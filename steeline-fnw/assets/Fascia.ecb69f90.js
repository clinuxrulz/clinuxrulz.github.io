import{a as t}from"./index.5aba22ff.js";import{b,T as k,Q as v,J as A,K as G,l as R,O as q,Z as O,Y as Z,X as W,G as D}from"./Component.6024a649.js";import{a as m}from"./Vec3.ce1f4f7a.js";import{a as T}from"./utils.6e3ab489.js";import{i as j}from"./PropertiesForm.c69fa44e.js";class ie{constructor(e){let x=t(()=>{let i,l,n,r;for(let o of e.outline())(i==null||o.x<i)&&(i=o.x),(l==null||o.x>l)&&(l=o.x),(n==null||o.y<n)&&(n=o.y),(r==null||o.y>r)&&(r=o.y);if(!(i==null||l==null||n==null||r==null))return{minX:i,minY:n,maxX:l,maxY:r}}),w=e.startGap??(()=>300),B=e.endGap??(()=>100),a=e.maxSpacing??(()=>1200),S=()=>20,y=t(()=>{let i=x();if(i==null)return[];let l=0,n=[];n.push(i.minX);for(let r=0;r<e.baySizes().length-1;++r)l+=e.baySizes()[r],n.push(l);return n.push(i.maxX),n}),g=i=>{let l=e.outline(),n;for(let r=0;r<l.length;++r){let o=l[r],s=l[(r+1)%l.length],X=Math.min(o.y,s.y),c=Math.max(o.y,s.y);if(X<=i&&i<=c){let u=s.x-o.x,M=s.y-o.y,d=o.x+(i-o.y)*u/M;if(!Number.isFinite(d))continue;n==null?n={minX:d,maxX:d}:(d<n.minX&&(n.minX=d),d>n.maxX&&(n.maxX=d))}}return n},f=t(()=>{let i=x();if(i==null)return[];let l=i.minY+w(),r=i.maxY-B()-.5*e.purlinProperties().width-l,o=Math.ceil(r/a()),s=o+1,X=r/o,c=[];for(let u=0;u<s;++u)c.push(l+X*u);return c}),P=i=>{let l=i.posY,n=i.fromX,r=i.toX,o=[{fromX:n,toX:r}],s=[];for(let X of e.openings()){for(let c of o){let u=X.pos.x,M=X.pos.y,d=u+X.width,H=M+X.height;if(M<=l&&l<=H)if(d<=c.fromX)s.push(c);else if(u>=c.toX)s.push(c);else{{let I=c.fromX,C=u;I<C&&s.push({fromX:I,toX:C})}{let I=d,C=c.toX;I<C&&s.push({fromX:I,toX:C})}}else s.push(c)}{let c=o;o=s,s=c,s.splice(0,s.length)}}return o},p=t(()=>{let i={},l=e.baySizes(),n;e.reverseBayIndices==null?n=!1:n=e.reverseBayIndices();for(let r of e.openBays()){let o=r.location;if(o.head()!="Bay")continue;let s=o.tail();if(s==null)continue;let X=s.head();if(X==null)continue;let c=Number.parseInt(X);if(!Number.isFinite(c)||c<0||c>=l.length)continue;let u;n?u=l.length-1-c:u=c,i[u]=r}return i}),h=t(()=>{if(x()==null)return[];let l=p(),n=f(),r=[];for(let o=0;o<y().length-1;++o){let s=l[o];if(s!=null&&s.type=="Fully Open")continue;let X=o>0?S():0,c=o<y().length-2?S():0,u=y()[o]-X,M=y()[o+1]+c;for(let d of n){let H=g(d);if(H==null||u>=H.maxX||M<=H.minX)continue;u=Math.max(u,H.minX),M=Math.min(M,H.maxX);let I=d-.5*e.purlinProperties().width;for(let C of P({posY:I,fromX:u,toX:M})){let Y=C.fromX,Q=C.toX-C.fromX;r.push(new b({itemName:()=>e.purlinItemName(),transform:()=>k.create(m.create(Y,d-.5*e.purlinProperties().width,0),v.identity),length:()=>Q,topHatProperties:()=>e.purlinProperties()}))}}}return r}),z=t(()=>{if(!e.hasEndClips())return[];let i=2*f().length;return[new b({itemName:()=>"Tophat 64 Girt Clip, 100x50x100 2.0mm",qty:()=>i})]});this.components=t(()=>[...h(),...z()])}}class L{constructor(e){let x=t(()=>"Angled Base Connection, C"+e.frameSize().toFixed(0)+", "+e.size().toFixed(0));this.components=t(()=>[new b({itemName:x,usage:()=>"Column Anchor Brackets (Angle)"})])}}function J(N){return"Powers Pure150-PTO M"+N.boltSize.toFixed(0)+" x "+N.boltLength.toFixed(0)+"mm (hnom = 125)"}function F(){return"Purlin Bolt/Nut 12x30"}class K{constructor(e){let x=t(()=>e.pitch()+"\xB0 Apex Bracket, C"+e.frameSize().toFixed()+" Frame - Lipped"),w=()=>{let a=Math.cos(e.pitch()*Math.PI/180),S=Math.sin(e.pitch()*Math.PI/180),y=Math.tan(e.pitch()*Math.PI/180);const g=150,f=10,P=g+(e.frameSize()-2*f/a)*y;let p=.001,h=new A;h.moveTo(0,0),h.lineTo(-a*P*p,-S*P*p),h.lineTo(-a*g*p,(-S*g-(e.frameSize()-2*f)/a)*p),h.lineTo(0,-(e.frameSize()-2*f)/a*p),h.lineTo(a*g*p,(-S*g-(e.frameSize()-2*f)/a)*p),h.lineTo(a*P*p,-S*P*p),h.closePath();let z=new G(h,{depth:5*p,bevelEnabled:!1});z.translate(0,0,-f/a*p),z.rotateX(90*Math.PI/180);let i=new R(z,new q({color:"#808080"})),l=new O(new Z(z),new W({color:"#000000"})),n=new D;return n.add(i),n.add(l),n},B=t(()=>[new b({itemName:F,usage:()=>"Apex Bracket",qty:()=>8})]);this.components=t(()=>[new b({transform:()=>k.identity,itemName:x,usage:()=>"Apex Brackets",mkObject3d:()=>w}),...B()])}}class E{constructor(e){let x=t(()=>"Base Cleat Bolt Down Bracket C"+e.frameSize().toFixed(0)+" Frame");this.components=t(()=>[new b({itemName:x})])}}class U{constructor(e){let x=t(()=>e.pitch()+"\xB0 Haunch Bracket, C"+e.frameSize().toFixed()+" Frame, "+e.hand()+" - Lipped"),w=()=>{let a=Math.cos(e.pitch()*Math.PI/180),S=Math.sin(e.pitch()*Math.PI/180),y=Math.tan(e.pitch()*Math.PI/180);const g=150,f=10,P=g+(e.frameSize()-2*f)*(1-S),p=g+(e.frameSize()-2*f)*y;let h=.001,z=new A;z.moveTo(0,0),z.lineTo(0,-P*h),z.lineTo((e.frameSize()-2*f)*h,-P*h),z.lineTo((e.frameSize()-2*f)*h,(-P+g)*h),z.lineTo((e.frameSize()-2*f+p*a)*h,(-P+g+p*S)*h),z.lineTo((e.frameSize()-2*f+p*a-(e.frameSize()-2*f)*S)*h,(-P+g+p*S+(e.frameSize()-2*f)*a)*h),z.closePath();let i=new G(z,{depth:5*h,bevelEnabled:!1});i.translate(+f/a*h,0,-f/a*h),i.rotateX(90*Math.PI/180),e.hand()=="Right"&&(i.translate(0,-2*f/a*h,0),i.rotateZ(Math.PI));let l=new R(i,new q({color:"#808080"})),n=new O(new Z(i),new W({color:"#000000"})),r=new D;return r.add(l),r.add(n),r},B=t(()=>[new b({itemName:F,usage:()=>"Haunch Bracket",qty:()=>10})]);this.components=t(()=>[new b({transform:()=>k.identity,itemName:x,usage:()=>"Haunch Brackets "+e.hand(),mkObject3d:()=>w}),...B()])}}class ne{constructor(e){let x=t(()=>e.pitch()*Math.PI/180),w=t(()=>Math.cos(x())),B=t(()=>Math.sin(x())),a=t(()=>Math.tan(x())),S=()=>0,y=e.height,g=t(()=>y()-S()),f=t(()=>(.5*e.span()-e.girtHeight()-e.frameProperties().webSize)/w()-e.frameProperties().webSize*a()),P=t(()=>new b({itemName:e.frameItemName,usage:()=>"Column",length:g,ceeProperties:e.frameProperties,transform:()=>k.create(m.create(e.girtHeight()+e.frameProperties().webSize,0,0),v.fromWU(m.negUnitY,m.unitZ))})),p=t(()=>new b({itemName:e.frameItemName,usage:()=>"Column",length:g,ceeProperties:e.frameProperties,transform:()=>k.create(m.create(e.span()-e.girtHeight(),0,0),v.fromWU(m.negUnitY,m.unitZ))})),h=t(()=>new b({itemName:e.frameItemName,usage:()=>"Rafter",length:f,ceeProperties:e.frameProperties,transform:()=>k.create(m.create(e.girtHeight()+e.frameProperties().webSize+e.frameProperties().webSize*B(),0,e.height()-(e.purlinHeight()+e.frameProperties().webSize)/w()+(e.girtHeight()+e.frameProperties().webSize+e.frameProperties().webSize*B())*a()),v.fromWU(m.negUnitY,m.create(w(),0,B())))})),z=t(()=>new b({itemName:e.frameItemName,usage:()=>"Rafter",length:f,ceeProperties:e.frameProperties,transform:()=>k.create(m.create(e.span()-e.girtHeight()-e.frameProperties().webSize,0,e.height()-e.purlinHeight()/w()+(e.girtHeight()+e.frameProperties().webSize)*a()),v.fromWU(m.negUnitY,m.create(-w(),0,B())))})),i=t(()=>{if(e.baySizes().length<2)return[];let c=[],u=0;for(let M=0;M<e.baySizes().length-1;++M){u+=e.baySizes()[M];let d;{let C=u-.5*e.mullionProperties().flangeSize,Y=u+.5*e.mullionProperties().flangeSize;d=e.height()+Math.min(Math.min(C,e.span()-C),Math.min(Y,e.span()-Y))*a()-e.purlinHeight()/w()}let H=d,I=u;c.push(new b({itemName:e.mullionItemName,length:()=>H,usage:()=>"Mullion",ceeProperties:e.mullionProperties,transform:()=>k.create(m.create(I-.5*e.mullionProperties().flangeSize,e.mullionProperties().webSize,0),v.fromWU(m.unitX,m.unitZ))}))}return c}),l=t(()=>({bracket:new U({pitch:e.pitch,frameSize:()=>e.frameProperties().webSize,hand:()=>"Left"}),space:k.create(m.create(e.girtHeight(),5,e.height()+e.girtHeight()*a()-e.purlinHeight()/w()),v.identity)})),n=t(()=>({bracket:new U({pitch:e.pitch,frameSize:()=>e.frameProperties().webSize,hand:()=>"Right"}),space:k.create(m.create(e.span()-e.girtHeight(),5,e.height()+e.girtHeight()*a()-e.purlinHeight()/w()),v.identity)})),r=t(()=>({bracket:new K({pitch:e.pitch,frameSize:()=>e.frameProperties().webSize}),space:k.create(m.create(.5*e.span(),5,e.height()+.5*e.span()*a()-e.purlinHeight()/w()),v.identity)})),o=t(()=>e.locationType()!="End"?[]:[new L({frameSize:()=>e.frameProperties().webSize,size:()=>60}),new L({frameSize:()=>e.frameProperties().webSize,size:()=>60})]),s=t(()=>e.locationType()!="Mid"?[]:[new E({frameSize:()=>e.frameProperties().webSize}),new E({frameSize:()=>e.frameProperties().webSize})]),X=t(()=>{let c;switch(e.locationType()){default:case"End":c=2*2;break;case"Mid":c=4*2;break}return[new b({itemName:F,usage:()=>"Column Anchor Brackets",qty:()=>c}),new b({itemName:()=>J({boltSize:12,boltLength:120}),usage:()=>"Column",qty:()=>2*2})]});this.components=t(()=>{let c=T(l().bracket.components,()=>l().space),u=T(n().bracket.components,()=>n().space),M=T(r().bracket.components,()=>r().space);return[P(),p(),h(),z(),...i(),...c(),...u(),...M(),...o().flatMap(d=>d.components()),...s().flatMap(d=>d.components()),...X()]})}}class oe{constructor(e){let x=()=>"C10010",w=t(()=>j[x()]),B=t(()=>{let S=[],y=0;for(let g of e.baySizes()){let f=y;S.push(new b({transform:()=>k.create(m.create(f,w().flangeSize,-w().webSize),v.fromWU(m.negUnitY,m.unitX)),itemName:x,length:()=>g,usage:()=>"Eave Purlin",ceeProperties:w})),y+=g}return S}),a=t(()=>{let S="Eave Purlin Bracket- Single C150 Frames",y=e.baySizes().length+1,g="14-24 X 38 CL4 Fine Hex Series 500 SDS",f=0;for(let P of e.baySizes())f+=Math.ceil(P/300);return[new b({itemName:()=>S,qty:()=>y,usage:()=>"Eave Purlin"}),new b({itemName:()=>g,qty:()=>f,usage:()=>"Eave Purlin"})]});this.components=t(()=>[...B(),...a()])}}export{ne as C,oe as F,ie as P};
