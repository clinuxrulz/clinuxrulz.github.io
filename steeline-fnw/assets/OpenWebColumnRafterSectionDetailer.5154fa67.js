import{c as Z,g as J,o as oe,z as me,a as H,A as ge,i as B,b as N,I as K,e as I,s as S,C as ce,t as F,u as ve,J as pe,_ as be,S as _e,M as Q,d as $e,f as xe}from"./index.5aba22ff.js";import{L as ae}from"./Line2D.139781b3.js";import{a as ee,V as k}from"./Vec3.ce1f4f7a.js";import{m as de,S as ue,a as ye}from"./SvgWithPanZoomState.e2089103.js";import{D as ke}from"./DocumentsView.ab8d138b.js";import{i as te,P as Me,m as q,j as we}from"./PropertiesForm.c69fa44e.js";import{O as Se}from"./OpenWebColumnRafterSection.d2fefac8.js";import"./Ray2D.01cdc921.js";import"./DocumentView.3a121409.js";import"./Component.6024a649.js";const Ce=F('<div style="display: flex; flex-direction: column; width: 287mm; height: 200mm; padding: 0; margin: 0; overflow: none;"><div><h2></h2></div><div style="flex-grow: 1; overflow: none;"></div></div>'),We=F('<svg><rect vector-effect="non-scaling-stroke"></rect></svg>',4,!0),ne=F('<svg><line stroke="black" stroke-width="1" vector-effect="non-scaling-stroke"></line></svg>',4,!0),Ne=F('<svg><text fill="black" text-anchor="middle"></text></svg>',4,!0),se=y=>{let W;const[D,v]=Z({svgWidth:400,svgHeight:300,unitScale:12.5}),d=$=>$/D.unitScale,[b,L]=Z({...de(),panX:d(0),panY:d(-2500),scale:20}),X=new ResizeObserver($=>{for(const i of $)i.contentBoxSize&&J(()=>{v("svgWidth",i.contentRect.width),v("svgHeight",i.contentRect.height)})});oe(()=>{J(()=>{W!=null&&(v("svgWidth",W.clientWidth),v("svgHeight",W.clientHeight))}),W!=null&&X.observe(W)}),me(()=>{W!=null&&X.unobserve(W),X.disconnect()});const G=H(()=>{let $=y.openWebMember.components(),i=[];for(let m of $)if(m.transform!=null&&m.length!=null){if(m.ceeProperties!=null){let C=Math.atan2(-m.transform().u.z,m.transform().u.x)*180/Math.PI,M;{let c;m.transform().v.y<0?c=ee.zero:c=m.transform().w.scale(m.ceeProperties().flangeSize),M=m.transform().o.add(c)}let g="translate("+d(M.x)+","+d(-M.z)+") rotate("+C+")";i.push({transform:g,width:d(m.length()),height:d(m.ceeProperties().flangeSize),colour:"rgb(0,0,0)",pos:k.create(d(M.x),d(-M.z)),angle:C})}if(m.flatProperties!=null){let C=Math.atan2(-m.transform().v.z,m.transform().v.x)*180/Math.PI,M;{let c;m.transform().u.y>0?c=ee.zero:c=m.transform().w.scale(m.flatProperties().thickness),M=m.transform().o.add(c)}let g="translate("+d(M.x)+","+d(-M.z)+") rotate("+C+")";i.push({transform:g,width:d(m.flatProperties().width),height:d(m.flatProperties().thickness),colour:"rgb(255,0,0)",pos:k.create(d(M.x),d(-M.z)),angle:C})}}return i}),R=H(()=>{let $=[],i=y.openWebMember.params,m=i.frontBackCutAngle()*Math.PI/180,C=Math.tan(m),M=i.backBackCutAngle()*Math.PI/180,g=Math.tan(M),c,r;m>0?(c=i.width()*C,r=0):(c=0,r=i.width()*-C);let t,p;M>0?(t=i.width()*g,p=0):(t=0,p=i.width()*-g);{let n=k.create(c,-1e3/b.scale),u=k.create(y.openWebMember.params.length()-t,-1e3/b.scale),o=n.distance(u).toFixed(0)+"mm (to outside of plates)";$.push({pt1:n,pt2:u,text:o})}{let n=k.create(r,i.width()+800/b.scale),u=k.create(y.openWebMember.params.length()-p,i.width()+800/b.scale),o=n.distance(u).toFixed(0)+"mm (to outside of plates)";$.push({pt1:n,pt2:u,text:o})}{let n=k.create(-400/b.scale,0),u=k.create(-400/b.scale,i.width()),o=n.distance(u).toFixed(0)+"mm";$.push({pt1:n,pt2:u,text:o})}if(i.frontBackCutAngle()!=0){let n=i.frontBackCutAngle()>0?-1e3/b.scale:800/b.scale,u=0,o=i.frontBackCutAngle()>0?c:r,s=k.create(u,n),e=k.create(o,n),a=s.distance(e).toFixed(0)+"mm";$.push({pt1:s,pt2:e,text:a})}if(i.backBackCutAngle()!=0){let n=i.backBackCutAngle()>0?-1e3/b.scale:800/b.scale,u=i.backBackCutAngle()>0?y.openWebMember.params.length()-t:y.openWebMember.params.length()-p,o=i.backBackCutAngle()>0?y.openWebMember.params.length()-p:y.openWebMember.params.length()-t,s=k.create(u,n),e=k.create(o,n),a=s.distance(e).toFixed(0)+"mm";$.push({pt1:s,pt2:e,text:a})}{let n=[],u=Math.max(c,r),o=Math.max(t,p);i.frontBackCutAngle()>0?n.push(0):n.push(u);for(let e of y.openWebMember.components()){if(e.transform==null||e.length==null||e.ceeProperties==null||e.transform().o.x<u+100||e.transform().o.x>i.length()-o-100)continue;let a=e.transform().u.z>0?e.length():0,l=e.transform().o.add(e.transform().u.scale(a)).add(e.transform().w.scale(.5*e.ceeProperties().flangeSize));n.push(l.x)}i.backBackCutAngle()>0?n.push(i.length()):n.push(i.length()-o),n.sort((e,a)=>e-a);let s=i.width()+300/b.scale;for(let e=0;e<n.length-1;++e){let a=n[e],l=n[e+1],f=k.create(a,s),w=k.create(l,s),h=(l-a).toFixed(0)+"mm";$.push({pt1:f,pt2:w,text:h})}}{let n=[],u=Math.max(c,r),o=Math.max(t,p);i.frontBackCutAngle()>0?n.push(u):n.push(0);for(let e of y.openWebMember.components()){if(e.transform==null||e.length==null||e.ceeProperties==null||e.transform().o.x<u+100||e.transform().o.x>i.length()-o-100)continue;let a=e.transform().u.z<0?e.length():0,l=e.transform().o.add(e.transform().u.scale(a)).add(e.transform().w.scale(.5*e.ceeProperties().flangeSize));n.push(l.x)}i.backBackCutAngle()>0?n.push(i.length()-o):n.push(i.length()),n.sort((e,a)=>e-a);let s=-500/b.scale;for(let e=0;e<n.length-1;++e){let a=n[e],l=n[e+1],f=k.create(a,s),w=k.create(l,s),h=(l-a).toFixed(0)+"mm";$.push({pt1:f,pt2:w,text:h})}}return $});return ge(()=>{let $,i,m,C;for(let o of G()){let s=o.angle*Math.PI/180,e=Math.cos(s),a=Math.sin(s),l=k.create(e,a),f=k.create(-l.y,l.x),w=[o.pos,o.pos.add(l.scale(o.width)),o.pos.add(l.scale(o.width)).add(f.scale(o.height)),o.pos.add(f.scale(o.height))];for(let h of w)($==null||h.x<$)&&($=h.x),(i==null||h.x>i)&&(i=h.x),(m==null||h.y<m)&&(m=h.y),(C==null||h.y>C)&&(C=h.y)}if($==null||i==null||m==null||C==null)return;const M=100;let g=i-$,c=C-m,r=(D.svgWidth-M)/g,t=D.svgHeight/c,p=Math.min(r,t)*.9,n=-.5*D.svgWidth/p+.5*g,u=-.5*D.svgHeight/p-.5*c;J(()=>{L("panX",n),L("panY",u),L("scale",p)})}),(()=>{const $=Ce.cloneNode(!0),i=$.firstChild,m=i.firstChild,C=i.nextSibling;B(m,()=>y.documentTitle);const M=W;return typeof M=="function"?ve(M,C):W=C,B(C,N(ue,{showGrid:!1,fontSize:12,state:b,style:{width:"100%",height:"100%"},get children(){return[N(K,{get each(){return G()},children:g=>(()=>{const c=We.cloneNode(!0);return I(r=>{const t=g().transform,p=g().width,n=g().height,u="stroke-width:1;stroke:"+g().colour+";fill:none;";return t!==r._v$&&S(c,"transform",r._v$=t),p!==r._v$2&&S(c,"width",r._v$2=p),n!==r._v$3&&S(c,"height",r._v$3=n),r._v$4=ce(c,u,r._v$4),r},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),c})()}),N(K,{get each(){return R()},children:g=>{let c=H(()=>{let r=g().pt2.sub(g().pt1).normalize(),t=k.create(-r.y,r.x),p=g().pt1.add(g().pt2).scale(.5).add(t.scale(50)),n=Math.atan2(-r.y,r.x)*180/Math.PI,u=ae.create(g().pt1.sub(t.scale(40)),g().pt1.add(t.scale(40))),o=ae.create(g().pt2.sub(t.scale(40)),g().pt2.add(t.scale(40)));return{leftLineEnd:u,rightLineEnd:o,textO:p,textAngle:n}});return[(()=>{const r=ne.cloneNode(!0);return I(t=>{const p=d(g().pt1.x),n=d(-g().pt1.y),u=d(g().pt2.x),o=d(-g().pt2.y);return p!==t._v$5&&S(r,"x1",t._v$5=p),n!==t._v$6&&S(r,"y1",t._v$6=n),u!==t._v$7&&S(r,"x2",t._v$7=u),o!==t._v$8&&S(r,"y2",t._v$8=o),t},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),r})(),(()=>{const r=ne.cloneNode(!0);return I(t=>{const p=d(c().leftLineEnd.v1.x),n=d(-c().leftLineEnd.v1.y),u=d(c().leftLineEnd.v2.x),o=d(-c().leftLineEnd.v2.y);return p!==t._v$9&&S(r,"x1",t._v$9=p),n!==t._v$10&&S(r,"y1",t._v$10=n),u!==t._v$11&&S(r,"x2",t._v$11=u),o!==t._v$12&&S(r,"y2",t._v$12=o),t},{_v$9:void 0,_v$10:void 0,_v$11:void 0,_v$12:void 0}),r})(),(()=>{const r=ne.cloneNode(!0);return I(t=>{const p=d(c().rightLineEnd.v1.x),n=d(-c().rightLineEnd.v1.y),u=d(c().rightLineEnd.v2.x),o=d(-c().rightLineEnd.v2.y);return p!==t._v$13&&S(r,"x1",t._v$13=p),n!==t._v$14&&S(r,"y1",t._v$14=n),u!==t._v$15&&S(r,"x2",t._v$15=u),o!==t._v$16&&S(r,"y2",t._v$16=o),t},{_v$13:void 0,_v$14:void 0,_v$15:void 0,_v$16:void 0}),r})(),(()=>{const r=Ne.cloneNode(!0);return B(r,()=>g().text),I(t=>{const p="translate("+d(c().textO.x)+","+d(-c().textO.y)+") rotate("+c().textAngle+")",n=(20/b.scale).toString();return p!==t._v$17&&S(r,"transform",t._v$17=p),n!==t._v$18&&S(r,"font-size",t._v$18=n),t},{_v$17:void 0,_v$18:void 0}),r})()]}})]}})),$})()},Pe=F('<button class="btn btn-primary" style="margin-left: 5px; margin-bottom: 5px;">Close</button>'),ze=F("<br>"),Be=F('<svg><polygon stroke="green" fill="none" vector-effect="non-scaling-stroke"></polygon></svg>',4,!0),Fe=F('<div style="flex-grow: 1; display: flex; flex-direction: row;"><div></div></div>'),De=F('<div style="flex-grow: 1; display: flex; flex-direction: column; overflow-y: scroll;"><div style="flex-grow: 1;"><table class="table"><thead><tr><th style="background: #FFF;">Item Name</th><th style="background: #FFF;">Qty</th><th style="background: #FFF;">Length</th><th style="background: #FFF;">Usage</th></tr></thead><tbody></tbody></table></div></div>'),ie=F('<div style="flex-grow: 1; display: flex; flex-direction: column;"></div>'),Te=F('<div style="flex-grow: 1; display: flex; flex-direction: column; overflow-y: hidden;"><div><h2>Open Web Column Rafter Section Detailer</h2></div><ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link" style="cursor: pointer;">Model</a></li><li class="nav-item"><a class="nav-link" style="cursor: pointer;">BOM</a></li><li class="nav-item"><a class="nav-link" style="cursor: pointer;">3D</a></li><li class="nav-item"><a class="nav-link" style="cursor: pointer;">Workshop Drawings</a></li></ul></div>'),Oe=F('<svg><rect vector-effect="non-scaling-stroke"></rect></svg>',4,!0),He=F("<tr><td></td><td></td><td></td><td></td></tr>"),Ie=pe(()=>be(()=>import("./ComponentScene3D.8d7811a7.js"),["ComponentScene3D.8d7811a7.js","index.5aba22ff.js","index.8628b9c4.css","Component.6024a649.js","Vec3.ce1f4f7a.js","OrbitControls.3e0e93be.js","GLTFExporter.c7bd8ba1.js","PropertiesForm.c69fa44e.js","three_js_component_renderer.95a2237b.js","LineKit.f6b732de.js","Component.fa73bdbc.js","Line3D.2b8117f1.js"],import.meta.url));var P;(function(y){y[y.Model=0]="Model",y[y.BOM=1]="BOM",y[y._3D=2]="_3D",y[y.WorkshopDrawings=3]="WorkshopDrawings"})(P||(P={}));const Ue=y=>{oe(()=>{document.title="Tool Box - Open Web Column Rafter Section Detailer"});const[W,D]=Z({svgWidth:400,svgHeight:300,unitScale:100/8,selectedTab:P.Model}),[v,d]=Z({span:12e3,height:4300,pitch:15,webWidth:600,girtHeight:102,purlinHeight:102,webMemberItemName:"C10019"}),b=s=>s/W.unitScale,[L,X]=Z({...de(),panX:b(-1e3),panY:b(-9e3)});new ResizeObserver(s=>{for(const e of s)if(e.contentBoxSize){if(e.contentRect.width==0)return;J(()=>{D("svgWidth",e.contentRect.width),D("svgHeight",e.contentRect.height)})}});const G=H(()=>!1);let R=new ye({state:L,setState:X,disablePan:G}),$=s=>{R.onMouseDown(s)},i=s=>{R.onMouseUp(s)},m=s=>{R.onMouseMove(s)},C=s=>{R.onWheel(s)};const M=new Se({span:()=>v.span,height:()=>v.height,pitch:()=>v.pitch,webMemberWidth:()=>v.webWidth,girtHeight:()=>v.girtHeight,purlinHeight:()=>v.purlinHeight,nestingMemberProperties:()=>{let s=te[v.webMemberItemName];return{itemName:v.webMemberItemName.substring(0,4)+" Nesting Channel",webSize:s.webSize,flangeSize:s.flangeSize,lipSize:0,thickness:s.thickness}},webMemberProperties:()=>{let s=te[v.webMemberItemName];return{itemName:v.webMemberItemName,webSize:s.webSize,flangeSize:s.flangeSize,lipSize:s.lipSize,thickness:s.thickness}},flatProperties:()=>({itemName:"Flat Bar 50x10",width:50,thickness:10})}),g=H(()=>M.components()),c=H(()=>{let s=g(),e={};for(let l of s){if(l.itemName==null)continue;let f;l.length==null?f="--":f=Math.round(l.length()).toFixed(0)+" mm";let w=l.itemName+"_"+f,h=e[w];if(h==null){let T=new Map;l.usage!=null&&T.set(l.usage(),l.qty==null?1:l.qty()),e[w]={itemName:l.itemName(),qty:l.qty==null?1:l.qty(),usage:T,length:f}}else if(h.qty+=l.qty==null?1:l.qty(),l.usage!=null){let T=h.usage.get(l.usage())??0;h.usage.set(l.usage(),T+(l.qty==null?1:l.qty()))}}let a=[];for(let l in e){let f=e[l],w="";{let h=!0;for(let[T,U]of f.usage)h?h=!1:w+="; ",w+=T+" ("+U+")"}a.push({itemName:f.itemName,qty:f.qty,length:f.length,usage:w})}return a.sort((l,f)=>{let w=l.itemName.localeCompare(f.itemName);if(w!=0)return w;{let h=Number.parseFloat(l.length),T=Number.parseFloat(f.length);return Number.isFinite(h)&&Number.isFinite(T)?h-T:l.length.localeCompare(f.length)}}),a}),r=()=>{D("selectedTab",P.Model)},t=()=>{D("selectedTab",P.BOM)},p=()=>{D("selectedTab",P._3D)},n=()=>{D("selectedTab",P.WorkshopDrawings)},u=H(()=>{let s="",e=v.height+.5*v.span*Math.tan(v.pitch*Math.PI/180),a=[k.create(0,0),k.create(v.span,0),k.create(v.span,v.height),k.create(.5*v.span,e),k.create(0,v.height)];{let l=!0;for(let f of a)l?l=!1:s+=" ",s+=b(f.x)+","+b(-f.y)}return{pointsStr:s}}),o=H(()=>{let s=g(),e=[];for(let a of s)if(a.transform!=null&&a.length!=null){if(a.ceeProperties!=null){let l=Math.atan2(-a.transform().u.z,a.transform().u.x)*180/Math.PI,f;{let h;a.transform().v.y<0?h=ee.zero:h=a.transform().w.scale(a.ceeProperties().flangeSize),f=a.transform().o.add(h)}let w="translate("+b(f.x)+","+b(-f.z)+") rotate("+l+")";e.push({transform:w,width:b(a.length()),height:b(a.ceeProperties().flangeSize),colour:"rgb(0,0,0)"})}if(a.flatProperties!=null){let l=Math.atan2(-a.transform().v.z,a.transform().v.x)*180/Math.PI,f;{let h;a.transform().u.y>0?h=ee.zero:h=a.transform().w.scale(a.flatProperties().thickness),f=a.transform().o.add(h)}let w="translate("+b(f.x)+","+b(-f.z)+") rotate("+l+")";e.push({transform:w,width:b(a.flatProperties().width),height:b(a.flatProperties().thickness),colour:"rgb(255,0,0)"})}}return e});return(()=>{const s=Te.cloneNode(!0),e=s.firstChild;e.firstChild;const a=e.nextSibling,l=a.firstChild,f=l.firstChild,w=l.nextSibling,h=w.firstChild,T=w.nextSibling,U=T.firstChild,fe=T.nextSibling,le=fe.firstChild;return B(e,N(_e,{get when(){return y.onClose!=null},get children(){return[(()=>{const x=Pe.cloneNode(!0);return x.$$click=()=>{y.onClose!=null&&y.onClose()},x})(),ze.cloneNode(!0)]}}),null),f.$$click=()=>r(),h.$$click=()=>t(),U.$$click=()=>p(),le.$$click=()=>n(),B(s,N($e,{get children(){return[N(Q,{get when(){return W.selectedTab==P.Model},get children(){const x=Fe.cloneNode(!0),E=x.firstChild;return B(E,N(Me,{get fieldGroups(){return[{displayName:"Section",fields:[q({displayName:()=>"Span",value:()=>v.span,setValue:_=>d("span",_)}),q({displayName:()=>"Height",value:()=>v.height,setValue:_=>d("height",_)}),q({displayName:()=>"Pitch",value:()=>v.pitch,setValue:_=>d("pitch",_)}),q({displayName:()=>"Web Width",value:()=>v.webWidth,setValue:_=>d("webWidth",_)}),q({displayName:()=>"Girt Height",value:()=>v.girtHeight,setValue:_=>d("girtHeight",_)}),q({displayName:()=>"Purlin Height",value:()=>v.purlinHeight,setValue:_=>d("purlinHeight",_)}),we({displayName:()=>"Web Member",value:()=>v.webMemberItemName,setValue:_=>d("webMemberItemName",_),possibleValues:H(()=>Object.keys(te))})],expanded:()=>!0}]}})),B(x,N(ue,{showGrid:!0,fontSize:12,state:L,onMouseDown:$,onMouseUp:i,onMouseMove:m,onWheel:C,style:{"flex-grow":"1"},get children(){return[N(K,{get each(){return o()},children:_=>(()=>{const O=Oe.cloneNode(!0);return I(z=>{const A=_().transform,Y=_().width,V=_().height,j="stroke-width:1;stroke:"+_().colour+";fill:none;";return A!==z._v$5&&S(O,"transform",z._v$5=A),Y!==z._v$6&&S(O,"width",z._v$6=Y),V!==z._v$7&&S(O,"height",z._v$7=V),z._v$8=ce(O,j,z._v$8),z},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),O})()}),(()=>{const _=Be.cloneNode(!0);return I(()=>S(_,"points",u().pointsStr)),_})()]}}),null),x}}),N(Q,{get when(){return W.selectedTab==P.BOM},get children(){const x=De.cloneNode(!0),E=x.firstChild,_=E.firstChild,O=_.firstChild,z=O.nextSibling;return B(z,N(K,{get each(){return c()},children:A=>(()=>{const Y=He.cloneNode(!0),V=Y.firstChild,j=V.nextSibling,re=j.nextSibling,he=re.nextSibling;return B(V,()=>A().itemName),B(j,()=>A().qty),B(re,()=>A().length),B(he,()=>A().usage),Y})()})),x}}),N(Q,{get when(){return W.selectedTab==P._3D},get children(){const x=ie.cloneNode(!0);return B(x,N(Ie,{get components(){return g()}})),x}}),N(Q,{get when(){return W.selectedTab==P.WorkshopDrawings},get children(){const x=ie.cloneNode(!0);return B(x,N(ke,{documents:[{name:()=>"Column Frame",pages:()=>[()=>N(se,{documentTitle:"Column Frame",get openWebMember(){return M.columns()[0]}})]},{name:()=>"Rafter Frame",pages:()=>[()=>N(se,{documentTitle:"Rafter Frame",get openWebMember(){return M.rafters()[0]}})]}]})),x}})]}}),null),I(x=>{const E=W.selectedTab==P.Model,_=W.selectedTab==P.BOM,O=W.selectedTab==P._3D,z=W.selectedTab==P.WorkshopDrawings;return E!==x._v$&&f.classList.toggle("active",x._v$=E),_!==x._v$2&&h.classList.toggle("active",x._v$2=_),O!==x._v$3&&U.classList.toggle("active",x._v$3=O),z!==x._v$4&&le.classList.toggle("active",x._v$4=z),x},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),s})()};xe(["click"]);export{Ue as default};
