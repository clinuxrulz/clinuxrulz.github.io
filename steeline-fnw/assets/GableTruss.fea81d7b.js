import{a as o}from"./index.5aba22ff.js";import{P as d,L as w}from"./Line2D.139781b3.js";import{b as se,T as me,Q as ce}from"./Component.6024a649.js";import{R as J}from"./Ray2D.01cdc921.js";import{V as r,a as q}from"./Vec3.ce1f4f7a.js";import{A as he}from"./PropertiesForm.c69fa44e.js";class Pe{constructor(f){let L=()=>17,K=()=>30,_=()=>80,$=()=>5,v=()=>12,I=o(()=>new he({webSize:_(),flangeSize:K(),lipSize:$(),dimpleDistFromWeb:L(),tieDownHoleOffsetFromCentre:0,serviceHoleOffsetFromCentre:0})),M=o(()=>d.fromPointAndNormal(r.create(0,L()),r.unitY)),ee=o(()=>d.fromPointAndNormal(r.zero,r.unitX)),te=o(()=>d.fromPointAndNormal(r.create(f.span(),0),r.negUnitX)),x=o(()=>Math.cos(f.pitch()*Math.PI/180)),Z=o(()=>Math.sin(f.pitch()*Math.PI/180)),z=o(()=>{let e=M().intersection(ee()),t=M().intersection(te());if(!(e==null||t==null))return w.create(e,t)}),A=o(()=>d.fromPointAndNormal(r.create(0,f.kneeHeight()),r.create(Z(),-x())).moveInNormalDirection(L())),U=o(()=>d.fromPointAndNormal(r.create(f.span(),f.kneeHeight()),r.create(-Z(),-x())).moveInNormalDirection(L())),C=o(()=>{let e=A().intersection(U()),t=A().intersection(M());if(!(e==null||t==null))return w.create(e,t).extendLength(v(),v())}),S=o(()=>{let e=U().intersection(M()),t=U().intersection(A());if(!(e==null||t==null))return w.create(e,t).extendLength(v(),v())}),X=o(()=>{let e=40,t=300-.5*e*x(),s=(.5*f.span()-80+.5*e*x()-t)/f.numWebSpacingPerSize(),m=[],h=[];for(let n=0;n<f.numWebSpacingPerSize();++n){let c=t+s*n+.5*e*x(),g=t+s*(n+.5)-.5*e,l=t+s*(n+.5)+.5*e,b=t+s*(n+1)-.5*e*x(),y=d.fromPointAndNormal(r.create(c,0),r.unitX),V=d.fromPointAndNormal(r.create(g,0),r.unitX),D=d.fromPointAndNormal(r.create(l,0),r.unitX),G=d.fromPointAndNormal(r.create(b,0),r.unitX),T=y.intersection(A()),F=V.intersection(M()),N=D.intersection(M()),R=G.intersection(A());T==null||F==null||N==null||R==null||h.push(w.create(F,T).extendLength(v(),v()),w.create(N,R).extendLength(v(),v()))}let P=[];for(let n of h){let c=r.create(f.span()-n.v1.x,n.v1.y),g=r.create(f.span()-n.v2.x,n.v2.y);P.push(w.create(g,c))}return m=[...h,...P],m});const W=e=>{let t=e.v2.sub(e.v1).normalize(),a=r.create(-t.y,t.x),s=e.v1.sub(a.scale(L())),m=e.length();return new se({transform:()=>me.create(q.create(s.x,0,s.y),ce.fromUV(q.create(t.x,0,t.y),q.unitY)),length:()=>m,panelMemberProperties:I})},O=(e,t)=>{let a=J.fromOriginDirection(e.v1,e.v2.sub(e.v1)),s=e.length(),m=[];for(let h of t){let P=d.fromPointToPoint(h.v1,h.v2),n=J.fromOriginDirection(h.v1,h.v2.sub(h.v1)),c=a.intersectionTime(P);if(c==null||c<0||c>1)continue;let g=a.pointFromTime(c),l=n.closestTimeToPoint(g);l<0||l>1||m.push(c*s)}return m},re=(e,t,a)=>{let s=e.v2.sub(e.v1),m=s.scale(1/s.length()),h=r.create(-m.y,m.x),P=e.v1.sub(h.scale(t.dimpleDistFromWeb)),n=e.length(),c=(l,b)=>{if(l.y<=0&&b.y>=0||b.y<=0&&l.y>=0){let y=l.x+(0-l.y)*(b.x-l.x)/(b.y-l.y);return Number.isFinite(y)?y:void 0}},g=[];for(let{dimpleLine:l,params:b}of a){let y=l.length(),V=l.v2.sub(l.v1),D=V.scale(1/V.length()),G=r.create(-D.y,D.x),T=l.v1.sub(G.scale(t.dimpleDistFromWeb)),F=r.create(T.sub(P).dot(m),T.sub(P).dot(h)),N=r.create(D.dot(m),D.dot(h)),R=r.create(-N.y,N.x),Y=F,k=F.add(N.scale(y)),j=k.add(R.scale(b.flangeSize)),B=Y.add(R.scale(b.flangeSize)),p=[],i=c(Y,k);if(i!=null&&p.push(i),i=c(k,j),i!=null&&p.push(i),i=c(j,B),i!=null&&p.push(i),i=c(B,Y),i!=null&&p.push(i),p.length<2)continue;let H=Math.max(0,Math.min(n,p[0])),E=Math.max(0,Math.min(n,p[0]));for(let Q=1;Q<p.length;++Q)i=Math.max(0,Math.min(n,p[Q])),i<H&&(H=i),i>E&&(E=i);E-H<.001||g.push({from:H,to:E})}return g};let u=e=>e==null?[]:[e],oe=o(()=>{let e=z();if(e==null)return;let t=W(e),a=O(e,[...u(C()),...u(S()),...X()]);return t.flangePunches=()=>a,t}),ne=o(()=>{let e=C();if(e==null)return;let t=W(e),a=O(e,[...u(z()),...u(S()),...X()]);return t.flangePunches=()=>a,t}),le=o(()=>{let e=S();if(e==null)return;let t=W(e),a=O(e,[...u(z()),...u(C()),...X()]);return t.flangePunches=()=>a,t}),ie=o(()=>X().map(e=>o(()=>{let t=W(e),a=O(e,[...u(z()),...u(C()),...u(S())]),s=re(e,I(),[...u(z()),...u(C()),...u(S())].map(m=>({dimpleLine:m,params:I()})));return t.flangePunches=()=>a,t.webNotchRanges=()=>s,t}))),ae=o(()=>{let e=[];e.push(oe,ne,le);for(let t of ie())e.push(t);return e});this.members=ae}}export{Pe as G};
