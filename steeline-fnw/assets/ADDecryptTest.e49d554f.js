import{t as y,u as g,h as s}from"./index.5aba22ff.js";const b=y('<div style="flex-grow: 1; display: flex; flex-direction: column;"><div><h2>AD Decrypt Test</h2>STE_clientcomponents.dat file: <input type="file"><br></div>Result:<textarea style="flex-grow: 1;"></textarea></div>'),_=u=>{let n;const a=r=>{if(n==null)return;let i=n;h(r,"52F3pnYslNp@B1").then(l=>{i.value=l})};return(()=>{const r=b.cloneNode(!0),i=r.firstChild,p=i.firstChild,l=p.nextSibling,x=l.nextSibling,o=i.nextSibling,f=o.nextSibling;x.addEventListener("change",t=>{let c=t.target;if(c.files==null||c.files.length==0)return;let d=c.files[0];a(d)});const e=n;return typeof e=="function"?g(e,f):n=f,f.readOnly=!0,r})()};async function h(u,n){let a=await u.arrayBuffer(),i=new Uint8Array(a).subarray(0,32),p=new Uint8Array(a,32),l="";for(let c of p){let d=c.toString(16);d.length==1&&(d="0"+d),l+=d}let x=s.exports.enc.Hex.parse(l),o=S(n,i),f=s.exports.lib.CipherParams.create({ciphertext:x});return s.exports.AES.decrypt(f,s.exports.enc.Hex.parse(o.pass),{iv:s.exports.enc.Hex.parse(o.iv),mode:s.exports.mode.CFB,padding:s.exports.pad.Pkcs7}).toString(s.exports.enc.Utf8)}function S(u,n){function a(e,t){if(e.length>t&&(e=e.substring(0,t)),e.length<t){for(;e.length<t;)e=e+"0";e=e.substring(0,t)}return e}let r=256,i=128,p="";for(let e of n){let t=e.toString(16);t.length<2&&(t="0"+t),p+=t}let l=s.exports.enc.Hex.parse(p),o=s.exports.PBKDF2(u,l,{keySize:r/4,iterations:5e4}).toString();return{pass:a(o.substring(0,2*r/8),2*r/8),iv:a(o.substring(2*r/8,2*r/8+2*i/8),2*i/8)}}export{_ as default};
