import{i as Fn,C as Ae,e as Wt,r as Be,h as mn,j as wo,S as ll,l as ol,o as ki,p as So,w as Po}from"./Component.fa73bdbc.js";import{y as zt,aa as sl,l as wt,A as Gt,g as At,a as t,z as Fe,B as Wi,b as Je,s as Me,I as St,e as dt,i as mt,S as Sn,t as lt,c as Gn,D as No,ab as al,ac as hl,ad as cl,f as Mo,M as mr,o as Co,d as vo,u as To,ae as Pn,af as ko,ag as zo,ah as gr,ai as Ao}from"./index.5aba22ff.js";import{ag as xo,ah as Vn,ai as dl,_ as Xt,B as di,aj as Zn,ak as Ln,al as gn,C as Pi,am as Io,a as Bo,a9 as Oo,a4 as xt,k as Ii,a2 as ui,g as De,r as Xi,V as je,ae as Fo,an as ul,H as fl,ao as Vo,ap as Lo,L as pl,x as ml,z as Hn,aq as Ho,ar as Nn,X as Tt,O as rt,D as $n,q as Eo,as as Uo,l as xe,Z as ht,at as Ro,au as Wo,av as Xo,G as nt,P as Do,h as _o,ac as Yo,aw as Go,ax as Zo,ay as $o,s as gl,e as Kn,t as Ko,u as jo,w as Qo,v as qo,y as Jo,F as es,I as ts,az as is,aA as ns,m as yr,aB as br,aC as wr,aD as Sr,aE as rs,aF as ls,aG as os,aH as zi,b as T,a7 as ve,T as m,Q as y,a0 as hi,$ as Ni,Y as bt,J as Et,K as It,aI as vi,aJ as ss,aK as as,aL as Mn,aM as si,R as hs,aN as cs,aO as ds,aP as us,a3 as Vt,aQ as yl,ad as fs,aa as ps}from"./Component.6024a649.js";import{S as Te,C as Pr,G as jt,R as Lt}from"./Gutter.196a297e.js";import{V as f,a as i}from"./Vec3.ce1f4f7a.js";import{v as En,g as ms,m as Un,a as wi,i as gs}from"./utils.6e3ab489.js";import{o as Pe,a as Oe,d as Ot,b as Ft,w as Zi,c as Cn}from"./PanelUtils.894b6d74.js";import{n as Qt,m as se,c as Pt,R as Ri,q as jn,r as yn,b as kt,S as Mi,a as Di,s as un,t as ci,F as vt,u as Qn,o as ys,i as yt,T as Ai,Z as sn,v as an,j as ft,w as bs,d as ws,x as hn,l as vn,y as Tn,p as Ti,z as Ss}from"./PropertiesForm.c69fa44e.js";import{b as tt,e as ut,m as bn}from"./LineKit.f6b732de.js";import{m as qn,S as Jn}from"./SvgWithPanZoomState.e2089103.js";import{S as er}from"./StandardBorderLandscapeDoc.be2b9e86.js";import{L as Ps}from"./Labeler.42ece7e8.js";import{a as Si,o as Ns,L as Ms}from"./LockerShed.98091ec0.js";import{W as Nr,S as bl,M as Cs}from"./MezzanineFloor.5f8c35cf.js";import{P as Kt}from"./Plane3D.472a05fa.js";import{R as Hi}from"./Ray3D.5e4c723f.js";import{G as vs}from"./GableTruss.fea81d7b.js";import{C as tr,T as Ts}from"./Transform2D.200bb15c.js";import{H as ks}from"./HexagonalFirePit.41ea653b.js";import{O as zs}from"./OpenWebColumnRafterSection.d2fefac8.js";import{P as ni,L as $e}from"./Line2D.139781b3.js";import{C as $i,P as Yt,F as Mr}from"./Fascia.ecb69f90.js";import{L as Ki}from"./Line3D.2b8117f1.js";import{W as As}from"./WeldedUBColumnRafterSection.79a51e85.js";function xs(C,e=!1){const n=C[0].index!==null,r=new Set(Object.keys(C[0].attributes)),o=new Set(Object.keys(C[0].morphAttributes)),l={},s={},a=C[0].morphTargetsRelative,h=new Xt;let d=0;for(let c=0;c<C.length;++c){const u=C[c];let S=0;if(n!==(u.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const b in u.attributes){if(!r.has(b))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+b+'" attribute exists among all geometries, or in none of them.'),null;l[b]===void 0&&(l[b]=[]),l[b].push(u.attributes[b]),S++}if(S!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(a!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const b in u.morphAttributes){if(!o.has(b))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;s[b]===void 0&&(s[b]=[]),s[b].push(u.morphAttributes[b])}if(e){let b;if(n)b=u.index.count;else if(u.attributes.position!==void 0)b=u.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;h.addGroup(d,b,c),d+=b}}if(n){let c=0;const u=[];for(let S=0;S<C.length;++S){const b=C[S].index;for(let N=0;N<b.count;++N)u.push(b.getX(N)+c);c+=C[S].attributes.position.count}h.setIndex(u)}for(const c in l){const u=Cr(l[c]);if(!u)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" attribute."),null;h.setAttribute(c,u)}for(const c in s){const u=s[c][0].length;if(u===0)break;h.morphAttributes=h.morphAttributes||{},h.morphAttributes[c]=[];for(let S=0;S<u;++S){const b=[];for(let w=0;w<s[c].length;++w)b.push(s[c][w][S]);const N=Cr(b);if(!N)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" morphAttribute."),null;h.morphAttributes[c].push(N)}}return h}function Cr(C){let e,n,r,o=-1,l=0;for(let d=0;d<C.length;++d){const c=C[d];if(c.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(n===void 0&&(n=c.itemSize),n!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=c.normalized),r!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(o===-1&&(o=c.gpuType),o!==c.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;l+=c.array.length}const s=new e(l);let a=0;for(let d=0;d<C.length;++d)s.set(C[d].array,a),a+=C[d].array.length;const h=new di(s,n,r);return o!==void 0&&(h.gpuType=o),h}function vr(C,e){if(e===xo)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),C;if(e===Vn||e===dl){let n=C.getIndex();if(n===null){const s=[],a=C.getAttribute("position");if(a!==void 0){for(let h=0;h<a.count;h++)s.push(h);C.setIndex(s),n=C.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),C}const r=n.count-2,o=[];if(e===Vn)for(let s=1;s<=r;s++)o.push(n.getX(0)),o.push(n.getX(s)),o.push(n.getX(s+1));else for(let s=0;s<r;s++)s%2===0?(o.push(n.getX(s)),o.push(n.getX(s+1)),o.push(n.getX(s+2))):(o.push(n.getX(s+2)),o.push(n.getX(s+1)),o.push(n.getX(s)));o.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const l=C.clone();return l.setIndex(o),l.clearGroups(),l}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),C}function ir(C,e=!1){return console.warn("THREE.BufferGeometryUtils: mergeBufferGeometries() has been renamed to mergeGeometries()."),xs(C,e)}class Is extends Zn{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new Ls(n)}),this.register(function(n){return new _s(n)}),this.register(function(n){return new Ys(n)}),this.register(function(n){return new Gs(n)}),this.register(function(n){return new Es(n)}),this.register(function(n){return new Us(n)}),this.register(function(n){return new Rs(n)}),this.register(function(n){return new Ws(n)}),this.register(function(n){return new Vs(n)}),this.register(function(n){return new Xs(n)}),this.register(function(n){return new Hs(n)}),this.register(function(n){return new Ds(n)}),this.register(function(n){return new Os(n)}),this.register(function(n){return new Zs(n)}),this.register(function(n){return new $s(n)})}load(e,n,r,o){const l=this;let s;this.resourcePath!==""?s=this.resourcePath:this.path!==""?s=this.path:s=Ln.extractUrlBase(e),this.manager.itemStart(e);const a=function(d){o?o(d):console.error(d),l.manager.itemError(e),l.manager.itemEnd(e)},h=new gn(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(e,function(d){try{l.parse(d,s,function(c){n(c),l.manager.itemEnd(e)},a)}catch(c){a(c)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,r,o){let l;const s={},a={},h=new TextDecoder;if(typeof e=="string")l=JSON.parse(e);else if(e instanceof ArrayBuffer)if(h.decode(new Uint8Array(e,0,4))===wl){try{s[_e.KHR_BINARY_GLTF]=new Ks(e)}catch(u){o&&o(u);return}l=JSON.parse(s[_e.KHR_BINARY_GLTF].content)}else l=JSON.parse(h.decode(e));else l=e;if(l.asset===void 0||l.asset.version[0]<2){o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const d=new aa(l,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const u=this.pluginCallbacks[c](d);a[u.name]=u,s[u.name]=!0}if(l.extensionsUsed)for(let c=0;c<l.extensionsUsed.length;++c){const u=l.extensionsUsed[c],S=l.extensionsRequired||[];switch(u){case _e.KHR_MATERIALS_UNLIT:s[u]=new Fs;break;case _e.KHR_DRACO_MESH_COMPRESSION:s[u]=new js(l,this.dracoLoader);break;case _e.KHR_TEXTURE_TRANSFORM:s[u]=new Qs;break;case _e.KHR_MESH_QUANTIZATION:s[u]=new qs;break;default:S.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}d.setExtensions(s),d.setPlugins(a),d.parse(r,o)}parseAsync(e,n){const r=this;return new Promise(function(o,l){r.parse(e,n,o,l)})}}function Bs(){let C={};return{get:function(e){return C[e]},add:function(e,n){C[e]=n},remove:function(e){delete C[e]},removeAll:function(){C={}}}}const _e={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Os{constructor(e){this.parser=e,this.name=_e.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let r=0,o=n.length;r<o;r++){const l=n[r];l.extensions&&l.extensions[this.name]&&l.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,l.extensions[this.name].light)}}_loadLight(e){const n=this.parser,r="light:"+e;let o=n.cache.get(r);if(o)return o;const l=n.json,h=((l.extensions&&l.extensions[this.name]||{}).lights||[])[e];let d;const c=new Pi(16777215);h.color!==void 0&&c.fromArray(h.color);const u=h.range!==void 0?h.range:0;switch(h.type){case"directional":d=new Oo(c),d.target.position.set(0,0,-1),d.add(d.target);break;case"point":d=new Bo(c),d.distance=u;break;case"spot":d=new Io(c),d.distance=u,h.spot=h.spot||{},h.spot.innerConeAngle=h.spot.innerConeAngle!==void 0?h.spot.innerConeAngle:0,h.spot.outerConeAngle=h.spot.outerConeAngle!==void 0?h.spot.outerConeAngle:Math.PI/4,d.angle=h.spot.outerConeAngle,d.penumbra=1-h.spot.innerConeAngle/h.spot.outerConeAngle,d.target.position.set(0,0,-1),d.add(d.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+h.type)}return d.position.set(0,0,0),d.decay=2,ai(d,h),h.intensity!==void 0&&(d.intensity=h.intensity),d.name=n.createUniqueName(h.name||"light_"+e),o=Promise.resolve(d),n.cache.add(r,o),o}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,r=this.parser,l=r.json.nodes[e],a=(l.extensions&&l.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(h){return r._getNodeRef(n.cache,a,h)})}}class Fs{constructor(){this.name=_e.KHR_MATERIALS_UNLIT}getMaterialType(){return xt}extendParams(e,n,r){const o=[];e.color=new Pi(1,1,1),e.opacity=1;const l=n.pbrMetallicRoughness;if(l){if(Array.isArray(l.baseColorFactor)){const s=l.baseColorFactor;e.color.fromArray(s),e.opacity=s[3]}l.baseColorTexture!==void 0&&o.push(r.assignTexture(e,"map",l.baseColorTexture,Ii))}return Promise.all(o)}}class Vs{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=o.extensions[this.name].emissiveStrength;return l!==void 0&&(n.emissiveIntensity=l),Promise.resolve()}}class Ls{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:ui}extendMaterialParams(e,n){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],s=o.extensions[this.name];if(s.clearcoatFactor!==void 0&&(n.clearcoat=s.clearcoatFactor),s.clearcoatTexture!==void 0&&l.push(r.assignTexture(n,"clearcoatMap",s.clearcoatTexture)),s.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=s.clearcoatRoughnessFactor),s.clearcoatRoughnessTexture!==void 0&&l.push(r.assignTexture(n,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),s.clearcoatNormalTexture!==void 0&&(l.push(r.assignTexture(n,"clearcoatNormalMap",s.clearcoatNormalTexture)),s.clearcoatNormalTexture.scale!==void 0)){const a=s.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new De(a,a)}return Promise.all(l)}}class Hs{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:ui}extendMaterialParams(e,n){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],s=o.extensions[this.name];return s.iridescenceFactor!==void 0&&(n.iridescence=s.iridescenceFactor),s.iridescenceTexture!==void 0&&l.push(r.assignTexture(n,"iridescenceMap",s.iridescenceTexture)),s.iridescenceIor!==void 0&&(n.iridescenceIOR=s.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),s.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),s.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),s.iridescenceThicknessTexture!==void 0&&l.push(r.assignTexture(n,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(l)}}class Es{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:ui}extendMaterialParams(e,n){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[];n.sheenColor=new Pi(0,0,0),n.sheenRoughness=0,n.sheen=1;const s=o.extensions[this.name];return s.sheenColorFactor!==void 0&&n.sheenColor.fromArray(s.sheenColorFactor),s.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=s.sheenRoughnessFactor),s.sheenColorTexture!==void 0&&l.push(r.assignTexture(n,"sheenColorMap",s.sheenColorTexture,Ii)),s.sheenRoughnessTexture!==void 0&&l.push(r.assignTexture(n,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(l)}}class Us{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:ui}extendMaterialParams(e,n){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],s=o.extensions[this.name];return s.transmissionFactor!==void 0&&(n.transmission=s.transmissionFactor),s.transmissionTexture!==void 0&&l.push(r.assignTexture(n,"transmissionMap",s.transmissionTexture)),Promise.all(l)}}class Rs{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:ui}extendMaterialParams(e,n){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],s=o.extensions[this.name];n.thickness=s.thicknessFactor!==void 0?s.thicknessFactor:0,s.thicknessTexture!==void 0&&l.push(r.assignTexture(n,"thicknessMap",s.thicknessTexture)),n.attenuationDistance=s.attenuationDistance||1/0;const a=s.attenuationColor||[1,1,1];return n.attenuationColor=new Pi(a[0],a[1],a[2]),Promise.all(l)}}class Ws{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:ui}extendMaterialParams(e,n){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=o.extensions[this.name];return n.ior=l.ior!==void 0?l.ior:1.5,Promise.resolve()}}class Xs{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:ui}extendMaterialParams(e,n){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],s=o.extensions[this.name];n.specularIntensity=s.specularFactor!==void 0?s.specularFactor:1,s.specularTexture!==void 0&&l.push(r.assignTexture(n,"specularIntensityMap",s.specularTexture));const a=s.specularColorFactor||[1,1,1];return n.specularColor=new Pi(a[0],a[1],a[2]),s.specularColorTexture!==void 0&&l.push(r.assignTexture(n,"specularColorMap",s.specularColorTexture,Ii)),Promise.all(l)}}class Ds{constructor(e){this.parser=e,this.name=_e.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:ui}extendMaterialParams(e,n){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],s=o.extensions[this.name];return s.anisotropyStrength!==void 0&&(n.anisotropy=s.anisotropyStrength),s.anisotropyRotation!==void 0&&(n.anisotropyRotation=s.anisotropyRotation),s.anisotropyTexture!==void 0&&l.push(r.assignTexture(n,"anisotropyMap",s.anisotropyTexture)),Promise.all(l)}}class _s{constructor(e){this.parser=e,this.name=_e.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[this.name])return null;const l=o.extensions[this.name],s=n.options.ktx2Loader;if(!s){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,l.source,s)}}class Ys{constructor(e){this.parser=e,this.name=_e.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,o=r.json,l=o.textures[e];if(!l.extensions||!l.extensions[n])return null;const s=l.extensions[n],a=o.images[s.source];let h=r.textureLoader;if(a.uri){const d=r.options.manager.getHandler(a.uri);d!==null&&(h=d)}return this.detectSupport().then(function(d){if(d)return r.loadTextureImage(e,s.source,h);if(o.extensionsRequired&&o.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Gs{constructor(e){this.parser=e,this.name=_e.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,r=this.parser,o=r.json,l=o.textures[e];if(!l.extensions||!l.extensions[n])return null;const s=l.extensions[n],a=o.images[s.source];let h=r.textureLoader;if(a.uri){const d=r.options.manager.getHandler(a.uri);d!==null&&(h=d)}return this.detectSupport().then(function(d){if(d)return r.loadTextureImage(e,s.source,h);if(o.extensionsRequired&&o.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Zs{constructor(e){this.name=_e.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,r=n.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const o=r.extensions[this.name],l=this.parser.getDependency("buffer",o.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return l.then(function(a){const h=o.byteOffset||0,d=o.byteLength||0,c=o.count,u=o.byteStride,S=new Uint8Array(a,h,d);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(c,u,S,o.mode,o.filter).then(function(b){return b.buffer}):s.ready.then(function(){const b=new ArrayBuffer(c*u);return s.decodeGltfBuffer(new Uint8Array(b),c,u,S,o.mode,o.filter),b})})}else return null}}class $s{constructor(e){this.name=_e.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,r=n.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const o=n.meshes[r.mesh];for(const d of o.primitives)if(d.mode!==Rt.TRIANGLES&&d.mode!==Rt.TRIANGLE_STRIP&&d.mode!==Rt.TRIANGLE_FAN&&d.mode!==void 0)return null;const s=r.extensions[this.name].attributes,a=[],h={};for(const d in s)a.push(this.parser.getDependency("accessor",s[d]).then(c=>(h[d]=c,h[d])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(d=>{const c=d.pop(),u=c.isGroup?c.children:[c],S=d[0].count,b=[];for(const N of u){const w=new Xi,p=new je,g=new Kn,P=new je(1,1,1),M=new Fo(N.geometry,N.material,S);for(let v=0;v<S;v++)h.TRANSLATION&&p.fromBufferAttribute(h.TRANSLATION,v),h.ROTATION&&g.fromBufferAttribute(h.ROTATION,v),h.SCALE&&P.fromBufferAttribute(h.SCALE,v),M.setMatrixAt(v,w.compose(p,g,P));for(const v in h)v!=="TRANSLATION"&&v!=="ROTATION"&&v!=="SCALE"&&N.geometry.setAttribute(v,h[v]);ul.prototype.copy.call(M,N),this.parser.assignFinalMaterial(M),b.push(M)}return c.isGroup?(c.clear(),c.add(...b),c):b[0]}))}}const wl="glTF",Oi=12,Tr={JSON:1313821514,BIN:5130562};class Ks{constructor(e){this.name=_e.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,Oi),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==wl)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const o=this.header.length-Oi,l=new DataView(e,Oi);let s=0;for(;s<o;){const a=l.getUint32(s,!0);s+=4;const h=l.getUint32(s,!0);if(s+=4,h===Tr.JSON){const d=new Uint8Array(e,Oi+s,a);this.content=r.decode(d)}else if(h===Tr.BIN){const d=Oi+s;this.body=e.slice(d,d+a)}s+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class js{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=_e.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const r=this.json,o=this.dracoLoader,l=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},h={},d={};for(const c in s){const u=Rn[c]||c.toLowerCase();a[u]=s[c]}for(const c in e.attributes){const u=Rn[c]||c.toLowerCase();if(s[c]!==void 0){const S=r.accessors[e.attributes[c]],b=xi[S.componentType];d[u]=b.name,h[u]=S.normalized===!0}}return n.getDependency("bufferView",l).then(function(c){return new Promise(function(u){o.decodeDracoFile(c,function(S){for(const b in S.attributes){const N=S.attributes[b],w=h[b];w!==void 0&&(N.normalized=w)}u(S)},a,d)})})}}class Qs{constructor(){this.name=_e.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class qs{constructor(){this.name=_e.KHR_MESH_QUANTIZATION}}class Sl extends os{constructor(e,n,r,o){super(e,n,r,o)}copySampleValue_(e){const n=this.resultBuffer,r=this.sampleValues,o=this.valueSize,l=e*o*3+o;for(let s=0;s!==o;s++)n[s]=r[l+s];return n}interpolate_(e,n,r,o){const l=this.resultBuffer,s=this.sampleValues,a=this.valueSize,h=a*2,d=a*3,c=o-n,u=(r-n)/c,S=u*u,b=S*u,N=e*d,w=N-d,p=-2*b+3*S,g=b-S,P=1-p,M=g-S+u;for(let v=0;v!==a;v++){const k=s[w+v+a],z=s[w+v+h]*c,x=s[N+v+a],A=s[N+v]*c;l[v]=P*k+M*z+p*x+g*A}return l}}const Js=new Kn;class ea extends Sl{interpolate_(e,n,r,o){const l=super.interpolate_(e,n,r,o);return Js.fromArray(l).normalize().toArray(l),l}}const Rt={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},xi={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},kr={9728:Ko,9729:pl,9984:jo,9985:Qo,9986:qo,9987:ml},zr={33071:Jo,33648:es,10497:Hn},kn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Rn={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ri={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ta={CUBICSPLINE:void 0,LINEAR:gl,STEP:ts},zn={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ia(C){return C.DefaultMaterial===void 0&&(C.DefaultMaterial=new rt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:is})),C.DefaultMaterial}function gi(C,e,n){for(const r in n.extensions)C[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function ai(C,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(C.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function na(C,e,n){let r=!1,o=!1,l=!1;for(let d=0,c=e.length;d<c;d++){const u=e[d];if(u.POSITION!==void 0&&(r=!0),u.NORMAL!==void 0&&(o=!0),u.COLOR_0!==void 0&&(l=!0),r&&o&&l)break}if(!r&&!o&&!l)return Promise.resolve(C);const s=[],a=[],h=[];for(let d=0,c=e.length;d<c;d++){const u=e[d];if(r){const S=u.POSITION!==void 0?n.getDependency("accessor",u.POSITION):C.attributes.position;s.push(S)}if(o){const S=u.NORMAL!==void 0?n.getDependency("accessor",u.NORMAL):C.attributes.normal;a.push(S)}if(l){const S=u.COLOR_0!==void 0?n.getDependency("accessor",u.COLOR_0):C.attributes.color;h.push(S)}}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(h)]).then(function(d){const c=d[0],u=d[1],S=d[2];return r&&(C.morphAttributes.position=c),o&&(C.morphAttributes.normal=u),l&&(C.morphAttributes.color=S),C.morphTargetsRelative=!0,C})}function ra(C,e){if(C.updateMorphTargets(),e.weights!==void 0)for(let n=0,r=e.weights.length;n<r;n++)C.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(C.morphTargetInfluences.length===n.length){C.morphTargetDictionary={};for(let r=0,o=n.length;r<o;r++)C.morphTargetDictionary[n[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function la(C){let e;const n=C.extensions&&C.extensions[_e.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+An(n.attributes):e=C.indices+":"+An(C.attributes)+":"+C.mode,C.targets!==void 0)for(let r=0,o=C.targets.length;r<o;r++)e+=":"+An(C.targets[r]);return e}function An(C){let e="";const n=Object.keys(C).sort();for(let r=0,o=n.length;r<o;r++)e+=n[r]+":"+C[n[r]]+";";return e}function Wn(C){switch(C){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function oa(C){return C.search(/\.jpe?g($|\?)/i)>0||C.search(/^data\:image\/jpeg/)===0?"image/jpeg":C.search(/\.webp($|\?)/i)>0||C.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const sa=new Xi;class aa{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new Bs,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,o=!1,l=-1;typeof navigator<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,o=navigator.userAgent.indexOf("Firefox")>-1,l=o?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||o&&l<98?this.textureLoader=new fl(this.options.manager):this.textureLoader=new Vo(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new gn(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const r=this,o=this.json,l=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(s){const a={scene:s[0][o.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:o.asset,parser:r,userData:{}};gi(l,a,o),ai(a,o),Promise.all(r._invokeAll(function(h){return h.afterRoot&&h.afterRoot(a)})).then(function(){e(a)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],r=this.json.meshes||[];for(let o=0,l=n.length;o<l;o++){const s=n[o].joints;for(let a=0,h=s.length;a<h;a++)e[s[a]].isBone=!0}for(let o=0,l=e.length;o<l;o++){const s=e[o];s.mesh!==void 0&&(this._addNodeRef(this.meshCache,s.mesh),s.skin!==void 0&&(r[s.mesh].isSkinnedMesh=!0)),s.camera!==void 0&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,r){if(e.refs[n]<=1)return r;const o=r.clone(),l=(s,a)=>{const h=this.associations.get(s);h!=null&&this.associations.set(a,h);for(const[d,c]of s.children.entries())l(c,a.children[d])};return l(r,o),o.name+="_instance_"+e.uses[n]++,o}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let r=0;r<n.length;r++){const o=e(n[r]);if(o)return o}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const r=[];for(let o=0;o<n.length;o++){const l=e(n[o]);l&&r.push(l)}return r}getDependency(e,n){const r=e+":"+n;let o=this.cache.get(r);if(!o){switch(e){case"scene":o=this.loadScene(n);break;case"node":o=this._invokeOne(function(l){return l.loadNode&&l.loadNode(n)});break;case"mesh":o=this._invokeOne(function(l){return l.loadMesh&&l.loadMesh(n)});break;case"accessor":o=this.loadAccessor(n);break;case"bufferView":o=this._invokeOne(function(l){return l.loadBufferView&&l.loadBufferView(n)});break;case"buffer":o=this.loadBuffer(n);break;case"material":o=this._invokeOne(function(l){return l.loadMaterial&&l.loadMaterial(n)});break;case"texture":o=this._invokeOne(function(l){return l.loadTexture&&l.loadTexture(n)});break;case"skin":o=this.loadSkin(n);break;case"animation":o=this._invokeOne(function(l){return l.loadAnimation&&l.loadAnimation(n)});break;case"camera":o=this.loadCamera(n);break;default:if(o=this._invokeOne(function(l){return l!=this&&l.getDependency&&l.getDependency(e,n)}),!o)throw new Error("Unknown type: "+e);break}this.cache.add(r,o)}return o}getDependencies(e){let n=this.cache.get(e);if(!n){const r=this,o=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(o.map(function(l,s){return r.getDependency(e,s)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],r=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[_e.KHR_BINARY_GLTF].body);const o=this.options;return new Promise(function(l,s){r.load(Ln.resolveURL(n.uri,o.path),l,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(r){const o=n.byteLength||0,l=n.byteOffset||0;return r.slice(l,l+o)})}loadAccessor(e){const n=this,r=this.json,o=this.json.accessors[e];if(o.bufferView===void 0&&o.sparse===void 0){const s=kn[o.type],a=xi[o.componentType],h=o.normalized===!0,d=new a(o.count*s);return Promise.resolve(new di(d,s,h))}const l=[];return o.bufferView!==void 0?l.push(this.getDependency("bufferView",o.bufferView)):l.push(null),o.sparse!==void 0&&(l.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),l.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(l).then(function(s){const a=s[0],h=kn[o.type],d=xi[o.componentType],c=d.BYTES_PER_ELEMENT,u=c*h,S=o.byteOffset||0,b=o.bufferView!==void 0?r.bufferViews[o.bufferView].byteStride:void 0,N=o.normalized===!0;let w,p;if(b&&b!==u){const g=Math.floor(S/b),P="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+g+":"+o.count;let M=n.cache.get(P);M||(w=new d(a,g*b,o.count*b/c),M=new Lo(w,b/c),n.cache.add(P,M)),p=new ns(M,h,S%b/c,N)}else a===null?w=new d(o.count*h):w=new d(a,S,o.count*h),p=new di(w,h,N);if(o.sparse!==void 0){const g=kn.SCALAR,P=xi[o.sparse.indices.componentType],M=o.sparse.indices.byteOffset||0,v=o.sparse.values.byteOffset||0,k=new P(s[1],M,o.sparse.count*g),z=new d(s[2],v,o.sparse.count*h);a!==null&&(p=new di(p.array.slice(),p.itemSize,p.normalized));for(let x=0,A=k.length;x<A;x++){const I=k[x];if(p.setX(I,z[x*h]),h>=2&&p.setY(I,z[x*h+1]),h>=3&&p.setZ(I,z[x*h+2]),h>=4&&p.setW(I,z[x*h+3]),h>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p})}loadTexture(e){const n=this.json,r=this.options,l=n.textures[e].source,s=n.images[l];let a=this.textureLoader;if(s.uri){const h=r.manager.getHandler(s.uri);h!==null&&(a=h)}return this.loadTextureImage(e,l,a)}loadTextureImage(e,n,r){const o=this,l=this.json,s=l.textures[e],a=l.images[n],h=(a.uri||a.bufferView)+":"+s.sampler;if(this.textureCache[h])return this.textureCache[h];const d=this.loadImageSource(n,r).then(function(c){c.flipY=!1,c.name=s.name||a.name||"",c.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(c.name=a.uri);const S=(l.samplers||{})[s.sampler]||{};return c.magFilter=kr[S.magFilter]||pl,c.minFilter=kr[S.minFilter]||ml,c.wrapS=zr[S.wrapS]||Hn,c.wrapT=zr[S.wrapT]||Hn,o.associations.set(c,{textures:e}),c}).catch(function(){return null});return this.textureCache[h]=d,d}loadImageSource(e,n){const r=this,o=this.json,l=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());const s=o.images[e],a=self.URL||self.webkitURL;let h=s.uri||"",d=!1;if(s.bufferView!==void 0)h=r.getDependency("bufferView",s.bufferView).then(function(u){d=!0;const S=new Blob([u],{type:s.mimeType});return h=a.createObjectURL(S),h});else if(s.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(h).then(function(u){return new Promise(function(S,b){let N=S;n.isImageBitmapLoader===!0&&(N=function(w){const p=new yr(w);p.needsUpdate=!0,S(p)}),n.load(Ln.resolveURL(u,l.path),N,void 0,b)})}).then(function(u){return d===!0&&a.revokeObjectURL(h),u.userData.mimeType=s.mimeType||oa(s.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",h),u});return this.sourceCache[e]=c,c}assignTexture(e,n,r,o){const l=this;return this.getDependency("texture",r.index).then(function(s){if(!s)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(s=s.clone(),s.channel=r.texCoord),l.extensions[_e.KHR_TEXTURE_TRANSFORM]){const a=r.extensions!==void 0?r.extensions[_e.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const h=l.associations.get(s);s=l.extensions[_e.KHR_TEXTURE_TRANSFORM].extendTexture(s,a),l.associations.set(s,h)}}return o!==void 0&&(s.colorSpace=o),e[n]=s,s})}assignFinalMaterial(e){const n=e.geometry;let r=e.material;const o=n.attributes.tangent===void 0,l=n.attributes.color!==void 0,s=n.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+r.uuid;let h=this.cache.get(a);h||(h=new Ho,Nn.prototype.copy.call(h,r),h.color.copy(r.color),h.map=r.map,h.sizeAttenuation=!1,this.cache.add(a,h)),r=h}else if(e.isLine){const a="LineBasicMaterial:"+r.uuid;let h=this.cache.get(a);h||(h=new Tt,Nn.prototype.copy.call(h,r),h.color.copy(r.color),h.map=r.map,this.cache.add(a,h)),r=h}if(o||l||s){let a="ClonedMaterial:"+r.uuid+":";o&&(a+="derivative-tangents:"),l&&(a+="vertex-colors:"),s&&(a+="flat-shading:");let h=this.cache.get(a);h||(h=r.clone(),l&&(h.vertexColors=!0),s&&(h.flatShading=!0),o&&(h.normalScale&&(h.normalScale.y*=-1),h.clearcoatNormalScale&&(h.clearcoatNormalScale.y*=-1)),this.cache.add(a,h),this.associations.set(h,this.associations.get(r))),r=h}e.material=r}getMaterialType(){return rt}loadMaterial(e){const n=this,r=this.json,o=this.extensions,l=r.materials[e];let s;const a={},h=l.extensions||{},d=[];if(h[_e.KHR_MATERIALS_UNLIT]){const u=o[_e.KHR_MATERIALS_UNLIT];s=u.getMaterialType(),d.push(u.extendParams(a,l,n))}else{const u=l.pbrMetallicRoughness||{};if(a.color=new Pi(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){const S=u.baseColorFactor;a.color.fromArray(S),a.opacity=S[3]}u.baseColorTexture!==void 0&&d.push(n.assignTexture(a,"map",u.baseColorTexture,Ii)),a.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,a.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(d.push(n.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),d.push(n.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),s=this._invokeOne(function(S){return S.getMaterialType&&S.getMaterialType(e)}),d.push(Promise.all(this._invokeAll(function(S){return S.extendMaterialParams&&S.extendMaterialParams(e,a)})))}l.doubleSided===!0&&(a.side=$n);const c=l.alphaMode||zn.OPAQUE;if(c===zn.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,c===zn.MASK&&(a.alphaTest=l.alphaCutoff!==void 0?l.alphaCutoff:.5)),l.normalTexture!==void 0&&s!==xt&&(d.push(n.assignTexture(a,"normalMap",l.normalTexture)),a.normalScale=new De(1,1),l.normalTexture.scale!==void 0)){const u=l.normalTexture.scale;a.normalScale.set(u,u)}return l.occlusionTexture!==void 0&&s!==xt&&(d.push(n.assignTexture(a,"aoMap",l.occlusionTexture)),l.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=l.occlusionTexture.strength)),l.emissiveFactor!==void 0&&s!==xt&&(a.emissive=new Pi().fromArray(l.emissiveFactor)),l.emissiveTexture!==void 0&&s!==xt&&d.push(n.assignTexture(a,"emissiveMap",l.emissiveTexture,Ii)),Promise.all(d).then(function(){const u=new s(a);return l.name&&(u.name=l.name),ai(u,l),n.associations.set(u,{materials:e}),l.extensions&&gi(o,u,l),u})}createUniqueName(e){const n=Eo.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,r=this.extensions,o=this.primitiveCache;function l(a){return r[_e.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,n).then(function(h){return Ar(h,a,n)})}const s=[];for(let a=0,h=e.length;a<h;a++){const d=e[a],c=la(d),u=o[c];if(u)s.push(u.promise);else{let S;d.extensions&&d.extensions[_e.KHR_DRACO_MESH_COMPRESSION]?S=l(d):S=Ar(new Xt,d,n),o[c]={primitive:d,promise:S},s.push(S)}}return Promise.all(s)}loadMesh(e){const n=this,r=this.json,o=this.extensions,l=r.meshes[e],s=l.primitives,a=[];for(let h=0,d=s.length;h<d;h++){const c=s[h].material===void 0?ia(this.cache):this.getDependency("material",s[h].material);a.push(c)}return a.push(n.loadGeometries(s)),Promise.all(a).then(function(h){const d=h.slice(0,h.length-1),c=h[h.length-1],u=[];for(let b=0,N=c.length;b<N;b++){const w=c[b],p=s[b];let g;const P=d[b];if(p.mode===Rt.TRIANGLES||p.mode===Rt.TRIANGLE_STRIP||p.mode===Rt.TRIANGLE_FAN||p.mode===void 0)g=l.isSkinnedMesh===!0?new Uo(w,P):new xe(w,P),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),p.mode===Rt.TRIANGLE_STRIP?g.geometry=vr(g.geometry,dl):p.mode===Rt.TRIANGLE_FAN&&(g.geometry=vr(g.geometry,Vn));else if(p.mode===Rt.LINES)g=new ht(w,P);else if(p.mode===Rt.LINE_STRIP)g=new Ro(w,P);else if(p.mode===Rt.LINE_LOOP)g=new Wo(w,P);else if(p.mode===Rt.POINTS)g=new Xo(w,P);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);Object.keys(g.geometry.morphAttributes).length>0&&ra(g,l),g.name=n.createUniqueName(l.name||"mesh_"+e),ai(g,l),p.extensions&&gi(o,g,p),n.assignFinalMaterial(g),u.push(g)}for(let b=0,N=u.length;b<N;b++)n.associations.set(u[b],{meshes:e,primitives:b});if(u.length===1)return l.extensions&&gi(o,u[0],l),u[0];const S=new nt;l.extensions&&gi(o,S,l),n.associations.set(S,{meshes:e});for(let b=0,N=u.length;b<N;b++)S.add(u[b]);return S})}loadCamera(e){let n;const r=this.json.cameras[e],o=r[r.type];if(!o){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?n=new Do(_o.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):r.type==="orthographic"&&(n=new Yo(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),r.name&&(n.name=this.createUniqueName(r.name)),ai(n,r),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],r=[];for(let o=0,l=n.joints.length;o<l;o++)r.push(this._loadNodeShallow(n.joints[o]));return n.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",n.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(o){const l=o.pop(),s=o,a=[],h=[];for(let d=0,c=s.length;d<c;d++){const u=s[d];if(u){a.push(u);const S=new Xi;l!==null&&S.fromArray(l.array,d*16),h.push(S)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[d])}return new Go(a,h)})}loadAnimation(e){const n=this.json,r=this,o=n.animations[e],l=o.name?o.name:"animation_"+e,s=[],a=[],h=[],d=[],c=[];for(let u=0,S=o.channels.length;u<S;u++){const b=o.channels[u],N=o.samplers[b.sampler],w=b.target,p=w.node,g=o.parameters!==void 0?o.parameters[N.input]:N.input,P=o.parameters!==void 0?o.parameters[N.output]:N.output;w.node!==void 0&&(s.push(this.getDependency("node",p)),a.push(this.getDependency("accessor",g)),h.push(this.getDependency("accessor",P)),d.push(N),c.push(w))}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(h),Promise.all(d),Promise.all(c)]).then(function(u){const S=u[0],b=u[1],N=u[2],w=u[3],p=u[4],g=[];for(let P=0,M=S.length;P<M;P++){const v=S[P],k=b[P],z=N[P],x=w[P],A=p[P];if(v===void 0)continue;v.updateMatrix&&v.updateMatrix();const I=r._createAnimationTracks(v,k,z,x,A);if(I)for(let O=0;O<I.length;O++)g.push(I[O])}return new Zo(l,void 0,g)})}createNodeMesh(e){const n=this.json,r=this,o=n.nodes[e];return o.mesh===void 0?null:r.getDependency("mesh",o.mesh).then(function(l){const s=r._getNodeRef(r.meshCache,o.mesh,l);return o.weights!==void 0&&s.traverse(function(a){if(!!a.isMesh)for(let h=0,d=o.weights.length;h<d;h++)a.morphTargetInfluences[h]=o.weights[h]}),s})}loadNode(e){const n=this.json,r=this,o=n.nodes[e],l=r._loadNodeShallow(e),s=[],a=o.children||[];for(let d=0,c=a.length;d<c;d++)s.push(r.getDependency("node",a[d]));const h=o.skin===void 0?Promise.resolve(null):r.getDependency("skin",o.skin);return Promise.all([l,Promise.all(s),h]).then(function(d){const c=d[0],u=d[1],S=d[2];S!==null&&c.traverse(function(b){!b.isSkinnedMesh||b.bind(S,sa)});for(let b=0,N=u.length;b<N;b++)c.add(u[b]);return c})}_loadNodeShallow(e){const n=this.json,r=this.extensions,o=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const l=n.nodes[e],s=l.name?o.createUniqueName(l.name):"",a=[],h=o._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});return h&&a.push(h),l.camera!==void 0&&a.push(o.getDependency("camera",l.camera).then(function(d){return o._getNodeRef(o.cameraCache,l.camera,d)})),o._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){a.push(d)}),this.nodeCache[e]=Promise.all(a).then(function(d){let c;if(l.isBone===!0?c=new $o:d.length>1?c=new nt:d.length===1?c=d[0]:c=new ul,c!==d[0])for(let u=0,S=d.length;u<S;u++)c.add(d[u]);if(l.name&&(c.userData.name=l.name,c.name=s),ai(c,l),l.extensions&&gi(r,c,l),l.matrix!==void 0){const u=new Xi;u.fromArray(l.matrix),c.applyMatrix4(u)}else l.translation!==void 0&&c.position.fromArray(l.translation),l.rotation!==void 0&&c.quaternion.fromArray(l.rotation),l.scale!==void 0&&c.scale.fromArray(l.scale);return o.associations.has(c)||o.associations.set(c,{}),o.associations.get(c).nodes=e,c}),this.nodeCache[e]}loadScene(e){const n=this.extensions,r=this.json.scenes[e],o=this,l=new nt;r.name&&(l.name=o.createUniqueName(r.name)),ai(l,r),r.extensions&&gi(n,l,r);const s=r.nodes||[],a=[];for(let h=0,d=s.length;h<d;h++)a.push(o.getDependency("node",s[h]));return Promise.all(a).then(function(h){for(let c=0,u=h.length;c<u;c++)l.add(h[c]);const d=c=>{const u=new Map;for(const[S,b]of o.associations)(S instanceof Nn||S instanceof yr)&&u.set(S,b);return c.traverse(S=>{const b=o.associations.get(S);b!=null&&u.set(S,b)}),u};return o.associations=d(l),l})}_createAnimationTracks(e,n,r,o,l){const s=[],a=e.name?e.name:e.uuid,h=[];ri[l.path]===ri.weights?e.traverse(function(S){S.morphTargetInfluences&&h.push(S.name?S.name:S.uuid)}):h.push(a);let d;switch(ri[l.path]){case ri.weights:d=wr;break;case ri.rotation:d=Sr;break;case ri.position:case ri.scale:d=br;break;default:switch(r.itemSize){case 1:d=wr;break;case 2:case 3:default:d=br;break}break}const c=o.interpolation!==void 0?ta[o.interpolation]:gl,u=this._getArrayFromAccessor(r);for(let S=0,b=h.length;S<b;S++){const N=new d(h[S]+"."+ri[l.path],n.array,u,c);o.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(N),s.push(N)}return s}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const r=Wn(n.constructor),o=new Float32Array(n.length);for(let l=0,s=n.length;l<s;l++)o[l]=n[l]*r;n=o}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const o=this instanceof Sr?ea:Sl;return new o(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function ha(C,e,n){const r=e.attributes,o=new rs;if(r.POSITION!==void 0){const a=n.json.accessors[r.POSITION],h=a.min,d=a.max;if(h!==void 0&&d!==void 0){if(o.set(new je(h[0],h[1],h[2]),new je(d[0],d[1],d[2])),a.normalized){const c=Wn(xi[a.componentType]);o.min.multiplyScalar(c),o.max.multiplyScalar(c)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const l=e.targets;if(l!==void 0){const a=new je,h=new je;for(let d=0,c=l.length;d<c;d++){const u=l[d];if(u.POSITION!==void 0){const S=n.json.accessors[u.POSITION],b=S.min,N=S.max;if(b!==void 0&&N!==void 0){if(h.setX(Math.max(Math.abs(b[0]),Math.abs(N[0]))),h.setY(Math.max(Math.abs(b[1]),Math.abs(N[1]))),h.setZ(Math.max(Math.abs(b[2]),Math.abs(N[2]))),S.normalized){const w=Wn(xi[S.componentType]);h.multiplyScalar(w)}a.max(h)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(a)}C.boundingBox=o;const s=new ls;o.getCenter(s.center),s.radius=o.min.distanceTo(o.max)/2,C.boundingSphere=s}function Ar(C,e,n){const r=e.attributes,o=[];function l(s,a){return n.getDependency("accessor",s).then(function(h){C.setAttribute(a,h)})}for(const s in r){const a=Rn[s]||s.toLowerCase();a in C.attributes||o.push(l(r[s],a))}if(e.indices!==void 0&&!C.index){const s=n.getDependency("accessor",e.indices).then(function(a){C.setIndex(a)});o.push(s)}return ai(C,e),ha(C,e,n),Promise.all(o).then(function(){return e.targets!==void 0?na(C,e.targets,n):C})}class We{constructor(e){this.data=e}static nil(){return ca}static fromArray(e){let n=We.nil();for(let r=e.length-1;r>=0;--r)n=n.cons(e[r]);return n}toArray(){let e=[],n=this;for(;;){let r=n.head();if(r==null)break;e.push(r);let o=n.tail();if(o==null)break;n=o}return e}cons(e){return new We({type:"Cons",head:e,tail:this})}isNil(){return this.data.type=="Nil"}head(){switch(this.data.type){case"Cons":return this.data.head;case"Nil":return}}tail(){switch(this.data.type){case"Cons":return this.data.tail;case"Nil":return}}equals(e){let n=this,r=e;for(;;){if(n.head()!=r.head())return!1;let o=n.tail(),l=r.tail();if(o==null&&l==null)break;if(o==null)return!1;if(l==null)return!1;n=o,r=l}return!0}}const ca=new We({type:"Nil"}),bi=Fn(C=>We.fromArray(C),C=>C.toArray(),{type:"Array",elemTypeSchema:{type:"String"}});let da={length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:40},leg1Length:{displayName:"Leg 1 Length",typeSchema:{type:"Number"},defaultValue:40},leg2Length:{displayName:"Leg 2 Length",typeSchema:{type:"Number"},defaultValue:80},thickness:{displayName:"Thickness",typeSchema:{type:"Number"},defaultValue:3},holeDiameter:{displayName:"Hole Diameter",typeSchema:{type:"Number"},defaultValue:12},leg1NumHoles:{displayName:"Leg 1 # Holes",typeSchema:{type:"Number"},defaultValue:1},leg2NumHoles:{displayName:"Leg 2 # Holes",typeSchema:{type:"Number"},defaultValue:2}};const ua=new Ae({typeName:"AngleBracket",displayName:"Angle Bracket",propertiesSchema:da}),fa=ua;function nr(C,e,n){if(C.clearGroups(),delete C.userData.faceGroups,C.setIndex(e.triangles),C.setAttribute("position",new zi(e.vertices,3)),e.faceGroups){let r=new Set;n&&(r=new Set(n)),C.userData.faceGroups=e.faceGroups,e.faceGroups.forEach(({start:o,count:l,faceId:s})=>{C.addGroup(o,l,r.has(s)?1:0)})}else C.addGroup(0,e.triangles.length,0);e.normals&&e.normals.length?C.setAttribute("normal",new zi(e.normals,3)):C.computeVertexNormals(),C.computeBoundingBox()}function rr(C,e,n){if(C.clearGroups(),delete C.userData.edgeGroups,C.setAttribute("position",new zi(e.lines,3)),!!e)if(e.edgeGroups){let r=new Set;n&&(r=new Set(n)),C.userData.edgeGroups=e.edgeGroups,e.edgeGroups.forEach(({start:o,count:l,edgeId:s})=>{C.addGroup(o,l,r.has(s)?1:0)})}else C.addGroup(0,e.lines.length/3,0)}function pa(){return new Worker(""+new URL("geometric_kernel_worker.caa3a86c.js",import.meta.url).href)}let Xn=new Map;const Pl=new pa;Pl.addEventListener("message",C=>{let e=C.data,n=Xn.get(e.requestId);Xn.delete(e.requestId),n?.(e.result)});function Yi(C){return new Promise(e=>{Xn.set(C.requestId,n=>{e(n)}),Pl.postMessage(C)})}await Yi({type:"setupOpenCascade",requestId:zt(),params:{opencascadeWasm:sl}});async function ma(C){return await Yi({type:"shapeToMesh",requestId:zt(),params:{shapeId:C}})}async function ga(C){return await Yi({type:"shapeToEdges",requestId:zt(),params:{shapeId:C}})}async function xr(C){await Yi({type:"deleteShape",requestId:zt(),params:{shapeId:C}})}async function ya(C){return await Yi({type:"generateAngleBracketShape",requestId:zt(),params:JSON.parse(JSON.stringify(C))})}function ba(C){let[e,n]=wt(void 0),[r,o]=wt(void 0);return Gt(()=>{let l=C();if(l==null){n(void 0),o(void 0);return}if(l.type=="Err"){n(Wt(l.message)),o(Wt(l.message));return}let s=l.value;(async()=>{let a=await ma(s),h=await ga(s);At(()=>{n(a),o(h)})})()}),t(()=>l=>{let s=e(),a=r();if(s==null||a==null)return new nt;if(s.type=="Err"||a.type=="Err")return new nt;let h=s.value,d=a.value,c=new Xt,u=new rt({color:"#5a8296",polygonOffset:!0,polygonOffsetFactor:2,polygonOffsetUnits:1}),S=new Xt,b=new Tt({color:"#3c5a6e"});nr(c,h),rr(S,d),Fe(()=>{c.dispose(),u.dispose(),S.dispose(),b.dispose()});let N=new xe(c,u),w=new ht(S,b),p=new nt;return p.add(N),p.add(w),p})}class wa{constructor(){this.componentType=fa}create(e,n,r,o,l){return new Sa(n,r,o,l)}}let Nl=new wa;Be(Nl);class Sa{constructor(e,n,r,o){this.type=Nl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let[l,s]=wt(void 0);Fe(()=>{let d=Wi(()=>l());d?.type=="Ok"&&xr(d.value)}),Gt(async()=>{let d=Wi(()=>l()),c=await ya(e);s(c),d?.type=="Ok"&&xr(d.value)});let a=ba(l),h=new T({mkObject3d:a});this.components=t(()=>[h])}}let Pa={type:{displayName:"Type",typeSchema:{type:"String",possibleValues:["Wall Sheeting","Roof Sheeting"]},defaultValue:"Wall Sheeting"},usage:{displayName:"Usage",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String"}},defaultValue:void 0},outline:{displayName:"Outline",typeSchema:{type:"Array",elemTypeSchema:En},defaultValue:[f.zero,f.create(1e3,0),f.create(1e3,1e3),f.create(0,1e3)]},bays:{displayName:"Bays",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Array",elemTypeSchema:{type:"Object",properties:{baySize:{displayName:"Bay Size",typeSchema:{type:"Number"},defaultValue:0},sheetedStyle:{displayName:"Sheeted Style",typeSchema:{type:"Union",parts:{"Fully Sheeted":{},"Fully Open":{},"Upper Infill":{fromHeight:{displayName:"From Height",typeSchema:{type:"Number"},defaultValue:0}},Skirted:{fromHeight:{displayName:"From Height",typeSchema:{type:"Number"},defaultValue:0},toHeight:{displayName:"To Height",typeSchema:{type:"Number"},defaultValue:0}}}},defaultValue:{type:"Fully Sheeted"}}}}}},defaultValue:void 0},openings:{displayName:"Openings",typeSchema:{type:"Array",elemTypeSchema:{type:"Object",properties:{pos:{displayName:"Pos",typeSchema:En,defaultValue:f.zero},width:{displayName:"Width",typeSchema:{type:"Number"},defaultValue:0},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:0}}}},defaultValue:[]},colour:{displayName:"Colour",typeSchema:{type:"String"},defaultValue:""},sheetingType:{displayName:"Sheeting Type",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String",possibleValues:["Steelclad 0.42","Corrugated 0.42","Supersaw","Unirib","Long Line 305","Flat"]}},defaultValue:void 0},sheetingDirection:{displayName:"Sheeting Direction",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String",possibleValues:["Vertical","Horiztonal"]}},defaultValue:void 0},startSheetingAtOppositeEnd:{displayName:"Start Sheeting At Opposite End",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Boolean"}},defaultValue:void 0}};const Na=new Ae({typeName:"SheetedArea",displayName:"Sheeted Area",propertiesSchema:Pa}),Ma=Na;class Ca{constructor(){this.useStandardKitInsert=!1,this.componentType=Ma}create(e,n,r,o,l){return new va(n,r,o,l)}}let lr=new Ca;Be(lr);const ji=lr;class va{constructor(e,n,r,o){this.type=lr,this.layers=t(()=>[ve.Cladding]),this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=t(()=>e.usage==null),s=t(()=>e.bays==null),a=t(()=>e.sheetingType==null),h=new Te({type:()=>e.type,get usage(){if(!l())return()=>e.usage},outline:()=>e.outline,get bays(){if(!s())return()=>e.bays},openings:()=>e.openings,colour:()=>e.colour,get sheetingType(){if(!a())return()=>e.sheetingType},sheetingDirection:()=>e.sheetingDirection??"Vertical",startSheetingAtOppositeEnd:()=>e.startSheetingAtOppositeEnd??!1,sheetingLowPoly:()=>!1,previewOpening:()=>{},textures:void 0});this.components=h.components}}let Ta={name:{displayName:"Name",typeSchema:{type:"String"},defaultValue:""}};const ka=new Ae({typeName:"Group",displayName:"Group",propertiesSchema:Ta}),za=ka;class Aa{constructor(){this.useStandardKitInsert=!1,this.componentType=za}create(e,n,r,o,l){return new xa(n,r,o,l)}}const or=new Aa;Be(or);const yi=or;class xa{constructor(e,n,r,o){this.type=or,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o}}class Ia{constructor(e){this.diameter=e.diameter}}class Zt{constructor(e){let n=()=>50,r=()=>50,o=()=>5,l=t(()=>new Ia({diameter:o()})),s=t(()=>e.pitch()*Math.PI/180),a=t(()=>Math.tan(s())),h=b=>e.apexHeight()-Math.abs(b-e.pitchOffset())*a(),d=b=>e.pitch()==0?0:Math.max(0,e.pitchOffset()-(e.apexHeight()-b)/a()),c=b=>e.pitch()==0?e.width():Math.min(e.width(),e.pitchOffset()+(e.apexHeight()-b)/a()),u=t(()=>{let b=[];{let N=0,p=e.width()-N,g=Math.ceil(p/n()),P=p/g,M=g-1;for(let v=0;v<M;++v){let k=N+P*(v+1);b.push({length:h(k),transform:m.create(i.create(N+P*(v+1),0,0),y.fromUV(i.unitZ,i.unitY))})}}{let N=0,p=e.apexHeight()-N,g=Math.ceil(p/r()),P=p/g,M=g-1;for(let v=0;v<M;++v){let k=N+P*(v+1),z=d(k),A=c(k)-z;b.push({length:A,transform:m.create(i.create(z,0,k),y.identity)})}}return N=>{let w=[],p=new Kn;for(let v of b){let k=.001,z=new hi(.5*l().diameter*k,.5*l().diameter*k,v.length*k,20);z.rotateZ(.5*Math.PI);let x=v.transform.orientation;p.set(x.x,x.y,x.z,x.w),z.translate(.5*v.length*k,0,0),z.applyQuaternion(p),z.translate(v.transform.o.x*k,v.transform.o.y*k,v.transform.o.z*k),w.push(z)}let g=ir(w),P=new rt({color:"#808080"});return Fe(()=>{g.dispose(),P.dispose()}),new xe(g,P)}}),S=t(()=>new T({layers:t(()=>[ve.Cladding]),mkObject3d:u}));this.components=t(()=>[S()])}}let Ba={length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:1e3},apexHeight:{displayName:"Apex Height",typeSchema:{type:"Number"},defaultValue:1e3},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:0},pitchOffset:{displayName:"Pitch Offset",typeSchema:{type:"Number"},defaultValue:0}};const Oa=new Ae({typeName:"Mesh",displayName:"Mesh",propertiesSchema:Ba}),Fa=Oa;class Va{constructor(){this.componentType=Fa}create(e,n,r,o,l){return new La(n,r,o,l)}}let sr=new Va;Be(sr);const Ht=sr;class La{constructor(e,n,r,o){this.type=sr,this.layers=t(()=>[ve.Cladding]),this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new Zt({width:()=>e.length,apexHeight:()=>e.apexHeight,pitch:()=>e.pitch,pitchOffset:()=>e.pitchOffset});this.components=l.components}}class Ha{constructor(e){let n=e.subKitCreator.mkKitFunction,r=()=>5,o=t(()=>e.pitch()*Math.PI/180),l=t(()=>Math.cos(o())),s=t(()=>Math.sin(o())),a=t(()=>Math.tan(o())),h=t(()=>(e.span()+e.rearOverhang())/l()),d=()=>"40x2.0 SHS",c=t(()=>Qt[d()]),u=new Ea({length:e.length,height:e.height,doorWidth:e.doorWidth,doorFrameClearance:r,frameMemberItemName:d,frameMemberProperties:c,mkKit:n}),S=n({id:"Front Frame",kitType:yi,state:{name:()=>"Front Frame"},children:u.kits}),b=new Ua({length:e.length,height:t(()=>e.height()-e.span()*a()),frameMemberItemName:d,frameMemberProperties:c,mkKit:n}),N=n({id:"Rear Frame",kitType:yi,state:{name:()=>"Rear Frame"},space:t(()=>m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX))),children:b.kits}),w=t(()=>.5*e.height()),p=new Ra({length:t(()=>e.span()-2*c().size),height:t(()=>e.height()-(e.span()-c().size)*a()),shadedRoom:t(()=>e.shadedSpan()-c().size),pitch:e.pitch,nogginCentreZ:w,ca:l,sa:s,ta:a,frameMemberItemName:d,frameMemberProperties:c,mkKit:n}),g=n({id:"Left Side Frame",kitType:yi,state:{name:()=>"Left Side Frame"},space:t(()=>m.create(i.create(0,e.span()-c().size,0),y.fromWU(i.unitZ,i.negUnitY))),children:p.kits}),P=new Wa({length:t(()=>e.span()-2*c().size),height:t(()=>e.height()-(e.span()-c().size)*a()),shadedRoom:t(()=>e.shadedSpan()-c().size),pitch:e.pitch,nogginCentreZ:w,ca:l,sa:s,ta:a,frameMemberItemName:d,frameMemberProperties:c,mkKit:n}),M=n({id:"Right Side Frame",kitType:yi,state:{name:()=>"Right Side Frame"},space:t(()=>m.create(i.create(e.length(),c().size,0),y.fromWU(i.unitZ,i.unitY))),children:P.kits}),v=t(()=>(g()?.space?.call(void 0)??m.identity).pointFromThisSpace(i.create(p.internalDoorStudCentreX(),0,0)).y),k=new Xa({length:t(()=>e.doorWidth()+2*r()+c().size),span:t(()=>v()+.5*c().size-c().size),peakHeight:t(()=>e.height()-c().size*a()),pitch:e.pitch,doorFrameClearance:r,nogginCentreZ:w,ca:l,sa:s,ta:a,frameMemberItemName:d,frameMemberProperties:c,mkKit:n}),z=t(()=>m.create(i.create(c().size,c().size,0),y.identity)),x=n({id:"Internal Framing",kitType:yi,state:{name:()=>"Internal Framing"},space:z,children:k.kits}),A=t(()=>new T({children:k.components,transform:z})),I=n({id:"Left Shade Sheeting",kitType:ji,state:{type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.shadedSpan(),0),f.create(e.shadedSpan(),e.height()-(e.span()-e.shadedSpan())*a()),f.create(0,e.height()-e.span()*a())]),openings:t(()=>[]),colour:()=>"Shale Grey"},space:t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))}),O=n({id:"Right Shade Sheeting",kitType:ji,state:{type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.shadedSpan(),0),f.create(e.shadedSpan(),e.height()-e.span()*a()),f.create(0,e.height()-(e.span()-e.shadedSpan())*a())]),openings:t(()=>[]),colour:()=>"Shale Grey"},space:t(()=>m.create(i.create(e.length(),e.span()-e.shadedSpan(),0),y.fromWU(i.unitZ,i.unitY)))}),E=n({id:"Rear Shade Sheeting",kitType:ji,state:{type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()-e.span()*a()),f.create(0,e.height()-e.span()*a())]),openings:t(()=>[]),colour:()=>"Shale Grey"},space:t(()=>m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))}),F=n({id:"Roof Sheeting",kitType:ji,state:{type:()=>"Roof Sheeting",outline:()=>[f.zero,f.create(e.length(),0),f.create(e.length(),h()),f.create(0,h())],openings:()=>[],colour:()=>"Zinc",sheetingType:()=>"Corrugated 0.42"},space:t(()=>m.create(i.create(0,0,e.height()),y.fromWU(i.create(0,l(),-s()),i.unitX)))});this.kits=t(()=>[...Pe(S()),...Pe(N()),...Pe(g()),...Pe(M()),...Pe(x()),...Pe(I()),...Pe(O()),...Pe(E()),...Pe(F())]);let $=mn(this.kits);this.components=t(()=>[...$(),...u.components(),A()]),this.memberScheduleComponents=t(()=>{let G=J=>[...J.hasLabel?.call(J)??!1?[J]:[],...(J.children?.call(J)??[]).flatMap(G)];return this.components().flatMap(G)}),this.allocateLabels=G=>{wo(G,this.kits())}}}class Ea{constructor(e){let n="Front Frame ",r=e.mkKit,o=r({id:n+"Base Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()-2*e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.frameMemberProperties().size,0,0),y.identity))}),l=r({id:n+"Top Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()-2*e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size,0,e.height()),y.fromUV(i.negUnitX,i.unitY)))}),s=r({id:n+"Left Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:e.height,hasLabel:()=>!0},space:t(()=>m.create(i.create(0,0,e.height()),y.fromUV(i.negUnitZ,i.unitY)))}),a=r({id:n+"Right Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:e.height,hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length(),0,0),y.fromUV(i.unitZ,i.unitY)))}),h=r({id:n+"Door Stud",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.height()-2*e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.frameMemberProperties().size+e.doorWidth()+2*e.doorFrameClearance(),0,e.height()-e.frameMemberProperties().size),y.fromUV(i.negUnitZ,i.unitY)))}),d=t(()=>.5*e.height()),c=r({id:n+"Noggin",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()-3*e.frameMemberProperties().size-e.doorWidth()-2*e.doorFrameClearance()),hasLabel:()=>!0},space:t(()=>m.create(i.create(2*e.frameMemberProperties().size+e.doorWidth()+2*e.doorFrameClearance(),0,.5*e.height()-.5*e.frameMemberProperties().size),y.fromUV(i.unitX,i.unitY)))}),u=t(()=>2*e.frameMemberProperties().size+e.doorWidth()+2*e.doorFrameClearance()),S=t(()=>e.length()-3*e.frameMemberProperties().size-e.doorWidth()-2*e.doorFrameClearance()),b=t(()=>(e.height()-3*e.frameMemberProperties().size)/2),N=r({id:n+"Mesh 1",kitType:Ht,state:{length:S,apexHeight:b,pitch:()=>0,pitchOffset:()=>0},space:t(()=>m.create(i.create(u(),.5*e.frameMemberProperties().size,e.frameMemberProperties().size),y.identity))}),w=r({id:n+"Mesh 2",kitType:Ht,state:{length:S,apexHeight:b,pitch:()=>0,pitchOffset:()=>0},space:t(()=>m.create(i.create(u(),.5*e.frameMemberProperties().size,.5*e.height()+.5*e.frameMemberProperties().size),y.identity))}),p=new Ml({width:e.doorWidth,height:t(()=>e.height()-2*e.frameMemberProperties().size-e.doorFrameClearance()),doorClearance:e.doorFrameClearance,nogginCentreZ:d,frameMemberItemName:e.frameMemberItemName,frameMemberProperties:e.frameMemberProperties,mkKit:r}),g=t(()=>m.create(i.create(e.frameMemberProperties().size+e.doorFrameClearance(),0,e.frameMemberProperties().size+e.doorFrameClearance()),y.identity)),P=r({id:"Door",kitType:yi,state:{name:()=>"Door"},space:g,children:p.kits}),M=t(()=>new T({children:p.components,transform:g}));this.kits=t(()=>[...[o(),l(),s(),a(),h(),c(),P(),N(),w()].flatMap(v=>Pe(v))]),this.components=t(()=>[M()])}}class Ua{constructor(e){let n="Front Frame ",r=e.mkKit,o=r({id:n+"Base Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()-2*e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.frameMemberProperties().size,0,0),y.identity))}),l=r({id:n+"Top Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()-2*e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size,0,e.height()),y.fromUV(i.negUnitX,i.unitY)))}),s=r({id:n+"Left Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:e.height,hasLabel:()=>!0},space:t(()=>m.create(i.create(0,0,e.height()),y.fromUV(i.negUnitZ,i.unitY)))}),a=r({id:n+"Right Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:e.height,hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length(),0,0),y.fromUV(i.unitZ,i.unitY)))}),h=r({id:n+"Noggin Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()-2*e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.frameMemberProperties().size,0,.5*e.height()-.5*e.frameMemberProperties().size),y.identity))});this.kits=t(()=>[...[o(),l(),s(),a(),h()].flatMap(d=>Pe(d))]),this.components=t(()=>[])}}class Ra{constructor(e){let n=e.ca,r=e.sa,o=e.ta,l=e.mkKit,s=l({id:"Base Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:e.length,hasLabel:()=>!0}}),a=l({id:"Top Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()/n()+e.frameMemberProperties().size*o()),frontBackCutAngle:t(()=>e.pitch()),backBackCutAngle:t(()=>-e.pitch()),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length(),0,e.height()+e.length()*o()),y.fromUV(i.create(-n(),0,-r()),i.unitY)))}),h=t(()=>e.shadedRoom()-.5*e.frameMemberProperties().size),d=l({id:"Shaded Stud",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.height()+(h()+.5*e.frameMemberProperties().size)*o()-e.frameMemberProperties().size-e.frameMemberProperties().size/n()),backBackCutAngle:t(()=>e.pitch()),hasLabel:()=>!0},space:t(()=>m.create(i.create(h()+.5*e.frameMemberProperties().size,0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))}),c=t(()=>.5*(h()+(e.length()+e.frameMemberProperties().size))),u=l({id:"Internal Door Stud",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.height()+(c()+.5*e.frameMemberProperties().size)*o()-e.frameMemberProperties().size-e.frameMemberProperties().size/n()),backBackCutAngle:t(()=>e.pitch()),hasLabel:()=>!0},space:t(()=>m.create(i.create(c()+.5*e.frameMemberProperties().size,0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))}),S=[l({id:"Noggin 1",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>c()-h()-e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(h()+.5*e.frameMemberProperties().size,0,e.nogginCentreZ()-.5*e.frameMemberProperties().size),y.identity))}),l({id:"Noggin 2",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()-c()-.5*e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(c()+.5*e.frameMemberProperties().size,0,e.nogginCentreZ()-.5*e.frameMemberProperties().size),y.identity))})],b=l({id:"Bottom Left Mesh",kitType:Ht,state:{length:t(()=>c()-h()-e.frameMemberProperties().size),apexHeight:t(()=>e.nogginCentreZ()-1.5*e.frameMemberProperties().size),pitch:()=>0,pitchOffset:()=>0},space:t(()=>m.create(i.create(h()+.5*e.frameMemberProperties().size,.5*e.frameMemberProperties().size,e.frameMemberProperties().size),y.identity))}),N=l({id:"Bottom Right Mesh",kitType:Ht,state:{length:t(()=>e.length()-c()-.5*e.frameMemberProperties().size),apexHeight:t(()=>e.nogginCentreZ()-1.5*e.frameMemberProperties().size),pitch:()=>0,pitchOffset:()=>0},space:t(()=>m.create(i.create(c()+.5*e.frameMemberProperties().size,.5*e.frameMemberProperties().size,e.frameMemberProperties().size),y.identity))}),w=l({id:"Top Left Mesh",kitType:Ht,state:{length:t(()=>c()-h()-e.frameMemberProperties().size),apexHeight:t(()=>e.height()+(c()-.5*e.frameMemberProperties().size)*o()-e.frameMemberProperties().size/n()-(e.nogginCentreZ()+.5*e.frameMemberProperties().size)),pitch:e.pitch,pitchOffset:t(()=>c()-h()-e.frameMemberProperties().size)},space:t(()=>m.create(i.create(h()+.5*e.frameMemberProperties().size,.5*e.frameMemberProperties().size,e.nogginCentreZ()+.5*e.frameMemberProperties().size),y.identity))}),p=l({id:"Top Right Mesh",kitType:Ht,state:{length:t(()=>e.length()-c()-.5*e.frameMemberProperties().size),apexHeight:t(()=>e.height()+e.length()*o()-e.frameMemberProperties().size/n()-(e.nogginCentreZ()+.5*e.frameMemberProperties().size)),pitch:e.pitch,pitchOffset:t(()=>e.length()-c()-.5*e.frameMemberProperties().size)},space:t(()=>m.create(i.create(c()+.5*e.frameMemberProperties().size,.5*e.frameMemberProperties().size,e.nogginCentreZ()+.5*e.frameMemberProperties().size),y.identity))});this.internalDoorStudCentreX=c,this.kits=t(()=>[...[s(),a(),d(),u(),...S.map(g=>g()),b(),N(),w(),p()].flatMap(g=>Pe(g))])}}class Wa{constructor(e){let n=e.ca,r=e.sa,o=e.ta,l=e.mkKit,s=l({id:"Base Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:e.length,hasLabel:()=>!0}}),a=l({id:"Top Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()/n()+e.frameMemberProperties().size*o()),frontBackCutAngle:t(()=>-e.pitch()),backBackCutAngle:t(()=>e.pitch()),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length()+e.frameMemberProperties().size*o()*n(),0,e.height()-e.frameMemberProperties().size*o()*r()),y.fromUV(i.create(-n(),0,r()),i.unitY)))}),h=t(()=>e.length()-(e.shadedRoom()-.5*e.frameMemberProperties().size)),d=l({id:"Shaded Stud",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.height()+(e.length()-(h()-.5*e.frameMemberProperties().size))*o()-e.frameMemberProperties().size-e.frameMemberProperties().size/n()),backBackCutAngle:t(()=>-e.pitch()),hasLabel:()=>!0},space:t(()=>m.create(i.create(h()+.5*e.frameMemberProperties().size,0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))}),c=l({id:"Noggin",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>h()-.5*e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(0,0,e.nogginCentreZ()-.5*e.frameMemberProperties().size),y.identity))}),u=l({id:"Bottom Mesh",kitType:Ht,state:{length:t(()=>h()-.5*e.frameMemberProperties().size),apexHeight:t(()=>e.nogginCentreZ()-1.5*e.frameMemberProperties().size),pitch:()=>0,pitchOffset:()=>0},space:t(()=>m.create(i.create(0,.5*e.frameMemberProperties().size,e.frameMemberProperties().size),y.identity))}),S=l({id:"Top Mesh",kitType:Ht,state:{length:t(()=>h()-.5*e.frameMemberProperties().size),apexHeight:t(()=>e.height()+e.length()*o()-e.frameMemberProperties().size/n()-(e.nogginCentreZ()+.5*e.frameMemberProperties().size)),pitch:e.pitch,pitchOffset:()=>0},space:t(()=>m.create(i.create(0,0,e.nogginCentreZ()+.5*e.frameMemberProperties().size),y.identity))});this.kits=t(()=>[...[s(),a(),d(),c(),u(),S()].flatMap(b=>Pe(b))])}}class Ml{constructor(e){let n=e.mkKit,r=n({id:"Bottom Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.width()-2*e.doorClearance()),frontBackCutAngle:()=>45,backBackCutAngle:()=>45,hasLabel:()=>!0},space:t(()=>m.create(i.create(e.doorClearance(),0,e.doorClearance()),y.identity))}),o=n({id:"Top Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.width()-2*e.doorClearance()),frontBackCutAngle:()=>45,backBackCutAngle:()=>45,hasLabel:()=>!0},space:t(()=>m.create(i.create(e.width()-e.doorClearance(),0,e.height()-e.doorClearance()),y.fromUV(i.negUnitX,i.unitY)))}),l=n({id:"Left Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.height()-2*e.doorClearance()),frontBackCutAngle:()=>45,backBackCutAngle:()=>45,hasLabel:()=>!0},space:t(()=>m.create(i.create(e.doorClearance(),0,e.height()-e.doorClearance()),y.fromUV(i.negUnitZ,i.unitY)))}),s=n({id:"Right Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.height()-2*e.doorClearance()),frontBackCutAngle:()=>45,backBackCutAngle:()=>45,hasLabel:()=>!0},space:t(()=>m.create(i.create(e.width()-e.doorClearance(),0,e.doorClearance()),y.fromUV(i.unitZ,i.unitY)))}),a=n({id:"Noggin",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.width()-2*(e.doorClearance()+e.frameMemberProperties().size)),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.doorClearance()+e.frameMemberProperties().size,0,e.nogginCentreZ()-.5*e.frameMemberProperties().size-e.doorClearance()-e.frameMemberProperties().size),y.identity))}),h=n({id:"Mesh 1",kitType:Ht,state:{length:t(()=>e.width()-2*(e.doorClearance()+e.frameMemberProperties().size)),apexHeight:t(()=>e.nogginCentreZ()-.5*e.frameMemberProperties().size-e.doorClearance()-2*e.frameMemberProperties().size),pitch:()=>0,pitchOffset:()=>0},space:t(()=>m.create(i.create(e.doorClearance()+e.frameMemberProperties().size,.5*e.frameMemberProperties().size,e.doorClearance()+e.frameMemberProperties().size),y.identity))}),d=n({id:"Mesh 2",kitType:Ht,state:{length:t(()=>e.width()-2*(e.doorClearance()+e.frameMemberProperties().size)),apexHeight:t(()=>e.height()-e.doorClearance()-e.frameMemberProperties().size-(e.nogginCentreZ()+.5*e.frameMemberProperties().size-e.doorClearance()-e.frameMemberProperties().size)),pitch:()=>0,pitchOffset:()=>0},space:t(()=>m.create(i.create(e.doorClearance()+e.frameMemberProperties().size,.5*e.frameMemberProperties().size,e.nogginCentreZ()+.5*e.frameMemberProperties().size-e.doorClearance()-e.frameMemberProperties().size),y.identity))}),c=t(()=>[{hinge:new Ir,space:t(()=>m.create(i.create(.5*e.doorClearance(),0,e.height()*1/4),y.identity))},{hinge:new Ir,space:t(()=>m.create(i.create(.5*e.doorClearance(),0,e.height()*3/4),y.identity))}]),u=t(()=>c().map(({hinge:S,space:b})=>new T({children:S.components,transform:b})));this.kits=t(()=>[r(),o(),l(),s(),a(),h(),d()].flatMap(S=>Pe(S))),this.components=t(()=>[...u()])}}class Ir{constructor(){let e=()=>110,n=()=>40,r=()=>2,o=()=>10,l=t(()=>new T({mkObject3d:t(()=>s=>{let a=.001,h=new rt({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#808080"}),d=new Ni(n()*a,r()*a,e()*a),c=new bt(d),u=new Tt({color:"black"}),S=new xe(d,h),b=new xe(d,h),N=new ht(c,u),w=new ht(c,u),p=new hi(.5*o()*a,.5*o()*a,e()*a),g=new bt(p),P=new xe(p,h),M=new ht(g,u);S.position.set(-.5*n()*a,-.5*r()*a,0),N.position.set(-.5*n()*a,-.5*r()*a,0),b.position.set(.5*n()*a,-.5*r()*a,0),w.position.set(.5*n()*a,-.5*r()*a,0),P.rotateX(.5*Math.PI),M.rotateX(.5*Math.PI),P.translateZ(.5*o()*a),M.translateZ(.5*o()*a),Fe(()=>{h.dispose(),d.dispose(),c.dispose(),u.dispose(),p.dispose(),g.dispose()});let v=new nt;return v.add(S),v.add(b),v.add(P),v.add(N),v.add(w),v.add(M),v}),transform:t(()=>m.identity)}));this.components=t(()=>[l()])}}class Xa{constructor(e){let n=e.ca,r=e.sa,o=e.ta,l=e.mkKit,s=l({id:"Base Member 1",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()-e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size,e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))}),a=l({id:"Base Member 2",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.span()-e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)))}),h=t(()=>e.peakHeight()-e.span()*o()),d=l({id:"Stud Member",kitType:Oe,state:{itemName:e.frameMemberItemName,length:h,hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length(),e.span(),h()),y.fromUV(i.negUnitZ,i.negUnitY)))}),c=l({id:"Top Member 1",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.length()-e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(0,e.span(),h()),y.fromWU(i.negUnitZ,i.unitX)))}),u=l({id:"Top Member 2",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>(e.span()-e.frameMemberProperties().size)/n()+e.frameMemberProperties().size*o()),frontBackCutAngle:t(()=>-e.pitch()),backBackCutAngle:e.pitch,hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length(),e.span()-e.frameMemberProperties().size+e.frameMemberProperties().size*o()*n(),e.peakHeight()-(e.span()-e.frameMemberProperties().size)*o()-e.frameMemberProperties().size*o()*r()),y.fromUV(i.create(0,-n(),r()),i.negUnitX)))}),S=l({id:"Noggin",kitType:Oe,state:{itemName:e.frameMemberItemName,length:t(()=>e.span()-e.frameMemberProperties().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(e.length(),0,e.nogginCentreZ()+.5*e.frameMemberProperties().size),y.fromWU(i.negUnitX,i.unitY)))}),b=l({id:"Mesh 1",kitType:Ht,state:{length:t(()=>e.span()-e.frameMemberProperties().size),apexHeight:t(()=>e.nogginCentreZ()-1.5*e.frameMemberProperties().size),pitch:()=>0,pitchOffset:()=>0},space:t(()=>m.create(i.create(e.length()-.5*e.frameMemberProperties().size,0,e.frameMemberProperties().size),y.fromWU(i.unitZ,i.unitY)))}),N=l({id:"Mesh 2",kitType:Ht,state:{length:t(()=>e.span()-e.frameMemberProperties().size),apexHeight:t(()=>e.peakHeight()-e.frameMemberProperties().size/n()-(e.nogginCentreZ()+.5*e.frameMemberProperties().size)),pitch:e.pitch,pitchOffset:()=>0},space:t(()=>m.create(i.create(e.length()-.5*e.frameMemberProperties().size,0,e.nogginCentreZ()+.5*e.frameMemberProperties().size),y.fromWU(i.unitZ,i.unitY)))}),w=t(()=>m.create(i.create(0,e.span()-e.frameMemberProperties().size,e.frameMemberProperties().size+e.doorFrameClearance()),y.identity)),p=new Ml({width:t(()=>e.length()-e.frameMemberProperties().size),height:t(()=>h()-2*e.frameMemberProperties().size-e.doorFrameClearance()),doorClearance:e.doorFrameClearance,nogginCentreZ:e.nogginCentreZ,frameMemberItemName:e.frameMemberItemName,frameMemberProperties:e.frameMemberProperties,mkKit:l}),g=l({id:"Door",kitType:yi,state:{name:()=>"Door"},space:w,children:p.kits}),P=t(()=>new T({children:p.components,transform:w}));this.kits=t(()=>[s(),a(),d(),c(),u(),S(),b(),N(),g()].flatMap(M=>Pe(M))),this.components=t(()=>[P()])}}const Da=lt('<img style="max-width: 3cm;">'),_a=lt('<svg><path fill="transparent" style="stroke-width:1;stroke:black;fill:none;" vector-effect="non-scaling-stroke"></path></svg>',4,!0),Ya=lt('<svg><text text-anchor="middle" dominant-baseline="middle"></text></svg>',4,!0),Ga=lt('<svg><text dominant-baseline="middle"></text></svg>',4,!0),Br=lt('<svg><text text-anchor="end" dominant-baseline="middle"></text></svg>',4,!0),Or=lt('<svg><line stroke="black" stroke-width="1" vector-effect="non-scaling-stroke"></line></svg>',4,!0),Za=lt('<svg><text fill="black" text-anchor="middle" font-weight="bold"></text></svg>',4,!0);async function $a(){let C=new Image;await new Promise(r=>{C.src="./img/steeline-logo.png",C.addEventListener("load",()=>{r()})});let e=document.createElement("canvas");e.width=C.width,e.height=C.height;let n=e.getContext("2d");if(n!=null)return n.drawImage(C,0,0),e.toDataURL("image/png")}let Ka=await $a();const Gi=C=>{let e=t(()=>ms(C.labeler,C.components)),[n,r]=wt(void 0),o=t(()=>{let h=[],d=0;for(let c of e()){if(c.shsProperties!=null&&c.length!=null){let u=c.length(),S=c.shsProperties();h.push({posY:d,width:u,height:S.size,frontCutAngle:c.frontBackCutAngle==null?void 0:c.frontBackCutAngle(),backCutAngle:c.backBackCutAngle==null?void 0:c.backBackCutAngle(),backMidCutAngle:c.backMidBackCutAngle==null?void 0:c.backMidBackCutAngle(),itemName:c.itemName==null?"":c.itemName(),label:C.labeler.lookupLabelForComponent(c)??"",qty:c.qty==null?1:c.qty()}),d+=S.size*2.5}if(c.rhsProperties!=null&&c.length!=null){let u=c.length(),S=c.rhsProperties();h.push({posY:d,width:u,height:S.flangeSize,frontCutAngle:c.frontBackCutAngle==null?void 0:c.frontBackCutAngle(),backCutAngle:c.backBackCutAngle==null?void 0:c.backBackCutAngle(),backMidCutAngle:c.backMidBackCutAngle==null?void 0:c.backMidBackCutAngle(),itemName:c.itemName==null?"":c.itemName(),label:C.labeler.lookupLabelForComponent(c)??"",qty:c.qty==null?1:c.qty()}),d+=S.flangeSize*2.5}}return h}),l=t(()=>{let h=n();if(h==null)return{panX:0,panY:0,scale:1};let d,c,u,S;for(let z of o()){let x=[f.create(0,z.posY),f.create(z.width,z.posY),f.create(z.width,z.posY+z.height),f.create(0,z.posY+z.height)];for(let A of x)(d==null||A.x<d)&&(d=A.x),(c==null||A.x>c)&&(c=A.x),(u==null||A.y<u)&&(u=A.y),(S==null||A.y>S)&&(S=A.y)}if(d==null||c==null||u==null||S==null)return{panX:0,panY:0,scale:1};let b=h.clientWidth,N=h.clientHeight,w=c-d,p=S-u,g=b/w,P=N/p,M=Math.min(g,P)*.9,v=-.5*b/M+.5*w,k=u-.5*(N/M-p);return{panX:v,panY:k,scale:M}}),s=t(()=>({...qn(),scale:l().scale,panX:l().panX,panY:l().panY})),a=t(()=>o().map(({posY:h,width:d,height:c})=>({space:m.create(i.create(d+30,0,-h-c),y.fromUV(i.unitZ,i.unitX)),markers:[0,c]})));return Je(er,{get logo(){return(()=>{const h=Da.cloneNode(!0);return Me(h,"src",Ka),h})()},companyDetails:{name:"Steeline FNW",abn:"12345678",address1:"300 Anzac Avenue",address2:"Harristown QLD 4350",phone:"(07) 4580 4244",fax:"(07) 4304 8012",email:"info@fnw.com.au",website:"fnw.au"},get title(){return C.title},projectNumber:"12-3456",customerName:"Customer Name",clientName:"Client Name",siteAddress1:"Site Address 1",siteAddress2:"Site Address 2",lot:"12345",rpsp:"12345",date:"00/00/0000",ultWindSpeed:"N/A",drawingNo:"12-3456;A",get children(){return Je(Jn,{onRefSvg:h=>{r(h)},showGrid:!1,fontSize:12,get state(){return s()},style:{width:"100%",height:"100%",border:"none"},get children(){return[Je(St,{get each(){return o()},children:h=>{let d=h().frontCutAngle??0,c=h().backCutAngle??0,u=h().backMidCutAngle??0,S=Math.tan(d*Math.PI/180),b=Math.tan(c*Math.PI/180),N=Math.tan(u*Math.PI/180),w=[f.create(Math.max(0,S)*h().height,0),...u==0?[f.create(h().width-Math.max(0,b)*h().height,0)]:[f.create(h().width-Math.max(0,N)*.5*h().height,0)],...u==0?[]:[f.create(h().width,.5*h().height)],...u==0?[f.create(h().width-Math.max(0,-b)*h().height,h().height)]:[f.create(h().width-Math.max(0,N)*.5*h().height,h().height)],f.create(Math.max(0,-S)*h().height,h().height)];return[(()=>{const p=_a.cloneNode(!0);return dt(g=>{const P="translate(0,"+h().posY+")",M="M"+w[0].x+" "+w[0].y+w.slice(1).map(v=>" L"+v.x+" "+v.y).join("")+" Z";return P!==g._v$&&Me(p,"transform",g._v$=P),M!==g._v$2&&Me(p,"d",g._v$2=M),g},{_v$:void 0,_v$2:void 0}),p})(),(()=>{const p=Ya.cloneNode(!0);return p.style.setProperty("font-weight","bold"),mt(p,()=>h().itemName+" ("+h().label+"): "+h().qty+" @ "+h().width.toFixed(0)+"mm"),dt(g=>{const P=.5*h().width,M=h().posY+.5*h().height,v=(10/s().scale).toString();return P!==g._v$3&&Me(p,"x",g._v$3=P),M!==g._v$4&&Me(p,"y",g._v$4=M),v!==g._v$5&&p.style.setProperty("font-size",g._v$5=v),g},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),p})(),Je(Sn,{when:d!=0,get children(){const p=Ga.cloneNode(!0);return p.style.setProperty("font-weight","bold"),mt(p,()=>Math.abs(d)+" deg."),dt(g=>{const P=Math.abs(S)*h().height,M=h().posY+.5*h().height,v=(10/s().scale).toString();return P!==g._v$6&&Me(p,"x",g._v$6=P),M!==g._v$7&&Me(p,"y",g._v$7=M),v!==g._v$8&&p.style.setProperty("font-size",g._v$8=v),g},{_v$6:void 0,_v$7:void 0,_v$8:void 0}),p}}),Je(Sn,{when:c!=0,get children(){const p=Br.cloneNode(!0);return p.style.setProperty("font-weight","bold"),mt(p,()=>Math.abs(c)+" deg."),dt(g=>{const P=h().width-Math.abs(b)*h().height,M=h().posY+.5*h().height,v=(10/s().scale).toString();return P!==g._v$9&&Me(p,"x",g._v$9=P),M!==g._v$10&&Me(p,"y",g._v$10=M),v!==g._v$11&&p.style.setProperty("font-size",g._v$11=v),g},{_v$9:void 0,_v$10:void 0,_v$11:void 0}),p}}),Je(Sn,{when:u!=0,get children(){const p=Br.cloneNode(!0);return p.style.setProperty("font-weight","bold"),mt(p,()=>Math.abs(u)+" deg. pivot middle"),dt(g=>{const P=h().width-.5*Math.abs(N)*h().height,M=h().posY+.5*h().height,v=(10/s().scale).toString();return P!==g._v$12&&Me(p,"x",g._v$12=P),M!==g._v$13&&Me(p,"y",g._v$13=M),v!==g._v$14&&p.style.setProperty("font-size",g._v$14=v),g},{_v$12:void 0,_v$13:void 0,_v$14:void 0}),p}})]}}),Je(St,{get each(){return a()},children:h=>{if(h().markers.length==0)return[];let d=[...h().markers].sort((p,g)=>p-g),c=d[0],u=d[d.length-1],S=h().space.pointFromThisSpace(i.create(c,0,0)),b=h().space.pointFromThisSpace(i.create(u,0,0)),N=h().space.v,w=Math.atan(-h().space.u.z/h().space.u.x)*180/Math.PI;return[(()=>{const p=Or.cloneNode(!0);return dt(g=>{const P=S.x,M=-S.z,v=b.x,k=-b.z;return P!==g._v$15&&Me(p,"x1",g._v$15=P),M!==g._v$16&&Me(p,"y1",g._v$16=M),v!==g._v$17&&Me(p,"x2",g._v$17=v),k!==g._v$18&&Me(p,"y2",g._v$18=k),g},{_v$15:void 0,_v$16:void 0,_v$17:void 0,_v$18:void 0}),p})(),Je(St,{each:d,children:p=>{let g=h().space.pointFromThisSpace(i.create(p(),0,0)),P=g.sub(N.scale(15)),M=g.add(N.scale(15));return(()=>{const v=Or.cloneNode(!0);return dt(k=>{const z=P.x,x=-P.z,A=M.x,I=-M.z;return z!==k._v$19&&Me(v,"x1",k._v$19=z),x!==k._v$20&&Me(v,"y1",k._v$20=x),A!==k._v$21&&Me(v,"x2",k._v$21=A),I!==k._v$22&&Me(v,"y2",k._v$22=I),k},{_v$19:void 0,_v$20:void 0,_v$21:void 0,_v$22:void 0}),v})()}}),Je(St,{get each(){return[...Array(d.length-1).keys()]},children:p=>{let g=d[p()],P=d[p()+1],M=h().space.pointFromThisSpace(i.create(.5*(g+P),40,0)),v="translate("+M.x+","+-M.z+") rotate("+w+")";return(()=>{const k=Za.cloneNode(!0);return Me(k,"transform",v),mt(k,()=>Math.round(P-g)+" mm"),dt(()=>Me(k,"font-size",(10/s().scale).toString())),k})()}})]}})]}})}})};let ja={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:2500},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:2e3},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2200},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:5},rearOverhang:{displayName:"Rear Overhang",typeSchema:{type:"Number"},defaultValue:200},shadedSpan:{displayName:"Shaded Span",typeSchema:{type:"Number"},defaultValue:820},doorWidth:{displayName:"Door Width",typeSchema:{type:"Number"},defaultValue:820}};const Qa=new Ae({typeName:"Aviary",displayName:"Aviary",propertiesSchema:ja}),qa=Qa;class Ja{constructor(){this.componentType=qa}create(e,n,r,o,l){return new eh(n,r,o,l)}}let Cl=new Ja;Be(Cl);class eh{constructor(e,n,r,o){this.type=Cl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new ll({kitsUserEdits:r,setKitsUserEdits:o}),s=new Ha({span:()=>e.span,length:()=>e.length,height:()=>e.height,pitch:()=>e.pitch,rearOverhang:()=>e.rearOverhang,shadedSpan:()=>e.shadedSpan,doorWidth:()=>e.doorWidth,subKitCreator:l});this.kits=s.kits,this.components=s.components,this.documents2=a=>t(()=>[{name:()=>"Member Schedule",pages:()=>[t(()=>Gi({title:"Aviary",components:s.memberScheduleComponents(),labeler:a}))]}]),this.allocateLabels=s.allocateLabels}}class vl{constructor(e){let n=t(()=>{let r=t(()=>e.width()-2*e.frameTimberProperties().webSize),o=t(()=>{let s=2,a=.5*e.frameTimberProperties().webSize,c=(e.height()-.5*e.frameTimberProperties().webSize-a)/s,u=s+1,S=[];for(let b=0;b<u;++b)S.push(a+b*c);return S}),l=t(()=>{let s=[],a=o();for(let h=0;h<a.length-1;++h){let d=a[h]+.5*e.frameTimberProperties().webSize,c=a[h+1]-.5*e.frameTimberProperties().webSize;s.push({fromZ:d,toZ:c})}return s});return[new T({itemName:e.frameTimberItemName,length:e.height,timberProperties:e.frameTimberProperties,transform:t(()=>m.create(i.create(0,e.frameTimberProperties().flangeSize,e.height()),y.fromWU(i.negUnitY,i.negUnitZ)))}),new T({itemName:e.frameTimberItemName,length:e.height,timberProperties:e.frameTimberProperties,transform:t(()=>m.create(i.create(e.width(),e.frameBraceTimberProperties().flangeSize,0),y.fromWU(i.negUnitY,i.unitZ)))}),...o().map(s=>new T({itemName:e.frameTimberItemName,length:r,timberProperties:e.frameTimberProperties,transform:t(()=>m.create(i.create(e.frameTimberProperties().webSize,e.frameTimberProperties().flangeSize,s-.5*e.frameTimberProperties().webSize),y.fromWU(i.negUnitY,i.unitX)))})),...l().flatMap(({fromZ:s,toZ:a},h)=>{let d=e.frameTimberProperties().webSize,c=e.width()-e.frameTimberProperties().webSize,u=a-s,S=c-d,b=e.frameBraceTimberProperties().webSize,N=Math.sqrt(S*S+u*u-b*b),w;{let I=N,O=b,E=Math.sqrt(I*I+O*O);w=tr.xy(f.create(I/E,-O/E))}let p=f.create(S,-u).normalize(),g=w.rotate(p),P=g.x,M=g.y,v=(h&1)==0;v&&(P=-P);let k=-M,z=P,x=m.create(i.create(v?c:d+k*b,0,v?a:a+z*b),y.fromWU(i.unitY,i.create(P,0,M))),A=Math.atan(Math.abs(P/M))*180/Math.PI;return[new T({itemName:e.frameBraceTimberItemName,length:()=>N,timberProperties:e.frameBraceTimberProperties,frontBackCutAngle:()=>v?A:-A,backBackCutAngle:()=>v?-A:A,transform:()=>x})]}),...(()=>{let s=e.width(),a=Math.floor(s/e.frameTimberProperties().webSize),h=e.frameTimberProperties().webSize,d=[];for(let c=0;c<a;++c){let u=c*h;d.push(new T({itemName:e.frameTimberItemName,length:e.height,timberProperties:e.frameTimberProperties,transform:t(()=>m.create(i.create(u,e.frameTimberProperties().flangeSize*2,e.height()),y.fromWU(i.negUnitY,i.negUnitZ)))}))}return d})()]});this.components=t(()=>[...n()])}}class et{constructor(e){this.webSize=e.webSize,this.flangeSize=e.flangeSize}}let th={height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2040},width:{displayName:"Width",typeSchema:{type:"Number"},defaultValue:920}};const ih=new Ae({typeName:"BarnPADoor",displayName:"Barn PA Door",propertiesSchema:th}),nh=ih;class rh{constructor(){this.componentType=nh}create(e,n,r,o,l){return new lh(n,r,o,l)}}let Tl=new rh;Be(Tl);class lh{constructor(e,n,r,o){this.type=Tl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new vl({height:()=>e.height,width:()=>e.width,frameTimberItemName:()=>"100x40",frameTimberProperties:t(()=>new et({webSize:100,flangeSize:40})),frameBraceTimberItemName:()=>"60x40",frameBraceTimberProperties:t(()=>new et({webSize:60,flangeSize:40}))});this.components=l.components,this.properties=t(()=>[{displayName:"Barn PA Door",fields:[se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),se({displayName:()=>"Width",value:()=>e.width,setValue:s=>n("width",s)})],expanded:()=>!0}])}}class oh{constructor(e){let n=t(()=>new T({itemName:e.memberItemName,length:e.height,rhsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.memberProperties().flangeSize,0,0),y.fromUV(i.unitZ,i.unitY)))})),r=t(()=>new T({itemName:e.memberItemName,length:e.height,rhsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.width(),0,0),y.fromUV(i.unitZ,i.unitY)))})),o=t(()=>new T({itemName:e.memberItemName,length:e.width,rhsProperties:e.memberProperties,transform:t(()=>m.create(i.zero,y.identity))})),l=t(()=>new T({itemName:e.memberItemName,length:e.width,rhsProperties:e.memberProperties,transform:t(()=>m.create(i.create(0,0,e.height()-e.memberProperties().flangeSize),y.identity))})),s=t(()=>e.height()-2*e.memberProperties().flangeSize),a=t(()=>{let b=.5*e.memberProperties().flangeSize,w=e.width()-.5*e.memberProperties().flangeSize-b,p=Math.ceil(w/e.maxStudSpacing()),g=w/p,P=p-1;return Array(P).fill(void 0).map((M,v)=>b+g*(v+1))}),h=t(()=>a().map(b=>new T({itemName:e.studItemName,length:s,rhsProperties:e.studProperties,transform:t(()=>m.create(i.create(b+.5*e.studProperties().flangeSize,0,e.memberProperties().flangeSize),y.fromUV(i.unitZ,i.unitY)))}))),d=t(()=>{if(e.useSteelCladding())return[];let b=0,w=e.height()-b,p=Math.floor((w+e.timberGapSize())/(e.timberProperties().webSize+e.timberGapSize())),g=e.timberProperties().webSize+e.timberGapSize();return Array(p).fill(void 0).map((P,M)=>b+.5*e.timberProperties().webSize+M*g)}),c=t(()=>d().map(b=>new T({itemName:e.timberItemName,layers:()=>[ve.Cladding],length:e.width,timberProperties:e.timberProperties,fixedCost:t(()=>({cost:e.timberFixedCost(),unit:"/m"})),transform:t(()=>m.create(i.create(0,0,b-.5*e.timberProperties().webSize),y.fromUV(i.unitX,i.unitZ)))}))),u=t(()=>{if(!!e.useSteelCladding())return{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.width(),0),f.create(e.width(),e.height()),f.create(0,e.height())]),openings:t(()=>[]),colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Horizontal",previewOpening:()=>{}}),space:()=>m.identity}}),S=t(()=>Pe(u()).map(({sheeting:b,space:N})=>new T({children:b.components,transform:N})));this.components=t(()=>[n(),r(),o(),l(),...h(),...c(),...S()])}}class sh{constructor(e){let n=e.studItemName,r=e.studProperties,o=t(()=>e.pitch()*Math.PI/180),l=t(()=>Math.cos(o())),s=t(()=>Math.sin(o())),a=t(()=>Math.tan(o())),h=t(()=>e.height()+e.span()*a()),d=t(()=>[new T({itemName:e.memberItemName,length:h,shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.memberProperties().size,e.memberProperties().size,0),y.fromUV(i.unitZ,i.negUnitX)))}),new T({itemName:e.memberItemName,length:h,shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.length()-e.memberProperties().size,0,0),y.fromUV(i.unitZ,i.unitX)))}),new T({itemName:e.memberItemName,length:e.height,shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.memberProperties().size,e.span(),0),y.fromUV(i.unitZ,i.negUnitX)))}),new T({itemName:e.memberItemName,length:e.height,shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.length()-e.memberProperties().size,e.span()-e.memberProperties().size,0),y.fromUV(i.unitZ,i.unitX)))})]),c=t(()=>e.span()/l()),u=t(()=>[new T({itemName:e.memberItemName,length:c,shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.memberProperties().size,e.span(),e.height()),y.fromUV(i.create(0,-l(),s()),i.negUnitX)))}),new T({itemName:e.memberItemName,length:c,shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.length()-e.memberProperties().size,0,h()),y.fromUV(i.create(0,l(),-s()),i.unitX)))})]),S=t(()=>(e.span()-2*e.memberProperties().size)/l()+r().webSize*a()),b=t(()=>{let x=e.memberProperties().size-.5*r().flangeSize,I=e.length()-e.memberProperties().size+.5*r().flangeSize-x,O=Math.ceil(I/e.maxPurlinSpacing()),E=I/O,F=O-1;return Array(F).fill(void 0).map(($,G)=>x+(G+1)*E)}),N=t(()=>b().map(x=>new T({itemName:n,length:S,rhsProperties:r,transform:t(()=>m.create(i.create(x-.5*r().flangeSize,e.memberProperties().size-r().webSize*s(),h()-(e.memberProperties().size-r().webSize*s())*a()-r().webSize/l()),y.fromWU(i.unitX,i.create(0,l(),-s()))))}))),w=t(()=>[new T({itemName:e.memberItemName,length:t(()=>e.span()-2*e.memberProperties().size),shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.memberProperties().size,e.span()-e.memberProperties().size,e.memberProperties().size),y.fromUV(i.negUnitY,i.negUnitX)))}),new T({itemName:e.memberItemName,length:t(()=>e.span()-2*e.memberProperties().size),shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.length()-e.memberProperties().size,e.memberProperties().size,e.memberProperties().size),y.fromUV(i.unitY,i.unitX)))}),new T({itemName:e.memberItemName,length:t(()=>e.length()-2*e.memberProperties().size),shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.length()-e.memberProperties().size,e.span()-e.memberProperties().size,e.memberProperties().size),y.fromUV(i.negUnitX,i.unitY)))})]),p=t(()=>[new T({itemName:e.memberItemName,length:t(()=>e.length()-2*e.memberProperties().size),shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.memberProperties().size,0,h()-e.memberProperties().size*a()-e.memberProperties().size),y.identity))}),new T({itemName:e.memberItemName,length:t(()=>e.length()-2*e.memberProperties().size),shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(e.length()-e.memberProperties().size,e.span()-e.memberProperties().size,e.height()),y.fromUV(i.negUnitX,i.unitY)))})]),g=t(()=>{let x=e.memberProperties().size-.5*e.studProperties().flangeSize,I=e.length()-e.memberProperties().size+.5*e.studProperties().flangeSize-x,O=Math.ceil(I/e.maxStudSpacing()),E=I/O,F=O-1;return Array(F).fill(void 0).map(($,G)=>x+(G+1)*E)}),P=t(()=>{let x=t(()=>e.height()-2*e.memberProperties().size);return g().map(A=>new T({itemName:e.studItemName,length:x,rhsProperties:e.studProperties,transform:t(()=>m.create(i.create(A+.5*e.studProperties().flangeSize,e.span()-e.studProperties().webSize,e.memberProperties().size),y.fromUV(i.unitZ,i.unitY)))}))}),M=t(()=>{let x=e.memberProperties().size-.5*e.studProperties().flangeSize,I=e.span()-e.memberProperties().size+.5*e.studProperties().flangeSize-x,O=Math.ceil(I/e.maxStudSpacing()),E=I/O,F=O-1;return Array(F).fill(void 0).map(($,G)=>x+(G+1)*E)}),v=t(()=>M().flatMap(x=>[new T({itemName:e.studItemName,length:t(()=>h()-e.memberProperties().size/l()-(x-.5*e.studProperties().flangeSize)*a()-e.memberProperties().size),rhsProperties:e.studProperties,transform:t(()=>m.create(i.create(e.studProperties().webSize,x+.5*e.studProperties().flangeSize,e.memberProperties().size),y.fromUV(i.unitZ,i.negUnitX)))}),new T({itemName:e.studItemName,length:t(()=>h()-e.memberProperties().size/l()-(x-.5*e.studProperties().flangeSize)*a()-e.memberProperties().size),rhsProperties:e.studProperties,transform:t(()=>m.create(i.create(e.length()-e.studProperties().webSize,x-.5*e.studProperties().flangeSize,e.memberProperties().size),y.fromUV(i.unitZ,i.unitX)))})])),k=t(()=>d().length*2+P().length*2+v().length*2+N().length*2+w().length*2+p().length*2),z=t(()=>new T({itemName:()=>"Welding Labour",qty:k,fixedCost:t(()=>({cost:e.weldingLabourFixedCost(),unit:"/ea"}))}));this.components=t(()=>[...d(),...u(),...N(),...w(),...p(),...P(),...v(),z()])}}class xn{constructor(e){let n=t(()=>{let a=e.outline();if(a.length==0)return;let h=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;for(let S of a)h=Math.min(h,S.x),d=Math.max(d,S.x),c=Math.min(c,S.y),u=Math.max(u,S.y);return{minX:h,maxX:d,minY:c,maxY:u}}),r=(a,h)=>{let d=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,u=e.outline();for(let b of u)a<=b.y&&b.y<=h&&(d=Math.min(d,b.x),c=Math.max(c,b.x));let S=b=>{for(let N=0;N<u.length;++N){let w=(N+1)%u.length,p=u[N],g=u[w];if(Math.min(p.y,g.y)<=b&&b<=Math.max(p.y,g.y)){let P=p.x+(b-p.y)*(g.x-p.x)/(g.y-p.y);if(!Number.isFinite(P))continue;d=Math.min(d,P),c=Math.max(c,P)}}};if(S(a),S(h),!!Number.isFinite(d))return{minX:d,maxX:c}},o=t(()=>{let a=n();if(a==null)return[];let h=a.minY,c=a.maxY-h,u=Math.ceil((c-e.timberGapSize())/(e.timberProperties().webSize+e.timberGapSize())),S=e.timberProperties().webSize+e.timberGapSize();return Array(u).fill(void 0).map((b,N)=>h+.5*e.timberProperties().webSize+N*S)}),l=t(()=>o().flatMap(a=>{let h=r(a-.5*e.timberProperties().webSize,a+.5*e.timberProperties().webSize);if(h==null)return[];let d=h.minX,u=h.maxX-d;return[new T({itemName:e.timberItemName,layers:t(()=>[ve.Cladding]),length:()=>u,fixedCost:t(()=>({cost:e.timberFixedCost(),unit:"/m"})),transform:t(()=>m.create(i.create(d,0,a-.5*e.timberProperties().webSize),y.fromUV(i.unitX,i.unitZ)))})]})),s=t(()=>new T({layers:t(()=>[ve.Cladding]),mkObject3d:t(()=>a=>{let h=n(),d=e.outline();if(h==null||d.length<3)return new nt;let c=h.maxX-h.minX,u=.001,S=[];for(let A of o()){let I=new Ni(c*u,e.timberProperties().webSize*u,e.timberProperties().flangeSize*u);I.rotateX(.5*Math.PI),I.translate((h.minX+.5*c)*u,-.5*e.timberProperties().flangeSize*u,A*u),S.push(I)}let b=ir(S),N;{let A=new Et;A.moveTo(d[0].x*u,d[0].y*u);for(let I=1;I<d.length;++I)A.lineTo(d[I].x*u,d[I].y*u);A.closePath(),N=new It(A,{depth:3*e.timberProperties().flangeSize*u,bevelEnabled:!1}),N.rotateX(.5*Math.PI),N.translate(0,1.5*e.timberProperties().flangeSize*u,0)}let w=Pr.fromGeometry(b).intersect(Pr.fromGeometry(N)).toGeometry(new Xi),p=new nt,g,P=e.timberColour?.call(void 0);P!=null?g=Pt[P].colourHex??"#C08000":g="#C08000";let M=new xt({color:g}),v=new xe(w,M);const k=new Tt({color:"#000000"});let z=new bt(w);const x=new ht(z,k);return b.dispose(),N.dispose(),Fe(()=>{w.dispose(),M.dispose(),z.dispose(),k.dispose()}),p.add(v),p.add(x),p})}));this.components=t(()=>[...l(),s()])}}const Fr=50;class ah{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=t(()=>e.height()+e.span()*l()),a=()=>"75x3.0 SHS",h=t(()=>Qt[a()]),d=()=>"75x50x3.0 RHS",c=t(()=>Ri[d()]),u=()=>"75x50x3.0 RHS",S=t(()=>Ri[u()]),b=()=>"75x50x3.0 RHS",N=t(()=>Ri[b()]),w=(()=>{let G=t(()=>e.openedAngle()*Math.PI/180),J=t(()=>Math.cos(G())),K=t(()=>Math.sin(G())),te=t(()=>s()-h().size*l()-h().size);return{door:new oh({width:t(()=>e.length()-2*h().size),height:te,memberItemName:u,memberProperties:S,studItemName:b,studProperties:N,maxStudSpacing:e.maxStudSpacing,useSteelCladding:e.useSteelCladding,timberItemName:e.timberItemName,timberProperties:e.timberProperties,timberGapSize:e.timberGapSize,timberFixedCost:e.timberFixedCost}),space:t(()=>m.create(i.create(h().size,-te()*K(),te()-te()*J()),y.fromWU(i.create(0,K(),J()),i.unitX)))}})(),p=t(()=>new T({children:w.door.components,transform:w.space})),g=new sh({span:e.span,length:e.length,height:e.height,pitch:e.pitch,memberItemName:a,memberProperties:h,studItemName:d,studProperties:c,maxStudSpacing:e.maxStudSpacing,maxPurlinSpacing:e.maxPurlinSpacing,weldingLabourFixedCost:e.weldingLabourFixedCost}),P=t(()=>new T({children:g.components,transform:()=>m.identity})),M=t(()=>{let G=t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())]),J=t(()=>[f.create(0,0),f.create(e.span(),0),f.create(e.span(),s()),f.create(0,e.height())]),K=t(()=>[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(0,s())]);return[{cladding:e.useSteelCladding()?new Te({type:()=>"Wall Sheeting",outline:G,openings:t(()=>[]),colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Horizontal",previewOpening:()=>{}}):new xn({outline:G,timberItemName:e.timberItemName,timberProperties:e.timberProperties,timberGapSize:e.timberGapSize,timberFixedCost:e.timberFixedCost}),space:t(()=>m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))},{cladding:e.useSteelCladding()?new Te({type:()=>"Wall Sheeting",outline:J,openings:t(()=>[]),colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Horizontal",previewOpening:()=>{}}):new xn({outline:J,timberItemName:e.timberItemName,timberProperties:e.timberProperties,timberGapSize:e.timberGapSize,timberFixedCost:e.timberFixedCost}),space:t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))},{cladding:e.useSteelCladding()?new Te({type:()=>"Wall Sheeting",outline:K,openings:t(()=>[]),colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Horizontal",previewOpening:()=>{}}):new xn({outline:K,timberItemName:e.timberItemName,timberProperties:e.timberProperties,timberGapSize:e.timberGapSize,timberFixedCost:e.timberFixedCost}),space:t(()=>m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)))}]}),v=t(()=>M().map(({cladding:G,space:J})=>new T({children:G.components,transform:J}))),k=t(()=>[{sheetedArea:new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-Fr),f.create(e.length(),-Fr),f.create(e.length(),e.span()/r()),f.create(0,e.span()/r())]),openings:()=>[],colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",sheetingLowPoly:()=>!1,previewOpening:()=>{}}),space:m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.create(0,-r(),o()),i.negUnitX))}]),z=t(()=>k().map(({sheetedArea:G,space:J})=>new T({children:G.components,transform:()=>J}))),x=t(()=>e.span()/r()+200),A=t(()=>i.create(0,r()*30,o()*30)),I=t(()=>i.create(0,r()*170,-o()*170)),O=t(()=>{let G="Flashing - Barge Corrugated CB";return[new T({itemName:()=>G,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-50,0,s()+35/r()).add(A()),y.fromUV(i.create(0,r(),-o()),i.negUnitX)),length:x,flashingProfile:()=>tt}),new T({itemName:()=>G,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+50,e.span(),e.height()+35/r()).add(I()),y.fromUV(i.create(0,-r(),o()),i.unitX)),length:x,flashingProfile:()=>tt}),new T({itemName:()=>G,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length(),-30,s()+30/r()),y.fromUV(i.negUnitX,i.negUnitY)),length:()=>e.length(),flashingProfile:()=>tt})]}),E=t(()=>{if(!e.useSteelCladding())return[];let G="Flashing - Corner 50 x 50";return[new T({itemName:()=>G,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,-30,0),y.fromUV(i.unitZ,i.unitX)),length:s,flashingProfile:()=>ut}),new T({itemName:()=>G,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,-30,0),y.fromUV(i.unitZ,i.unitY)),length:s,flashingProfile:()=>ut}),new T({itemName:()=>G,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitX)),length:e.height,flashingProfile:()=>ut}),new T({itemName:()=>G,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitY)),length:e.height,flashingProfile:()=>ut})]}),F=t(()=>[{gutter:new jt({length:e.length}),space:m.create(i.create(e.length(),e.span()+50,e.height()),y.fromWU(i.unitZ,i.negUnitX))}]),$=t(()=>F().map(({gutter:G,space:J})=>new T({children:G.components,transform:()=>J})));this.components=t(()=>[p(),P(),...v(),...z(),...O(),...E(),...$()])}}const hh=8,ch="140 x 19mm Merbau",dh=140,uh=19,fh=15,ph=11.25;let mh={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:2e3},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:4e3},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2400},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:10},openedAngle:{displayName:"Opened Angle",typeSchema:{type:"Number"},defaultValue:0},maxStudSpacing:{displayName:"Max Stud Spacing",typeSchema:{type:"Number"},defaultValue:1200,optional:!0},maxPurlinSpacing:{displayName:"Max Purlin Spacing",typeSchema:{type:"Number"},defaultValue:1200,optional:!0},weldingLabourFixedCost:{displayName:"Welded Labour Fixed Cost",typeSchema:{type:"Number"},defaultValue:hh,optional:!0},useSteelCladding:{displayName:"Use Steel Cladding",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},timberItemName:{displayName:"Timber Item Name",typeSchema:{type:"String"},defaultValue:ch,optional:!0},timberWebSize:{displayName:"Timber Web Size",typeSchema:{type:"Number"},defaultValue:dh,optional:!0},timberFlangeSize:{displayName:"Timber Flange Size",typeSchema:{type:"Number"},defaultValue:uh,optional:!0},timberGapSize:{displayName:"Timber Gap Size",typeSchema:{type:"Number"},defaultValue:fh,optional:!0},timberFixedCost:{displayName:"Timber Fixed Cost",typeSchema:{type:"Number"},defaultValue:ph,optional:!0}};const gh=new Ae({typeName:"BbqPod",displayName:"BBQ Pod",propertiesSchema:mh}),yh=gh;class bh{constructor(){this.componentType=yh}create(e,n,r,o,l){return new wh(n,r,o,l)}}let kl=new bh;Be(kl);class wh{constructor(e,n,r,o){this.type=kl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new ah({span:()=>e.span,length:()=>e.length,height:()=>e.height,pitch:()=>e.pitch,openedAngle:()=>e.openedAngle,maxStudSpacing:()=>e.maxStudSpacing,maxPurlinSpacing:()=>e.maxPurlinSpacing,weldingLabourFixedCost:()=>e.weldingLabourFixedCost,useSteelCladding:()=>e.useSteelCladding,timberItemName:()=>e.timberItemName,timberProperties:t(()=>new et({webSize:e.timberWebSize,flangeSize:e.timberFlangeSize})),timberGapSize:()=>e.timberGapSize,timberFixedCost:()=>e.timberFixedCost});this.components=l.components;let s={displayName:"Timber Properties",fields:[jn({displayName:()=>"Item Name",value:()=>e.timberItemName,setValue:a=>n("timberItemName",a)}),se({displayName:()=>"Width",value:()=>e.timberWebSize,setValue:a=>n("timberWebSize",a)}),se({displayName:()=>"Height",value:()=>e.timberFlangeSize,setValue:a=>n("timberFlangeSize",a)}),se({displayName:()=>"Gap Size",value:()=>e.timberGapSize,setValue:a=>n("timberGapSize",a)}),se({displayName:()=>"Cost",value:()=>e.timberFixedCost,setValue:a=>n("timberFixedCost",a)})],expanded:()=>!0};this.properties=t(()=>[{displayName:"Properties",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:a=>n("span",a)}),se({displayName:()=>"Length",value:()=>e.length,setValue:a=>n("length",a)}),se({displayName:()=>"Height",value:()=>e.height,setValue:a=>n("height",a)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:a=>n("pitch",a)}),yn({displayName:()=>"Opened Angle",value:()=>e.openedAngle,setValue:a=>n("openedAngle",a),minValue:()=>0,maxValue:()=>90,stepSize:()=>1}),se({displayName:()=>"Max Stud Spacing",value:()=>e.maxStudSpacing,setValue:a=>n("maxStudSpacing",a)}),se({displayName:()=>"Max Purlin Spacing",value:()=>e.maxPurlinSpacing,setValue:a=>n("maxPurlinSpacing",a)}),se({displayName:()=>"Welding Labour $/weld",value:()=>e.weldingLabourFixedCost,setValue:a=>n("weldingLabourFixedCost",a)}),kt({displayName:()=>"Use Steel Cladding",value:()=>e.useSteelCladding,setValue:a=>n("useSteelCladding",a)})],expanded:()=>!0},...e.useSteelCladding?[]:[s]])}}const Sh=Ii;class _i extends Zn{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,n,r,o){const l=this,s=new gn(l.manager);s.setPath(l.path),s.setRequestHeader(l.requestHeader),s.setWithCredentials(l.withCredentials),s.load(e,function(a){try{n(l.parse(a))}catch(h){o?o(h):console.error(h),l.manager.itemError(e)}},r,o)}parse(e){const n=this;function r(Q,R){if(Q.nodeType!==1)return;const V=v(Q);let L=!1,ne=null;switch(Q.nodeName){case"svg":R=N(Q,R);break;case"style":l(Q);break;case"g":R=N(Q,R);break;case"path":R=N(Q,R),Q.hasAttribute("d")&&(ne=o(Q));break;case"rect":R=N(Q,R),ne=h(Q);break;case"polygon":R=N(Q,R),ne=d(Q);break;case"polyline":R=N(Q,R),ne=c(Q);break;case"circle":R=N(Q,R),ne=u(Q);break;case"ellipse":R=N(Q,R),ne=S(Q);break;case"line":R=N(Q,R),ne=b(Q);break;case"defs":L=!0;break;case"use":R=N(Q,R);const me=(Q.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),ye=Q.viewportElement.getElementById(me);ye?r(ye,R):console.warn("SVGLoader: 'use node' references non-existent node id: "+me);break}ne&&(R.fill!==void 0&&R.fill!=="none"&&ne.color.setStyle(R.fill,Sh),z(ne,ce),F.push(ne),ne.userData={node:Q,style:R});const he=Q.childNodes;for(let le=0;le<he.length;le++){const me=he[le];L&&me.nodeName!=="style"&&me.nodeName!=="defs"||r(me,R)}V&&(G.pop(),G.length>0?ce.copy(G[G.length-1]):ce.identity())}function o(Q){const R=new si,V=new De,L=new De,ne=new De;let he=!0,le=!1;const me=Q.getAttribute("d");if(me===""||me==="none")return null;const ye=me.match(/[a-df-z][^a-df-z]*/ig);for(let W=0,D=ye.length;W<D;W++){const H=ye[W],X=H.charAt(0),Z=H.slice(1).trim();he===!0&&(le=!0,he=!1);let U;switch(X){case"M":U=p(Z);for(let B=0,j=U.length;B<j;B+=2)V.x=U[B+0],V.y=U[B+1],L.x=V.x,L.y=V.y,B===0?R.moveTo(V.x,V.y):R.lineTo(V.x,V.y),B===0&&ne.copy(V);break;case"H":U=p(Z);for(let B=0,j=U.length;B<j;B++)V.x=U[B],L.x=V.x,L.y=V.y,R.lineTo(V.x,V.y),B===0&&le===!0&&ne.copy(V);break;case"V":U=p(Z);for(let B=0,j=U.length;B<j;B++)V.y=U[B],L.x=V.x,L.y=V.y,R.lineTo(V.x,V.y),B===0&&le===!0&&ne.copy(V);break;case"L":U=p(Z);for(let B=0,j=U.length;B<j;B+=2)V.x=U[B+0],V.y=U[B+1],L.x=V.x,L.y=V.y,R.lineTo(V.x,V.y),B===0&&le===!0&&ne.copy(V);break;case"C":U=p(Z);for(let B=0,j=U.length;B<j;B+=6)R.bezierCurveTo(U[B+0],U[B+1],U[B+2],U[B+3],U[B+4],U[B+5]),L.x=U[B+2],L.y=U[B+3],V.x=U[B+4],V.y=U[B+5],B===0&&le===!0&&ne.copy(V);break;case"S":U=p(Z);for(let B=0,j=U.length;B<j;B+=4)R.bezierCurveTo(w(V.x,L.x),w(V.y,L.y),U[B+0],U[B+1],U[B+2],U[B+3]),L.x=U[B+0],L.y=U[B+1],V.x=U[B+2],V.y=U[B+3],B===0&&le===!0&&ne.copy(V);break;case"Q":U=p(Z);for(let B=0,j=U.length;B<j;B+=4)R.quadraticCurveTo(U[B+0],U[B+1],U[B+2],U[B+3]),L.x=U[B+0],L.y=U[B+1],V.x=U[B+2],V.y=U[B+3],B===0&&le===!0&&ne.copy(V);break;case"T":U=p(Z);for(let B=0,j=U.length;B<j;B+=2){const oe=w(V.x,L.x),ie=w(V.y,L.y);R.quadraticCurveTo(oe,ie,U[B+0],U[B+1]),L.x=oe,L.y=ie,V.x=U[B+0],V.y=U[B+1],B===0&&le===!0&&ne.copy(V)}break;case"A":U=p(Z,[3,4],7);for(let B=0,j=U.length;B<j;B+=7){if(U[B+5]==V.x&&U[B+6]==V.y)continue;const oe=V.clone();V.x=U[B+5],V.y=U[B+6],L.x=V.x,L.y=V.y,s(R,U[B],U[B+1],U[B+2],U[B+3],U[B+4],oe,V),B===0&&le===!0&&ne.copy(V)}break;case"m":U=p(Z);for(let B=0,j=U.length;B<j;B+=2)V.x+=U[B+0],V.y+=U[B+1],L.x=V.x,L.y=V.y,B===0?R.moveTo(V.x,V.y):R.lineTo(V.x,V.y),B===0&&ne.copy(V);break;case"h":U=p(Z);for(let B=0,j=U.length;B<j;B++)V.x+=U[B],L.x=V.x,L.y=V.y,R.lineTo(V.x,V.y),B===0&&le===!0&&ne.copy(V);break;case"v":U=p(Z);for(let B=0,j=U.length;B<j;B++)V.y+=U[B],L.x=V.x,L.y=V.y,R.lineTo(V.x,V.y),B===0&&le===!0&&ne.copy(V);break;case"l":U=p(Z);for(let B=0,j=U.length;B<j;B+=2)V.x+=U[B+0],V.y+=U[B+1],L.x=V.x,L.y=V.y,R.lineTo(V.x,V.y),B===0&&le===!0&&ne.copy(V);break;case"c":U=p(Z);for(let B=0,j=U.length;B<j;B+=6)R.bezierCurveTo(V.x+U[B+0],V.y+U[B+1],V.x+U[B+2],V.y+U[B+3],V.x+U[B+4],V.y+U[B+5]),L.x=V.x+U[B+2],L.y=V.y+U[B+3],V.x+=U[B+4],V.y+=U[B+5],B===0&&le===!0&&ne.copy(V);break;case"s":U=p(Z);for(let B=0,j=U.length;B<j;B+=4)R.bezierCurveTo(w(V.x,L.x),w(V.y,L.y),V.x+U[B+0],V.y+U[B+1],V.x+U[B+2],V.y+U[B+3]),L.x=V.x+U[B+0],L.y=V.y+U[B+1],V.x+=U[B+2],V.y+=U[B+3],B===0&&le===!0&&ne.copy(V);break;case"q":U=p(Z);for(let B=0,j=U.length;B<j;B+=4)R.quadraticCurveTo(V.x+U[B+0],V.y+U[B+1],V.x+U[B+2],V.y+U[B+3]),L.x=V.x+U[B+0],L.y=V.y+U[B+1],V.x+=U[B+2],V.y+=U[B+3],B===0&&le===!0&&ne.copy(V);break;case"t":U=p(Z);for(let B=0,j=U.length;B<j;B+=2){const oe=w(V.x,L.x),ie=w(V.y,L.y);R.quadraticCurveTo(oe,ie,V.x+U[B+0],V.y+U[B+1]),L.x=oe,L.y=ie,V.x=V.x+U[B+0],V.y=V.y+U[B+1],B===0&&le===!0&&ne.copy(V)}break;case"a":U=p(Z,[3,4],7);for(let B=0,j=U.length;B<j;B+=7){if(U[B+5]==0&&U[B+6]==0)continue;const oe=V.clone();V.x+=U[B+5],V.y+=U[B+6],L.x=V.x,L.y=V.y,s(R,U[B],U[B+1],U[B+2],U[B+3],U[B+4],oe,V),B===0&&le===!0&&ne.copy(V)}break;case"Z":case"z":R.currentPath.autoClose=!0,R.currentPath.curves.length>0&&(V.copy(ne),R.currentPath.currentPoint.copy(V),he=!0);break;default:console.warn(H)}le=!1}return R}function l(Q){if(!(!Q.sheet||!Q.sheet.cssRules||!Q.sheet.cssRules.length))for(let R=0;R<Q.sheet.cssRules.length;R++){const V=Q.sheet.cssRules[R];if(V.type!==1)continue;const L=V.selectorText.split(/,/gm).filter(Boolean).map(ne=>ne.trim());for(let ne=0;ne<L.length;ne++){const he=Object.fromEntries(Object.entries(V.style).filter(([,le])=>le!==""));$[L[ne]]=Object.assign($[L[ne]]||{},he)}}}function s(Q,R,V,L,ne,he,le,me){if(R==0||V==0){Q.lineTo(me.x,me.y);return}L=L*Math.PI/180,R=Math.abs(R),V=Math.abs(V);const ye=(le.x-me.x)/2,W=(le.y-me.y)/2,D=Math.cos(L)*ye+Math.sin(L)*W,H=-Math.sin(L)*ye+Math.cos(L)*W;let X=R*R,Z=V*V;const U=D*D,B=H*H,j=U/X+B/Z;if(j>1){const Xe=Math.sqrt(j);R=Xe*R,V=Xe*V,X=R*R,Z=V*V}const oe=X*B+Z*U,ie=(X*Z-oe)/oe;let ae=Math.sqrt(Math.max(0,ie));ne===he&&(ae=-ae);const be=ae*R*H/V,we=-ae*V*D/R,ke=Math.cos(L)*be-Math.sin(L)*we+(le.x+me.x)/2,Ve=Math.sin(L)*be+Math.cos(L)*we+(le.y+me.y)/2,Se=a(1,0,(D-be)/R,(H-we)/V),Le=a((D-be)/R,(H-we)/V,(-D-be)/R,(-H-we)/V)%(Math.PI*2);Q.currentPath.absellipse(ke,Ve,R,V,Se,Se+Le,he===0,L)}function a(Q,R,V,L){const ne=Q*V+R*L,he=Math.sqrt(Q*Q+R*R)*Math.sqrt(V*V+L*L);let le=Math.acos(Math.max(-1,Math.min(1,ne/he)));return Q*L-R*V<0&&(le=-le),le}function h(Q){const R=M(Q.getAttribute("x")||0),V=M(Q.getAttribute("y")||0),L=M(Q.getAttribute("rx")||Q.getAttribute("ry")||0),ne=M(Q.getAttribute("ry")||Q.getAttribute("rx")||0),he=M(Q.getAttribute("width")),le=M(Q.getAttribute("height")),me=1-.551915024494,ye=new si;return ye.moveTo(R+L,V),ye.lineTo(R+he-L,V),(L!==0||ne!==0)&&ye.bezierCurveTo(R+he-L*me,V,R+he,V+ne*me,R+he,V+ne),ye.lineTo(R+he,V+le-ne),(L!==0||ne!==0)&&ye.bezierCurveTo(R+he,V+le-ne*me,R+he-L*me,V+le,R+he-L,V+le),ye.lineTo(R+L,V+le),(L!==0||ne!==0)&&ye.bezierCurveTo(R+L*me,V+le,R,V+le-ne*me,R,V+le-ne),ye.lineTo(R,V+ne),(L!==0||ne!==0)&&ye.bezierCurveTo(R,V+ne*me,R+L*me,V,R+L,V),ye}function d(Q){function R(he,le,me){const ye=M(le),W=M(me);ne===0?L.moveTo(ye,W):L.lineTo(ye,W),ne++}const V=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,L=new si;let ne=0;return Q.getAttribute("points").replace(V,R),L.currentPath.autoClose=!0,L}function c(Q){function R(he,le,me){const ye=M(le),W=M(me);ne===0?L.moveTo(ye,W):L.lineTo(ye,W),ne++}const V=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,L=new si;let ne=0;return Q.getAttribute("points").replace(V,R),L.currentPath.autoClose=!1,L}function u(Q){const R=M(Q.getAttribute("cx")||0),V=M(Q.getAttribute("cy")||0),L=M(Q.getAttribute("r")||0),ne=new Mn;ne.absarc(R,V,L,0,Math.PI*2);const he=new si;return he.subPaths.push(ne),he}function S(Q){const R=M(Q.getAttribute("cx")||0),V=M(Q.getAttribute("cy")||0),L=M(Q.getAttribute("rx")||0),ne=M(Q.getAttribute("ry")||0),he=new Mn;he.absellipse(R,V,L,ne,0,Math.PI*2);const le=new si;return le.subPaths.push(he),le}function b(Q){const R=M(Q.getAttribute("x1")||0),V=M(Q.getAttribute("y1")||0),L=M(Q.getAttribute("x2")||0),ne=M(Q.getAttribute("y2")||0),he=new si;return he.moveTo(R,V),he.lineTo(L,ne),he.currentPath.autoClose=!1,he}function N(Q,R){R=Object.assign({},R);let V={};if(Q.hasAttribute("class")){const le=Q.getAttribute("class").split(/\s/).filter(Boolean).map(me=>me.trim());for(let me=0;me<le.length;me++)V=Object.assign(V,$["."+le[me]])}Q.hasAttribute("id")&&(V=Object.assign(V,$["#"+Q.getAttribute("id")]));function L(le,me,ye){ye===void 0&&(ye=function(D){return D.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),D}),Q.hasAttribute(le)&&(R[me]=ye(Q.getAttribute(le))),V[le]&&(R[me]=ye(V[le])),Q.style&&Q.style[le]!==""&&(R[me]=ye(Q.style[le]))}function ne(le){return Math.max(0,Math.min(1,M(le)))}function he(le){return Math.max(0,M(le))}return L("fill","fill"),L("fill-opacity","fillOpacity",ne),L("fill-rule","fillRule"),L("opacity","opacity",ne),L("stroke","stroke"),L("stroke-opacity","strokeOpacity",ne),L("stroke-width","strokeWidth",he),L("stroke-linejoin","strokeLineJoin"),L("stroke-linecap","strokeLineCap"),L("stroke-miterlimit","strokeMiterLimit",he),L("visibility","visibility"),R}function w(Q,R){return Q-(R-Q)}function p(Q,R,V){if(typeof Q!="string")throw new TypeError("Invalid input: "+typeof Q);const L={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},ne=0,he=1,le=2,me=3;let ye=ne,W=!0,D="",H="";const X=[];function Z(oe,ie,ae){const be=new SyntaxError('Unexpected character "'+oe+'" at index '+ie+".");throw be.partial=ae,be}function U(){D!==""&&(H===""?X.push(Number(D)):X.push(Number(D)*Math.pow(10,Number(H)))),D="",H=""}let B;const j=Q.length;for(let oe=0;oe<j;oe++){if(B=Q[oe],Array.isArray(R)&&R.includes(X.length%V)&&L.FLAGS.test(B)){ye=he,D=B,U();continue}if(ye===ne){if(L.WHITESPACE.test(B))continue;if(L.DIGIT.test(B)||L.SIGN.test(B)){ye=he,D=B;continue}if(L.POINT.test(B)){ye=le,D=B;continue}L.COMMA.test(B)&&(W&&Z(B,oe,X),W=!0)}if(ye===he){if(L.DIGIT.test(B)){D+=B;continue}if(L.POINT.test(B)){D+=B,ye=le;continue}if(L.EXP.test(B)){ye=me;continue}L.SIGN.test(B)&&D.length===1&&L.SIGN.test(D[0])&&Z(B,oe,X)}if(ye===le){if(L.DIGIT.test(B)){D+=B;continue}if(L.EXP.test(B)){ye=me;continue}L.POINT.test(B)&&D[D.length-1]==="."&&Z(B,oe,X)}if(ye===me){if(L.DIGIT.test(B)){H+=B;continue}if(L.SIGN.test(B)){if(H===""){H+=B;continue}H.length===1&&L.SIGN.test(H)&&Z(B,oe,X)}}L.WHITESPACE.test(B)?(U(),ye=ne,W=!1):L.COMMA.test(B)?(U(),ye=ne,W=!0):L.SIGN.test(B)?(U(),ye=he,D=B):L.POINT.test(B)?(U(),ye=le,D=B):Z(B,oe,X)}return U(),X}const g=["mm","cm","in","pt","pc","px"],P={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function M(Q){let R="px";if(typeof Q=="string"||Q instanceof String)for(let L=0,ne=g.length;L<ne;L++){const he=g[L];if(Q.endsWith(he)){R=he,Q=Q.substring(0,Q.length-he.length);break}}let V;return R==="px"&&n.defaultUnit!=="px"?V=P.in[n.defaultUnit]/n.defaultDPI:(V=P[R][n.defaultUnit],V<0&&(V=P[R].in*n.defaultDPI)),V*parseFloat(Q)}function v(Q){if(!(Q.hasAttribute("transform")||Q.nodeName==="use"&&(Q.hasAttribute("x")||Q.hasAttribute("y"))))return null;const R=k(Q);return G.length>0&&R.premultiply(G[G.length-1]),ce.copy(R),G.push(R),R}function k(Q){const R=new vi,V=J;if(Q.nodeName==="use"&&(Q.hasAttribute("x")||Q.hasAttribute("y"))){const L=M(Q.getAttribute("x")),ne=M(Q.getAttribute("y"));R.translate(L,ne)}if(Q.hasAttribute("transform")){const L=Q.getAttribute("transform").split(")");for(let ne=L.length-1;ne>=0;ne--){const he=L[ne].trim();if(he==="")continue;const le=he.indexOf("("),me=he.length;if(le>0&&le<me){const ye=he.slice(0,le),W=p(he.slice(le+1));switch(V.identity(),ye){case"translate":if(W.length>=1){const D=W[0];let H=0;W.length>=2&&(H=W[1]),V.translate(D,H)}break;case"rotate":if(W.length>=1){let D=0,H=0,X=0;D=W[0]*Math.PI/180,W.length>=3&&(H=W[1],X=W[2]),K.makeTranslation(-H,-X),te.makeRotation(D),_.multiplyMatrices(te,K),K.makeTranslation(H,X),V.multiplyMatrices(K,_)}break;case"scale":if(W.length>=1){const D=W[0];let H=D;W.length>=2&&(H=W[1]),V.scale(D,H)}break;case"skewX":W.length===1&&V.set(1,Math.tan(W[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":W.length===1&&V.set(1,0,0,Math.tan(W[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":W.length===6&&V.set(W[0],W[2],W[4],W[1],W[3],W[5],0,0,1);break}}R.premultiply(V)}}return R}function z(Q,R){function V(le){ee.set(le.x,le.y,1).applyMatrix3(R),le.set(ee.x,ee.y)}function L(le){const me=le.xRadius,ye=le.yRadius,W=Math.cos(le.aRotation),D=Math.sin(le.aRotation),H=new je(me*W,me*D,0),X=new je(-ye*D,ye*W,0),Z=H.applyMatrix3(R),U=X.applyMatrix3(R),B=J.set(Z.x,U.x,0,Z.y,U.y,0,0,0,1),j=K.copy(B).invert(),ae=te.copy(j).transpose().multiply(j).elements,be=E(ae[0],ae[1],ae[4]),we=Math.sqrt(be.rt1),ke=Math.sqrt(be.rt2);if(le.xRadius=1/we,le.yRadius=1/ke,le.aRotation=Math.atan2(be.sn,be.cs),!((le.aEndAngle-le.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const Se=K.set(we,0,0,0,ke,0,0,0,1),Le=te.set(be.cs,be.sn,0,-be.sn,be.cs,0,0,0,1),Xe=Se.multiply(Le).multiply(B),Ke=Nt=>{const{x:fi,y:qt}=new je(Math.cos(Nt),Math.sin(Nt),0).applyMatrix3(Xe);return Math.atan2(qt,fi)};le.aStartAngle=Ke(le.aStartAngle),le.aEndAngle=Ke(le.aEndAngle),x(R)&&(le.aClockwise=!le.aClockwise)}}function ne(le){const me=I(R),ye=O(R);le.xRadius*=me,le.yRadius*=ye;const W=me>Number.EPSILON?Math.atan2(R.elements[1],R.elements[0]):Math.atan2(-R.elements[3],R.elements[4]);le.aRotation+=W,x(R)&&(le.aStartAngle*=-1,le.aEndAngle*=-1,le.aClockwise=!le.aClockwise)}const he=Q.subPaths;for(let le=0,me=he.length;le<me;le++){const W=he[le].curves;for(let D=0;D<W.length;D++){const H=W[D];H.isLineCurve?(V(H.v1),V(H.v2)):H.isCubicBezierCurve?(V(H.v0),V(H.v1),V(H.v2),V(H.v3)):H.isQuadraticBezierCurve?(V(H.v0),V(H.v1),V(H.v2)):H.isEllipseCurve&&(Y.set(H.aX,H.aY),V(Y),H.aX=Y.x,H.aY=Y.y,A(R)?L(H):ne(H))}}}function x(Q){const R=Q.elements;return R[0]*R[4]-R[1]*R[3]<0}function A(Q){const R=Q.elements,V=R[0]*R[3]+R[1]*R[4];if(V===0)return!1;const L=I(Q),ne=O(Q);return Math.abs(V/(L*ne))>Number.EPSILON}function I(Q){const R=Q.elements;return Math.sqrt(R[0]*R[0]+R[1]*R[1])}function O(Q){const R=Q.elements;return Math.sqrt(R[3]*R[3]+R[4]*R[4])}function E(Q,R,V){let L,ne,he,le,me;const ye=Q+V,W=Q-V,D=Math.sqrt(W*W+4*R*R);return ye>0?(L=.5*(ye+D),me=1/L,ne=Q*me*V-R*me*R):ye<0?ne=.5*(ye-D):(L=.5*D,ne=-.5*D),W>0?he=W+D:he=W-D,Math.abs(he)>2*Math.abs(R)?(me=-2*R/he,le=1/Math.sqrt(1+me*me),he=me*le):Math.abs(R)===0?(he=1,le=0):(me=-.5*he/R,he=1/Math.sqrt(1+me*me),le=me*he),W>0&&(me=he,he=-le,le=me),{rt1:L,rt2:ne,cs:he,sn:le}}const F=[],$={},G=[],J=new vi,K=new vi,te=new vi,_=new vi,Y=new De,ee=new je,ce=new vi,Ce=new DOMParser().parseFromString(e,"image/svg+xml");return r(Ce.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:F,xml:Ce.documentElement}}static createShapes(e){const r={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},o={loc:r.ORIGIN,t:0};function l(w,p,g,P){const M=w.x,v=p.x,k=g.x,z=P.x,x=w.y,A=p.y,I=g.y,O=P.y,E=(z-k)*(x-I)-(O-I)*(M-k),F=(v-M)*(x-I)-(A-x)*(M-k),$=(O-I)*(v-M)-(z-k)*(A-x),G=E/$,J=F/$;if($===0&&E!==0||G<=0||G>=1||J<0||J>1)return null;if(E===0&&$===0){for(let K=0;K<2;K++)if(s(K===0?g:P,w,p),o.loc==r.ORIGIN){const te=K===0?g:P;return{x:te.x,y:te.y,t:o.t}}else if(o.loc==r.BETWEEN){const te=+(M+o.t*(v-M)).toPrecision(10),_=+(x+o.t*(A-x)).toPrecision(10);return{x:te,y:_,t:o.t}}return null}else{for(let _=0;_<2;_++)if(s(_===0?g:P,w,p),o.loc==r.ORIGIN){const Y=_===0?g:P;return{x:Y.x,y:Y.y,t:o.t}}const K=+(M+G*(v-M)).toPrecision(10),te=+(x+G*(A-x)).toPrecision(10);return{x:K,y:te,t:G}}}function s(w,p,g){const P=g.x-p.x,M=g.y-p.y,v=w.x-p.x,k=w.y-p.y,z=P*k-v*M;if(w.x===p.x&&w.y===p.y){o.loc=r.ORIGIN,o.t=0;return}if(w.x===g.x&&w.y===g.y){o.loc=r.DESTINATION,o.t=1;return}if(z<-Number.EPSILON){o.loc=r.LEFT;return}if(z>Number.EPSILON){o.loc=r.RIGHT;return}if(P*v<0||M*k<0){o.loc=r.BEHIND;return}if(Math.sqrt(P*P+M*M)<Math.sqrt(v*v+k*k)){o.loc=r.BEYOND;return}let x;P!==0?x=v/P:x=k/M,o.loc=r.BETWEEN,o.t=x}function a(w,p){const g=[],P=[];for(let M=1;M<w.length;M++){const v=w[M-1],k=w[M];for(let z=1;z<p.length;z++){const x=p[z-1],A=p[z],I=l(v,k,x,A);I!==null&&g.find(O=>O.t<=I.t+Number.EPSILON&&O.t>=I.t-Number.EPSILON)===void 0&&(g.push(I),P.push(new De(I.x,I.y)))}}return P}function h(w,p,g){const P=new De;p.getCenter(P);const M=[];return g.forEach(v=>{v.boundingBox.containsPoint(P)&&a(w,v.points).forEach(z=>{M.push({identifier:v.identifier,isCW:v.isCW,point:z})})}),M.sort((v,k)=>v.point.x-k.point.x),M}function d(w,p,g,P,M){(M==null||M==="")&&(M="nonzero");const v=new De;w.boundingBox.getCenter(v);const k=[new De(g,v.y),new De(P,v.y)],z=h(k,w.boundingBox,p);z.sort((F,$)=>F.point.x-$.point.x);const x=[],A=[];z.forEach(F=>{F.identifier===w.identifier?x.push(F):A.push(F)});const I=x[0].point.x,O=[];let E=0;for(;E<A.length&&A[E].point.x<I;)O.length>0&&O[O.length-1]===A[E].identifier?O.pop():O.push(A[E].identifier),E++;if(O.push(w.identifier),M==="evenodd"){const F=O.length%2===0,$=O[O.length-2];return{identifier:w.identifier,isHole:F,for:$}}else if(M==="nonzero"){let F=!0,$=null,G=null;for(let J=0;J<O.length;J++){const K=O[J];F?(G=p[K].isCW,F=!1,$=K):G!==p[K].isCW&&(G=p[K].isCW,F=!0)}return{identifier:w.identifier,isHole:F,for:$}}else console.warn('fill-rule: "'+M+'" is currently not implemented.')}let c=999999999,u=-999999999,S=e.subPaths.map(w=>{const p=w.getPoints();let g=-999999999,P=999999999,M=-999999999,v=999999999;for(let k=0;k<p.length;k++){const z=p[k];z.y>g&&(g=z.y),z.y<P&&(P=z.y),z.x>M&&(M=z.x),z.x<v&&(v=z.x)}return u<=M&&(u=M+1),c>=v&&(c=v-1),{curves:w.curves,points:p,isCW:ss.isClockWise(p),identifier:-1,boundingBox:new as(new De(v,P),new De(M,g))}});S=S.filter(w=>w.points.length>1);for(let w=0;w<S.length;w++)S[w].identifier=w;const b=S.map(w=>d(w,S,c,u,e.userData?e.userData.style.fillRule:void 0)),N=[];return S.forEach(w=>{if(!b[w.identifier].isHole){const g=new Et;g.curves=w.curves,b.filter(M=>M.isHole&&M.for===w.identifier).forEach(M=>{const v=S[M.identifier],k=new Mn;k.curves=v.curves,g.holes.push(k)}),N.push(g)}}),N}static getStrokeStyle(e,n,r,o,l){return e=e!==void 0?e:1,n=n!==void 0?n:"#000",r=r!==void 0?r:"miter",o=o!==void 0?o:"butt",l=l!==void 0?l:4,{strokeColor:n,strokeWidth:e,strokeLineJoin:r,strokeLineCap:o,strokeMiterLimit:l}}static pointsToStroke(e,n,r,o){const l=[],s=[],a=[];if(_i.pointsToStrokeWithBuffers(e,n,r,o,l,s,a)===0)return null;const h=new Xt;return h.setAttribute("position",new zi(l,3)),h.setAttribute("normal",new zi(s,3)),h.setAttribute("uv",new zi(a,2)),h}static pointsToStrokeWithBuffers(e,n,r,o,l,s,a,h){const d=new De,c=new De,u=new De,S=new De,b=new De,N=new De,w=new De,p=new De,g=new De,P=new De,M=new De,v=new De,k=new De,z=new De,x=new De,A=new De,I=new De;r=r!==void 0?r:12,o=o!==void 0?o:.001,h=h!==void 0?h:0,e=W(e);const O=e.length;if(O<2)return 0;const E=e[0].equals(e[O-1]);let F,$=e[0],G;const J=n.strokeWidth/2,K=1/(O-1);let te=0,_,Y,ee,ce,Ce=!1,Ue=0,Q=h*3,R=h*2;V(e[0],e[1],d).multiplyScalar(J),p.copy(e[0]).sub(d),g.copy(e[0]).add(d),P.copy(p),M.copy(g);for(let D=1;D<O;D++){F=e[D],D===O-1?E?G=e[1]:G=void 0:G=e[D+1];const H=d;if(V($,F,H),u.copy(H).multiplyScalar(J),v.copy(F).sub(u),k.copy(F).add(u),_=te+K,Y=!1,G!==void 0){V(F,G,c),u.copy(c).multiplyScalar(J),z.copy(F).sub(u),x.copy(F).add(u),ee=!0,u.subVectors(G,$),H.dot(u)<0&&(ee=!1),D===1&&(Ce=ee),u.subVectors(G,F),u.normalize();const X=Math.abs(H.dot(u));if(X>Number.EPSILON){const Z=J/X;u.multiplyScalar(-Z),S.subVectors(F,$),b.copy(S).setLength(Z).add(u),A.copy(b).negate();const U=b.length(),B=S.length();S.divideScalar(B),N.subVectors(G,F);const j=N.length();switch(N.divideScalar(j),S.dot(A)<B&&N.dot(A)<j&&(Y=!0),I.copy(b).add(F),A.add(F),ce=!1,Y?ee?(x.copy(A),k.copy(A)):(z.copy(A),v.copy(A)):he(),n.strokeLineJoin){case"bevel":le(ee,Y,_);break;case"round":me(ee,Y),ee?ne(F,v,z,_,0):ne(F,x,k,_,1);break;case"miter":case"miter-clip":default:const oe=J*n.strokeMiterLimit/U;if(oe<1)if(n.strokeLineJoin!=="miter-clip"){le(ee,Y,_);break}else me(ee,Y),ee?(N.subVectors(I,v).multiplyScalar(oe).add(v),w.subVectors(I,z).multiplyScalar(oe).add(z),L(v,_,0),L(N,_,0),L(F,_,.5),L(F,_,.5),L(N,_,0),L(w,_,0),L(F,_,.5),L(w,_,0),L(z,_,0)):(N.subVectors(I,k).multiplyScalar(oe).add(k),w.subVectors(I,x).multiplyScalar(oe).add(x),L(k,_,1),L(N,_,1),L(F,_,.5),L(F,_,.5),L(N,_,1),L(w,_,1),L(F,_,.5),L(w,_,1),L(x,_,1));else Y?(ee?(L(g,te,1),L(p,te,0),L(I,_,0),L(g,te,1),L(I,_,0),L(A,_,1)):(L(g,te,1),L(p,te,0),L(I,_,1),L(p,te,0),L(A,_,0),L(I,_,1)),ee?z.copy(I):x.copy(I)):ee?(L(v,_,0),L(I,_,0),L(F,_,.5),L(F,_,.5),L(I,_,0),L(z,_,0)):(L(k,_,1),L(I,_,1),L(F,_,.5),L(F,_,.5),L(I,_,1),L(x,_,1)),ce=!0;break}}else he()}else he();!E&&D===O-1&&ye(e[0],P,M,ee,!0,te),te=_,$=F,p.copy(z),g.copy(x)}if(!E)ye(F,v,k,ee,!1,_);else if(Y&&l){let D=I,H=A;Ce!==ee&&(D=A,H=I),ee?(ce||Ce)&&(H.toArray(l,0*3),H.toArray(l,3*3),ce&&D.toArray(l,1*3)):(ce||!Ce)&&(H.toArray(l,1*3),H.toArray(l,3*3),ce&&D.toArray(l,0*3))}return Ue;function V(D,H,X){return X.subVectors(H,D),X.set(-X.y,X.x).normalize()}function L(D,H,X){l&&(l[Q]=D.x,l[Q+1]=D.y,l[Q+2]=0,s&&(s[Q]=0,s[Q+1]=0,s[Q+2]=1),Q+=3,a&&(a[R]=H,a[R+1]=X,R+=2)),Ue+=3}function ne(D,H,X,Z,U){d.copy(H).sub(D).normalize(),c.copy(X).sub(D).normalize();let B=Math.PI;const j=d.dot(c);Math.abs(j)<1&&(B=Math.abs(Math.acos(j))),B/=r,u.copy(H);for(let oe=0,ie=r-1;oe<ie;oe++)S.copy(u).rotateAround(D,B),L(u,Z,U),L(S,Z,U),L(D,Z,.5),u.copy(S);L(S,Z,U),L(X,Z,U),L(D,Z,.5)}function he(){L(g,te,1),L(p,te,0),L(v,_,0),L(g,te,1),L(v,_,1),L(k,_,0)}function le(D,H,X){H?D?(L(g,te,1),L(p,te,0),L(v,_,0),L(g,te,1),L(v,_,0),L(A,_,1),L(v,X,0),L(z,X,0),L(A,X,.5)):(L(g,te,1),L(p,te,0),L(k,_,1),L(p,te,0),L(A,_,0),L(k,_,1),L(k,X,1),L(x,X,0),L(A,X,.5)):D?(L(v,X,0),L(z,X,0),L(F,X,.5)):(L(k,X,1),L(x,X,0),L(F,X,.5))}function me(D,H){H&&(D?(L(g,te,1),L(p,te,0),L(v,_,0),L(g,te,1),L(v,_,0),L(A,_,1),L(v,te,0),L(F,_,.5),L(A,_,1),L(F,_,.5),L(z,te,0),L(A,_,1)):(L(g,te,1),L(p,te,0),L(k,_,1),L(p,te,0),L(A,_,0),L(k,_,1),L(k,te,1),L(A,_,0),L(F,_,.5),L(F,_,.5),L(A,_,0),L(x,te,1)))}function ye(D,H,X,Z,U,B){switch(n.strokeLineCap){case"round":U?ne(D,X,H,B,.5):ne(D,H,X,B,.5);break;case"square":if(U)d.subVectors(H,D),c.set(d.y,-d.x),u.addVectors(d,c).add(D),S.subVectors(c,d).add(D),Z?(u.toArray(l,1*3),S.toArray(l,0*3),S.toArray(l,3*3)):(u.toArray(l,1*3),u.toArray(l,3*3),S.toArray(l,0*3));else{d.subVectors(X,D),c.set(d.y,-d.x),u.addVectors(d,c).add(D),S.subVectors(c,d).add(D);const j=l.length;Z?(u.toArray(l,j-1*3),S.toArray(l,j-2*3),S.toArray(l,j-4*3)):(u.toArray(l,j-2*3),S.toArray(l,j-1*3),S.toArray(l,j-4*3))}break}}function W(D){let H=!1;for(let Z=1,U=D.length-1;Z<U;Z++)if(D[Z].distanceTo(D[Z+1])<o){H=!0;break}if(!H)return D;const X=[];X.push(D[0]);for(let Z=1,U=D.length-1;Z<U;Z++)D[Z].distanceTo(D[Z+1])>=o&&X.push(D[Z]);return X.push(D[D.length-1]),X}}}const Ph=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   width="50.87159205mm"
   height="53.65397943mm"
   viewBox="0 0 50.87159205 53.65397943"
   version="1.1"
   id="svg184"
   sodipodi:docname="rail.svg"
   inkscape:version="1.2.1 (9c6d41e410, 2022-07-14)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns:lc="http://www.librecad.org">
  <path
     id="line180"
     style="fill:none;stroke:#000000"
     d="m 38.57159,4.9000001 h 0.800003 m -27.871593,0 h 0.8 M 41.771592,0.8 a 2.4,2.4 0 0 0 -2.4,2.4 m 2.399999,-2.39999999 h 5.900002 M 41.771591,0 h 5.900002 m -5.900001,0 a 3.2,3.2 0 0 0 -3.2,3.2 M 50.871593,37.294998 V 44.02 M 50.07159,37.294998 V 44.02 m 0.800003,-25.125 v 13 m -0.800003,-13 v 13 M 32.286345,53.653979 a 1.4,1.4 0 0 0 0.40932,-0.06117 m -0.40932,-0.73883 a 0.6,0.6 0 0 0 0.175423,-0.02622 m -0.175422,0.826221 h -6.850549 m 6.850549,-0.799999 h -6.850549 m 23.029859,-5.582546 -15.769989,6.321373 m 15.536091,-7.086415 -15.769989,6.32137 M 50.07159,3.2 V 13.495 M 50.871593,3.2 v 10.295 m -11.5,-8.5949999 V 3.2 M 38.57159,4.9000001 V 3.2 M 9.1000004,0 H 3.2 M 9.1000004,0.80000001 H 3.2 M 12.3,3.2 A 3.2,3.2 0 0 0 9.1,0 m 2.4,3.2 A 2.4,2.4 0 0 0 9.1,0.8 m 9.309824,52.027762 a 0.6,0.6 0 0 0 0.175423,0.02622 m -0.40932,0.738824 a 1.4,1.4 0 0 0 0.40932,0.06117 M 0.80000001,37.294998 V 44.02 M 0,37.294998 V 44.02 M 0.80000001,18.895 v 13 M 0,18.895 v 13 m 2.6398337,14.611393 15.7699903,6.32137 M 2.4059362,47.271435 18.175926,53.592808 M 12.3,4.9000001 V 3.2 M 11.5,4.9000001 V 3.2 M 0,3.2 V 13.495 M 0.80000001,3.2 V 13.495 M 18.585247,52.853981 h 6.85055 m -6.85055,0.799999 h 6.85055 m 24.498575,-37.748734 0.804974,-1.803469 m -0.8057,1.805084 a 0.7,0.7 0 0 0 0,0.576278 m 0.8057,1.805084 -0.804974,-1.803468 m -0.729808,-0.907196 a 1.5,1.5 0 0 0 0,1.234882 m 0.804248,1.801853 -0.804974,-1.803469 m 0,-1.231651 0.804974,-1.803469 m -0.07444,20.529539 0.804974,-1.803466 m 0,4.186447 -0.804974,-1.803471 m -7.26e-4,-0.577893 a 0.7,0.7 0 0 0 0,0.576278 m -0.729082,-0.90558 a 1.5,1.5 0 0 0 0,1.234882 m -7.26e-4,-1.233265 0.804974,-1.803471 m 0,4.838589 -0.804974,-1.803467 M 1.6677535,15.579174 0.86277878,13.775705 m 0.0751677,2.707434 a 0.7,0.7 0 0 0 0,-0.576278 m -0.0751677,2.707433 0.80497472,-1.803469 m -7.253e-4,0.0016 a 1.5,1.5 0 0 0 0,-1.234882 M 0.93722123,15.905246 0.13224657,14.101777 m 0,4.186446 0.80497466,-1.803468 M 0.86277878,37.014294 1.6677535,35.210827 m -7.253e-4,0.0016 a 1.5,1.5 0 0 0 0,-1.234882 m -0.72908172,0.90558 a 0.7,0.7 0 0 0 0,-0.576278 M 1.6677535,33.979176 0.86277878,32.175705 m -0.73053221,4.51252 0.80497466,-1.803471 m 0,-0.57951 -0.80497466,-1.803466 M 50.071592,3.2 a 2.4,2.4 0 0 0 -2.4,-2.4 m 3.2,2.4 a 3.2,3.2 0 0 0 -3.2,-3.2 m 3.067042,14.103361 a 1.5008812,1.5008812 0 0 0 0.132944,-0.604972 m -0.862054,0.275732 a 0.70088125,0.70088125 0 0 0 0.06208,-0.28251 m 0.799974,5.4 a 1.5008812,1.5008812 0 0 0 -0.132944,-0.604972 m -0.667028,0.61175 a 0.70088125,0.70088125 0 0 0 -0.06208,-0.28251 m 0.862052,18.675732 a 1.5008812,1.5008812 0 0 0 -0.132944,-0.604972 m 0,-4.183278 a 1.5008812,1.5008812 0 0 0 0.132944,-0.604972 m -0.799972,5.4 a 0.70088125,0.70088125 0 0 0 -0.06208,-0.28251 m -2e-6,-4.841758 a 0.70088125,0.70088125 0 0 0 0.06208,-0.28251 M 48.465656,47.271436 A 3.4,3.4 0 0 0 50.871592,44.02 m -2.639834,2.486392 A 2.6,2.6 0 0 0 50.071592,44.02 M 3.2,0 A 3.2,3.2 0 0 0 0,3.2 M 3.2,0.8 A 2.4,2.4 0 0 0 0.8,3.2 m -1.435e-5,10.291611 a 0.70088125,0.70088125 0 0 0 0.0620819,0.28251 m 0,4.841758 a 0.70088125,0.70088125 0 0 0 -0.0620819,0.28251 m -0.7999713,-5.4 a 1.5008812,1.5008812 0 0 0 0.13294344,0.604972 m 0,4.183278 A 1.5008812,1.5008812 0 0 0 1.435e-5,18.891611 m 0.7999713,13 a 0.70088125,0.70088125 0 0 0 0.0620819,0.28251 m 0,4.841758 a 0.70088125,0.70088125 0 0 0 -0.0620819,0.28251 m -0.7999713,-5.4 a 1.5008812,1.5008812 0 0 0 0.13294344,0.604972 m 0,4.183278 A 1.5008812,1.5008812 0 0 0 1.435e-5,37.291611 M 0.8,44.02 a 2.6,2.6 0 0 0 1.8398336,2.486392 M 0,44.02 a 3.4,3.4 0 0 0 2.4059362,3.251436" />
</svg>
`,Nh=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   width="68.6mm"
   height="46.00211506mm"
   viewBox="0 0 68.6 46.00211506"
   version="1.1"
   id="svg120"
   sodipodi:docname="post.svg"
   inkscape:version="1.2.1 (9c6d41e410, 2022-07-14)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns:lc="http://www.librecad.org">
  <path
     id="path116"
     style="fill:none;stroke:#000000;stroke-width:1"
     d="M 62.581736,10.0687 A 5.2,5.2 0 0 0 60.302119,0.01978757 M 62.300751,9.319669 A 4.4,4.4 0 0 0 60.371844,0.81674333 M 62.29861,9.3204814 A 4.05,4.05 0 0 0 59.7,13.101482 m 2.885304,-3.034136 A 3.25,3.25 0 0 0 60.5,13.101482 m 8.1,19.100633 A 4.8,4.8 0 0 0 67.268892,28.884467 M 67.8,32.202115 A 4,4 0 0 0 66.690743,29.437408 M 63.8,46.002115 a 4.8,4.8 0 0 0 4.8,-4.8 m -4.8,4 a 4,4 0 0 0 4,-4 m 0.799998,-10e-7 v -9 m -0.799995,9 v -9 M 59.7,20.202115 a 4.8,4.8 0 0 0 1.331108,3.317648 M 60.5,20.202115 a 4,4 0 0 0 1.109257,2.764707 m -9.770304,21.944384 a 4,4 0 0 0 -5.077906,0 m 5.585696,-0.618182 a 4.8,4.8 0 0 0 -6.093486,0 m 5.585696,0.618182 a 4.8,4.8 0 0 0 3.046743,1.090909 m -2.538953,-1.709091 a 4,4 0 0 0 2.538953,0.909091 m 8.914303,0.799998 h -8.914303 m 8.914303,-0.799999 H 54.885696 M 67.26889,28.884466 61.609257,22.966822 m 5.081485,6.470586 -5.659633,-5.917644 M 60.5,20.202116 v -7.100634 m -0.799999,7.100634 V 13.101482 M 43.714306,46.002113 h -9.414307 m 9.414307,-0.799999 h -9.414307 m -11.953256,-0.90909 a 4,4 0 0 0 2.538953,0.909091 m -3.046743,-0.290909 a 4.8,4.8 0 0 0 3.046743,1.090909 m -11.171392,-0.8 a 4,4 0 0 0 2.538953,-0.909091 m -2.538953,1.709091 a 4.8,4.8 0 0 0 3.046743,-1.090909 m 5.585696,-0.618182 a 4.8,4.8 0 0 0 -6.093486,0 m 5.585696,0.618182 a 4,4 0 0 0 -5.077906,0 m 8.124649,0.290908 h 9.414303 m -9.414303,0.799999 h 9.414303 m 9.414305,2e-6 a 4.8,4.8 0 0 0 3.046743,-1.090909 m -3.046743,0.290909 a 4,4 0 0 0 2.538953,-0.909091 M 8.1,13.101482 A 3.25,3.25 0 0 0 6.0146958,10.067346 M 8.9,13.101482 A 4.05,4.05 0 0 0 6.3013902,9.3204814 M 8.2281561,0.81674333 A 4.4,4.4 0 0 0 6.2992494,9.319669 M 8.2978807,0.01978757 A 5.2,5.2 0 0 0 6.0182637,10.0687 M 6.9907434,22.966822 A 4,4 0 0 0 8.1,20.202115 M 7.568892,23.519763 A 4.8,4.8 0 0 0 8.9,20.202115 M 1.9092566,29.437408 A 4,4 0 0 0 0.8,32.202115 M 1.331108,28.884467 A 4.8,4.8 0 0 0 0,32.202115 m 0.8,9 a 4,4 0 0 0 4,4 m -4.8,-4 a 4.8,4.8 0 0 0 4.8,4.8 M 0.80000001,41.202114 v -9 M 0,41.202114 v -9 M 1.9092566,29.437408 7.568892,23.519764 M 1.331108,28.884466 6.9907432,22.966822 M 8.8999996,20.202116 V 13.101482 M 8.1000004,20.202116 V 13.101482 M 4.8000002,45.202114 H 13.714304 M 4.8000002,46.002113 H 13.714304 M 60.371845,0.81674331 60.30212,0.01978757 M 8.2281561,0.81674331 8.2978811,0.01978757" />
</svg>
`,Mh="data:text/svg;base64,"+window.btoa(Ph),Ch="data:text/svg;base64,"+window.btoa(Nh);let zl=new _i,vh=await zl.loadAsync(Mh),Al=vh.paths.flatMap(C=>C.toShapes(!0)),Th=await zl.loadAsync(Ch),xl=Th.paths.flatMap(C=>C.toShapes(!0));function Vr(C){let e=new It(Al,{depth:C,bevelEnabled:!1}),n=.001;e.scale(n,n,n),e.rotateY(-.5*Math.PI),e.rotateX(-.5*Math.PI);const r=e.attributes.position;let o;for(let l=0;l<r.array.length;l+=3){let s=r.array[l+2];(o==null||s<o)&&(o=s)}return o!=null&&e.translate(C*n,0,-o),e}function Lr(C){let e=new It(xl,{depth:C,bevelEnabled:!1}),n=.001;e.scale(n,n,n),e.rotateY(-.5*Math.PI),e.rotateX(-.5*Math.PI);const r=e.attributes.position;let o;for(let l=0;l<r.array.length;l+=3){let s=r.array[l+2];(o==null||s<o)&&(o=s)}return o!=null&&e.translate(C*n,0,-o),e}function Hr(C){let e=new It(Al,{depth:C,bevelEnabled:!1}),n=.001;return e.scale(n,n,n),e.rotateX(-.5*Math.PI),e.rotateZ(.5*Math.PI),e.computeBoundingBox(),e.boundingBox!=null&&e.translate(-e.boundingBox.min.x,0,-e.boundingBox.min.z),e}function Er(C){let e=new It(xl,{depth:C,bevelEnabled:!1}),n=.001;return e.scale(n,n,n),e.computeBoundingBox(),e.boundingBox!=null&&(e.translate(0,-e.boundingBox.max.y,0),e.rotateX(-.5*Math.PI),e.rotateZ(.5*Math.PI)),e.computeBoundingBox(),e.boundingBox!=null&&e.translate(C*n,0,0),e}class Ei{constructor(e){let n=()=>68.6,r=()=>50.9,o=()=>53.7,l=()=>5,s=()=>65,a=()=>16,h=()=>5,d=()=>10,c=t(()=>new et({webSize:s(),flangeSize:a()})),u=t(()=>new T({itemName:()=>"Fence Rail",length:e.length,mkObject3d:t(()=>{let p=e.length();return g=>{let P=Pt[e.postRailColour()]?.colourHex??"blue",M=Hr(p),v=new rt({color:P});return Fe(()=>{M.dispose(),v.dispose()}),new xe(M,v)}}),transform:t(()=>m.create(i.create(0,.5*(n()-r()),0),y.identity))})),S=t(()=>{let p=t(()=>i.create(-e.length(),0,e.leftHeight()-e.rightHeight()).normalize()),g=t(()=>Math.abs(p().z)/Math.abs(p().x)),P=t(()=>{let v=e.length(),k=e.rightHeight()-e.leftHeight(),z=g();return Math.sqrt(v*v+k*k)-z*o()-2*l()}),M=t(()=>i.create(e.length(),.5*(n()-r()),e.rightHeight()).add(e.leftHeight()<e.rightHeight()?p().scale(g()*o()+l()):p().scale(l())));return new T({itemName:()=>"Fence Rail",length:P,mkObject3d:t(()=>{let v=P();return k=>{let z=Pt[e.postRailColour()]?.colourHex??"blue",x=Hr(v),A=new rt({color:z});return Fe(()=>{x.dispose(),A.dispose()}),new xe(x,A)}}),transform:t(()=>m.create(M(),y.fromUV(p(),i.unitY)))})}),b=t(()=>{let p=e.leftHeight;return new T({itemName:()=>"Fence Post",length:p,mkObject3d:t(()=>{let g=p();return P=>{let M=Pt[e.postRailColour()]?.colourHex??"blue",v=Er(g),k=new rt({color:M});return Fe(()=>{v.dispose(),k.dispose()}),new xe(v,k)}}),transform:t(()=>m.create(i.create(0,0,e.leftHeight()),y.fromUV(i.negUnitZ,i.unitY)))})}),N=t(()=>{let p=e.rightHeight;return new T({itemName:()=>"Fence Post",length:p,mkObject3d:t(()=>{let g=p();return P=>{let M=Pt[e.postRailColour()]?.colourHex??"blue",v=Er(g),k=new rt({color:M});return Fe(()=>{v.dispose(),k.dispose()}),new xe(v,k)}}),transform:t(()=>m.create(i.create(e.length(),0,0),y.fromUV(i.unitZ,i.unitY)))})}),w=t(()=>{let p=d(),g=[],P=0,v=Math.min(e.leftHeight(),e.rightHeight())-d()-P,k=Math.ceil(v/(s()+p)),z=v/k;for(let x=0;x<k;++x){let A=P+p+z*x;g.push(new T({itemName:()=>"Slat",length:t(()=>e.length()-h()*2),timberProperties:c,colour:e.slatColour,transform:t(()=>m.create(i.create(h(),a()+.5*(n()-a()),A),y.fromWU(i.negUnitY,i.unitX)))}))}return g});this.components=t(()=>[u(),S(),b(),N(),...w()])}}class Ur{constructor(e){let n=()=>10,r=t(()=>new T({itemName:()=>"Flange Plate",mkObject3d:()=>{let l=e.postProperties().size+100,s=n();return a=>{let h=.001,d=new Et;d.moveTo(-50*h,-50*h),d.lineTo((-50+l)*h,-50*h),d.lineTo((-50+l)*h,(-50+l)*h),d.lineTo(-50*h,(-50+l)*h),d.closePath();let c=[f.create(-25,-25),f.create(-50+l-25,-25),f.create(-25,-50+l-25),f.create(-50+l-25,-50+l-25)];for(let P of c){let M=new Et;M.absellipse(P.x*h,P.y*h,9*h,9*h,0,2*Math.PI,!1,0),d.holes.push(M)}let u=new It(d,{bevelEnabled:!1,depth:s*h}),S=new rt({color:"#808080"}),b=new bt(u),N=new Tt({color:"black"});Fe(()=>{u.dispose(),S.dispose(),b.dispose(),N.dispose()});let w=new xe(u,S),p=new ht(b,N),g=new nt;return g.add(w),g.add(p),g}}})),o=t(()=>new T({itemName:e.postItemName,length:t(()=>e.height()-n()),shsProperties:e.postProperties,transform:t(()=>m.create(i.create(e.postProperties().size,0,n()),y.fromUV(i.unitZ,i.unitY)))}));this.components=t(()=>[r(),o()])}}class kh{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=t(()=>e.height()+e.span()*l()),a=()=>50,h=()=>200,d=()=>"50x2.0 SHS",c=t(()=>Qt[d()]),u=t(()=>{let I=e.length()/e.numBays(),O=e.numBays()+1,E=[];E.push(0);for(let F=1;F<O-1;++F)E.push(I*F);return E.push(e.length()),E}),S=()=>"50x2.0 SHS",b=t(()=>new Mi({size:50,thickness:2})),N=t(()=>{let A=.5*b().size,O=(e.length()-.5*b().size-A)/e.numBays(),E=e.numBays()+1,F=[];for(let $=0;$<E;++$)F.push(A+$*O);return F}),w=t(()=>{let A=u(),I=[];for(let O=0;O<A.length-1;++O){let E;O==0?E=A[O]+c().size:E=A[O]+.5*c().size;let F;O==A.length-2?F=A[O+1]-c().size:F=A[O+1]-.5*c().size;let $=F-E;I.push(new T({itemName:d,length:()=>$,shsProperties:c,transform:t(()=>m.create(i.create(E,0,e.height()-c().size),y.fromWU(i.unitZ,i.unitX)))})),I.push(new T({itemName:d,length:()=>$,shsProperties:c,transform:t(()=>m.create(i.create(E,e.span()-c().size,s()-c().size*l()-c().size),y.fromWU(i.unitZ,i.unitX)))}))}return I}),p=t(()=>{let A=N(),I=[];for(let O=0;O<A.length-1;++O){let E=A[O]+.5*b().size,$=A[O+1]-.5*b().size-E,G=e.height()-h()-a();I.push({door:new Ei({length:()=>$,leftHeight:()=>G,rightHeight:()=>G,slatColour:()=>"Shale Grey",postRailColour:()=>"Deep Ocean"}),space:t(()=>m.create(i.create(E,0,a()),y.identity))})}return I}),g=t(()=>p().map(({door:A,space:I})=>new T({children:A.components,transform:I}))),P=t(()=>{let A=[];for(let I of N())A.push({post:new Ur({postItemName:S,postProperties:b,height:e.height}),space:t(()=>m.create(i.create(I-.5*b().size,0,0),y.identity))}),A.push({post:new Ur({postItemName:S,postProperties:b,height:t(()=>s()-b().size*l())}),space:t(()=>m.create(i.create(I-.5*b().size,e.span()-b().size,0),y.identity))});return A}),M=t(()=>P().map(({post:A,space:I})=>new T({children:A.components,transform:I}))),v=t(()=>{let A=[];A.push({slatFence:new Ei({length:t(()=>e.span()-2*c().size),leftHeight:t(()=>s()-c().size*l()-a()),rightHeight:t(()=>e.height()-c().size*l()-a()),slatColour:()=>"Shale Grey",postRailColour:()=>"Deep Ocean"}),space:t(()=>m.create(i.create(0,e.span()-c().size,a()),y.fromWU(i.unitZ,i.negUnitY)))}),A.push({slatFence:new Ei({length:t(()=>e.span()-2*c().size),leftHeight:t(()=>e.height()-c().size*l()-a()),rightHeight:t(()=>s()-c().size*l()-a()),slatColour:()=>"Shale Grey",postRailColour:()=>"Deep Ocean"}),space:t(()=>m.create(i.create(e.length(),c().size,a()),y.fromWU(i.unitZ,i.unitY)))});let I=N(),O=68.6;for(let E=1;E<I.length-1;++E){let F=I[E];A.push({slatFence:new Ei({length:t(()=>e.span()-2*c().size),leftHeight:t(()=>e.height()-c().size*l()-a()),rightHeight:t(()=>s()-c().size*l()-a()),slatColour:()=>"Shale Grey",postRailColour:()=>"Deep Ocean"}),space:t(()=>m.create(i.create(F+.5*O,c().size,a()),y.fromWU(i.unitZ,i.unitY)))})}return A}),k=t(()=>v().map(({slatFence:A,space:I})=>new T({children:A.components,transform:I}))),z=t(()=>[{sheetedArea:new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.span()/r()),f.create(0,e.span()/r())]),openings:()=>[],colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",sheetingLowPoly:()=>!1,previewOpening:()=>{}}),space:m.create(i.create(0,0,e.height()),y.fromWU(i.create(0,r(),o()),i.unitX))}]),x=t(()=>z().map(({sheetedArea:A,space:I})=>new T({children:A.components,transform:()=>I})));this.components=t(()=>[...w(),...g(),...M(),...k(),...x()]),this.memberScheduleComponents=t(()=>[...w()]),this.allocateLabels=A=>{for(let I of w())A.genLabelForComponent(I)}}}let zh={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:1e3},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:1800},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:1400},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:5},numBays:{displayName:"# Bays",typeSchema:{type:"Number"},defaultValue:2}};const Ah=new Ae({typeName:"BinHider",displayName:"Bin Hider",propertiesSchema:zh}),xh=Ah;class Ih{constructor(){this.componentType=xh}create(e,n,r,o,l){return new Bh(n,r,o,l)}}let Il=new Ih;Be(Il);class Bh{constructor(e,n,r,o){this.type=Il,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new kh({span:()=>e.span,length:()=>e.length,height:()=>e.height,pitch:()=>e.pitch,numBays:()=>e.numBays});this.components=l.components,this.properties=t(()=>[{displayName:"Bin Hider",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:s=>n("span",s)}),se({displayName:()=>"Length",value:()=>e.length,setValue:s=>n("length",s)}),se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:s=>n("pitch",s)}),Di({displayName:()=>"# Bays",value:()=>e.numBays,setValue:s=>n("numBays",s)})],expanded:()=>!0}]),this.documents2=s=>t(()=>[{name:()=>"Member Schedule",pages:()=>[t(()=>Gi({title:"Bin Hider",components:l.memberScheduleComponents(),labeler:s}))]}]),this.allocateLabels=s=>{l.allocateLabels(s)}}}class Oh{constructor(e){let n=e.timberItemName,r=e.timberProperties,o=t(()=>{let l=0,a=e.length()-l,h=Math.ceil(a/r().webSize),d=r().webSize,c=[],u=e.span();for(let S=0;S<h;++S){let b=l+S*d,N=0;c.push(new T({itemName:n,length:()=>u,colour:e.colour,timberProperties:r,transform:t(()=>m.create(i.create(b+r().webSize,N,0),y.fromWU(i.unitZ,i.unitY)))}))}return c});this.components=t(()=>[...o()])}}const Fh=lt('<svg><path fill="lightgrey" style="stroke-width:1;stroke:black;" vector-effect="non-scaling-stroke"></path></svg>',4,!0),Vh=lt('<svg><rect fill="lightgrey" style="stroke-width:1;stroke:black;" vector-effect="non-scaling-stroke"></rect></svg>',4,!0),Lh=lt('<div style="flex-grow: 1; display: flex; flex-direction: row;"><div><b style="font-size: 10pt; white-space: nowrap;">Member Schedule</b><table style="border-spacing: 0; width: 100%;"><thead><tr><th style="font-size: 8pt; border-left: black 2px solid; border-top: black 2px solid; border-bottom: 2px solid;">Label</th><th style="font-size: 8pt; border: black 2px solid;">Description</th></tr></thead><tbody></tbody></table></div></div>'),Hh=lt('<img style="max-width: 3cm;">'),Eh=lt('<svg><text font-weight="bold" style="fill:black;"></text></svg>',4,!0),Rr=lt('<svg><line stroke="black" stroke-width="1" vector-effect="non-scaling-stroke"></line></svg>',4,!0),Uh=lt('<svg><text fill="black" text-anchor="middle" font-weight="bold"></text></svg>',4,!0),Rh=lt('<tr><td style="border-left: black 1px solid; border-bottom: black 1px solid; font-size: 8pt;"></td><td style="border-left: black 1px solid; border-bottom: black 1px solid; border-right: black 1px solid; font-size: 8pt;"></td></tr>');async function Wh(){let C=new Image;await new Promise(r=>{C.src="./img/steeline-logo.png",C.addEventListener("load",()=>{r()})});let e=document.createElement("canvas");e.width=C.width,e.height=C.height;let n=e.getContext("2d");if(n!=null)return n.drawImage(C,0,0),e.toDataURL("image/png")}let Xh=await Wh();const Dh=C=>{let e=t(()=>C.dimensionStrings==null?[]:C.dimensionStrings),[n,r]=wt(void 0);const[o,l]=Gn({...qn(),scale:.2,panX:-1e3,panY:-3e3});let s=t(()=>{let b=[];for(let N of C.components){let w;if(N.transform==null?w=m.identity:w=N.transform(),N.ceeProperties!=null&&N.length!=null){let p=N.length(),g=N.ceeProperties(),P=Math.atan2(-w.u.z,w.u.x)*180/Math.PI,M;{let k;w.v.y<0?k=i.zero:k=w.w.scale(N.ceeProperties().flangeSize),M=w.o.add(k)}let v="translate("+M.x+","+-M.z+") rotate("+P+")";b.push({transform:v,pos:f.create(M.x,-M.z),angle:P,width:p,height:g.flangeSize})}if(N.shsProperties!=null&&N.length!=null){let p=N.length(),g=N.shsProperties(),P=Math.atan2(-w.u.z,w.u.x)*180/Math.PI,M;{let k;w.v.y<0?k=i.zero:k=w.w.scale(N.shsProperties().size),M=w.o.add(k)}let v="translate("+M.x+","+-M.z+") rotate("+P+")";b.push({transform:v,pos:f.create(M.x,-M.z),angle:P,width:p,height:g.size,backCutAngle:N.backBackCutAngle==null?void 0:N.backBackCutAngle(),frontCutAngle:N.frontBackCutAngle==null?void 0:N.frontBackCutAngle(),backMidCutAngle:N.backMidBackCutAngle==null?void 0:N.backMidBackCutAngle()})}if(N.rhsProperties!=null&&N.length!=null){let p=N.length(),g=N.rhsProperties(),P=Math.atan2(-w.u.z,w.u.x)*180/Math.PI,M;{let k;w.v.y<0?k=i.zero:k=w.w.scale(N.rhsProperties().flangeSize),M=w.o.add(k)}let v="translate("+M.x+","+-M.z+") rotate("+P+")";b.push({transform:v,pos:f.create(M.x,-M.z),angle:P,width:p,height:g.flangeSize,backCutAngle:N.backBackCutAngle==null?void 0:N.backBackCutAngle(),frontCutAngle:N.frontBackCutAngle==null?void 0:N.frontBackCutAngle(),backMidCutAngle:N.backMidBackCutAngle==null?void 0:N.backMidBackCutAngle()})}if(N.timberProperties!=null&&N.length!=null)if(Math.abs(w.v.x)<.001){let p=N.length(),g=N.timberProperties(),P=Math.atan2(-w.u.z,w.u.x)*180/Math.PI,M;{let k;w.v.y<0?k=i.zero:k=w.w.scale(g.flangeSize),M=w.o.add(k)}let v="translate("+M.x+","+-M.z+") rotate("+P+")";b.push({transform:v,pos:f.create(M.x,-M.z),angle:P,width:p,height:g.flangeSize,backCutAngle:N.backBackCutAngle==null?void 0:N.backBackCutAngle(),frontCutAngle:N.frontBackCutAngle==null?void 0:N.frontBackCutAngle(),backMidCutAngle:N.backMidBackCutAngle==null?void 0:N.backMidBackCutAngle()})}else{let p=N.length(),g=N.timberProperties(),P=Math.atan2(-w.u.z,w.u.x)*180/Math.PI,M;{let k;w.v.y<0?k=i.zero:k=w.w.scale(g.flangeSize),M=w.o.add(k)}let v="translate("+M.x+","+-M.z+") rotate("+P+")";b.push({transform:v,pos:f.create(M.x,-M.z),angle:P,width:p,height:g.webSize,backCutAngle:N.backBackCutAngle==null?void 0:N.backBackCutAngle(),frontCutAngle:N.frontBackCutAngle==null?void 0:N.frontBackCutAngle(),backMidCutAngle:N.backMidBackCutAngle==null?void 0:N.backMidBackCutAngle()})}if(N.flatProperties!=null&&N.length!=null&&N.itemName!=null&&N.itemName().indexOf("Strap")!=-1){let g=N.length(),P=N.flatProperties(),M=Math.atan2(-w.u.z,w.u.x)*180/Math.PI,v;{let z;w.w.y<0?z=i.zero:z=w.w.scale(N.flatProperties().width),v=w.o.add(z)}let k="translate("+v.x+","+-v.z+") rotate("+M+")";b.push({transform:k,pos:f.create(v.x,-v.z),angle:M,width:g,height:P.width})}}return b}),a=t(()=>{let b=[];for(let N of C.components){let w;if(N.transform==null?w=m.identity:w=N.transform(),N.shsProperties!=null&&N.length!=null&&N.hasLabel!=null&&N.hasLabel()){let p=C.labeler.lookupLabelForComponent(N);if(p!=null){let g=N.length(),P=N.shsProperties(),M;{let k;Math.abs(w.u.x)>Math.abs(w.u.z)?w.u.x<0?k=.8:k=.3:w.u.z<0?k=.3:k=.7,M=w.o.add(w.u.scale(.5*g)).add(w.w.scale(P.size*k))}let v="translate("+M.x+","+-M.z+")";b.push({transform:v,label:p})}}if(N.rhsProperties!=null&&N.length!=null&&N.hasLabel!=null&&N.hasLabel()){let p=C.labeler.lookupLabelForComponent(N);if(p!=null){let g=N.length(),P=N.rhsProperties(),M;{let k;Math.abs(w.u.x)>Math.abs(w.u.z)?w.u.x<0?k=.8:k=.3:w.u.z<0?k=.3:k=.7,M=w.o.add(w.u.scale(.5*g)).add(w.w.scale(P.flangeSize*k))}let v="translate("+M.x+","+-M.z+")";b.push({transform:v,label:p})}}if(N.ceeProperties!=null&&N.length!=null&&N.hasLabel!=null&&N.hasLabel()){let p=C.labeler.lookupLabelForComponent(N);if(p!=null){let g=N.length(),P=N.ceeProperties(),M;{let k;Math.abs(w.u.x)>Math.abs(w.u.z)?w.u.x<0?k=.8:k=.3:w.u.z<0?k=.3:k=.7,M=w.o.add(w.u.scale(.5*g)).add(w.w.scale(P.flangeSize*k))}let v="translate("+M.x+","+-M.z+")";b.push({transform:v,label:p})}}if(N.flatProperties!=null&&N.length!=null&&N.hasLabel!=null&&N.hasLabel()&&N.itemName!=null&&N.itemName().indexOf("Strap")!=-1){let p=N.length(),g=N.flatProperties(),P=C.labeler.lookupLabelForComponent(N);if(P!=null){let M;{let k;k=.3,M=w.o.add(w.u.scale(.4*p)).add(w.v.scale(g.width*k))}let v="translate("+M.x+","+-M.z+")";b.push({transform:v,label:P})}}}return b});Gt(()=>{let b=n();if(b==null)return;let N,w,p,g;for(let E of s()){let F=E.angle*Math.PI/180,$=Math.cos(F),G=Math.sin(F),J=f.create($,G),K=f.create(-J.y,J.x),te=[E.pos,E.pos.add(J.scale(E.width)),E.pos.add(J.scale(E.width)).add(K.scale(E.height)),E.pos.add(K.scale(E.height))];for(let _ of te)(N==null||_.x<N)&&(N=_.x),(w==null||_.x>w)&&(w=_.x),(p==null||_.y<p)&&(p=_.y),(g==null||_.y>g)&&(g=_.y)}for(let E of e()){let F,$;for(let K of E.markers)(F==null||K<F)&&(F=K),($==null||K>$)&&($=K);if(F==null||$==null)continue;let G=E.space.pointFromThisSpace(i.create(F,0,0)),J=E.space.pointFromThisSpace(i.create($,0,0));for(let K of[G,J])(N==null||K.x<N)&&(N=K.x),(w==null||K.x>w)&&(w=K.x),(p==null||-K.z<p)&&(p=-K.z),(g==null||-K.z>g)&&(g=-K.z)}if(N==null||w==null||p==null||g==null)return;let P=b.clientWidth,M=b.clientHeight,v=w-N,k=g-p,z=P/v,x=M/k,A=Math.min(z,x)*.9,I=-.5*P/A+.5*v,O=p-.5*(M/A-k);At(()=>{l("panX",I),l("panY",O),l("scale",A)})});let h=t(()=>{let b={};for(let w of C.components)if(w.hasLabel!=null&&w.hasLabel()&&w.itemName!=null&&w.length!=null){let p=C.labeler.lookupLabelForComponent(w);if(p!=null){let g=b[p];if(g!=null)g.qty+=1;else{let P={label:p,itemName:w.itemName(),qty:w.qty==null?1:w.qty(),length:w.length()};b[p]=P}}}let N=[];for(let w in b)N.push(b[w]);return N.sort((w,p)=>w.label.localeCompare(p.label)),N}),d=t(()=>s().map(b=>{let N=Math.sin(b.angle*Math.PI/180);return{rect:b,type:Math.abs(N)<.001?"Plate":"Stud"}})),c=t(()=>d().flatMap(b=>b.type=="Plate"?[b.rect]:[])),u=t(()=>d().flatMap(b=>b.type=="Stud"?[b.rect]:[])),S=b=>{let N=b().frontCutAngle??0,w=b().backCutAngle??0,p=b().backMidCutAngle??0;if(N!=0||w!=0||p!=0){let g=Math.tan(N*Math.PI/180),P=Math.tan(w*Math.PI/180),M=Math.tan(p*Math.PI/180),v=[f.create(Math.max(0,g)*b().height,0),...p==0?[f.create(b().width-Math.max(0,P)*b().height,0)]:[f.create(b().width-Math.max(0,M)*.5*b().height,0)],...p==0?[]:[f.create(b().width,.5*b().height)],...p==0?[f.create(b().width-Math.max(0,-P)*b().height,b().height)]:[f.create(b().width-Math.max(0,M)*.5*b().height,b().height)],f.create(Math.max(0,-g)*b().height,b().height)];return(()=>{const k=Fh.cloneNode(!0);return dt(z=>{const x=b().transform,A="M"+v[0].x+" "+v[0].y+v.slice(1).map(I=>" L"+I.x+" "+I.y).join("")+" Z";return x!==z._v$&&Me(k,"transform",z._v$=x),A!==z._v$2&&Me(k,"d",z._v$2=A),z},{_v$:void 0,_v$2:void 0}),k})()}else return(()=>{const g=Vh.cloneNode(!0);return dt(P=>{const M=b().transform,v=b().width,k=b().height;return M!==P._v$3&&Me(g,"transform",P._v$3=M),v!==P._v$4&&Me(g,"width",P._v$4=v),k!==P._v$5&&Me(g,"height",P._v$5=k),P},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),g})()};return Je(er,{get logo(){return(()=>{const b=Hh.cloneNode(!0);return Me(b,"src",Xh),b})()},companyDetails:{name:"Steeline FNW",abn:"12345678",address1:"300 Anzac Avenue",address2:"Harristown QLD 4350",phone:"(07) 4580 4244",fax:"(07) 4304 8012",email:"info@fnw.com.au",website:"fnw.au"},get title(){return C.title},projectNumber:"12-3456",customerName:"Customer Name",clientName:"Client Name",siteAddress1:"Site Address 1",siteAddress2:"Site Address 2",lot:"12345",rpsp:"12345",date:"00/00/0000",ultWindSpeed:"N/A",drawingNo:"12-3456;A",get children(){const b=Lh.cloneNode(!0),N=b.firstChild,w=N.firstChild,p=w.nextSibling,g=p.firstChild,P=g.nextSibling;return mt(b,Je(Jn,{onRefSvg:M=>{r(M)},showGrid:!1,fontSize:12,state:o,style:{width:"100%",height:"100%",border:"none"},get children(){return[Je(St,{get each(){return u()},children:S}),Je(St,{get each(){return c()},children:S}),Je(St,{get each(){return a()},children:M=>(()=>{const v=Eh.cloneNode(!0);return mt(v,()=>M().label),dt(k=>{const z=M().transform,x=(10/o.scale).toString();return z!==k._v$6&&Me(v,"transform",k._v$6=z),x!==k._v$7&&Me(v,"font-size",k._v$7=x),k},{_v$6:void 0,_v$7:void 0}),v})()}),Je(St,{get each(){return e()},children:M=>{if(M().markers.length==0)return[];let v=[...M().markers].sort((E,F)=>E-F),k=v[0],z=v[v.length-1],x=M().space.pointFromThisSpace(i.create(k,0,0)),A=M().space.pointFromThisSpace(i.create(z,0,0)),I=M().space.v,O=Math.atan(-M().space.u.z/M().space.u.x)*180/Math.PI;return[(()=>{const E=Rr.cloneNode(!0);return dt(F=>{const $=x.x,G=-x.z,J=A.x,K=-A.z;return $!==F._v$8&&Me(E,"x1",F._v$8=$),G!==F._v$9&&Me(E,"y1",F._v$9=G),J!==F._v$10&&Me(E,"x2",F._v$10=J),K!==F._v$11&&Me(E,"y2",F._v$11=K),F},{_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0}),E})(),Je(St,{each:v,children:E=>{let F=M().space.pointFromThisSpace(i.create(E(),0,0)),$=F.sub(I.scale(10)),G=F.add(I.scale(10));return(()=>{const J=Rr.cloneNode(!0);return dt(K=>{const te=$.x,_=-$.z,Y=G.x,ee=-G.z;return te!==K._v$12&&Me(J,"x1",K._v$12=te),_!==K._v$13&&Me(J,"y1",K._v$13=_),Y!==K._v$14&&Me(J,"x2",K._v$14=Y),ee!==K._v$15&&Me(J,"y2",K._v$15=ee),K},{_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0}),J})()}}),Je(St,{get each(){return[...Array(v.length-1).keys()]},children:E=>{let F=v[E()],$=v[E()+1],G=M().space.pointFromThisSpace(i.create(.5*(F+$),12,0)),J="translate("+G.x+","+-G.z+") rotate("+O+")";return(()=>{const K=Uh.cloneNode(!0);return Me(K,"transform",J),mt(K,()=>Math.round($-F)),dt(()=>Me(K,"font-size",(10/o.scale).toString())),K})()}})]}})]}}),N),mt(P,Je(St,{get each(){return h()},children:M=>(()=>{const v=Rh.cloneNode(!0),k=v.firstChild,z=k.nextSibling;return mt(k,()=>M().label),mt(z,()=>M().qty+" x "+M().itemName+" @ "+M().length.toFixed(0)+" mm"),v})()})),b}})};class Qi{constructor(e){let n=()=>50,r=()=>25,o=()=>113,l=()=>20,s=()=>5,a=t(()=>new et({webSize:n(),flangeSize:r()})),h=t(()=>new T({length:t(()=>e.length()),timberProperties:a,colour:e.colour,transform:t(()=>m.create(i.create(0,0,e.baseSlatDistOffGround()),y.identity))})),d=t(()=>[new T({length:t(()=>e.length()),timberProperties:a,colour:e.colour,transform:t(()=>m.create(i.create(0,0,e.height()-r()),y.identity))}),new T({length:t(()=>e.length()),timberProperties:a,colour:e.colour,transform:t(()=>m.create(i.create(0,0,e.height()-o()-r()),y.identity))})]),c=t(()=>{let N=l()+.5*n(),g=(e.length()-l()-.5*n()-N)/e.numTallSlatGaps(),P=e.numTallSlatGaps()+1;return Array(P).fill(void 0).map((M,v)=>N+v*g)}),u=t(()=>{let N=e.baseSlatDistOffGround()+s(),p=e.height()-s()-N;return c().map(g=>new T({length:()=>p,timberProperties:a,colour:e.colour,transform:t(()=>m.create(i.create(g-.5*n(),.5*n()-.5*r(),N),y.fromUV(i.unitZ,i.unitX)))}))}),S=t(()=>{let N=c();return Array(N.length-1).fill(void 0).flatMap((w,p)=>{let g=N[p],M=N[p+1]-g,v=3,k=M/v,z=v-1;return Array(z).fill(void 0).map((x,A)=>g+(A+1)*k)})}),b=t(()=>{let N=e.baseSlatDistOffGround()+s(),p=e.height()-o()-s()-N;return S().map(g=>new T({length:()=>p,timberProperties:a,colour:e.colour,transform:t(()=>m.create(i.create(g-.5*n(),.5*n()-.5*r(),N),y.fromUV(i.unitZ,i.unitX)))}))});this.components=t(()=>[h(),...d(),...u(),...b()]),this.fenceDrawing=N=>()=>{let{description:w,labeler:p}=N,g=[];g.push(e.baseSlatDistOffGround()),g.push(e.height());let P=[0,...[...b(),...u()].flatMap(v=>{let k=v.transform!=null?v.transform():m.identity,z=k.origin.x,x=k.origin.x+k.v.x*n();return[z,x]}).sort((v,k)=>v-k),e.length()],M=[h(),...d()].flatMap(v=>{let k=v.transform!=null?v.transform():m.identity,z=k.origin.z,x=k.origin.z+k.w.z*r();return[z,x]}).sort((v,k)=>v-k);return Dh({title:w,components:this.components(),labeler:p,dimensionStrings:[{space:m.create(i.create(0,0,e.baseSlatDistOffGround()-100),y.fromUV(i.unitX,i.unitZ)),markers:P},{space:m.create(i.create(0,0,e.baseSlatDistOffGround()-200),y.fromUV(i.unitX,i.unitZ)),markers:[0,e.length()]},{space:m.create(i.create(e.length()+100,0,0),y.fromUV(i.unitZ,i.negUnitX)),markers:M},{space:m.create(i.create(e.length()+200,0,0),y.fromUV(i.unitZ,i.negUnitX)),markers:g}]})}}}const _h=lt('<div style="flex-grow: 1; display: flex; flex-direction: row;"><div><b style="font-size: 10pt; white-space: nowrap;">Member Schedule</b><table style="border-spacing: 0; width: 100%;"><thead><tr><th style="font-size: 8pt; border-left: black 2px solid; border-top: black 2px solid; border-bottom: 2px solid;">Label</th><th style="font-size: 8pt; border: black 2px solid;">Description</th></tr></thead><tbody></tbody></table></div></div>'),Yh=lt('<img style="max-width: 3cm;">'),Gh=lt('<svg><path fill="transparent" style="stroke-width:1;stroke:black;fill:none;" vector-effect="non-scaling-stroke"></path></svg>',4,!0),Zh=lt('<svg><rect style="stroke-width:1;stroke:black;fill:none;" vector-effect="non-scaling-stroke"></rect></svg>',4,!0),$h=lt('<svg><text font-weight="bold" style="fill:black;"></text></svg>',4,!0),Wr=lt('<svg><line stroke="black" stroke-width="1" vector-effect="non-scaling-stroke"></line></svg>',4,!0),Kh=lt('<svg><text fill="black" text-anchor="middle" font-weight="bold"></text></svg>',4,!0),jh=lt('<tr><td style="border-left: black 1px solid; border-bottom: black 1px solid; font-size: 8pt;"></td><td style="border-left: black 1px solid; border-bottom: black 1px solid; border-right: black 1px solid; font-size: 8pt;"></td></tr>');async function Qh(){let C=new Image;await new Promise(r=>{C.src="./img/steeline-logo.png",C.addEventListener("load",()=>{r()})});let e=document.createElement("canvas");e.width=C.width,e.height=C.height;let n=e.getContext("2d");if(n!=null)return n.drawImage(C,0,0),e.toDataURL("image/png")}let qh=await Qh();const Jh=C=>{let e=t(()=>C.dimensionStrings==null?[]:C.dimensionStrings),[n,r]=wt(void 0);const[o,l]=Gn({...qn(),scale:.2,panX:-1e3,panY:-3e3});let s=t(()=>{let d=[];for(let c of C.components){let u;if(c.transform==null?u=m.identity:u=c.transform(),c.ceeProperties!=null&&c.length!=null){let S=c.length(),b=c.ceeProperties(),N=Math.atan2(-u.u.z,u.u.x)*180/Math.PI,w;{let g;u.v.y<0?g=i.zero:g=u.w.scale(c.ceeProperties().flangeSize),w=u.o.add(g)}let p="translate("+w.x+","+-w.z+") rotate("+N+")";d.push({transform:p,pos:f.create(w.x,-w.z),angle:N,width:S,height:b.flangeSize})}if(c.shsProperties!=null&&c.length!=null){let S=c.length(),b=c.shsProperties(),N=Math.atan2(-u.u.z,u.u.x)*180/Math.PI,w;{let g;u.v.y<0?g=i.zero:g=u.w.scale(c.shsProperties().size),w=u.o.add(g)}let p="translate("+w.x+","+-w.z+") rotate("+N+")";d.push({transform:p,pos:f.create(w.x,-w.z),angle:N,width:S,height:b.size,backCutAngle:c.backBackCutAngle==null?void 0:c.backBackCutAngle(),frontCutAngle:c.frontBackCutAngle==null?void 0:c.frontBackCutAngle(),backMidCutAngle:c.backMidBackCutAngle==null?void 0:c.backMidBackCutAngle()})}if(c.rhsProperties!=null&&c.length!=null){let S=c.length(),b=c.rhsProperties(),N=Math.atan2(-u.u.z,u.u.x)*180/Math.PI,w;{let g;u.v.y<0?g=i.zero:g=u.w.scale(c.rhsProperties().flangeSize),w=u.o.add(g)}let p="translate("+w.x+","+-w.z+") rotate("+N+")";d.push({transform:p,pos:f.create(w.x,-w.z),angle:N,width:S,height:b.flangeSize,backCutAngle:c.backBackCutAngle==null?void 0:c.backBackCutAngle(),frontCutAngle:c.frontBackCutAngle==null?void 0:c.frontBackCutAngle(),backMidCutAngle:c.backMidBackCutAngle==null?void 0:c.backMidBackCutAngle()})}if(c.flatProperties!=null&&c.length!=null&&c.itemName!=null&&c.itemName().indexOf("Strap")!=-1){let b=c.length(),N=c.flatProperties(),w=Math.atan2(-u.u.z,u.u.x)*180/Math.PI,p;{let P;u.w.y<0?P=i.zero:P=u.w.scale(c.flatProperties().width),p=u.o.add(P)}let g="translate("+p.x+","+-p.z+") rotate("+w+")";d.push({transform:g,pos:f.create(p.x,-p.z),angle:w,width:b,height:N.width})}}return d}),a=t(()=>{let d=[];for(let c of C.components){let u;if(c.transform==null?u=m.identity:u=c.transform(),c.shsProperties!=null&&c.length!=null&&c.hasLabel!=null&&c.hasLabel()){let S=C.labeler.lookupLabelForComponent(c);if(S!=null){let b=c.length(),N=c.shsProperties(),w;{let g;Math.abs(u.u.x)>Math.abs(u.u.z)?u.u.x<0?g=.8:g=.3:u.u.z<0?g=.3:g=.7,w=u.o.add(u.u.scale(.5*b)).add(u.w.scale(N.size*g))}let p="translate("+w.x+","+-w.z+")";d.push({transform:p,label:S})}}if(c.rhsProperties!=null&&c.length!=null&&c.hasLabel!=null&&c.hasLabel()){let S=C.labeler.lookupLabelForComponent(c);if(S!=null){let b=c.length(),N=c.rhsProperties(),w;{let g;Math.abs(u.u.x)>Math.abs(u.u.z)?u.u.x<0?g=.8:g=.3:u.u.z<0?g=.3:g=.7,w=u.o.add(u.u.scale(.5*b)).add(u.w.scale(N.flangeSize*g))}let p="translate("+w.x+","+-w.z+")";d.push({transform:p,label:S})}}if(c.ceeProperties!=null&&c.length!=null&&c.hasLabel!=null&&c.hasLabel()){let S=C.labeler.lookupLabelForComponent(c);if(S!=null){let b=c.length(),N=c.ceeProperties(),w;{let g;Math.abs(u.u.x)>Math.abs(u.u.z)?u.u.x<0?g=.8:g=.3:u.u.z<0?g=.3:g=.7,w=u.o.add(u.u.scale(.5*b)).add(u.w.scale(N.flangeSize*g))}let p="translate("+w.x+","+-w.z+")";d.push({transform:p,label:S})}}if(c.flatProperties!=null&&c.length!=null&&c.hasLabel!=null&&c.hasLabel()&&c.itemName!=null&&c.itemName().indexOf("Strap")!=-1){let S=c.length(),b=c.flatProperties(),N=C.labeler.lookupLabelForComponent(c);if(N!=null){let w;{let g;g=.3,w=u.o.add(u.u.scale(.4*S)).add(u.v.scale(b.width*g))}let p="translate("+w.x+","+-w.z+")";d.push({transform:p,label:N})}}}return d});Gt(()=>{let d=n();if(d==null)return;let c,u,S,b;for(let x of s()){let A=x.angle*Math.PI/180,I=Math.cos(A),O=Math.sin(A),E=f.create(I,O),F=f.create(-E.y,E.x),$=[x.pos,x.pos.add(E.scale(x.width)),x.pos.add(E.scale(x.width)).add(F.scale(x.height)),x.pos.add(F.scale(x.height))];for(let G of $)(c==null||G.x<c)&&(c=G.x),(u==null||G.x>u)&&(u=G.x),(S==null||G.y<S)&&(S=G.y),(b==null||G.y>b)&&(b=G.y)}for(let x of e()){let A,I;for(let F of x.markers)(A==null||F<A)&&(A=F),(I==null||F>I)&&(I=F);if(A==null||I==null)continue;let O=x.space.pointFromThisSpace(i.create(A,0,0)),E=x.space.pointFromThisSpace(i.create(I,0,0));for(let F of[O,E])(c==null||F.x<c)&&(c=F.x),(u==null||F.x>u)&&(u=F.x),(S==null||-F.z<S)&&(S=-F.z),(b==null||-F.z>b)&&(b=-F.z)}if(c==null||u==null||S==null||b==null)return;let N=d.clientWidth,w=d.clientHeight,p=u-c,g=b-S,P=N/p,M=w/g,v=Math.min(P,M)*.9,k=-.5*N/v+.5*p,z=S-.5*(w/v-g);At(()=>{l("panX",k),l("panY",z),l("scale",v)})});let h=t(()=>{let d={};for(let u of C.components)if(u.hasLabel!=null&&u.hasLabel()&&u.itemName!=null&&u.length!=null){let S=C.labeler.lookupLabelForComponent(u);if(S!=null){let b=d[S];if(b!=null)b.qty+=1;else{let N={label:S,itemName:u.itemName(),qty:u.qty==null?1:u.qty(),length:u.length()};d[S]=N}}}let c=[];for(let u in d)c.push(d[u]);return c.sort((u,S)=>u.label.localeCompare(S.label)),c});return Je(er,{get logo(){return(()=>{const d=Yh.cloneNode(!0);return Me(d,"src",qh),d})()},companyDetails:{name:"Steeline FNW",abn:"12345678",address1:"300 Anzac Avenue",address2:"Harristown QLD 4350",phone:"(07) 4580 4244",fax:"(07) 4304 8012",email:"info@fnw.com.au",website:"fnw.au"},get title(){return C.title},projectNumber:"12-3456",customerName:"Customer Name",clientName:"Client Name",siteAddress1:"Site Address 1",siteAddress2:"Site Address 2",lot:"12345",rpsp:"12345",date:"00/00/0000",ultWindSpeed:"N/A",drawingNo:"12-3456;A",get children(){const d=_h.cloneNode(!0),c=d.firstChild,u=c.firstChild,S=u.nextSibling,b=S.firstChild,N=b.nextSibling;return mt(d,Je(Jn,{onRefSvg:w=>{r(w)},showGrid:!1,fontSize:12,state:o,style:{width:"100%",height:"100%",border:"none"},get children(){return[Je(St,{get each(){return s()},children:w=>{let p=w().frontCutAngle??0,g=w().backCutAngle??0,P=w().backMidCutAngle??0;if(p!=0||g!=0||P!=0){let M=Math.tan(p*Math.PI/180),v=Math.tan(g*Math.PI/180),k=Math.tan(P*Math.PI/180),z=[f.create(Math.max(0,M)*w().height,0),...P==0?[f.create(w().width-Math.max(0,v)*w().height,0)]:[f.create(w().width-Math.max(0,k)*.5*w().height,0)],...P==0?[]:[f.create(w().width,.5*w().height)],...P==0?[f.create(w().width-Math.max(0,-v)*w().height,w().height)]:[f.create(w().width-Math.max(0,k)*.5*w().height,w().height)],f.create(Math.max(0,-M)*w().height,w().height)];return(()=>{const x=Gh.cloneNode(!0);return dt(A=>{const I=w().transform,O="M"+z[0].x+" "+z[0].y+z.slice(1).map(E=>" L"+E.x+" "+E.y).join("")+" Z";return I!==A._v$&&Me(x,"transform",A._v$=I),O!==A._v$2&&Me(x,"d",A._v$2=O),A},{_v$:void 0,_v$2:void 0}),x})()}else return(()=>{const M=Zh.cloneNode(!0);return dt(v=>{const k=w().transform,z=w().width,x=w().height;return k!==v._v$3&&Me(M,"transform",v._v$3=k),z!==v._v$4&&Me(M,"width",v._v$4=z),x!==v._v$5&&Me(M,"height",v._v$5=x),v},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),M})()}}),Je(St,{get each(){return a()},children:w=>(()=>{const p=$h.cloneNode(!0);return mt(p,()=>w().label),dt(g=>{const P=w().transform,M=(10/o.scale).toString();return P!==g._v$6&&Me(p,"transform",g._v$6=P),M!==g._v$7&&Me(p,"font-size",g._v$7=M),g},{_v$6:void 0,_v$7:void 0}),p})()}),Je(St,{get each(){return e()},children:w=>{if(w().markers.length==0)return[];let p=[...w().markers].sort((x,A)=>x-A),g=p[0],P=p[p.length-1],M=w().space.pointFromThisSpace(i.create(g,0,0)),v=w().space.pointFromThisSpace(i.create(P,0,0)),k=w().space.v,z=Math.atan(-w().space.u.z/w().space.u.x)*180/Math.PI;return[(()=>{const x=Wr.cloneNode(!0);return dt(A=>{const I=M.x,O=-M.z,E=v.x,F=-v.z;return I!==A._v$8&&Me(x,"x1",A._v$8=I),O!==A._v$9&&Me(x,"y1",A._v$9=O),E!==A._v$10&&Me(x,"x2",A._v$10=E),F!==A._v$11&&Me(x,"y2",A._v$11=F),A},{_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0}),x})(),Je(St,{each:p,children:x=>{let A=w().space.pointFromThisSpace(i.create(x(),0,0)),I=A.sub(k.scale(30)),O=A.add(k.scale(30));return(()=>{const E=Wr.cloneNode(!0);return dt(F=>{const $=I.x,G=-I.z,J=O.x,K=-O.z;return $!==F._v$12&&Me(E,"x1",F._v$12=$),G!==F._v$13&&Me(E,"y1",F._v$13=G),J!==F._v$14&&Me(E,"x2",F._v$14=J),K!==F._v$15&&Me(E,"y2",F._v$15=K),F},{_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0}),E})()}}),Je(St,{get each(){return[...Array(p.length-1).keys()]},children:x=>{let A=p[x()],I=p[x()+1],O=w().space.pointFromThisSpace(i.create(.5*(A+I),20,0)),E="translate("+O.x+","+-O.z+") rotate("+z+")";return(()=>{const F=Kh.cloneNode(!0);return Me(F,"transform",E),mt(F,()=>Math.round(I-A)+" mm"),dt(()=>Me(F,"font-size",(10/o.scale).toString())),F})()}})]}})]}}),c),mt(N,Je(St,{get each(){return h()},children:w=>(()=>{const p=jh.cloneNode(!0),g=p.firstChild,P=g.nextSibling;return mt(g,()=>w().label),mt(P,()=>w().qty+" x "+w().itemName+" @ "+w().length.toFixed(0)+" mm"),p})()})),d}})};class Fi{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=t(()=>e.peakHeight()-e.pitchOffset()*l()),a=t(()=>e.peakHeight()-(e.length()-e.pitchOffset())*l()),h=e.overrideStudXCentres??(()=>{}),d=e.removeBasePlate??(()=>!1),c=e.floorHeight??(()=>0),u=t(()=>{if(e.overrideBasePlateRanges!=null)return e.overrideBasePlateRanges();let z=Lt.single(e.hasLeftEdgeMember()?e.memberProperties().size:0,e.length()-(e.hasRightEdgeMember()?e.memberProperties().size:0));for(let x of e.openings()){if(c()+x.pos.y>=e.memberProperties().size)continue;let A=Lt.single(x.pos.x-e.studProperties().flangeSize,x.pos.x+x.width+e.studProperties().flangeSize);z=z.subtract(A)}return z}),S=t(()=>u().ranges.map(z=>new T({itemName:e.memberItemName,length:t(()=>z.to-z.from),hasLabel:()=>!0,shsProperties:e.memberProperties,transform:t(()=>m.create(i.create(z.from,0,0),y.identity))}))),b=t(()=>{if(e.pitchOffset()<=0&&e.pitch()!=0)return;let z;return e.pitch()==0?z=e.length():z=e.pitchOffset()/r(),new T({itemName:e.memberItemName,length:()=>z,hasLabel:()=>!0,shsProperties:e.memberProperties,frontBackCutAngle:e.pitch()==0?void 0:()=>-(.5*(90+e.pitch())-e.pitch()),backBackCutAngle:e.pitch()==0?void 0:()=>-e.pitch(),transform:t(()=>m.create(i.create(e.memberProperties().size*o(),0,s()+e.memberProperties().size*o()*l()-e.memberProperties().size/r()),y.fromUV(i.create(r(),0,o()),i.unitY)))})}),N=t(()=>{if(!(e.pitchOffset()>=e.length()||e.pitch()==0))return new T({itemName:e.memberItemName,length:t(()=>(e.length()-e.pitchOffset())/r()),hasLabel:()=>!0,shsProperties:e.memberProperties,frontBackCutAngle:()=>-e.pitch(),backBackCutAngle:()=>-(.5*(90+e.pitch())-e.pitch()),transform:t(()=>m.create(i.create(e.pitchOffset()-e.memberProperties().size*o(),0,e.peakHeight()+e.memberProperties().size*o()*l()-e.memberProperties().size/r()),y.fromUV(i.create(r(),0,-o()),i.unitY)))})}),w=t(()=>{if(!!e.hasLeftEdgeMember())return new T({itemName:e.memberItemName,length:s,hasLabel:()=>!0,shsProperties:e.memberProperties,frontBackCutAngle:()=>.5*(90+e.pitch())-e.pitch(),transform:t(()=>m.create(i.create(0,0,s()),y.fromUV(i.negUnitZ,i.unitY)))})}),p=t(()=>{if(!!e.hasRightEdgeMember())return new T({itemName:e.memberItemName,length:a,hasLabel:()=>!0,shsProperties:e.memberProperties,backBackCutAngle:()=>.5*(90+e.pitch())-e.pitch(),transform:t(()=>m.create(i.create(e.length(),0,0),y.fromUV(i.unitZ,i.unitY)))})}),g=t(()=>{let z=Lt.single(e.memberProperties().size-.5*e.studProperties().flangeSize,e.length()-e.memberProperties().size+.5*e.studProperties().flangeSize);for(let x of e.openings()){let A=Lt.single(x.pos.x-.5*e.studProperties().flangeSize,x.pos.x+x.width+.5*e.studProperties().flangeSize);z=z.subtract(A)}return z}),P=t(()=>{let z=h();return z!=null?z.map(x=>{let A=d()||!u().ranges.some(({from:I,to:O})=>I<=x&&x<=O);return{studCentreX:x,touchesGround:A}}):[...g().ranges.flatMap(x=>{let A=x.from,O=x.to-A,E=Math.ceil(O/e.maxStudSpacing()),F=O/E,$=E-1;return Array($).fill(void 0).map((G,J)=>{let K=A+(J+1)*F,te=d()||!u().ranges.some(({from:_,to:Y})=>_<=K&&K<=Y);return{studCentreX:K,touchesGround:te}})}),...e.openings().flatMap(x=>{let A=x.pos.y<e.memberProperties().size;return[{studCentreX:x.pos.x-.5*e.studProperties().flangeSize,touchesGround:A},{studCentreX:x.pos.x+x.width+.5*e.studProperties().flangeSize,touchesGround:A}]})]}),M=t(()=>P().map(({studCentreX:z,touchesGround:x})=>{let A=z-.5*e.studProperties().flangeSize,I=z+.5*e.studProperties().flangeSize,O=x?0:e.memberProperties().size,E,F,$;I<e.pitchOffset()?(E=e.peakHeight()-e.memberProperties().size/r()-(e.pitchOffset()-I)*l(),F=e.pitch()):A>e.pitchOffset()?(E=e.peakHeight()-e.memberProperties().size/r()-(A-e.pitchOffset())*l(),F=-e.pitch()):(E=e.peakHeight()-e.memberProperties().size/r(),F=0,Math.abs(z-e.pitchOffset())<=.5&&($=e.pitch));let G=E-O;return new T({itemName:e.studItemName,length:()=>G,hasLabel:()=>!0,rhsProperties:e.studProperties,backBackCutAngle:()=>F,backMidBackCutAngle:$,transform:t(()=>m.create(i.create(z+.5*e.studProperties().flangeSize,0,O),y.fromUV(i.unitZ,i.unitY)))})})),v=t(()=>e.openings().map(z=>new T({itemName:e.studItemName,length:()=>z.width,hasLabel:()=>!0,rhsProperties:e.studProperties,transform:t(()=>m.create(i.create(z.pos.x,0,c()+z.pos.y+z.height),y.identity))}))),k=t(()=>e.openings().flatMap(z=>z.pos.y<e.memberProperties().size?[]:[new T({itemName:e.studItemName,length:()=>z.width,hasLabel:()=>!0,rhsProperties:e.studProperties,transform:t(()=>m.create(i.create(z.pos.x,0,c()+z.pos.y-e.studProperties().flangeSize),y.identity))})]));this.components=t(()=>[...S(),...Pe(b()),...Pe(N()),...Pe(w()),...Pe(p()),...M(),...v(),...k()]),this.frameDrawing=z=>()=>{let{description:x,labeler:A}=z,I=[];return I.push(0),e.pitch()!=0&&I.push(a()),I.push(e.peakHeight()),Jh({title:x,components:this.components(),labeler:A,dimensionStrings:[{space:m.create(i.create(0,0,-200),y.fromUV(i.unitX,i.unitZ)),markers:[0,e.length()]},{space:m.create(i.create(e.length()+200,0,0),y.fromUV(i.unitZ,i.negUnitX)),markers:I}]})}}}class Bl{constructor(e){let n=e.useContinuousJoist??(()=>!1),r=e.joistSpacingType??(()=>"Max"),o=e.additionalJoistXCentres??(()=>[]);const l=175,s=250;let a=t(()=>{let M=e.stairsOp();if(M==null)return;let v=M.dir.normalize();f.create(-v.y,v.x),Math.ceil(e.height()/l);let k=M.headClearance*s/l,z=Ts.create(M.entryFloorPt,tr.xy(v)),x=[z.pointFromSpace(f.create(0,0)),z.pointFromSpace(f.create(0,M.width)),z.pointFromSpace(f.create(-k,M.width)),z.pointFromSpace(f.create(-k,0))],A,I,O,E;for(let F of x)(A==null||F.x<A)&&(A=F.x),(I==null||F.x>I)&&(I=F.x),(O==null||F.y<O)&&(O=F.y),(E==null||F.y>E)&&(E=F.y);if(!(A==null||I==null||O==null||E==null))return{minX:A,minY:O,maxX:I,maxY:E}}),h=t(()=>{let M=.5*e.bearerParams().flangeSize,k=(e.span()-.5*e.bearerParams().flangeSize-M)/e.numEndBays(),z=e.numEndBays()+1,x=[];for(let O=0;O<z;++O)x.push(M+k*O);let A=a(),I=O=>!(O<e.bearerParams().flangeSize*1.5||O>e.span()-e.bearerParams().flangeSize*1.5);return A!=null&&(I(A.minY)&&x.push(A.minY),I(A.maxY)&&x.push(A.maxY)),x.sort((O,E)=>O-E),x}),d=t(()=>{let M=[.5*e.joistParams().flangeSize,...o(),e.length()-.5*e.joistParams().flangeSize].sort((k,z)=>k-z),v=[];for(let k=0;k<M.length-1;++k){let z=M[k],x=M[k+1];switch(r()){case"Even":{let A=x-z,I=Math.ceil(A/e.joistCentres()),O=A/I,E=I+1;for(let F=0;F<E;++F){let $;F<E-1?$=z+O*F:$=x,v.push($)}break}case"Max":{let A=Math.ceil((x-z)/e.joistCentres())+1;for(let I=0;I<A;++I){let O;I<A-1?O=z+e.joistCentres()*I:O=x,v.push(O)}break}}}return v}),c=t(()=>{const M=e.columnParams().size+200;let v=.5*M,z=(e.length()-.5*M-v)/e.numSideBays(),x=e.numSideBays()+1,A=[];for(let I=0;I<x;++I)A.push(v+z*I);return A}),u=t(()=>{let M=a();if(M==null)return[];let v=M,k=[];return k.push(f.create(v.minX,v.minY),f.create(v.maxX,v.minY),f.create(v.minX,v.maxY),f.create(v.maxX,v.maxY)),k=k.filter(z=>{let x=z.x;return z.y,!(x<e.columnParams().size*1.5||x>e.length()-e.columnParams().size*1.5)}),k}),S=t(()=>e.height()-e.joistParams().webSize-e.bearerParams().webSize+e.castInDepth()),b=t(()=>{let M=[];for(let v of h())for(let k of c())M.push({member:new Nr({length:S,shsMemberParams:e.columnParams,plateThickness:e.plateThickness,girdirFlangeSize:()=>e.bearerParams().flangeSize}),space:m.create(i.create(k+.5*e.columnParams().size,v-.5*e.columnParams().size,-e.castInDepth()),y.fromUV(i.unitZ,i.unitY))});for(let v of u())M.push({member:new Nr({length:S,shsMemberParams:e.columnParams,plateThickness:e.plateThickness,girdirFlangeSize:()=>e.bearerParams().flangeSize}),space:m.create(i.create(v.x+.5*e.columnParams().size,v.y-.5*e.columnParams().size,0),y.fromUV(i.unitZ,i.unitY))});return M}),N=t(()=>{let M=[];for(let v of h())M.push(new T({transform:()=>m.create(i.create(0,v+.5*e.bearerParams().flangeSize,e.height()-e.joistParams().webSize-e.bearerParams().webSize),y.fromUV(i.unitX,i.unitZ)),itemName:()=>e.bearerParams().itemName,length:()=>e.length(),rhsProperties:()=>new un({webSize:e.bearerParams().webSize,flangeSize:e.bearerParams().flangeSize,thickness:e.bearerParams().thickness}),usage:()=>"Bearers"}));return M}),w=t(()=>{let M=[],v=a();if(v!=null){let z={...v};z.minX=Math.max(z.minX,e.bearerParams().flangeSize*1.5),z.maxX=Math.min(z.maxX,e.length()-e.bearerParams().flangeSize*1.5),v=z}let k;if(n())k=[{fromY:0,toY:e.span()}];else{k=[];for(let z=0;z<h().length-1;++z){let x=z==0,A=z==h().length-2,I=h()[z],O=h()[z+1],E=I+(x?-.5*e.bearerParams().flangeSize:0),F=O+(A?.5*e.bearerParams().flangeSize:0);k.push({fromY:E,toY:F})}}for(let z of k){let x=z.fromY,A=z.toY,I=A-x,O=.5*(x+A),E=[];if(v!=null){let F=v;F.minY<=O&&O<=F.maxY&&(E=[F.minX,F.maxX])}for(let F of[...d(),...E]){if(v!=null){let $=v;if($.minX<=F&&F<=$.maxX&&$.minY<=O&&O<=$.maxY&&!E.includes(F))continue}M.push(new T({transform:()=>m.create(i.create(F-.5*e.joistParams().flangeSize,x,e.height()-e.joistParams().webSize),y.fromUV(i.unitY,i.unitZ)),itemName:()=>e.joistParams().itemName,length:()=>I,rhsProperties:()=>new un({webSize:e.joistParams().webSize,flangeSize:e.joistParams().flangeSize,thickness:e.joistParams().thickness}),usage:()=>"Joists"}))}}return M}),p=t(()=>b().flatMap(({member:M,space:v})=>Un(wi(M.components,()=>v),()=>"Columns")())),g=t(()=>{let M=e.stairsOp();if(M==null)return;let v=i.create(M.entryFloorPt.x,M.entryFloorPt.y,e.height()),k=i.create(M.dir.x,M.dir.y,0).normalize(),z=i.unitZ.cross(k),x=v.add(z.scale(.5*e.bearerParams().flangeSize)),A=m.create(x,y.fromWU(i.unitZ,k)),I=M;return{stairStringers:new bl({width:()=>I.width-e.bearerParams().flangeSize,horizontalDist:()=>e.height()*s/l,verticalDist:e.height,numSteps:()=>Math.ceil(e.height()/l)-1}),space:A}}),P=t(()=>{let M=g();if(M==null)return[];let{stairStringers:v,space:k}=M;return wi(v.components,()=>k)()});this.components=t(()=>{let M=[],v=[N(),w(),p(),P()];for(let k of v)for(let z of k)M.push(z);return M})}}const Xr=30+50,li=200;class ec{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.sin(n())),o=t(()=>Math.cos(n())),l=t(()=>Math.tan(n())),s=t(()=>e.height()+.5*e.span()*l()),a=()=>"50x2.0 SHS",h=t(()=>Qt[a()]),d=()=>"50x25x2.0 RHS",c=t(()=>Ri[d()]),u=()=>600,S=()=>8,b=j=>t(()=>e.openings().filter(oe=>oe.targetId.head()==j)),N=b("SidewallA"),w=b("SidewallB"),p=b("EndwallA");b("EndwallB");let g=()=>"ModWood Decking 88x23mm",P=t(()=>new et({webSize:88,flangeSize:23})),M=new Bl({span:e.length,length:e.span,height:t(()=>e.floorHeight()),numSideBays:()=>1,numEndBays:()=>2,joistCentres:()=>450,castInDepth:()=>600,bearerParams:()=>({itemName:"150x50x3.0 RHS",webSize:150,flangeSize:50,thickness:2}),joistParams:()=>({itemName:"100x50x2.0 RHS",webSize:100,flangeSize:50,thickness:2}),columnParams:()=>({itemName:"100x3.0 SHS",size:100,thickness:3}),plateThickness:()=>10,stairsOp:()=>{},useContinuousJoist:()=>!0,joistSpacingType:()=>"Even",additionalJoistXCentres:t(()=>[h().size+.5*50,e.span()-h().size-.5*50])}),v=t(()=>m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY))),k=t(()=>new T({children:M.components,transform:v})),z=new Oh({span:t(()=>e.span()-2*h().size),length:e.length,colour:e.floorColour,timberItemName:g,timberProperties:P}),x=t(()=>m.create(i.create(0,h().size,e.floorHeight()),y.identity)),A=t(()=>new T({children:z.components,transform:x})),I=t(()=>{let j=[],oe=0,ie=e.length()-e.verandahLength();for(let ae of N()){let be;switch(ae.pos.type){case"centre":be=.5*(oe+ie)-.5*ae.width;break;case"fromLeft":be=oe+ae.pos.dist;break;case"fromRight":be=ie-ae.pos.dist-ae.width;break}j.push({pos:f.create(be,ae.headHeight-ae.height),width:ae.width,height:ae.height})}return j}),O=t(()=>{let j=[],oe=0,ie=e.length()-e.verandahLength();for(let ae of w()){let be;switch(ae.pos.type){case"centre":be=.5*(oe+ie)-.5*ae.width;break;case"fromLeft":be=oe+ae.pos.dist;break;case"fromRight":be=ie-ae.pos.dist-ae.width;break}j.push({pos:f.create(be,ae.headHeight-ae.height),width:ae.width,height:ae.height})}return j}),E=t(()=>{let j=[0,e.span()/3,2*e.span()/3,e.span()],oe=[];for(let ie of p()){let ae=ie.targetId.tail()?.head();if(ae==null)continue;let be=ae.match(/Bay([0-9]+)/);if(be==null)continue;let we=Number.parseInt(be[1])-1;if(we<0||we>=j.length-1)continue;let ke=j[we],Ve=j[we+1],Se;switch(ie.pos.type){case"centre":Se=.5*(ke+Ve)-.5*ie.width;break;case"fromLeft":Se=ke+ie.pos.dist;break;case"fromRight":Se=Ve-ie.pos.dist-ie.width;break}oe.push({pos:f.create(Se,ie.headHeight-ie.height),width:ie.width,height:ie.height})}return oe}),F=h,$=t(()=>{let j=.5*F().size,ie=e.span()-.5*F().size-j,ae=3,be=ie/ae,we=ae+1;return Array(we).fill(void 0).map((ke,Ve)=>j+be*Ve)}),G=t(()=>{let j=s,oe=t(()=>e.length()-e.verandahLength()-2*h().size),ie=t(()=>{let ae=.5*F().size,we=e.span()-.5*F().size-ae,ke=3,Ve=we/ke,Se=ke-1,Le=Array(Se).fill(void 0).map((Ke,Nt)=>ae+Ve*(Nt+1)),Xe=[];for(let Ke of Le)Xe.push(e.span()-Ke);return Xe.reverse(),Xe});return[{description:()=>"Sidewall A",wallFrame:new Fi({length:oe,peakHeight:e.height,pitch:()=>0,pitchOffset:()=>0,openings:t(()=>I().map(ae=>({...ae,pos:f.create(ae.pos.x-h().size,ae.pos.y)}))),hasLeftEdgeMember:()=>!1,hasRightEdgeMember:()=>!1,memberItemName:a,memberProperties:h,studItemName:d,studProperties:c,maxStudSpacing:u,weldingLabourPerSpotCost:S,floorHeight:()=>P().flangeSize}),space:t(()=>m.create(i.create(e.verandahLength()+h().size,0,0),y.fromWU(i.unitZ,i.unitX)))},{description:()=>"Sidewall B",wallFrame:new Fi({length:oe,peakHeight:e.height,pitch:()=>0,pitchOffset:()=>0,openings:t(()=>O().map(ae=>({...ae,pos:f.create(ae.pos.x-h().size,ae.pos.y)}))),hasLeftEdgeMember:()=>!1,hasRightEdgeMember:()=>!1,memberItemName:a,memberProperties:h,studItemName:d,studProperties:c,maxStudSpacing:u,weldingLabourPerSpotCost:S,floorHeight:()=>P().flangeSize}),space:t(()=>m.create(i.create(e.length()-h().size,e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))},{description:()=>"Endwall A",wallFrame:new Fi({length:e.span,peakHeight:j,pitch:e.pitch,pitchOffset:t(()=>.5*e.span()),openings:E,hasLeftEdgeMember:()=>!0,hasRightEdgeMember:()=>!0,memberItemName:a,memberProperties:h,studItemName:d,studProperties:c,maxStudSpacing:u,weldingLabourPerSpotCost:S,floorHeight:()=>P().flangeSize}),space:t(()=>m.create(i.create(e.verandahLength(),e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))},{description:()=>"Endwall B",wallFrame:new Fi({length:e.span,peakHeight:j,pitch:e.pitch,pitchOffset:t(()=>.5*e.span()),openings:t(()=>[]),hasLeftEdgeMember:()=>!0,hasRightEdgeMember:()=>!0,memberItemName:a,memberProperties:h,studItemName:d,studProperties:c,maxStudSpacing:u,weldingLabourPerSpotCost:S,floorHeight:()=>P().flangeSize}),space:t(()=>m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)))},{description:()=>"Endwall A Verandah Entry",wallFrame:new Fi({length:e.span,peakHeight:j,pitch:e.pitch,pitchOffset:t(()=>.5*e.span()),openings:()=>[],hasLeftEdgeMember:()=>!0,hasRightEdgeMember:()=>!0,memberItemName:a,memberProperties:h,studItemName:d,studProperties:c,maxStudSpacing:u,weldingLabourPerSpotCost:S,overrideStudXCentres:ie,overrideBasePlateRanges:t(()=>{let ae=ie(),be=Lt.single(h().size,e.span()-h().size);return ae.length!=2||(be=be.subtract(Lt.single(ae[0]-.5*c().flangeSize,ae[1]+.5*c().flangeSize))),be}),floorHeight:()=>P().flangeSize}),space:t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))}]}),J=t(()=>G().map(({wallFrame:j,space:oe})=>new T({children:j.components,transform:oe}))),K=t(()=>[new T({length:t(()=>e.length()-e.verandahLength()-2*h().size),itemName:a,hasLabel:()=>!0,shsProperties:h,transform:t(()=>m.create(i.create(e.verandahLength()+h().size,.5*e.span()-.5*h().size,s()-h().size-.5*h().size*l()),y.identity))}),new T({length:t(()=>e.verandahLength()-h().size),itemName:a,hasLabel:()=>!0,shsProperties:h,transform:t(()=>m.create(i.create(h().size,.5*e.span()-.5*h().size,s()-h().size-.5*h().size*l()),y.identity))})]),te=t(()=>[new T({length:t(()=>e.verandahLength()-h().size),itemName:a,hasLabel:()=>!0,shsProperties:h,transform:t(()=>m.create(i.create(h().size,0,e.height()-h().size),y.identity))}),new T({length:t(()=>e.verandahLength()-h().size),itemName:a,hasLabel:()=>!0,shsProperties:h,transform:t(()=>m.create(i.create(h().size,e.span()-h().size,e.height()-h().size),y.identity))})]),_=t(()=>[new T({length:t(()=>e.verandahLength()-h().size),itemName:a,hasLabel:()=>!0,shsProperties:h,transform:t(()=>m.create(i.create(h().size,0,0),y.identity))}),new T({length:t(()=>e.verandahLength()-h().size),itemName:a,hasLabel:()=>!0,shsProperties:h,transform:t(()=>m.create(i.create(h().size,e.span()-h().size,0),y.identity))})]);const Y=175,ee=250;let ce=()=>800,Ce=new bl({width:ce,horizontalDist:t(()=>e.floorHeight()*ee/Y),verticalDist:e.floorHeight,numSteps:()=>Math.ceil(e.floorHeight()/Y)-1}),Ue=t(()=>m.create(i.create(0,.5*(e.span()-ce()),0),y.identity)),Q=t(()=>new T({children:Ce.components,transform:Ue})),R=t(()=>[{fence:new Qi({length:t(()=>e.verandahLength()-F().size),height:()=>800,baseSlatDistOffGround:()=>h().size+100,numTallSlatGaps:()=>3,colour:e.fenceColour}),space:t(()=>m.create(i.create(F().size,0,0),y.identity))},{fence:new Qi({length:t(()=>e.verandahLength()-F().size),height:()=>800,baseSlatDistOffGround:()=>h().size+100,numTallSlatGaps:()=>3,colour:e.fenceColour}),space:t(()=>m.create(i.create(e.verandahLength(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))},{fence:new Qi({length:t(()=>$()[2]-.5*F().size-($()[1]+.5*c().flangeSize)),height:()=>800,baseSlatDistOffGround:()=>h().size+100,numTallSlatGaps:()=>2,colour:e.fenceColour}),space:t(()=>m.create(i.create(0,e.span()-F().size,0),y.fromWU(i.unitZ,i.negUnitY)))},{fence:new Qi({length:t(()=>$()[1]-.5*c().flangeSize-($()[0]+.5*F().size)),height:()=>800,baseSlatDistOffGround:()=>h().size+100,numTallSlatGaps:()=>2,colour:e.fenceColour}),space:t(()=>m.create(i.create(0,$()[1]-.5*c().flangeSize,0),y.fromWU(i.unitZ,i.negUnitY)))}]),V=t(()=>R().map(({fence:j,space:oe})=>new T({children:j.components,transform:oe}))),L=t(()=>[{openings:t(()=>{let j=[0,e.length()-e.verandahLength()],oe=[];for(let ie of N()){let ae=ie.targetId.tail()?.head();if(ae==null)continue;let be=ae.match(/Bay([0-9]+)/);if(be==null)continue;let we=Number.parseInt(be[1])-1;if(we<0||we>=j.length-1)continue;let ke=j[we],Ve=j[we+1],Se;switch(ie.pos.type){case"centre":Se=.5*(ke+Ve)-.5*ie.width;break;case"fromLeft":Se=ke+ie.pos.dist;break;case"fromRight":Se=Ve-ie.pos.dist-ie.width;break}oe.push(new T({openingProperties:t(()=>new Si({type:ie.type,modelName:"",width:ie.width,height:ie.height})),transform:t(()=>m.create(i.create(Se,0,ie.headHeight-ie.height),y.identity))}))}return oe}),space:t(()=>m.create(i.create(e.verandahLength(),0,P().flangeSize),y.fromWU(i.unitZ,i.unitX)))},{openings:t(()=>{let j=[0,e.length()-e.verandahLength()],oe=[];for(let ie of w()){let ae=ie.targetId.tail()?.head();if(ae==null)continue;let be=ae.match(/Bay([0-9]+)/);if(be==null)continue;let we=Number.parseInt(be[1])-1;if(we<0||we>=j.length-1)continue;let ke=j[we],Ve=j[we+1],Se;switch(ie.pos.type){case"centre":Se=.5*(ke+Ve)-.5*ie.width;break;case"fromLeft":Se=ke+ie.pos.dist;break;case"fromRight":Se=Ve-ie.pos.dist-ie.width;break}oe.push(new T({openingProperties:t(()=>new Si({type:ie.type,modelName:"",width:ie.width,height:ie.height})),transform:t(()=>m.create(i.create(Se,0,ie.headHeight-ie.height),y.identity))}))}return oe}),space:t(()=>m.create(i.create(e.length(),e.span(),P().flangeSize),y.fromWU(i.unitZ,i.negUnitX)))},{openings:t(()=>{let j=[0,e.span()/3,2*e.span()/3,e.span()],oe=[];for(let ie of p()){let ae=ie.targetId.tail()?.head();if(ae==null)continue;let be=ae.match(/Bay([0-9]+)/);if(be==null)continue;let we=Number.parseInt(be[1])-1;if(we<0||we>=j.length-1)continue;let ke=j[we],Ve=j[we+1],Se;switch(ie.pos.type){case"centre":Se=.5*(ke+Ve)-.5*ie.width;break;case"fromLeft":Se=ke+ie.pos.dist;break;case"fromRight":Se=Ve-ie.pos.dist-ie.width;break}oe.push(new T({openingProperties:t(()=>new Si({type:ie.type,modelName:"",width:ie.width,height:ie.height})),transform:t(()=>m.create(i.create(Se,0,ie.headHeight-ie.height),y.identity))}))}return oe}),space:t(()=>m.create(i.create(e.verandahLength(),e.span(),P().flangeSize),y.fromWU(i.unitZ,i.negUnitY)))}]),ne=t(()=>L().map(({openings:j,space:oe})=>new T({children:j,transform:oe}))),he=t(()=>[{location:()=>"Sidewall A",sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,-P().flangeSize),f.create(e.length()-e.verandahLength(),-P().flangeSize),f.create(e.length()-e.verandahLength(),e.height()-P().flangeSize),f.create(0,e.height()-P().flangeSize)]),openings:I,colour:e.wallSheetingColour,sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Horizontal",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.verandahLength(),0,P().flangeSize),y.identity))},{location:()=>"Sidewall B",sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,-P().flangeSize),f.create(e.length()-e.verandahLength(),-P().flangeSize),f.create(e.length()-e.verandahLength(),e.height()-P().flangeSize),f.create(0,e.height()-P().flangeSize)]),openings:O,colour:e.wallSheetingColour,sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Horizontal",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),e.span(),P().flangeSize),y.fromWU(i.unitZ,i.negUnitX)))},{location:()=>"Endwall A",sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,-P().flangeSize),f.create(e.span(),-P().flangeSize),f.create(e.span(),e.height()-P().flangeSize),f.create(.5*e.span(),s()-P().flangeSize),f.create(0,e.height()-P().flangeSize)]),openings:E,colour:e.wallSheetingColour,sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Horizontal",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.verandahLength(),e.span(),P().flangeSize),y.fromWU(i.unitZ,i.negUnitY)))},{location:()=>"Endwall B",sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,-P().flangeSize),f.create(e.span(),-P().flangeSize),f.create(e.span(),e.height()-P().flangeSize),f.create(.5*e.span(),s()-P().flangeSize),f.create(0,e.height()-P().flangeSize)]),openings:()=>[],colour:e.wallSheetingColour,sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Horizontal",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),0,P().flangeSize),y.fromWU(i.unitZ,i.unitY)))}]),le=t(()=>he().map(({location:j,sheeting:oe,space:ie})=>new T({usage:j,children:oe.components,transform:ie}))),me=t(()=>{let j=new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-Xr),f.create(e.length(),-Xr),f.create(e.length(),.5*e.span()/o()),f.create(0,.5*e.span()/o())]),openings:()=>[],colour:e.roofSheetingColour,previewOpening:()=>{}});return[{sheeting:j,space:t(()=>m.create(i.create(0,0,e.height()),y.fromWU(i.create(0,o(),r()),i.unitX)))},{sheeting:j,space:t(()=>m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.create(0,-o(),r()),i.negUnitX)))}]}),ye=t(()=>me().map(({sheeting:j,space:oe})=>new T({usage:()=>"Roof Sheeting",children:j.components,transform:oe}))),W=t(()=>{let j="Flashing - Corner 50 x 50 CB";return[new T({itemName:()=>j,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.verandahLength()+-30,-30,0),y.fromUV(i.unitZ,i.unitX)),length:()=>e.height(),flashingProfile:()=>ut}),new T({itemName:()=>j,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,-30,0),y.fromUV(i.unitZ,i.unitY)),length:()=>e.height(),flashingProfile:()=>ut}),new T({itemName:()=>j,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitX)),length:e.height,flashingProfile:()=>ut}),new T({itemName:()=>j,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.verandahLength()+-30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitY)),length:e.height,flashingProfile:()=>ut})]}),D=t(()=>{let j="Flashing - Barge Corrugated CB";return[new T({itemName:()=>j,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,0-li*o(),e.height()+30/o()-li*r()),y.fromUV(i.create(0,o(),r()),i.negUnitX)),length:()=>.5*e.span()/o()+li,flashingProfile:()=>tt}),new T({itemName:()=>j,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,.5*e.span(),e.height()+.5*e.span()*l()+30/o()),y.fromUV(i.create(0,o(),-r()),i.negUnitX)),length:()=>.5*e.span()/o()+li,flashingProfile:()=>tt}),new T({itemName:()=>j,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,e.span()+li*o(),e.height()+30/o()-li*r()),y.fromUV(i.create(0,-o(),r()),i.unitX)),length:()=>.5*e.span()/o()+li,flashingProfile:()=>tt}),new T({itemName:()=>j,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,.5*e.span(),e.height()+.5*e.span()*l()+30/o()),y.fromUV(i.create(0,-o(),-r()),i.unitX)),length:()=>.5*e.span()/o()+li,flashingProfile:()=>tt})]}),H=t(()=>[new T({itemName:()=>"Roll Top Ridge 0.55 Colorbond",layers:()=>[ve.Cladding],transform:()=>m.create(i.create(0,.5*e.span(),e.height()+.5*e.span()*l()+30/o()),y.identity),length:()=>e.length(),flashingProfile:()=>bn({pitch:e.pitch()})})]),X=t(()=>[{gutter:new jt({length:e.length}),space:m.create(i.create(0,0,e.height()),y.fromWU(i.unitZ,i.unitX))},{gutter:new jt({length:e.length}),space:m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.unitZ,i.negUnitX))}]),Z=t(()=>X().flatMap(({gutter:j,space:oe})=>wi(j.components,()=>oe)()));this.components=t(()=>[k(),A(),new T({children:t(()=>[...J(),...K(),...te(),..._(),Q(),...V(),...le(),...ye(),...W(),...ne(),...D(),...H(),...Z()]),transform:t(()=>m.create(i.create(0,0,e.floorHeight()),y.identity))})]);let U=t(()=>{let j=new Ps,ie=[this.components()];for(;;){let ae=ie.pop();if(ae==null)break;for(let be of ae)be.hasLabel!=null&&be.hasLabel()&&j.genLabelForComponent(be),be.children!=null&&ie.push(be.children())}return j}),B=t(()=>{let j=U(),oe=[...G().flatMap(({wallFrame:we})=>we.components()),...K(),...te(),..._()],ie={};for(let we of oe){let ke=j.lookupLabelForComponent(we);if(ke==null)continue;let Ve=ie[ke];Ve!=null?Ve.qty+=we.qty==null?1:we.qty():(Ve={component:we,qty:we.qty==null?1:we.qty()},ie[ke]=Ve)}let ae=[];for(let we in ie){let{component:ke,qty:Ve}=ie[we];ae.push({label:we,component:ke,qty:Ve})}ae.sort((we,ke)=>we.label.localeCompare(ke.label));let be=[];for(let{component:we,qty:ke}of ae)be.push(new T({...we,qty:()=>ke}));return be});this.documents=t(()=>[{name:()=>"Wall Frames",pages:t(()=>G().map(({description:j,wallFrame:oe})=>oe.frameDrawing({description:j(),labeler:U()})))},{name:()=>"Member Schedule",pages:t(()=>[()=>Gi({title:"Member Schedule",get components(){return B()},labeler:U()})])},{name:()=>"Fence Drawings",pages:t(()=>R().map(({fence:j})=>j.fenceDrawing({description:"???",labeler:U()})))}]),this.labeler=U}}let tc={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:2300},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:3500},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:1600},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:30},verandahLength:{displayName:"Verandah Length",typeSchema:{type:"Number"},defaultValue:1e3},floorHeight:{displayName:"Floor Height",typeSchema:{type:"Number"},defaultValue:400},wallSheetingColour:{displayName:"Wall Sheeting Colour",typeSchema:{type:"String"},defaultValue:"Surfmist"},roofSheetingColour:{displayName:"Roof Sheeting Colour",typeSchema:{type:"String"},defaultValue:"Southerly"},floorColour:{displayName:"Floor Colour",typeSchema:{type:"String"},defaultValue:"Basalt"},fenceColour:{displayName:"Fence Colour",typeSchema:{type:"String"},defaultValue:"Surfmist"}};const ic=new Ae({typeName:"CubbyHouse",displayName:"Cubby House",propertiesSchema:tc}),nc=ic;class rc{constructor(){this.componentType=nc}create(e,n,r,o,l){return new lc(n,r,o,l)}}let Ol=new rc;Be(Ol);class lc{constructor(e,n,r,o){this.type=Ol,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new ec({span:()=>e.span,length:()=>e.length,height:()=>e.height,pitch:()=>e.pitch,verandahLength:()=>e.verandahLength,floorHeight:()=>e.floorHeight,openings:t(()=>[{targetId:We.fromArray(["EndwallA","Bay1"]),type:"Window",pos:{type:"fromLeft",dist:112.5},width:600,height:600,headHeight:1400},{targetId:We.fromArray(["EndwallA","Bay2"]),type:"PA Door",pos:{type:"centre"},width:700,height:1600,headHeight:1600},{targetId:We.fromArray(["EndwallA","Bay3"]),type:"Window",pos:{type:"fromRight",dist:112.5},width:600,height:600,headHeight:1400},{targetId:We.fromArray(["SidewallA","Bay1"]),type:"Window",pos:{type:"fromRight",dist:300},width:600,height:600,headHeight:1400},{targetId:We.fromArray(["SidewallB","Bay1"]),type:"Window",pos:{type:"fromLeft",dist:300},width:600,height:600,headHeight:1400}]),wallSheetingColour:()=>e.wallSheetingColour,roofSheetingColour:()=>e.roofSheetingColour,floorColour:()=>e.floorColour,fenceColour:()=>e.fenceColour});this.components=l.components,this.properties=t(()=>[{displayName:"Properties",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:s=>n("span",s)}),se({displayName:()=>"Length",value:()=>e.length,setValue:s=>n("length",s)}),se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:s=>n("pitch",s)}),se({displayName:()=>"Verandah Length",value:()=>e.verandahLength,setValue:s=>n("verandahLength",s)}),se({displayName:()=>"Floor Height",value:()=>e.floorHeight,setValue:s=>n("floorHeight",s)})],expanded:()=>!0},{displayName:"Colours",fields:[ci({displayName:()=>"Wall",value:()=>e.wallSheetingColour,setValue:s=>n("wallSheetingColour",s),possibleValues:t(()=>Object.keys(Pt))}),ci({displayName:()=>"Roof",value:()=>e.roofSheetingColour,setValue:s=>n("roofSheetingColour",s),possibleValues:t(()=>Object.keys(Pt))}),ci({displayName:()=>"Floor",value:()=>e.floorColour,setValue:s=>n("floorColour",s),possibleValues:t(()=>Object.keys(Pt))}),ci({displayName:()=>"Fence",value:()=>e.fenceColour,setValue:s=>n("fenceColour",s),possibleValues:t(()=>Object.keys(Pt))})],expanded:()=>!0}]),this.documents=l.documents,this.labeler=l.labeler}}function oc(C,e){let n=Dr(C),r=Dr(e),o=sc(n,r),l=_r(o),s=ac(r,n);for(let d of s){let c=d.v2;d.v2=d.v3,d.v3=c}let a=_r(s),h=ir([l,a]);return h.addGroup(0,o.length*3,0),h.addGroup(o.length*3,Number.POSITIVE_INFINITY,1),h}function Dr(C){const e=C.attributes.position,n=C.attributes.normal,r=C.attributes.uv,o=C.attributes.color;let l;if(C.index)l=C.index.array;else{l=new Array(e.array.length/e.itemSize|0);for(let b=0;b<l.length;b++)l[b]=b}const s=l.length/3|0;let a=e.array.length/e.itemSize,h=new Array(a);for(let b=0;b<a;++b){const N=b,w=N*3,p=N*2,g=e.array[w],P=e.array[w+1],M=e.array[w+2],v=n.array[w],k=n.array[w+1],z=n.array[w+2],x=r?.array[p],A=r?.array[p+1];h[b]={x:g,y:P,z:M,nx:v,ny:k,nz:z,u:x,v:A,colour:o?{r:o.array[p],g:o.array[p+1],b:o.array[p+2]}:void 0}}let d,c=new Array(h.length);{let b=0,N={},w=0;for(let p of h){let g=Math.round(p.x*1e3)+"_"+Math.round(p.y*1e3)+"_"+Math.round(p.z*1e3),P=N[g];if(P==null){let M=b++;N[g]={v:i.create(p.x,p.y,p.z),idx:M},c[w]=M}else c[w]=P.idx;++w}d=new Array(b);for(let p in N){let g=N[p];d[g.idx]=g.v}}let u=new Array(s);for(let b=0,N=0;N<l.length;++b,N+=3)u[b]={v1:c[l[N]],v2:c[l[N+1]],v3:c[l[N+2]]};let S=[];for(let{v1:b,v2:N,v3:w}of u)S.push({v1:d[b],v2:d[N],v3:d[w]});return S}function _r(C){let e=new Map,n=new Xt,r=0,o=[],l=[],s=a=>{let h=e.get(a);return h==null&&(h=r++,e.set(a,h),o.push(a.x,a.y,a.z)),h};for(let a of C){let h=s(a.v1),d=s(a.v2),c=s(a.v3);l.push(h,d,c)}return n.setAttribute("position",new di(new Float32Array(o),3)),n.setIndex(l),n}function sc(C,e){let n=[],r=[...C];for(;;){let o=r.pop();if(o==null)break;let l=!0;for(let s of e)if(Ll(o,s)){let a=s.v2.sub(s.v1).cross(s.v3.sub(s.v1)).normalize(),h=Kt.fromKnownPtAndNormal(s.v1,a),d=Fl([o],h);if(d.length<2)continue;r.push(...d),l=!1;break}l&&n.push(o)}for(let o=n.length-1;o>=0;--o){let{v1:l,v2:s,v3:a}=n[o],h=i.create((l.x+s.x+a.x)/3,(l.y+s.y+a.y)/3,(l.z+s.z+a.z)/3);Vl(h,e)&&n.splice(o,1)}return n}function ac(C,e){let n=[],r=[...C];for(;;){let o=r.pop();if(o==null)break;let l=!0;for(let s of e)if(Ll(o,s)){let a=s.v2.sub(s.v1).cross(s.v3.sub(s.v1)).normalize(),h=Kt.fromKnownPtAndNormal(s.v1,a),d=Fl([o],h);if(d.length<2)continue;r.push(...d),l=!1;break}l&&n.push(o)}for(let o=n.length-1;o>=0;--o){let{v1:l,v2:s,v3:a}=n[o],h=i.create((l.x+s.x+a.x)/3,(l.y+s.y+a.y)/3,(l.z+s.z+a.z)/3);Vl(h,e)||n.splice(o,1)}return n}function Fl(C,e){let n=h=>{let d=.001,c=e.n.dot(h)+e.d;return c<-d?"Inside":c>d?"Outside":"Coinside"},r=[],o=(()=>{let h=0,d={};return c=>{let u=Math.round(c.x*1e3)+"_"+Math.round(c.y*1e3)+"_"+Math.round(c.z*1e3),S=d[u];return S==null&&(S=h++,d[u]=S,r[S]=c),S}})(),l={},s=(h,d)=>{let c=Math.min(h,d)+"_"+Math.max(h,d);{let M=l[c];if(M!=null)return M.type=="Some"?M.value:void 0}let u=r[h],S=r[d],b=n(u),N=n(S);if(!(b!="Coinside"&&N!="Coinside"&&b!=N)){l[c]={type:"None"};return}let g=Hi.create(u,S.sub(u)).collisionWithPlane(e);if(g==null){l[c]={type:"None"};return}let P=o(g);return l[c]={type:"Some",value:P},P},a=[];for(let h of C){let d=h.v1,c=h.v2,u=h.v3,S=o(d),b=o(c),N=o(u),w=s(S,b),p=s(b,N),g=s(N,S);if(w!=null)if(p!=null){let P=r[w],M=r[p];a.push({v1:P,v2:c,v3:M}),a.push({v1:P,v2:M,v3:u}),a.push({v1:d,v2:P,v3:u})}else if(g!=null){let P=r[w],M=r[g];a.push({v1:d,v2:P,v3:M}),a.push({v1:P,v2:c,v3:u}),a.push({v1:P,v2:u,v3:M})}else{let P=r[w];a.push({v1:d,v2:P,v3:u}),a.push({v1:P,v2:c,v3:u})}else if(p!=null)if(g!=null){let P=r[p],M=r[g];a.push({v1:M,v2:P,v3:u}),a.push({v1:d,v2:c,v3:P}),a.push({v1:d,v2:P,v3:M})}else{let P=r[p];a.push({v1:d,v2:c,v3:P}),a.push({v1:d,v2:P,v3:u})}else if(g!=null){let P=r[g];a.push({v1:d,v2:c,v3:P}),a.push({v1:P,v2:c,v3:u})}else a.push(h)}return a}let Vl=(()=>{let C=new hs;C.direction.set(1,0,0);let e=new je,n=new je,r=new je,o=new je;return(l,s)=>{let a=0;C.origin.set(l.x,l.y,l.z);for(let{v1:h,v2:d,v3:c}of s)e.set(h.x,h.y,h.z),n.set(d.x,d.y,d.z),r.set(c.x,c.y,c.z),C.intersectTriangle(e,n,r,!1,o)!=null&&++a;return(a&1)!=0}})(),Ll=(()=>{let C=new je,e=new je,n=new je,r=new je,o=new je,l=(s,a)=>{let h,d,c;C.set(s.v1.x,s.v1.y,s.v1.z),h=C.dot(o),C.set(s.v2.x,s.v2.y,s.v2.z),d=C.dot(o),C.set(s.v3.x,s.v3.y,s.v3.z),c=C.dot(o);let u=Math.min(Math.min(h,d),c),S=Math.max(Math.max(h,d),c);C.set(a.v1.x,a.v1.y,a.v1.z),h=C.dot(o),C.set(a.v2.x,a.v2.y,a.v2.z),d=C.dot(o),C.set(a.v3.x,a.v3.y,a.v3.z),c=C.dot(o);let b=Math.min(Math.min(h,d),c),N=Math.max(Math.max(h,d),c);return S<=b||u>=N};return(s,a)=>(C.set(s.v2.x-s.v1.x,s.v2.y-s.v1.y,s.v2.z-s.v1.z),e.set(s.v3.x-s.v1.x,s.v3.y-s.v1.y,s.v3.z-s.v1.z),n.crossVectors(C,e).normalize(),C.set(a.v2.x-a.v1.x,a.v2.y-a.v1.y,a.v2.z-a.v1.z),e.set(a.v3.x-a.v1.x,a.v3.y-a.v1.y,a.v3.z-a.v1.z),r.crossVectors(C,e).normalize(),o.copy(n),!(l(s,a)||(o.copy(r),l(s,a))||(C.set(s.v2.x-s.v1.x,s.v2.y-s.v1.y,s.v2.z-s.v1.z),e.copy(n),o.crossVectors(C,e).normalize(),l(s,a))||(C.set(s.v3.x-s.v2.x,s.v3.y-s.v2.y,s.v3.z-s.v2.z),o.crossVectors(C,e).normalize(),l(s,a))||(C.set(s.v1.x-s.v3.x,s.v1.y-s.v3.y,s.v1.z-s.v3.z),o.crossVectors(C,e).normalize(),l(s,a))||(C.set(a.v2.x-a.v1.x,a.v2.y-a.v1.y,a.v2.z-a.v1.z),e.copy(r),o.crossVectors(C,e).normalize(),l(s,a))||(C.set(a.v3.x-a.v2.x,a.v3.y-a.v2.y,a.v3.z-a.v2.z),o.crossVectors(C,e).normalize(),l(s,a))||(C.set(a.v1.x-a.v3.x,a.v1.y-a.v3.y,a.v1.z-a.v3.z),o.crossVectors(C,e).normalize(),l(s,a))))})(),hc={};const cc=new Ae({typeName:"CsgTest",displayName:"Csg Test",propertiesSchema:hc}),dc=cc;class uc{constructor(){this.isForTesting=!0,this.componentType=dc}create(e,n,r,o,l){return new fc(n,r,o,l)}}let Hl=new uc;Be(Hl);class fc{constructor(e,n,r,o){this.type=Hl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o,this.components=t(()=>[new T({mkObject3d:t(()=>l=>{let s=new Ni(1,1,1),a=new Ni(1,1,1);s.translate(0,0,.5),a.translate(.5,.5,1);let h=oc(s,a);s.dispose(),a.dispose();let d=new bt(h),c=new xt({color:"#0000FF",polygonOffset:!0,polygonOffsetUnits:1,polygonOffsetFactor:1}),u=new xt({color:"#00FF00",polygonOffset:!0,polygonOffsetUnits:1,polygonOffsetFactor:1}),S=new Tt({color:"#000000"});Fe(()=>{h.dispose(),d.dispose(),c.dispose(),u.dispose(),S.dispose()});let b=new nt;return b.add(new xe(h,[c,u])),b.add(new ht(d,S)),b})})]),this.properties=t(()=>[])}}class pc{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=()=>"35x2.0 SHS",a=t(()=>new Mi({size:35,thickness:2})),h=()=>"70x35x3.0 RHS",d=t(()=>new un({webSize:70,flangeSize:35,thickness:3})),c=()=>"125x20 Timber",u=t(()=>new et({webSize:125,flangeSize:20})),S=()=>"20x20 Timber",b=t(()=>new et({webSize:20,flangeSize:20})),N=new mc({length:t(()=>e.length()-2*a().size),windowWidth:e.windowWidth,windowHeight:e.windowHeight,drawbridgeWidth:e.drawbridgeWidth,drawbridgeHeight:e.drawbridgeHeight,frameMemberItemName:s,frameMemberProperties:a}),w=new gc({length:t(()=>e.length()-2*a().size),headerHeight:t(()=>2*a().size+e.drawbridgeHeight()),purchStudCentresX:t(()=>N.purchStudCentresX().map(Y=>e.length()-2*a().size-Y)),frameMemberItemName:s,frameMemberProperties:a}),p=new Yr({side:()=>"Endwall A",span:e.span,height:t(()=>e.height()-e.floorHeight()-a().size/r()),pitch:e.pitch,overhang:e.overhang,hasBaseMember:()=>!1,frameMemberItemName:s,frameMemberProperties:a}),g=new Yr({side:()=>"Endwall B",span:e.span,height:t(()=>e.height()-e.floorHeight()-a().size/r()),pitch:e.pitch,overhang:e.overhang,hasBaseMember:()=>!0,frameMemberItemName:s,frameMemberProperties:a}),P=t(()=>[{frame:p,space:t(()=>m.create(i.create(0,e.span(),e.floorHeight()),y.fromWU(i.unitZ,i.negUnitY)))},{frame:g,space:t(()=>m.create(i.create(e.length(),0,e.floorHeight()),y.fromWU(i.unitZ,i.unitY)))},{frame:N,space:t(()=>m.create(i.create(a().size,0,e.floorHeight()),y.identity))},{frame:w,space:t(()=>m.create(i.create(e.length()-a().size,e.span(),e.floorHeight()),y.fromWU(i.unitZ,i.negUnitX)))}]),M=t(()=>P().map(({frame:Y,space:ee})=>new T({children:Y.components,transform:ee}))),v=t(()=>{let Y=t(()=>e.span()-2*a().size),ee=N.purchStudCentresX();if(ee.length<2)return[];let ce=ee[ee.length-1]-ee[ee.length-2],Ce=[ee[0]-ce,...ee].map(Ue=>Ue+a().size+.5*b().webSize);return Ce.map((Ue,Q)=>{let R=e.floorHeight()+(e.drawbridgeHeight()+2*a().size)*(Ce.length-Q)/Ce.length;return{purch:new bc({span:Y,timberItemName:S,timberProperties:b}),space:t(()=>m.create(i.create(Ue,a().size,R),y.fromUV(i.unitY,i.negUnitX)))}})}),k=t(()=>v().map(({purch:Y,space:ee})=>new T({children:Y.components,transform:ee}))),z=new wc({span:e.span,length:e.length,height:e.floorHeight,nestingBoxSpan:e.nestingBoxSpan,nestingBoxQty:e.nestingBoxQty,frameMemberItemName:s,frameMemberProperties:a,baseFrameMemberItemName:h,baseFrameMemberProperties:d,timberItemName:c,timberProperties:u}),x=t(()=>new T({children:z.components})),A=t(()=>[{roofPlane:new Gr({length:e.length,width:t(()=>(.5*e.span()+e.overhang())/r()-a().size*l()),frameMemberItemName:s,frameMemberProperties:a}),space:t(()=>m.create(i.create(0,-e.overhang()+a().size*o(),e.height()-e.overhang()*l()-a().size*r()),y.fromUV(i.unitX,i.create(0,r(),o()))))},{roofPlane:new Gr({length:e.length,width:t(()=>(.5*e.span()+e.overhang())/r()-a().size*l()),frameMemberItemName:s,frameMemberProperties:a}),space:t(()=>m.create(i.create(e.length(),e.span()+e.overhang()-a().size*o(),e.height()-e.overhang()*l()-a().size*r()),y.fromUV(i.negUnitX,i.create(0,-r(),o()))))}]),I=t(()=>A().map(({roofPlane:Y,space:ee})=>new T({children:Y.components,transform:ee}))),O=t(()=>({drawbridge:new yc({width:e.drawbridgeWidth,height:e.drawbridgeHeight,timberItemName:c,timberProperties:u}),space:t(()=>{let Y=e.drawbridgeHeight(),ee=e.floorHeight()+a().size,ce=Math.sqrt(Y*Y-ee*ee);return m.create(i.create(.5*e.length()-.5*e.drawbridgeWidth(),0,e.floorHeight()+a().size),y.fromWU(i.create(0,-ce,-ee).normalize(),i.unitX))})})),E=t(()=>new T({children:O().drawbridge.components,transform:O().space})),F=t(()=>({pos:f.create(a().size,a().size),width:e.span()-2*a().size,height:g.undersideOfHorizontalSupportHeight()-a().size})),$=t(()=>({door:new Pc({width:()=>F().width,height:()=>F().height,frameMemberItemName:s,frameMemberProperties:a}),space:t(()=>m.create(i.create(e.length(),F().pos.x,e.floorHeight()+F().pos.y),y.fromWU(i.unitZ,i.unitY)))})),G=t(()=>new T({children:$().door.components,transform:$().space})),J=t(()=>{let Y=t(()=>e.height()-e.floorHeight()-2*a().size/r()),ee=t(()=>e.height()-e.floorHeight()),ce=t(()=>ee()+.5*e.span()*l());return[{sheeting:new Te({type:()=>"Wall Sheeting",usage:()=>"Sidewall A",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),Y()),f.create(0,Y())]),openings:t(()=>[{pos:f.create(.5*e.length()-.5*e.drawbridgeWidth(),0),width:e.drawbridgeWidth(),height:e.drawbridgeHeight()+a().size},{pos:f.create(a().size+N.window1CentreX()-.5*e.windowWidth(),a().size+e.drawbridgeHeight()-e.windowHeight()),width:e.windowWidth(),height:e.windowHeight()},{pos:f.create(a().size+N.window2CentreX()-.5*e.windowWidth(),a().size+e.drawbridgeHeight()-e.windowHeight()),width:e.windowWidth(),height:e.windowHeight()}]),colour:()=>"Surfmist",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,0,e.floorHeight()),y.fromWU(i.unitZ,i.unitX)))},{sheeting:new Te({type:()=>"Wall Sheeting",usage:()=>"Sidewall B",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),Y()),f.create(0,Y())]),openings:t(()=>[]),colour:()=>"Surfmist",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),e.span(),e.floorHeight()),y.fromWU(i.unitZ,i.negUnitX)))},{sheeting:new Te({type:()=>"Wall Sheeting",usage:()=>"Endwall A",outline:t(()=>[f.create(0,0),f.create(e.span(),0),f.create(e.span(),ee()),f.create(.5*e.span(),ce()),f.create(0,ee())]),openings:t(()=>[]),colour:()=>"Surfmist",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,e.span(),e.floorHeight()),y.fromWU(i.unitZ,i.negUnitY)))},{sheeting:new Te({type:()=>"Wall Sheeting",usage:()=>"Endwall B",outline:t(()=>[f.create(0,0),f.create(e.span(),0),f.create(e.span(),ee()),f.create(.5*e.span(),ce()),f.create(0,ee())]),openings:t(()=>[F()]),colour:()=>"Surfmist",sheetingType:()=>"Flat",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),0,e.floorHeight()),y.fromWU(i.unitZ,i.unitY)))}]}),K=t(()=>J().map(({sheeting:Y,space:ee})=>new T({children:Y.components,transform:ee}))),te=t(()=>{let Y=t(()=>(.5*e.span()+e.overhang())/r());return[{sheeting:new Te({type:()=>"Roof Sheeting",usage:()=>"Roof",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),Y()),f.create(0,Y())]),openings:t(()=>[]),colour:()=>"Surfmist",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,-e.overhang(),e.height()-e.overhang()*l()),y.fromWU(i.create(0,r(),o()),i.unitX)))},{sheeting:new Te({type:()=>"Roof Sheeting",usage:()=>"Roof",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),Y()),f.create(0,Y())]),openings:t(()=>[]),colour:()=>"Surfmist",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),e.span()+e.overhang(),e.height()-e.overhang()*l()),y.fromWU(i.create(0,-r(),o()),i.negUnitX)))}]}),_=t(()=>te().map(({sheeting:Y,space:ee})=>new T({children:Y.components,transform:ee})));this.components=t(()=>[...M(),...k(),x(),...I(),E(),G(),...K(),..._()]),this.memberScheduleComponents=t(()=>[...N.memberScheduleComponents(),...w.memberScheduleComponents(),...p.memberScheduleComponents(),...g.memberScheduleComponents(),...z.memberScheduleComponents(),...$().door.memberScheduleComponents()]),this.allocateLabels=Y=>{N.allocateLabels(Y),w.allocateLabels(Y),p.allocateLabels(Y),g.allocateLabels(Y),z.allocateLabels(Y),$().door.allocateLabels(Y),Y.genPrefixedLabelForKey({prefix:"W",key:"Sidewall A Wall Frame"}),Y.genPrefixedLabelForKey({prefix:"W",key:"Sidewall B Wall Frame"}),Y.genPrefixedLabelForKey({prefix:"W",key:"Endwall A Wall Frame"}),Y.genPrefixedLabelForKey({prefix:"W",key:"Endwall B Wall Frame"}),Y.genPrefixedLabelForKey({prefix:"F",key:"Floor Wall Frame"})},this.mkFramesForDoc=Y=>t(()=>[{side:"Sidewall A",frame:N},{side:"Sidewall B",frame:w},{side:"Endwall A",frame:p},{side:"Endwall B",frame:{mkFrameForDoc(ee){return t(()=>{let ce=g.mkFrameForDoc(ee),Ce=$().door.mkFrameForDoc(ee),Ue=m.create(i.create(a().size,0,a().size),y.identity);return{components:[...ce().components,...Ce().components.map(Q=>new T({...Q,transform:t(()=>Ue.fromThisSpace(Q.transform?.call(void 0)??m.identity))}))],dimensionStrings:[...ce().dimensionStrings,...Ce().dimensionStrings.map(Q=>({...Q,space:t(()=>Ue.fromThisSpace(Q.space))}))]}})}}},{side:"Floor",frame:z}].map(({side:ee,frame:ce})=>t(()=>({...ce.mkFrameForDoc(Y)(),frameLabel:Y.lookupLabelForKey(ee+" Wall Frame")??""}))))}}class Yr{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=()=>50,a=t(()=>e.height()-e.frameMemberProperties().size/r()+e.frameMemberProperties().size*l()),h=t(()=>(.5*e.span()+e.overhang())/r()-e.frameMemberProperties().size*l()),d=t(()=>[new T({itemName:e.frameMemberItemName,usage:e.side,length:a,frontBackCutAngle:t(()=>-e.pitch()),shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(0,0,a()),y.fromUV(i.negUnitZ,i.unitY)))}),new T({itemName:e.frameMemberItemName,usage:e.side,length:a,backBackCutAngle:t(()=>-e.pitch()),shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(e.span(),0,0),y.fromUV(i.unitZ,i.unitY)))})]),c=t(()=>[new T({itemName:e.frameMemberItemName,usage:e.side,length:h,backBackCutAngle:t(()=>-e.pitch()),shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(-e.overhang()+e.frameMemberProperties().size*o()+e.frameMemberProperties().size*l()*r(),0,e.height()-e.overhang()*l()-e.frameMemberProperties().size*r()+e.frameMemberProperties().size*l()*o()),y.fromUV(i.create(r(),0,o()),i.unitY)))}),new T({itemName:e.frameMemberItemName,usage:e.side,length:h,backBackCutAngle:t(()=>-e.pitch()),shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(e.span()+e.overhang()-e.frameMemberProperties().size*o()-e.frameMemberProperties().size*l()*r(),e.frameMemberProperties().size,e.height()-e.overhang()*l()-e.frameMemberProperties().size*r()+e.frameMemberProperties().size*l()*o()),y.fromUV(i.create(-r(),0,o()),i.negUnitY)))})]),u=t(()=>new T({itemName:e.frameMemberItemName,usage:e.side,length:t(()=>e.span()-2*e.frameMemberProperties().size),shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(e.span()-e.frameMemberProperties().size,0,a()-s()),y.fromUV(i.negUnitX,i.unitY)))})),S=t(()=>{if(!!e.hasBaseMember())return new T({itemName:e.frameMemberItemName,usage:e.side,length:t(()=>e.span()-2*e.frameMemberProperties().size),shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(e.frameMemberProperties().size,0,0),y.identity))})});this.components=t(()=>[...d(),...c(),u(),...Pe(S())]),this.memberScheduleComponents=this.components,this.allocateLabels=b=>{for(let N of this.memberScheduleComponents())b.genLabelForComponent(N)},this.mkFrameForDoc=b=>t(()=>({components:this.components(),dimensionStrings:[]})),this.undersideOfHorizontalSupportHeight=t(()=>a()-s()-e.frameMemberProperties().size)}}class mc{constructor(e){let n=t(()=>{let b=e.length()+2*e.frameMemberProperties().size,N=b*.5/3-e.frameMemberProperties().size,w=b*1.5/3-e.frameMemberProperties().size,p=b*2.5/3-e.frameMemberProperties().size;return{window1CentreX:N,window2CentreX:p,drawBridgeCentreX:w}}),r=()=>n().window1CentreX,o=()=>n().window2CentreX,l=()=>n().drawBridgeCentreX,s=t(()=>e.drawbridgeHeight()),a=t(()=>new T({itemName:e.frameMemberItemName,usage:()=>"Sidewall A",length:e.length,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:()=>m.identity})),h=t(()=>[new T({itemName:e.frameMemberItemName,usage:()=>"Window Stud",length:s,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(r()-.5*e.windowWidth(),0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))}),new T({itemName:e.frameMemberItemName,usage:()=>"Window Stud",length:s,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(r()+.5*e.windowWidth(),0,e.frameMemberProperties().size+s()),y.fromUV(i.negUnitZ,i.unitY)))}),new T({itemName:e.frameMemberItemName,usage:()=>"Drawbridge Stud",length:s,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(l()-.5*e.drawbridgeWidth(),0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))}),new T({itemName:e.frameMemberItemName,usage:()=>"Drawbridge Stud",length:s,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(l()+.5*e.drawbridgeWidth(),0,e.frameMemberProperties().size+s()),y.fromUV(i.negUnitZ,i.unitY)))}),new T({itemName:e.frameMemberItemName,usage:()=>"Window Stud",length:s,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(o()-.5*e.windowWidth(),0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))}),new T({itemName:e.frameMemberItemName,usage:()=>"Window Stud",length:s,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(o()+.5*e.windowWidth(),0,e.frameMemberProperties().size+s()),y.fromUV(i.negUnitZ,i.unitY)))})]),d=t(()=>new T({itemName:e.frameMemberItemName,usage:()=>"Sidewall A",length:e.length,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(e.length(),0,s()+2*e.frameMemberProperties().size),y.fromUV(i.negUnitX,i.unitY)))})),c=t(()=>[new T({itemName:e.frameMemberItemName,usage:()=>"Window Sill",length:e.windowWidth,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(r()-.5*e.windowWidth(),0,e.frameMemberProperties().size+e.drawbridgeHeight()-e.windowHeight()-e.frameMemberProperties().size),y.identity))}),new T({itemName:e.frameMemberItemName,usage:()=>"Window Sill",length:e.windowWidth,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(o()-.5*e.windowWidth(),0,e.frameMemberProperties().size+e.drawbridgeHeight()-e.windowHeight()-e.frameMemberProperties().size),y.identity))})]),u=t(()=>[{mesh:new Zt({width:e.windowWidth,apexHeight:e.windowHeight,pitch:()=>0,pitchOffset:()=>0}),space:t(()=>new m(i.create(r()-.5*e.windowWidth(),.5*e.frameMemberProperties().size,e.drawbridgeHeight()+e.frameMemberProperties().size-e.windowHeight()),y.identity))},{mesh:new Zt({width:e.windowWidth,apexHeight:e.windowHeight,pitch:()=>0,pitchOffset:()=>0}),space:t(()=>new m(i.create(o()-.5*e.windowWidth(),.5*e.frameMemberProperties().size,e.drawbridgeHeight()+e.frameMemberProperties().size-e.windowHeight()),y.identity))}]),S=t(()=>u().map(({mesh:b,space:N})=>new T({children:b.components,transform:N})));this.components=t(()=>[a(),...h(),d(),...c(),...S()]),this.memberScheduleComponents=this.components,this.allocateLabels=b=>{for(let N of this.memberScheduleComponents())b.genLabelForComponent(N)},this.purchStudCentresX=t(()=>[r()+.5*e.windowWidth()+.5*e.frameMemberProperties().size,l()-.5*e.drawbridgeWidth()-.5*e.frameMemberProperties().size]),this.window1CentreX=r,this.window2CentreX=o,this.mkFrameForDoc=b=>t(()=>({components:this.components(),dimensionStrings:[]}))}}class gc{constructor(e){let n=t(()=>e.headerHeight()-2*e.frameMemberProperties().size),r=t(()=>new T({itemName:e.frameMemberItemName,usage:()=>"Sidewall B",length:e.length,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:()=>m.identity})),o=t(()=>new T({itemName:e.frameMemberItemName,usage:()=>"Sidewall B",length:e.length,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(e.length(),0,e.headerHeight()),y.fromUV(i.negUnitX,i.unitY)))})),l=t(()=>e.purchStudCentresX().map(s=>new T({itemName:e.frameMemberItemName,usage:()=>"Purch Stud",length:n,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(s+.5*e.frameMemberProperties().size,0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))})));this.components=t(()=>[r(),o(),...l()]),this.memberScheduleComponents=this.components,this.allocateLabels=s=>{for(let a of this.memberScheduleComponents())s.genLabelForComponent(a)},this.mkFrameForDoc=s=>t(()=>({components:this.components(),dimensionStrings:[]}))}}class Gr{constructor(e){let n=t(()=>[new T({itemName:e.frameMemberItemName,usage:()=>"Purlins",length:e.length,shsProperties:e.frameMemberProperties,transform:()=>m.identity}),new T({itemName:e.frameMemberItemName,usage:()=>"Purlins",length:e.length,shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(0,e.width()-e.frameMemberProperties().size,0),y.identity))})]);this.components=t(()=>[...n()])}}class yc{constructor(e){let n=t(()=>{let o=e.timberProperties(),l=[],s=e.width(),a=Math.ceil(s/o.webSize),h=o.webSize,d=s-(a-1)*e.timberProperties().webSize;for(let c=0;c<a;++c){let u=h+c*e.timberProperties().webSize,S;c<a-1?S=o:S=new et({webSize:d,flangeSize:o.flangeSize}),l.push(new T({itemName:e.timberItemName,usage:()=>"Drawbridge",length:e.height,timberProperties:()=>S,transform:t(()=>m.create(i.create(u-o.webSize,0,0),y.fromWU(i.unitY,i.unitZ)))}))}return l}),r=t(()=>{let o=[],l=e.height(),s=4,h=(l-s*e.timberProperties().webSize)/s+e.timberProperties().webSize,c=.5*h+.5*e.timberProperties().webSize;for(let u=0;u<4;++u){let S=c+h*u;o.push(new T({itemName:e.timberItemName,usage:()=>"Drawbridge",length:e.width,timberProperties:e.timberProperties,transform:t(()=>m.create(i.create(0,e.timberProperties().flangeSize,S),y.fromWU(i.unitY,i.unitX)))}))}return o});this.components=t(()=>[...n(),...r()])}}class bc{constructor(e){let n=t(()=>new T({itemName:e.timberItemName,usage:()=>"Purch",length:e.span,timberProperties:e.timberProperties}));this.components=t(()=>[n()])}}class wc{constructor(e){let n=t(()=>[new T({itemName:e.baseFrameMemberItemName,usage:()=>"Base Frame",length:e.length,frontBackCutAngleType2:()=>45,backBackCutAngleType2:()=>45,rhsProperties:e.baseFrameMemberProperties,hasLabel:()=>!0,transform:t(()=>new m(i.create(0,0,e.height()-e.baseFrameMemberProperties().flangeSize),y.fromWU(i.unitZ,i.unitX)))}),new T({itemName:e.baseFrameMemberItemName,usage:()=>"Base Frame",length:e.length,frontBackCutAngleType2:()=>45,backBackCutAngleType2:()=>45,rhsProperties:e.baseFrameMemberProperties,hasLabel:()=>!0,transform:t(()=>new m(i.create(e.length(),e.span(),e.height()-e.baseFrameMemberProperties().flangeSize),y.fromWU(i.unitZ,i.negUnitX)))}),new T({itemName:e.baseFrameMemberItemName,usage:()=>"Base Frame",length:e.span,frontBackCutAngleType2:()=>45,backBackCutAngleType2:()=>45,rhsProperties:e.baseFrameMemberProperties,hasLabel:()=>!0,transform:t(()=>new m(i.create(0,e.span(),e.height()-e.baseFrameMemberProperties().flangeSize),y.fromWU(i.unitZ,i.negUnitY)))}),new T({itemName:e.baseFrameMemberItemName,usage:()=>"Base Frame",length:e.span,frontBackCutAngleType2:()=>45,backBackCutAngleType2:()=>45,rhsProperties:e.baseFrameMemberProperties,hasLabel:()=>!0,transform:t(()=>new m(i.create(e.length(),0,e.height()-e.baseFrameMemberProperties().flangeSize),y.fromWU(i.unitZ,i.unitY)))})]),r=t(()=>[new T({itemName:e.frameMemberItemName,usage:()=>"Base Frame",length:t(()=>e.span()-2*e.baseFrameMemberProperties().webSize),shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>new m(i.create(.5*e.length()-.5*e.frameMemberProperties().size,e.baseFrameMemberProperties().webSize,e.height()-e.frameMemberProperties().size),y.fromUV(i.unitY,i.unitZ)))}),new T({itemName:e.frameMemberItemName,usage:()=>"Base Frame",length:t(()=>.5*e.length()-e.baseFrameMemberProperties().webSize-.5*e.frameMemberProperties().size),shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>new m(i.create(e.baseFrameMemberProperties().webSize,.5*e.span()+.5*e.frameMemberProperties().size,e.height()-e.frameMemberProperties().size),y.fromUV(i.unitX,i.unitZ)))}),new T({itemName:e.frameMemberItemName,usage:()=>"Base Frame",length:t(()=>.5*e.length()-e.baseFrameMemberProperties().webSize-.5*e.frameMemberProperties().size),shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>new m(i.create(.5*e.length()+.5*e.frameMemberProperties().size,.5*e.span()+.5*e.frameMemberProperties().size,e.height()-e.frameMemberProperties().size),y.fromUV(i.unitX,i.unitZ)))})]),o=t(()=>({mesh:new Zt({width:t(()=>.5*e.length()-.5*e.frameMemberProperties().size),apexHeight:t(()=>e.span()-2*e.frameMemberProperties().size),pitch:()=>0,pitchOffset:()=>0}),space:t(()=>new m(i.create(0,e.frameMemberProperties().size,e.height()),y.fromWU(i.unitY,i.unitX)))})),l=t(()=>new T({children:o().mesh.components,transform:o().space})),s=t(()=>({floor:new Sc({span:t(()=>e.span()-2*e.frameMemberProperties().size),length:t(()=>.5*e.length()+.5*e.frameMemberProperties().size-e.frameMemberProperties().size),nestingBoxSpan:e.nestingBoxSpan,nestingBoxQty:e.nestingBoxQty,timberItemName:e.timberItemName,timberProperties:e.timberProperties}),space:t(()=>m.create(i.create(.5*e.length()-.5*e.frameMemberProperties().size,e.frameMemberProperties().size,e.height()),y.identity))})),a=t(()=>new T({children:s().floor.components,transform:s().space})),h=new Nc({length:e.length,span:e.span,height:t(()=>e.height()-e.baseFrameMemberProperties().flangeSize)}),d=t(()=>new T({children:h.components}));this.components=t(()=>[...n(),...r(),l(),a(),d()]),this.memberScheduleComponents=t(()=>[...n(),...r()]),this.allocateLabels=c=>{for(let u of this.memberScheduleComponents())c.genLabelForComponent(u)},this.mkFrameForDoc=c=>t(()=>{let u=m.create(i.zero,y.fromUV(i.unitX,i.unitZ));return{components:this.memberScheduleComponents().map(S=>new T({...S,transform:t(()=>u.fromThisSpace(S.transform?.call(void 0)??m.identity))})),dimensionStrings:[]}})}}class Sc{constructor(e){let n=t(()=>{let o=e.timberProperties(),l=0,s=e.length(),a=Math.ceil(s/e.timberProperties().webSize),h=s-(a-1)*e.timberProperties().webSize,d=[];for(let c=0;c<a;++c){let u=l+c*e.timberProperties().webSize,S;c<a-1?S=e.timberProperties():S=new et({webSize:h,flangeSize:o.flangeSize}),d.push(new T({itemName:e.timberItemName,usage:()=>"Floor",length:e.span,timberProperties:()=>S,transform:t(()=>m.create(i.create(u+S.webSize,0,0),y.fromWU(i.unitZ,i.unitY)))}))}return d}),r=t(()=>{let o=[new T({itemName:e.timberItemName,usage:()=>"Nesting Box",length:e.length,timberProperties:e.timberProperties,transform:t(()=>m.create(i.create(0,e.span()-e.nestingBoxSpan()+e.timberProperties().flangeSize,e.timberProperties().flangeSize),y.fromUV(i.unitX,i.unitZ)))}),new T({itemName:e.timberItemName,usage:()=>"Nesting Box",length:e.length,timberProperties:e.timberProperties,transform:t(()=>m.create(i.create(0,e.span(),e.timberProperties().flangeSize),y.fromUV(i.unitX,i.unitZ)))})],l=.5*e.timberProperties().flangeSize,h=(e.length()-.5*e.timberProperties().flangeSize-l)/e.nestingBoxQty(),d=e.nestingBoxQty()+1;for(let c=0;c<d;++c){let u=l+c*h;o.push(new T({itemName:e.timberItemName,usage:()=>"Nesting Box",length:t(()=>e.nestingBoxSpan()-2*e.timberProperties().flangeSize),timberProperties:e.timberProperties,transform:t(()=>m.create(i.create(u-.5*e.timberProperties().flangeSize,e.span()-e.nestingBoxSpan()+e.timberProperties().flangeSize,e.timberProperties().flangeSize),y.fromUV(i.unitY,i.unitZ)))}))}return o});this.components=t(()=>[...n(),...r()])}}class Pc{constructor(e){let n=()=>10,r=t(()=>e.width()-2*n()),o=t(()=>e.height()-2*n()),l=t(()=>[new T({itemName:e.frameMemberItemName,shsProperties:e.frameMemberProperties,length:r,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(n(),0,n()),y.identity)),hasLabel:()=>!0}),new T({itemName:e.frameMemberItemName,shsProperties:e.frameMemberProperties,length:r,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(e.width()-n(),0,e.height()-n()),y.fromUV(i.negUnitX,i.unitY))),hasLabel:()=>!0}),new T({itemName:e.frameMemberItemName,shsProperties:e.frameMemberProperties,length:o,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(n(),0,e.height()-n()),y.fromUV(i.negUnitZ,i.unitY))),hasLabel:()=>!0}),new T({itemName:e.frameMemberItemName,shsProperties:e.frameMemberProperties,length:o,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(e.width()-n(),0,n()),y.fromUV(i.unitZ,i.unitY))),hasLabel:()=>!0})]),s=t(()=>({sheeting:new Te({type:()=>"Wall Sheeting",usage:()=>"Endwall Door",outline:t(()=>[f.create(0,0),f.create(e.width()-2*n(),0),f.create(e.width()-2*n(),e.height()-2*n()),f.create(0,e.height()-2*n())]),openings:t(()=>[]),colour:()=>"Surfmist",sheetingType:()=>"Flat",previewOpening:()=>{}}),space:t(()=>m.create(i.create(n(),0,n()),y.identity))})),a=t(()=>new T({children:s().sheeting.components,transform:s().space}));this.components=t(()=>[...l(),a()]),this.memberScheduleComponents=l,this.allocateLabels=h=>{for(let d of this.memberScheduleComponents())h.genLabelForComponent(d)},this.mkFrameForDoc=h=>t(()=>({components:this.memberScheduleComponents(),dimensionStrings:[]}))}}class Nc{constructor(e){let n=t(()=>new Mc({length:e.length(),height:e.height()})),r=t(()=>l=>{let s=n(),a=s.incRef(),h=new rt({color:"#808080"});return Fe(()=>{s.defRef(),h.dispose()}),new xe(a,h)}),o=t(()=>[new T({mkObject3d:r}),new T({mkObject3d:r,transform:t(()=>m.create(i.create(0,e.span()-50,0),y.identity))})]);this.components=t(()=>[...o()])}}class Mc{constructor(e){this.geometry=void 0,this.refCount=0,this.length=e.length,this.height=e.height}incRef(){if(++this.refCount,this.geometry!=null)return this.geometry;let e,n=new Et,r=.001,o=50;n.absellipse(-.5*o*r,-.5*o*r,.5*o*r,.5*o*r,0,2*Math.PI,!1,0);let l=new cs([new je(0,0,this.height*r),new je(this.height*r,0,.1*this.height*r),new je(.5*this.length*r,0,0),new je((this.length-this.height)*r,0,.1*this.height*r),new je(this.length*r,0,this.height*r)]);return e=new It(n,{bevelEnabled:!1,depth:this.height*r,extrudePath:l,steps:100}),this.geometry=e,e}defRef(){--this.refCount,this.refCount==0&&this.geometry!=null&&(this.geometry.dispose(),this.geometry=void 0)}}let Cc={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:1220},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:2420},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:1200+345},floorHeight:{displayName:"Floor Height",typeSchema:{type:"Number"},defaultValue:345},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:45},overhang:{displayName:"Overhang",typeSchema:{type:"Number"},defaultValue:200},windowWidth:{displayName:"Window Width",typeSchema:{type:"Number"},defaultValue:300},windowHeight:{displayName:"Window Height",typeSchema:{type:"Number"},defaultValue:330},drawbridgeWidth:{displayName:"Drawbridge Width",typeSchema:{type:"Number"},defaultValue:330},drawbridgeHeight:{displayName:"Drawbridge Height",typeSchema:{type:"Number"},defaultValue:740},nestingBoxSpan:{displayName:"Nesting Box Span",typeSchema:{type:"Number"},defaultValue:400},nestingBoxQty:{displayName:"Nesting Box Qty",typeSchema:{type:"Number"},defaultValue:2}};const vc=new Ae({typeName:"DeluxeChickenCoop",displayName:"Deluxe Chicken Coop",propertiesSchema:Cc}),Tc=vc;class kc{constructor(){this.componentType=Tc}create(e,n,r,o,l){return new zc(n,r,o,l)}}let El=new kc;Be(El);class zc{constructor(e,n,r,o){this.type=El,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new pc({span:()=>e.span,length:()=>e.length,height:()=>e.height,floorHeight:()=>e.floorHeight,pitch:()=>e.pitch,overhang:()=>e.overhang,windowWidth:()=>e.windowWidth,windowHeight:()=>e.windowHeight,drawbridgeWidth:()=>e.drawbridgeWidth,drawbridgeHeight:()=>e.drawbridgeHeight,nestingBoxSpan:()=>e.nestingBoxSpan,nestingBoxQty:()=>e.nestingBoxQty});this.components=l.components,this.documents2=s=>t(()=>[{name:()=>"Member Schedule",pages:()=>[t(()=>Gi({title:"Deluxe Chicken Coop",components:l.memberScheduleComponents(),labeler:s}))]}]),this.allocateLabels=l.allocateLabels,this.mkFramesForDoc=l.mkFramesForDoc}}class Ac extends Zn{constructor(e){super(e)}load(e,n,r,o){const l=this,s=new gn(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){const h=l.parse(JSON.parse(a));n&&n(h)},r,o)}parse(e){return new xc(e)}}class xc{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,n=100){const r=[],o=Ic(e,n,this.data);for(let l=0,s=o.length;l<s;l++)r.push(...o[l].toShapes());return r}}function Ic(C,e,n){const r=Array.from(C),o=e/n.resolution,l=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*o,s=[];let a=0,h=0;for(let d=0;d<r.length;d++){const c=r[d];if(c===`
`)a=0,h-=l;else{const u=Bc(c,o,a,h,n);a+=u.offsetX,s.push(u.path)}}return s}function Bc(C,e,n,r,o){const l=o.glyphs[C]||o.glyphs["?"];if(!l){console.error('THREE.Font: character "'+C+'" does not exists in font family '+o.familyName+".");return}const s=new si;let a,h,d,c,u,S,b,N;if(l.o){const w=l._cachedOutline||(l._cachedOutline=l.o.split(" "));for(let p=0,g=w.length;p<g;)switch(w[p++]){case"m":a=w[p++]*e+n,h=w[p++]*e+r,s.moveTo(a,h);break;case"l":a=w[p++]*e+n,h=w[p++]*e+r,s.lineTo(a,h);break;case"q":d=w[p++]*e+n,c=w[p++]*e+r,u=w[p++]*e+n,S=w[p++]*e+r,s.quadraticCurveTo(u,S,d,c);break;case"b":d=w[p++]*e+n,c=w[p++]*e+r,u=w[p++]*e+n,S=w[p++]*e+r,b=w[p++]*e+n,N=w[p++]*e+r,s.bezierCurveTo(u,S,b,N,d,c);break}}return{offsetX:l.ha*e,path:s}}class Ui extends It{constructor(e,n={}){const r=n.font;if(r===void 0)super();else{const o=r.generateShapes(e,n.size);n.depth=n.height!==void 0?n.height:50,n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(o,n)}this.type="TextGeometry"}}const In={type:"Object",properties:{x:{displayName:"X",typeSchema:{type:"Number"},defaultValue:0},y:{displayName:"Y",typeSchema:{type:"Number"},defaultValue:0},z:{displayName:"Z",typeSchema:{type:"Number"},defaultValue:0}}};let Oc={from:{displayName:"From",typeSchema:In,defaultValue:{x:0,y:0,z:0}},to:{displayName:"To",typeSchema:In,defaultValue:{x:1,y:0,z:0}},dimStringOffset:{displayName:"Dimension String Offset",typeSchema:In,defaultValue:{x:0,y:0,z:0}}};const Fc=new Ae({typeName:"Dimension",displayName:"Dimension",propertiesSchema:Oc}),Vc=Fc,Lc=new Ac;let Ul;{let C;Ul=async()=>(C!=null||(C=await Lc.loadAsync("fonts/Times New Roman_Regular.json")),C)}const ar=await Ul();class Hc{constructor(){this.componentType=Vc}create(e,n,r,o,l){return new Ec(n,r,o,l)}}let hr=new Hc;Be(hr);const Mm=hr;class Ec{constructor(e,n,r,o){this.type=hr,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o,this.line=t(()=>Ki.create(i.create(e.from.x,e.from.y,e.from.z),i.create(e.to.x,e.to.y,e.to.z))),this.offset=t(()=>i.create(e.dimStringOffset.x,e.dimStringOffset.y,e.dimStringOffset.z)),this.components=t(()=>{let l=this.line(),s=this.offset(),a=l.v2.sub(l.v1).normalize();if(!Number.isFinite(a.x))return[];let h=s.normalize();return Number.isFinite(h.x)?(h=a.cross(h).cross(a).normalize(),Number.isFinite(h.x)?[new T({line:t(()=>Ki.create(l.v1.add(s),l.v2.add(s)))}),new T({line:t(()=>Ki.create(l.v1.add(s),l.v1))}),new T({line:t(()=>Ki.create(l.v2.add(s),l.v2))}),new T({mkObject3d:t(()=>d=>{let c=l.v1.distance(l.v2).toFixed(2)+"mm",u=new Ui(c,{font:ar});if(u.scale(.001,.001,.001),u.computeBoundingBox(),u.boundingBox!=null){let N=u.boundingBox;u.translate(-.5*(N.max.x-N.min.x),0,-.5*(N.max.z-N.min.z))}let S=new rt({color:"red"});return Fe(()=>{u.dispose(),S.dispose()}),new xe(u,S)}),transform:t(()=>m.create(l.v1.add(l.v2).scale(.5).add(s).add(h.scale(10)),y.fromUV(a,h)))})]:[]):[]}),this.properties=t(()=>[{displayName:"Dimension",fields:[se({displayName:()=>"From X",value:()=>e.from.x,setValue:l=>n("from","x",l)}),se({displayName:()=>"From Y",value:()=>e.from.y,setValue:l=>n("from","y",l)}),se({displayName:()=>"From Z",value:()=>e.from.z,setValue:l=>n("from","z",l)}),se({displayName:()=>"To X",value:()=>e.to.x,setValue:l=>n("to","x",l)}),se({displayName:()=>"To Y",value:()=>e.to.y,setValue:l=>n("to","y",l)}),se({displayName:()=>"To Z",value:()=>e.to.z,setValue:l=>n("to","z",l)}),se({displayName:()=>"Offset X",value:()=>e.dimStringOffset.x,setValue:l=>n("dimStringOffset","x",l)}),se({displayName:()=>"Offset Y",value:()=>e.dimStringOffset.y,setValue:l=>n("dimStringOffset","y",l)}),se({displayName:()=>"Offset Z",value:()=>e.dimStringOffset.z,setValue:l=>n("dimStringOffset","z",l)})],expanded:()=>!0}]),this.updateDim=({line:l,offset:s})=>{At(()=>{n("from","x",l.v1.x),n("from","y",l.v1.y),n("from","z",l.v1.z),n("to","x",l.v2.x),n("to","y",l.v2.y),n("to","z",l.v2.z),n("dimStringOffset","x",s.x),n("dimStringOffset","y",s.y),n("dimStringOffset","z",s.z)})}}}class Zr{constructor(e){let n=()=>"20x3.0 SHS",r=t(()=>new Mi({size:20,thickness:3})),o=t(()=>new T({itemName:n,length:e.width,shsProperties:r,transform:()=>m.identity})),l=t(()=>new T({itemName:n,length:e.width,shsProperties:r,transform:t(()=>m.create(i.create(0,0,e.height()-r().size),y.identity))})),s=t(()=>new T({itemName:n,length:e.height,shsProperties:r,transform:t(()=>m.create(i.create(r().size,0,0),y.fromUV(i.unitZ,i.unitY)))})),a=t(()=>new T({itemName:n,length:e.height,shsProperties:r,transform:t(()=>m.create(i.create(e.width(),0,0),y.fromUV(i.unitZ,i.unitY)))})),h=t(()=>{if(e.style()=="Front")return{mesh:new Zt({width:()=>e.width()-2*r().size,apexHeight:()=>e.height()-2*r().size,pitch:()=>0,pitchOffset:()=>0}),space:t(()=>m.create(i.create(r().size,0,r().size),y.identity))}}),d=t(()=>{let u=h();return u==null?[]:[new T({children:u.mesh.components,transform:u.space})]}),c=t(()=>{if(e.style()=="Back")return new T({length:e.width,flatProperties:t(()=>new vt({width:e.height(),thickness:1})),transform:t(()=>m.create(i.zero,y.fromUV(i.unitX,i.unitZ)))})});this.components=t(()=>[o(),l(),s(),a(),...d(),...Pe(c())])}}class Uc{constructor(e){let n=()=>"90x45 Timber",r=t(()=>new et({webSize:90,flangeSize:45})),o=()=>"64x3.0 SHS",l=t(()=>new Mi({size:64,thickness:3})),s=t(()=>{let h=10,d=h,u=e.span()-h-d,S=Math.ceil(u/r().webSize),b=r().webSize,N=[],w=e.length()-2*h;for(let p=0;p<S;++p){let g=h,P=d+p*b;N.push(new T({itemName:n,length:()=>w,timberProperties:r,transform:t(()=>m.create(i.create(g,P,0),y.identity))}))}return N}),a=t(()=>[new T({itemName:o,length:e.length,shsProperties:l,transform:t(()=>m.create(i.create(0,0,-l().size+r().flangeSize),y.identity))}),new T({itemName:o,length:e.length,shsProperties:l,transform:t(()=>m.create(i.create(0,e.span()-l().size,-l().size+r().flangeSize),y.identity))}),new T({itemName:o,length:e.span,shsProperties:l,transform:t(()=>m.create(i.create(0,e.span(),-l().size+r().flangeSize),y.fromWU(i.unitZ,i.negUnitY)))}),new T({itemName:o,length:e.span,shsProperties:l,transform:t(()=>m.create(i.create(e.length()-l().size,e.span(),-l().size+r().flangeSize),y.fromWU(i.unitZ,i.negUnitY)))})]);this.components=t(()=>[...s(),...a()])}}class $r{constructor(e){let n=t(()=>new T({mkObject3d:()=>()=>{let r=.001,o=30;const l=new ds(new je(0,0,e.height()*r),new je(0,-.2*e.span()*r,0),new je(0,-.2*e.span()*r,.1*e.height()*r),new je(0,-(.5*e.span()-o*r)*r,.5*o*r));let s=new Et;s.moveTo(0,0),s.ellipse(-.5*o*r,0,.5*o*r,.5*o*r,0,2*Math.PI,!1,0);let a=new It(s,{steps:20,bevelEnabled:!1,extrudePath:l}),h=a.clone();h.rotateZ(Math.PI),h.translate(o*r,.5*o*r,0),a.translate(0,(e.span()-.5*o)*r,0);let d=new rt({color:"#808080"});Fe(()=>{a.dispose(),h.dispose(),d.dispose()});let c=new xe(a,d),u=new xe(h,d),S=new nt;return S.add(c),S.add(u),S}}));this.components=t(()=>[n()])}}class Rc{constructor(e){let n=t(()=>e.baySize()*e.numBays()),r=t(()=>e.pitch()*Math.PI/180),o=t(()=>Math.cos(r())),l=t(()=>Math.sin(r())),s=t(()=>Math.tan(r())),a=()=>100,h=t(()=>e.height()+e.span()*s()),d=t(()=>200),c=t(()=>({webSize:90,flangeSize:45})),u=()=>"20x3.0 SHS",S=t(()=>new Mi({size:20,thickness:3})),b=new Uc({span:e.span,length:n}),N=t(()=>m.create(i.create(0,0,d()),y.identity)),w=t(()=>new T({children:b.components,transform:N})),p=t(()=>[{location:"Endwall A",mesh:new Zt({width:t(()=>e.span()-e.backRoomSize()-S().size),apexHeight:h,pitch:e.pitch,pitchOffset:t(()=>e.span()-e.backRoomSize()-S().size)}),space:t(()=>m.create(i.create(S().size,e.span()-e.backRoomSize(),0),y.fromWU(i.unitZ,i.negUnitY)))},{location:"Endwall B",mesh:new Zt({width:t(()=>e.span()-e.backRoomSize()-S().size),apexHeight:h,pitch:e.pitch,pitchOffset:()=>-S().size}),space:t(()=>m.create(i.create(n()-S().size,0,0),y.fromWU(i.unitZ,i.unitY)))}]),g=t(()=>p().map(({location:_,mesh:Y,space:ee})=>new T({usage:()=>_,children:Y.components,transform:ee}))),P=t(()=>{let _=[];for(let Y=0;Y<e.numBays()-1;++Y){let ee=e.baySize()*(Y+1);_.push({location:"Midwall "+(Y+1).toString(),mesh:new Zt({width:t(()=>e.span()),apexHeight:h,pitch:e.pitch,pitchOffset:t(()=>e.span())}),space:t(()=>m.create(i.create(ee,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))})}return _}),M=t(()=>P().map(({location:_,mesh:Y,space:ee})=>new T({usage:()=>_,children:Y.components,transform:ee}))),v=t(()=>[{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.backRoomSize(),0),f.create(e.backRoomSize(),e.height()+e.backRoomSize()*s()),f.create(0,e.height())]),openings:()=>[],colour:()=>"Deep Ocean",previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))},{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.backRoomSize(),0),f.create(e.backRoomSize(),e.height()),f.create(0,e.height()+e.backRoomSize()*s())]),openings:()=>[],colour:()=>"Deep Ocean",previewOpening:()=>{}}),space:t(()=>m.create(i.create(n(),e.span()-e.backRoomSize(),0),y.fromWU(i.unitZ,i.unitY)))},{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,e.insideOpeningHeight()),f.create(n(),e.insideOpeningHeight()),f.create(n(),e.height()+e.backRoomSize()*s()),f.create(0,e.height()+e.backRoomSize()*s())]),openings:()=>[],colour:()=>"Deep Ocean",previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,e.span()-e.backRoomSize(),0),y.fromWU(i.unitZ,i.unitX)))},...Array(e.numBays()).fill(void 0).map((_,Y)=>({sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.baySize()-e.insideOpeningWidth(),0),f.create(e.baySize()-e.insideOpeningWidth(),e.insideOpeningHeight()),f.create(0,e.insideOpeningHeight())]),openings:()=>[],colour:()=>"Deep Ocean",sheetingType:()=>"Flat",previewOpening:()=>{}}),space:t(()=>m.create(i.create(Y*e.baySize(),e.span()-e.backRoomSize(),0),y.fromWU(i.unitZ,i.unitX)))}))]),k=t(()=>v().map(({sheeting:_,space:Y})=>new T({children:_.components,transform:Y}))),z=t(()=>{let _=[],Y=0;for(let ee=0;ee<e.numBays();++ee){let ce=Y;Y+=e.baySize();let Q=Y-ce-40,R=h()-S().size-S().size*s();_.push({door:new Zr({width:()=>Q,height:()=>R,style:()=>"Front"}),space:t(()=>m.create(i.create(ce+20,0,0),y.identity))})}return _}),x=t(()=>z().map(({door:_,space:Y})=>new T({children:_.components,transform:Y}))),A=t(()=>{let _=[],Y=0;for(let ee=0;ee<e.numBays();++ee){let ce=Y;Y+=e.baySize();let Ce=Y,Q=Ce-ce-40,R=e.height()-S().size;_.push({door:new Zr({width:()=>Q,height:()=>R,style:()=>"Back"}),space:t(()=>m.create(i.create(Ce-20,e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))})}return _}),I=t(()=>A().map(({door:_,space:Y})=>new T({children:_.components,transform:Y}))),O=()=>30,E=t(()=>[{leg:new $r({span:e.span,height:d}),space:t(()=>m.create(i.create(0,0,0),y.identity))},{leg:new $r({span:e.span,height:d}),space:t(()=>m.create(i.create(n()-O(),0,0),y.identity))}]),F=t(()=>E().map(({leg:_,space:Y})=>new T({children:_.components,transform:Y}))),$=t(()=>{let _=[],Y=0;for(let ee=0;ee<e.numBays()+1;++ee){let ce=Y;_.push(new T({itemName:u,length:h,shsProperties:S,transform:t(()=>m.create(i.create(ce+(ee==0?S().size:ee<e.numBays()?.5*S().size:0),0,0),y.fromUV(i.unitZ,i.unitY)))})),_.push(new T({itemName:u,length:e.height,shsProperties:S,transform:t(()=>m.create(i.create(ce+(ee==0?S().size:ee<e.numBays()?.5*S().size:0),e.span()-S().size,0),y.fromUV(i.unitZ,i.unitY)))})),Y+=e.baySize()}return _}),G=t(()=>{let _=[];return _.push(new T({itemName:u,length:n,shsProperties:S,transform:t(()=>m.create(i.create(0,0,h()-S().size),y.identity))})),_.push(new T({itemName:u,length:n,shsProperties:S,transform:t(()=>m.create(i.create(0,e.span()-S().size,e.height()-S().size),y.identity))})),_}),J=t(()=>{let _=[],Y=0,ee=e.span()/o()+S().size*s();for(let ce=0;ce<e.numBays()+1;++ce){let Ce=Y;_.push(new T({itemName:u,length:()=>ee,shsProperties:S,transform:t(()=>m.create(i.create(Ce+(ce==e.numBays()?-S().size:ce>0?-.5*S().size:0),e.span(),e.height()-S().size/o()),y.fromUV(i.create(0,-o(),l()),i.unitX)))})),Y+=e.baySize()}return _}),K={sheeting:new Te({type:()=>"Roof Sheeting",outline:()=>[f.create(0,-a()/o()),f.create(n(),-a()/o()),f.create(n(),e.span()/o()),f.create(0,e.span()/o())],openings:()=>[],colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(n(),e.span(),e.height()),y.fromWU(i.create(0,-o(),l()),i.negUnitX)))},te=t(()=>new T({children:K.sheeting.components,transform:K.space}));this.components=t(()=>[w(),new T({children:t(()=>[...g(),...M(),...x(),...I(),...$(),...G(),...J(),te(),...k()]),transform:t(()=>m.create(i.create(0,0,d()+c().flangeSize),y.identity))}),...F()])}}let Wc={numBays:{displayName:"# Bays",typeSchema:{type:"Number"},defaultValue:2},baySize:{displayName:"Bay Size",typeSchema:{type:"Number"},defaultValue:1e3},span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:2e3},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:1e3},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:5},backRoomSize:{displayName:"Back Room Size",typeSchema:{type:"Number"},defaultValue:762},insideOpeningHeight:{displayName:"Inside Opening Height",typeSchema:{type:"Number"},defaultValue:500},insideOpeningWidth:{displayName:"Inside Opening Width",typeSchema:{type:"Number"},defaultValue:500}};const Xc=new Ae({typeName:"DogKennel",displayName:"Dog Kennel",propertiesSchema:Wc}),Dc=Xc;class _c{constructor(){this.componentType=Dc}create(e,n,r,o,l){return new Yc(n,r,o,l)}}let Rl=new _c;Be(Rl);class Yc{constructor(e,n,r,o){this.type=Rl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new Rc({numBays:()=>e.numBays,baySize:()=>e.baySize,span:()=>e.span,height:()=>e.height,pitch:()=>e.pitch,backRoomSize:()=>e.backRoomSize,insideOpeningHeight:()=>e.insideOpeningHeight,insideOpeningWidth:()=>e.insideOpeningWidth});this.components=l.components,this.properties=()=>[{displayName:"Properties",fields:[Di({displayName:()=>"# Bays",value:()=>e.numBays,setValue:s=>n("numBays",s)}),se({displayName:()=>"Bay Size",value:()=>e.baySize,setValue:s=>n("baySize",s)}),se({displayName:()=>"Span",value:()=>e.span,setValue:s=>n("span",s)}),se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:s=>n("pitch",s)}),se({displayName:()=>"Back Room Size",value:()=>e.backRoomSize,setValue:s=>n("backRoomSize",s)}),se({displayName:()=>"Inside Opening Height",value:()=>e.insideOpeningHeight,setValue:s=>n("insideOpeningHeight",s)}),se({displayName:()=>"Inside Opening Width",value:()=>e.insideOpeningWidth,setValue:s=>n("insideOpeningWidth",s)})],expanded:()=>!0}]}}class Dn{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=t(()=>.5*e.span()*l()),a=t(()=>.5*e.span()/r()),h=t(()=>.5*e.span()),d=t(()=>{let S=[];return S.push({sheeting:new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,a()),f.create(h(),0),f.create(h(),a())]),openings:t(()=>[]),colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",previewOpening:()=>{}}),space:t(()=>m.create(i.create(-.5*e.span(),h(),0),y.fromWU(i.create(r(),0,o()),i.negUnitY)))}),S.push({sheeting:new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,a()),f.create(0,0),f.create(h(),a())]),openings:t(()=>[]),colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",previewOpening:()=>{}}),space:t(()=>m.create(i.create(.5*e.span(),0,0),y.fromWU(i.create(-r(),0,o()),i.unitY)))}),S}),c=t(()=>d().map(({sheeting:S,space:b})=>new T({children:S.components,transform:b}))),u=t(()=>{let S="Tiny Flashing",b=.5*e.span()/r()+25/l();return[new T({itemName:()=>S,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(0,.5*e.span(),s()+40),y.fromWU(i.create(1,0,-1).normalize(),i.negUnitY)),length:()=>.5*e.span(),flashingProfile:()=>ut}),new T({itemName:()=>S,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-.5*e.span()-o()*40,0,0+r()*40),y.fromWU(i.unitY,i.create(r(),0,o()).normalize())),length:()=>b,flashingProfile:()=>ut}),new T({itemName:()=>S,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(.5*e.span()+o()*40-r()*b,0,0+r()*40+o()*b),y.fromWU(i.unitY,i.create(r(),0,-o()).normalize())),length:()=>b,flashingProfile:()=>ut})]});this.components=t(()=>[...c(),...u()])}}let Gc={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:500},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:40}};const Zc=new Ae({typeName:"FakeRoofWindow",displayName:"Fake Roof Window",propertiesSchema:Gc}),$c=Zc;class Kc{constructor(){this.componentType=$c}create(e,n,r,o,l){return new jc(n,r,o,l)}}let Wl=new Kc;Be(Wl);class jc{constructor(e,n,r,o){this.type=Wl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new Dn({span:()=>e.span,pitch:()=>e.pitch});this.components=l.components,this.properties=t(()=>[{displayName:"Fake Roof Window",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:s=>n("span",s)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:s=>n("pitch",s)})],expanded:()=>!0}])}}class Qc{constructor(e){let n=t(()=>Math.PI-2*Math.PI/e.numSides()),r=t(()=>({plate:new qi({outline:t(()=>{let u=e.baseDiameter(),S=[];for(let b=0;b<e.numSides();++b){let N=2*Math.PI*b/e.numSides();S.push(f.create(Math.cos(N)*.5*u,Math.sin(N)*.5*u))}return S}),thickness:()=>4}),space:t(()=>m.create(i.create(0,0,e.baseHeight()),y.identity))})),o=t(()=>new T({children:r().plate.components,transform:r().space})),l=t(()=>{let u=e.baseDiameter(),S=[],b;b=new qi({outline:t(()=>{let w=e.baseDiameter()*Math.cos(.5*n()),p=e.diameter()*Math.cos(.5*n()),g;{let P=.5*(e.diameter()-e.baseDiameter())*Math.sin(.5*n()),M=e.headHeight()-e.baseHeight();g=Math.sqrt(P*P+M*M)}return[f.create(0,0),f.create(w,0),f.create(w+.5*(p-w),g),f.create(-.5*(p-w),g)]}),thickness:()=>4});let N;{let w=.5*(e.diameter()-e.baseDiameter())*Math.sin(.5*n()),p=e.headHeight()-e.baseHeight(),g=Math.sqrt(w*w+p*p);N=f.create(w/g,p/g)}for(let w=0;w<e.numSides();++w){let p=2*Math.PI*w/e.numSides(),g=2*Math.PI*(w+1)/e.numSides(),P=Math.cos(p)*.5*u,M=Math.sin(p)*.5*u,v=Math.cos(g)*.5*u,k=Math.sin(g)*.5*u,z=i.create(v-P,k-M,0).normalize(),x=i.create(z.y*N.x,-z.x*N.x,N.y);S.push({plate:b,space:t(()=>m.create(i.create(P,M,e.baseHeight()),y.fromUV(z,x)))})}return S}),s=t(()=>l().map(({plate:u,space:S})=>new T({children:u.components,transform:S}))),a=t(()=>{let u=e.legPitch()*Math.PI/180,S=Math.cos(u),b=Math.sin(u),N=new qi({outline:t(()=>[f.zero,f.create(100,0),f.create(100+150*S,150*b),f.create(230*S,230*b)]),thickness:()=>4}),w=[],p=.5*e.baseDiameter()+100+150*S;for(let g=0;g<e.numSides();++g){let P=2*Math.PI*g/e.numSides(),M=Math.cos(P),v=Math.sin(P),k=m.create(i.create(M*p,v*p,4),y.fromUV(i.create(-M,-v,0),i.unitZ));w.push({plate:N,space:()=>k})}return w}),h=t(()=>a().map(({plate:u,space:S})=>new T({children:u.components,transform:S}))),d=t(()=>{let u=new qi({outline:t(()=>[f.zero,f.create(40,0),f.create(40,140),f.create(0,140)]),thickness:()=>4});return a().map(({space:S})=>({plate:u,space:t(()=>{let b=S().o,N=S().u,w=S().w;return m.create(b.sub(w.scale(.5*40)).add(N.scale(.5*100-.5*140)).sub(i.create(0,0,4)),y.fromWU(i.unitZ,w))})}))}),c=t(()=>d().map(({plate:u,space:S})=>new T({children:u.components,transform:S})));this.components=t(()=>[o(),...s(),...h(),...c()]),this.totalPlateArea=t(()=>[r(),...l(),...a(),...d()].reduce((u,S)=>u+S.plate.plateArea(),0)),this.allocateLabels=u=>{},this.mkPlatesForDoc=u=>t(()=>[t(()=>({label:"Base Plate",quantity:1,outline:r().plate.outline()})),t(()=>({label:"Side Plate",quantity:6,outline:l()[0].plate.outline()})),t(()=>({label:"Leg Plate",quantity:6,outline:a()[0].plate.outline()})),t(()=>({label:"Feet",quantity:6,outline:d()[0].plate.outline()}))])}}class qi{constructor(e){let n=t(()=>new T({mkObject3d:t(()=>{let r=e.outline();if(r.length<3)return()=>new nt;let o=e.thickness();return l=>{let s=.001,a=new Et;a.moveTo(r[0].x*s,r[0].y*s);for(let w=1;w<r.length;++w)a.lineTo(r[w].x*s,r[w].y*s);a.closePath();let h=new It(a,{bevelEnabled:!1,depth:o*s}),d=new rt({color:"#808080"}),c=new bt(h),u=new Tt({color:"black"});Fe(()=>{h.dispose(),d.dispose(),c.dispose(),u.dispose()});let S=new xe(h,d),b=new ht(c,u),N=new nt;return N.add(S),N.add(b),N}})}));this.outline=e.outline,this.components=t(()=>[n()]),this.plateArea=t(()=>{let r=e.outline(),o=0;for(let l=0;l<r.length;++l){let s=(l+1)%r.length;o+=r[l].cross(r[s])}return .5*Math.abs(o)/1e6})}}let qc={numSides:{displayName:"# of Sides",typeSchema:{type:"Number"},defaultValue:4},diameter:{displayName:"Diameter",typeSchema:{type:"Number"},defaultValue:760},baseDiameter:{displayName:"Base Diameter",typeSchema:{type:"Number"},defaultValue:420},baseHeight:{displayName:"Base Height",typeSchema:{type:"Number"},defaultValue:152},headHeight:{displayName:"Head Height",typeSchema:{type:"Number"},defaultValue:152+185},legPitch:{displayName:"Leg Pitch",typeSchema:{type:"Number"},defaultValue:80}};const Jc=new Ae({typeName:"FirePit",displayName:"Fire Pit",propertiesSchema:qc}),ed=Jc;class td{constructor(){this.componentType=ed}create(e,n,r,o,l){return new id(n,r,o,l)}}let Xl=new td;Be(Xl);class id{constructor(e,n,r,o){this.type=Xl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=a=>a/Math.sin(.5*(Math.PI-2*Math.PI/e.numSides)),s=new Qc({numSides:()=>e.numSides,diameter:()=>l(e.diameter),baseDiameter:()=>l(e.baseDiameter),baseHeight:()=>e.baseHeight,headHeight:()=>e.headHeight,legPitch:()=>e.legPitch});this.components=s.components,this.properties=t(()=>[{displayName:"Fire Pit",fields:[se({displayName:()=>"# of Sides",value:()=>e.numSides,setValue:a=>n("numSides",a)}),se({displayName:()=>"Diameter",value:()=>e.diameter,setValue:a=>n("diameter",a)}),se({displayName:()=>"Base Diameter",value:()=>e.baseDiameter,setValue:a=>n("baseDiameter",a)}),se({displayName:()=>"Base Height",value:()=>e.baseHeight,setValue:a=>n("baseHeight",a)}),se({displayName:()=>"Head Height",value:()=>e.headHeight,setValue:a=>n("headHeight",a)}),se({displayName:()=>"Leg Pitch",value:()=>e.legPitch,setValue:a=>n("legPitch",a)}),Qn({displayName:()=>"Area m\xB2",value:()=>s.totalPlateArea().toFixed(2)})],expanded:()=>!0}]),this.allocateLabels=s.allocateLabels,this.mkPlatesForDoc=s.mkPlatesForDoc}}let nd={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:6e3},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:15},kneeHeight:{displayName:"Knee Height",typeSchema:{type:"Number"},defaultValue:30},numWebSpacingPerSide:{displayName:"# Web Spacing Per Side",typeSchema:{type:"Number"},defaultValue:4},leftOverhang:{displayName:"Left Overhang",typeSchema:{type:"Number"},defaultValue:0},rightOverhang:{displayName:"Right Overhang",typeSchema:{type:"Number"},defaultValue:0}};const rd=new Ae({typeName:"GableTruss",displayName:"Gable Truss",propertiesSchema:nd}),ld=rd;class od{constructor(){this.componentType=ld}create(e,n,r,o,l){return new sd(n,r,o,l)}}let Dl=new od;Be(Dl);class sd{constructor(e,n,r,o){this.type=Dl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o,this.properties=t(()=>[{displayName:"Properties",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:l=>n("span",l)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:l=>n("pitch",l)}),se({displayName:()=>"Knee Height",value:()=>e.kneeHeight,setValue:l=>n("kneeHeight",l)}),Di({displayName:()=>"Num Web Spacing Per Side",value:()=>e.numWebSpacingPerSide,setValue:l=>n("numWebSpacingPerSide",l)})],expanded:()=>!0}]),this.components=t(()=>new vs({span:()=>e.span,pitch:()=>e.pitch,kneeHeight:()=>e.kneeHeight,numWebSpacingPerSize:()=>e.numWebSpacingPerSide,leftOverhang:()=>0,rightOverhang:()=>0,boxed:()=>!1}).members().flatMap(l=>Pe(l())))}}class Ji{constructor(e){let n=e.mkKit,r=t(()=>{let w=e.shape();switch(w.type){case"Rect":return w;case"Gable":{let p=w,g=t(()=>p.pitch()*Math.PI/180),P=t(()=>Math.cos(g())),M=t(()=>Math.sin(g())),v=t(()=>Math.tan(g())),k=t(()=>90-.5*(90+p.pitch()));return{type:"Gable",height:w.height,pitch:w.pitch,ca:P,sa:M,ta:v,kneeBackCut:k}}case"Skillion":{let p=w,g=t(()=>p.pitch()*Math.PI/180),P=t(()=>Math.cos(g())),M=t(()=>Math.sin(g())),v=t(()=>Math.tan(g())),k=t(()=>90-.5*(90+p.pitch())),z=t(()=>90-.5*(90-p.pitch()));return{type:"Skillion",height:w.height,pitch:w.pitch,ca:P,sa:M,ta:v,leftKneeBackCut:k,rightKneeBackCut:z}}case"Reverse Skillion":{let p=w,g=t(()=>p.pitch()*Math.PI/180),P=t(()=>Math.cos(g())),M=t(()=>Math.sin(g())),v=t(()=>Math.tan(g())),k=t(()=>90-.5*(90-p.pitch())),z=t(()=>90-.5*(90+p.pitch()));return{type:"Reverse Skillion",height:w.height,pitch:w.pitch,ca:P,sa:M,ta:v,leftKneeBackCut:k,rightKneeBackCut:z}}}}),o=w=>{let p=r();switch(p.type){case"Rect":return p.height()-e.frameMemberProperties().size;case"Gable":return p.height()+(.5*e.length()-Math.abs(.5*e.length()-w))*p.ta()-e.frameMemberProperties().size/p.ca()+.5*e.frameMemberProperties().size*p.ta();case"Skillion":return p.height()+w*p.ta()-e.frameMemberProperties().size/p.ca()+.5*e.frameMemberProperties().size*p.ta();case"Reverse Skillion":return p.height()+(e.length()-w)*p.ta()-e.frameMemberProperties().size/p.ca()+.5*e.frameMemberProperties().size*p.ta()}},l=t(()=>[new T({length:e.length,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(0,0,0),y.identity))})]),s=t(()=>{let w=r();switch(w.type){case"Rect":{let p=w;return[new T({length:e.length,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(0,0,p.height()-e.frameMemberProperties().size),y.identity))})]}case"Gable":{let p=w,g=t(()=>.5*e.length()/p.ca());return[new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,frontBackCutAngle:t(()=>-p.kneeBackCut()),backBackCutAngle:t(()=>-p.pitch()),transform:t(()=>m.create(i.create(e.frameMemberProperties().size*p.sa(),0,p.height()-e.frameMemberProperties().size*p.ca()),y.fromUV(i.create(p.ca(),0,p.sa()),i.unitY)))}),new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,frontBackCutAngle:t(()=>-p.kneeBackCut()),backBackCutAngle:t(()=>-p.pitch()),transform:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size*p.sa(),e.frameMemberProperties().size,p.height()-e.frameMemberProperties().size*p.ca()),y.fromUV(i.create(-p.ca(),0,p.sa()),i.negUnitY)))})]}case"Skillion":{let p=w,g=t(()=>(e.length()-e.frameMemberProperties().size)/p.ca());return[new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,frontBackCutAngle:t(()=>-p.leftKneeBackCut()),backBackCutAngle:t(()=>-p.pitch()),transform:t(()=>m.create(i.create(e.frameMemberProperties().size*p.sa(),0,p.height()-e.frameMemberProperties().size*p.ca()),y.fromUV(i.create(p.ca(),0,p.sa()),i.unitY)))})]}case"Reverse Skillion":{let p=w,g=t(()=>(e.length()-e.frameMemberProperties().size)/p.ca());return[new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,frontBackCutAngle:t(()=>-p.pitch()),backBackCutAngle:t(()=>-p.rightKneeBackCut()),transform:t(()=>m.create(i.create(-e.frameMemberProperties().size*p.sa()+e.frameMemberProperties().size,0,p.height()+e.length()*p.ta()-e.frameMemberProperties().size*p.ca()-e.frameMemberProperties().size*p.ta()),y.fromUV(i.create(p.ca(),0,-p.sa()),i.unitY)))})]}}}),a=t(()=>{let w=r();switch(w.type){case"Gable":{let p=w,g=t(()=>p.height()-e.frameMemberProperties().size);return new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,backBackCutAngle:t(()=>-p.kneeBackCut()),transform:t(()=>m.create(i.create(e.frameMemberProperties().size,0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))})}case"Skillion":{let p=w,g=t(()=>p.height()-e.frameMemberProperties().size);return new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,backBackCutAngle:t(()=>-p.leftKneeBackCut()),transform:t(()=>m.create(i.create(e.frameMemberProperties().size,0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))})}case"Reverse Skillion":{let p=w,g=t(()=>p.height()+e.length()*p.ta()-e.frameMemberProperties().size);return new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,backBackCutAngle:t(()=>-p.pitch()),transform:t(()=>m.create(i.create(e.frameMemberProperties().size,0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))})}default:return}}),h=t(()=>{let w=r();switch(w.type){case"Gable":{let p=w,g=t(()=>p.height()-e.frameMemberProperties().size);return new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,backBackCutAngle:t(()=>-p.kneeBackCut()),transform:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size,e.frameMemberProperties().size,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.negUnitY)))})}case"Skillion":{let p=w,g=t(()=>p.height()+e.length()*p.ta()-e.frameMemberProperties().size);return new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,backBackCutAngle:t(()=>-p.pitch()),transform:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size,e.frameMemberProperties().size,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.negUnitY)))})}case"Reverse Skillion":{let p=w,g=t(()=>p.height()-e.frameMemberProperties().size);return new T({length:g,itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,backBackCutAngle:t(()=>-p.rightKneeBackCut()),transform:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size,e.frameMemberProperties().size,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.negUnitY)))})}}}),d=t(()=>{if(e.nogginHeights().length==0)return[];let w=[],p;e.shape().type=="Rect"?p=[-.5*e.frameMemberProperties().size,e.length()+.5*e.frameMemberProperties().size]:p=[.5*e.frameMemberProperties().size,e.length()-.5*e.frameMemberProperties().size];for(let g=0;g<p.length-1;++g){let P=p[g],M=p[g+1],v=P+.5*e.frameMemberProperties().size,k=M-.5*e.frameMemberProperties().size;for(let z of e.nogginHeights()){let x=z-e.frameMemberProperties().size,A=k-v;w.push(new T({length:()=>A,itemName:e.frameMemberItemName,shsProperties:e.frameMemberProperties,hasLabel:()=>!0,transform:t(()=>m.create(i.create(v,0,x),y.identity))}))}}return w}),c=t(()=>e.openings().flatMap(w=>e.shape().type=="Rect"&&w.type!="Double X Brace Barn Door"&&w.type!="Window"&&w.type!="Double PA Door"?[]:new T({itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,length:()=>w.width,transform:t(()=>m.create(i.create(w.pos.x,0,w.pos.y+w.height),y.fromUV(i.unitX,i.unitY)))}))),u=t(()=>e.openings().flatMap(w=>w.type!="Window"||w.pos.y<=e.frameMemberProperties().size?[]:new T({itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,length:()=>w.width,transform:t(()=>m.create(i.create(w.pos.x,0,w.pos.y-e.frameMemberProperties().size),y.fromUV(i.unitX,i.unitY)))}))),S=t(()=>e.openings().flatMap(w=>{let p;w.type=="Fake X Brace Barn Window"?p=[w.pos.x+.5*e.frameMemberProperties().size,w.pos.x+w.width-.5*e.frameMemberProperties().size]:p=[w.pos.x-.5*e.frameMemberProperties().size,w.pos.x+w.width+.5*e.frameMemberProperties().size],p=p.filter(v=>1.5*e.frameMemberProperties().size<v&&v<e.length()-1.5*e.frameMemberProperties().size);let g=e.frameMemberProperties().size,P=w.pos.x+.5*w.width;for(let v of c()){let k=v.transform?.call(void 0);if(k==null)continue;let z=v.length?.call(void 0);if(z==null)continue;let x=k.o.x,A=k.o.x+k.u.x*z;x<P&&P<A&&k.o.z<w.pos.y&&(g=Math.max(g,k.o.z+e.frameMemberProperties().size))}let M=r();return p.map(v=>{let z=o(v)-g,x;switch(M.type){case"Rect":x=void 0;break;case"Gable":{let A=M.pitch()*(v>.5*e.length()?-1:1);x=()=>A;break}}return M.type=="Rect"&&(x=void 0),new T({itemName:e.frameMemberItemName,hasLabel:()=>!0,shsProperties:e.frameMemberProperties,length:()=>z,backBackCutAngle:x,transform:t(()=>m.create(i.create(v+.5*e.frameMemberProperties().size,0,g),y.fromUV(i.unitZ,i.unitY)))})})})),b=t(()=>{if(!(e.includeMeshAbove()&&e.nogginHeights().length!=0))return;let w=e.nogginHeights().reduce((p,g)=>Math.max(p,g),0);return n({id:"Upper Mesh",kitType:Ht,state:{length:e.length,apexHeight:()=>{let p=r();switch(p.type){case"Rect":return p.height()-(w+.5*e.frameMemberProperties().size);case"Gable":return p.height()+.5*e.length()*p.ta()-(w+.5*e.frameMemberProperties().size);case"Skillion":return p.height()+e.length()*p.ta()-(w+.5*e.frameMemberProperties().size);case"Reverse Skillion":return p.height()+e.length()*p.ta()-(w+.5*e.frameMemberProperties().size)}},pitch:()=>{let p=r();switch(p.type){case"Rect":return 0;case"Gable":return p.pitch();case"Skillion":return p.pitch();case"Reverse Skillion":return p.pitch()}},pitchOffset:()=>{switch(r().type){case"Rect":return 0;case"Gable":return .5*e.length();case"Skillion":return e.length();case"Reverse Skillion":return 0}}},space:t(()=>m.create(i.create(0,.5*e.frameMemberProperties().size,w),y.identity))})});this.kits=t(()=>[...Pe(b())].flatMap(w=>Pe(w())));let N=mn(this.kits);this.components=t(()=>[...N(),...l(),...s(),...Pe(a()),...Pe(h()),...c(),...S(),...u(),...d()]),this.mkFrameForDoc=w=>t(()=>{let p,g=r();switch(g.type){case"Rect":p=[0,g.height()];break;case"Gable":p=[0,g.height(),g.height()+.5*e.length()*g.ta()];break;case"Skillion":p=[0,g.height(),g.height()+e.length()*g.ta()];break;case"Reverse Skillion":p=[0,g.height(),g.height()+e.length()*g.ta()];break}return{components:this.components(),dimensionStrings:[{space:m.create(i.create(0,0,-300),y.fromUV(i.unitX,i.unitZ)),markers:[0,e.length()]},{space:m.create(i.create(e.length()+300,0,0),y.fromUV(i.unitZ,i.negUnitX)),markers:p}]}})}}class cn{constructor(e){let n=t(()=>{let r=t(()=>e.width()-2*e.frameTimberProperties().webSize),o=t(()=>{let l=[];return l.push({fromZ:e.frameTimberProperties().webSize,toZ:e.height()-e.frameTimberProperties().webSize,flipped:!1}),l.push({fromZ:e.frameTimberProperties().webSize,toZ:e.height()-e.frameTimberProperties().webSize,flipped:!0}),l});return[new T({itemName:e.frameTimberItemName,length:e.height,timberProperties:e.frameTimberProperties,transform:t(()=>m.create(i.create(0,e.frameTimberProperties().flangeSize,e.height()),y.fromWU(i.negUnitY,i.negUnitZ)))}),new T({itemName:e.frameTimberItemName,length:e.height,timberProperties:e.frameTimberProperties,transform:t(()=>m.create(i.create(e.width(),e.frameBraceTimberProperties().flangeSize,0),y.fromWU(i.negUnitY,i.unitZ)))}),new T({itemName:e.frameTimberItemName,length:r,timberProperties:e.frameTimberProperties,transform:t(()=>m.create(i.create(e.frameTimberProperties().webSize,e.frameTimberProperties().flangeSize,0),y.fromWU(i.negUnitY,i.unitX)))}),new T({itemName:e.frameTimberItemName,length:r,timberProperties:e.frameTimberProperties,transform:t(()=>m.create(i.create(e.frameTimberProperties().webSize,e.frameTimberProperties().flangeSize,e.height()-e.frameTimberProperties().webSize),y.fromWU(i.negUnitY,i.unitX)))}),...o().flatMap(({fromZ:l,toZ:s},a)=>{let h=e.frameTimberProperties().webSize,d=e.width()-e.frameTimberProperties().webSize,c=s-l,u=d-h,S=e.frameBraceTimberProperties().webSize,b=Math.sqrt(u*u+c*c-S*S),N;{let A=b,I=S,O=Math.sqrt(A*A+I*I);N=tr.xy(f.create(A/O,-I/O))}let w=f.create(u,-c).normalize(),p=N.rotate(w),g=p.x,P=p.y,M=(a&1)==0;M&&(g=-g);let v=-P,k=g,z=m.create(i.create(M?d:h+v*S,0,M?s:s+k*S),y.fromWU(i.unitY,i.create(g,0,P))),x=Math.atan(Math.abs(g/P))*180/Math.PI;return[new T({itemName:e.frameBraceTimberItemName,length:()=>b,timberProperties:e.frameBraceTimberProperties,frontBackCutAngle:()=>M?x:-x,backBackCutAngle:()=>M?-x:x,transform:()=>z})]}),...(()=>{let l=e.width(),s=Math.floor(l/e.frameTimberProperties().webSize),a=e.frameTimberProperties().webSize,h=[];for(let d=0;d<s;++d){let c=d*a;h.push(new T({itemName:e.frameTimberItemName,length:e.height,timberProperties:e.frameTimberProperties,transform:t(()=>m.create(i.create(c,e.frameTimberProperties().flangeSize*2,e.height()),y.fromWU(i.negUnitY,i.negUnitZ)))}))}return h})()]});this.components=t(()=>[...n()])}}class _l{constructor(e){let n=t(()=>new T({mkObject3d:t(()=>{let o=e.attachToPitch()*Math.PI/180,l=Math.tan(o);return s=>{let a=.001,h=new Et;h.moveTo(0,0),h.lineTo(.5*e.baseSize()*a,-.5*e.baseSize()*l*a),h.lineTo(.5*e.baseSize()*a,-.5*e.baseSize()*l*a+e.baseHeight()*a),h.lineTo(-.5*e.baseSize()*a,-.5*e.baseSize()*l*a+e.baseHeight()*a),h.lineTo(-.5*e.baseSize()*a,-.5*e.baseSize()*l*a),h.closePath();let d=new It(h,{bevelEnabled:!1,depth:e.baseSize()*a});d.rotateX(.5*Math.PI),d.rotateZ(.5*Math.PI),d.translate(-.5*e.baseSize()*a,0,0);let c=-.5*e.baseSize()*l+e.baseHeight(),u=new rt({color:"#606060"}),S=new bt(d),b=new Tt({color:"black"}),N=.5*e.baseSize()*Math.tan(e.basePitch()*Math.PI/180),w=new hi(0,.5*e.baseSize()*Math.SQRT2*a,N*a,4);w.rotateX(.5*Math.PI),w.rotateZ(.25*Math.PI),w.translate(0,0,c*a+.5*N*a);let p=new bt(w),g=150,P=new hi(10*a,10*a,g*a);P.rotateX(.5*Math.PI),P.translate(0,0,.5*g*a+(c+N)*a);let M=250,v=new hi(10*a,10*a,M*a);v.translate(0,0,(c+N+g)*a);let k=new hi(10*a,10*a,M*a);k.rotateZ(.5*Math.PI),k.translate(0,0,(c+N+g)*a);let z=new Ui("N",{font:e.font()});z.scale(.001,.001,.001),z.computeBoundingBox(),z.boundingBox!=null&&z.translate(0,-.5*(z.boundingBox.min.y+z.boundingBox.max.y),-.5*(z.boundingBox.min.z+z.boundingBox.max.z)),z.rotateX(.5*Math.PI),z.rotateZ(.5*Math.PI),z.translate(0,.5*M*a,(c+N+g)*a);let x=new bt(z),A=new Ui("S",{font:e.font()});A.scale(.001,.001,.001),A.computeBoundingBox(),A.boundingBox!=null&&A.translate(-A.boundingBox.max.x,-.5*(A.boundingBox.min.y+A.boundingBox.max.y),-.5*(A.boundingBox.min.z+A.boundingBox.max.z)),A.rotateX(.5*Math.PI),A.rotateZ(.5*Math.PI),A.translate(0,-.5*M*a,(c+N+g)*a);let I=new bt(A),O=new Ui("E",{font:e.font()});O.scale(.001,.001,.001),O.computeBoundingBox(),O.boundingBox!=null&&O.translate(0,-.5*(O.boundingBox.min.y+O.boundingBox.max.y),-.5*(O.boundingBox.min.z+O.boundingBox.max.z)),O.rotateX(.5*Math.PI),O.translate(.5*M*a,0,(c+N+g)*a);let E=new bt(O),F=new Ui("W",{font:e.font()});F.scale(.001,.001,.001),F.computeBoundingBox(),F.boundingBox!=null&&F.translate(-F.boundingBox.max.x,-.5*(F.boundingBox.min.y+F.boundingBox.max.y),-.5*(F.boundingBox.min.z+F.boundingBox.max.z)),F.rotateX(.5*Math.PI),F.translate(-.5*M*a,0,(c+N+g)*a);let $=new bt(F);Fe(()=>{d.dispose(),u.dispose(),S.dispose(),b.dispose(),w.dispose(),p.dispose(),v.dispose(),k.dispose(),z.dispose(),x.dispose(),A.dispose(),I.dispose(),O.dispose(),E.dispose(),F.dispose(),$.dispose()});let G=new xe(d,u),J=new ht(S,b),K=new xe(w,u),te=new ht(p,b),_=new xe(P,u),Y=new xe(v,u),ee=new xe(k,u),ce=new xe(z,u),Ce=new ht(x,b),Ue=new xe(A,u),Q=new ht(I,b),R=new xe(O,u),V=new ht(E,b),L=new xe(F,u),ne=new ht($,b),he=new nt;return he.add(G),he.add(J),he.add(K),he.add(te),he.add(_),he.add(Y),he.add(ee),he.add(ce),he.add(Ce),he.add(Ue),he.add(Q),he.add(R),he.add(V),he.add(L),he.add(ne),he}})}));this.components=t(()=>[n()])}}class ad{constructor(e){let n=e.mkKit,r=t(()=>e.kickAngle()*Math.PI/180),o=t(()=>Math.cos(r())),l=t(()=>Math.sin(r()));t(()=>ys(e.flatItemName())??new vt({width:100,thickness:5}));let s=n({id:"Base",kitType:Oe,state:{itemName:e.flatItemName,length:e.baseLength}}),a=n({id:"Back Kick",kitType:Oe,state:{itemName:e.flatItemName,length:e.kickLength},space:t(()=>m.create(i.create(-o()*e.kickLength(),0,l()*e.kickLength()),y.fromUV(i.create(o(),0,-l()),i.unitY)))}),h=n({id:"Front Kick",kitType:Oe,state:{itemName:e.flatItemName,length:e.kickLength},space:t(()=>m.create(i.create(e.baseLength(),0,0),y.fromUV(i.create(o(),0,l()),i.unitY)))});this.kits=t(()=>[s(),a(),h()].flatMap(c=>Pe(c)));let d=mn(this.kits);this.components=d}}let hd={baseLength:{displayName:"Base Length",typeSchema:{type:"Number"},defaultValue:3e3},kickLength:{displayName:"Kick Length",typeSchema:{type:"Number"},defaultValue:200},kickAngle:{displayName:"Kick Angle",typeSchema:{type:"Number"},defaultValue:30},flatItemName:{displayName:"Flat Item Name",typeSchema:{type:"String"},defaultValue:"Flat 100x5"}};const cd=new Ae({typeName:"Ski",displayName:"Ski",propertiesSchema:hd}),dd=cd;class ud{constructor(){this.componentType=dd}create(e,n,r,o,l){return new fd(e,n,r,o,l)}}let cr=new ud;Be(cr);const Kr=cr;class fd{constructor(e,n,r,o,l){this.type=cr,this.state=n,this.setState=r,this.kitsUserEdits=o,this.setKitsUserEdits=l;let s=new ad({baseLength:()=>n.baseLength,kickLength:()=>n.kickLength,kickAngle:()=>n.kickAngle,flatItemName:()=>n.flatItemName,mkKit:ol({kitsUserEdits:o,setKitsUserEdits:l})});this.kits=s.kits,this.components=s.components}}class pd{constructor(e){let n=t(()=>new T({itemName:()=>"Toe Point",mkObject3d:()=>r=>{let o=.001,l=new us(.5*e.diameter()*o,.5*e.thickness()*o,void 0,20);l.translate((e.stemLength()+.5*e.diameter())*o,0,0);let s=new hi(.5*e.thickness()*o,.5*e.thickness()*o,e.stemLength()*o);s.rotateZ(.5*Math.PI),s.translate(.5*e.stemLength()*o,0,0);let a=new rt({color:"#808080"}),h=new xe(l,a),d=new xe(s,a);Fe(()=>{l.dispose(),s.dispose(),a.dispose()});let c=new nt;return c.add(h),c.add(d),c}}));this.components=t(()=>[n()])}}let md={stemLength:{displayName:"Stem Length",typeSchema:{type:"Number"},defaultValue:20},diameter:{displayName:"Diameter",typeSchema:{type:"Number"},defaultValue:35},thickness:{displayName:"Thickness",typeSchema:{type:"Number"},defaultValue:8}};const gd=new Ae({typeName:"ToePoint",displayName:"Toe Point",propertiesSchema:md}),yd=gd;class bd{constructor(){this.componentType=yd}create(e,n,r,o,l){return new Sd(e,n,r,o,l)}}let dr=new bd;Be(dr);const wd=dr;class Sd{constructor(e,n,r,o,l){this.type=dr,this.state=n,this.setState=r,this.kitsUserEdits=o,this.setKitsUserEdits=l;let s=new pd({stemLength:()=>n.stemLength,diameter:()=>n.diameter,thickness:()=>n.thickness});this.components=s.components}}let Pd={length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:1e3},dim1:{displayName:"Dim 1",typeSchema:{type:"Number"},defaultValue:40},dim2:{displayName:"Dim 2",typeSchema:{type:"Number"},defaultValue:50},dim3:{displayName:"Dim 3",typeSchema:{type:"Number"},defaultValue:35}};const Nd=new Ae({typeName:"VermanFlashing",displayName:"Verman Flashing",propertiesSchema:Pd}),Md=Nd;class Cd{constructor(){this.componentType=Md}create(e,n,r,o,l){return new vd(e,n,r,o,l)}}let ur=new Cd;Be(ur);const en=ur;class vd{constructor(e,n,r,o,l){this.type=ur,this.state=n,this.setState=r,this.kitsUserEdits=o,this.setKitsUserEdits=l;let s=new T({itemName:()=>"Verman Flashing",length:()=>n.length,flashingProfile:t(()=>({start:{x:-n.dim1,y:0},segments:[{turnAngle:0,length:n.dim1},{turnAngle:-90,length:n.dim2},{turnAngle:90,length:n.dim3},{turnAngle:-90,length:.5},{turnAngle:-45,length:10}]}))});this.components=t(()=>[s])}}class Td{constructor(e){this.components=t(()=>[new T({layers:t(()=>[ve.Cladding]),openingProperties:t(()=>new Si({type:"PA Door",modelName:"",width:.5*e.width(),height:e.height(),removeHandle:!0})),colour:e.colour}),new T({layers:t(()=>[ve.Cladding]),openingProperties:t(()=>new Si({type:"PA Door",modelName:"",width:.5*e.width(),height:e.height(),swapHingeSide:!0})),colour:e.colour,transform:t(()=>m.create(i.create(.5*e.width(),0,0),y.identity))})])}}const tn=30+50,Ut=120;class kd{constructor(e){let n=e.mkKit,r="SidewallA",o="SidewallB",l="EndwallA",s="EndwallB",a=t(()=>e.pitch()*Math.PI/180),h=t(()=>Math.cos(a())),d=t(()=>Math.sin(a())),c=t(()=>Math.tan(a())),u=t(()=>{switch(e.roofType()){case"Gable":return e.height()+.5*e.span()*c();case"Skillion":return e.height()+e.span()*c()}}),S=()=>"50x2.0 SHS",b=t(()=>Qt[S()]),N=()=>"50x25x2.0 RHS",w=t(()=>Ri[N()]),p=()=>1200,g=()=>"ModWood Decking 88x23mm",P=t(()=>new et({webSize:88,flangeSize:23})),M=de=>t(()=>e.openings().flatMap(ue=>{if(ue.location.head()!=de)return[];{let pe=ue.location.tail();return pe==null?[]:{...ue,location:pe}}})),v=M("Sidewall A"),k=M("Sidewall B"),z=M("Endwall A"),x=M("Endwall B"),A=de=>{switch(de){case"Sidewall A":return[e.length()];case"Sidewall B":return[e.length()];case"Endwall A":return[e.span()];case"Endwall B":return[e.span()];default:return[]}},I=de=>{switch(de){case"Sidewall A":return m.create(i.zero,y.identity);case"Sidewall B":return m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX));case"Endwall A":return m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY));case"Endwall B":return m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY));default:return}},O=(de,ue,pe)=>{let Ne=A(de);if(Ne==null||ue.head()!="Bay")return;let ot=ue.tail();if(ot==null)return;let Qe=ot.head();if(Qe==null)return;let Ye=Number.parseInt(Qe);if(!Number.isFinite(Ye)||Ye<0||Ye>=Ne.length)return;let Mt;switch(de){case"Sidewall A":Mt=!1;break;case"Sidewall B":Mt=!0;break;case"Endwall A":Mt=!0;break;case"Endwall B":Mt=!1;break;default:Mt=!1;break}Mt&&(Ye=Ne.length-1-Ye);let pt=0;for(let re=0;re<Ye;++re)pt+=Ne[re];let Ct=pt+Ne[Ye],q;switch(pe.posX.type){case"Centre":{q=.5*(pt+Ct)-.5*pe.width;break}case"Left":{q=pt+pe.posX.dist;break}case"Right":{q=Ct-pe.posX.dist-pe.width;break}}let fe=pe.headHeight-pe.height;return f.create(q,fe)},E=(de,ue)=>ue.flatMap(pe=>{let Ne=O(de,pe.location,pe);return Ne==null?[]:[{type:pe.type,pos:Ne,width:pe.width,height:pe.height}]}),F=t(()=>E("Sidewall A",v())),$=t(()=>E("Sidewall B",k())),G=t(()=>E("Endwall A",z())),J=t(()=>E("Endwall B",x())),K=t(()=>e.includeNoggin()?[.5*u()]:[]),te=de=>t(()=>e.openBays().flatMap(ue=>{if(ue.location.head()!=de)return[];let pe=ue.location.tail();return pe==null?[]:[{...ue,location:pe}]})),_=te(r),Y=te(o),ee=te(l),ce=te(s),Ce=t(()=>{let de=[];return de.push({side:"Sidewall A",frame:new Ji({length:t(()=>e.length()-2*b().size),shape:t(()=>({type:"Rect",height:e.height})),nogginHeights:t(()=>{if(e.openSidewallA())return[];let ue=K(),pe=_().flatMap(Ne=>{switch(Ne.type){case"Lower Infill":return[Ne.toHeight]}return[]});return[...ue,...pe]}),openings:t(()=>F().map(ue=>({...ue,pos:f.create(ue.pos.x-b().size,ue.pos.y)}))),frameMemberItemName:S,frameMemberProperties:b,frameStudItemName:N,frameStudProperties:w,maxStudCentres:p,includeMeshAbove:t(()=>_().some(ue=>ue.type=="Lower Infill"&&ue.includeMeshAbove)),mkKit:n}),space:t(()=>m.create(i.create(b().size,0,0),y.fromWU(i.unitZ,i.unitX)))}),de.push({side:"Sidewall B",frame:new Ji({length:t(()=>e.length()-2*b().size),shape:t(()=>({type:"Rect",height:t(()=>{switch(e.roofType()){case"Gable":return e.height();case"Skillion":return u()-b().size*c()}})})),nogginHeights:t(()=>{let ue=K(),pe=Y().flatMap(Ne=>{switch(Ne.type){case"Lower Infill":return[Ne.toHeight]}return[]});return[...ue,...pe]}),openings:t(()=>$().map(ue=>({...ue,pos:f.create(ue.pos.x-b().size,ue.pos.y)}))),frameMemberItemName:S,frameMemberProperties:b,frameStudItemName:N,frameStudProperties:w,maxStudCentres:p,includeMeshAbove:t(()=>Y().some(ue=>ue.type=="Lower Infill"&&ue.includeMeshAbove)),mkKit:n}),space:t(()=>m.create(i.create(e.length()-b().size,e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))}),de.push({side:"Endwall A",frame:new Ji({length:e.span,shape:t(()=>{switch(e.roofType()){case"Gable":return{type:"Gable",height:e.height,pitch:e.pitch};case"Skillion":return{type:"Reverse Skillion",height:e.height,pitch:e.pitch}}}),nogginHeights:t(()=>{let ue=K(),pe=ee().flatMap(Ne=>{switch(Ne.type){case"Lower Infill":return[Ne.toHeight]}return[]});return[...ue,...pe]}),openings:G,frameMemberItemName:S,frameMemberProperties:b,frameStudItemName:N,frameStudProperties:w,maxStudCentres:p,includeMeshAbove:t(()=>ee().some(ue=>ue.type=="Lower Infill"&&ue.includeMeshAbove)),mkKit:n}),space:t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))}),de.push({side:"Endwall B",frame:new Ji({length:e.span,shape:t(()=>{switch(e.roofType()){case"Gable":return{type:"Gable",height:e.height,pitch:e.pitch};case"Skillion":return{type:"Skillion",height:e.height,pitch:e.pitch}}}),nogginHeights:t(()=>{let ue=K(),pe=ce().flatMap(Ne=>{switch(Ne.type){case"Lower Infill":return[Ne.toHeight]}return[]});return[...ue,...pe]}),openings:J,frameMemberItemName:S,frameMemberProperties:b,frameStudItemName:N,frameStudProperties:w,maxStudCentres:p,includeMeshAbove:t(()=>ce().some(ue=>ue.type=="Lower Infill"&&ue.includeMeshAbove)),mkKit:n}),space:t(()=>m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)))}),de}),Ue=t(()=>{switch(e.roofType()){case"Gable":return[new T({length:t(()=>e.length()-2*b().size),itemName:S,hasLabel:()=>!0,shsProperties:b,transform:t(()=>m.create(i.create(b().size,.5*e.span()-.5*b().size,e.height()+.5*e.span()*c()-b().size-.5*b().size*c()),y.identity))})];case"Skillion":return[]}}),Q=t(No(Ce,de=>new T({children:de.frame.components,transform:de.space}))),R=t(()=>{if(!e.includeFloor())return[];let de=[],ue;{let Ye=.5*b().size,pt=e.length()-.5*b().size-Ye,Ct=Math.ceil(pt/3e3),q=pt/Ct,fe=Ct-1;ue=e.span()-2*b().size;for(let re=0;re<fe;++re)de.push(Ye+(re+1)*q);console.log(de)}let pe=[];{let Ye=.5*b().size,pt=e.span()-.5*b().size-Ye,Ct=Math.ceil(pt/600),q=pt/Ct,fe=Ct-1;for(let re=0;re<fe;++re)pe.push(Ye+(re+1)*q)}let Ne=[];for(let Qe of de)Ne.push(new T({itemName:S,shsProperties:b,length:()=>ue,hasLabel:()=>!0,transform:t(()=>m.create(i.create(Qe+.5*b().size,b().size,0),y.fromWU(i.unitZ,i.unitY)))}));let ot=[.5*b().size,...de,e.length()-.5*b().size];for(let Qe=0;Qe<ot.length-1;++Qe){let Ye=ot[Qe]+.5*b().size,pt=ot[Qe+1]-.5*b().size-Ye;for(let Ct of pe)Ne.push(new T({itemName:S,shsProperties:b,length:()=>pt,hasLabel:()=>!0,transform:t(()=>m.create(i.create(Ye,Ct-.5*b().size,0),y.fromWU(i.unitZ,i.unitX)))}))}return Ne}),V=t(()=>{if(!e.includeFloor())return[];let de=.5*P().webSize,pe=e.length()-.5*P().webSize-de,Ne=Math.ceil(pe/P().webSize),ot=[];for(let Qe=0;Qe<Ne;++Qe){let Ye=de+Qe*P().webSize;ot.push(new T({itemName:g,layers:()=>[ve.Cladding],length:e.span,timberProperties:P,transform:t(()=>m.create(i.create(Ye+.5*P().webSize,0,b().size),y.fromWU(i.unitZ,i.unitY)))}))}return ot}),L=t(()=>{if(!e.includeSkis())return[];let de=()=>5,ue=t(()=>"Flat 100x"+de().toFixed(0)),pe=()=>30,Ne=()=>50,ot=t(()=>e.span()+2*pe()+2*Ne()),Qe;return e.openBays().some(Ye=>Ye.location.head()=="Sidewall A"&&Ye.location.tail()==null)?Qe="Sidewall A":Qe="Sidewall B",[n({id:"Left Ski",kitType:Kr,state:{baseLength:ot,kickLength:()=>200,kickAngle:()=>30,flatItemName:ue},space:t(()=>m.create(i.create(-pe(),e.span()+pe()+Ne(),-de()),y.fromWU(i.unitZ,i.negUnitY)))}),n({id:"Right Ski",kitType:Kr,state:{baseLength:ot,kickLength:()=>200,kickAngle:()=>30,flatItemName:ue},space:t(()=>m.create(i.create(e.length()+pe(),-pe()-Ne(),-de()),y.fromWU(i.unitZ,i.unitY)))}),n({id:"Toe Point",kitType:wd,state:{stemLength:()=>30,diameter:()=>50,thickness:()=>12},space:t(()=>Qe=="Sidewall A"?m.create(i.create(.5*e.length(),0,.5*b().size),y.fromWU(i.unitZ,i.negUnitY)):m.create(i.create(.5*e.length(),e.span(),.5*b().size),y.fromWU(i.unitZ,i.unitY)))}),n({id:"Toe Brace",kitType:Oe,state:{itemName:S,length:t(()=>e.span()-2*b().size),hasLabel:()=>!0},space:t(()=>m.create(i.create(.5*e.length()-.5*b().size,e.span()-b().size,0),y.fromWU(i.unitZ,i.negUnitY)))})]}),ne=t(()=>e.includeGutter()?[{gutter:new jt({length:e.length,colour:e.roofSheetingColour}),space:m.create(i.create(0,0,e.height()),y.fromWU(i.unitZ,i.unitX))},...e.roofType()=="Gable"?[{gutter:new jt({length:e.length,colour:e.roofSheetingColour}),space:m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.unitZ,i.negUnitX))}]:[]]:[]),he=t(()=>ne().flatMap(({gutter:de,space:ue})=>new T({children:de.components,transform:()=>ue}))),le=t(()=>e.includeVermanFlashing()?[n({id:"Sidewall A Verman Flashing",kitType:en,state:{length:e.length,dim1:()=>b().size,dim2:()=>b().size+2,dim3:()=>35},space:t(()=>m.create(i.create(e.length(),0,b().size+.5),y.fromWU(i.unitZ,i.negUnitX)))}),n({id:"Sidewall B Verman Flashing",kitType:en,state:{length:e.length,dim1:()=>b().size,dim2:()=>b().size+2,dim3:()=>35},space:t(()=>m.create(i.create(0,e.span(),b().size+.5),y.fromWU(i.unitZ,i.unitX)))}),n({id:"Endwall A Verman Flashing",kitType:en,state:{length:e.span,dim1:()=>b().size,dim2:()=>b().size+2,dim3:()=>35},space:t(()=>m.create(i.create(0,0,b().size+.5),y.fromWU(i.unitZ,i.unitY)))}),n({id:"Endwall B Verman Flashing",kitType:en,state:{length:e.span,dim1:()=>b().size,dim2:()=>b().size+2,dim3:()=>35},space:t(()=>m.create(i.create(e.length(),e.span(),b().size+.5),y.fromWU(i.unitZ,i.negUnitY)))})]:[]),me=t(()=>[{wallId:"Sidewall A",openings:v()},{wallId:"Sidewall B",openings:k()},{wallId:"Endwall A",openings:z()},{wallId:"Endwall B",openings:x()}].flatMap(({wallId:de,openings:ue})=>{let pe=I(de);if(pe==null)return[];let Ne=pe;return ue.flatMap(ot=>{let Qe=O(de,ot.location,ot);if(Qe==null)return[];let Ye=Qe;return[{id:ot.id,space:Ne.fromThisSpace(m.create(i.create(Ye.x,0,Ye.y),y.identity)),opening:ot}]})})),ye=t(()=>me().map(({id:de,space:ue,opening:pe})=>{if(pe.type=="Barn PA Door")return new T({children:new vl({height:()=>pe.height,width:()=>pe.width,frameTimberItemName:()=>"100x40",frameTimberProperties:t(()=>new et({webSize:100,flangeSize:40})),frameBraceTimberItemName:()=>"60x40",frameBraceTimberProperties:t(()=>new et({webSize:60,flangeSize:40}))}).components,transform:()=>ue});if(pe.type=="X Brace Barn Door")return new T({children:new cn({height:()=>pe.height,width:()=>pe.width,frameTimberItemName:()=>"100x40",frameTimberProperties:t(()=>new et({webSize:100,flangeSize:40})),frameBraceTimberItemName:()=>"60x40",frameBraceTimberProperties:t(()=>new et({webSize:60,flangeSize:40}))}).components,transform:()=>ue});if(pe.type=="Double X Brace Barn Door"){let Ne=new cn({height:()=>pe.height,width:t(()=>.5*pe.width),frameTimberItemName:()=>"100x40",frameTimberProperties:t(()=>new et({webSize:100,flangeSize:40})),frameBraceTimberItemName:()=>"60x40",frameBraceTimberProperties:t(()=>new et({webSize:60,flangeSize:40}))});return new T({children:t(()=>[new T({children:Ne.components}),new T({children:Ne.components,transform:t(()=>m.create(i.create(.5*pe.width,0,0),y.identity))})]),transform:()=>ue})}else{if(pe.type=="Fake X Brace Barn Window")return new T({children:new cn({height:()=>pe.height,width:()=>pe.width,frameTimberItemName:()=>"100x40",frameTimberProperties:t(()=>new et({webSize:100,flangeSize:40})),frameBraceTimberItemName:()=>"60x40",frameBraceTimberProperties:t(()=>new et({webSize:60,flangeSize:40}))}).components,transform:()=>ue.fromThisSpace(m.create(i.create(0,-b().size,0),y.identity))});if(pe.type=="Double PA Door"){let Ne=new Td({height:()=>pe.height,width:()=>pe.width,colour:e.wallSheetingColour});return new T({children:Ne.components,transform:()=>ue})}else return new T({layers:t(()=>[ve.Cladding]),openingProperties:t(()=>new Si({type:pe.type,modelName:"",width:pe.width,height:pe.height})),colour:e.wallSheetingColour,transform:()=>ue})}})),W=t(()=>[e.length()]),D=t(()=>[...W()].reverse()),H=t(()=>[e.span()]),X=t(()=>[e.span()]),Z=t(()=>{let de=[];de.push(0);let ue=W(),pe=0;for(let Ne=0;Ne<ue.length-1;++Ne)pe+=ue[Ne],de.push(pe);return de.push(e.length()),de}),U=t(()=>{let de=[];de.push(0);let ue=H(),pe=0;for(let Ne=0;Ne<ue.length-1;++Ne)pe+=ue[Ne],de.push(pe);return de.push(e.span()),de}),B=t(()=>{let de=[];de.push(0);let ue=X(),pe=0;for(let Ne=0;Ne<ue.length-1;++Ne)pe+=ue[Ne],de.push(pe);return de.push(e.span()),de}),j=(de,ue,pe)=>t(()=>{let Ne=ue(),ot=de(),Qe=pe();return ot.map((Ye,Mt)=>{let pt;Qe?pt=ot.length-1-Mt:pt=Mt;let Ct=pt.toString(),q=Ne.find(fe=>{if(fe.location.head()!="Bay")return!1;let re=fe.location.tail();return re==null?!1:re.head()==Ct});if(q==null)return{baySize:Ye,sheetedStyle:{type:"Fully Sheeted"}};switch(q.type){case"Fully Open":return{baySize:Ye,sheetedStyle:{type:"Fully Open"}};case"Upper Infill":return{baySize:Ye,sheetedStyle:{type:"Upper Infill",fromHeight:q.fromHeight}};case"Lower Infill":return{baySize:Ye,sheetedStyle:{type:"Lower Infill",toHeight:q.toHeight}};case"Skirted":return{baySize:Ye,sheetedStyle:{type:"Skirted",fromHeight:q.fromHeight,toHeight:q.toHeight}}}})}),oe=j(W,_,()=>!1),ie=j(D,Y,()=>!0),ae=j(H,ee,()=>!0),be=j(X,ce,()=>!1),we=t(()=>[...e.openSidewallA()?[]:[{location:()=>"Sidewall A",sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())]),bays:oe,openings:F,colour:e.wallSheetingColour,sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.zero,y.identity))}],{location:()=>"Sidewall B",sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>{switch(e.roofType()){case"Gable":return[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())];case"Skillion":return[f.create(0,0),f.create(e.length(),0),f.create(e.length(),u()),f.create(0,u())]}}),bays:ie,openings:$,colour:e.wallSheetingColour,sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))},{location:()=>"Endwall A",sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>{switch(e.roofType()){case"Gable":return[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),u()),f.create(0,e.height())];case"Skillion":return[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(0,u())]}}),bays:ae,openings:G,colour:e.wallSheetingColour,sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))},{location:()=>"Endwall B",sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>{switch(e.roofType()){case"Gable":return[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),u()),f.create(0,e.height())];case"Skillion":return[f.create(0,0),f.create(e.span(),0),f.create(e.span(),u()),f.create(0,e.height())]}}),bays:be,openings:()=>[],colour:e.wallSheetingColour,sheetingType:()=>"Corrugated 0.42",sheetingDirection:()=>"Vertical",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)))}]),ke=t(()=>we().map(({location:de,sheeting:ue,space:pe})=>new T({usage:de,children:ue.components,transform:pe}))),Ve=t(()=>{switch(e.roofType()){case"Gable":{let de=new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-tn),f.create(e.length(),-tn),f.create(e.length(),.5*e.span()/h()),f.create(0,.5*e.span()/h())]),openings:()=>[],colour:e.roofSheetingColour,previewOpening:()=>{}});return[{sheeting:de,space:t(()=>m.create(i.create(0,0,e.height()),y.fromWU(i.create(0,h(),d()),i.unitX)))},{sheeting:de,space:t(()=>m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.create(0,-h(),d()),i.negUnitX)))}]}case"Skillion":return[{sheeting:new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-tn),f.create(e.length(),-tn),f.create(e.length(),e.span()/h()),f.create(0,e.span()/h())]),openings:()=>[],colour:e.roofSheetingColour,previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,0,e.height()),y.fromWU(i.create(0,h(),d()),i.unitX)))}]}}),Se=t(()=>Ve().map(({sheeting:de,space:ue})=>new T({usage:()=>"Roof Sheeting",children:de.components,transform:ue}))),Le=t(()=>{let de="Flashing - Corner 50 x 50 CB";return[new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,-30,0),y.fromUV(i.unitZ,i.unitX)),length:()=>e.height(),flashingProfile:()=>ut,colour:e.wallSheetingColour}),new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,-30,0),y.fromUV(i.unitZ,i.unitY)),length:()=>e.height(),flashingProfile:()=>ut,colour:e.wallSheetingColour}),new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitX)),length:t(()=>{switch(e.roofType()){case"Gable":return e.height();case"Skillion":return u()}}),flashingProfile:()=>ut,colour:e.wallSheetingColour}),new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitY)),length:t(()=>{switch(e.roofType()){case"Gable":return e.height();case"Skillion":return u()}}),flashingProfile:()=>ut,colour:e.wallSheetingColour})]}),Xe=t(()=>{switch(e.roofType()){case"Gable":{let de="Flashing - Barge Corrugated CB";return[new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,0-Ut*h(),e.height()+30/h()-Ut*d()),y.fromUV(i.create(0,h(),d()),i.negUnitX)),length:()=>.5*e.span()/h()+Ut,flashingProfile:()=>tt,colour:e.roofSheetingColour}),new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,.5*e.span(),e.height()+.5*e.span()*c()+30/h()),y.fromUV(i.create(0,h(),-d()),i.negUnitX)),length:()=>.5*e.span()/h()+Ut,flashingProfile:()=>tt,colour:e.roofSheetingColour}),new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,e.span()+Ut*h(),e.height()+30/h()-Ut*d()),y.fromUV(i.create(0,-h(),d()),i.unitX)),length:()=>.5*e.span()/h()+Ut,flashingProfile:()=>tt,colour:e.roofSheetingColour}),new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,.5*e.span(),e.height()+.5*e.span()*c()+30/h()),y.fromUV(i.create(0,-h(),-d()),i.unitX)),length:()=>.5*e.span()/h()+Ut,flashingProfile:()=>tt,colour:e.roofSheetingColour})]}case"Skillion":{let de="Flashing - Barge Corrugated CB",ue="Flashing - Barge Corrugated CB High Side";return[new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,0-(Ut-30)*h(),e.height()+30/h()-(Ut-30)*d()),y.fromUV(i.create(0,h(),d()),i.negUnitX)),length:()=>e.span()/h()+Ut,flashingProfile:()=>tt,colour:e.roofSheetingColour}),new T({itemName:()=>de,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,e.span()+30*h(),e.height()+e.span()*c()+30/h()-30*d()),y.fromUV(i.create(0,-h(),-d()),i.unitX)),length:()=>e.span()/h()+Ut,flashingProfile:()=>tt,colour:e.roofSheetingColour}),new T({itemName:()=>ue,layers:()=>[ve.Cladding],transform:t(()=>m.create(i.create(-30,e.span()+30,e.height()+e.span()*c()+30/h()),y.fromWU(i.unitZ,i.unitX))),length:t(()=>e.length()+60),flashingProfile:()=>tt,colour:e.roofSheetingColour})]}}}),Ke=t(()=>{switch(e.roofType()){case"Gable":return[new T({itemName:()=>"Roll Top Ridge 0.55 Colorbond",layers:()=>[ve.Cladding],transform:()=>m.create(i.create(0,.5*e.span(),e.height()+.5*e.span()*c()+30/h()),y.identity),length:()=>e.length(),flashingProfile:()=>bn({pitch:e.pitch()}),colour:e.roofSheetingColour})];case"Skillion":return[]}}),Nt=t(()=>{if(!!e.hasWeatherVane())return new T({children:new _l({attachToPitch:e.pitch,baseSize:()=>300,baseHeight:()=>300,basePitch:()=>25,font:e.font}).components,transform:t(()=>m.create(i.create(.5*e.length(),.5*e.span(),e.height()+.5*e.span()*c()),y.identity))})}),fi=t(()=>{let de=[],ue=800;return e.hasFakeRoofWindowOnSidewallA()&&de.push(new T({children:new Dn({span:()=>ue,pitch:e.pitch}).components,transform:t(()=>m.create(i.create(.5*e.length(),.25*e.span()-.25*ue,e.height()+(.25*e.span()-.25*ue)*c()),y.identity))})),e.hasFakeRoofWindowOnSidewallB()&&de.push(new T({children:new Dn({span:()=>ue,pitch:e.pitch}).components,transform:t(()=>m.create(i.create(.5*e.length(),.75*e.span()+.25*ue,e.height()+(.25*e.span()-.25*ue)*c()),y.fromWU(i.unitZ,i.negUnitX)))})),de});this.kits=t(()=>[...L(),...le()].flatMap(de=>Pe(de())));let qt=mn(this.kits);this.components=t(()=>[...qt(),...Q(),...R(),...V(),...Ue(),...he(),...ye(),...ke(),...Se(),...Le(),...Xe(),...Ke(),...Pe(Nt()),...fi()]),this.memberScheduleComponents=t(()=>[...Ce().flatMap(({frame:de})=>de.components()),...Ue(),...R(),...qt().flatMap(de=>de.children!=null?de.children().filter(ue=>ue.hasLabel?.call(ue)??!1):[])]),this.allocateLabels=de=>{for(let ue of Ce()){de.genPrefixedLabelForKey({prefix:"W",key:ue.side+" Wall Frame"});for(let pe of ue.frame.components())pe.hasLabel==null||!pe.hasLabel()||de.genLabelForComponent(pe)}de.genPrefixedLabelForKey({prefix:"F",key:"Floor Frame"});for(let ue of Ue())de.genLabelForComponent(ue);for(let ue of R())de.genLabelForComponent(ue);for(let ue of qt())if(ue.children!=null)for(let pe of ue.children())(pe.hasLabel?.call(pe)??!1)&&de.genLabelForComponent(pe)},this.insertOpeningWalls=t(()=>{let de={location:We.fromArray(["Sidewall A"]),space:m.create(i.zero,y.identity),outline:[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())],bays:[{size:e.length(),minLeftDist:300,minRightDist:300}],reverseBayIndices:!1},ue={location:We.fromArray(["Sidewall B"]),space:m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)),outline:[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())],bays:[{size:e.length(),minLeftDist:300,minRightDist:300}],reverseBayIndices:!0},pe={location:We.fromArray(["Endwall A"]),space:m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)),outline:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),e.height()+.5*e.span()*c()),f.create(0,e.height())],bays:[{size:e.span(),minLeftDist:300,minRightDist:300}],reverseBayIndices:!0},Ne={location:We.fromArray(["Endwall B"]),space:m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)),outline:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),e.height()+.5*e.span()*c()),f.create(0,e.height())],bays:[{size:e.span(),minLeftDist:300,minRightDist:300}],reverseBayIndices:!0};return[de,ue,pe,Ne]}),this.mkFramesForDoc=de=>t(()=>[...Ce().map(({side:ue,frame:pe})=>t(()=>({...pe.mkFrameForDoc(de)(),frameLabel:de.lookupLabelForKey(ue+" Wall Frame")??""}))),...e.includeFloor()?[t(()=>{let ue=m.create(i.zero,y.fromUV(i.unitX,i.negUnitZ));return{frameLabel:de.lookupLabelForKey("Floor Frame")??"",components:R().map(pe=>new T({...pe,transform:t(()=>ue.fromThisSpace(pe.transform?.call(void 0)??m.identity))})),dimensionStrings:[]}})]:[]]),this.openingSelectables=t(()=>me().flatMap(({id:de,space:ue,opening:pe})=>({id:de,space:ue,localAabb:new Vt({minX:0,maxX:pe.width,minY:-200,maxY:200,minZ:0,maxZ:pe.height})})));let Jt=t(()=>m.create(i.zero,y.identity)),ei=t(()=>m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX))),Bi=t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY))),wn=t(()=>m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)));this.baySelectables=t(()=>{let de=[],ue=Z(),pe=U(),Ne=B(),ot=Jt(),Qe=ei(),Ye=Bi(),Mt=wn(),pt=F(),Ct=$(),q=G(),fe=J();for(let re=0;re<ue.length-1;++re){let ge=ue[re],ze=ue[re+1];{let Ie=new Vt({minX:ge,maxX:ze,minY:-100,maxY:100,minZ:0,maxZ:e.height()}),Ge={id:"SidewallA.Bay["+re.toString()+"]",space:ot,localAabb:Ie,rayCollisionTime:st=>{let ct=st,at=Ie.rayCollisionTime(ct);if(at==null)return;let He=ct.positionFromTime(at);for(let Ee of pt)if(He.x>=Ee.pos.x&&He.y>=Ee.pos.y&&He.x<Ee.pos.x+Ee.width&&He.y<Ee.pos.y+Ee.height)return;return at}};de.push(Ge)}{let Ie=new Vt({minX:e.length()-ze,maxX:e.length()-ge,minY:-100,maxY:100,minZ:0,maxZ:e.roofType()=="Gable"?e.height():u()}),Ge={id:"SidewallB.Bay["+re.toString()+"]",space:Qe,localAabb:Ie,rayCollisionTime:st=>{let ct=st,at=Ie.rayCollisionTime(ct);if(at==null)return;let He=ct.positionFromTime(at);for(let Ee of Ct)if(He.x>=Ee.pos.x&&He.y>=Ee.pos.y&&He.x<Ee.pos.x+Ee.width&&He.y<Ee.pos.y+Ee.height)return;return at}};de.push(Ge)}}for(let re=0;re<pe.length-1;++re){let ge=pe[re],ze=pe[re+1],Ie=new Vt({minX:ge,maxX:ze,minY:-100,maxY:100,minZ:0,maxZ:u()}),Ge={id:"EndwallA.Bay["+(pe.length-2-re).toString()+"]",space:Ye,localAabb:Ie,rayCollisionTime:st=>{let ct=st,at=Ie.rayCollisionTime(ct);if(at==null)return;let He=ct.positionFromTime(at);for(let Ee of q)if(He.x>=Ee.pos.x&&He.y>=Ee.pos.y&&He.x<Ee.pos.x+Ee.width&&He.y<Ee.pos.y+Ee.height)return;return at}};de.push(Ge)}for(let re=0;re<Ne.length-1;++re){let ge=Ne[re],ze=Ne[re+1],Ie=new Vt({minX:ge,maxX:ze,minY:-100,maxY:100,minZ:0,maxZ:u()}),Ge={id:"EndwallB.Bay["+re.toString()+"]",space:Mt,localAabb:Ie,rayCollisionTime:st=>{let ct=st,at=Ie.rayCollisionTime(ct);if(at==null)return;let He=ct.positionFromTime(at);for(let Ee of fe)if(He.x>=Ee.pos.x&&He.y>=Ee.pos.y&&He.x<Ee.pos.x+Ee.width&&He.y<Ee.pos.y+Ee.height)return;return at}};de.push(Ge)}return de})}}const fr={type:"Object",properties:{location:{displayName:"Location",typeSchema:bi,defaultValue:We.nil()},id:{displayName:"Id",typeSchema:{type:"String"},defaultValue:""},type:{displayName:"Type",typeSchema:Ns,defaultValue:"PA Door"},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2010},width:{displayName:"Width",typeSchema:{type:"Number"},defaultValue:820},headHeight:{displayName:"Head Height",typeSchema:{type:"Number"},defaultValue:2010},posX:{displayName:"Pos X",typeSchema:{type:"Union",parts:{Centre:{},Left:{dist:{displayName:"Dist",typeSchema:{type:"Number"},defaultValue:0}},Right:{dist:{displayName:"Dist",typeSchema:{type:"Number"},defaultValue:0}}}},defaultValue:{type:"Centre"}},barnPADoorProperties:{displayName:"Barn PA Door Properties",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Object",properties:{frameTimberWebSize:{displayName:"Frame Timber Web Size",typeSchema:{type:"Number"},defaultValue:100},frameTimberFlangeSize:{displayName:"Frame Timber Flange Size",typeSchema:{type:"Number"},defaultValue:50},frameTimberItemName:{displayName:"Frame Timber Item Name",typeSchema:{type:"String"},defaultValue:"100x50 Timber"},frameBraceTimberWebSize:{displayName:"Frame Brace Timber Web Size",typeSchema:{type:"Number"},defaultValue:100},frameBraceTimberFlangeSize:{displayName:"Frame Brace Timber Flange Size",typeSchema:{type:"Number"},defaultValue:50},frameBraceTimberItemName:{displayName:"Frame Brace Timber Item Name",typeSchema:{type:"String"},defaultValue:"100x50 Timber"}}}},defaultValue:void 0,optional:!0},frameOptions:{displayName:"Frame Options",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Object",properties:{studType:{displayName:"Stud Type",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Union",parts:{"Single Stud":{},"Boxed Stud":{},"Triple Stud":{},Cee:{itemName:{displayName:"Item Name",typeSchema:{type:"String"},defaultValue:""}}}}},optional:!0,defaultValue:{type:"Single Stud"}},headType:{displayName:"Head Type",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Union",parts:{"Single Plate":{},"Trussed Header":{},Cee:{itemName:{displayName:"Item Name",typeSchema:{type:"String"},defaultValue:""}}}}},optional:!0,defaultValue:{type:"Single Plate"}}}}},optional:!0,defaultValue:void 0}}};class Vi{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=()=>0,a=t(()=>e.height()+(e.girtHeight()+e.columnProperties().webSize)*l()-e.basePlateThickness()-s()),h=t(()=>{switch(e.roofType()){case"Gable":return a();case"Skillion":return e.height()+(e.span()-e.girtHeight()-e.columnProperties().webSize)*l()-e.basePlateThickness()-s()}}),d=t(()=>{switch(e.roofType()){case"Gable":return(.5*e.span()-e.girtHeight()-e.columnProperties().webSize-2*e.rafterPlateThickness())/r()+e.columnProperties().webSize*l();case"Skillion":return(e.span()-2*(e.girtHeight()+e.columnProperties().webSize+e.rafterPlateThickness()))/r()+e.columnProperties().webSize*l()}}),c=t(()=>e.backToBack()?4:2),u=t(()=>e.columnItemName().startsWith("C300")||e.columnItemName().startsWith("C350")?3:2),S=t(()=>c()*u()),b=t(()=>[new T({itemName:()=>"M16 Chemset Studbolt",description:()=>"Column Tie Down",usage:()=>"Columns",qty:S}),new T({itemName:()=>"M16 Glass Capsule",description:()=>"Column Tie Down",usage:()=>"Columns",qty:S})]),N=t(()=>e.rafterProperties().webSize/r()+100),w=t(()=>e.rafterProperties().flangeSize),p=t(()=>e.columnProperties().webSize-e.rafterPlateThickness()),g=t(()=>e.columnProperties().webSize),P=t(()=>e.columnProperties().flangeSize),M=A=>new T({itemName:e.columnItemName,length:()=>A.side()=="Side1"?a():h(),ceeProperties:e.columnProperties,backBackCutAngle:t(()=>(A.side()=="Side1"?-e.pitch():e.pitch())*(A.flip()?-1:1)),transform:t(()=>A.flip()?A.transform().fromThisSpace(m.create(i.create(0,e.columnProperties().webSize,e.columnProperties().flangeSize),y.fromUV(i.unitX,i.negUnitY))):A.transform()),children:t(()=>[new T({itemName:()=>"Flat",length:()=>e.rafterProperties().webSize,flatProperties:t(()=>new vt({width:w(),thickness:e.basePlateThickness()})),holes2d:t(()=>[f.create(.5*g()-.5*e.columnProperties().webHoleDistApart,.5*P()),f.create(.5*g()+.5*e.columnProperties().webHoleDistApart,.5*P())]),transform:t(()=>m.create(i.create(-e.basePlateThickness(),0,0),y.fromUV(i.unitY,i.unitZ)))}),new T({itemName:()=>"Flat",length:N,flatProperties:t(()=>new vt({width:w(),thickness:e.rafterPlateThickness()})),holes2d:t(()=>[f.create(25,.5*e.rafterProperties().flangeSize),f.create(N()-25,.5*e.rafterProperties().flangeSize)]),transform:t(()=>m.create(i.create(-N()-e.basePlateThickness()+e.height()+(e.girtHeight()+e.rafterProperties().webSize)*l()-e.purlinHeight()/r()+50,A.side()=="Side1"!=A.flip()?e.rafterProperties().webSize:e.rafterPlateThickness(),0),y.fromUV(i.unitX,i.unitZ)))}),new T({itemName:()=>"Flat",length:p,flatProperties:t(()=>new vt({width:w(),thickness:e.rafterPlateThickness()})),transform:t(()=>m.create(i.create(-N()-e.basePlateThickness()+e.height()+(e.girtHeight()+e.rafterProperties().webSize)*l()-e.purlinHeight()/r()+50+50,A.side()=="Side1"!=A.flip()?0:e.rafterPlateThickness(),0),y.fromUV(i.unitY,i.unitZ)))}),new T({itemName:()=>"Flat",length:p,flatProperties:t(()=>new vt({width:w(),thickness:e.rafterPlateThickness()})),transform:t(()=>m.create(i.create(-e.basePlateThickness()+e.height()+(e.girtHeight()+e.rafterProperties().webSize)*l()-e.purlinHeight()/r()+50-e.rafterPlateThickness()-50,A.side()=="Side1"!=A.flip()?0:e.rafterPlateThickness(),0),y.fromUV(i.unitY,i.unitZ)))})])}),v=t(()=>[M({side:()=>"Side1",flip:t(()=>!e.backToBack()&&e.flipped()),transform:t(()=>m.create(i.create(e.girtHeight(),e.backToBack()?.5*e.columnProperties().flangeSize:0,e.basePlateThickness()),y.fromWU(i.unitY,i.unitZ)))}),...e.backToBack()?[M({side:()=>"Side1",flip:()=>!0,transform:t(()=>m.create(i.create(e.girtHeight(),-.5*e.columnProperties().flangeSize,e.basePlateThickness()),y.fromWU(i.unitY,i.unitZ)))})]:[],M({side:()=>"Side2",flip:t(()=>!e.backToBack()&&e.flipped()),transform:t(()=>m.create(i.create(e.span()-e.girtHeight()-e.columnProperties().webSize,e.backToBack()?.5*e.columnProperties().flangeSize:0,e.basePlateThickness()),y.fromWU(i.unitY,i.unitZ)))}),...e.backToBack()?[M({side:()=>"Side2",flip:()=>!0,transform:t(()=>m.create(i.create(e.span()-e.girtHeight()-e.columnProperties().webSize,-.5*e.columnProperties().flangeSize,e.basePlateThickness()),y.fromWU(i.unitY,i.unitZ)))})]:[]]),k=A=>new T({itemName:e.rafterItemName,length:d,ceeProperties:e.columnProperties,frontBackCutAngle:A.side()=="Side1"!=A.flip()?t(()=>-e.pitch()):e.pitch,backBackCutAngle:A.side()=="Side1"!=A.flip()?e.pitch:t(()=>-e.pitch()),transform:t(()=>{let I=A.side()=="Side1"?m.create(i.create(e.girtHeight()+e.columnProperties().webSize+e.rafterPlateThickness()-e.rafterProperties().webSize*o(),A.offsetY(),e.height()+(e.girtHeight()+e.columnProperties().webSize-e.rafterProperties().webSize*o())*l()-e.purlinHeight()/r()),y.fromWU(i.unitY,i.create(r(),0,o()))):m.create(i.create(e.span()-(e.girtHeight()+e.columnProperties().webSize+e.rafterPlateThickness()),A.offsetY(),e.height()-(e.rafterProperties().webSize+e.purlinHeight())/r()+(e.girtHeight()+e.columnProperties().webSize)*l()),y.fromWU(i.unitY,i.create(-r(),0,o())));return A.flip()?I.fromThisSpace(m.create(i.create(0,e.columnProperties().webSize,e.columnProperties().flangeSize),y.fromUV(i.unitX,i.negUnitY))):I}),children:t(()=>[new T({itemName:()=>"Flat",length:N,flatProperties:t(()=>new vt({width:w(),thickness:e.rafterPlateThickness()})),holes2d:t(()=>[f.create(25,.5*e.rafterProperties().flangeSize),f.create(N()-25,.5*e.rafterProperties().flangeSize)]),transform:t(()=>A.side()=="Side1"!=A.flip()?m.create(i.create(e.rafterProperties().webSize*l()-e.rafterPlateThickness()*r()+50*o(),-e.rafterPlateThickness()*o()-50*r(),0),y.fromUV(i.create(-o(),r(),0),i.unitZ)):m.create(i.create(-e.basePlateThickness()-50*o(),e.basePlateThickness()*l()-50*r(),0),y.fromUV(i.create(o(),r(),0),i.unitZ)))}),new T({itemName:()=>"Flat",length:N,flatProperties:t(()=>new vt({width:w(),thickness:e.rafterPlateThickness()})),holes2d:t(()=>[f.create(25,.5*e.rafterProperties().flangeSize),f.create(N()-25,.5*e.rafterProperties().flangeSize)]),transform:t(()=>A.side()=="Side1"!=A.flip()?m.create(i.create(d()+50*o(),-50*r(),0),y.fromUV(i.create(-o(),r(),0),i.unitZ)):m.create(i.create(d()-e.rafterProperties().webSize*l()-50*o(),-50*r(),0),y.fromUV(i.create(o(),r(),0),i.unitZ)))})])}),z=t(()=>[k({side:()=>"Side1",offsetY:()=>e.backToBack()?.5*e.columnProperties().flangeSize:0,flip:t(()=>!e.backToBack()&&e.flipped())}),...e.backToBack()?[k({side:()=>"Side1",offsetY:()=>-.5*e.columnProperties().flangeSize,flip:()=>!0})]:[],...e.roofType()=="Gable"?[k({side:()=>"Side2",offsetY:()=>e.backToBack()?.5*e.columnProperties().flangeSize:0,flip:t(()=>!e.backToBack()&&e.flipped())}),...e.backToBack()?[k({side:()=>"Side2",offsetY:()=>-.5*e.columnProperties().flangeSize,flip:()=>!0})]:[]]:[]]),x=t(()=>{if(e.baySizes().length<2)return[];let A=[],I=0;for(let O=0;O<e.baySizes().length-1;++O){I+=e.baySizes()[O];let E;{let G=I-.5*e.mullionProperties().flangeSize,J=I+.5*e.mullionProperties().flangeSize;E=e.height()+Math.min(Math.min(G,e.span()-G),Math.min(J,e.span()-J))*l()-e.purlinHeight()/r()}let F=E,$=I;A.push(new T({itemName:e.mullionItemName,length:()=>F,usage:()=>"Mullion",ceeProperties:e.mullionProperties,transform:()=>m.create(i.create($-.5*e.mullionProperties().flangeSize,e.mullionProperties().webSize,0),y.fromWU(i.unitX,i.unitZ))}))}return A});this.components=t(()=>[...b(),...v(),...z(),...x()])}}let zd="Not Found",jr=yt.C20024,fn={type:"TopHat",properties:Ai["64TH100"]},Ze=C=>C??zd,Bn=C=>C==null?jr:yt[C]??jr,Qr=C=>C==null?fn:C.match(/TH[0-9]+/)?{type:"TopHat",properties:Ai[C]}:C.match(/Z[0-9]+/)?{type:"Zed",properties:sn[C]}:fn;const Yl={type:"Union",parts:{"Fully Open":{location:{displayName:"Location",typeSchema:bi,defaultValue:We.nil()}},"Upper Infill":{location:{displayName:"Location",typeSchema:bi,defaultValue:We.nil()},fromHeight:{displayName:"From Height",typeSchema:{type:"Number"},defaultValue:0}},"Lower Infill":{location:{displayName:"Location",typeSchema:bi,defaultValue:We.nil()},toHeight:{displayName:"To Height",typeSchema:{type:"Number"},defaultValue:0},includeMeshAbove:{displayName:"Include Mesh Above",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0}},Skirted:{location:{displayName:"Location",typeSchema:bi,defaultValue:We.nil()},fromHeight:{displayName:"From Height",typeSchema:{type:"Number"},defaultValue:0},toHeight:{displayName:"To Height",typeSchema:{type:"Number"},defaultValue:0}}}},Ad={type:"Object",properties:{location:{displayName:"Location",typeSchema:bi,defaultValue:We.nil()},id:{displayName:"Id",typeSchema:{type:"String"},defaultValue:""},flipped:{displayName:"Flipped",typeSchema:{type:"Boolean"},defaultValue:!1}}},nn=50,oi=200;class xd{constructor(e){let n=t(()=>Math.cos(e.pitch()*Math.PI/180)),r=t(()=>Math.sin(e.pitch()*Math.PI/180)),o=t(()=>Math.tan(e.pitch()*Math.PI/180)),l=t(()=>{switch(e.roofType()){case"Gable":return e.height()+.5*e.span()*o();case"Skillion":return e.height()+e.span()*o()}}),s=t(()=>{let q=[],fe=0;for(let re of e.preferredSideBaySizes()){let ge=fe+re;if(ge>=e.length()){let ze=e.length()-fe;q.push(ze),fe+=ze;break}q.push(re),fe=ge}return Math.abs(q[q.length-1])<=.001&&q.splice(q.length-1,1),e.length()-fe>=.001&&(q.length==0?q.push(e.length()):q[q.length-1]+=e.length()-fe),q}),a=t(()=>[...s()].reverse()),h=t(()=>{let q=[],fe=0;for(let re of e.preferredEndABaySizes()){let ge=fe+re;if(ge>=e.length()){let ze=e.length()-fe;q.push(ze),fe+=ze;break}q.push(re),fe=ge}return Math.abs(q[q.length-1])<=.001&&q.splice(q.length-1,1),e.span()-fe>=.001&&(q.length==0?q.push(e.span()):q[q.length-1]+=e.span()-fe),q}),d=t(()=>{let q=[],fe=0;for(let re of e.preferredEndBBaySizes()){let ge=fe+re;if(ge>=e.length()){let ze=e.length()-fe;q.push(ze),fe+=ze;break}q.push(re),fe=ge}return Math.abs(q[q.length-1])<=.001&&q.splice(q.length-1,1),e.span()-fe>=.001&&(q.length==0?q.push(e.span()):q[q.length-1]+=e.span()-fe),q}),c=t(()=>{let q=[];q.push(0);let fe=s(),re=0;for(let ge=0;ge<fe.length-1;++ge)re+=fe[ge],q.push(re);return q.push(e.length()),q}),u=t(()=>{let q=[];q.push(0);let fe=h(),re=0;for(let ge=0;ge<fe.length-1;++ge)re+=fe[ge],q.push(re);return q.push(e.span()),q}),S=t(()=>{let q=[];q.push(0);let fe=d(),re=0;for(let ge=0;ge<fe.length-1;++ge)re+=fe[ge],q.push(re);return q.push(e.span()),q});t(()=>{let q=s(),fe=0;for(let re=0;re<q.length+1;++re){let ge=re==0?0:q[re-1],ze=re==q.length?0:q[re];fe=Math.max(fe,.5*(ge+ze))}return fe});let b=e.frameMemberItemName,N=t(()=>Bn(b())),w=e.frameMemberItemName,p=t(()=>Bn(w())),g=e.frameMemberItemName,P=t(()=>Bn(g())),M=t(()=>e.midFrameBackToBack()?"Double":"Single"),v=e.sideGirtItemName,k=t(()=>Qr(v())),z=e.purlinItemName,x=t(()=>Qr(z())),A="SidewallA",I="SidewallB",O="EndwallA",E="EndwallB",F=q=>t(()=>e.openings().flatMap(fe=>{if(fe.location.head()!=q)return[];{let re=fe.location.tail();return re==null?[]:{...fe,location:re}}})),$=F(A),G=F(I),J=F(O),K=F(E),te=q=>{switch(q){case A:return s();case I:return[...s()].reverse();case O:return h();case E:return d();default:return[]}},_=q=>{switch(q){case A:return m.create(i.zero,y.identity);case I:return m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX));case O:return m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY));case E:return m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY));default:return}},Y=(q,fe,re)=>{let ge=te(q);if(ge==null||fe.head()!="Bay")return;let ze=fe.tail();if(ze==null)return;let Ie=ze.head();if(Ie==null)return;let Ge=Number.parseInt(Ie);if(!Number.isFinite(Ge)||Ge<0||Ge>=ge.length)return;let st;switch(q){case A:st=!1;break;case I:st=!0;break;case O:st=!0;break;case E:st=!1;break;default:st=!1;break}st&&(Ge=ge.length-1-Ge);let ct=0;for(let qe=0;qe<Ge;++qe)ct+=ge[qe];let at=ct+ge[Ge],He;switch(re.posX.type){case"Centre":{He=.5*(ct+at)-.5*re.width;break}case"Left":{He=ct+re.posX.dist;break}case"Right":{He=at-re.posX.dist-re.width;break}}let Ee=re.headHeight-re.height;return f.create(He,Ee)},ee=t(()=>{let q=k();switch(q.type){case"TopHat":return q.properties.height;case"Zed":return q.properties.webSize}}),ce=t(()=>{let q=x();switch(q.type){case"TopHat":return q.properties.height;case"Zed":return q.properties.webSize}}),Ce=t(()=>c().map((q,fe)=>{let re=c(),ge=k(),ze;return fe==0?ze=(ge.type=="TopHat"?ge.properties.height:ge.properties.webSize)+.5*N().flangeSize:fe==re.length-1?ze=e.length()-(ge.type=="TopHat"?ge.properties.height:ge.properties.webSize)-.5*N().flangeSize:ze=q,ze})),Ue,Q,R;Ue=t(()=>{switch(e.constructionType()){case"Welded":return new Vi({height:e.height,span:e.span,pitch:e.pitch,baySizes:h,setDown:()=>0,fallAtColumn1:()=>0,fallAtColumn2:()=>0,roofType:e.roofType,girtHeight:ee,purlinHeight:ce,flipped:()=>!1,backToBack:()=>!1,columnItemName:()=>Ze(b()),rafterItemName:()=>Ze(w()),mullionItemName:()=>Ze(b()),columnProperties:N,rafterProperties:p,mullionProperties:P,basePlateThickness:()=>10,rafterPlateThickness:()=>10,tieDownItemName:()=>"unknown",rafterBoltItemName:()=>"unknown",kneeTieItemName:()=>{},kneeTieProperties:()=>{},collarTieItemName:()=>{},collarTieProperties:()=>{}});case"Componentry":return new $i({span:e.span,height:e.height,pitch:e.pitch,baySizes:t(()=>[]),frameItemName:()=>Ze(b()),frameProperties:N,mullionItemName:()=>Ze(b()),mullionProperties:N,girtHeight:ee,purlinHeight:ce,locationType:()=>"End"})}}),Q=t(()=>{switch(e.constructionType()){case"Welded":return e.roofType()=="Gable"?new Vi({height:e.height,span:e.span,pitch:e.pitch,baySizes:d,setDown:()=>0,fallAtColumn1:()=>0,fallAtColumn2:()=>0,roofType:e.roofType,girtHeight:ee,purlinHeight:ce,flipped:()=>!1,backToBack:()=>!1,columnItemName:()=>Ze(b()),rafterItemName:()=>Ze(w()),mullionItemName:()=>Ze(b()),columnProperties:N,rafterProperties:p,mullionProperties:P,basePlateThickness:()=>10,rafterPlateThickness:()=>10,tieDownItemName:()=>"unknown",rafterBoltItemName:()=>"unknown",kneeTieItemName:()=>{},kneeTieProperties:()=>{},collarTieItemName:()=>{},collarTieProperties:()=>{}}):new Vi({height:e.height,span:e.span,pitch:e.pitch,baySizes:d,setDown:()=>0,fallAtColumn1:()=>0,fallAtColumn2:()=>0,roofType:e.roofType,girtHeight:ee,purlinHeight:ce,flipped:()=>!0,backToBack:()=>!1,columnItemName:()=>Ze(b()),rafterItemName:()=>Ze(w()),mullionItemName:()=>Ze(g()),columnProperties:N,rafterProperties:p,mullionProperties:P,basePlateThickness:()=>10,rafterPlateThickness:()=>10,tieDownItemName:()=>"unknown",rafterBoltItemName:()=>"unknown",kneeTieItemName:()=>{},kneeTieProperties:()=>{},collarTieItemName:()=>{},collarTieProperties:()=>{}});case"Componentry":return new $i({span:e.span,height:e.height,pitch:e.pitch,baySizes:t(()=>[]),frameItemName:()=>Ze(b()),frameProperties:N,mullionItemName:()=>Ze(b()),mullionProperties:N,girtHeight:ee,purlinHeight:ce,locationType:()=>"End"})}}),R=t(()=>{switch(e.constructionType()){case"Welded":if(M()=="Single")switch(e.constructionType()){case"Welded":return new Vi({height:e.height,span:e.span,pitch:e.pitch,baySizes:t(()=>[]),setDown:()=>0,fallAtColumn1:()=>0,fallAtColumn2:()=>0,roofType:e.roofType,girtHeight:ee,purlinHeight:ce,flipped:()=>!1,backToBack:()=>!1,columnItemName:()=>Ze(b()),rafterItemName:()=>Ze(w()),mullionItemName:()=>Ze(b()),columnProperties:N,rafterProperties:p,mullionProperties:P,basePlateThickness:()=>10,rafterPlateThickness:()=>10,tieDownItemName:()=>"unknown",rafterBoltItemName:()=>"unknown",kneeTieItemName:()=>{},kneeTieProperties:()=>{},collarTieItemName:()=>{},collarTieProperties:()=>{}});case"Componentry":return new $i({span:e.span,height:e.height,pitch:e.pitch,baySizes:t(()=>[]),frameItemName:()=>Ze(b()),frameProperties:N,mullionItemName:()=>Ze(b()),mullionProperties:N,girtHeight:ee,purlinHeight:ce,locationType:()=>"End"})}else return new Vi({height:e.height,span:e.span,pitch:e.pitch,baySizes:t(()=>[]),setDown:()=>0,fallAtColumn1:()=>0,fallAtColumn2:()=>0,roofType:e.roofType,girtHeight:ee,purlinHeight:ce,flipped:()=>!1,backToBack:()=>M()=="Double",columnItemName:()=>Ze(b()),rafterItemName:()=>Ze(w()),mullionItemName:()=>Ze(g()),columnProperties:N,rafterProperties:p,mullionProperties:P,basePlateThickness:()=>10,rafterPlateThickness:()=>10,tieDownItemName:()=>"unknown",rafterBoltItemName:()=>"unknown",kneeTieItemName:()=>{},kneeTieProperties:()=>{},collarTieItemName:()=>{},collarTieProperties:()=>{}});case"Componentry":return new $i({span:e.span,height:e.height,pitch:e.pitch,baySizes:t(()=>[]),frameItemName:()=>Ze(b()),frameProperties:N,mullionItemName:()=>Ze(b()),mullionProperties:N,girtHeight:ee,purlinHeight:ce,locationType:()=>"End"})}});let V=t(()=>Ce().map((q,fe)=>{let re=e.roofType()=="Skillion"||e.roofType()=="Gable"&&fe==Ce().length-1,ge;return fe==0?ge=Ue():fe==Ce().length-1?ge=Q():ge=R(),{frame:ge,space:t(()=>re?m.create(i.create(q+.5*N().flangeSize,0,0),y.fromVW(i.negUnitX,i.unitZ)):m.create(i.create(q-.5*N().flangeSize,e.span(),0),y.fromVW(i.unitX,i.unitZ)))}})),L=t(()=>V().map(({frame:q,space:fe})=>new T({children:q.components,transform:fe}))),ne=t(()=>{let q=k();switch(q.type){case"TopHat":return q.properties;default:return fn.properties}}),he=(q,fe)=>fe.flatMap(re=>{let ge=Y(q,re.location,re);return ge==null?[]:[{pos:ge,width:re.width,height:re.height}]}),le=t(()=>he(A,$())),me=t(()=>he(I,G())),ye=t(()=>he(O,J())),W=t(()=>he(E,K())),D=q=>t(()=>e.openBays().flatMap(fe=>{if(fe.location.head()!=q)return[];let re=fe.location.tail();return re==null?[]:[{...fe,location:re}]})),H=D(A),X=D(I),Z=D(O),U=D(E),B=t(()=>{let q=new Yt({purlinItemName:t(()=>Ze(v())),purlinProperties:ne,outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()-ce()/n()),f.create(0,e.height()-ce()/n())]),baySizes:s,openings:le,openBays:H,hasEndClips:()=>!1,maxSpacing:e.sideGirtSpacing}),fe=new Yt({purlinItemName:t(()=>Ze(v())),purlinProperties:ne,outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()-ce()/n()),f.create(0,e.height()-ce()/n())]),baySizes:t(()=>[...s()].reverse()),reverseBayIndices:()=>!0,openings:me,openBays:X,hasEndClips:()=>!1,maxSpacing:e.sideGirtSpacing}),re=N().webSize,ge=ee(),ze,Ie;switch(e.roofType()){case"Gable":{ze=new Yt({purlinItemName:t(()=>Ze(v())),purlinProperties:ne,outline:t(()=>[f.create(ge+re,0),f.create(e.span()-ge-re,0),f.create(e.span()-ge-re,e.height()-(ce()+re)/n()),f.create(.5*e.span(),e.height()+.5*e.span()*o()-(ce()+re)/n()),f.create(ge+re,e.height()-(ce()+re)/n())]),baySizes:h,reverseBayIndices:()=>!0,openings:ye,openBays:Z,hasEndClips:()=>!0,maxSpacing:e.endGirtSpacing}),Ie=new Yt({purlinItemName:t(()=>Ze(v())),purlinProperties:ne,outline:t(()=>[f.create(ge+re,0),f.create(e.span()-ge-re,0),f.create(e.span()-ge-re,e.height()-(ce()+re)/n()),f.create(.5*e.span(),e.height()+.5*e.span()*o()-(ce()+re)/n()),f.create(ge+re,e.height()-(ce()+re)/n())]),baySizes:d,openings:W,openBays:U,hasEndClips:()=>!0,maxSpacing:e.endGirtSpacing});break}case"Skillion":{ze=new Yt({purlinItemName:t(()=>Ze(v())),purlinProperties:ne,outline:t(()=>[f.create(ge+re,0),f.create(e.span()-ge-re,0),f.create(e.span()-ge-re,e.height()-(ce()+re)/n()),f.create(ge+re,l()-(ce()+re)/n())]),baySizes:h,reverseBayIndices:()=>!0,openings:ye,openBays:Z,hasEndClips:()=>!0,maxSpacing:e.endGirtSpacing}),Ie=new Yt({purlinItemName:t(()=>Ze(v())),purlinProperties:ne,outline:t(()=>[f.create(ge+re,0),f.create(e.span()-ge-re,0),f.create(e.span()-ge-re,l()-(ce()+re)/n()),f.create(ge+re,e.height()-(ce()+re)/n())]),baySizes:d,openings:W,openBays:U,hasEndClips:()=>!0,maxSpacing:e.endGirtSpacing});break}}let Ge=[],st=c();for(let ct of e.partitionWalls()){let at=ct.location,He;if(at.head()!="MidFrame"||(He=at.tail(),He==null))continue;let Ee=He.head();if(Ee==null)continue;let qe=Number.parseInt(Ee);if(!Number.isFinite(qe))continue;let $t=qe+1;if($t<0||$t>=st.length)continue;let ii=st[$t];Ge.push({girts:new Yt({purlinItemName:t(()=>Ze(v())),purlinProperties:ne,outline:t(()=>[f.create(ge+re,0),f.create(e.span()-ge-re,0),f.create(e.span()-ge-re,e.height()-(ce()+re)/n()),f.create(ge+re,l()-(ce()+re)/n())]),baySizes:h,reverseBayIndices:()=>!0,openings:ye,openBays:Z,hasEndClips:()=>!0,maxSpacing:e.endGirtSpacing}),space:m.create(i.create(ii+ee(),e.span(),0),y.fromUV(i.negUnitY,i.unitZ)),usage:"Mid Frame "+qe})}return[{girts:q,space:m.create(i.create(0,ee(),0),y.fromUV(i.unitX,i.unitZ)),usage:"Sidewall A"},{girts:fe,space:m.create(i.create(e.length(),e.span()-ee(),0),y.fromUV(i.negUnitX,i.unitZ)),usage:"Sidewall B"},{girts:ze,space:m.create(i.create(ee(),e.span(),0),y.fromUV(i.negUnitY,i.unitZ)),usage:"Endwall A"},{girts:Ie,space:m.create(i.create(e.length()-ee(),0,0),y.fromUV(i.unitY,i.unitZ)),usage:"Endwall B"},...Ge]}),j=t(()=>B().map(({girts:q,space:fe,usage:re})=>new T({usage:()=>re,children:q.components,transform:()=>fe}))),oe=t(()=>{let q=x();switch(q.type){case"TopHat":return q.properties;default:return fn.properties}}),ie=t(()=>{let q,fe;switch(e.roofType()){case"Gable":{q=new Yt({purlinItemName:t(()=>Ze(z())),purlinProperties:oe,outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),.5*e.span()/n()),f.create(0,.5*e.span()/n())]),baySizes:s,openings:t(()=>[]),openBays:t(()=>[]),hasEndClips:()=>!1}),fe=new Yt({purlinItemName:t(()=>Ze(z())),purlinProperties:oe,outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),.5*e.span()/n()),f.create(0,.5*e.span()/n())]),baySizes:t(()=>[...s()].reverse()),openings:t(()=>[]),openBays:t(()=>[]),hasEndClips:()=>!1});break}case"Skillion":{q=new Yt({purlinItemName:t(()=>Ze(z())),purlinProperties:oe,outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.span()/n()),f.create(0,e.span()/n())]),baySizes:s,openings:t(()=>[]),openBays:t(()=>[]),hasEndClips:()=>!1}),fe=void 0;break}}return[{purlins:q,space:m.create(i.create(0,0,e.height()-ce()/n()),y.fromUV(i.unitX,i.create(0,n(),r()))),usage:"Sideroof A"},...fe!=null?[{purlins:fe,space:m.create(i.create(e.length(),e.span(),e.height()-ce()/n()),y.fromUV(i.negUnitX,i.create(0,-n(),r()))),usage:"Sideroof B"}]:[]]}),ae=t(()=>ie().map(({purlins:q,space:fe,usage:re})=>new T({usage:()=>re,children:q.components,transform:()=>fe}))),be=(q,fe,re)=>t(()=>{let ge=fe(),ze=q(),Ie=re();return ze.map((Ge,st)=>{let ct;Ie?ct=ze.length-1-st:ct=st;let at=ct.toString(),He=ge.find(Ee=>{if(Ee.location.head()!="Bay")return!1;let qe=Ee.location.tail();return qe==null?!1:qe.head()==at});if(He==null)return{baySize:Ge,sheetedStyle:{type:"Fully Sheeted"}};switch(He.type){case"Fully Open":return{baySize:Ge,sheetedStyle:{type:"Fully Open"}};case"Upper Infill":return{baySize:Ge,sheetedStyle:{type:"Upper Infill",fromHeight:He.fromHeight}};case"Lower Infill":return{baySize:Ge,sheetedStyle:{type:"Lower Infill",toHeight:He.toHeight}};case"Skirted":return{baySize:Ge,sheetedStyle:{type:"Skirted",fromHeight:He.fromHeight,toHeight:He.toHeight}}}})}),we=be(s,H,()=>!1),ke=be(a,X,()=>!0),Ve=be(h,Z,()=>!0),Se=be(d,U,()=>!1),Le=t(()=>{let q=new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())]),bays:we,openings:le,colour:()=>"Deep Ocean",sheetingLowPoly:e.sheetingLowPoly,previewOpening:()=>{},textures:e.textures}),fe=new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())]),bays:ke,openings:me,colour:()=>"Deep Ocean",sheetingLowPoly:e.sheetingLowPoly,previewOpening:()=>{},textures:e.textures}),re,ge;switch(e.roofType()){case"Gable":{re=t(()=>[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),e.height()+.5*e.span()*Math.tan(e.pitch()*Math.PI/180)),f.create(0,e.height())]),ge=re;break}case"Skillion":{re=t(()=>[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(0,l())]),ge=t(()=>[f.create(0,0),f.create(e.span(),0),f.create(e.span(),l()),f.create(0,e.height())]);break}}let ze=new Te({type:()=>"Wall Sheeting",outline:re,bays:Ve,openings:ye,colour:()=>"Deep Ocean",sheetingLowPoly:e.sheetingLowPoly,previewOpening:()=>{},textures:e.textures}),Ie=new Te({type:()=>"Wall Sheeting",outline:ge,bays:Se,openings:W,colour:()=>"Deep Ocean",sheetingLowPoly:e.sheetingLowPoly,previewOpening:()=>{},textures:e.textures});return[{sheetedArea:q,space:m.create(i.create(0,0,0),y.fromWU(i.unitZ,i.unitX)),sideName:"Sidewall A"},{sheetedArea:fe,space:m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)),sideName:"Sidewall B"},{sheetedArea:ze,space:m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)),sideName:"Endwall A"},{sheetedArea:Ie,space:m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)),sideName:"Endwall B"}]}),Xe=t(()=>Le().map(({sheetedArea:q,space:fe})=>new T({children:q.components,transform:()=>fe}))),Ke=t(()=>{switch(e.roofType()){case"Gable":{let q=new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-nn),f.create(e.length(),-nn),f.create(e.length(),.5*e.span()/n()),f.create(0,.5*e.span()/n())]),openings:()=>[],colour:()=>"Manor Red",sheetingType:()=>"Corrugated 0.42",sheetingLowPoly:e.sheetingLowPoly,previewOpening:()=>{},textures:e.textures});return[{sheetedArea:q,space:m.create(i.create(0,0,e.height()),y.fromWU(i.create(0,n(),r()),i.unitX))},{sheetedArea:q,space:m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.create(0,-n(),r()),i.negUnitX))}]}case"Skillion":return[{sheetedArea:new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-nn),f.create(e.length(),-nn),f.create(e.length(),e.span()/n()),f.create(0,e.span()/n())]),openings:()=>[],colour:()=>"Manor Red",sheetingType:()=>"Corrugated 0.42",sheetingLowPoly:e.sheetingLowPoly,previewOpening:()=>{},textures:e.textures}),space:m.create(i.create(0,0,e.height()),y.fromWU(i.create(0,n(),r()),i.unitX))}]}}),Nt=t(()=>Ke().map(({sheetedArea:q,space:fe})=>new T({children:q.components,transform:()=>fe}))),fi=t(()=>{let q="Flashing - Barge Corrugated CB";return[new T({itemName:()=>q,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,0-oi*n(),e.height()+30/n()-oi*r()),y.fromUV(i.create(0,n(),r()),i.negUnitX)),length:()=>.5*e.span()/n()+oi,flashingProfile:()=>tt}),new T({itemName:()=>q,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,.5*e.span(),e.height()+.5*e.span()*o()+30/n()),y.fromUV(i.create(0,n(),-r()),i.negUnitX)),length:()=>.5*e.span()/n()+oi,flashingProfile:()=>tt}),new T({itemName:()=>q,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,e.span()+oi*n(),e.height()+30/n()-oi*r()),y.fromUV(i.create(0,-n(),r()),i.unitX)),length:()=>.5*e.span()/n()+oi,flashingProfile:()=>tt}),new T({itemName:()=>q,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,.5*e.span(),e.height()+.5*e.span()*o()+30/n()),y.fromUV(i.create(0,-n(),-r()),i.unitX)),length:()=>.5*e.span()/n()+oi,flashingProfile:()=>tt})]}),qt=t(()=>[new T({itemName:()=>"Roll Top Ridge 0.55 Colorbond",transform:()=>m.create(i.create(0,.5*e.span(),e.height()+.5*e.span()*o()+30/n()),y.identity),length:()=>e.length(),flashingProfile:()=>bn({pitch:e.pitch()})})]),Jt=t(()=>{let q="Flashing - Corner 50 x 50 CB";return[new T({itemName:()=>q,transform:()=>m.create(i.create(-30,-30,0),y.fromUV(i.unitZ,i.unitX)),length:()=>e.height(),flashingProfile:()=>ut}),new T({itemName:()=>q,transform:()=>m.create(i.create(e.length()+30,-30,0),y.fromUV(i.unitZ,i.unitY)),length:()=>e.height(),flashingProfile:()=>ut}),new T({itemName:()=>q,transform:()=>m.create(i.create(e.length()+30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitX)),length:()=>e.height(),flashingProfile:()=>ut}),new T({itemName:()=>q,transform:()=>m.create(i.create(-30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitY)),length:()=>e.height(),flashingProfile:()=>ut})]}),ei=t(()=>[{fascia:new Mr({baySizes:s}),space:m.create(i.create(0,0,e.height()),y.fromWU(i.unitZ,i.unitX))},{fascia:new Mr({baySizes:a}),space:m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.unitZ,i.negUnitX))}]),Bi=t(()=>ei().flatMap(({fascia:q,space:fe})=>new T({children:q.components,transform:()=>fe}))),wn=t(()=>[{gutter:new jt({length:e.length}),space:m.create(i.create(0,0,e.height()),y.fromWU(i.unitZ,i.unitX))},{gutter:new jt({length:e.length}),space:m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.unitZ,i.negUnitX))}]),de=t(()=>wn().flatMap(({gutter:q,space:fe})=>new T({children:q.components,transform:()=>fe}))),ue=t(()=>[{wallId:A,openings:$()},{wallId:I,openings:G()},{wallId:O,openings:J()},{wallId:E,openings:K()}].flatMap(({wallId:q,openings:fe})=>{let re=_(q);if(re==null)return[];let ge=re;return fe.flatMap(ze=>{let Ie=Y(q,ze.location,ze);if(Ie==null)return[];let Ge=Ie;return[new T({id:()=>ze.id,openingProperties:t(()=>new Si({type:ze.type,modelName:"",width:ze.width,height:ze.height})),transform:t(()=>ge.fromThisSpace(m.create(i.create(Ge.x,0,Ge.y),y.identity)))})]})}));this.components=t(()=>[...L(),...j(),...ae(),...Xe(),...Nt(),...fi(),...qt(),...Jt(),...Bi(),...de(),...ue()]),this.sideBaySizes=s,this.endABaySizes=h,this.endBBaySizes=d;let pe=We.fromArray(["SidewallA"]),Ne=We.fromArray(["SidewallB"]),ot=We.fromArray(["EndwallA"]),Qe=We.fromArray(["EndwallB"]);this.insertOpeningWalls=t(()=>{let q={location:pe,space:m.create(i.zero,y.identity),outline:[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())],bays:s().map(Ie=>({size:Ie,minLeftDist:300,minRightDist:300})),reverseBayIndices:!1},fe,re,ge,ze=[...s()].reverse();switch(e.roofType()){case"Gable":{fe={location:Ne,space:m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)),outline:[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())],bays:ze.map(Ie=>({size:Ie,minLeftDist:300,minRightDist:300})),reverseBayIndices:!0},re={location:ot,space:m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)),outline:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),l()),f.create(0,e.height())],bays:h().map(Ie=>({size:Ie,minLeftDist:300,minRightDist:300})),reverseBayIndices:!0},ge={location:Qe,space:m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)),outline:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),l()),f.create(0,e.height())],bays:d().map(Ie=>({size:Ie,minLeftDist:300,minRightDist:300})),reverseBayIndices:!1};break}case"Skillion":{fe={location:Ne,space:m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)),outline:[f.create(0,0),f.create(e.length(),0),f.create(e.length(),l()),f.create(0,l())],bays:ze.map(Ie=>({size:Ie,minLeftDist:300,minRightDist:300})),reverseBayIndices:!0},re={location:ot,space:m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)),outline:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(0,l())],bays:h().map(Ie=>({size:Ie,minLeftDist:300,minRightDist:300})),reverseBayIndices:!0},ge={location:Qe,space:m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)),outline:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),l()),f.create(0,e.height())],bays:d().map(Ie=>({size:Ie,minLeftDist:300,minRightDist:300})),reverseBayIndices:!1};break}}return[q,fe,re,ge]}),this.insertPartitionWalls=t(()=>{let q=[],fe=s(),re=0,ge;switch(e.roofType()){case"Gable":ge=[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),l()),f.create(0,e.height())];break;case"Skillion":ge=[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(0,l())];break}let ze=e.partitionWalls();for(let Ie=0;Ie<fe.length-1;++Ie){re+=fe[Ie];let Ge=We.fromArray(["MidFrame",Ie.toString()]);ze.some(st=>st.location.equals(Ge))||q.push({location:Ge,space:m.create(i.create(re,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)),outline:ge})}return q}),this.openingSelectables=t(()=>ue().flatMap(q=>{if(q.id==null)return[];if(q.openingProperties==null)return[];let fe;q.transform==null?fe=m.identity:fe=q.transform();let re=q.id(),ge=q.openingProperties();return{id:re,space:fe,localAabb:new Vt({minX:0,maxX:ge.width,minY:-200,maxY:200,minZ:0,maxZ:ge.height})}}));let Ye=t(()=>m.create(i.zero,y.identity)),Mt=t(()=>m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX))),pt=t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY))),Ct=t(()=>m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)));t(()=>Kt.fromKnownPtAndNormal(i.zero,i.negUnitY)),t(()=>Kt.fromKnownPtAndNormal(i.create(e.length(),e.span(),0),i.unitY)),t(()=>Kt.fromKnownPtAndNormal(i.create(0,e.span(),0),i.negUnitX)),t(()=>Kt.fromKnownPtAndNormal(i.create(e.length(),0,0),i.unitX)),t(()=>Kt.fromKnownPtAndNormal(i.create(0,0,e.height()),i.create(0,-r(),n()))),t(()=>{if(e.roofType()=="Gable")return Kt.fromKnownPtAndNormal(i.create(e.length(),e.span(),e.height()),i.create(0,r(),n()))}),this.baySelectables=t(()=>{let q=[],fe=c(),re=u(),ge=S(),ze=Ye(),Ie=Mt(),Ge=pt(),st=Ct(),ct=le(),at=me(),He=ye(),Ee=W();for(let qe=0;qe<fe.length-1;++qe){let $t=fe[qe],ii=fe[qe+1];{let Dt=new Vt({minX:$t,maxX:ii,minY:-100,maxY:100,minZ:0,maxZ:e.height()}),pi={id:"SidewallA.Bay["+qe.toString()+"]",space:ze,localAabb:Dt,rayCollisionTime:mi=>{let _t=mi.toSpace(ze),Bt=Dt.rayCollisionTime(_t);if(Bt==null)return;let gt=_t.positionFromTime(Bt);for(let it of ct)if(gt.x>=it.pos.x&&gt.y>=it.pos.y&&gt.x<it.pos.x+it.width&&gt.y<it.pos.y+it.height)return;return Bt}};q.push(pi)}{let Dt=new Vt({minX:e.length()-ii,maxX:e.length()-$t,minY:-100,maxY:100,minZ:0,maxZ:e.roofType()=="Gable"?e.height():l()}),pi={id:"SidewallB.Bay["+qe.toString()+"]",space:Ie,localAabb:Dt,rayCollisionTime:mi=>{let _t=mi.toSpace(Ie),Bt=Dt.rayCollisionTime(_t);if(Bt==null)return;let gt=_t.positionFromTime(Bt);for(let it of at)if(gt.x>=it.pos.x&&gt.y>=it.pos.y&&gt.x<it.pos.x+it.width&&gt.y<it.pos.y+it.height)return;return Bt}};q.push(pi)}}for(let qe=0;qe<re.length-1;++qe){let $t=re[qe],ii=re[qe+1],Dt=new Vt({minX:$t,maxX:ii,minY:-100,maxY:100,minZ:0,maxZ:l()}),pi={id:"EndwallA.Bay["+(re.length-2-qe).toString()+"]",space:Ge,localAabb:Dt,rayCollisionTime:mi=>{let _t=mi.toSpace(Ge),Bt=Dt.rayCollisionTime(_t);if(Bt==null)return;let gt=_t.positionFromTime(Bt);for(let it of He)if(gt.x>=it.pos.x&&gt.y>=it.pos.y&&gt.x<it.pos.x+it.width&&gt.y<it.pos.y+it.height)return}};q.push(pi)}for(let qe=0;qe<ge.length-1;++qe){let $t=ge[qe],ii=ge[qe+1],Dt=new Vt({minX:$t,maxX:ii,minY:-100,maxY:100,minZ:0,maxZ:l()}),pi={id:"EndwallB.Bay["+qe.toString()+"]",space:st,localAabb:Dt,rayCollisionTime:mi=>{let _t=mi.toSpace(st),Bt=Dt.rayCollisionTime(_t);if(Bt==null)return;let gt=_t.positionFromTime(Bt);for(let it of Ee)if(gt.x>=it.pos.x&&gt.y>=it.pos.y&&gt.x<it.pos.x+it.width&&gt.y<it.pos.y+it.height)return}};q.push(pi)}return q})}}let Id={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:2e3},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:3e3},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2100},roofType:{displayName:"Roof Type",typeSchema:{type:"String",possibleValues:["Gable","Skillion"]},defaultValue:"Gable",optional:!0},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:40},includeGutter:{displayName:"Include Gutter?",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},includeNoggin:{displayName:"Include Noggin?",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},openSidewallA:{displayName:"Open Sidewall A?",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},includeFloor:{displayName:"Include Floor?",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},includeSkis:{displayName:"Has Skis?",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},openings:{displayName:"Openings",typeSchema:{type:"Array",elemTypeSchema:fr},defaultValue:[]},openBays:{displayName:"Open Bays",typeSchema:{type:"Array",elemTypeSchema:Yl},defaultValue:[],optional:!0},wallSheetingColour:{displayName:"Wall Sheet Colour",typeSchema:{type:"String"},defaultValue:"Deep Ocean",optional:!0},roofSheetingColour:{displayName:"Roof Sheet Colour",typeSchema:{type:"String"},defaultValue:"Deep Ocean",optional:!0},includeVermanFlashing:{displayName:"Include Verman Flashing",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},hasWeatherVane:{displayName:"Has Weather Vane",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},hasFakeRoofWindowSidewallA:{displayName:"Has Fake Window Sidewall A",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},hasFakeRoofWindowSidewallB:{displayName:"Has Fake Window Sidewall B",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0}};const Bd=new Ae({typeName:"GardenShed",displayName:"Garden Shed",propertiesSchema:Id}),Od=Bd;class Fd{constructor(){this.componentType=Od}create(e,n,r,o,l){return new Vd(n,r,o,l)}}let Gl=new Fd;Be(Gl);class Vd{constructor(e,n,r,o){this.type=Gl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new kd({span:()=>e.span,length:()=>e.length,height:()=>e.height,roofType:()=>e.roofType,pitch:()=>e.pitch,includeGutter:()=>e.includeGutter,includeNoggin:()=>e.includeNoggin,openSidewallA:()=>e.openSidewallA,includeFloor:()=>e.includeFloor,includeSkis:()=>e.includeSkis,openings:()=>e.openings,openBays:()=>e.openBays,wallSheetingColour:()=>e.wallSheetingColour,roofSheetingColour:()=>e.roofSheetingColour,includeVermanFlashing:()=>e.includeVermanFlashing,hasWeatherVane:()=>e.hasWeatherVane,hasFakeRoofWindowOnSidewallA:()=>e.hasFakeRoofWindowSidewallA,hasFakeRoofWindowOnSidewallB:()=>e.hasFakeRoofWindowSidewallB,font:()=>ar,mkKit:ol({kitsUserEdits:r,setKitsUserEdits:o})});this.kits=l.kits,this.components=l.components,this.properties=t(()=>[{displayName:"Garden Shed",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:S=>n("span",S)}),se({displayName:()=>"Length",value:()=>e.length,setValue:S=>n("length",S)}),se({displayName:()=>"Height",value:()=>e.height,setValue:S=>n("height",S)}),an({displayName:()=>"Roof Type",value:()=>e.roofType,setValue:S=>n("roofType",S),possibleValues:t(()=>["Gable","Skillion"])}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:S=>n("pitch",S)}),kt({displayName:()=>"Include Gutter?",value:()=>e.includeGutter,setValue:S=>n("includeGutter",S)}),kt({displayName:()=>"Include Verman Flashing?",value:()=>e.includeVermanFlashing,setValue:S=>n("includeVermanFlashing",S)}),kt({displayName:()=>"Include Noggin?",value:()=>e.includeNoggin,setValue:S=>n("includeNoggin",S)}),kt({displayName:()=>"Open Sidewall A?",value:()=>e.openSidewallA,setValue:S=>n("openSidewallA",S)}),kt({displayName:()=>"Include Floor?",value:()=>e.includeFloor,setValue:S=>n("includeFloor",S)}),kt({displayName:()=>"Include Skis?",value:()=>e.includeSkis,setValue:S=>n("includeSkis",S)}),kt({displayName:()=>"Weather Vane?",value:()=>e.hasWeatherVane,setValue:S=>n("hasWeatherVane",S)}),kt({displayName:()=>"Fake Roof Window Side A?",value:()=>e.hasFakeRoofWindowSidewallA,setValue:S=>n("hasFakeRoofWindowSidewallA",S)}),kt({displayName:()=>"Fake Roof Window Side B?",value:()=>e.hasFakeRoofWindowSidewallB,setValue:S=>n("hasFakeRoofWindowSidewallB",S)})],expanded:()=>!0},{displayName:"Colours",fields:[ci({displayName:()=>"Wall Sheeting Colour",value:()=>e.wallSheetingColour,setValue:S=>n("wallSheetingColour",S),possibleValues:t(()=>Object.keys(Pt))}),ci({displayName:()=>"Roof Sheeting Colour",value:()=>e.roofSheetingColour,setValue:S=>n("roofSheetingColour",S),possibleValues:t(()=>Object.keys(Pt))})],expanded:()=>!0}]),this.documents2=S=>t(()=>[{name:()=>"Member Schedule",pages:()=>[t(()=>Gi({title:"Garden Shed",components:l.memberScheduleComponents(),labeler:S}))]}]),this.allocateLabels=S=>{l.allocateLabels(S)},this.insertOpeningWalls=l.insertOpeningWalls,this.insertOpening=t(()=>S=>{n("openings",[...e.openings,S])});let s=S=>e.openings.find(b=>b.id==S),a=(S,b)=>{n("openings",e.openings.map(N=>N.id!=S?N:b(N)))},h=t(()=>l.openingSelectables().map(b=>({id:()=>b.id,space:()=>b.space,localAabb:()=>b.localAabb,properties:t(()=>[{displayName:"Opening",fields:[se({displayName:()=>"Height",value:t(()=>s(b.id)?.height??0),setValue:N=>a(b.id,w=>({...w,height:N}))}),se({displayName:()=>"Width",value:t(()=>s(b.id)?.width??0),setValue:N=>a(b.id,w=>({...w,width:N}))}),se({displayName:()=>"Head Height",value:t(()=>s(b.id)?.headHeight??0),setValue:N=>a(b.id,w=>({...w,headHeight:N}))})],expanded:()=>!0},{displayName:"Position",fields:[jn({displayName:()=>"Location",value:t(()=>{let N=s(b.id);return N==null?"":N.location.toArray().join(".")}),setValue:N=>{let w=N.split("."),p=We.fromArray(w);a(b.id,g=>({...g,location:p}))}})],expanded:()=>!0}]),delete:()=>{n("openings",e.openings.filter(N=>N.id!=b.id))}}))),d=/^(Sidewall[AB]|Endwall[AB])\.Bay\[([0-9]+)\]$/,c=S=>{let b=d.exec(S);if(b==null)return t(()=>[]);let N=b[1],w=Number.parseInt(b[2]),p=We.fromArray([N,"Bay",w.toString()]),g=t(()=>e.openBays.find(k=>k.location.equals(p))),P=t(()=>{let k=g();if(k!=null)switch(k.type){case"Fully Open":return;case"Upper Infill":return k.fromHeight;case"Lower Infill":return;case"Skirted":return k.fromHeight}}),M=t(()=>{let k=g();if(k!=null)switch(k.type){case"Fully Open":return;case"Upper Infill":return;case"Lower Infill":return k.toHeight;case"Skirted":return k.toHeight}}),v=t(()=>{let k=g();if(k!=null)switch(k.type){case"Fully Open":return;case"Upper Infill":return;case"Lower Infill":return k.includeMeshAbove;case"Skirted":return}});return t(()=>[{displayName:"Bay",fields:[ft({displayName:()=>"Sheeted Type",value:t(()=>{let k=g();if(k==null)return"Full";switch(k.type){case"Fully Open":return"Open";case"Upper Infill":return"Upper Infill";case"Lower Infill":return"Lower Infill";case"Skirted":return"Skirted"}}),setValue:k=>{switch(k){case"Full":{n("openBays",e.openBays.filter(z=>!z.location.equals(p)));break}case"Open":{let z=!1,x=[],A={type:"Fully Open",location:p};for(let I=0;I<e.openBays.length;++I)e.openBays[I].location.equals(p)?(x.push(A),z=!0):x.push(e.openBays[I]);z||x.push(A),n("openBays",x);break}case"Upper Infill":{let z=!1,x=[],A={type:"Upper Infill",location:p,fromHeight:e.height-300};for(let I=0;I<e.openBays.length;++I)e.openBays[I].location.equals(p)?(x.push(A),z=!0):x.push(e.openBays[I]);z||x.push(A),n("openBays",x);break}case"Lower Infill":{let z=!1,x=[],A={type:"Lower Infill",location:p,toHeight:e.height-300,includeMeshAbove:!1};for(let I=0;I<e.openBays.length;++I)e.openBays[I].location.equals(p)?(x.push(A),z=!0):x.push(e.openBays[I]);z||x.push(A),n("openBays",x);break}case"Skirted":{let z=!1,x=[],A={type:"Skirted",location:p,fromHeight:300,toHeight:1e3};for(let I=0;I<e.openBays.length;++I)e.openBays[I].location.equals(p)?(x.push(A),z=!0):x.push(e.openBays[I]);z||x.push(A),n("openBays",x);break}}},possibleValues:t(()=>["Full","Open","Upper Infill","Lower Infill","Skirted"])}),...P()==null?[]:[se({displayName:()=>"From Height",value:()=>P()??0,setValue:k=>n("openBays",e.openBays.map(z=>z.location.equals(p)?{...z,fromHeight:k}:z))})],...M()==null?[]:[se({displayName:()=>"To Height",value:()=>M()??0,setValue:k=>n("openBays",e.openBays.map(z=>z.location.equals(p)?{...z,toHeight:k}:z))})],...v()==null?[]:[kt({displayName:()=>"Include Mesh Above",value:()=>v()??!1,setValue:k=>n("openBays",e.openBays.map(z=>z.location.equals(p)?{...z,includeMeshAbove:k}:z))})]],expanded:()=>!0}])},u=t(()=>l.baySelectables().map(({id:b,space:N,localAabb:w,rayCollisionTime:p})=>({id:()=>b,space:()=>N,localAabb:()=>w,rayCollisionTime:()=>p,properties:c(b)})));this.subObjects=t(()=>[...h(),...u()]),this.mkFramesForDoc=l.mkFramesForDoc}}let Ld={diameter:{displayName:"Diameter",typeSchema:{type:"Number"},defaultValue:760},baseDiameter:{displayName:"Base Diameter",typeSchema:{type:"Number"},defaultValue:420},baseHeight:{displayName:"Base Height",typeSchema:{type:"Number"},defaultValue:152},headHeight:{displayName:"Head Height",typeSchema:{type:"Number"},defaultValue:152+185},legPitch:{displayName:"Leg Pitch",typeSchema:{type:"Number"},defaultValue:80}};const Hd=new Ae({typeName:"HexagonalFirePit",displayName:"Hexagonal Fire Pit",propertiesSchema:Ld}),Ed=Hd;class Ud{constructor(){this.componentType=Ed}create(e,n,r,o,l){return new Rd(n,r,o,l)}}let Zl=new Ud;Be(Zl);class Rd{constructor(e,n,r,o){this.type=Zl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=a=>a/Math.sin(Math.PI/3),s=new ks({diameter:()=>l(e.diameter),baseDiameter:()=>l(e.baseDiameter),baseHeight:()=>e.baseHeight,headHeight:()=>e.headHeight,legPitch:()=>e.legPitch});this.components=s.components,this.properties=t(()=>[{displayName:"Hexagonal Fire Pit",fields:[se({displayName:()=>"Diameter",value:()=>e.diameter,setValue:a=>n("diameter",a)}),se({displayName:()=>"Base Diameter",value:()=>e.baseDiameter,setValue:a=>n("baseDiameter",a)}),se({displayName:()=>"Base Height",value:()=>e.baseHeight,setValue:a=>n("baseHeight",a)}),se({displayName:()=>"Head Height",value:()=>e.headHeight,setValue:a=>n("headHeight",a)}),se({displayName:()=>"Leg Pitch",value:()=>e.legPitch,setValue:a=>n("legPitch",a)}),Qn({displayName:()=>"Area m\xB2",value:()=>s.totalPlateArea().toFixed(2)})],expanded:()=>!0}]),this.allocateLabels=s.allocateLabels,this.mkPlatesForDoc=s.mkPlatesForDoc}}class Wd{constructor(e){let n=t(()=>new T({mkObject3d:()=>r=>{let o=.001,l=new Et;l.absarc(0,0,(e.pipeInsideRadius()+e.pipeThickness())*o,2*Math.PI,0,!1);let s=new Et;s.absarc(0,0,e.pipeInsideRadius()*o,0,2*Math.PI,!0),l.holes.push(s);let a=new It(l,{bevelEnabled:!1,depth:e.pipeLength()*o}),h=new rt({color:"#808080"}),d=new bt(a,35),c=new Tt({color:"black"});Fe(()=>{a.dispose(),h.dispose(),d.dispose(),c.dispose()});let u=new nt;return u.add(new xe(a,h)),u.add(new ht(d,c)),u}}));this.components=t(()=>[n()])}}class Xd{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=t(()=>[new T({itemName:e.columnItemName,length:e.height,ceeProperties:e.columnProperties,transform:t(()=>m.create(i.create(e.columnProperties().flangeSize*Math.SQRT1_2,0,0),y.fromWU(i.create(-Math.SQRT1_2,Math.SQRT1_2,0),i.unitZ)))}),new T({itemName:e.columnItemName,length:e.height,ceeProperties:e.columnProperties,transform:t(()=>m.create(i.create((e.columnProperties().webSize+e.columnProperties().flangeSize)*Math.SQRT1_2,e.span()-e.columnProperties().webSize*Math.SQRT1_2,0),y.fromWU(i.create(-Math.SQRT1_2,-Math.SQRT1_2,0),i.unitZ)))}),new T({itemName:e.columnItemName,length:e.height,ceeProperties:e.columnProperties,transform:t(()=>m.create(i.create(.5*e.span(),e.columnProperties().webSize,0),y.fromWU(i.unitX,i.unitZ)))}),new T({itemName:e.columnItemName,length:e.height,ceeProperties:e.columnProperties,transform:t(()=>m.create(i.create(.5*e.span(),e.span(),0),y.fromWU(i.unitX,i.unitZ)))})]),a=t(()=>{let u,S,b;{let M=Math.SQRT2,v=l(),k=Math.sqrt(M*M+v*v);u=M/k,S=v/k,b=v/M}let N=(e.columnProperties().flangeSize+e.columnProperties().webSize)*Math.SQRT1_2,w=N,p=Math.sqrt(N*N+w*w),g=t(()=>(.5*e.span()*Math.SQRT2-p)/u),P=t(()=>(.5*e.span()-e.columnProperties().webSize)/r()-e.columnProperties().webSize*l());return[new T({itemName:e.columnItemName,length:g,ceeProperties:e.columnProperties,transform:t(()=>m.create(i.create(N,-e.columnProperties().flangeSize*Math.SQRT1_2+w,e.height()+p*b),y.fromWU(i.create(-Math.SQRT1_2,Math.SQRT1_2,0),i.create(Math.SQRT1_2*u,Math.SQRT1_2*u,S))))}),new T({itemName:e.columnItemName,length:g,ceeProperties:e.columnProperties,transform:t(()=>m.create(i.create(e.columnProperties().flangeSize*Math.SQRT1_2+e.columnProperties().webSize*S*Math.SQRT1_2+N-e.columnProperties().flangeSize*Math.SQRT1_2,e.span()-e.columnProperties().webSize*S*Math.SQRT1_2-w+e.columnProperties().flangeSize*Math.SQRT1_2,e.height()+(e.columnProperties().webSize*S+p)*b-e.columnProperties().webSize/u),y.fromWU(i.create(-Math.SQRT1_2,-Math.SQRT1_2,0),i.create(Math.SQRT1_2*u,-Math.SQRT1_2*u,S))))}),new T({itemName:e.columnItemName,length:P,ceeProperties:e.columnProperties,transform:t(()=>m.create(i.create(.5*e.span(),e.columnProperties().webSize+e.columnProperties().webSize*o(),e.height()-e.columnProperties().webSize/r()+e.columnProperties().webSize*o()*l()+e.columnProperties().webSize*l()),y.fromWU(i.unitX,i.create(0,r(),o()))))}),new T({itemName:e.columnItemName,length:P,ceeProperties:e.columnProperties,transform:t(()=>m.create(i.create(.5*e.span(),e.span()-e.columnProperties().webSize,e.height()+e.columnProperties().webSize*l()),y.fromWU(i.unitX,i.create(0,-r(),o()))))})]}),h=()=>300,d={bracket:new Wd({pitch:e.pitch,webHoleGapSize:()=>e.columnProperties().webHoleDistApart,pipeInsideRadius:()=>30,pipeThickness:()=>6,pipeLength:h}),space:t(()=>m.create(i.create(.5*e.span(),.5*e.span(),e.height()+.5*e.span()*l()-.5*h()-.5*e.columnProperties().webSize/r()),y.identity))},c=t(()=>new T({children:d.bracket.components,transform:d.space}));this.components=t(()=>[...s(),...a(),c()])}}const Dd=6e3,_d=2400,Yd=15,Gd="C25024";let Zd={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:Dd},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:_d},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:Yd},columnItemName:{displayName:"Column Item Name",typeSchema:{type:"String"},defaultValue:Gd}};const $d=new Ae({typeName:"HipRoofPortalFrame",displayName:"Hip Roof Portal Frame",propertiesSchema:Zd}),Kd=$d;class jd{constructor(){this.isForTesting=!0,this.componentType=Kd}create(e,n,r,o,l){return new Qd(n,r,o,l)}}let $l=new jd;Be($l);class Qd{constructor(e,n,r,o){this.type=$l,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new Xd({span:()=>e.span,height:()=>e.height,pitch:()=>e.pitch,columnItemName:()=>e.columnItemName,columnProperties:t(()=>yt[e.columnItemName])});this.components=l.components,this.properties=t(()=>[{displayName:"Properties",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:s=>n("span",s)}),se({displayName:()=>"Height",value:()=>e.span,setValue:s=>n("height",s)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:s=>n("pitch",s)}),ft({displayName:()=>"Column",value:()=>e.columnItemName,setValue:s=>n("columnItemName",s),possibleValues:t(()=>Object.keys(yt))})],expanded:()=>!0}])}}let qd={mimeType:{displayName:"Mime Type",typeSchema:{type:"String"},defaultValue:"image/png"},base64Data:{displayName:"Base 64 Data",typeSchema:{type:"String"},defaultValue:"iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAABlFJREFUeF7t1IERACAIAzHZf2g8XePDBk25zu7ucQQI5ATmnQHI9S4wgS9gADwCgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgIGIFy+6AQMgB8gEBYwAOHyRSdgAPwAgbCAAQiXLzoBA+AHCIQFDEC4fNEJGAA/QCAsYADC5YtOwAD4AQJhAQMQLl90AgbADxAICxiAcPmiEzAAfoBAWMAAhMsXnYAB8AMEwgJ/AML5RSeQF7hgif0uvuOdMwAAAABJRU5ErkJggg=="},scale:{displayName:"Scale",typeSchema:{type:"Number"},defaultValue:1},opacity:{displayName:"Opacity",typeSchema:{type:"Number"},defaultValue:1}};const Jd=new Ae({typeName:"Image",displayName:"Image",propertiesSchema:qd}),eu=Jd;class tu{constructor(){this.componentType=eu}create(e,n,r,o,l){return new iu(n,r,o,l)}}let Kl=new tu;Be(Kl);class iu{constructor(e,n,r,o){this.type=Kl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=t(()=>{let[a,h]=wt(al()),d=()=>{let c=a();c.type=="Success"&&c.value.dispose()};return new fl().loadAsync("data:"+e.mimeType+";base64,"+e.base64Data).then(c=>{d(),h(hl(c))}).catch(c=>{d(),h(cl(c))}),Fe(()=>{d()}),a}),s=t(()=>l()());this.components=t(()=>{let a=s();if(a.type!="Success")return[];let h=a.value,d=e.scale*.001,c=h.image.width,u=h.image.height;return c==null||u==null?[]:[new T({mkObject3d:t(()=>S=>{let b=new Float32Array([0,0,0,c*d,0,0,c*d,u*d,0,0,u*d,0]),N=new di(b,3),w=new Float32Array([0,0,1,0,1,1,0,1]),p=new di(w,2),g=[0,1,2,0,2,3],P=new Xt;P.setAttribute("position",N),P.setAttribute("uv",p),P.setIndex(g);let M=new xt({map:h,opacity:Wi(()=>e.opacity),transparent:!0,side:$n});{let k=!0;Gt(()=>{let z=e.opacity;if(k){k=!1;return}M.setValues({opacity:z}),S()})}return new xe(P,M)})})]}),this.properties=t(()=>[{displayName:"Image",fields:[bs({displayName:()=>"Image",value:()=>({mimeType:e.mimeType,base64Data:e.base64Data}),setValue:({mimeType:a,base64Data:h})=>{At(()=>{n("mimeType",a),n("base64Data",h)})}}),se({displayName:()=>"Scale",value:()=>e.scale,setValue:a=>n("scale",a)}),yn({displayName:()=>"Opacity",value:()=>e.opacity,setValue:a=>n("opacity",a),minValue:()=>0,maxValue:()=>1,stepSize:()=>.1})],expanded:()=>!0}]),this.rayCollision=t(()=>a=>{let h=a.collisionTimeWithPlane(Kt.xyPlane);if(h==null||h<=0)return;let d=a.positionFromTime(h),c=this.getImage();if(c==null)return;let u=0,S=c.width*e.scale,b=0,N=c.height*e.scale;if(!(d.x<u||d.x>S||d.y<b||d.y>N))return h}),this.getImage=()=>{let a=s();if(a.type!="Success")return;let h=a.value.image;if(h instanceof HTMLImageElement)return h}}}let nu={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:1100},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:3655},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2330},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:5},sheetingType:{displayName:"Sheeting Type",typeSchema:{type:"String",possibleValues:["Steelclad 0.42","Corrugated 0.42"]},defaultValue:"Steelclad 0.42"},sheetingDirection:{displayName:"Sheeting Direction",typeSchema:{type:"String",possibleValues:["Vertical","Horizontal"]},defaultValue:"Horizontal"},openingSide:{displayName:"Open Side",typeSchema:{type:"String",possibleValues:["Sidewall A","Sidewall B"]},defaultValue:"Sidewall A"},openingWidth:{displayName:"Opening Width",typeSchema:{type:"Union",parts:{Max:{},Fixed:{value:{displayName:"Value",typeSchema:{type:"Number"},defaultValue:1e3}}}},defaultValue:{type:"Max"}}};const ru=new Ae({typeName:"LockerShed",displayName:"Locker Shed",propertiesSchema:nu}),lu=ru,ou=lt('<div style="whitespace: nowrap; width: 100%;"><b>"Max"</b>(<!>)</div>'),su=lt('<div style="whitespace: nowrap; width: 100%;"></div>'),au=lt('<div style="display: flex; flex-direction: column;"><div style="display: flex; flex-direction: row;"><input id="LockerShedDesigner_maxLenOrFixLenField_max" type="radio" name="LockerShedDesigner_maxLenOrFixLenField_group"><label style="whitespace: nowrap; padding-left: 2px;" for="LockerShedDesigner_maxLenOrFixLenField_max"><b>"Max"</b>(<!>)</label></div><div style="display: flex; flex-direction: row;"><input id="LockerShedDesigner_maxLenOrFixLenField_fixed" type="radio" name="LockerShedDesigner_maxLenOrFixLenField_group"><label style="whitespace: nowrap; padding-left: 2px;" for="LockerShedDesigner_maxLenOrFixLenField_fixed"><input type="text" size="5" style="padding-left: 2px;">mm</label></div><div style="text-align: right; margin-top: 5px;"><button class="btn btn-primary" style="margin-right: 5px;">OK</button><button class="btn btn-primary" style="margin-right: 5px;">Cancel</button></div></div>');class hu{componentType=lu;create(e,n,r,o,l){return new cu(n,r,o,l)}}let jl=new hu;Be(jl);class cu{type=jl;constructor(e,n,r,o){let[l,s]=wt({previewOpening:()=>{},sheetingLowPoly:()=>!1}),a=t(()=>l().sheetingLowPoly()),h=t(()=>l().textures);this.setVisualProperties=s,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let d=t(()=>new Ms({span:()=>e.span,length:()=>e.length,height:()=>e.height,pitch:()=>e.pitch,sheetingType:()=>e.sheetingType,sheetingDirection:()=>e.sheetingDirection,openingSide:()=>e.openingSide,openingWidth:()=>e.openingWidth,sheetingLowPoly:a,textures:h()}));this.components=t(()=>d().components()),this.properties=()=>[{displayName:"Properties",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:c=>n("span",c)}),se({displayName:()=>"Length",value:()=>e.length,setValue:c=>n("length",c)}),se({displayName:()=>"Height",value:()=>e.height,setValue:c=>n("height",c)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:c=>n("pitch",c)}),ft({displayName:()=>"Sheeting Type",value:()=>e.sheetingType,setValue:c=>n("sheetingType",c),possibleValues:t(()=>["Steelclad 0.42","Corrugated 0.42"])}),ft({displayName:()=>"Sheeting Direction",value:()=>e.sheetingDirection,setValue:c=>n("sheetingDirection",c),possibleValues:t(()=>["Vertical","Horizontal"])}),ft({displayName:()=>"Opening Side",value:()=>e.openingSide,setValue:c=>n("openingSide",c),possibleValues:t(()=>["Sidewall A","Sidewall B"])}),du({displayName:()=>"Opening Width",value:()=>e.openingWidth,setValue:c=>n("openingWidth",c),maxValue:()=>d().maxOpeningWidth()})],expanded:()=>!0}]}}function du(C){return ws({displayName:C.displayName,component:({editing:e,onDoneEdit:n})=>Je(vo,{get children(){return[Je(mr,{get when(){return!e()},children:()=>{let r=C.value();switch(r.type){case"Max":return(()=>{const o=ou.cloneNode(!0),l=o.firstChild,s=l.nextSibling,a=s.nextSibling;return a.nextSibling,mt(o,()=>C.maxValue()+" mm",a),o})();case"Fixed":return(()=>{const o=su.cloneNode(!0);return mt(o,()=>r.value+" mm"),o})()}}}),Je(mr,{get when(){return e()},children:()=>{let r;{let d=C.value();d.type=="Max"?r=C.maxValue():r=d.value}let[o,l]=Gn({type:C.value().type,fixedLength:r}),s=t(()=>{switch(o.type){case"Max":return!0;case"Fixed":return o.fixedLength!=null}}),a=()=>{!s()||At(()=>{switch(n()(),o.type){case"Max":C.setValue({type:"Max"});break;case"Fixed":o.fixedLength!=null&&C.setValue({type:"Fixed",value:o.fixedLength});break}})},h;return Co(()=>{if(C.value().type=="Fixed"){if(h==null)return;h.select()}}),(()=>{const d=au.cloneNode(!0),c=d.firstChild,u=c.firstChild,S=u.nextSibling,b=S.firstChild,N=b.nextSibling,w=N.nextSibling;w.nextSibling;const p=c.nextSibling,g=p.firstChild,P=g.nextSibling,M=P.firstChild,v=p.nextSibling,k=v.firstChild,z=k.nextSibling;u.addEventListener("change",A=>{A.currentTarget.checked&&l("type","Max")}),mt(S,()=>C.maxValue()+" mm",w),g.addEventListener("change",A=>{A.currentTarget.checked&&l("type","Fixed")}),M.$$keydown=A=>{A.key=="Enter"&&a()},M.$$input=A=>{let I=Number.parseFloat(A.currentTarget.value);Number.isFinite(I)?l("fixedLength",I):l("fixedLength",void 0)},M.$$click=A=>{o.type!="Fixed"&&l("type","Fixed"),A.currentTarget.select()};const x=h;return typeof x=="function"?To(x,M):h=M,M.value=r??"",k.$$click=()=>a(),z.$$click=()=>{n()()},dt(()=>k.disabled=!s()),dt(()=>u.checked=o.type=="Max"),dt(()=>g.checked=o.type=="Fixed"),d})()}})]}})})}Mo(["click","input","keydown"]);let uu={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:12e3},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:5e3},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2500},numEndBays:{displayName:"# End Bays",typeSchema:{type:"Number"},defaultValue:2},numSideBays:{displayName:"# Side Bays",typeSchema:{type:"Number"},defaultValue:1},joistCentres:{displayName:"Joist Centres",typeSchema:{type:"Number"},defaultValue:600},girderItemName:{displayName:"Girder Item Name",typeSchema:{type:"String"},defaultValue:"UB25025"},joistItemName:{displayName:"Joist Item Name",typeSchema:{type:"String"},defaultValue:"C20024"},columnItemName:{displayName:"Column Item Name",typeSchema:{type:"String"},defaultValue:"100x3.0 SHS"},plateThickness:{displayName:"Plate Thickness",typeSchema:{type:"Number"},defaultValue:10},hasStairs:{displayName:"Has Stairs",typeSchema:{type:"Boolean"},defaultValue:!0}};const fu=new Ae({typeName:"MezzanineFloor",displayName:"Mezzanine Floor",propertiesSchema:uu}),pu=fu;class mu{constructor(){this.componentType=pu}create(e,n,r,o,l){return new gu(n,r,o,l)}}let Ql=new mu;Be(Ql);class gu{constructor(e,n,r,o){this.type=Ql,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o,this.components=t(()=>{let l=hn[e.girderItemName];if(l==null)return[];let s=yt[e.joistItemName];if(s==null)return[];let a,h=/([0-9]+)x([0-9]+\.[0-9]+)/,d=e.columnItemName.match(h);if(d!=null&&(a=new Mi({size:Number.parseFloat(d[0]),thickness:Number.parseFloat(d[1])})),a==null)return[];let c=a;return new Cs({span:()=>e.span,length:()=>e.length,height:()=>e.height,numEndBays:()=>e.numEndBays,numSideBays:()=>e.numSideBays,joistCentres:()=>e.joistCentres,girderParams:()=>({itemName:e.girderItemName,webSize:l.webSize,flangeSize:l.flangeSize,thickness:l.thickness}),joistParams:()=>({itemName:e.joistItemName,webSize:s.webSize,flangeSize:s.flangeSize,thickness:s.thickness,lipSize:s.lipSize}),columnParams:()=>({itemName:e.columnItemName,size:c.size,thickness:c.thickness}),plateThickness:()=>e.plateThickness,stairsOp:t(()=>{if(e.hasStairs)return{entryFloorPt:f.create(e.length-1500,.5*152),dir:f.create(1,0),width:1200,headClearance:2e3}})}).components()}),this.properties=t(()=>[{displayName:"Mezzanine",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:l=>n("span",l)}),se({displayName:()=>"Length",value:()=>e.length,setValue:l=>n("length",l)}),se({displayName:()=>"Height",value:()=>e.height,setValue:l=>n("height",l)}),Di({displayName:()=>"# End Bays",value:()=>e.numEndBays,setValue:l=>n("numEndBays",l)}),Di({displayName:()=>"# Side Bays",value:()=>e.numSideBays,setValue:l=>n("numSideBays",l)}),se({displayName:()=>"Joist Centres",value:()=>e.joistCentres,setValue:l=>n("joistCentres",l)}),kt({displayName:()=>"Stairs?",value:()=>e.hasStairs,setValue:l=>n("hasStairs",l)})],expanded:()=>!0}])}}let yu={width:{displayName:"Width",typeSchema:{type:"Number"},defaultValue:50},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:70},thickness:{displayName:"Thickness",typeSchema:{type:"Number"},defaultValue:30}},bu=new Ae({typeName:"OpenCascadeBottle",displayName:"Open Cascade Bottle",propertiesSchema:yu});const wu=bu;class Su{constructor(){this.isForTesting=!0,this.componentType=wu}create(e,n,r,o,l){return new Pu(e,n,r,o,l)}}let ql=new Su;Be(ql);class Pu{constructor(e,n,r,o,l){this.type=ql,this.state=n,this.setState=r,this.kitsUserEdits=o,this.setKitsUserEdits=l;let s=t(()=>Nu(n)),a=new T({mkObject3d:t(()=>{let h=s();if(h==null)return()=>new nt;let d=h;return c=>{let u=new Xt,S=new rt({color:"#5a8296",polygonOffset:!0,polygonOffsetFactor:2,polygonOffsetUnits:1}),b=new Xt,N=new Tt({color:"#000000"});nr(u,d.mesh()),rr(b,d.meshEdges()),Fe(()=>{u.dispose(),S.dispose(),b.dispose(),N.dispose()});let w=new xe(u,S),p=new ht(b,N),g=new nt;return g.add(w),g.add(p),g}})});this.components=t(()=>[a]),this.replicadShape=s}}function Nu(C){try{let e=Pn([-C.width/2,0]).vLine(-C.thickness/4).threePointsArc(C.width,0,C.width/2,-C.thickness/4).vLine(C.thickness/4).closeWithMirror().sketchOnPlane().extrude(C.height).fillet(C.thickness/12);const n=C.thickness/4,r=C.height/10,o=ko(n,r,[0,0,C.height],[0,0,1]);e=e.fuse(o),e=e.shell(C.thickness/50,u=>u.inPlane("XY",[0,0,C.height+r]));const l=new zo().containsPoint([0,n,C.height]).ofSurfaceType("CYLINDRE").find(e.clone(),{unique:!0}),s=gr(l,-.01*n).faces[0],a=Pn([.75,.25]).halfEllipse(2,.5,.1).close().sketchOnFace(s,"bounds"),h=gr(l,.05*n).faces[0],d=Pn([.75,.25]).halfEllipse(2,.5,.05).close().sketchOnFace(h,"bounds"),c=a.loftWith(d,{});return e.fuse(c).scale(.001)}catch(e){console.log(e);return}}let Mu={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:12e3},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:4300},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:15},webWidth:{displayName:"Web Width",typeSchema:{type:"Number"},defaultValue:600},girtHeight:{displayName:"Girt Height",typeSchema:{type:"Number"},defaultValue:102},purlinHeight:{displayName:"Purlin Height",typeSchema:{type:"Number"},defaultValue:102},webMemberItemName:{displayName:"Web Member Item",typeSchema:{type:"String"},defaultValue:"C10019"}};const Cu=new Ae({typeName:"OpenWebColumnRafterSection",displayName:"Open Web Column Rafter Section",propertiesSchema:Mu}),vu=Cu;class Tu{constructor(){this.componentType=vu}create(e,n,r,o,l){return new ku(n,r,o,l)}}let Jl=new Tu;Be(Jl);class ku{constructor(e,n,r,o){this.type=Jl,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;const l=new zs({span:()=>e.span,height:()=>e.height,pitch:()=>e.pitch,webMemberWidth:()=>e.webWidth,girtHeight:()=>e.girtHeight,purlinHeight:()=>e.purlinHeight,nestingMemberProperties:()=>{let s=yt[e.webMemberItemName];return{itemName:e.webMemberItemName.substring(0,4)+" Nesting Channel",webSize:s.webSize,flangeSize:s.flangeSize,lipSize:0,thickness:s.thickness}},webMemberProperties:()=>{let s=yt[e.webMemberItemName];return{itemName:e.webMemberItemName,webSize:s.webSize,flangeSize:s.flangeSize,lipSize:s.lipSize,thickness:s.thickness}},flatProperties:()=>({itemName:"Flat Bar 50x10",width:50,thickness:10})});this.components=l.components,this.properties=()=>[{displayName:"Properties",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:s=>n("span",s)}),se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:s=>n("pitch",s)}),se({displayName:()=>"Web Width",value:()=>e.webWidth,setValue:s=>n("webWidth",s)}),se({displayName:()=>"Girt Height",value:()=>e.girtHeight,setValue:s=>n("girtHeight",s)}),se({displayName:()=>"Purlin Height",value:()=>e.purlinHeight,setValue:s=>n("purlinHeight",s)}),ft({displayName:()=>"Web Member",value:()=>e.webMemberItemName,setValue:s=>n("webMemberItemName",s),possibleValues:t(()=>Object.keys(yt))})],expanded:()=>!0}]}}let Re=50;class zu{constructor(e){let n=t(()=>Math.max(e.plateProfile().profile.webSize,Math.max(e.studProfile().profile.webSize,e.braceProfile().profile.webSize))),r=e.dimpleDistFromEnd,o=t(()=>e.plateProfile().profile.flangeSize),l=t(()=>e.studProfile().profile.flangeSize),s=t(()=>[...e.midHeights()].sort(({x:W},{x:D})=>W-D)),a=t(()=>[{x:0,height:e.leftHeight()},...s(),{x:e.length(),height:e.rightHeight()}]),h=t(()=>{let W=Math.max(e.leftHeight(),e.rightHeight());for(let D of e.midHeights())D.height>W&&(W=D.height);return W}),d=W=>{let D=s(),H={x:0,height:e.leftHeight()},X;for(let B of D){if(W<B.x){X=B;break}H=B}X==null&&(X={x:e.length(),height:e.rightHeight()});let Z=X.x-H.x,U=X.height-H.height;return H.height+(W-H.x)*U/Z},c=W=>{let D=s(),H={x:0,height:e.leftHeight()},X;for(let oe of D){if(W<oe.x){X=oe;break}H=oe}X==null&&(X={x:e.length(),height:e.rightHeight()});let Z=X.x-H.x,U=X.height-H.height,B=Math.sqrt(Z*Z+U*U),j=Math.abs(Z)/B;return H.height+(W-H.x)*U/Z-e.plateProfile().profile.dimpleDistFromWeb/j};t(()=>d(0)),t(()=>d(e.length()));let u=t(()=>ni.fromPointAndNormal(f.zero,f.unitY)),S=t(()=>ni.fromPointAndNormal(f.create(0,e.plateProfile().profile.dimpleDistFromWeb),f.unitY)),b=t(()=>ni.fromPointAndNormal(f.zero,f.unitX)),N=t(()=>ni.fromPointAndNormal(f.create(e.length(),0),f.negUnitX));t(()=>ni.fromPointAndNormal(f.create(e.studProfile().profile.dimpleDistFromWeb,0),f.unitX)),t(()=>ni.fromPointAndNormal(f.create(e.length()-e.studProfile().profile.dimpleDistFromWeb,0),f.negUnitX));let w=t(()=>{let W=[],D=a();for(let H=0;H<D.length-1;++H){let X=D[H],Z=D[H+1],U=X.x-Z.x,B=X.height-Z.height,j=Math.sqrt(U*U+B*B),oe=U/j,ae=-(B/j),be=oe;W.push(ni.fromPointAndNormal(f.create(X.x,X.height),f.create(ae,be)))}return W}),p=t(()=>w().map(W=>W.moveInNormalDirection(e.plateProfile().profile.dimpleDistFromWeb))),g=t(()=>{let W=p(),D=b(),H=N(),X=[];for(let Z=0;Z<W.length;++Z){let U=W[Z],B,j;Z==0?B=D:B=W[Z-1],Z==W.length-1?j=H:j=W[Z+1];let oe=U.intersection(j),ie=B.intersection(U);oe==null||ie==null?X.push(void 0):X.push($e.create(oe,ie))}return X}),P=t(()=>$e.create(f.create(0,e.plateProfile().profile.dimpleDistFromWeb),f.create(e.length(),e.plateProfile().profile.dimpleDistFromWeb))),M=t(()=>{let W=w();if(W.length==0)return;let H=W[0].intersection(b());if(H==null)return;let X=b().intersection(u());if(X==null)return;let Z=f.create(e.studProfile().profile.dimpleDistFromWeb,0);return $e.create(H.add(Z),X.add(Z)).extendLength(-e.studClearanceFromPlate(),-e.studClearanceFromPlate())}),v=t(()=>{let W=w();if(W.length==0)return;let D=W[W.length-1],H=N().intersection(u());if(H==null)return;let X=D.intersection(N());if(X==null)return;let Z=f.create(-e.studProfile().profile.dimpleDistFromWeb,0);return $e.create(H.add(Z),X.add(Z)).extendLength(-e.studClearanceFromPlate(),-e.studClearanceFromPlate())}),k=t(()=>{let W=[],D=e.plateProfile(),H=e.studProfile();for(let X of e.openingCutOuts()){let Z=X.pos.x-H.profile.dimpleDistFromWeb,U=X.pos.x+X.width+H.profile.dimpleDistFromWeb,B;switch(X.frameOptions.studType.type){case"Single Stud":B=[$e.create(f.create(Z,e.studClearanceFromPlate()),f.create(Z,d(Z)-e.studClearanceFromPlate())),$e.create(f.create(U,d(U)-e.studClearanceFromPlate()),f.create(U,e.studClearanceFromPlate()))];break;case"Boxed Stud":{B=[$e.create(f.create(Z,e.studClearanceFromPlate()),f.create(Z,d(Z)-e.studClearanceFromPlate())),$e.create(f.create(Z,d(Z)-e.studClearanceFromPlate()),f.create(Z,e.studClearanceFromPlate())),$e.create(f.create(U,d(U)-e.studClearanceFromPlate()),f.create(U,e.studClearanceFromPlate())),$e.create(f.create(U,e.studClearanceFromPlate()),f.create(U,d(U)-e.studClearanceFromPlate()))];break}case"Triple Stud":{B=[$e.create(f.create(Z,e.studClearanceFromPlate()),f.create(Z,d(Z)-e.studClearanceFromPlate())),$e.create(f.create(Z,d(Z)-e.studClearanceFromPlate()),f.create(Z,e.studClearanceFromPlate())),$e.create(f.create(Z-l(),e.studClearanceFromPlate()),f.create(Z-l(),d(Z-l())-e.studClearanceFromPlate())),$e.create(f.create(U,d(U)-e.studClearanceFromPlate()),f.create(U,e.studClearanceFromPlate())),$e.create(f.create(U,e.studClearanceFromPlate()),f.create(U,d(U)-e.studClearanceFromPlate())),$e.create(f.create(U+l(),d(U+l())-e.studClearanceFromPlate()),f.create(U+l(),e.studClearanceFromPlate()))];break}case"Cee":{let Se=X.frameOptions.studType.itemName,Le=yt[Se];if(Le==null)B=[];else{let Xe=X.pos.x-Le.webSize-H.profile.dimpleDistFromWeb,Ke=X.pos.x+X.width+Le.webSize+H.profile.dimpleDistFromWeb;B=[$e.create(f.create(Xe,D.profile.dimpleDistFromWeb-r()),f.create(Xe,c(Xe)+r())),$e.create(f.create(Ke,c(Ke)+r()),f.create(Ke,D.profile.dimpleDistFromWeb-r()))]}break}}let j;if(X.frameOptions.headType.type=="Cee"){let Se=X.frameOptions.headType.itemName;j=yt[Se]}else j=void 0;let oe=X.pos.y+X.height,ie;if(X.frameOptions.headType.type=="Cee"&&j!=null){let Se=Math.min(d(X.pos.x),d(X.pos.x+X.width))-j.webSize;ie=[$e.create(f.create(X.pos.x-(X.frameOptions.studType.type=="Cee"?0:l()),oe+D.profile.dimpleDistFromWeb),f.create(X.pos.x+X.width+(X.frameOptions.studType.type=="Cee"?0:l()),oe+D.profile.dimpleDistFromWeb)),$e.create(f.create(X.pos.x+X.width+(X.frameOptions.studType.type=="Cee"?0:l()),Se-D.profile.dimpleDistFromWeb),f.create(X.pos.x-(X.frameOptions.studType.type=="Cee"?0:l()),Se-D.profile.dimpleDistFromWeb))]}else ie=[$e.create(f.create(X.pos.x-l(),oe+D.profile.dimpleDistFromWeb),f.create(X.pos.x+X.width+l(),oe+D.profile.dimpleDistFromWeb))];if(X.frameOptions.studType.type=="Cee"){let Se;if(X.frameOptions.headType.type=="Cee"&&j!=null){let Ke=Math.min(d(X.pos.x),d(X.pos.x+X.width))-j.webSize-D.profile.dimpleDistFromWeb;Se=Nt=>Ke}else Se=c;let Le=X.pos.x+H.profile.dimpleDistFromWeb,Xe=X.pos.x+X.width-H.profile.dimpleDistFromWeb;B.push($e.create(f.create(Le,Se(Le)),f.create(Le,oe+D.profile.dimpleDistFromWeb)).extendLength(r(),r()),$e.create(f.create(Xe,oe+D.profile.dimpleDistFromWeb),f.create(Xe,Se(Le))).extendLength(r(),r()))}let ae;X.pos.y>o()?X.frameOptions.studType.type=="Cee"?ae=$e.create(f.create(X.pos.x+X.width,X.pos.y-D.profile.dimpleDistFromWeb),f.create(X.pos.x,X.pos.y-D.profile.dimpleDistFromWeb)):ae=$e.create(f.create(X.pos.x+X.width+l(),X.pos.y-D.profile.dimpleDistFromWeb),f.create(X.pos.x-l(),X.pos.y-D.profile.dimpleDistFromWeb)):ae=void 0;let be=[],we=[];{let Se=X.pos.x-H.profile.dimpleDistFromWeb,Le=X.pos.x+X.width+H.profile.dimpleDistFromWeb,Xe;if(X.frameOptions.headType.type=="Cee"&&j!=null){let Jt=Math.min(d(X.pos.x),d(X.pos.x+X.width))-j.webSize-D.profile.dimpleDistFromWeb;Xe=ei=>Jt}else Xe=c;let Ke=Le-Se,Nt=Math.ceil(Ke/e.studCentres()),fi=Ke/Nt,qt=Nt-1;we.push(Se);for(let Jt=0;Jt<qt;++Jt){let ei=Se+(Jt+1)*fi;we.push(ei);let Bi=$e.create(f.create(ei,Xe(ei)+D.profile.dimpleDistFromWeb-e.studClearanceFromPlate()),f.create(ei,oe+D.profile.dimpleDistFromWeb-D.profile.dimpleDistFromWeb+e.studClearanceFromPlate()));be.push(Bi)}we.push(Le)}let ke=[];if(X.pos.y>o())for(let Se=1;Se<we.length-1;++Se){let Le=we[Se],Xe=$e.create(f.create(Le,X.pos.y-e.studClearanceFromPlate()),f.create(Le,e.studClearanceFromPlate()));ke.push(Xe)}let Ve=[];if(X.frameOptions.headType.type=="Trussed Header")for(let Se=0;Se<we.length-1;++Se){let Le=we[Se+1]-Re,Xe=we[Se]+Re,Ke;Ke=Se<we.length>>1?"Up Right":"Down Right";let Nt;switch(Ke){case"Up Right":{Nt=$e.create(f.create(Le,c(Le)),f.create(Xe,oe+D.profile.dimpleDistFromWeb)).extendLength(r(),r());break}case"Down Right":{Nt=$e.create(f.create(Le,oe+D.profile.dimpleDistFromWeb),f.create(Xe,c(Xe))).extendLength(r(),r());break}}Ve.push(Nt)}W.push({openingId:X.id,studDimpleLines:B,headerDimpleLines:ie,sillDimpleLine:ae,headerStudsDimpleLines:be,headerBraceDimpleLines:Ve,sillStudsDimpleLines:ke,rangeX:{minX:Z,maxX:U}})}return W.sort(({rangeX:{minX:X}},{rangeX:{minX:Z}})=>X-Z),W}),z=t(()=>k().flatMap(({studDimpleLines:W})=>W)),x=t(()=>k().flatMap(({headerDimpleLines:W})=>W)),A=t(()=>k().flatMap(({sillDimpleLine:W})=>Pe(W))),I=t(()=>k().flatMap(({headerStudsDimpleLines:W})=>W)),O=t(()=>k().flatMap(({headerBraceDimpleLines:W})=>W)),E=t(()=>k().flatMap(({sillStudsDimpleLines:W})=>W)),F=t(()=>{let W=Lt.single(e.studProfile().profile.dimpleDistFromWeb,e.length()-e.studProfile().profile.dimpleDistFromWeb);for(let{rangeX:D}of k())W=W.subtract(Lt.single(D.minX,D.maxX));return W}),$=t(()=>{let W=[],D=F();for(let H of D.ranges){let X=H.from,U=H.to-X,B=Math.ceil(U/e.studCentres()),j=B-1,oe;switch(e.studCentreType()){case"Max":{oe=U/B;break}case"Exact":{oe=e.studCentres();break}}for(let ie=0;ie<j;++ie)W.push(X+(ie+1)*oe)}return W}),G=t(()=>$().flatMap(W=>{let D=ni.fromPointAndNormal(f.create(W,0),f.unitX),H=f.create(W,c(W)),X=D.intersection(S());return X==null?[]:[$e.create(H,X).extendLength(e.plateProfile().profile.dimpleDistFromWeb-e.studClearanceFromPlate(),e.plateProfile().profile.dimpleDistFromWeb-e.studClearanceFromPlate())]})),J=t(()=>{let W=0,X=(h()-W)/(e.numNoggins()+1),Z=[];for(let U=0;U<e.numNoggins();++U){let B=U,j=W+(U+1)*X,oe=Lt.single(0,e.length());for(let ie of e.openingCutOuts())if(ie.pos.y<j&&j<=ie.pos.y+ie.height){let ae;ie.frameOptions.studType.type=="Cee"?ae=yt[ie.frameOptions.studType.itemName]:ae=void 0;let be;ae==null?be=Lt.single(ie.pos.x,ie.pos.x+ie.width):be=Lt.single(ie.pos.x-ae.webSize,ie.pos.x+ie.width+ae.webSize),oe=oe.subtract(be)}for(let ie of oe.ranges){let ae=f.create(ie.to,j),be=f.create(ie.from,j);Z.push({line:$e.create(ae,be),precutIndex:B})}}return Z}),K=t(()=>J().map(({line:W})=>W));this.insertPanelBraceWall=t(()=>{let W=M(),D=v(),H=G(),X=P(),Z=g(),U=J(),B=[];if(W!=null){{let oe=W.intersectOtherLine(X);oe!=null&&(B.push({id:"LeftStud_BasePlate_Right",location:oe.add(f.create(Re,0))}),B.push({id:"LeftStud_BasePlate_Up",location:oe.add(f.create(0,Re))}))}for(let oe of U){let ie=W.intersectOtherLine(oe.line),ae=oe.precutIndex;ie!=null&&(B.push({id:"LeftStud_Noggin"+(ae+1)+"_Right",location:ie.add(f.create(Re,0))}),B.push({id:"LeftStud_Noggin"+(ae+1)+"_Down",location:ie.add(f.create(0,-Re))}),B.push({id:"LeftStud_Noggin"+(ae+1)+"_Up",location:ie.add(f.create(0,Re))}))}{let oe=0;for(let ie of Z){if(ie!=null){let ae=W.intersectOtherLine(ie);ae!=null&&(B.push({id:"LeftStud_TopPlate"+(oe+1)+"_Right",location:ae.add(f.create(Re,0))}),B.push({id:"LeftStud_TopPlate"+(oe+1)+"_Down",location:ae.add(f.create(0,-Re))}))}++oe}}}let j=0;for(let oe of H){{let ie=oe.intersectOtherLine(X);ie!=null&&(B.push({id:"MidStud"+j+"_BasePlate_Left",location:ie.add(f.create(-Re,0))}),B.push({id:"MidStud"+j+"_BasePlate_Right",location:ie.add(f.create(Re,0))}),B.push({id:"MidStud"+j+"_BasePlate_Up",location:ie.add(f.create(0,Re))}))}for(let ie of U){let ae=oe.intersectOtherLine(ie.line),be=ie.precutIndex,we="MidStud"+j+"_Noggin"+be+"_";ae!=null&&(B.push({id:we+"Left",location:ae.add(f.create(-Re,0))}),B.push({id:we+"Right",location:ae.add(f.create(Re,0))}),B.push({id:we+"Down",location:ae.add(f.create(0,-Re))}),B.push({id:we+"Right",location:ae.add(f.create(0,Re))}))}{let ie=0;for(let ae of Z){if(ae!=null){let be="MidStud"+j+"_TopPlate"+ie+"_",we=oe.intersectOtherLine(ae);we!=null&&(B.push({id:be+"Left",location:we.add(f.create(-Re,0))}),B.push({id:be+"Right",location:we.add(f.create(Re,0))}),B.push({id:be+"Down",location:we.add(f.create(0,-Re))}))}++ie}}++j}if(D!=null){{let oe=D.intersectOtherLine(X);oe!=null&&(B.push({id:"RightStud_BasePlate_Left",location:oe.add(f.create(-Re,0))}),B.push({id:"RightStud_BasePlate_Up",location:oe.add(f.create(0,Re))}))}for(let oe of U){let ie=D.intersectOtherLine(oe.line),ae=oe.precutIndex;ie!=null&&(B.push({id:"RightStud_Noggin"+(ae+1)+"_Left",location:ie.add(f.create(-Re,0))}),B.push({id:"RightStud_Noggin"+(ae+1)+"_Down",location:ie.add(f.create(0,-Re))}),B.push({id:"RightStud_Noggin"+(ae+1)+"_Up",location:ie.add(f.create(0,Re))}))}{let oe=0;for(let ie of Z){if(ie!=null){let ae=D.intersectOtherLine(ie);ae!=null&&(B.push({id:"RightStud_TopPlate"+(oe+1)+"_Left",location:ae.add(f.create(-Re,0))}),B.push({id:"RightStud_TopPlate"+(oe+1)+"_Down",location:ae.add(f.create(0,-Re))}))}++oe}}}for(let{openingId:oe,studDimpleLines:ie}of k()){if(ie.length==0)continue;let ae=ie.reduce((we,ke)=>Math.min(we.v1.x,we.v2.x)<Math.min(ke.v1.x,ke.v2.x)?we:ke),be=ie.reduce((we,ke)=>Math.max(we.v1.x,we.v2.x)>Math.max(ke.v1.x,ke.v2.x)?we:ke);for(let{studSide:we,studDimpleLine:ke}of[{studSide:"Left",studDimpleLine:ae},{studSide:"Right",studDimpleLine:be}]){let Ve="Opening_"+oe+"_"+we;{let Se=ke.intersectOtherLine(X);Se!=null&&(B.push({id:Ve+"_BasePlate_Left",location:Se.add(f.create(-Re,0))}),B.push({id:Ve+"_BasePlate_Right",location:Se.add(f.create(Re,0))}),B.push({id:Ve+"_BasePlate_Up",location:Se.add(f.create(0,Re))}))}for(let Se of U){let Le=ke.intersectOtherLine(Se.line),Xe=Se.precutIndex,Ke=Ve+"_Noggin"+Xe+"_";Le!=null&&(B.push({id:Ke+"Left",location:Le.add(f.create(-Re,0))}),B.push({id:Ke+"Right",location:Le.add(f.create(Re,0))}),B.push({id:Ke+"Down",location:Le.add(f.create(0,-Re))}),B.push({id:Ke+"Right",location:Le.add(f.create(0,Re))}))}{let Se=0;for(let Le of Z){if(Le!=null){let Xe="MidStud"+j+"_TopPlate"+Se+"_",Ke=ke.intersectOtherLine(Le);Ke!=null&&(B.push({id:Xe+"Left",location:Ke.add(f.create(-Re,0))}),B.push({id:Xe+"Right",location:Ke.add(f.create(Re,0))}),B.push({id:Xe+"Down",location:Ke.add(f.create(0,-Re))}))}++Se}}}}return{location:We.nil(),thickness:n(),space:m.identity,points:B}});let te=t(()=>{let W=this.insertPanelBraceWall(),D={};for(let X of W.points)D[X.id]=X.location;let H=[];for(let X of e.braces()){let Z=D[X.fromId];if(Z==null)continue;let U=D[X.toId];U!=null&&H.push({id:X.id,dimpleLine:$e.create(Z,U).extendLength(e.dimpleDistFromEnd(),e.dimpleDistFromEnd())})}return H});t(()=>te().map(({dimpleLine:W})=>W));let _=t(()=>g().flatMap((W,D)=>{if(W==null)return[];let H;D==0?H=M():H=g()[D-1];let X;D==g().length-1?X=v():X=g()[D+1];let Z=!0,U=Ot(W,Z,[...Pe(H),...Pe(X),...G()]),B="TC"+(1+D);return[Ft({subKitCreator:e.subKitCreator,id:B,dimpleLine:W,profile:e.plateProfile(),inverted:Z,maxWebSize:n(),flangePunches:()=>U,localLabel:()=>B,usage:()=>"Top Chord"})]})),Y=t(()=>{let W=!1,D=Ot(P(),W,[...g().flatMap(X=>X==null?[]:[X]),...Pe(M()),...Pe(v()),...G()]),H="BC1";return Ft({subKitCreator:e.subKitCreator,id:H,dimpleLine:P(),profile:e.plateProfile(),inverted:W,maxWebSize:n(),flangePunches:()=>D,localLabel:()=>H,usage:()=>"Bottom Chord"})}),ee=t(()=>{let W=M();if(W==null)return;let D=!0,H=Ot(W,D,[...g().flatMap(Z=>Z==null?[]:[Z]),P(),...K()]),X="S1";return Ft({subKitCreator:e.subKitCreator,id:X,dimpleLine:W,profile:e.studProfile(),inverted:D,maxWebSize:n(),flangePunches:()=>H,localLabel:()=>"S1",usage:()=>"Stud"})}),ce=t(()=>{let W=v();if(W==null)return;let D=!1,H=Ot(W,D,[...g().flatMap(Z=>Z==null?[]:[Z]),P(),...K()]),X="S"+(2+G().length);return Ft({subKitCreator:e.subKitCreator,id:X,dimpleLine:W,profile:e.studProfile(),inverted:D,maxWebSize:n(),flangePunches:()=>H,localLabel:()=>X,usage:()=>"Stud"})}),Ce=t(()=>z().map((W,D)=>{let H=W.v2.y<W.v1.y,X=Ot(W,H,[...g().flatMap(U=>U==null?[]:[U]),P(),...K()]),Z="DS"+(D+1);return Ft({subKitCreator:e.subKitCreator,id:Z,dimpleLine:W,profile:e.studProfile(),inverted:H,maxWebSize:n(),flangePunches:()=>X,localLabel:()=>Z,usage:()=>"Stud"})})),Ue=t(()=>x().map((W,D)=>{let H=!1,X=Ot(W,H,[...z()]),Z=Zi(W,H,e.plateProfile().profile,z().map(B=>({dimpleLine:B,params:e.studProfile().profile})),5),U="DH"+(D+1);return Ft({subKitCreator:e.subKitCreator,id:U,dimpleLine:W,profile:e.plateProfile(),inverted:H,maxWebSize:n(),flangePunches:()=>X,webNotchRanges:()=>Z,localLabel:()=>U,usage:()=>"Header"})})),Q=t(()=>A().map((W,D)=>{let H=!0,X=Ot(W,H,[...z()]),Z="DSL"+(D+1);return Ft({subKitCreator:e.subKitCreator,id:Z,dimpleLine:W,profile:e.plateProfile(),inverted:H,maxWebSize:n(),flangePunches:()=>X,localLabel:()=>Z,usage:()=>"Sill"})})),R=t(()=>I().map((W,D)=>{let H=!1,X=Ot(W,H,[...g().flatMap(U=>Pe(U)),...x()]),Z="DHS"+(D+1);return Ft({subKitCreator:e.subKitCreator,id:Z,dimpleLine:W,profile:e.studProfile(),inverted:H,maxWebSize:n(),flangePunches:()=>X,localLabel:()=>Z,usage:()=>"Door Head Stud"})})),V=t(()=>O().map((W,D)=>{let H=!1,X=Ot(W,H,[...g().flatMap(B=>Pe(B)),...x()]),Z=Zi(W,H,e.braceProfile().profile,[...g().flatMap(Pe),...x()].map(B=>({dimpleLine:B,params:e.plateProfile().profile})),5),U="DHB"+(D+1);return Ft({subKitCreator:e.subKitCreator,id:U,dimpleLine:W,profile:e.plateProfile(),inverted:H,maxWebSize:n(),flangePunches:()=>X,webNotchRanges:()=>Z,localLabel:()=>U,usage:()=>"Door Head Brace"})})),L=t(()=>E().map((W,D)=>{let H=!1,X=Ot(W,H,[P(),...A()]),Z="DSLS"+(D+1);return Ft({subKitCreator:e.subKitCreator,id:Z,dimpleLine:W,profile:e.studProfile(),inverted:H,maxWebSize:n(),flangePunches:()=>X,usage:()=>"Door Sill Studs"})})),ne=t(()=>e.openingCutOuts().flatMap(W=>{if(W.frameOptions.studType.type!="Cee")return[];let D=W.frameOptions.studType.itemName,H=yt[D];if(H==null)return[];let X=H,Z=d(W.pos.x),U=d(W.pos.x+W.width);return[e.subKitCreator.mkKit({id:W.id+"_LeftCeeStud",kitType:Oe,state:{itemName:()=>D,length:()=>Z},space:t(()=>m.create(i.create(W.pos.x-X.webSize,0,0),y.fromWU(i.unitY,i.unitZ)))})(),e.subKitCreator.mkKit({id:W.id+"_RightCeeStud",kitType:Oe,state:{itemName:()=>D,length:()=>U},space:t(()=>m.create(i.create(W.pos.x+W.width,0,0),y.fromWU(i.unitY,i.unitZ)))})()]})),he=t(()=>e.openingCutOuts().flatMap(W=>{if(W.frameOptions.headType.type!="Cee")return[];let D=W.frameOptions.headType.itemName;if(yt[D]==null)return[];let X=W.width;return[e.subKitCreator.mkKit({id:W.id+"_CeeHead",kitType:Oe,state:{itemName:()=>D,length:()=>X},space:t(()=>m.create(i.create(W.pos.x,0,Math.min(d(W.pos.x),d(W.pos.x+W.width))),y.fromWU(i.unitY,i.unitX)))})()]})),le=t(()=>G().map((W,D)=>{let H=!0,X=Ot(W,H,[...g().flatMap(U=>U==null?[]:[U]),P(),...K()]),Z="S"+(2+D);return Ft({subKitCreator:e.subKitCreator,id:Z,dimpleLine:W,profile:e.studProfile(),inverted:H,maxWebSize:n(),flangePunches:()=>X,localLabel:()=>Z,usage:()=>"Stud"})})),me=t(()=>K().map((W,D)=>{let H=!0,X=Ot(W,H,[...Pe(M()),...G(),...Pe(v())]),Z=e.studProfile(),U=Zi(W,H,e.plateProfile().profile,[...[...Pe(M()),...G(),...Pe(v()),...z()].map(j=>({dimpleLine:j,params:Z.profile}))],5),B="N"+(1+D);return Ft({subKitCreator:e.subKitCreator,id:B,dimpleLine:W,profile:e.plateProfile(),inverted:H,maxWebSize:n(),flangePunches:()=>X,webNotchRanges:()=>U,localLabel:()=>B,usage:()=>"Noggin"})})),ye=t(()=>te().map(({id:W,dimpleLine:D},H)=>{let X=!1,Z=Ot(D,X,[...Pe(M()),...G(),...Pe(v()),...z(),P(),...g().flatMap(Pe),...K()]),U=Zi(D,X,e.braceProfile().profile,[...Pe(M()),...G(),...Pe(v())].map(B=>({dimpleLine:B,params:e.studProfile().profile})),5);return Ft({subKitCreator:e.subKitCreator,id:W,componentId:W,dimpleLine:D,profile:e.braceProfile(),inverted:X,maxWebSize:n(),localLabel:()=>"B"+(1+H),usage:()=>"Brace",flangePunches:()=>Z,webNotchRanges:()=>U})}));this.kits=t(()=>[..._().flatMap(Pe),...Pe(Y()),...Pe(ee).flatMap(W=>Pe(W())),...Pe(ce).flatMap(W=>Pe(W())),...Ce().flatMap(Pe),...Ue().flatMap(Pe),...Q().flatMap(Pe),...R().flatMap(Pe),...V().flatMap(Pe),...L().flatMap(Pe),...ne().flatMap(Pe),...he().flatMap(Pe),...le().flatMap(Pe),...me().flatMap(Pe),...ye().flatMap(Pe)]),this.components=t(()=>this.kits().flatMap(({id:W,kit:D,space:H})=>(D.components?.call(void 0)??[]).map(X=>new T({...X,transform:t(()=>(H?.call(void 0)??m.identity).fromThisSpace(X.transform?.call(void 0)??m.identity))})))),this.braceComponents=t(()=>ye().flatMap(Pe).flatMap(({id:W,kit:D,space:H})=>(D.components?.call(void 0)??[]).map(X=>new T({...X,transform:t(()=>(H?.call(void 0)??m.identity).fromThisSpace(X.transform?.call(void 0)??m.identity))})))),this.mkFrameForDoc=()=>t(()=>({components:this.components(),dimensionStrings:[{space:m.create(i.create(0,0,-300),y.fromUV(i.unitX,i.unitZ)),markers:[0,e.length()]},{space:m.create(i.create(e.length()+200,0,0),y.fromUV(i.unitZ,i.negUnitX)),markers:[0,e.rightHeight()]}]}))}}let Au={length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:3e3},leftHeight:{displayName:"Left Height",typeSchema:{type:"Number"},defaultValue:2400},rightHeight:{displayName:"Right Height",typeSchema:{type:"Number"},defaultValue:2400},midHeights:{displayName:"Mid Heights",typeSchema:{type:"Array",elemTypeSchema:{type:"Object",properties:{x:{displayName:"X",typeSchema:{type:"Number"},defaultValue:0},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:0}}}},defaultValue:[]},numNoggins:{displayName:"Num Noggins",typeSchema:{type:"Number"},defaultValue:1},studCentres:{displayName:"Stud Centres",typeSchema:{type:"Number"},defaultValue:600},studCentreType:{displayName:"Stud Centre Type",typeSchema:{type:"String",possibleValues:["Max","Exact"]},defaultValue:"Max"},dimpleDistFromEnd:{displayName:"Dimple Dist From End",typeSchema:{type:"Number"},defaultValue:12},studClearanceFromPlate:{displayName:"Stud Clearance From Plate",typeSchema:{type:"Number"},defaultValue:5,optional:!0},external:{displayName:"External?",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},loadBearing:{displayName:"Load Bearing?",typeSchema:{type:"Boolean"},defaultValue:!1,optional:!0},machineName:{displayName:"Machine Name",typeSchema:{type:"String"},defaultValue:"",optional:!0},plateProfileDesc:{displayName:"Plate",typeSchema:{type:"String"},defaultValue:"Plate",optional:!0},studProfileDesc:{displayName:"Stud",typeSchema:{type:"String"},defaultValue:"Stud",optional:!0},braceProfileDesc:{displayName:"Brace",typeSchema:{type:"String"},defaultValue:"Plate",optional:!0},dimplePunchDesc:{displayName:"Dimple",typeSchema:{type:"String"},defaultValue:"Dimple",optional:!0},notchPunchDesc:{displayName:"Notch",typeSchema:{type:"String"},defaultValue:"Notch",optional:!0},openings:{displayName:"Openings",typeSchema:{type:"Array",elemTypeSchema:fr},defaultValue:[],optional:!0},braces:{displayName:"Braces",typeSchema:{type:"Array",elemTypeSchema:{type:"Object",properties:{id:{displayName:"Id",typeSchema:{type:"String"},defaultValue:""},fromId:{displayName:"From Id",typeSchema:{type:"String"},defaultValue:""},toId:{displayName:"To Id",typeSchema:{type:"String"},defaultValue:""}}}},defaultValue:[],optional:!0}};const xu=new Ae({typeName:"PanelWallFrame",displayName:"Panel Wall Frame",propertiesSchema:Au}),Iu=xu;class Bu{constructor(){this.componentType=Iu}create(e,n,r,o,l){return new Ou(e,n,r,o,l)}}let eo=new Bu;Be(eo);class Ou{constructor(e,n,r,o,l){this.type=eo,this.state=n,this.setState=r,this.kitsUserEdits=o,this.setKitsUserEdits=l,this.updateOpeningFrameOptions=()=>{At(()=>{for(let P=0;P<n.openings.length;++P){let M=Cn(n.openings[P].width,n.external,n.loadBearing);r("openings",P,"frameOptions",M)}})};let s=P=>t(()=>{let M=P(),v=vn[M];return v==null?Wt('Profile named "'+M+'" not found.'):ki(v)}),a=s(()=>n.plateProfileDesc),h=s(()=>n.studProfileDesc),d=s(()=>n.braceProfileDesc),c=t(()=>{let P=a();if(P.type=="Err")return P;let M=h();if(M.type=="Err")return M;let v=d();return v.type=="Err"?v:ki(Math.max(P.value.webSize,Math.max(M.value.webSize,v.value.webSize)))}),u=t(()=>{let P;{let z=a();if(z.type=="Err")return z;P=z.value}let M;{let z=h();if(z.type=="Err")return z;M=z.value}let v;{let z=d();if(z.type=="Err")return z;v=z.value}let k=t(()=>{let z=[];for(let x of n.openings){let A;switch(x.posX.type){case"Centre":A=.5*n.length-.5*x.width;break;case"Left":A=x.posX.dist;break;case"Right":A=n.length-x.posX.dist-x.width;break}let I=x.headHeight-x.height,O={studType:x.frameOptions?.studType??{type:"Single Stud"},headType:x.frameOptions?.headType??{type:"Single Plate"}};z.push({id:x.id,openingType:x.type,pos:f.create(A,I),width:x.width,height:x.height,frameOptions:O})}return z});return ki(new zu({subKitCreator:new ll({kitsUserEdits:o,setKitsUserEdits:l}),length:()=>n.length,leftHeight:()=>n.leftHeight,rightHeight:()=>n.rightHeight,midHeights:()=>n.midHeights,numNoggins:()=>n.numNoggins,studCentres:()=>n.studCentres,studCentreType:()=>n.studCentreType,dimpleDistFromEnd:()=>n.dimpleDistFromEnd,studClearanceFromPlate:()=>n.studClearanceFromPlate,plateProfile:t(()=>({itemName:n.plateProfileDesc,profile:P})),studProfile:t(()=>({itemName:n.studProfileDesc,profile:M})),braceProfile:t(()=>({itemName:n.braceProfileDesc,profile:v})),openingCutOuts:k,braces:()=>n.braces}))}),S=t(()=>"PanelWallFrame_"+e);this.kits=t(()=>{let P=u();return P.type=="Err"?[]:P.value.kits()}),this.components=t(()=>{let P=u();if(P.type=="Err"){let M=P.message;return[new T({itemName:t(()=>"Error: "+M),length:()=>n.length,timberProperties:t(()=>new et({webSize:n.leftHeight,flangeSize:80})),colour:()=>"Manor Red",transform:t(()=>m.create(i.create(0,80,0),y.fromUV(i.unitX,i.unitZ)))})]}else return[new T({kitTag:()=>"PanelWallFrame",labelKey:S,children:P.value.components})]}),this.errors=t(()=>{let P=u();return P.type=="Err"?[P.message]:[]}),this.allocateLabels=P=>{P.genPrefixedLabelForKey({prefix:"W",key:S()})},this.insertOpeningWalls=t(()=>[{location:We.nil(),space:m.identity,outline:[f.create(0,0),f.create(n.length,0),f.create(n.length,n.rightHeight),f.create(0,n.leftHeight)],bays:[{size:n.length,minLeftDist:300,minRightDist:300}],reverseBayIndices:!1}]),this.insertOpening=t(()=>P=>{let M=Cn(P.width,n.external,n.loadBearing),v={...P,frameOptions:M};r("openings",[...n.openings,v])}),this.insertPanelBraceWalls=t(()=>{let P=u();return P.type=="Err"?[]:[P.value.insertPanelBraceWall()]}),this.insertPanelBrace=t(()=>({location:P,fromId:M,toId:v})=>{if(P.head()!=null)return;let k=zt();r("braces",[...n.braces,{id:k,fromId:M,toId:v}])});let b=P=>n.openings.find(M=>M.id==P),N=(P,M)=>{r("openings",n.openings.map(v=>v.id!=P?v:M(v)))},w=t(()=>n.openings.map(P=>{let M;switch(P.posX.type){case"Centre":M=.5*n.length-.5*P.width;break;case"Left":M=P.posX.dist;break;case"Right":M=n.length-P.posX.dist-P.width;break}let v=M+P.width,k=new Vt({minX:M,maxX:v,minY:-200,maxY:200,minZ:P.headHeight-P.height,maxZ:P.headHeight}),z=()=>b(P.id),x=()=>z()?.frameOptions,A=t(()=>x()?.studType?.type??"Single Stud"),I=t(()=>x()?.headType?.type??"Single Plate"),O=_=>{let Y;switch(_){case"Single Stud":Y={type:"Single Stud"};break;case"Boxed Stud":Y={type:"Boxed Stud"};break;case"Triple Stud":Y={type:"Triple Stud"};break;case"Cee":Y={type:"Cee",itemName:"C20024"};break}let ee=x(),ce;ee==null?ce={studType:Y}:ce={...ee,studType:Y},N(P.id,Ce=>({...Ce,frameOptions:ce}))},E=_=>{let Y;switch(_){case"Single Plate":Y={type:"Single Plate"};break;case"Trussed Header":Y={type:"Trussed Header"};break;case"Cee":Y={type:"Cee",itemName:"C20024"};break}let ee=x(),ce;ee==null?ce={headType:Y}:ce={...ee,headType:Y},N(P.id,Ce=>({...Ce,frameOptions:ce}))},F=t(()=>A()=="Cee"),$=t(()=>I()=="Cee"),G=t(()=>{let _=x();return _?.studType?.type!="Cee"?"":_.studType.itemName}),J=t(()=>{let _=x();return _?.headType?.type!="Cee"?"":_.headType.itemName}),K=_=>{let Y=x(),ee;Y==null?ee={studType:{type:"Cee",itemName:_}}:ee={...Y,studType:{type:"Cee",itemName:_}},N(P.id,ce=>({...ce,frameOptions:ee}))},te=_=>{let Y=x(),ee;Y==null?ee={headType:{type:"Cee",itemName:_}}:ee={...Y,headType:{type:"Cee",itemName:_}},N(P.id,ce=>({...ce,frameOptions:ee}))};return{id:()=>P.id,space:()=>m.identity,localAabb:()=>k,properties:t(()=>[{displayName:"Opening",fields:[se({displayName:()=>"Height",value:t(()=>b(P.id)?.height??0),setValue:_=>N(P.id,Y=>({...Y,height:_}))}),se({displayName:()=>"Width",value:t(()=>b(P.id)?.width??0),setValue:_=>N(P.id,Y=>{let ee={...Y,width:_},ce=Cn(ee.width,n.external,n.loadBearing);return{...ee,frameOptions:ce}})}),se({displayName:()=>"Head Height",value:t(()=>b(P.id)?.headHeight??0),setValue:_=>N(P.id,Y=>({...Y,headHeight:_}))})],expanded:()=>!0},{displayName:"Position",fields:[an({displayName:()=>"Pos X Type",value:()=>z()?.posX.type??"Centre",setValue:_=>N(P.id,Y=>{switch(_){case"Centre":return{...Y,posX:{type:"Centre"}};case"Left":return{...Y,posX:{type:"Left",dist:300}};case"Right":return{...Y,posX:{type:"Right",dist:300}}}}),possibleValues:()=>["Centre","Left","Right"]}),...z()?.posX.type=="Left"||z()?.posX.type=="Right"?[se({displayName:()=>"Dist",value:()=>{let _=z()?.posX;return _==null||_.type!="Left"&&_.type!="Right"?300:_.dist},setValue:_=>N(P.id,Y=>{let ee=z()?.posX;return ee==null||ee.type!="Left"&&ee.type!="Right"?Y:{...Y,posX:{...ee,dist:_}}})})]:[]],expanded:()=>!0},{displayName:"Opening Framing",fields:[an({displayName:()=>"Stud Type",value:A,setValue:O,possibleValues:()=>["Single Stud","Boxed Stud","Triple Stud","Cee"]}),...F()?[ft({displayName:()=>"Stud Item",value:G,setValue:K,possibleValues:t(()=>Object.keys(vn))})]:[],an({displayName:()=>"Head Type",value:I,setValue:E,possibleValues:()=>["Single Plate","Trussed Header","Cee"]}),...$()?[ft({displayName:()=>"Head Item",value:J,setValue:te,possibleValues:t(()=>Object.keys(vn))})]:[]],expanded:()=>!0}]),delete:()=>{r("openings",n.openings.filter(({id:_})=>_!=P.id))}}})),p=t(()=>{let P=u();return P.type=="Err"?[]:P.value.braceComponents().flatMap(M=>{if(M.id==null)return[];let v=M.id();return[{id:()=>v,space:t(()=>M.transform==null?m.identity:M.transform()),localAabb:t(()=>{if(M.length==null||M.panelMemberProperties==null)return Vt.empty();let k=5;return new Vt({minX:-k,minY:-k,minZ:-k,maxX:M.length()+k,maxY:M.panelMemberProperties().webSize+k,maxZ:M.panelMemberProperties().flangeSize+k})}),properties:()=>[],actionButtons:()=>[{displayName:()=>"Flip",action:()=>{r("braces",n.braces.map(k=>k.id!=v?k:{...k,fromId:k.toId,toId:k.fromId}))}}],delete:()=>{r("braces",n.braces.filter(({id:k})=>k!=v))}}]})}),g=t(()=>[f.create(n.length,n.rightHeight),...[...n.midHeights].sort((P,M)=>P.x-M.x).reverse().map(P=>f.create(P.x,P.height)),f.create(0,n.leftHeight)]);this.mkFaceToFaceExtendable=({space:P,setSpace:M})=>t(()=>({transform:t(()=>{let v=c(),k;return v.type=="Err"?k=0:k=v.value,P().fromThisSpace(m.create(i.create(0,.5*k,0),y.fromUV(i.unitX,i.unitZ)))}),outlinePts:g,outlineEdges:t(()=>{let v=g(),k=[];for(let z=0;z<v.length-1;++z)k.push({pt1Idx:z,pt2Idx:z+1});return k}),moveOutlinePoint:(v,k)=>{if(v==0)At(()=>{r("length",k.x),r("rightHeight",k.y)});else if(v==n.midHeights.length+1){let z=P();At(()=>{M(m.create(z.origin.add(z.u.scale(k.x)),z.orientation)),r("length",n.length-k.x),r("leftHeight",k.y)})}else{let z=v-1;At(()=>{r("midHeights",z,"x",k.x),r("midHeights",z,"height",k.y)})}},splitOutlineEdge:v=>{let k=n.midHeights.length-1-v,z=[...n.midHeights].sort((E,F)=>E.x-F.x),x=k==-1?{x:0,height:n.leftHeight}:z[k],A=k==n.midHeights.length-1?{x:n.length,height:n.rightHeight}:z[k+1],I={x:.5*(x.x+A.x),height:.5*(x.height+A.height)},O=[...z.slice(0,v),I,...z.slice(v)];return r("midHeights",O),{ptIdx:v+1}},deleteOutlinePt:v=>{if(v==0||v==n.midHeights.length+1)return;let k=n.midHeights.length-1-(v-1),z=[...Ao(n.midHeights)];z.sort((x,A)=>x.x-A.x),z.splice(k,1),r("midHeights",z)},faces:t(()=>{let v=c(),k;v.type=="Err"?k=80:k=v.value;let z=[],x=[f.zero,f.create(n.length,0),f.create(n.length,n.rightHeight),...[...n.midHeights].sort((I,O)=>I.x-O.x).reverse().map(({x:I,height:O})=>f.create(I,O)),f.create(0,n.leftHeight)],A=P().fromThisSpace(m.create(i.zero,y.fromUV(i.unitX,i.unitZ)));for(let I=0;I<x.length;++I){let O=(I+1)%x.length,E=x[I],F=x[O],$=E.distance(F),G=F.sub(E).scale(1/$);if(!Number.isFinite(G.x))continue;let J=[f.zero,f.create(k,0),f.create(k,$),f.create(0,$)],K=m.create(i.create(E.x,E.y,.5*k),y.fromUV(i.negUnitZ,i.create(G.x,G.y,0))),te;if(I==0)te=()=>{};else if(I==1)te=_=>{let Y=P(),ce=Hi.create(Y.o,Y.u).collisionTimeWithPlane(_);ce==null||ce<=0||r("length",ce)};else if(I==x.length-1)te=_=>{let Y=P(),ee=Hi.create(Y.o.add(Y.u.scale(n.length)),Y.u.scale(-1)),ce=ee.collisionTimeWithPlane(_);ce==null||ce<=0||(r("length",ce),M(m.create(ee.positionFromTime(ce),Y.orientation)))};else{let _=(I+(x.length-1))%x.length,Y=I,ee=(I+1)%x.length,ce=(I+2)%x.length,Ce=A.pointFromThisSpace(x[_].toVec3()),Ue=A.pointFromThisSpace(x[Y].toVec3()),Q=A.pointFromThisSpace(x[ee].toVec3()),R=A.pointFromThisSpace(x[ce].toVec3()),V=Hi.create(Ce,Ue.sub(Ce)),L=Hi.create(R,R.sub(Q));te=ne=>{let he=V.collisionWithPlane(ne);if(he==null)return;let le=L.collisionWithPlane(ne);if(le==null)return;let me=A.pointToThisSpace(he).xy(),ye=A.pointToThisSpace(le).xy(),W=n.leftHeight,D=n.rightHeight,H=[...n.midHeights];Y==2?D=me.y:H[Y-3]={x:me.x,height:me.y},ee==x.length-1?W=ye.y:H[ee-3]={x:ye.x,height:ye.y},At(()=>{r("leftHeight",W),r("rightHeight",D),r("midHeights",H)})}}z.push({outline:J,localTransform:K,extendToPlane:te})}return z})})),this.subObjects=t(()=>[...w(),...p()]),this.mkFramesForDoc=P=>t(()=>{let M=u();if(M.type=="Err")return[];let v=M.value.mkFrameForDoc;return[t(()=>({...v()(),frameLabel:P.lookupLabelForKey(S())??""}))]})}}class _n{constructor(e){let n=t(()=>e.cleatWidth()??50),r=t(()=>e.cleatLength()??200),o=t(()=>e.cleatThickness()??6),l=t(()=>new vt({width:n(),thickness:o()})),s=t(()=>n().toFixed(0)+"x"+o().toFixed(1)+" Flat"),a=t(()=>e.cleatOnFasciaWidth()??50),h=t(()=>e.cleatOnFasciaLength()??200),d=t(()=>e.cleatOnFasciaThickness()??6),c=t(()=>e.cleatOnFasciaPos()??e.postLength()-h()),u=t(()=>a().toFixed(0)+"x"+d().toFixed(1)+" Flat"),S=t(()=>new vt({width:a(),thickness:d()})),b=t(()=>Qt[e.postItemName()]),N=t(()=>new T({itemName:e.postItemName,description:()=>"Posts",hasLabel:()=>!0,labelKey:()=>"P",length:e.postLength,shsProperties:b,transform:t(()=>m.create(i.create(b().size,0,0),y.fromUV(i.unitZ,i.unitY)))})),w=t(()=>b().size.toFixed(0)+" SHS Fab"),p=t(()=>new T({itemName:()=>"Post Base Labour",description:()=>"Post Labour"})),g=t(()=>new T({itemName:()=>w(),description:()=>"Post Labour"})),P=()=>{let J,K,te=6;return b().size<=100-25?(J="100x6 Flat",K=100):(J="130x6 Flat",K=130),new T({itemName:()=>J,description:()=>"CastIn Plates",length:()=>K,flatProperties:t(()=>new vt({width:K,thickness:te})),transform:t(()=>m.create(i.create(.5*b().size-.5*K,.5*b().size-.5*K,-te),y.identity))})},M=()=>{let J=b().size+100,K=6,te=b().size,_=te.toFixed(0)+"x6 Flat";return new T({itemName:()=>_,description:()=>"Tie Down Plates",length:()=>J,flatProperties:t(()=>new vt({width:te,thickness:K})),holes2d:t(()=>[f.create(25,.5*te),f.create(J-25,.5*te)]),transform:t(()=>m.create(i.create(.5*b().size-.5*J,.5*b().size-.5*te,-K),y.identity))})},v=()=>{let J=b().size+50,K=6,te=b().size,_=te.toFixed(0)+"x6 Flat";return[new T({itemName:()=>_,description:()=>"Tie Down Plates",length:()=>J-b().size,flatProperties:t(()=>new vt({width:te,thickness:K})),holes2d:t(()=>[f.create(25,.5*te)]),transform:t(()=>m.create(i.create(b().size,e.endPostType()=="Side2"?-50:b().size,-K),y.fromWU(i.unitZ,i.unitY)))}),new T({itemName:()=>_,description:()=>"Tie Down Plates",length:()=>J,flatProperties:t(()=>new vt({width:te,thickness:K})),holes2d:t(()=>[f.create(e.sidePostType()=="End2"?25:J-25,.5*te)]),transform:t(()=>m.create(i.create(e.sidePostType()=="End2"?b().size-J:0,0,-K),y.identity))})]},k=t(()=>{switch(e.basePlateType()){case"Type1":return[P()];case"Type2":return[M()];case"Type3":return v()}}),z=J=>new T({itemName:s,description:()=>"Cleat",length:r,flatProperties:l,holes2d:t(()=>{let K=e.cleatHole1XPos(),te=e.cleatHole1YPos(),_=e.cleatHole2XPos(),Y=e.cleatHole2YPos();return[...K==null||te==null?[]:[f.create(K,te)],..._==null||Y==null?[]:[f.create(_,Y)]]}),transform:t(()=>e.endPostType()=="Side1"?m.create(i.create(o()+J.offsetX,b().size,J.posZ),y.fromUV(i.unitZ,i.unitY)):m.create(i.create(J.offsetX,0,J.posZ),y.fromUV(i.unitZ,i.negUnitY)))}),x=J=>new T({itemName:s,description:()=>"Cleat",length:r,flatProperties:l,holes2d:t(()=>{let K=e.cleatHole1XPos(),te=e.cleatHole1YPos(),_=e.cleatHole2XPos(),Y=e.cleatHole2YPos();return[...K==null||te==null?[]:[f.create(K,te)],..._==null||Y==null?[]:[f.create(_,Y)]]}),transform:t(()=>e.endPostType()=="Side1"?m.create(i.create(b().size+J.offsetX,b().size,J.posZ),y.fromUV(i.unitZ,i.unitY)):m.create(i.create(b().size-o()+J.offsetX,0,J.posZ),y.fromUV(i.unitZ,i.negUnitY)))}),A=J=>new T({itemName:s,description:()=>"Cleat",length:r,flatProperties:l,holes2d:t(()=>{let K=e.cleatHole1XPos(),te=e.cleatHole1YPos(),_=e.cleatHole2XPos(),Y=e.cleatHole2YPos();return[...K==null||te==null?[]:[f.create(K,te)],..._==null||Y==null?[]:[f.create(_,Y)]]}),transform:t(()=>e.endPostType()=="Side1"?m.create(i.create(.5*b().size+.5*o()+J.offsetX,b().size,J.posZ),y.fromUV(i.unitZ,i.unitY)):m.create(i.create(.5*b().size-.5*o()+J.offsetX,0,J.posZ),y.fromUV(i.unitZ,i.negUnitY)))}),I=J=>new T({itemName:s,description:()=>"Cleat",length:r,flatProperties:l,holes2d:t(()=>{let K=e.cleatHole1XPos(),te=e.cleatHole1YPos(),_=e.cleatHole2XPos(),Y=e.cleatHole2YPos();return[...K==null||te==null?[]:[f.create(K,te)],..._==null||Y==null?[]:[f.create(_,Y)]]}),transform:t(()=>m.create(i.create(.5*b().size+.5*o()+J.offsetX,.5*b().size-.5*n(),e.postLength()+e.capThickness()),y.fromUV(i.unitZ,i.unitY)))}),O=()=>new T({itemName:u,description:()=>"Cleat",length:h,flatProperties:S,holes2d:t(()=>{let J=e.cleatOnFasciaHole1XPos(),K=e.cleatOnFasciaHole1YPos(),te=e.cleatOnFasciaHole2XPos(),_=e.cleatOnFasciaHole2YPos();return[...J==null||K==null?[]:[f.create(J,K)],...te==null||_==null?[]:[f.create(te,_)]]}),transform:t(()=>m.create(i.create(-a(),e.endPostType()=="Side1"?0:b().size-d(),c()),y.fromUV(i.unitZ,i.unitX)))}),E=()=>new T({itemName:u,description:()=>"Cleat",length:h,flatProperties:S,holes2d:t(()=>{let J=e.cleatOnFasciaHole1XPos(),K=e.cleatOnFasciaHole1YPos(),te=e.cleatOnFasciaHole2XPos(),_=e.cleatOnFasciaHole2YPos();return[...J==null||K==null?[]:[f.create(J,K)],...te==null||_==null?[]:[f.create(te,_)]]}),transform:t(()=>m.create(i.create(b().size,e.endPostType()=="Side1"?0:b().size-d(),c()),y.fromUV(i.unitZ,i.unitX)))}),F=t(()=>{let J,K=e.cleatAttachmentType();switch(K.onPost.type){case"None":{J=[];break}case"End1OfPost":{J=[z(K.onPost)];break}case"End2OfPost":{J=[x(K.onPost)];break}case"MidOfPost":{J=[A(K.onPost)];break}case"OnCap":{J=[I(K.onPost)];break}}let te=[];return K.onFasciaEnd1&&te.push(O()),K.onFasciaEnd2&&te.push(E()),[...J,...te]}),$=t(()=>e.cleatAttachmentType().onPost.type!="OnCap"?[]:[new T({itemName:t(()=>b().size+"x6.0 Flat"),description:()=>"Cap on Post",length:()=>b().size,flatProperties:t(()=>new vt({width:b().size,thickness:6})),transform:t(()=>m.create(i.create(0,0,e.postLength()),y.identity))})]),G=t(()=>e.basePlateType()=="Type1"?[]:[new T({itemName:()=>"M12 Chemset Studbolt",description:()=>"Tie Downs",qty:()=>2}),new T({itemName:()=>"M12 Glass Capsule",description:()=>"Tie Downs",qty:()=>2})]);this.components=t(()=>[N(),...k(),...F(),...$(),...G(),p(),g()])}}let Fu={sidePostType:{displayName:"Side Post Type",typeSchema:{type:"String",possibleValues:["End1","Mid","End2"]},defaultValue:"End1"},endPostType:{displayName:"End Post Type",typeSchema:{type:"String",possibleValues:["Side1","Side2"]},defaultValue:"Side1"},basePlateType:{displayName:"Base Plate Type",typeSchema:{type:"String",possibleValues:["Type1","Type2","Type3"]},defaultValue:"Type1"},cleatAttachmentType:{displayName:"Cleat Attachment Type",typeSchema:{type:"Object",properties:{onPost:{displayName:"On Post",typeSchema:{type:"Union",parts:{None:{},End1OfPost:{posZ:{displayName:"Pos Z",typeSchema:{type:"Number"},defaultValue:0},offsetX:{displayName:"Offset X",typeSchema:{type:"Number"},defaultValue:0}},End2OfPost:{posZ:{displayName:"Pos Z",typeSchema:{type:"Number"},defaultValue:0},offsetX:{displayName:"Offset X",typeSchema:{type:"Number"},defaultValue:0}},MidOfPost:{posZ:{displayName:"Pos Z",typeSchema:{type:"Number"},defaultValue:0},offsetX:{displayName:"Offset X",typeSchema:{type:"Number"},defaultValue:0}},OnCap:{offsetX:{displayName:"Offset X",typeSchema:{type:"Number"},defaultValue:0}}}},defaultValue:{type:"None"}},onFasciaEnd1:{displayName:"On Fascia End 1",typeSchema:{type:"Boolean"},defaultValue:!1},onFasciaEnd2:{displayName:"On Fascia End 2",typeSchema:{type:"Boolean"},defaultValue:!1}}},defaultValue:{onPost:{type:"None"},onFasciaEnd1:!1,onFasciaEnd2:!1}}};const Vu=new Ae({typeName:"PsfStylePost",displayName:"Post",propertiesSchema:Fu}),Lu=Vu;class Hu{constructor(){this.isForTesting=!0,this.componentType=Lu}create(e,n,r,o,l){return new Eu(n,r,o,l)}}let to=new Hu;Be(to);class Eu{constructor(e,n,r,o){this.type=to,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new _n({cyclonic:()=>!1,postItemName:()=>"100x3.0 SHS",postLabel:()=>"P",postThickness:()=>3,postLength:()=>2400,castInDepth:()=>0,castInPeirWidth:()=>0,sidePostType:()=>e.sidePostType,endPostType:()=>e.endPostType,flipCleatOnPost:()=>!1,basePlateType:()=>e.basePlateType,basePlateHoleSize:()=>12,cleatAttachmentType:()=>e.cleatAttachmentType,cleatLength:()=>{},cleatWidth:()=>{},cleatThickness:()=>{},cleatHole1XPos:()=>{},cleatHole1YPos:()=>{},cleatHole2XPos:()=>{},cleatHole2YPos:()=>{},cleatHoleSize:()=>{},cleatOnFasciaLength:()=>{},cleatOnFasciaWidth:()=>{},cleatOnFasciaThickness:()=>{},cleatOnFasciaHole1XPos:()=>{},cleatOnFasciaHole1YPos:()=>{},cleatOnFasciaHole2XPos:()=>{},cleatOnFasciaHole2YPos:()=>{},cleatOnFasciaHoleSize:()=>{},cleatOnFasciaPos:()=>{},state:()=>({}),capThickness:()=>6});this.components=t(()=>[new T({children:l.components,transform:t(()=>m.create(i.create(0,0,6),y.identity))})]),this.properties=t(()=>[{displayName:"Properties",fields:[ft({displayName:()=>"Side Type",value:()=>e.sidePostType,setValue:s=>n("sidePostType",s),possibleValues:t(()=>["End1","Mid","End2"])}),ft({displayName:()=>"End Type",value:()=>e.endPostType,setValue:s=>n("endPostType",s),possibleValues:t(()=>["Side1","Side2"])}),ft({displayName:()=>"Base Type",value:()=>e.basePlateType,setValue:s=>n("basePlateType",s),possibleValues:t(()=>["Type1","Type2","Type3"])}),ft({displayName:()=>"Cleat On Post Type",value:()=>e.cleatAttachmentType.onPost.type,setValue:s=>{let a=s,h;switch(a){case"None":h={type:"None"};break;case"End1OfPost":h={type:"End1OfPost",posZ:2200,offsetX:0};break;case"End2OfPost":h={type:"End2OfPost",posZ:2200,offsetX:0};break;case"MidOfPost":h={type:"MidOfPost",posZ:2200,offsetX:0};break;case"OnCap":h={type:"OnCap",offsetX:0};break}n("cleatAttachmentType","onPost",h)},possibleValues:t(()=>["None","End1OfPost","End2OfPost","MidOfPost","OnCap"])}),kt({displayName:()=>"Cleat On Fascia End 1",value:()=>e.cleatAttachmentType.onFasciaEnd1,setValue:s=>n("cleatAttachmentType","onFasciaEnd1",s)}),kt({displayName:()=>"Cleat On Fascia End 2",value:()=>e.cleatAttachmentType.onFasciaEnd2,setValue:s=>n("cleatAttachmentType","onFasciaEnd2",s)})],expanded:()=>!0}])}}const qr=50;class Uu{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=t(()=>e.height()+e.span()*l()),a=t(()=>yt[e.rafterItemName()]),h=t(()=>Qt[e.postItemName()]),d=t(()=>yt[e.purlinItemName()]),c=()=>{let I=e.initialBayCentres();if(I==null)return Wt("If initialBayCentres is not given then side1BayMarkers, end1BayMarkers and end2BayMarkers must be given");let O=e.length()-2*a().flangeSize-h().size,E=Math.ceil(O/I),F=O/E,$=E+1,G=a().flangeSize+.5*h().size;return ki(Array($).fill(void 0).map((J,K)=>G+K*F))},u=t(()=>{let I=e.sideBayMarkers();return I!=null?ki(I):c()}),S=t(()=>{let I=u();if(I.type=="Err")return[];let O=I.value,E=6,F=6,$=6,G=a().webHoleDistApart+50,J=50,K=35*r()+(.5*a().webSize+.5*a().webHoleDistApart)*o()+25,te=a().webHoleDistApart*r()+50,_=h().size,Y=(.5*a().webSize+.5*a().webHoleDistApart)/r()+.5*_*l()+25,ee=25,ce=K-25,Ce=ee+a().webHoleDistApart*r(),Ue=ce-a().webHoleDistApart*o(),Q=.5*_*l()+(.5*a().webSize-.5*a().webHoleDistApart)/r(),R=.5*_,V=Y-25,L=.5*_,ne=e.height()+(d().flangeSize+h().size+K-25)*l()-(.5*a().webSize+.5*a().webHoleDistApart)/r()-25-E,he=s()-(d().flangeSize+h().size+K-25)*l()-(.5*a().webSize-.5*a().webHoleDistApart)/r()-te+25-E,le=Ce,me=ce,ye=ee,W=Ue;return O.flatMap((D,H)=>{let X=H!=0&&H!=O.length-1&&e.midFrameType()=="Double",Z;if(H==0&&e.end1Overhang()!=0)Z={type:"None"};else if(H==O.length-1&&e.end2Overhang()!=0)Z={type:"None"};else if(H==0||H==O.length-1||e.side1Overhang()==0)if(X)Z={type:"MidOfPost",posZ:ne,offsetX:-a().thickness-.5*F};else{let ae;H==0||H==O.length-1?ae=0:ae=.5*h().size-.5*a().flangeSize-F,Z={type:H!=O.length-1?"End1OfPost":"End2OfPost",posZ:ne,offsetX:ae}}else Z={type:"OnCap",offsetX:0};let U;if(H==0&&e.end1Overhang()!=0)U={type:"None"};else if(H==O.length-1&&e.end2Overhang()!=0)U={type:"None"};else if(H==0||H==O.length-1||e.side1Overhang()==0)if(X)U={type:"MidOfPost",posZ:he,offsetX:-a().thickness-.5*F};else{let ae;H==0||H==O.length-1?ae=0:ae=.5*h().size-.5*a().flangeSize-F,U={type:H!=O.length-1?"End1OfPost":"End2OfPost",posZ:he,offsetX:ae}}else U={type:"OnCap",offsetX:0};let B;H!=0&&H!=O.length-1&&e.side1Overhang()!=0?B=e.height()+d().flangeSize*l()-a().webSize/r()-$-E:B=e.height()+d().flangeSize*l()-E;let j;H!=0&&H!=O.length-1&&e.side2Overhang()!=0?j=s()-(d().flangeSize+h().size)*l()-a().webSize/r()-$-E:j=s()-(d().flangeSize+h().size)*l()-E;let oe=Z.type=="OnCap",ie=U.type=="OnCap";return[{post:new _n({cyclonic:()=>!1,postItemName:()=>"100x3.0 SHS",postLabel:()=>"P",postThickness:()=>3,postLength:()=>B,castInDepth:()=>300,castInPeirWidth:()=>150,sidePostType:t(()=>H==0?"End1":H==O.length-1?"End2":"Mid"),endPostType:()=>"Side1",flipCleatOnPost:()=>!1,basePlateType:()=>H==0||H==O.length-1?"Type3":"Type2",basePlateHoleSize:()=>12,cleatAttachmentType:t(()=>({onPost:Z,onFasciaEnd1:H!=0&&e.side1Overhang()==0||H==O.length-1&&e.side1Overhang()!=0||H==0&&e.end1Overhang()!=0,onFasciaEnd2:H!=O.length-1&&e.side1Overhang()==0||H==0&&e.side1Overhang()!=0||H==O.length-1&&e.end2Overhang()!=0})),cleatLength:()=>Z.type=="OnCap"?Y:te,cleatWidth:()=>Z.type=="OnCap"?_:K,cleatThickness:()=>6,cleatHole1XPos:()=>oe?Q:ee,cleatHole1YPos:()=>oe?R:ce,cleatHole2XPos:()=>oe?V:Ce,cleatHole2YPos:()=>oe?L:Ue,cleatHoleSize:()=>{},cleatOnFasciaLength:()=>G,cleatOnFasciaWidth:()=>J,cleatOnFasciaThickness:()=>6,cleatOnFasciaHole1XPos:()=>.5*G-.5*a().webHoleDistApart,cleatOnFasciaHole1YPos:()=>.5*J,cleatOnFasciaHole2XPos:()=>.5*G+.5*a().webHoleDistApart,cleatOnFasciaHole2YPos:()=>.5*J,cleatOnFasciaHoleSize:()=>{},cleatOnFasciaPos:t(()=>e.height()-E-.5*d().webSize-.5*G),state:()=>({}),capThickness:()=>6}),space:t(()=>m.create(i.create(D-.5*h().size,d().flangeSize,6),y.identity))},{post:new _n({cyclonic:()=>!1,postItemName:()=>"100x3.0 SHS",postLabel:()=>"P",postThickness:()=>3,postLength:()=>j,castInDepth:()=>300,castInPeirWidth:()=>150,sidePostType:t(()=>H==0?"End1":H==O.length-1?"End2":"Mid"),endPostType:()=>"Side2",flipCleatOnPost:()=>!1,basePlateType:()=>H==0||H==O.length-1?"Type3":"Type2",basePlateHoleSize:()=>12,cleatAttachmentType:t(()=>({onPost:U,onFasciaEnd1:H!=0&&e.side2Overhang()==0||H==O.length-1&&e.side2Overhang()!=0||H==0&&e.end1Overhang()!=0,onFasciaEnd2:H!=O.length-1&&e.side2Overhang()==0||H==0&&e.side2Overhang()!=0||H==O.length-1&&e.end2Overhang()!=0})),cleatLength:()=>U.type=="OnCap"?Y:te,cleatWidth:()=>U.type=="OnCap"?_:K,cleatThickness:()=>6,cleatHole1XPos:()=>ie?Q:le,cleatHole1YPos:()=>ie?R:me,cleatHole2XPos:()=>ie?V:ye,cleatHole2YPos:()=>ie?L:W,cleatHoleSize:()=>{},cleatOnFasciaLength:()=>G,cleatOnFasciaWidth:()=>J,cleatOnFasciaThickness:()=>6,cleatOnFasciaHole1XPos:()=>.5*G-.5*a().webHoleDistApart,cleatOnFasciaHole1YPos:()=>.5*J,cleatOnFasciaHole2XPos:()=>.5*G+.5*a().webHoleDistApart,cleatOnFasciaHole2YPos:()=>.5*J,cleatOnFasciaHoleSize:()=>{},cleatOnFasciaPos:t(()=>s()-d().flangeSize*l()-E-.5*d().webSize-.5*G),state:()=>({}),capThickness:()=>6}),space:t(()=>m.create(i.create(D-.5*h().size,e.span()-d().flangeSize-h().size,6),y.identity))}]})}),b=t(()=>S().map(({post:I,space:O})=>new T({children:I.components,transform:O}))),N=t(()=>{let I=u();if(I.type=="Err")return[];let O=I.value;return O.flatMap((E,F)=>{let $=F==0,G=F==O.length-1,J=!($||G)&&e.rafterFrameType()=="Double",K,te;$?K=a().flangeSize-e.end1Overhang():G?K=e.length()-a().flangeSize+e.end2Overhang():K=E+(J?0:.5*a().flangeSize);let _;J?_=E:_=void 0;let Y;$||G||e.side1Overhang()!=0?Y=-e.side1Overhang()+d().flangeSize:Y=d().flangeSize+h().size;let ee;$||G||e.side2Overhang()!=0?ee=e.span()+e.side2Overhang()-d().flangeSize:ee=e.span()-d().flangeSize-h().size,te=(ee-Y)/r()-a().webSize*l();let ce;G?ce=1:ce=-1;let Ce;ce<0?Ce=Y:Ce=Y+a().webSize*o();let Ue;ce<0?Ue=e.height()+Y*l():Ue=e.height()+Y*l()-a().webSize/r();let Q=Y+a().webSize*o(),R=e.height()+Q*l()-a().webSize/r();return[new T({itemName:e.rafterItemName,description:()=>"Rafters",length:()=>te,ceeProperties:a,transform:t(()=>m.create(i.create(K,Ce,Ue),y.fromWU(i.create(ce,0,0),i.create(0,r(),o()))))}),..._==null?[]:(V=>[new T({itemName:e.rafterItemName,description:()=>"Rafters",length:()=>te,ceeProperties:a,transform:t(()=>m.create(i.create(V,Q,R),y.fromWU(i.unitX,i.create(0,r(),o()))))})])(_)]})}),w=t(()=>{let I=u();if(I.type=="Err")return[];let O=I.value,E=[-e.end1Overhang(),...O.flatMap(($,G)=>G==0||G==O.length-1?[]:[$]),e.length()+e.end2Overhang()],F=[];for(let $=0;$<E.length-1;++$){let G=E[$],J=E[$+1];if(F.push(new T({itemName:e.purlinItemName,length:()=>J-G,description:()=>"Fascia",ceeProperties:d,transform:t(()=>m.create(i.create(G,d().flangeSize-e.side1Overhang(),e.height()-d().webSize-e.side1Overhang()*l()),y.fromWU(i.negUnitY,i.unitX)))}),new T({itemName:e.purlinItemName,length:()=>J-G,description:()=>"Fascia",ceeProperties:d,transform:t(()=>m.create(i.create(G,e.span()-d().flangeSize+e.side2Overhang(),s()-d().flangeSize*l()+e.side2Overhang()*l()),y.fromWU(i.unitY,i.unitX)))})),e.side1Overhang()!=0){let K;$==0||e.midFrameType()=="Double"?K=G+a().flangeSize:K=G+.5*a().flangeSize;let te;$+1==E.length-1||e.midFrameType()=="Double"?te=J-a().flangeSize:te=J-.5*a().flangeSize,F.push(new T({itemName:e.purlinItemName,length:()=>te-K,description:()=>"Purlin",ceeProperties:d,transform:t(()=>m.create(i.create(K,d().flangeSize,e.height()-d().webSize),y.fromWU(i.negUnitY,i.unitX)))}))}if(e.side2Overhang()!=0){let K;$==0||e.midFrameType()=="Double"?K=G+a().flangeSize:K=G+.5*a().flangeSize;let te;$+1==E.length-1||e.midFrameType()=="Double"?te=J-a().flangeSize:te=J-.5*a().flangeSize,F.push(new T({itemName:e.purlinItemName,length:()=>te-K,description:()=>"Purlin",ceeProperties:d,transform:t(()=>m.create(i.create(K,e.span()-d().flangeSize,s()-d().flangeSize*l()),y.fromWU(i.unitY,i.unitX)))}))}}return F}),p=t(()=>{let I=N().flatMap(E=>{if(E.transform==null)return[];let F=E.transform(),$=F.w;return F.o.x+($.x<0?-a().flangeSize:0)});I.sort((E,F)=>E-F);let O=[];for(let E=0;E<I.length-1;++E){let F=I[E]+a().flangeSize,$=I[E+1];if($-F<a().flangeSize*2+100)continue;let G=d().flangeSize,K=e.span()-d().flangeSize-G,te=Math.ceil(K/r()/e.purlinCentres()),_=K/te,Y=te-1;for(let ee=0;ee<Y;++ee){let ce=G+(ee+1)*_;O.push(new T({itemName:e.purlinItemName,description:()=>"Purlins",length:()=>$-F,ceeProperties:d,transform:t(()=>m.create(i.create(F,ce,e.height()+ce*l()-d().webSize/r()),y.fromWU(i.create(0,-r(),-o()),i.unitX)))}))}}return O}),g=t(()=>{let I=e.length()+e.side1Overhang()+e.side2Overhang(),O=(e.span()+e.end1Overhang()+e.end2Overhang())/r();return[{sheetedArea:new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-qr),f.create(I,-qr),f.create(I,O),f.create(0,O)]),openings:()=>[],colour:()=>"Deep Ocean",sheetingType:()=>"Corrugated 0.42",previewOpening:()=>{}}),space:t(()=>m.create(i.create(-e.end1Overhang(),-e.side1Overhang(),e.height()-e.side1Overhang()*l()),y.fromWU(i.create(0,r(),o()),i.unitX)))}]}),P=t(()=>g().map(({sheetedArea:I,space:O})=>new T({children:I.components,transform:O}))),M=t(()=>[{gutter:new jt({length:t(()=>e.length()+e.end1Overhang()+e.end2Overhang())}),space:t(()=>m.create(i.create(-e.end1Overhang(),-e.side1Overhang(),e.height()-e.side1Overhang()*l()),y.fromWU(i.unitZ,i.unitX)))}]),v=t(()=>M().map(({gutter:I,space:O})=>new T({children:I.components,transform:O}))),k=t(()=>(e.span()+e.side1Overhang()+e.side2Overhang())/r()+200),z=t(()=>i.create(0,-r()*170,-o()*170)),x=t(()=>i.create(0,r()*30,o()*30)),A=t(()=>{let I="Flashing - Barge Corrugated CB";return[new T({itemName:()=>I,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-e.end1Overhang()-35,-e.side1Overhang(),e.height()-e.side1Overhang()*l()+35/r()).add(z()),y.fromUV(i.create(0,r(),o()),i.negUnitX)),length:k,flashingProfile:()=>tt}),new T({itemName:()=>I,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+e.end2Overhang()+35,e.span()+e.side2Overhang(),s()+e.side2Overhang()*l()+35/r()).add(x()),y.fromUV(i.create(0,-r(),-o()),i.unitX)),length:k,flashingProfile:()=>tt}),new T({itemName:()=>I,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-e.end1Overhang(),e.span()+e.side2Overhang()+30,s()+e.side2Overhang()*l()+30/r()),y.fromUV(i.unitX,i.unitY)),length:t(()=>e.length()+e.end1Overhang()+e.end2Overhang()),flashingProfile:()=>tt})]});this.components=t(()=>[...b(),...N(),...w(),...p(),...P(),...v(),...A()])}}const Ru="100x3.0 SHS",Wu="C25024",Xu=1200;let Du={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:6e3},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:12e3},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2400},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:5},side1Overhang:{displayName:"Side 1 Overhang",typeSchema:{type:"Number"},defaultValue:0},side2Overhang:{displayName:"Side 2 Overhang",typeSchema:{type:"Number"},defaultValue:0},end1Overhang:{displayName:"End 1 Overhang",typeSchema:{type:"Number"},defaultValue:0},end2Overhang:{displayName:"End 2 Overhang",typeSchema:{type:"Number"},defaultValue:0},engineering:{displayName:"Engineering",typeSchema:{type:"Object",properties:{postItemName:{displayName:"Post Item Name",typeSchema:{type:"String"},defaultValue:""},rafterItemName:{displayName:"Rafter Item Name",typeSchema:{type:"String"},defaultValue:""},midFrameType:{displayName:"Mid Frame Type",typeSchema:{type:"String",possibleValues:["Single","Double"]},defaultValue:"Single"},maxPurlinCentres:{displayName:"Max Purlin Centres",typeSchema:{type:"Number"},defaultValue:600,optional:!0}}},defaultValue:{postItemName:Ru,rafterItemName:Wu,midFrameType:"Double",maxPurlinCentres:Xu}}};const _u=new Ae({typeName:"SkillionCarport",displayName:"Skillion Carport",propertiesSchema:Du}),Yu=_u;class Gu{constructor(){this.componentType=Yu}create(e,n,r,o,l){return new Zu(n,r,o,l)}}let io=new Gu;Be(io);class Zu{constructor(e,n,r,o){this.type=io,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new Uu({rafterItemName:()=>e.engineering.rafterItemName,postItemName:()=>e.engineering.postItemName,midFrameType:()=>e.engineering.midFrameType,maxEaveOverhang:()=>600,rafterFrameType:()=>e.engineering.midFrameType,collarTieItemName:()=>{},kneeTieItemName:()=>{},purlinItemName:()=>e.engineering.rafterItemName,purlinCentres:()=>e.engineering.maxPurlinCentres,maxSideGirtCentresOp:()=>{},castInDepth:()=>300,castInPeirWidth:()=>150,midKneeBraceUsingYDirection:()=>!1,siteDetails:()=>({}),claddingDetails:()=>({}),length:()=>e.length,span:()=>e.span,height:()=>e.height,pitch:()=>e.pitch,initialBayCentres:()=>3e3,sideBayMarkers:()=>{},end1BayMarkers:()=>{},end2BayMarkers:()=>{},side1WallData:()=>({}),side2WallData:()=>({}),end1WallData:()=>({}),end2WallData:()=>({}),side1Overhang:()=>e.side1Overhang,side2Overhang:()=>e.side2Overhang,end1Overhang:()=>e.end1Overhang,end2Overhang:()=>e.end2Overhang,soilType:()=>"M",windCategory:()=>"N40",ultimateWindSpeed:()=>38,startCastIn:()=>!1});this.components=l.components,this.properties=t(()=>[{displayName:"Properties",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:s=>n("span",s)}),se({displayName:()=>"Length",value:()=>e.length,setValue:s=>n("length",s)}),se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:s=>n("pitch",s)}),se({displayName:()=>"Side A Overhang",value:()=>e.side1Overhang,setValue:s=>n("side1Overhang",s)}),se({displayName:()=>"Side B Overhang",value:()=>e.side2Overhang,setValue:s=>n("side2Overhang",s)}),se({displayName:()=>"End A Overhang",value:()=>e.end1Overhang,setValue:s=>n("end1Overhang",s)}),se({displayName:()=>"End B Overhang",value:()=>e.end2Overhang,setValue:s=>n("end2Overhang",s)})],expanded:()=>!0},{displayName:"Engineering",fields:[ft({displayName:()=>"Rafter",value:()=>e.engineering.rafterItemName,setValue:s=>n("engineering","rafterItemName",s),possibleValues:t(()=>Object.keys(yt))}),ft({displayName:()=>"Post",value:()=>e.engineering.postItemName,setValue:s=>n("engineering","postItemName",s),possibleValues:t(()=>Object.keys(Qt))}),ft({displayName:()=>"Mid Frame Type",value:()=>e.engineering.midFrameType,setValue:s=>n("engineering","midFrameType",s),possibleValues:t(()=>["Single","Double"])}),se({displayName:()=>"Max Purlin Spacing",value:()=>e.engineering.maxPurlinCentres,setValue:s=>n("engineering","maxPurlinCentres",s)})],expanded:()=>!0}])}}class $u{constructor(e){let n=t(()=>{let l=t(()=>{let s=e.vertices();return a=>{let h=.001,d=new Et(s.map(M=>new De(M.x*h,M.y*h))),c=new yl(d),u=new xt({color:"#606060"}),S=new xt({color:"#506050",side:fs}),b=new bt(c),N=new Tt({color:"black"});Fe(()=>{c.dispose(),u.dispose(),S.dispose(),b.dispose(),N.dispose()});let w=new xe(c,u),p=new xe(c,S),g=new ht(b,N),P=new nt;return P.add(w),P.add(p),P.add(g),P}});return new T({mkObject3d:l})}),r=t(()=>{let l=t(()=>{let s=e.vertices(),a=s.reduce((u,S)=>Math.min(u,S.x),Number.POSITIVE_INFINITY),h=s.reduce((u,S)=>Math.max(u,S.x),Number.NEGATIVE_INFINITY),d=e.sheetingTakeOffSections();const c=762;return u=>{let S=new nt,b=.001;for(let N=0;N<d.length;++N){let w=new Xt,p=new Float32Array(d[N].sheets.length*4*3*2),g=0;for(let v of d[N].sheets){let k=v.position,z=v.length,x=Math.max(a,k.x)*b,A=Math.min(h,k.x+c)*b;p[g]=x,p[g+1]=k.y*b,p[g+2]=.05,g+=3,p[g]=A,p[g+1]=k.y*b,p[g+2]=.05,g+=3,p[g]=A,p[g+1]=k.y*b,p[g+2]=.05,g+=3,p[g]=A,p[g+1]=(k.y+z)*b,p[g+2]=.05,g+=3,p[g]=A,p[g+1]=(k.y+z)*b,p[g+2]=.05,g+=3,p[g]=x,p[g+1]=(k.y+z)*b,p[g+2]=.05,g+=3,p[g]=x,p[g+1]=(k.y+z)*b,p[g+2]=.05,g+=3,p[g]=x,p[g+1]=k.y*b,p[g+2]=.05,g+=3}w.setAttribute("position",new di(p,3));let P=new Tt({color:d[N].sectionColour}),M=new ht(w,P);S.add(M),Fe(()=>{w.dispose(),P.dispose()})}return S}});return new T({mkObject3d:l})}),o=t(()=>e.sheetingTakeOffSections().flatMap(({sectionColour:l,sheets:s})=>s.map(a=>new T({itemName:()=>"Sheet",length:()=>a.length,itemMarkColour:()=>l}))));this.components=t(()=>[n(),r(),...o()])}}let Ku={heightOffGround:{displayName:"Height Off Ground",typeSchema:{type:"Number"},defaultValue:2400},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:22},vertices:{displayName:"Vertices",typeSchema:{type:"Array",elemTypeSchema:Fn(({x:C,y:e})=>f.create(C,e),C=>({x:C.x,y:C.y}),{type:"Object",properties:{x:{displayName:"X",typeSchema:{type:"Number"},defaultValue:0},y:{displayName:"Y",typeSchema:{type:"Number"},defaultValue:0}}})},defaultValue:[f.create(-500,0),f.create(500,0),f.create(500,1e3),f.create(-500,1e3)]},sheetingTakeOffSections:{displayName:"Sheeting Take Off Sections",typeSchema:{type:"Array",elemTypeSchema:{type:"Object",properties:{sectionColour:{displayName:"Section Colour",typeSchema:{type:"String"},defaultValue:""},sheets:{displayName:"Sheets",typeSchema:{type:"Array",elemTypeSchema:{type:"Object",properties:{position:{displayName:"Position",typeSchema:Fn(({x:C,y:e})=>f.create(C,e),C=>({x:C.x,y:C.y}),{type:"Object",properties:{x:{displayName:"X",typeSchema:{type:"Number"},defaultValue:0},y:{displayName:"Y",typeSchema:{type:"Number"},defaultValue:0}}}),defaultValue:f.zero},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:0}}}},defaultValue:[]}}}},defaultValue:[],optional:!0}};const ju=new Ae({typeName:"RoofPlane",displayName:"Roof Plane",propertiesSchema:Ku}),Qu=ju;class qu{constructor(){this.componentType=Qu,this.defaultInsertMulti=!0}create(e,n,r,o,l){return new Ju(n,r,o,l)}}let pr=new qu;Be(pr);const Cm=pr;class Ju{constructor(e,n,r,o){this.type=pr,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=t(()=>e.pitch*Math.PI/180),s=t(()=>Math.cos(l())),a=t(()=>Math.sin(l())),h=t(()=>m.create(i.create(0,0,e.heightOffGround),y.fromWU(i.create(0,-a(),s()),i.unitX))),d=new $u({vertices:()=>e.vertices,sheetingTakeOffSections:()=>e.sheetingTakeOffSections}),c=t(()=>{let u=0;for(let S=0;S<e.vertices.length;++S){let b=(S+1)%e.vertices.length,N=e.vertices[S],w=e.vertices[b];u+=N.cross(w)}return u=.5*u/1e6,u});this.components=t(()=>[new T({children:d.components,transform:h})]),this.properties=t(()=>[{displayName:"Roof Plane",fields:[se({displayName:()=>"Height Off Ground",value:()=>e.heightOffGround,setValue:u=>n("heightOffGround",u)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:u=>n("pitch",u)}),Qn({displayName:()=>"Area (m\xB2)",value:t(()=>c().toFixed(2))})],expanded:()=>!0}]),this.rayCollision=t(()=>u=>{let S=h(),b=Kt.fromKnownPtAndNormal(S.o,S.w),N=u.collisionTimeWithPlane(b);if(N==null||N<0)return;let w=u.positionFromTime(N),p=S.pointToThisSpace(w).xy();if(!!gs(p,e.vertices))return N}),this.snapPoints=t(()=>e.vertices.map(u=>h().pointFromThisSpace(u.toVec3()))),this.joinRoofPlaneEdgesRoofPlanes=t(()=>[{vertices:()=>e.vertices,space:h,updateVertices:u=>{n("vertices",u)}}]),this.clearSheetingTakeOff=()=>{n("sheetingTakeOffSections",[])},this.addVerticalSheetingTakeOffPositions=({sectionColour:u,sheets:S})=>{n("sheetingTakeOffSections",[...e.sheetingTakeOffSections,{sectionColour:u,sheets:S}])},this.area=c}}let ef={roofType:{displayName:"Roof Type",typeSchema:{type:"String",possibleValues:["Gable","Skillion"]},optional:!0,defaultValue:"Gable"},constructionType:{displayName:"Construction Type",typeSchema:{type:"String",possibleValues:["Welded","Componentry"]},optional:!0,defaultValue:"Welded"},span:{displayName:"Span",typeSchema:{type:"Number"},optional:!0,defaultValue:6e3},length:{displayName:"Length",typeSchema:{type:"Number"},optional:!0,defaultValue:6e3},height:{displayName:"Height",typeSchema:{type:"Number"},optional:!0,defaultValue:2400},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},optional:!0,defaultValue:15},sideBaySizes:{displayName:"Side Bay Sizes",typeSchema:{type:"Array",elemTypeSchema:{type:"Number"}},optional:!0,defaultValue:[3e3,3e3]},endABaySizes:{displayName:"End A Bay Sizes",typeSchema:{type:"Array",elemTypeSchema:{type:"Number"}},optional:!0,defaultValue:[3e3,3e3]},endBBaySizes:{displayName:"End B Bay Sizes",typeSchema:{type:"Array",elemTypeSchema:{type:"Number"}},optional:!0,defaultValue:[3e3,3e3]},girtType:{displayName:"Girt Type",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String",possibleValues:["TopHat","Zed"]}},optional:!0,defaultValue:void 0},purlinType:{displayName:"Purlin Type",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String",possibleValues:["TopHat","Zed"]}},optional:!0,defaultValue:void 0},windCategory:{displayName:"Wind Category",typeSchema:{type:"String"},optional:!0,defaultValue:""},openings:{displayName:"Openings",typeSchema:{type:"Array",elemTypeSchema:fr},optional:!0,defaultValue:[]},openBays:{displayName:"Open Bays",typeSchema:{type:"Array",elemTypeSchema:Yl},optional:!0,defaultValue:[]},partitionWalls:{displayName:"Partition Walls",typeSchema:{type:"Array",elemTypeSchema:Ad},optional:!0,defaultValue:[]},frameMemberItemName:{displayName:"Frame Member",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String"}},optional:!0,defaultValue:void 0},midFrameBackToBack:{displayName:"Mid Frame Back To Back",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Boolean"}},optional:!0,defaultValue:void 0},endwallMullionItemName:{displayName:"Endwall Mullion",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String"}},optional:!0,defaultValue:void 0},braceItemName:{displayName:"Brace",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String"}},optional:!0,defaultValue:void 0},purlinItemName:{displayName:"Purlin",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String"}},optional:!0,defaultValue:void 0},sideGirtItemName:{displayName:"Side Girt",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String"}},optional:!0,defaultValue:void 0},endGirtItemName:{displayName:"End Girt",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"String"}},optional:!0,defaultValue:void 0},purlinSpacing:{displayName:"Purlin Spacing",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Number"}},optional:!0,defaultValue:void 0},sideGirtSpacing:{displayName:"Side Girt Spacing",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Number"}},optional:!0,defaultValue:void 0},endGirtSpacing:{displayName:"End Girt Spacing",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Number"}},optional:!0,defaultValue:void 0},hasKneeBraces:{displayName:"Has Knee Braces",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Boolean"}},optional:!0,defaultValue:void 0},hasApexBraces:{displayName:"Has Apex Braces",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Boolean"}},optional:!0,defaultValue:void 0},kneeBracePctOfSpan:{displayName:"Knee Brace % of Span",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Number"}},optional:!0,defaultValue:void 0},kneeBracePctOfWallHeight:{displayName:"Knee Brace % of Wall Height",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Number"}},optional:!0,defaultValue:void 0},apexBracePctOfSpan:{displayName:"Apex Brace % of Span",typeSchema:{type:"MaybeUndefined",elemTypeSchema:{type:"Number"}},optional:!0,defaultValue:void 0}};const tf=new Ae({typeName:"Shed",displayName:"Shed",propertiesSchema:ef}),nf=tf,rf=!1,lf=1200,of=1200,sf=1200,af=!1,hf=!1,cf=30,df=15,uf=30;class ff{constructor(){this.noMultiForm=!0,this.componentType=nf}create(e,n,r,o,l){return new pf(n,r,o,l)}}let no=new ff;Be(no);class pf{constructor(e,n,r,o){this.type=no;let[l,s]=wt({previewOpening:()=>{},sheetingLowPoly:()=>!1});this.setVisualProperties=s;let a=t(()=>l().textures);this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let h=t(()=>new xd({roofType:()=>e.roofType,constructionType:()=>e.constructionType,span:()=>e.span,length:()=>e.length,preferredSideBaySizes:()=>e.sideBaySizes,preferredEndABaySizes:()=>e.endABaySizes,preferredEndBBaySizes:()=>e.endBBaySizes,height:()=>e.height,pitch:()=>e.pitch,girtType:()=>e.girtType,purlinType:()=>e.purlinType,windCategory:()=>e.windCategory,openings:()=>e.openings,openBays:()=>e.openBays,partitionWalls:()=>e.partitionWalls,frameMemberItemName:()=>e.frameMemberItemName,midFrameBackToBack:()=>e.midFrameBackToBack??rf,endwallMullionItemName:()=>e.endwallMullionItemName,braceItemName:()=>e.braceItemName,purlinItemName:()=>e.purlinItemName,sideGirtItemName:()=>e.sideGirtItemName,endGirtItemName:()=>e.endGirtItemName,purlinSpacing:()=>e.purlinSpacing??lf,sideGirtSpacing:()=>e.sideGirtSpacing??of,endGirtSpacing:()=>e.endGirtSpacing??sf,hasKneeBraces:()=>e.hasKneeBraces??af,hasApexBraces:()=>e.hasApexBraces??hf,kneeBracePctOfSpan:()=>e.kneeBracePctOfSpan??cf,kneeBracePctOfWallHeight:()=>e.kneeBracePctOfWallHeight??df,apexBracePctOfSpan:()=>e.apexBracePctOfSpan??uf,sheetingLowPoly:()=>!1,textures:a()}));this.components=t(()=>h().components());let d=g=>{const P="Unset";let M;if(g.valueToDisplayValue==null)M=void 0;else{let v=g.valueToDisplayValue;M=k=>k==P?P:v(k)}return ft({displayName:g.displayName,value:()=>g.value()??P,setValue:v=>{v==P?g.setValue(void 0):g.setValue(v)},possibleValues:t(()=>[P,...g.possibleValues()]),valueToDisplayValue:M})},c=g=>d({displayName:g.displayName,value:()=>{let P=g.value();if(P!=null)return P?"Yes":"No"},setValue:P=>{P==null?g.setValue(void 0):g.setValue(P=="Yes")},possibleValues:()=>["No","Yes"]});this.properties=t(()=>[{displayName:"Properties",fields:[ft({displayName:()=>"Roof Type",value:()=>e.roofType,setValue:g=>n("roofType",g),possibleValues:t(()=>["Gable","Skillion"])}),ft({displayName:()=>"Construction Type",value:()=>e.constructionType,setValue:g=>n("constructionType",g),possibleValues:t(()=>["Welded","Componentry"])}),se({displayName:()=>"Span",value:()=>e.span,setValue:g=>n("span",g)}),se({displayName:()=>"Length",value:()=>e.length,setValue:g=>n("length",g)}),se({displayName:()=>"Height",value:()=>e.height,setValue:g=>n("height",g)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:g=>n("pitch",g)}),Tn({displayName:()=>"Side Bay Sizes",value:()=>h().sideBaySizes(),setValue:g=>n("sideBaySizes",g),totalLengthChangeAllowed:()=>!0}),Tn({displayName:()=>"End A Bay Sizes",value:()=>h().endABaySizes(),setValue:g=>n("endABaySizes",g),totalLengthChangeAllowed:()=>!1}),Tn({displayName:()=>"End B Bay Sizes",value:()=>h().endBBaySizes(),setValue:g=>n("endBBaySizes",g),totalLengthChangeAllowed:()=>!1})],expanded:()=>!0},{displayName:"Engineering",fields:[d({displayName:()=>"Frame",value:()=>e.frameMemberItemName,setValue:g=>n("frameMemberItemName",g),possibleValues:t(()=>Object.keys(yt))}),d({displayName:()=>"Mid Frame Type",value:t(()=>{if(e.midFrameBackToBack!=null)return e.midFrameBackToBack?"Double":"Single"}),setValue:g=>{let P;g==null?P=void 0:P=g=="Double",n("midFrameBackToBack",P)},possibleValues:()=>["Single","Double"]}),d({displayName:()=>"Endwall Mullion",value:()=>e.endwallMullionItemName,setValue:g=>n("endwallMullionItemName",g),possibleValues:t(()=>Object.keys(yt))}),d({displayName:()=>"Brace",value:()=>e.braceItemName,setValue:g=>n("braceItemName",g),possibleValues:t(()=>Object.keys(yt))}),d({displayName:()=>"Purlin",value:()=>e.purlinItemName,setValue:g=>n("purlinItemName",g),possibleValues:t(()=>[...Object.keys(Ai),...Object.keys(sn)])}),d({displayName:()=>"Sidewall Girt",value:()=>e.sideGirtItemName,setValue:g=>n("sideGirtItemName",g),possibleValues:t(()=>[...Object.keys(Ai),...Object.keys(sn)])}),d({displayName:()=>"Endwall Girt",value:()=>e.endGirtItemName,setValue:g=>n("endGirtItemName",g),possibleValues:t(()=>[...Object.keys(Ai),...Object.keys(sn)])}),Ti({displayName:()=>"Purlin Spacing",value:()=>e.purlinSpacing,setValue:g=>n("purlinSpacing",g)}),Ti({displayName:()=>"Side Girt Spacing",value:()=>e.sideGirtSpacing,setValue:g=>n("sideGirtSpacing",g)}),Ti({displayName:()=>"End Girt Spacing",value:()=>e.endGirtSpacing,setValue:g=>n("endGirtSpacing",g)}),c({displayName:()=>"Has Knee Brace",value:()=>e.hasKneeBraces,setValue:g=>n("hasKneeBraces",g)}),c({displayName:()=>"Has Apex Brace",value:()=>e.hasApexBraces,setValue:g=>n("hasApexBraces",g)}),Ti({displayName:()=>"Knee Brace % of Span",value:()=>e.kneeBracePctOfSpan,setValue:g=>n("kneeBracePctOfSpan",g)}),Ti({displayName:()=>"Knee Brace % of Wall Ht",value:()=>e.kneeBracePctOfWallHeight,setValue:g=>n("kneeBracePctOfWallHeight",g)}),Ti({displayName:()=>"Apex Brace % of Span",value:()=>e.apexBracePctOfSpan,setValue:g=>n("apexBracePctOfSpan",g)})],expanded:()=>!0}]),this.insertOpeningWalls=()=>h().insertOpeningWalls(),this.insertPartitionWalls=()=>h().insertPartitionWalls(),this.insertOpening=t(()=>g=>{n("openings",[...e.openings,g])}),this.insertPartitionWall=t(()=>g=>{n("partitionWalls",[...e.partitionWalls,{location:g,id:zt(),flipped:!1}])});let u=g=>e.openings.find(P=>P.id==g),S=(g,P)=>{n("openings",e.openings.map(M=>M.id!=g?M:P(M)))},b=t(()=>h().openingSelectables().map(P=>({id:()=>P.id,space:()=>P.space,localAabb:()=>P.localAabb,properties:t(()=>[{displayName:"Opening",fields:[se({displayName:()=>"Height",value:t(()=>u(P.id)?.height??0),setValue:M=>S(P.id,v=>({...v,height:M}))}),se({displayName:()=>"Width",value:t(()=>u(P.id)?.width??0),setValue:M=>S(P.id,v=>({...v,width:M}))}),se({displayName:()=>"Head Height",value:t(()=>u(P.id)?.headHeight??0),setValue:M=>S(P.id,v=>({...v,headHeight:M}))})],expanded:()=>!0},{displayName:"Position",fields:[jn({displayName:()=>"Location",value:t(()=>{let M=u(P.id);return M==null?"":M.location.toArray().join(".")}),setValue:M=>{let v=M.split("."),k=We.fromArray(v);S(P.id,z=>({...z,location:k}))}})],expanded:()=>!0}]),delete:()=>{n("openings",e.openings.filter(M=>M.id!=P.id))}}))),N=/^(Sidewall[AB]|Endwall[AB])\.Bay\[([0-9]+)\]$/,w=g=>{let P=N.exec(g);if(P==null)return t(()=>[]);let M=P[1],v=Number.parseInt(P[2]),k=We.fromArray([M,"Bay",v.toString()]),z=t(()=>e.openBays.find(I=>I.location.equals(k))),x=t(()=>{let I=z();if(I!=null)switch(I.type){case"Fully Open":return;case"Upper Infill":return I.fromHeight;case"Skirted":return I.fromHeight}}),A=t(()=>{let I=z();if(I!=null)switch(I.type){case"Fully Open":return;case"Upper Infill":return;case"Skirted":return I.toHeight}});return t(()=>[{displayName:"Bay",fields:[ft({displayName:()=>"Sheeted Type",value:t(()=>{let I=z();if(I==null)return"Full";switch(I.type){case"Fully Open":return"Open";case"Upper Infill":return"Upper Infill";case"Lower Infill":return"Lower Infill";case"Skirted":return"Skirted"}}),setValue:I=>{switch(I){case"Full":{n("openBays",e.openBays.filter(O=>!O.location.equals(k)));break}case"Open":{let O=!1,E=[],F={type:"Fully Open",location:k};for(let $=0;$<e.openBays.length;++$)e.openBays[$].location.equals(k)?(E.push(F),O=!0):E.push(e.openBays[$]);O||E.push(F),n("openBays",E);break}case"Upper Infill":{let O=!1,E=[],F={type:"Upper Infill",location:k,fromHeight:e.height-300};for(let $=0;$<e.openBays.length;++$)e.openBays[$].location.equals(k)?(E.push(F),O=!0):E.push(e.openBays[$]);O||E.push(F),n("openBays",E);break}case"Skirted":{let O=!1,E=[],F={type:"Skirted",location:k,fromHeight:300,toHeight:1e3};for(let $=0;$<e.openBays.length;++$)e.openBays[$].location.equals(k)?(E.push(F),O=!0):E.push(e.openBays[$]);O||E.push(F),n("openBays",E);break}}},possibleValues:t(()=>["Full","Open","Upper Infill","Skirted"])}),...x()==null?[]:[se({displayName:()=>"From Height",value:()=>x()??0,setValue:I=>n("openBays",e.openBays.map(O=>O.location.equals(k)?{...O,fromHeight:I}:O))})],...A()==null?[]:[se({displayName:()=>"To Height",value:()=>A()??0,setValue:I=>n("openBays",e.openBays.map(O=>O.location.equals(k)?{...O,toHeight:I}:O))})]],expanded:()=>!0}])},p=t(()=>h().baySelectables().map(({id:P,space:M,localAabb:v,rayCollisionTime:k})=>({id:()=>P,space:()=>M,localAabb:()=>v,rayCollisionTime:()=>k,properties:w(P)})));this.subObjects=t(()=>[...b(),...p()])}}class mf{constructor(e){let n=()=>68.6,r=()=>50.9,o=t(()=>{switch(e.sheetingType()){case"Corrugated 0.42":return 16;case"Steelclad 0.42":case"Supersaw":case"Unirib":return 35;default:return 30}}),l=()=>5,s=()=>5,a=t(()=>new T({itemName:()=>"Rail",length:()=>e.width()-2*s(),transform:t(()=>m.create(i.create(s(),.5*(n()-r()),0),y.identity)),mkObject3d:t(()=>{let N=e.width()-2*s();return w=>{let p=Vr(N),g=new rt({color:"#808080"});return Gt(()=>{let P=Pt[e.postRailColour()],M;P==null?M="#808080":M=P.colourHex,g.color.setStyle(M),w()}),Fe(()=>{p.dispose(),g.dispose()}),new xe(p,g)}})})),h=t(()=>new T({itemName:()=>"Rail",length:()=>e.width()-2*s(),transform:t(()=>m.create(i.create(e.width()-s(),.5*(n()-r()),e.height()),y.fromUV(i.negUnitX,i.unitY))),mkObject3d:t(()=>{let N=e.width()-2*s();return w=>{let p=Vr(N),g=new rt({color:"#808080"});return Gt(()=>{let P=Pt[e.postRailColour()],M;P==null?M="#808080":M=P.colourHex,g.color.setStyle(M),w()}),Fe(()=>{p.dispose(),g.dispose()}),new xe(p,g)}})})),d=t(()=>new T({itemName:()=>"Post",length:e.height,transform:t(()=>m.create(i.create(0,0,e.height()),y.fromUV(i.negUnitZ,i.unitY))),mkObject3d:t(()=>{let N=e.height();return w=>{let p=Lr(N),g=new rt({color:"#808080"});return Gt(()=>{let P=Pt[e.postRailColour()],M;P==null?M="#808080":M=P.colourHex,g.color.setStyle(M),w()}),Fe(()=>{p.dispose(),g.dispose()}),new xe(p,g)}})})),c=t(()=>new T({itemName:()=>"Post",length:e.height,transform:t(()=>m.create(i.create(e.width(),0,0),y.fromUV(i.unitZ,i.unitY))),mkObject3d:t(()=>{let N=e.height();return w=>{let p=Lr(N),g=new rt({color:"#808080"});return Gt(()=>{let P=Pt[e.postRailColour()],M;P==null?M="#808080":M=P.colourHex,g.color.setStyle(M),w()}),Fe(()=>{p.dispose(),g.dispose()}),new xe(p,g)}})})),u=new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.width()-2*l(),0),f.create(e.width()-2*l(),e.height()-2*l()),f.create(0,e.height()-2*l())]),openings:()=>[],colour:e.sheetingColour,sheetingType:e.sheetingType,previewOpening:()=>{}}),S=t(()=>m.create(i.create(l(),.5*(n()+o()),l()),y.identity)),b=t(()=>new T({children:u.components,transform:S}));this.components=t(()=>[a(),h(),d(),c(),b()])}}let gf={width:{displayName:"Width",typeSchema:{type:"Number"},defaultValue:1600},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:1200},sheetingType:{displayName:"Sheeting Type",typeSchema:{type:"String",possibleValues:["Corrugated 0.42","Steelclad 0.42","Supersaw","Unirib"]},defaultValue:"Corrugated 0.42"},postRailColour:{displayName:"Post Rail Colour",typeSchema:{type:"String"},defaultValue:"Basalt",optional:!0},sheetingColour:{displayName:"Sheeting Colour",typeSchema:{type:"String"},defaultValue:"Deep Ocean",optional:!0}};const yf=new Ae({typeName:"SheetedFence",displayName:"Sheeted Fence",propertiesSchema:gf}),bf=yf;class wf{componentType=bf;create(e,n,r,o,l){return new Sf(n,r,o,l)}}let ro=new wf;Be(ro);class Sf{type=ro;constructor(e,n,r,o){this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new mf({width:()=>e.width,height:()=>e.height,sheetingType:()=>e.sheetingType,postRailColour:()=>e.postRailColour,sheetingColour:()=>e.sheetingColour});this.components=l.components,this.properties=t(()=>[{displayName:"Properties",fields:[se({displayName:()=>"Width",value:()=>e.width,setValue:s=>n("width",s)}),se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),ft({displayName:()=>"Sheeting Type",value:()=>e.sheetingType,setValue:s=>n("sheetingType",s),possibleValues:t(()=>["Corrugated 0.42","Steelclad 0.42","Supersaw","Unirib"])}),ci({displayName:()=>"Post / Rail Colour",value:()=>e.postRailColour,setValue:s=>n("postRailColour",s),possibleValues:t(()=>Object.keys(Pt))}),ci({displayName:()=>"Sheeting Colour",value:()=>e.sheetingColour,setValue:s=>n("sheetingColour",s),possibleValues:t(()=>Object.keys(Pt))})],expanded:()=>!0}])}}let Pf={length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:1800},leftHeight:{displayName:"Left Height",typeSchema:{type:"Number"},defaultValue:1e3},rightHeight:{displayName:"Right Height",typeSchema:{type:"Number"},defaultValue:1e3},slatColour:{displayName:"Slat Colour",typeSchema:{type:"String"},defaultValue:"Shale Grey"},postRailColour:{displayName:"Post Rail Colour",typeSchema:{type:"String"},defaultValue:"Deep Ocean"}};const Nf=new Ae({typeName:"SlatFence",displayName:"Slat Fence",propertiesSchema:Pf}),Mf=Nf;class Cf{constructor(){this.componentType=Mf}create(e,n,r,o,l){return new vf(n,r,o,l)}}let lo=new Cf;Be(lo);class vf{constructor(e,n,r,o){this.type=lo,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new Ei({length:()=>e.length,leftHeight:()=>e.leftHeight,rightHeight:()=>e.rightHeight,slatColour:()=>e.slatColour,postRailColour:()=>e.postRailColour});this.components=l.components,this.properties=t(()=>[{displayName:"Slat Fence",fields:[se({displayName:()=>"Length",value:()=>e.length,setValue:s=>n("length",s)}),se({displayName:()=>"Left Height",value:()=>e.leftHeight,setValue:s=>n("leftHeight",s)}),se({displayName:()=>"Right Height",value:()=>e.rightHeight,setValue:s=>n("rightHeight",s)})],expanded:()=>!0}])}}class Jr{constructor(e){this.centre=e.centre,this.radius=e.radius}intersectCircle(e){let n=Tf(this.centre.x,this.centre.y,this.radius,e.centre.x,e.centre.y,e.radius);if(n!=!1)return{pt1:f.create(n[0],n[2]),pt2:f.create(n[1],n[3])}}}function Tf(C,e,n,r,o,l){var s,a,h,d,c,u,S,b,N;if(a=r-C,h=o-e,d=Math.sqrt(h*h+a*a),d>n+l||d<Math.abs(n-l))return!1;s=(n*n-l*l+d*d)/(2*d),b=C+a*s/d,N=e+h*s/d,c=Math.sqrt(n*n-s*s),u=-h*(c/d),S=a*(c/d);var w=b+u,p=b-u,g=N+S,P=N-S;return[w,p,g,P]}class kf{constructor(e){let n=()=>4,r=t(()=>Math.acos(.5*(e.topSize()-e.baseSize())*Math.SQRT2/e.sideEdgeLength())),o=()=>240,l=()=>90,s=()=>80,a=()=>230,h=t(()=>{let P=r(),M=Math.cos(P),v=Math.sin(P),k=f.zero,z=k.add(f.create(-a()*M,a()*v)),x=new Jr({centre:k,radius:l()}),A=new Jr({centre:z.add(f.create(s(),0)),radius:o()}),I=x.intersectCircle(A);if(I==null)return[];let O=I.pt1.y<I.pt2.y?I.pt1:I.pt2,E=O.add(f.create(-s(),0));return[k,z,E,O]}),d=t(()=>Math.abs(h().reduce((P,M)=>Math.min(P,M.y),0))+n()),c=t(()=>({plate:new rn({outline:t(()=>{let P=e.baseSize();return[f.create(-.5*P,-.5*P),f.create(.5*P,-.5*P),f.create(.5*P,.5*P),f.create(-.5*P,.5*P)]}),thickness:()=>4}),space:t(()=>m.create(i.create(0,0,d()),y.identity))})),u=t(()=>new T({children:c().plate.components,transform:c().space})),S=t(()=>{let P=e.baseSize(),M=e.topSize(),v;{let A=e.sideEdgeLength(),I=.5*(e.topSize()-e.baseSize());v=Math.sqrt(A*A-I*I)}let k=[],z;z=new rn({outline:t(()=>[f.create(-.5*P,0),f.create(.5*P,0),f.create(.5*M,v),f.create(-.5*M,v)]),thickness:()=>4});let x;{let A=v,I=.5*(e.topSize()-e.baseSize()),O=Math.sqrt(A*A-I*I),E=I,F=O,$=Math.sqrt(E*E+F*F);x=f.create(E/$,F/$)}return k.push({plate:z,space:t(()=>m.create(i.create(0,-.5*e.baseSize(),d()),y.fromUV(i.unitX,i.create(0,-x.x,x.y))))}),k.push({plate:z,space:t(()=>m.create(i.create(.5*e.baseSize(),0,d()),y.fromUV(i.unitY,i.create(x.x,0,x.y))))}),k.push({plate:z,space:t(()=>m.create(i.create(0,.5*e.baseSize(),d()),y.fromUV(i.negUnitX,i.create(0,x.x,x.y))))}),k.push({plate:z,space:t(()=>m.create(i.create(-.5*e.baseSize(),0,d()),y.fromUV(i.negUnitY,i.create(-x.x,0,x.y))))}),k}),b=t(()=>S().map(({plate:P,space:M})=>new T({children:P.components,transform:M}))),N=t(()=>{let P=new rn({outline:h,thickness:n}),M=[];return M.push({plate:P,space:t(()=>m.create(i.create(-.5*e.baseSize(),-.5*e.baseSize(),d()),y.fromUV(i.create(Math.SQRT1_2,Math.SQRT1_2,0),i.unitZ)))}),M.push({plate:P,space:t(()=>m.create(i.create(.5*e.baseSize(),-.5*e.baseSize(),d()),y.fromUV(i.create(-Math.SQRT1_2,Math.SQRT1_2,0),i.unitZ)))}),M.push({plate:P,space:t(()=>m.create(i.create(.5*e.baseSize(),.5*e.baseSize(),d()),y.fromUV(i.create(-Math.SQRT1_2,-Math.SQRT1_2,0),i.unitZ)))}),M.push({plate:P,space:t(()=>m.create(i.create(-.5*e.baseSize(),.5*e.baseSize(),d()),y.fromUV(i.create(Math.SQRT1_2,-Math.SQRT1_2,0),i.unitZ)))}),M}),w=t(()=>N().map(({plate:P,space:M})=>new T({children:P.components,transform:M}))),p=t(()=>{let P=90,M=50,v=new rn({outline:t(()=>[f.zero,f.create(M,0),f.create(M,P),f.create(0,P)]),thickness:()=>4});return N().map(({plate:k,space:z})=>({plate:v,space:t(()=>{let x=k.outline()[2],A=z().o,I=z().u,O=z().w;return m.create(A.sub(O.scale(.5*M)).sub(I.scale(-x.x+.5*(P-s()))).sub(i.create(0,0,d())),y.fromWU(i.unitZ,O))})}))}),g=t(()=>p().map(({plate:P,space:M})=>new T({children:P.components,transform:M})));this.components=t(()=>[u(),...b(),...w(),...g()]),this.totalPlateArea=t(()=>[c(),...S(),...N(),...p()].reduce((P,M)=>P+M.plate.plateArea(),0)),this.allocateLabels=P=>{},this.mkPlatesForDoc=P=>t(()=>[t(()=>({label:"Base Plate",quantity:1,outline:c().plate.outline()})),t(()=>({label:"Side Plate",quantity:4,outline:S()[0].plate.outline()})),t(()=>({label:"Leg Plate",quantity:4,outline:N()[0].plate.outline()})),t(()=>({label:"Feet",quantity:4,outline:p()[0].plate.outline()}))])}}class rn{constructor(e){let n=t(()=>new T({mkObject3d:t(()=>{let r=e.outline();if(r.length<3)return()=>new nt;let o=e.thickness();return l=>{let s=.001,a=new Et;a.moveTo(r[0].x*s,r[0].y*s);for(let w=1;w<r.length;++w)a.lineTo(r[w].x*s,r[w].y*s);a.closePath();let h=new It(a,{bevelEnabled:!1,depth:o*s}),d=new rt({color:"#808080"}),c=new bt(h),u=new Tt({color:"black"});Fe(()=>{h.dispose(),d.dispose(),c.dispose(),u.dispose()});let S=new xe(h,d),b=new ht(c,u),N=new nt;return N.add(S),N.add(b),N}})}));this.outline=e.outline,this.components=t(()=>[n()]),this.plateArea=t(()=>{let r=e.outline(),o=0;for(let l=0;l<r.length;++l){let s=(l+1)%r.length;o+=r[l].cross(r[s])}return .5*Math.abs(o)/1e6})}}let zf={topSize:{displayName:"Top Size",typeSchema:{type:"Number"},defaultValue:700},baseSize:{displayName:"Base Size",typeSchema:{type:"Number"},defaultValue:300},sideEdgeLength:{displayName:"Side Edge Length",typeSchema:{type:"Number"},defaultValue:360}};const Af=new Ae({typeName:"SquareFirePit",displayName:"Square Fire Pit",propertiesSchema:zf}),xf=Af;class If{constructor(){this.componentType=xf}create(e,n,r,o,l){return new Bf(n,r,o,l)}}let oo=new If;Be(oo);class Bf{constructor(e,n,r,o){this.type=oo,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new kf({topSize:()=>e.topSize,baseSize:()=>e.baseSize,sideEdgeLength:()=>e.sideEdgeLength});this.components=l.components,this.allocateLabels=l.allocateLabels,this.mkPlatesForDoc=l.mkPlatesForDoc}}class Of{constructor(e){let n=()=>"40x2.0 SHS",r=t(()=>new Mi({size:Qt[n()].size,thickness:Qt[n()].thickness})),o=()=>"100x20 Timber",l=t(()=>new et({webSize:100,flangeSize:20})),s=t(()=>e.pitch()*Math.PI/180),a=t(()=>Math.cos(s())),h=t(()=>Math.sin(s())),d=t(()=>Math.tan(s())),c=t(()=>e.height()+e.span()*d()),u=t(()=>c()-r().size*d()),S=5,b=t(()=>({frame:new Ff({length:t(()=>e.length()-2*r().size),height:u,doorWidth:e.frontDoorWidth,doorClearance:()=>S,frameMemberItemName:n,frameMemberProperties:r}),space:t(()=>m.create(i.create(r().size,0,0),y.identity))})),N=t(()=>new T({children:t(()=>b().frame.components()),transform:t(()=>b().space())})),w=t(()=>{let F=new Vf({length:e.span,height:e.height,pitch:e.pitch,sheetedSpan:e.sheetedSpan,frameMemberItemName:n,frameMemberProperties:r});return[{frame:F,space:t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))},{frame:F,space:t(()=>m.create(i.create(e.length()-r().size,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))}]}),p=t(()=>w().map(({frame:F,space:$})=>new T({children:F.components,transform:$}))),g=t(()=>({frame:new Hf({width:t(()=>e.length()-2*r().size),height:e.height,rearOpeningHeadHeight:e.rearOpeningHeadHeight,rearOpeningSillHeight:e.rearOpeningSillHeight,frameMemberItemName:n,frameMemberProperties:r}),space:t(()=>m.create(i.create(e.length()-r().size,e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))})),P=t(()=>new T({children:g().frame.components,transform:g().space})),M=t(()=>({frame:new Ef({span:e.rearOpeningSpan,length:e.length,height:t(()=>e.rearOpeningHeadHeight()-e.rearOpeningSillHeight()+r().size),pitch:e.rearOpeningPitch,lidOpeningAngle:e.lidOpeningAngle,frameMemberItemName:n,frameMemberProperties:r}),space:t(()=>m.create(i.create(e.length(),e.span(),e.rearOpeningSillHeight()-r().size),y.fromWU(i.unitZ,i.negUnitX)))})),v=t(()=>new T({children:M().frame.components,transform:M().space})),k=t(()=>({frame:new Rf({length:e.length,rearOpeningSpan:e.rearOpeningSpan,insideOverhang:e.insideNestingOverhang,timberItemName:o,timberProperties:l,frameMemberProperties:r,numNestingAreas:e.numNestingAreas}),space:t(()=>m.create(i.create(0,e.span(),e.rearOpeningSillHeight()),y.identity))})),z=t(()=>new T({children:k().frame.components,transform:k().space})),x=t(()=>{let F=e.rearOpeningSillHeight()+2*l().flangeSize,$=F,G=Math.sqrt(F*F+$*$),J=$/G,K=F/G,te=200;return new T({itemName:o,length:()=>G,timberProperties:l,transform:t(()=>m.create(i.create(e.length()-l().webSize-te,e.span()-e.insideNestingOverhang()-$,0),y.fromUV(i.create(0,J,K),i.unitX)))})}),A=t(()=>[{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.sheetedSpan(),0),f.create(e.sheetedSpan(),e.height()+e.sheetedSpan()*d()),f.create(0,e.height())]),openings:t(()=>[]),colour:()=>"Shale Grey",previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)))},{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.sheetedSpan(),0),f.create(e.sheetedSpan(),e.height()),f.create(0,e.height()+e.sheetedSpan()*d())]),openings:t(()=>[]),colour:()=>"Shale Grey",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),e.span()-e.sheetedSpan(),0),y.fromWU(i.unitZ,i.unitY)))},{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,e.rearOpeningHeadHeight()),f.create(e.length(),e.rearOpeningHeadHeight()),f.create(e.length(),e.height()),f.create(0,e.height())]),openings:t(()=>[]),colour:()=>"Shale Grey",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))},{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.rearOpeningSillHeight()),f.create(0,e.rearOpeningSillHeight())]),openings:t(()=>[]),colour:()=>"Shale Grey",sheetingType:()=>"Flat",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)))}]),I=t(()=>A().map(({sheeting:F,space:$})=>new T({children:F.components,transform:$}))),O=t(()=>[{sheeting:new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-e.overhang()),f.create(e.length(),-e.overhang()),f.create(e.length(),e.span()/a()),f.create(0,e.span()/a())]),openings:t(()=>[]),colour:()=>"Shale Grey",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.create(0,-a(),h()),i.negUnitX)))}]),E=t(()=>O().map(({sheeting:F,space:$})=>new T({usage:()=>"Roof Sheeting",children:F.components,transform:$})));this.components=t(()=>[N(),...p(),P(),v(),z(),x(),...I(),...E()])}}class Ff{constructor(e){let n=t(()=>new T({itemName:e.frameMemberItemName,length:e.length,shsProperties:e.frameMemberProperties,transform:()=>m.identity})),r=t(()=>new T({itemName:e.frameMemberItemName,length:e.length,shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(0,0,e.height()-e.frameMemberProperties().size),y.identity))})),o=t(()=>new T({itemName:e.frameMemberItemName,length:t(()=>e.height()-2*e.frameMemberProperties().size),shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(e.doorWidth()+e.frameMemberProperties().size,0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))})),l=t(()=>({mesh:new Zt({width:t(()=>e.length()-e.doorWidth()-e.frameMemberProperties().size),apexHeight:t(()=>e.height()-2*e.frameMemberProperties().size),pitch:()=>0,pitchOffset:()=>0}),space:t(()=>m.create(i.create(e.doorWidth()+e.frameMemberProperties().size,.5*e.frameMemberProperties().size,e.frameMemberProperties().size),y.identity))})),s=t(()=>new T({children:t(()=>l().mesh.components()),transform:t(()=>l().space())})),a=t(()=>({door:new Lf({width:e.doorWidth,height:t(()=>e.height()-2*e.frameMemberProperties().size),doorClearance:e.doorClearance,frameMemberItemName:e.frameMemberItemName,frameMemberProperties:e.frameMemberProperties}),space:t(()=>m.create(i.create(0,0,e.frameMemberProperties().size),y.identity))})),h=t(()=>new T({children:t(()=>a().door.components()),transform:t(()=>a().space())}));this.components=t(()=>[n(),r(),o(),s(),h()])}}class Vf{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=t(()=>e.height()+e.length()*l()),a=t(()=>new T({itemName:e.frameMemberItemName,length:e.length,shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.zero,y.identity))})),h=t(()=>new T({itemName:e.frameMemberItemName,length:t(()=>e.length()/r()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45+.5*e.pitch(),backBackCutAngle:()=>45-.5*e.pitch(),transform:t(()=>m.create(i.create(e.length(),0,s()),y.fromUV(i.create(-r(),0,-o()),i.unitY)))})),d=t(()=>new T({itemName:e.frameMemberItemName,length:t(()=>e.height()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45-.5*e.pitch(),backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(0,0,e.height()),y.fromUV(i.negUnitZ,i.unitY)))})),c=t(()=>new T({itemName:e.frameMemberItemName,length:t(()=>s()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45+.5*e.pitch(),transform:t(()=>m.create(i.create(e.length(),0,0),y.fromUV(i.unitZ,i.unitY)))})),u=t(()=>new T({itemName:e.frameMemberItemName,length:t(()=>e.height()+e.sheetedSpan()*l()-e.frameMemberProperties().size-e.frameMemberProperties().size/r()),shsProperties:e.frameMemberProperties,backBackCutAngle:()=>e.pitch(),transform:t(()=>m.create(i.create(e.sheetedSpan(),0,e.frameMemberProperties().size),y.fromUV(i.unitZ,i.unitY)))})),S=t(()=>({mesh:new Zt({width:t(()=>e.length()-e.sheetedSpan()-e.frameMemberProperties().size),apexHeight:t(()=>e.height()+e.length()*l()-e.frameMemberProperties().size-e.frameMemberProperties().size/r()-e.frameMemberProperties().size*l()),pitch:()=>e.pitch(),pitchOffset:t(()=>e.length()-e.sheetedSpan()-e.frameMemberProperties().size)}),space:t(()=>m.create(i.create(e.sheetedSpan(),.5*e.frameMemberProperties().size,e.frameMemberProperties().size),y.identity))})),b=t(()=>new T({children:t(()=>S().mesh.components()),transform:t(()=>S().space())}));this.components=t(()=>[a(),h(),d(),c(),u(),b()])}}class Lf{constructor(e){let n=t(()=>new T({itemName:e.frameMemberItemName,length:t(()=>e.width()-2*e.doorClearance()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(e.doorClearance(),0,e.doorClearance()),y.identity))})),r=t(()=>new T({itemName:e.frameMemberItemName,length:t(()=>e.width()-2*e.doorClearance()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(e.width()-e.doorClearance(),0,e.height()-e.doorClearance()),y.fromUV(i.negUnitX,i.unitY)))})),o=t(()=>new T({itemName:e.frameMemberItemName,length:t(()=>e.height()-2*e.doorClearance()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(e.doorClearance(),0,e.height()-e.doorClearance()),y.fromUV(i.negUnitZ,i.unitY)))})),l=t(()=>new T({itemName:e.frameMemberItemName,length:t(()=>e.height()-2*e.doorClearance()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(e.width()-e.doorClearance(),0,e.doorClearance()),y.fromUV(i.unitZ,i.unitY)))})),s=t(()=>({mesh:new Zt({width:t(()=>e.width()-2*(e.doorClearance()+e.frameMemberProperties().size)),apexHeight:t(()=>e.height()-2*(e.doorClearance()+e.frameMemberProperties().size)),pitch:()=>0,pitchOffset:()=>0}),space:t(()=>m.create(i.create(e.doorClearance()+e.frameMemberProperties().size,.5*e.frameMemberProperties().size,e.doorClearance()+e.frameMemberProperties().size),y.identity))})),a=t(()=>new T({children:t(()=>s().mesh.components()),transform:t(()=>s().space())})),h=t(()=>[{hinge:new pn,space:t(()=>m.create(i.create(.5*e.doorClearance(),0,e.height()*1/4),y.identity))},{hinge:new pn,space:t(()=>m.create(i.create(.5*e.doorClearance(),0,e.height()*3/4),y.identity))}]),d=t(()=>h().map(({hinge:c,space:u})=>new T({children:c.components,transform:u})));this.components=t(()=>[n(),r(),o(),l(),a(),...d()])}}class Hf{constructor(e){let n=t(()=>new T({itemName:e.frameMemberItemName,length:e.width,shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.zero,y.identity))})),r=t(()=>new T({itemName:e.frameMemberItemName,length:e.width,shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(e.width(),0,e.height()),y.fromUV(i.negUnitX,i.unitY)))})),o=t(()=>new T({itemName:e.frameMemberItemName,length:e.width,shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(0,0,e.rearOpeningHeadHeight()),y.identity))})),l=t(()=>new T({itemName:e.frameMemberItemName,length:e.width,shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(e.width(),0,e.rearOpeningSillHeight()),y.fromUV(i.negUnitX,i.unitY)))}));this.components=t(()=>[n(),r(),o(),l()])}}class Ef{constructor(e){let n=()=>10,r=t(()=>e.pitch()*Math.PI/180),o=t(()=>Math.cos(r())),l=t(()=>Math.sin(r())),s=t(()=>Math.tan(r())),a=t(()=>e.height()-e.span()*s()),h=t(()=>90-.5*(90+e.pitch())),d=t(()=>e.span()/o()),c=t(()=>[new T({itemName:e.frameMemberItemName,length:e.span,shsProperties:e.frameMemberProperties,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(0,0,e.frameMemberProperties().size),y.fromWU(i.unitX,i.negUnitY)))}),new T({itemName:e.frameMemberItemName,length:e.span,shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,transform:t(()=>m.create(i.create(e.length(),-e.span(),e.frameMemberProperties().size),y.fromWU(i.negUnitX,i.unitY)))}),new T({itemName:e.frameMemberItemName,length:e.length,shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(0,-e.span(),e.frameMemberProperties().size),y.fromWU(i.unitY,i.unitX)))})]),u=t(()=>[new T({itemName:e.frameMemberItemName,length:t(()=>e.length()-2*e.frameMemberProperties().size),shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size,-e.span(),a()),y.fromUV(i.negUnitX,i.create(0,o(),l()))))}),new T({itemName:e.frameMemberItemName,length:t(()=>e.length()-2*e.frameMemberProperties().size),shsProperties:e.frameMemberProperties,transform:t(()=>m.create(i.create(e.frameMemberProperties().size,-e.frameMemberProperties().size*o()+e.frameMemberProperties().size*l(),e.height()-e.frameMemberProperties().size*l()-e.frameMemberProperties().size*o()),y.fromUV(i.unitX,i.create(0,o(),l()))))})]),S=t(()=>[new T({itemName:e.frameMemberItemName,length:t(()=>a()-e.frameMemberProperties().size),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>0,backBackCutAngle:h,transform:t(()=>m.create(i.create(0,-e.span(),e.frameMemberProperties().size),y.fromWU(i.unitY,i.unitZ)))}),new T({itemName:e.frameMemberItemName,length:t(()=>a()-e.frameMemberProperties().size),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>0,backBackCutAngle:h,transform:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size,-e.span(),e.frameMemberProperties().size),y.fromWU(i.unitY,i.unitZ)))})]),b=t(()=>[new T({itemName:e.frameMemberItemName,length:d,shsProperties:e.frameMemberProperties,frontBackCutAngle:h,backBackCutAngle:e.pitch,transform:t(()=>m.create(i.create(0,-e.span(),a()),y.fromUV(i.create(0,o(),l()),i.unitX)))}),new T({itemName:e.frameMemberItemName,length:d,shsProperties:e.frameMemberProperties,frontBackCutAngle:h,backBackCutAngle:e.pitch,transform:t(()=>m.create(i.create(e.length()-e.frameMemberProperties().size,-e.span(),a()),y.fromUV(i.create(0,o(),l()),i.unitX)))})]),N=t(()=>({lid:new Uf({length:t(()=>e.length()+2*(n()+e.frameMemberProperties().size)),width:t(()=>(e.span()+n())/o()),frameMemberItemName:e.frameMemberItemName,frameMemberProperties:e.frameMemberProperties}),space:t(()=>m.create(i.create(-n()-e.frameMemberProperties().size,-e.frameMemberProperties().size*o(),e.height()-e.frameMemberProperties().size*l()+e.frameMemberProperties().size*o()-e.frameMemberProperties().size/o()),y.fromAxisAngle(i.unitX,e.pitch()-e.lidOpeningAngle())))})),w=t(()=>new T({children:N().lid.components,transform:N().space})),p=t(()=>[{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.span(),0),f.create(e.span(),a()),f.create(0,e.height())]),openings:t(()=>[]),colour:()=>"Shale Grey",sheetingType:()=>"Flat",previewOpening:()=>{}}),space:t(()=>m.create(i.zero,y.fromWU(i.unitZ,i.negUnitY)))},{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(0,a())]),openings:t(()=>[]),colour:()=>"Shale Grey",sheetingType:()=>"Flat",previewOpening:()=>{}}),space:t(()=>m.create(i.create(e.length(),-e.span(),0),y.fromWU(i.unitZ,i.unitY)))},{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),a()),f.create(0,a())]),openings:t(()=>[]),colour:()=>"Shale Grey",sheetingType:()=>"Flat",previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,-e.span(),0),y.identity))}]),g=t(()=>p().map(({sheeting:P,space:M})=>new T({children:P.components,transform:M})));this.components=t(()=>[...c(),...u(),...S(),...b(),w(),...g()])}}class Uf{constructor(e){let n=()=>120,r=t(()=>[new T({itemName:e.frameMemberItemName,length:e.width,shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,transform:t(()=>m.create(i.create(0,-e.width(),-e.frameMemberProperties().size),y.fromWU(i.unitX,i.unitY)))}),new T({itemName:e.frameMemberItemName,length:e.width,shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,transform:t(()=>m.create(i.create(e.length(),-e.width(),0),y.fromWU(i.negUnitX,i.unitY)))}),new T({itemName:e.frameMemberItemName,length:e.length,shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(0,-e.width(),0),y.fromWU(i.unitY,i.unitX)))}),new T({itemName:e.frameMemberItemName,length:t(()=>e.width()-n()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(n(),-e.width()+n(),-e.frameMemberProperties().size),y.fromWU(i.unitX,i.unitY)))}),new T({itemName:e.frameMemberItemName,length:t(()=>e.width()-n()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(e.length()-n(),-e.width()+n(),0),y.fromWU(i.negUnitX,i.unitY)))}),new T({itemName:e.frameMemberItemName,length:t(()=>e.length()-2*n()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(n(),-e.width()+n(),0),y.fromWU(i.unitY,i.unitX)))}),new T({itemName:e.frameMemberItemName,length:t(()=>e.length()-2*n()),shsProperties:e.frameMemberProperties,frontBackCutAngle:()=>45,backBackCutAngle:()=>45,transform:t(()=>m.create(i.create(n(),0,-e.frameMemberProperties().size),y.fromWU(i.negUnitY,i.unitX)))})]),o=t(()=>[{sheeting:new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.width()),f.create(0,e.width())]),openings:t(()=>[]),colour:()=>"Shale Grey",sheetingType:()=>"Flat",previewOpening:()=>{}}),space:t(()=>m.create(i.create(0,-e.width(),0),y.fromWU(i.unitY,i.unitX)))}]),l=t(()=>o().map(({sheeting:h,space:d})=>new T({children:h.components,transform:d}))),s=t(()=>[{hinge:new pn,space:t(()=>m.create(i.create(e.length()*1/4,0,0),y.fromWU(i.unitX,i.unitY)))},{hinge:new pn,space:t(()=>m.create(i.create(e.length()*3/4,0,0),y.fromWU(i.unitX,i.unitY)))}]),a=t(()=>s().map(({hinge:h,space:d})=>new T({children:h.components,transform:d})));this.components=t(()=>[...r(),...l(),...a()])}}class Rf{constructor(e){let n=t(()=>{let a=[],h=3,d=.5*e.timberProperties().webSize,u=e.length()-.5*e.timberProperties().webSize-d,S=h-1,b=u/S,N=t(()=>e.insideOverhang()+e.rearOpeningSpan());for(let w=0;w<h;++w){let p=d+b*w;a.push(new T({itemName:e.timberItemName,length:N,timberProperties:e.timberProperties,transform:t(()=>m.create(i.create(p+.5*e.timberProperties().webSize,-e.insideOverhang(),0),y.fromWU(i.unitZ,i.unitY)))}))}return a}),r=t(()=>({members:t(()=>{let a=0,h=e.insideOverhang()+e.rearOpeningSpan(),d=h-a,c=Math.ceil(d/e.timberProperties().webSize),u=[];for(let S=0;S<c;++S){let b=S*e.timberProperties().webSize,N;S<c-1?N=e.timberProperties():N=new et({webSize:h-b,flangeSize:e.timberProperties().flangeSize}),u.push(new T({itemName:e.timberItemName,length:e.length,timberProperties:()=>N,transform:t(()=>m.create(i.create(0,b,0),y.identity))}))}return u}),space:t(()=>m.create(i.create(0,-e.insideOverhang(),e.timberProperties().flangeSize),y.identity))})),o=t(()=>new T({children:r().members,transform:r().space})),l=t(()=>new T({itemName:e.timberItemName,length:e.length,timberProperties:e.timberProperties,transform:t(()=>m.create(i.create(0,-e.frameMemberProperties().size,2*e.timberProperties().flangeSize),y.fromUV(i.unitX,i.unitZ)))})),s=t(()=>{let a=0,c=(e.length()-a)/e.numNestingAreas(),u=e.numNestingAreas()-1,S=[],b=t(()=>e.rearOpeningSpan()+e.frameMemberProperties().size);for(let N=0;N<u;++N){let w=a+c*(N+1);S.push(new T({itemName:e.timberItemName,length:b,timberProperties:e.timberProperties,transform:t(()=>m.create(i.create(w+.5*e.timberProperties().flangeSize,-e.frameMemberProperties().size,2*e.timberProperties().flangeSize),y.fromUV(i.unitY,i.unitZ)))}))}return S});this.components=t(()=>[...n(),o(),l(),...s()])}}class pn{constructor(){let e=()=>110,n=()=>40,r=()=>2,o=()=>10,l=t(()=>new T({mkObject3d:t(()=>s=>{let a=.001,h=new rt({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#808080"}),d=new Ni(n()*a,r()*a,e()*a),c=new bt(d),u=new Tt({color:"black"}),S=new xe(d,h),b=new xe(d,h),N=new ht(c,u),w=new ht(c,u),p=new hi(.5*o()*a,.5*o()*a,e()*a),g=new bt(p),P=new xe(p,h),M=new ht(g,u);S.position.set(-.5*n()*a,-.5*r()*a,0),N.position.set(-.5*n()*a,-.5*r()*a,0),b.position.set(.5*n()*a,-.5*r()*a,0),w.position.set(.5*n()*a,-.5*r()*a,0),P.rotateX(.5*Math.PI),M.rotateX(.5*Math.PI),P.translateZ(.5*o()*a),M.translateZ(.5*o()*a),Fe(()=>{h.dispose(),d.dispose(),c.dispose(),u.dispose(),p.dispose(),g.dispose()});let v=new nt;return v.add(S),v.add(b),v.add(P),v.add(N),v.add(w),v.add(M),v}),transform:t(()=>m.identity)}));this.components=t(()=>[l()])}}let Wf={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:2400},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:1770},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2030},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:5},overhang:{displayName:"Overhang",typeSchema:{type:"Number"},defaultValue:300},frontDoorWidth:{displayName:"Front Door Width",typeSchema:{type:"Number"},defaultValue:600},sheetedSpan:{displayName:"Sheeted Span",typeSchema:{type:"Number"},defaultValue:820},rearOpeningHeadHeight:{displayName:"Rear Opening Head Height",typeSchema:{type:"Number"},defaultValue:800},rearOpeningSillHeight:{displayName:"Rear Opening Sill Height",typeSchema:{type:"Number"},defaultValue:400},rearOpeningSpan:{displayName:"Rear Opening Span",typeSchema:{type:"Number"},defaultValue:350},rearOpeningPitch:{displayName:"Rear Opening Pitch",typeSchema:{type:"Number"},defaultValue:5},insideNestingOverhang:{displayName:"Inside Nesting Overhang",typeSchema:{type:"Number"},defaultValue:350},numNestingAreas:{displayName:"Num Nesting Areas",typeSchema:{type:"Number"},defaultValue:5},lidOpenAngle:{displayName:"Lid Open Angle",typeSchema:{type:"Number"},defaultValue:0}};const Xf=new Ae({typeName:"StandardChickenCoop",displayName:"Standard Chicken Coop",propertiesSchema:Wf}),Df=Xf;class _f{constructor(){this.componentType=Df}create(e,n,r,o,l){return new Yf(n,r,o,l)}}let so=new _f;Be(so);class Yf{constructor(e,n,r,o){this.type=so,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new Of({span:()=>e.span,length:()=>e.length,height:()=>e.height,pitch:()=>e.pitch,overhang:()=>e.overhang,frontDoorWidth:()=>e.frontDoorWidth,sheetedSpan:()=>e.sheetedSpan,rearOpeningHeadHeight:()=>e.rearOpeningHeadHeight,rearOpeningSillHeight:()=>e.rearOpeningSillHeight,rearOpeningSpan:()=>e.rearOpeningSpan,rearOpeningPitch:()=>e.rearOpeningPitch,lidOpeningAngle:()=>e.lidOpenAngle,insideNestingOverhang:()=>e.insideNestingOverhang,numNestingAreas:()=>e.numNestingAreas});this.components=l.components,this.properties=t(()=>[{displayName:"Standard Chicken Coop",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:s=>n("span",s)}),se({displayName:()=>"Length",value:()=>e.length,setValue:s=>n("length",s)}),se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:s=>n("pitch",s)}),se({displayName:()=>"Overhang",value:()=>e.overhang,setValue:s=>n("overhang",s)}),se({displayName:()=>"Door Width",value:()=>e.frontDoorWidth,setValue:s=>n("frontDoorWidth",s)}),se({displayName:()=>"Sheeted Span",value:()=>e.sheetedSpan,setValue:s=>n("sheetedSpan",s)}),se({displayName:()=>"Rear Opening Head Height",value:()=>e.rearOpeningHeadHeight,setValue:s=>n("rearOpeningHeadHeight",s)}),se({displayName:()=>"Rear Opening Sill Height",value:()=>e.rearOpeningSillHeight,setValue:s=>n("rearOpeningSillHeight",s)}),se({displayName:()=>"Inside Nesting Overhang",value:()=>e.insideNestingOverhang,setValue:s=>n("insideNestingOverhang",s)}),yn({displayName:()=>"Lid Open Angle",value:()=>e.lidOpenAngle,setValue:s=>n("lidOpenAngle",s),minValue:()=>0,maxValue:t(()=>90+e.rearOpeningPitch),stepSize:()=>5})],expanded:()=>!0}])}}let Gf={base64Data:{displayName:"Base 64 Data",typeSchema:{type:"String"},defaultValue:""},scale:{displayName:"Scale",typeSchema:{type:"Number"},defaultValue:1},opacity:{displayName:"Opacity",typeSchema:{type:"Number"},defaultValue:1}};const Zf=new Ae({typeName:"Svg",displayName:"SVG",propertiesSchema:Gf}),$f=Zf;class Kf{constructor(){this.componentType=$f}create(e,n,r,o,l){return new jf(n,r,o,l)}}let ao=new Kf;Be(ao);class jf{constructor(e,n,r,o){this.type=ao,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=t(()=>{let[h,d]=wt(al());return new _i().loadAsync("data:text/svg;base64,"+e.base64Data).then(c=>{d(hl(c))}).catch(c=>{d(cl(c))}),h}),s=t(()=>{let h=l()();if(h.type=="Success")return h.value}),a=t(()=>{let h=s(),d=new nt;if(h==null)return d;for(let c of h.paths){let u=new xt({color:c.color,side:$n});Fe(()=>u.dispose());let S=_i.createShapes(c);for(let b of S){let N=new yl(b),w=new xe(N,u);Fe(()=>{N.dispose()}),d.add(w)}}return d});this.components=t(()=>[new T({mkObject3d:t(()=>h=>a())})]),this.properties=t(()=>[{displayName:"SVG",fields:[Ss({displayName:()=>"SVG",value:()=>({base64Data:e.base64Data}),setValue:({base64Data:h})=>{n("base64Data",h)}}),se({displayName:()=>"Scale",value:()=>e.scale,setValue:h=>n("scale",h)}),yn({displayName:()=>"Opacity",value:()=>e.opacity,setValue:h=>n("opacity",h),minValue:()=>0,maxValue:()=>1,stepSize:()=>.1})],expanded:()=>!0}]);{let h=new ps,d=new je,c=new je;this.rayCollision=t(()=>u=>{let S=.001;d.set(u.origin.x*S,u.origin.y*S,u.origin.z*S),c.set(u.direction.x,u.direction.y,u.direction.z),h.set(d,c);let b=h.intersectObject(a());if(b.length!=0)return b[0].distance})}}}const Qf=70,qf=20,el=100;function Jf(){let C=.001,e=new De(35,0).multiplyScalar(C),n=new De(18,15).multiplyScalar(C),r=new De(30,40).multiplyScalar(C),o=new De(0,100).multiplyScalar(C);const l=new Et;l.moveTo(e.x,e.y),l.splineThru([n,r,o]),e=e.clone(),n=n.clone(),r=r.clone(),o=o.clone(),e.x*=-1,n.x*=-1,r.x*=-1,o.x*=-1,l.splineThru([r,n,e]),l.lineTo(0,0),l.closePath();let s=new It(l,{bevelEnabled:!1,depth:20*C});s.rotateX(.5*Math.PI),s.translate(35*C,20*C,0);let a=new rt({color:"#CCCCCC"}),h=new xe(s,a),d=new Tt({color:"#000000"}),c=new bt(s);const u=new ht(c,d);Fe(()=>{s.dispose(),c.dispose(),a.dispose(),d.dispose()});let S=new nt;return S.add(h),S.add(u),S}class ep{constructor(e){let n=t(()=>new et({webSize:Qf,flangeSize:qf})),r=t(()=>new T({mkObject3d:t(()=>l=>Jf()),transform:t(()=>new m(i.create(0,0,e.studLength()-el),y.identity))})),o=t(()=>new T({length:()=>e.studLength()-el,timberProperties:n,colour:()=>"Pearl White",transform:t(()=>new m(i.zero,y.fromWU(i.unitY,i.unitZ)))}));this.components=t(()=>[o(),r()])}}const ti=70,On=20,tl=20;class tp{constructor(e){let n=t(()=>new et({webSize:ti,flangeSize:On})),r=t(()=>{let h=.5*ti,c=e.length()-.5*ti-h,u=Math.ceil((ti+c+tl)/(ti+tl)),S=(ti+c-u*ti)/(u-1),b=ti+S;return Array(u).fill(void 0).map((N,w)=>h+w*b)}),o=t(()=>r().map(h=>({stud:new ep({studLength:t(()=>e.height()+200*Math.sin(Math.PI*h/e.length()))}),space:t(()=>m.create(i.create(h-.5*ti,0,0),y.identity))}))),l=t(()=>o().map(({stud:h,space:d})=>new T({children:h.components,transform:d}))),s=t(()=>new T({length:e.length,timberProperties:n,colour:()=>"Pearl White",transform:t(()=>m.create(i.create(0,On,300),y.fromWU(i.unitY,i.unitX)))})),a=t(()=>new T({length:e.length,timberProperties:n,colour:()=>"Pearl White",transform:t(()=>m.create(i.create(0,On,e.height()-300),y.fromWU(i.unitY,i.unitX)))}));this.components=t(()=>[s(),a(),...l()])}}let ip={};const np=new Ae({typeName:"HeritagePicketFence",displayName:"Heritage Picket Fence",propertiesSchema:ip}),rp=np;class lp{constructor(){this.isForTesting=!0,this.componentType=rp}create(e,n,r,o,l){return new op(n,r,o,l)}}let ho=new lp;Be(ho);class op{constructor(e,n,r,o){this.type=ho,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new tp({length:()=>2e3,height:()=>1200});this.components=l.components,this.properties=t(()=>[])}}class sp{constructor(e){let n=()=>"150x50x3.0 RHS",r=t(()=>new un({webSize:150,flangeSize:50,thickness:3})),o=t(()=>e.pitch()*Math.PI/180),l=t(()=>Math.cos(o())),s=t(()=>Math.sin(o())),a=t(()=>Math.tan(o())),h=O=>e.apexHeight()-Math.abs(O-e.pitchOffset())*a(),d=t(()=>h(0)),c=t(()=>h(e.length())),u=t(()=>new T({itemName:e.timberItemName,length:e.length,timberProperties:e.timberProperties})),S=t(()=>{if(e.pitch()!=0&&e.pitchOffset()<=0)return[];let O;return e.pitch()==0?O=e.length():O=Math.min(e.length(),Math.max(0,e.pitchOffset()))/l(),e.hasRibbonPlate()?[new T({itemName:e.timberItemName,length:()=>O,timberProperties:e.timberProperties,transform:()=>m.create(i.create(0,0,d()-e.timberProperties().flangeSize/l()),y.fromUV(i.create(l(),0,s()),i.unitY))}),new T({itemName:e.timberItemName,length:()=>O,timberProperties:e.timberProperties,transform:()=>m.create(i.create(0,0,d()-2*e.timberProperties().flangeSize/l()),y.fromUV(i.create(l(),0,s()),i.unitY))})]:[new T({itemName:e.timberItemName,length:()=>O,timberProperties:e.timberProperties,transform:()=>m.create(i.create(0,0,d()-e.timberProperties().flangeSize/l()),y.fromUV(i.create(l(),0,s()),i.unitY))})]}),b=t(()=>{if(e.pitch()==0||e.pitchOffset()>=e.length())return;let O=Math.min(e.length(),Math.max(0,e.length()-e.pitchOffset()))/l();return new T({itemName:e.timberItemName,length:()=>O,timberProperties:e.timberProperties,transform:()=>m.create(i.create(e.length()-O*l(),0,O*s()+c()-e.timberProperties().flangeSize/l()),y.fromUV(i.create(l(),0,-s()),i.unitY))})}),N=t(()=>{let O=t(()=>d()-2*e.timberProperties().flangeSize+(e.hasRibbonPlate()?-e.timberProperties().flangeSize:0));return new T({itemName:e.timberItemName,length:O,timberProperties:e.timberProperties,transform:()=>m.create(i.create(e.timberProperties().flangeSize,0,e.timberProperties().flangeSize),y.fromUV(i.unitZ,i.unitY))})}),w=t(()=>{let O=t(()=>c()-2*e.timberProperties().flangeSize+(e.hasRibbonPlate()?-e.timberProperties().flangeSize:0));return new T({itemName:e.timberItemName,length:O,timberProperties:e.timberProperties,transform:()=>m.create(i.create(e.length(),0,e.timberProperties().flangeSize),y.fromUV(i.unitZ,i.unitY))})}),p=t(()=>{let O=Lt.single(.5*e.timberProperties().flangeSize,e.length()-.5*e.timberProperties().flangeSize);for(let E of e.openingCutOuts())O=O.subtract(Lt.single(E.pos.x-.5*e.timberProperties().flangeSize,E.pos.x+E.width+.5*e.timberProperties().flangeSize));return O}),g=t(()=>{let O=[];for(let E of p().ranges){let F=[],$=E.from,J=E.to-$,K=Math.ceil(J/e.studCentres()),te=e.studCentreType()=="Exact"?e.studCentres():J/K,_=Math.max(0,K-1);for(let Y=0;Y<_;++Y){let ee=$+(Y+1)*te;F.push(ee)}O.push({rangeX:E,studCentresX:F})}return O}),P=t(()=>{let O=[];for(let{studCentresX:E}of g())for(let F of E){let $=h(F)-2*e.timberProperties().flangeSize+(e.hasRibbonPlate()?-e.timberProperties().flangeSize:0);O.push(new T({itemName:e.timberItemName,length:()=>$,timberProperties:e.timberProperties,transform:()=>m.create(i.create(F+.5*e.timberProperties().flangeSize,0,e.timberProperties().flangeSize),y.fromUV(i.unitZ,i.unitY))}))}return O}),M=t(()=>{let O=[];for(let{rangeX:E,studCentresX:F}of g()){let $=[E.from,...F,E.to];for(let G=0;G<$.length-1;++G){let J=$[G],K=$[G+1],te=J+.5*e.timberProperties().flangeSize,Y=K-.5*e.timberProperties().flangeSize-te;if(Y<=0)continue;let ee=((G&1)==0?-1:1)*.5*e.timberProperties().flangeSize,ce=.5*Math.min(d(),c())-.5*e.timberProperties().flangeSize+ee;O.push(new T({itemName:e.timberItemName,length:()=>Y,timberProperties:e.timberProperties,transform:()=>m.create(i.create(te,0,ce),y.identity)}))}}return O}),v=t(()=>{let O=[];for(let E of e.openingCutOuts()){let F=[E.pos.x-.5*e.timberProperties().flangeSize,E.pos.x+E.width+.5*e.timberProperties().flangeSize];for(let $ of F){let G=h($)-2*e.timberProperties().flangeSize+(e.hasRibbonPlate()?-e.timberProperties().flangeSize:0);O.push(new T({itemName:e.timberItemName,length:()=>G,timberProperties:e.timberProperties,transform:()=>m.create(i.create($+.5*e.timberProperties().flangeSize,0,e.timberProperties().flangeSize),y.fromUV(i.unitZ,i.unitY))}))}}return O}),k=t(()=>{let O=[];for(let E of e.openingCutOuts())O.push(new T({itemName:e.timberItemName,length:()=>E.width,timberProperties:e.timberProperties,transform:()=>m.create(i.create(E.pos.x,0,E.pos.y+E.height),y.identity)})),O.push(new T({itemName:e.timberItemName,length:()=>E.width,timberProperties:e.timberProperties,transform:()=>m.create(i.create(E.pos.x,0,E.pos.y+E.height+e.timberProperties().flangeSize+r().webSize),y.identity)}));return O}),z=t(()=>{let O=[];for(let E of e.openingCutOuts())O.push(new T({itemName:n,description:()=>"Head Beam",length:()=>E.width,rhsProperties:r,transform:()=>m.create(i.create(E.pos.x,.5*(e.timberProperties().webSize-r().flangeSize),E.pos.y+E.height+e.timberProperties().flangeSize+r().webSize),y.fromUV(i.unitX,i.negUnitZ))}));return O}),x=t(()=>{let O=[];for(let E of e.openingCutOuts())E.pos.y<e.timberProperties().flangeSize||O.push(new T({itemName:e.timberItemName,length:()=>E.width,timberProperties:e.timberProperties,transform:()=>m.create(i.create(E.pos.x,0,E.pos.y-e.timberProperties().flangeSize),y.identity)}));return O}),A=t(()=>{let O=[];for(let E of e.openingCutOuts()){let F=E.pos.x-.5*e.timberProperties().webSize,G=E.pos.x+E.width+.5*e.timberProperties().webSize-F,J=Math.ceil(G/e.studCentres()),K=e.studCentreType()=="Exact"?e.studCentres():G/J,te=Math.max(0,J-1);for(let _=0;_<te;++_){let Y=F+(_+1)*K,ee=E.pos.y+E.height+2*e.timberProperties().flangeSize+r().webSize,Ce=h(Y)-e.timberProperties().flangeSize+(e.hasRibbonPlate()?-e.timberProperties().flangeSize:0)-ee;O.push(new T({itemName:e.timberItemName,length:()=>Ce,timberProperties:e.timberProperties,transform:()=>m.create(i.create(Y+.5*e.timberProperties().flangeSize,0,ee),y.fromUV(i.unitZ,i.unitY))}))}}return O}),I=t(()=>{let O=[];for(let E of e.openingCutOuts()){if(E.pos.y<e.timberProperties().flangeSize)continue;let F=E.pos.x-.5*e.timberProperties().webSize,G=E.pos.x+E.width+.5*e.timberProperties().webSize-F,J=Math.ceil(G/e.studCentres()),K=e.studCentreType()=="Exact"?e.studCentres():G/J,te=Math.max(0,J-1);for(let _=0;_<te;++_){let Y=F+(_+1)*K,ee=e.timberProperties().flangeSize,Ce=E.pos.y-e.timberProperties().flangeSize-ee;O.push(new T({itemName:e.timberItemName,length:()=>Ce,timberProperties:e.timberProperties,transform:()=>m.create(i.create(Y+.5*e.timberProperties().flangeSize,0,ee),y.fromUV(i.unitZ,i.unitY))}))}}return O});this.components=t(()=>[u(),...S(),...Pe(b()),N(),w(),...P(),...M(),...v(),...k(),...x(),...z(),...A(),...I()])}}class ln{constructor(e){let n=t(()=>{let o=0,l=[];for(let s of e.baySizes()){let a=o;o+=s;let h=o,d=h-a,c=t(()=>{let u=[];for(let S of e.openingCutOuts()){let b=S.pos.x+.5*S.width;a<b&&b<h&&u.push({pos:f.create(S.pos.x-a,S.pos.y),width:S.width,height:S.height})}return u});l.push({frame:new sp({length:()=>d,apexHeight:e.apexHeight,pitch:e.pitch,pitchOffset:t(()=>e.pitchOffset()-a),numNoggins:e.numNoggins,studCentres:e.studCentres,studCentreType:e.studCentreType,openingCutOuts:c,timberItemName:e.timberItemName,timberProperties:e.timberProperties,hasRibbonPlate:e.hasRibbonPlate}),space:m.create(i.create(a,0,0),y.identity)})}return l}),r=t(()=>n().flatMap(({frame:o,space:l})=>wi(o.components,()=>l)()));this.components=t(()=>[...r()])}}const on=50;class ap{constructor(e){let n=t(()=>e.pitch()*Math.PI/180),r=t(()=>Math.cos(n())),o=t(()=>Math.sin(n())),l=t(()=>Math.tan(n())),s=R=>t(()=>e.openings().filter(V=>V.targetId.head()==R)),a=s("SidewallA"),h=s("SidewallB"),d=s("EndwallA"),c=s("EndwallB"),u=t(()=>e.floorSystem()==null?[new T({transform:()=>m.create(i.create(0,0,-100),y.identity),length:e.length,flatProperties:()=>new vt({width:e.span(),thickness:100})})]:[]),S=t(()=>{let R=e.floorSystem();if(R!=null)return new Bl({span:e.span,length:e.length,height:R.height,numSideBays:()=>2,numEndBays:()=>2,joistCentres:()=>450,castInDepth:()=>600,bearerParams:()=>({itemName:"150x50x3.0 RHS",webSize:150,flangeSize:50,thickness:3}),joistParams:()=>({itemName:"100x50x2.0",webSize:100,flangeSize:50,thickness:3}),columnParams:()=>({itemName:"100x3.0 SHS",size:100,thickness:3}),plateThickness:()=>10,stairsOp:()=>{}})}),b=t(()=>{let R=S();return R==null?[]:R.components()}),N=()=>"40mm Roof Batten 0.55",w=t(()=>Ai[N()]),p=()=>"240x45 Smart LVL13",g=()=>900,P=t(()=>new et({webSize:240,flangeSize:45})),M=t(()=>{let R=t(()=>{let ne=.5*P().flangeSize,le=e.length()-.5*P().flangeSize-ne,me=Math.ceil(le/g()),ye=g(),W=me-1,D=[];for(let H=0;H<W;++H)D.push(ne+(H+1)*ye);return D}),V=t(()=>e.span()/r()+P().webSize*l()),L=[];for(let ne of R())L.push(new T({itemName:p,usage:()=>"Rafters",length:V,timberProperties:P,transform:()=>m.create(i.create(ne-.5*P().flangeSize,0,e.height()-(w().height+P().webSize)/r()),y.fromWU(i.unitX,i.create(0,r(),o())))}));return L}),v=t(()=>[{purlins:new Yt({purlinItemName:N,purlinProperties:w,outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.span()/r()),f.create(0,e.span()/r())]),baySizes:e.sideWallBaySizes,openings:()=>[],openBays:t(()=>[]),hasEndClips:()=>!1,startGap:()=>.5*w().width,endGap:()=>.5*w().width,maxSpacing:()=>450}),space:m.create(i.create(0,0,e.height()-w().height/r()),y.fromUV(i.unitX,i.create(0,r(),o())))}]),k=t(()=>v().map(R=>new T({children:R.purlins.components,transform:()=>R.space,usage:()=>"Purlins"}))),z=R=>t(()=>{let V=e.previewOpening();if(V!=null&&V.wallId==R)return{pos:V.pos,width:V.width,height:V.height}},void 0,{equals:(V,L)=>V==null&&L==null}),x=z("SidewallA"),A=z("SidewallB"),I=z("EndwallA"),O=z("EndwallB"),E=t(()=>e.isMonoPitch()?e.height()+e.span()*l():e.height()+.5*e.span()*l()),F=t(()=>{let R=0,V=[R];for(let L of e.sideWallBaySizes())R+=L,V.push(R);return V}),$=t(()=>{let R=0,V=[R];for(let L of e.endWallABaySizes())R+=L,V.push(R);return V}),G=t(()=>{let R=0,V=[R];for(let L of e.endWallBBaySizes())R+=L,V.push(R);return V}),J=t(()=>{let R=()=>"90x45 Timber",V=t(()=>({webSize:90,flangeSize:45})),L=t(()=>{let H=[...e.sideWallBaySizes()];return H.length>0&&(H[0]-=V().webSize,H[H.length-1]-=V().webSize),H}),ne=t(()=>{let H=[...e.sideWallBaySizes()].reverse();return H.length>0&&(H[0]-=V().webSize,H[H.length-1]-=V().webSize),H}),he=e.endWallABaySizes,le=t(()=>[...e.endWallBBaySizes()].reverse()),me=t(()=>a().flatMap(H=>{let X=H.targetId.tail()?.head();if(X==null)return[];let Z=X?.match(/^Bay([0-9]+)$/);if(Z==null)return[];let U=Number.parseInt(Z[1])-1,B=F()[U],j=F()[U+1];return[{pos:f.create(.5*(B+j)-.5*H.width-V().webSize,H.headHeight-H.height),width:H.width,height:H.height}]})),ye=t(()=>h().flatMap(H=>{let X=H.targetId.tail()?.head();if(X==null)return[];let Z=X?.match(/^Bay([0-9]+)$/);if(Z==null)return[];let U=Number.parseInt(Z[1])-1,B=e.length()-F()[U+1],j=e.length()-F()[U];return[{pos:f.create(.5*(B+j)-.5*H.width-V().webSize,H.headHeight-H.height),width:H.width,height:H.height}]})),W=t(()=>d().flatMap(H=>{let X=H.targetId.tail()?.head();if(X==null)return[];let Z=X?.match(/^Bay([0-9]+)$/);if(Z==null)return[];let U=Number.parseInt(Z[1])-1,B=e.span()-$()[U+1],j=e.span()-$()[U];return[{pos:f.create(.5*(B+j)-.5*H.width,H.headHeight-H.height),width:H.width,height:H.height}]})),D=t(()=>c().flatMap(H=>{let X=H.targetId.tail()?.head();if(X==null)return[];let Z=X?.match(/^Bay([0-9]+)$/);if(Z==null)return[];let U=Number.parseInt(Z[1])-1,B=G()[U],j=G()[U+1];return[{pos:f.create(.5*(B+j)-.5*H.width,H.headHeight-H.height),width:H.width,height:H.height}]}));return[{locationName:"SidewallA",wallFrames:new ln({baySizes:L,apexHeight:t(()=>e.height()-(w().height+P().webSize)/r()+V().webSize*l()),pitch:()=>0,pitchOffset:()=>0,numNoggins:()=>1,studCentres:()=>450,studCentreType:()=>"Exact",openingCutOuts:me,timberItemName:R,timberProperties:V,hasRibbonPlate:()=>!0}),space:m.create(i.create(V().webSize,0,0),y.identity)},{locationName:"SidewallB",wallFrames:new ln({baySizes:ne,apexHeight:t(()=>E()-(w().height+P().webSize)/r()),pitch:()=>0,pitchOffset:()=>0,numNoggins:()=>1,studCentres:()=>450,studCentreType:()=>"Exact",openingCutOuts:ye,timberItemName:R,timberProperties:V,hasRibbonPlate:()=>!0}),space:m.create(i.create(e.length()-V().webSize,e.span(),0),y.fromWU(i.unitZ,i.negUnitX))},{locationName:"EndwallA",wallFrames:new ln({baySizes:he,apexHeight:t(()=>E()-w().height/r()),pitch:e.pitch,pitchOffset:()=>0,numNoggins:()=>1,studCentres:()=>450,studCentreType:()=>"Exact",openingCutOuts:W,timberItemName:R,timberProperties:V,hasRibbonPlate:()=>!1}),space:m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY))},{locationName:"EndwallB",wallFrames:new ln({baySizes:le,apexHeight:t(()=>E()-w().height/r()),pitch:e.pitch,pitchOffset:e.span,numNoggins:()=>1,studCentres:()=>450,studCentreType:()=>"Exact",openingCutOuts:D,timberItemName:R,timberProperties:V,hasRibbonPlate:()=>!1}),space:m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY))}]}),K=R=>{switch(R){case"SidewallA":return"Sidewall A";case"SidewallB":return"Sidewall B";case"EndwallA":return"Endwall A";case"EndwallB":return"Endwall B";default:return R}},te=t(()=>J().map(({locationName:R,wallFrames:V,space:L})=>new T({children:V.components,transform:()=>L,usage:()=>K(R)}))),_=t(()=>{let R=t(()=>a().flatMap(W=>{let D=W.targetId.tail()?.head();if(D==null)return[];let H=D?.match(/^Bay([0-9]+)$/);if(H==null)return[];let X=Number.parseInt(H[1])-1,Z=F()[X],U=F()[X+1];return[{pos:f.create(.5*(Z+U)-.5*W.width,W.headHeight-W.height),width:W.width,height:W.height}]})),V=t(()=>h().flatMap(W=>{let D=W.targetId.tail()?.head();if(D==null)return[];let H=D?.match(/^Bay([0-9]+)$/);if(H==null)return[];let X=Number.parseInt(H[1])-1,Z=e.length()-F()[X+1],U=e.length()-F()[X];return[{pos:f.create(.5*(Z+U)-.5*W.width,W.headHeight-W.height),width:W.width,height:W.height}]})),L=t(()=>d().flatMap(W=>{let D=W.targetId.tail()?.head();if(D==null)return[];let H=D?.match(/^Bay([0-9]+)$/);if(H==null)return[];let X=Number.parseInt(H[1])-1,Z=e.span()-$()[X+1],U=e.span()-$()[X];return[{pos:f.create(.5*(Z+U)-.5*W.width,W.headHeight-W.height),width:W.width,height:W.height}]})),ne=t(()=>c().flatMap(W=>{let D=W.targetId.tail()?.head();if(D==null)return[];let H=D?.match(/^Bay([0-9]+)$/);if(H==null)return[];let X=Number.parseInt(H[1])-1,Z=G()[X],U=G()[X+1];return[{pos:f.create(.5*(Z+U)-.5*W.width,W.headHeight-W.height),width:W.width,height:W.height}]})),he=new Te({type:()=>"Wall Sheeting",outline:t(()=>[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())]),openings:R,colour:()=>e.colours.wallSheeting(),sheetingType:()=>"Long Line 305",sheetingLowPoly:e.sheetingLowPoly,previewOpening:x,textures:e.textures}),le=new Te({type:()=>"Wall Sheeting",outline:t(()=>e.isMonoPitch()?[f.create(0,0),f.create(e.length(),0),f.create(e.length(),E()),f.create(0,E())]:[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())]),openings:V,colour:()=>e.colours.wallSheeting(),sheetingType:()=>"Long Line 305",sheetingLowPoly:e.sheetingLowPoly,previewOpening:A,textures:e.textures}),me=new Te({type:()=>"Wall Sheeting",outline:t(()=>e.isMonoPitch()?[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(0,E())]:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),e.height()+.5*e.span()*Math.tan(e.pitch()*Math.PI/180)),f.create(0,e.height())]),openings:L,colour:()=>e.colours.wallSheeting(),sheetingType:()=>"Long Line 305",sheetingLowPoly:e.sheetingLowPoly,previewOpening:I,textures:e.textures}),ye=new Te({type:()=>"Wall Sheeting",outline:t(()=>e.isMonoPitch()?[f.create(0,0),f.create(e.span(),0),f.create(e.span(),E()),f.create(0,e.height())]:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),e.height()+.5*e.span()*Math.tan(e.pitch()*Math.PI/180)),f.create(0,e.height())]),openings:ne,colour:()=>e.colours.wallSheeting(),sheetingType:()=>"Long Line 305",startSheetingAtOppositeEnd:()=>!0,sheetingLowPoly:e.sheetingLowPoly,previewOpening:O,textures:e.textures});return[{sheetedArea:he,space:m.create(i.create(0,0,0),y.fromWU(i.unitZ,i.unitX)),sideName:"Sidewall A"},{sheetedArea:le,space:m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)),sideName:"Sidewall B"},{sheetedArea:me,space:m.create(i.create(0,e.span(),0),y.fromWU(i.unitZ,i.negUnitY)),sideName:"Endwall A"},{sheetedArea:ye,space:m.create(i.create(e.length(),0,0),y.fromWU(i.unitZ,i.unitY)),sideName:"Endwall B"}]}),Y=t(()=>{if(e.isMonoPitch())return[{sheetedArea:new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-on),f.create(e.length(),-on),f.create(e.length(),e.span()/r()),f.create(0,e.span()/r())]),openings:()=>[],colour:()=>e.colours.roofSheeting(),sheetingLowPoly:e.sheetingLowPoly,previewOpening:()=>{},textures:e.textures}),space:m.create(i.create(0,0,e.height()),y.fromWU(i.create(0,r(),o()),i.unitX))}];{let R=new Te({type:()=>"Roof Sheeting",outline:t(()=>[f.create(0,-on),f.create(e.length(),-on),f.create(e.length(),.5*e.span()/r()),f.create(0,.5*e.span()/r())]),openings:()=>[],colour:()=>e.colours.roofSheeting(),sheetingLowPoly:e.sheetingLowPoly,previewOpening:()=>{},textures:e.textures});return[{sheetedArea:R,space:m.create(i.create(0,0,e.height()),y.fromWU(i.create(0,r(),o()),i.unitX))},{sheetedArea:R,space:m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.create(0,-r(),o()),i.negUnitX))}]}}),ee=t(()=>{if(e.isMonoPitch()){let R="Flashing - Barge Corrugated CB",V="Flashing - High Barge Corrugated CB",L=t(()=>e.span()/r()+200),ne=t(()=>i.create(0,-r()*170,-o()*170)),he=t(()=>i.create(0,r()*30,o()*30));return[new T({itemName:()=>R,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-35,0,e.height()+35/r()).add(ne()),y.fromUV(i.create(0,r(),o()),i.negUnitX)),length:L,flashingProfile:()=>tt}),new T({itemName:()=>R,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+35,e.span(),E()+35/r()).add(he()),y.fromUV(i.create(0,-r(),-o()),i.unitX)),length:L,flashingProfile:()=>tt}),new T({itemName:()=>V,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(0,e.span()+30,E()+30/r()),y.fromUV(i.unitX,i.unitY)),length:()=>e.length(),flashingProfile:()=>tt})]}else{let R="Flashing - Barge Corrugated CB";return[new T({itemName:()=>R,transform:()=>m.create(i.create(-30,0,e.height()+30/r()),y.fromUV(i.create(0,r(),o()),i.negUnitX)),length:()=>.5*e.span()/r(),flashingProfile:()=>tt}),new T({itemName:()=>R,transform:()=>m.create(i.create(-30,.5*e.span(),e.height()+.5*e.span()*l()+30/r()),y.fromUV(i.create(0,r(),-o()),i.negUnitX)),length:()=>.5*e.span()/r(),flashingProfile:()=>tt}),new T({itemName:()=>R,transform:()=>m.create(i.create(e.length()+30,e.span(),e.height()+30/r()),y.fromUV(i.create(0,-r(),o()),i.unitX)),length:()=>.5*e.span()/r(),flashingProfile:()=>tt}),new T({itemName:()=>R,transform:()=>m.create(i.create(e.length()+30,.5*e.span(),e.height()+.5*e.span()*l()+30/r()),y.fromUV(i.create(0,-r(),-o()),i.unitX)),length:()=>.5*e.span()/r(),flashingProfile:()=>tt})]}}),ce=t(()=>e.isMonoPitch()?[]:[new T({itemName:()=>"Roll Top Ridge 0.55 Colorbond",transform:()=>m.create(i.create(0,.5*e.span(),e.height()+.5*e.span()*l()+30/r()),y.identity),length:()=>e.length(),flashingProfile:()=>bn({pitch:e.pitch()})})]),Ce=t(()=>{let R="Flashing - Corner 50 x 50 CB";return[new T({itemName:()=>R,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,-30,0),y.fromUV(i.unitZ,i.unitX)),length:()=>e.height(),flashingProfile:()=>ut}),new T({itemName:()=>R,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,-30,0),y.fromUV(i.unitZ,i.unitY)),length:()=>e.height(),flashingProfile:()=>ut}),new T({itemName:()=>R,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(e.length()+30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitX)),length:()=>e.isMonoPitch()?E():e.height(),flashingProfile:()=>ut}),new T({itemName:()=>R,layers:()=>[ve.Cladding],transform:()=>m.create(i.create(-30,e.span()+30,0),y.fromUV(i.unitZ,i.negUnitY)),length:()=>e.isMonoPitch()?E():e.height(),flashingProfile:()=>ut})]}),Ue=t(()=>[{gutter:new jt({length:e.length}),space:m.create(i.create(0,0,e.height()),y.fromWU(i.unitZ,i.unitX))},...e.isMonoPitch()?[]:[{gutter:new jt({length:e.length}),space:m.create(i.create(e.length(),e.span(),e.height()),y.fromWU(i.unitZ,i.negUnitX))}]]),Q=t(()=>Ue().flatMap(({gutter:R,space:V})=>wi(R.components,()=>V)()));this.components=t(()=>{let R=_().flatMap(({sheetedArea:ne,space:he,sideName:le})=>Un(wi(ne.components,()=>he),()=>le)()),V=Y().flatMap(({sheetedArea:ne,space:he})=>wi(ne.components,()=>he)());return V=Un(()=>V,()=>"Roof Sheeting")(),[u(),b(),new T({transform:t(()=>{let ne,he=e.floorSystem();return he==null?ne=100:ne=he.height(),m.create(i.create(0,0,ne),y.identity)}),children:t(()=>[...M(),...k(),...te(),...R,...V,...ee(),...ce(),...Ce(),...Q()])})].flatMap(ne=>ne)}),this.insertOpeningModeWalls=t(()=>[{id:"SidewallA",space:m.create(i.create(0,0,0),y.identity),outline:[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())]},{id:"SidewallB",space:m.create(i.create(e.length(),e.span(),0),y.fromWU(i.unitZ,i.negUnitX)),outline:[f.create(0,0),f.create(e.length(),0),f.create(e.length(),e.height()),f.create(0,e.height())]},{id:"EndwallA",space:m.create(i.create(0,e.span(),100),y.fromWU(i.unitZ,i.negUnitY)),outline:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),e.height()+.5*e.span()*Math.tan(e.pitch()*Math.PI/180)),f.create(0,e.height())]},{id:"EndwallB",space:m.create(i.create(e.length(),0,100),y.fromWU(i.unitZ,i.unitY)),outline:[f.create(0,0),f.create(e.span(),0),f.create(e.span(),e.height()),f.create(.5*e.span(),e.height()+.5*e.span()*Math.tan(e.pitch()*Math.PI/180)),f.create(0,e.height())]}])}}let hp=Math.round(2400+(240+40)/Math.cos(10*Math.PI/180)-90*Math.tan(10*Math.PI/180)),cp={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:5700},length:{displayName:"Length",typeSchema:{type:"Number"},defaultValue:6e3},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:hp},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:10},isMonoPitch:{displayName:"Is Mono Pitch?",typeSchema:{type:"Boolean"},defaultValue:!0},sideWallBaySizes:{displayName:"Sidewall Bay Sizes",typeSchema:{type:"Array",elemTypeSchema:{type:"Number"}},defaultValue:[3e3,3e3]},endWallABaySizes:{displayName:"Endwall A Bay Sizes",typeSchema:{type:"Array",elemTypeSchema:{type:"Number"}},defaultValue:[2850,2850]},endWallBBaySizes:{displayName:"Endwall B Bay Sizes",typeSchema:{type:"Array",elemTypeSchema:{type:"Number"}},defaultValue:[2850,2850]},floorSystem:{displayName:"Floor System",typeSchema:{type:"Object",properties:{height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:0}}},defaultValue:{height:570}},openings:{displayName:"Openings",typeSchema:{type:"Array",elemTypeSchema:{type:"Object",properties:{targetId:{displayName:"Target Id",typeSchema:bi,defaultValue:We.nil()},pos:{displayName:"Position",typeSchema:{type:"Union",parts:{centre:{}}},defaultValue:{type:"centre"}},width:{displayName:"Width",typeSchema:{type:"Number"},defaultValue:0},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:0},headHeight:{displayName:"Head Height",typeSchema:{type:"Number"},defaultValue:0}}}},defaultValue:[{targetId:We.fromArray(["EndwallB","Bay1"]),pos:{type:"centre"},width:1200,height:2100,headHeight:2100},{targetId:We.fromArray(["EndwallB","Bay2"]),pos:{type:"centre"},width:2100,height:2100,headHeight:2100},{targetId:We.fromArray(["SidewallB","Bay1"]),pos:{type:"centre"},width:1800,height:600,headHeight:2400},{targetId:We.fromArray(["SidewallB","Bay2"]),pos:{type:"centre"},width:1800,height:600,headHeight:2400}]},colours:{displayName:"Colours",typeSchema:{type:"Object",properties:{roofSheeting:{displayName:"Roof Sheeting",typeSchema:{type:"String"},defaultValue:""},wallSheeting:{displayName:"Wall Sheeting",typeSchema:{type:"String"},defaultValue:""},gutter:{displayName:"Gutter",typeSchema:{type:"String"},defaultValue:""},bargeCap:{displayName:"Barge Cap",typeSchema:{type:"String"},defaultValue:""},cornerTrim:{displayName:"Corner Trim",typeSchema:{type:"String"},defaultValue:""},openingTrim:{displayName:"Opening Trim",typeSchema:{type:"String"},defaultValue:""},ridgeCap:{displayName:"Ridge Cap",typeSchema:{type:"String"},defaultValue:""}}},defaultValue:{roofSheeting:"Manor Red",wallSheeting:"Deep Ocean",gutter:"Manor Red",bargeCap:"Manor Red",cornerTrim:"Deep Ocean",openingTrim:"Manor Red",ridgeCap:"Manor Red"}}};const dp=new Ae({typeName:"TimberShed",displayName:"Timber Shed",propertiesSchema:cp}),up=dp;class fp{constructor(){this.componentType=up}create(e,n,r,o,l){return new pp(n,r,o,l)}}let co=new fp;Be(co);class pp{constructor(e,n,r,o){this.type=co;let[l,s]=wt({previewOpening:()=>{},sheetingLowPoly:()=>!1}),a=t(()=>l().previewOpening()),h=t(()=>l().sheetingLowPoly()),d=t(()=>l().textures);this.setVisualProperties=s,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let c=t(()=>new ap({span:()=>e.span,length:()=>e.length,height:()=>e.height,pitch:()=>e.pitch,isMonoPitch:()=>e.isMonoPitch,sideWallBaySizes:()=>e.sideWallBaySizes,endWallABaySizes:()=>e.endWallABaySizes,endWallBBaySizes:()=>e.endWallBBaySizes,floorSystem:t(()=>{if(e.floorSystem!=null){let u=e.floorSystem;return{height:()=>u.height}}}),openings:()=>e.openings,colours:{roofSheeting:()=>e.colours.roofSheeting,wallSheeting:()=>e.colours.wallSheeting,gutter:()=>e.colours.gutter,bargeCap:()=>e.colours.bargeCap,cornerTrim:()=>e.colours.cornerTrim,openingTrim:()=>e.colours.openingTrim,ridgeCap:()=>e.colours.ridgeCap},previewOpening:a,sheetingLowPoly:h,textures:d()}));this.components=t(()=>c().components()),this.properties=()=>[{displayName:"Properties",fields:[se({displayName:()=>"span",value:()=>e.span,setValue:u=>n("span",u)}),se({displayName:()=>"length",value:()=>e.length,setValue:u=>n("length",u)}),se({displayName:()=>"height",value:()=>e.height,setValue:u=>n("height",u)}),se({displayName:()=>"pitch",value:()=>e.pitch,setValue:u=>n("pitch",u)}),kt({displayName:()=>"Mono Pitch?",value:()=>e.isMonoPitch,setValue:u=>n("isMonoPitch",u)})],expanded:()=>!0}]}}let mp={};const gp=new Ae({typeName:"Tree",displayName:"Tree",propertiesSchema:mp}),yp=gp;let uo;{let C=new Is,e;uo=async()=>{if(e!=null)return e;let r=(await C.loadAsync("./resources/tree3.gltf")).scene.children[0];return r.geometry.scale(.05,.05,.05),r.geometry.rotateX(Math.PI),e=r,e}}let il=await uo();class bp{constructor(){this.componentType=yp}create(e,n,r,o,l){return new wp(n,r,o,l)}}let fo=new bp;Be(fo);class wp{constructor(e,n,r,o){this.type=fo,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o,this.components=t(()=>[new T({mkObject3d:t(()=>l=>{let s=new xe(il.geometry,il.material);return s.castShadow=!0,s})})]),this.properties=t(()=>[])}}let Sp={style:{displayName:"Style",typeSchema:{type:"String",possibleValues:["Flat Top","Arched Spear","Continuous Scroll","Cross Top","Double Flat","Hi-Low Spear","Intermitten Ring","Loop & Spear","Loop Top","Lorraine","Macintyre","Oakwood","Open Rail","Open Rail Scroll","Oxley Ring","Ring & Scroll","Rod Top","Sapphire","Spear Top","Windsor Ring"]},defaultValue:"Loop Top"},width:{displayName:"Width",typeSchema:{type:"Number"},defaultValue:1200},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:1200},secondaryHeight:{displayName:"Secondary Height",typeSchema:{type:"Number"},defaultValue:1080},endGap:{displayName:"End Gap",typeSchema:{type:"Number"},defaultValue:50},maxGapSize:{displayName:"Max Gap Size",typeSchema:{type:"Number"},defaultValue:120},flatWidth:{displayName:"Flat Width",typeSchema:{type:"Number"},defaultValue:40},flatHeight:{displayName:"Flat Height",typeSchema:{type:"Number"},defaultValue:20},tubeDiameter:{displayName:"Tube Diameter",typeSchema:{type:"Number"},defaultValue:20}};const Pp=new Ae({typeName:"TubedFencePanel",displayName:"Tubed Fence Panel",propertiesSchema:Sp}),Np=Pp;function Mp(){return new Worker(""+new URL("tube_fence_modeling_worker.6ee15673.js",import.meta.url).href)}let Yn=new Map,po=new Mp;po.addEventListener("message",C=>{let e=C.data,n=Yn.get(e.requestId);Yn.delete(e.requestId),n?.(e.result)});await Ci({type:"setupOpenCascade",requestId:zt(),params:{opencascadeWasm:sl,resourcesUrl:window.location.origin+window.location.pathname+"resources/"}});function Ci(C){return new Promise(e=>{Yn.set(C.requestId,n=>{e(n)}),po.postMessage(C)})}async function Cp(C){return await Ci({type:"makeTubedFaceShape",requestId:zt(),params:C})}async function vp(C){return await Ci({type:"shapeToMesh",requestId:zt(),params:{id:C}})}async function Tp(C){return await Ci({type:"shapeToEdges",requestId:zt(),params:{id:C}})}async function vm(C){return await Ci({type:"fuseShapesWithTransforms",requestId:zt(),params:{shapeIdTransformList:C.map(({shapeId:e,transform:n})=>({shapeId:e,transform:{o:[n.o.x,n.o.y,n.o.z],q:[n.orientation.w,n.orientation.x,n.orientation.y,n.orientation.z]}}))}})}async function Tm(C){let e=C.cameraTransform.o,n=C.cameraTransform.w,r=C.cameraTransform.u;return await Ci({type:"projectShape",requestId:zt(),params:{shapeId:C.shapeId,camera:{position:[e.x,e.y,e.z],direction:[n.x,n.y,n.z],xAxis:[r.x,r.y,r.z]}}})}async function nl(C){await Ci({type:"deleteShape",requestId:zt(),params:{id:C}})}class kp{constructor(e){let n=t(()=>({style:e.style(),width:e.width(),height:e.height(),secondaryHeight:e.secondaryHeight(),endGap:e.endGap(),maxGapSize:e.maxGapSize(),flatWidth:e.flatWidth(),flatHeight:e.flatHeight(),tubeDiameter:e.tubeDiameter()})),[r,o]=wt(void 0);Fe(()=>{let d=r();d!=null&&d.type=="Ok"&&nl(d.value)}),Gt(()=>{let d=n();(async()=>{let c=Wi(r);c!=null&&c.type=="Ok"&&nl(c.value),o(void 0);let u=await Cp(d);o(u)})()});let[l,s]=wt(void 0),[a,h]=wt(void 0);Gt(()=>{let d=r();if(d==null){s(void 0),h(void 0);return}if(d.type=="Err"){s(Wt(d.message)),h(Wt(d.message));return}let c=d.value;(async()=>{let u=await vp(c),S=await Tp(c);At(()=>{s(u),h(S)})})()}),this.mkObject3d=t(()=>d=>{let c=.001,u=l(),S=a();if(u==null||S==null){let z=new Ni(e.width()*c,e.flatWidth()*c,e.height()*c);z.translate(.5*e.width()*c,.5*e.flatWidth()*c,.5*e.height()*c);let x=new xt({color:"green",transparent:!0,opacity:.5});return Fe(()=>{z.dispose(),x.dispose()}),new xe(z,x)}if(u.type=="Err"||S.type=="Err"){let z=new Ni(e.width()*c,e.flatWidth()*c,e.height()*c);z.translate(.5*e.width()*c,.5*e.flatWidth()*c,.5*e.height()*c);let x=new xt({color:"red",transparent:!0,opacity:.5});return Fe(()=>{z.dispose(),x.dispose()}),new xe(z,x)}let b=u.value,N=S.value,w=new Xt,p=new rt({color:"#5a8296",polygonOffset:!0,polygonOffsetFactor:2,polygonOffsetUnits:1}),g=new Xt,P=new Tt({color:"#3c5a6e"});nr(w,b),rr(g,N),Fe(()=>{w.dispose(),p.dispose(),g.dispose(),P.dispose()});let M=new xe(w,p),v=new ht(g,P),k=new nt;return k.add(M),k.add(v),k}),this.shapeId=t(()=>{let d=r();if(!(d==null||d.type=="Err"))return d.value})}}class zp{constructor(){this.componentType=Np}create(e,n,r,o,l){return new Ap(e,n,r,o,l)}}let mo=new zp;Be(mo);class Ap{constructor(e,n,r,o,l){this.type=mo,this.state=n,this.setState=r,this.kitsUserEdits=o,this.setKitsUserEdits=l;let s=new kp({style:()=>n.style,width:()=>n.width,height:()=>n.height,secondaryHeight:()=>n.secondaryHeight,endGap:()=>n.endGap,maxGapSize:()=>n.maxGapSize,flatWidth:()=>n.flatWidth,flatHeight:()=>n.flatHeight,tubeDiameter:()=>n.tubeDiameter}),a=new T({mkObject3d:s.mkObject3d});this.components=t(()=>[a]),this.shapeId=s.shapeId}}let xp={attachToPitch:{displayName:"Attach To Pitch",typeSchema:{type:"Number"},defaultValue:40},baseSize:{displayName:"Base Side",typeSchema:{type:"Number"},defaultValue:300},baseHeight:{displayName:"Base Height",typeSchema:{type:"Number"},defaultValue:300},basePitch:{displayName:"Base Pitch",typeSchema:{type:"Number"},defaultValue:15}};const Ip=new Ae({typeName:"WeatherVane",displayName:"Weather Vane",propertiesSchema:xp}),Bp=Ip;class Op{constructor(){this.componentType=Bp}create(e,n,r,o,l){return new Fp(n,r,o,l)}}let go=new Op;Be(go);class Fp{constructor(e,n,r,o){this.type=go,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new _l({attachToPitch:()=>e.attachToPitch,baseSize:()=>e.baseSize,baseHeight:()=>e.baseHeight,basePitch:()=>e.basePitch,font:()=>ar});this.components=l.components,this.properties=t(()=>[{displayName:"Weather Vane",fields:[se({displayName:()=>"Attach To Pitch",value:()=>e.attachToPitch,setValue:s=>n("attachToPitch",s)}),se({displayName:()=>"Base Size",value:()=>e.baseSize,setValue:s=>n("baseSize",s)}),se({displayName:()=>"Base Height",value:()=>e.baseHeight,setValue:s=>n("baseHeight",s)}),se({displayName:()=>"Base Pitch",value:()=>e.basePitch,setValue:s=>n("basePitch",s)})],expanded:()=>!0}])}}let Vp={span:{displayName:"Span",typeSchema:{type:"Number"},defaultValue:12e3},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:4300},pitch:{displayName:"Pitch",typeSchema:{type:"Number"},defaultValue:15},girtHeight:{displayName:"Girt Height",typeSchema:{type:"Number"},defaultValue:102},purlinHeight:{displayName:"Purlin Height",typeSchema:{type:"Number"},defaultValue:102},frameItemName:{displayName:"Frame Item",typeSchema:{type:"String"},defaultValue:"UB25025"}};const Lp=new Ae({typeName:"WeldedUBColumnRafterSection",displayName:"Welded UB Column Rafter Section",propertiesSchema:Vp}),Hp=Lp;class Ep{constructor(){this.componentType=Hp}create(e,n,r,o,l){return new Up(n,r,o,l)}}let yo=new Ep;Be(yo);class Up{constructor(e,n,r,o){this.type=yo,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;const l=new As({span:()=>e.span,height:()=>e.height,pitch:()=>e.pitch,ubMemberProperties:()=>{let s=hn[e.frameItemName];return{itemName:e.frameItemName,webSize:s.webSize,flangeSize:s.flangeSize,thickness:s.thickness}},plateThickness:()=>10,girtHeight:()=>e.girtHeight,purlinHeight:()=>e.purlinHeight,hasCentreMullion:()=>!0,mullionProperties:()=>{let s=hn[e.frameItemName];return{itemName:e.frameItemName,webSize:s.webSize,flangeSize:s.flangeSize,thickness:s.thickness}}});this.components=l.components,this.properties=()=>[{displayName:"Properties",fields:[se({displayName:()=>"Span",value:()=>e.span,setValue:s=>n("span",s)}),se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),se({displayName:()=>"Pitch",value:()=>e.pitch,setValue:s=>n("pitch",s)}),se({displayName:()=>"Girt Height",value:()=>e.girtHeight,setValue:s=>n("girtHeight",s)}),se({displayName:()=>"Purlin Height",value:()=>e.purlinHeight,setValue:s=>n("purlinHeight",s)}),ft({displayName:()=>"Frame Size",value:()=>e.frameItemName,setValue:s=>n("frameItemName",s),possibleValues:t(()=>Object.keys(hn))})],expanded:()=>!0}]}}let Rp={height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:2040},width:{displayName:"Width",typeSchema:{type:"Number"},defaultValue:920}};const Wp=new Ae({typeName:"XBraceBarnDoor",displayName:"X Brace Barn Door",propertiesSchema:Rp}),Xp=Wp;class Dp{constructor(){this.componentType=Xp}create(e,n,r,o,l){return new _p(n,r,o,l)}}let bo=new Dp;Be(bo);class _p{constructor(e,n,r,o){this.type=bo,this.state=e,this.setState=n,this.kitsUserEdits=r,this.setKitsUserEdits=o;let l=new cn({height:()=>e.height,width:()=>e.width,frameTimberItemName:()=>"100x40",frameTimberProperties:t(()=>new et({webSize:100,flangeSize:40})),frameBraceTimberItemName:()=>"60x40",frameBraceTimberProperties:t(()=>new et({webSize:60,flangeSize:40}))});this.components=l.components,this.properties=t(()=>[{displayName:"Barn PA Door",fields:[se({displayName:()=>"Height",value:()=>e.height,setValue:s=>n("height",s)}),se({displayName:()=>"Width",value:()=>e.width,setValue:s=>n("width",s)})],expanded:()=>!0}])}}const Yp=new Ae({typeName:"Position",displayName:"Position",propertiesSchema:{position:{displayName:"Position",typeSchema:En,defaultValue:f.zero}}}),km=Yp,Gp=new Ae({typeName:"Size",displayName:"Size",propertiesSchema:{width:{displayName:"Width",typeSchema:{type:"Number"},defaultValue:100},height:{displayName:"Height",typeSchema:{type:"Number"},defaultValue:50}}}),zm=Gp,Zp={parentId:{displayName:"Parent ID",typeSchema:{type:"String"},defaultValue:""}},$p=new Ae({typeName:"Parent",displayName:"Parent",propertiesSchema:Zp}),rl=$p,Kp={childIds:{displayName:"Child IDs",typeSchema:{type:"Array",elemTypeSchema:{type:"String"}},defaultValue:[]}},jp=new Ae({typeName:"Children",displayName:"Children",propertiesSchema:Kp}),Li=jp;class dn{constructor(){this.allEntitiesMonitor=void 0,this.entityComponentMonitor=new Map,this.entityComponentSetMonitor=new Map,this.entitiesWithComponentTypesMonitors=new Map,this.monitors=new Set,this.entityMonitors=new Map,this.entities={}}addEntityMonitor(e,n){let r=this.entityMonitors.get(e);r==null?this.entityMonitors.set(e,new Set([n])):r.add(n)}removeEntityMonitor(e,n){let r=this.entityMonitors.get(e);r!=null&&(r.delete(n),r.size===0&&this.entityMonitors.delete(e))}fireEvent(e){Wi(()=>{for(let r of this.monitors)r.handleEvent(e);let n=this.entityMonitors.get(e.entityId);if(n!=null)for(let r of n)r.handleEvent(e)})}hookupAllEntities(){let e=a=>{Fe(()=>{a.refCount--,a.refCount===0&&(this.monitors.delete(a),this.allEntitiesMonitor=void 0)})};{let a=this.allEntitiesMonitor;if(a!=null)return a.refCount++,e(a),a.result}let n=Object.keys(this.entities),[r,o]=wt(n),l=new Set(n),s={handleEvent:a=>{switch(a.type){case"EntityCreated":{l.has(a.entityId)||(l.add(a.entityId),o([...l]));break}case"EntityDestroyed":{l.has(a.entityId)&&(l.delete(a.entityId),o([...l]));break}}},result:r,refCount:1};return this.allEntitiesMonitor=s,this.monitors.add(s),e(s),r}hookupEntityComponent(e,n){let r=e+","+n.typeName,o=h=>{Fe(()=>{h.refCount--,h.refCount===0&&(this.removeEntityMonitor(e,h),this.entityComponentMonitor.delete(r))})};{let h=this.entityComponentMonitor.get(r);if(h!=null)return h.refCount++,o(h),h.result}let[l,s]=wt(this.entities[e]?.[n.typeName]),a={handleEvent:h=>{switch(h.type){case"EntityComponentsSet":{h.entityId==e&&h.components[n.typeName]!=null&&s(h.components[n.typeName]);break}case"EntityComponentsUnset":{h.entityId==e&&h.componentTypes.some(d=>d==n.typeName)&&s(void 0);break}}},result:l,refCount:1};return this.entityComponentMonitor.set(r,a),this.addEntityMonitor(e,a),o(a),l}hookupEntityComponentSet(e){let n=e,r=a=>{Fe(()=>{a.refCount--,a.refCount===0&&(this.removeEntityMonitor(e,a),this.entityComponentSetMonitor.delete(n))})};{let a=this.entityComponentSetMonitor.get(n);if(a!=null)return a.refCount++,r(a),a.result}let[o,l]=wt(this.entities[e]),s={handleEvent:a=>{switch(a.type){case"EntityComponentsSet":{a.entityId==e&&l(this.entities[e]==null?void 0:{...this.entities[e]});break}case"EntityComponentsUnset":{a.entityId==e&&l(this.entities[e]==null?void 0:{...this.entities[e]});break}}},result:o,refCount:1};return this.entityComponentSetMonitor.set(n,s),this.addEntityMonitor(e,s),r(s),o}hookupEntitiesWithComponentTypes(e){let n=e.map(u=>u.typeName).sort().join(","),r=u=>{Fe(()=>{u.refCount--,u.refCount===0&&(this.monitors.delete(u),this.entitiesWithComponentTypesMonitors.delete(n))})};{let u=this.entitiesWithComponentTypesMonitors.get(n);if(u!=null)return u.refCount++,r(u),u.result}let o=new Set(e.map(u=>u.typeName)),l=u=>{for(let S of e)if(this.entities[u]?.[S.typeName]==null)return!1;return!0},s=Object.keys(this.entities).filter(l),[a,h]=wt(s),d=new Set(s),c={handleEvent:u=>{switch(u.type){case"EntityComponentsSet":{l(u.entityId)&&(d.has(u.entityId)||(d.add(u.entityId),h([...a(),u.entityId])));break}case"EntityComponentsUnset":{u.componentTypes.some(S=>o.has(S))&&d.has(u.entityId)&&(d.delete(u.entityId),h(a().filter(S=>S!=u.entityId)));break}}},result:a,refCount:1};return this.entitiesWithComponentTypesMonitors.set(n,c),this.monitors.add(c),r(c),a}hookupChildEntities(e){let n=this.hookupEntityComponent(e,Li);return t(()=>{let r=n();return r==null?[]:r.state.childIds})}hookupDescendantEntities(e){let n=this.hookupChildEntities(e),r=t(()=>{let o=n(),l=[];for(let s of o)l.push(this.hookupDescendantEntities(s));return l});return t(()=>[...n(),...r().flatMap(o=>o())])}static mkEmpty(){return new dn}static fromJSON(e,n){let r=new dn;if(!n.hasOwnProperty("entities"))return Wt("worldFromJson: entities field is missing.");let o=n.entities;if(typeof o!="object")return Wt("worldFromJson: entities is meant to be an object.");for(let l in o){let s=o[l];if(typeof s!="object")return Wt("worldFromJson: entity with id `"+l+"` has componentTypes that needs to be an object.");let a={};for(let h in s){let d=s[h];if(typeof d!="object")return Wt("worldFromJson: entity with id `"+l+"` has a component `"+h+"` that needs to be an object.");let c=e.lookupComponentType(h);if(c==null)return Wt("worldFromJson: entity with id `"+l+"` has a componentType of `"+h+"` that is not found in registry.");let u=So(c.propertiesSchema,d,!1);if(u.type=="Err")return Wt("worldFromJson: entity with id `"+l+"`, componentType `"+h+"`: "+u.message);a[h]=c.create(u.value)}r.entities[l]=a}return ki(r)}toJSON(){let e={entities:{}};for(let n in this.entities){let r=this.entities[n],o={};for(let l in r){let s=r[l],a=Po(s.type.propertiesSchema,s.state);o[l]=a}e.entities[n]=o}return e}deepClone(e){let n=dn.fromJSON(e,this.toJSON());if(n.type=="Err")throw new Error("deepClone: "+n.message);return n.value}getEntities(){return Object.keys(this.entities)}getEntitiesWithComponentTypes(e){let n=[];for(let r in this.entities)e.every(o=>this.hasComponent(r,o))&&n.push(r);return n}hasEntity(e){return this.entities.hasOwnProperty(e)}createEntityWithId(e,n){let r={};for(let o of n)r[o.type.typeName]=o;this.entities[e]=r,At(()=>{this.fireEvent({type:"EntityCreated",entityId:e}),n.length!=0&&this.fireEvent({type:"EntityComponentsSet",entityId:e,components:r})})}createEntity(e){let n=zt();return this.createEntityWithId(n,e),n}destroyEntity(e){let n=this.getComponent(e,rl);if(n!=null){let o=this.getComponent(n.state.parentId,Li);o?.setState("childIds",o.state.childIds.filter(l=>l!=e))}let r=this.entities[e];r!=null&&this.fireEvent({type:"EntityComponentsUnset",entityId:e,componentTypes:Object.keys(r)}),delete this.entities[e],this.fireEvent({type:"EntityDestroyed",entityId:e})}destroyEntityAndDescendants(e){At(()=>{let n=this.getComponent(e,rl);if(n!=null){let o=this.getComponent(n.state.parentId,Li);o?.setState("childIds",o.state.childIds.filter(l=>l!=e))}let r=[e];for(;;){let o=r.pop();if(o==null)break;let l=this.getComponent(o,Li);l!=null&&r.push(...l.state.childIds);let s=this.entities[e];s!=null&&this.fireEvent({type:"EntityComponentsUnset",entityId:e,componentTypes:Object.keys(s)}),delete this.entities[o],this.fireEvent({type:"EntityDestroyed",entityId:o})}})}getDescendantEntities(e){let n=[],r=[e];for(;;){let o=r.pop();if(o==null)break;let l=this.getComponent(o,Li);l!=null&&(r.push(...l.state.childIds),n.push(...l.state.childIds))}return n}hasComponent(e,n){let r=this.entities[e];return r==null?!1:r[n.typeName]!=null}getComponent(e,n){let r=this.entities[e];if(r!=null)return r[n.typeName]}getComponents(e){let n=this.entities[e];return n==null?[]:Object.values(n)}getComponentSet(e){return this.entities[e]??{}}getComponentTypes(e){let n=this.entities[e];return n==null?[]:Object.keys(n)}setComponents(e,n){let r=this.entities[e];r==null&&(r={},this.entities[e]=r);for(let o of n)r[o.type.typeName]=o;this.fireEvent({type:"EntityComponentsSet",entityId:e,components:r})}unsetComponents(e,n){let r=this.entities[e];if(r!=null){for(let o of n)delete r[o.typeName];this.fireEvent({type:"EntityComponentsUnset",entityId:e,componentTypes:n.map(o=>o.typeName)})}}}function Am(C,e){return C[e.typeName]}class xm{constructor(e){this.componentTypes=e,this.typeNameToComponentType=new Map;for(let n of e)this.typeNameToComponentType.set(n.typeName,n);this.aliasTypeNameMap=new Map}lookupComponentType(e){let n=this.typeNameToComponentType.get(e);if(n!=null)return n;let r=this.aliasTypeNameMap.get(e);if(r!=null)return this.typeNameToComponentType.get(r)}addAlias(e,n){this.aliasTypeNameMap.set(e,n)}}let Qp={orderIndex:{displayName:"Order Index",typeSchema:{type:"Number"},defaultValue:0}},qp=new Ae({typeName:"OrderIndex",displayName:"Order Index",propertiesSchema:Qp});const Im=qp;export{nl as $,vu as A,Iu as B,Qu as C,nf as D,Ma as E,bf as F,dd as G,Yu as H,Mf as I,xf as J,Df as K,$f as L,rp as M,up as N,yd as O,We as P,yp as Q,xm as R,Np as S,Md as T,Bp as U,Hp as V,Xp as W,Im as X,Am as Y,vm as Z,Tm as _,rl as a,dn as a0,iu as a1,Ju as a2,Is as a3,Ul as a4,Cm as a5,yi as a6,Mm as a7,Ec as a8,qa as b,Li as c,nh as d,yh as e,xh as f,Lu as g,dc as h,nc as i,Tc as j,Vc as k,Dc as l,$c as m,ed as n,ld as o,km as p,Od as q,za as r,zm as s,Ed as t,Kd as u,eu as v,lu as w,Fa as x,pu as y,wu as z};
