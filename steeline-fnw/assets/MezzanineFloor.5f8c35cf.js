import{a as o}from"./index.5aba22ff.js";import{b as w,T as g,Q as d}from"./Component.6024a649.js";import{a as r,V as b}from"./Vec3.ce1f4f7a.js";import{S as T,F as k,U as R,C as B}from"./PropertiesForm.c69fa44e.js";import{m as L,a as V}from"./utils.6e3ab489.js";import{T as E,C as H}from"./Transform2D.200bb15c.js";class D{constructor(e){let Y=o(()=>e.length()-2*e.plateThickness()),X=o(()=>new w({transform:()=>g.create(r.create(e.plateThickness(),0,0),d.identity),itemName:()=>e.shsMemberParams().itemName,length:Y,shsProperties:()=>new T({size:e.shsMemberParams().size,thickness:e.shsMemberParams().thickness})})),v=o(()=>{let a=e.shsMemberParams().size+200,f=a;return new w({transform:()=>g.create(r.create(0,.5*e.shsMemberParams().size-.5*a,.5*e.shsMemberParams().size-.5*a),d.fromWU(r.unitX,r.unitY)),itemName:()=>"Flat Bar "+a.toFixed(0)+"x"+e.plateThickness(),length:()=>f,flatProperties:()=>new k({width:a,thickness:e.plateThickness()})})}),u=o(()=>{let a=e.girdirFlangeSize(),f=e.shsMemberParams().size+200;return new w({transform:()=>g.create(r.create(e.length()-e.plateThickness(),.5*e.shsMemberParams().size+.5*a,-.5*(f-e.shsMemberParams().size)),d.fromWU(r.unitX,r.unitZ)),itemName:()=>"Flat Bar "+a.toFixed(0)+"x"+e.plateThickness(),length:()=>f,flatProperties:()=>new k({width:a,thickness:e.plateThickness()})})});this.params=e,this.components=o(()=>{let a=[];return a.push(X(),v(),u()),a})}}class J{constructor(e){let Y=o(()=>e.numSteps()+1),X=o(()=>{let u=e.horizontalDist(),a=e.verticalDist(),f=r.create(u,0,a).normalize(),x=r.unitY,M=Math.sqrt(u*u+a*a),C=f.scale(-M),y=C.add(x.scale(e.width()-50));return[new w({transform:()=>g.create(C,d.fromUV(f,x)),length:()=>M,shsProperties:()=>new T({size:50,thickness:3})}),new w({transform:()=>g.create(y,d.fromUV(f,x)),length:()=>M,shsProperties:()=>new T({size:50,thickness:3})}),new w({itemName:()=>"Stair Stringer "+e.numSteps()+" treads",qty:()=>2})]}),v=o(()=>{let u=[],a=e.verticalDist()/Y(),f=e.horizontalDist()/Y(),x=f,M=50;for(let C=0;C<e.numSteps();++C)u.push(new w({transform:()=>g.create(r.create(f*(C+1)-e.horizontalDist(),0,a*(C+1)-e.verticalDist()),d.fromWU(r.unitZ,r.unitY)),length:()=>e.width(),flatProperties:()=>new k({width:x,thickness:M})}));return u});this.components=()=>[...X(),...v()]}}class ${constructor(e){let v=o(()=>{let t=e.stairsOp();if(t==null)return;let i=t.dir.normalize();b.create(-i.y,i.x),Math.ceil(e.height()/175);let n=t.headClearance*250/175,h=E.create(t.entryFloorPt,H.xy(i)),l=[h.pointFromSpace(b.create(0,0)),h.pointFromSpace(b.create(0,t.width)),h.pointFromSpace(b.create(-n,t.width)),h.pointFromSpace(b.create(-n,0))],s,c,m,P;for(let z of l)(s==null||z.x<s)&&(s=z.x),(c==null||z.x>c)&&(c=z.x),(m==null||z.y<m)&&(m=z.y),(P==null||z.y>P)&&(P=z.y);if(!(s==null||c==null||m==null||P==null))return{minX:s,minY:m,maxX:c,maxY:P}}),u=o(()=>{let t=.5*e.girderParams().flangeSize,n=(e.span()-.5*e.girderParams().flangeSize-t)/e.numEndBays(),h=e.numEndBays()+1,l=[];for(let m=0;m<h;++m)l.push(t+n*m);let s=v(),c=m=>!(m<e.girderParams().flangeSize*1.5||m>e.span()-e.girderParams().flangeSize*1.5);return s!=null&&(c(s.minY)&&l.push(s.minY),c(s.maxY)&&l.push(s.maxY)),l.sort((m,P)=>m-P),l}),a=o(()=>{let t=.5*e.joistParams().flangeSize,i=e.length()-.5*e.joistParams().flangeSize,n=Math.ceil((i-t)/e.joistCentres())+1,h=[];for(let l=0;l<n;++l){let s;l<n-1?s=t+e.joistCentres()*l:s=i,h.push(s)}return h}),f=o(()=>{const t=e.columnParams().size+200;let i=.5*t,h=(e.length()-.5*t-i)/e.numSideBays(),l=e.numSideBays()+1,s=[];for(let c=0;c<l;++c)s.push(i+h*c);return s}),x=o(()=>{let t=v();if(t==null)return[];let i=t,n=[];return n.push(b.create(i.minX,i.minY),b.create(i.maxX,i.minY),b.create(i.minX,i.maxY),b.create(i.maxX,i.maxY)),n=n.filter(h=>{let l=h.x;return h.y,!(l<e.columnParams().size*1.5||l>e.length()-e.columnParams().size*1.5)}),n}),M=o(()=>e.height()-e.girderParams().webSize),C=o(()=>{let t=[];for(let i of u())for(let n of f())t.push({member:new D({length:M,shsMemberParams:e.columnParams,plateThickness:e.plateThickness,girdirFlangeSize:()=>e.girderParams().flangeSize}),space:g.create(r.create(n+.5*e.columnParams().size,i-.5*e.columnParams().size,0),d.fromUV(r.unitZ,r.unitY))});for(let i of x())t.push({member:new D({length:M,shsMemberParams:e.columnParams,plateThickness:e.plateThickness,girdirFlangeSize:()=>e.girderParams().flangeSize}),space:g.create(r.create(i.x+.5*e.columnParams().size,i.y-.5*e.columnParams().size,0),d.fromUV(r.unitZ,r.unitY))});return t}),y=o(()=>{let t=[];for(let i of u())t.push(new w({transform:()=>g.create(r.create(0,i+.5*e.girderParams().flangeSize,e.height()-e.girderParams().webSize),d.fromUV(r.unitX,r.unitZ)),itemName:()=>e.girderParams().itemName,length:()=>e.length(),ubProperties:()=>new R({webSize:e.girderParams().webSize,flangeSize:e.girderParams().flangeSize,thickness:e.girderParams().thickness}),usage:()=>"Girders"}));return t}),N=o(()=>{let t=[],i=v();if(i!=null){let n={...i};n.minX=Math.max(n.minX,e.girderParams().flangeSize*1.5),n.maxX=Math.min(n.maxX,e.length()-e.girderParams().flangeSize*1.5),i=n}for(let n=0;n<u().length-1;++n){let h=u()[n],l=u()[n+1],s=h+.5*e.girderParams().flangeSize,c=l-.5*e.girderParams().flangeSize,m=c-s,P=.5*(s+c),z=[];if(i!=null){let S=i;S.minY<=P&&P<=S.maxY&&(z=[S.minX,S.maxX])}for(let S of[...a(),...z]){if(i!=null){let F=i;if(F.minX<=S&&S<=F.maxX&&F.minY<=P&&P<=F.maxY&&!z.includes(S))continue}let O=.5*e.girderParams().flangeSize+100,j=e.joistParams().webSize-80,W=10;t.push(new w({transform:()=>g.create(r.create(S-.5*e.joistParams().flangeSize,s,e.height()-e.joistParams().webSize),d.fromUV(r.unitY,r.unitZ)),itemName:()=>e.joistParams().itemName,length:()=>m,ceeProperties:()=>B.create({webSize:e.joistParams().webSize,flangeSize:e.joistParams().flangeSize,lipSize:e.joistParams().lipSize,thickness:e.joistParams().thickness,webHoleDistApart:0}),usage:()=>"Joists"}),new w({transform:()=>g.create(r.create(S-.5*e.joistParams().flangeSize+e.joistParams().thickness,s-.5*e.girderParams().flangeSize+.5*e.girderParams().thickness,e.height()-.5*e.joistParams().webSize-.5*j),d.fromUV(r.unitY,r.unitZ)),itemName:()=>"Flat",length:()=>O,flatProperties:()=>new k({width:j,thickness:10}),usage:()=>"Girder Cleats"}),new w({transform:()=>g.create(r.create(S-.5*e.joistParams().flangeSize+e.joistParams().thickness+W,c+.5*e.girderParams().flangeSize-.5*e.girderParams().thickness,e.height()-.5*e.joistParams().webSize-.5*j),d.fromUV(r.negUnitY,r.unitZ)),itemName:()=>"Flat",length:()=>O,flatProperties:()=>new k({width:j,thickness:10}),usage:()=>"Girder Cleats"}))}}return t}),Z=o(()=>C().flatMap(({member:t,space:i})=>L(V(t.components,()=>i),()=>"Columns")())),p=o(()=>{let t=e.stairsOp();if(t==null)return;let i=r.create(t.entryFloorPt.x,t.entryFloorPt.y,e.height()),n=r.create(t.dir.x,t.dir.y,0).normalize(),h=r.unitZ.cross(n),l=i.add(h.scale(.5*e.girderParams().flangeSize)),s=g.create(l,d.fromWU(r.unitZ,n)),c=t;return{stairStringers:new J({width:()=>c.width-e.girderParams().flangeSize,horizontalDist:()=>e.height()*250/175,verticalDist:e.height,numSteps:()=>Math.ceil(e.height()/175)-1}),space:s}}),G=o(()=>{let t=p();if(t==null)return[];let{stairStringers:i,space:n}=t;return V(i.components,()=>n)()});this.components=o(()=>{let t=[],i=[y(),N(),Z(),G()];for(let n of i)for(let h of n)t.push(h);return t})}}export{$ as M,J as S,D as W};
