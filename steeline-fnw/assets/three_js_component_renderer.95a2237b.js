import{D as W,A as F,z as k,a as z,B as ie,l as re}from"./index.5aba22ff.js";import{H as le,G as X,T as se,e as K,J as G,K as _,B as Y,O as M,X as O,l as S,Y as x,Z as m,_ as V,V as H,$ as Z,a0 as Q,a1 as oe,z as I,a2 as q}from"./Component.6024a649.js";import{L as ae,f as ne}from"./LineKit.f6b732de.js";import{c as E}from"./PropertiesForm.c69fa44e.js";class fe{constructor(b){this.kitId=b.kitId}}const L=new le;let J;{let e;J=b=>{if(e!=null)return e;let o=0,y=L.load("./resources/Galvanized_steel_02_1K_Base_Color.jpg",()=>{++o,o==2&&b()}),r=L.load("./resources/Galvanized_steel_02_1K_Roughness.jpg",()=>{++o,o==2&&b()});return y.wrapS=I,y.wrapT=I,r.wrapS=I,r.wrapT=I,y.repeat.set(2,2),r.repeat.set(2,2),e=new q({map:y,roughnessMap:r,metalness:.5,clearcoat:1,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1}),e}}let N;{let e;N=b=>{if(e!=null)return e;let o=0,y=L.load("./resources/patchy_cement1_Base_Color.jpg",()=>{++o,o==3&&b()}),r=L.load("./resources/patchy_cement1_Normal.jpg",()=>{++o,o==3&&b()}),t=L.load("./resources/patchy_cement1_Roughness.jpg",()=>{++o,o==3&&b()});return y.wrapS=I,y.wrapT=I,r.wrapS=I,r.wrapT=I,t.wrapS=I,t.wrapT=I,y.repeat.set(2,2),t.repeat.set(2,2),e=new q({map:y,normalMap:r,roughnessMap:t}),e}}function Oe(e){let b=W(e.kits,o=>{o.kit()instanceof ae||F(()=>{let y=new X;y.userData=new fe({kitId:o.kitId()}),e.group.add(y),k(()=>{e.group.remove(y)}),he({group:y,components:z(()=>o.kit().components?.call(o.kit())??[]),rerender:e.rerender,isLayerVisible:e.isLayerVisible,showDebugMarkings:e.showDebugMarkings,textured:e.textured});let r=new K;F(()=>{r.set(o.space().orientation.x,o.space().orientation.y,o.space().orientation.z,o.space().orientation.w),y.setRotationFromQuaternion(r),y.position.set(o.space().o.x/1e3,o.space().o.y/1e3,o.space().o.z/1e3),y.updateMatrix(),ie(()=>e.rerender?.call(void 0))})})});F(()=>b())}function he(e){let[b,o]=re(!0);$({...e,rerender:()=>{o(!0)}}),F(()=>{b()&&(e.rerender!=null&&e.rerender(),o(!1))})}function $(e){F(()=>{W(e.components,b=>{de(e.group,b,e.rerender,e.isLayerVisible,e.showDebugMarkings,e.textured)})()})}function de(e,b,o,y,r,t){let s=z(()=>b.transform!=null?b.transform():se.identity),u=[];for(let g of ue){let c,d=g(b,o,y,r,t);F(()=>{c!=null&&(c(),c=void 0);let h=d();h.length!=0&&(b.layers!=null&&y!=null?(b.layers().some(l=>y(l))&&(e.add(...h),c=()=>{e.remove(...h)}),o?.()):(e.add(...h),c=()=>{e.remove(...h)}))}),F(()=>{for(let h of d())h.position.set(s().o.x/1e3,s().o.y/1e3,s().o.z/1e3),h.setRotationFromQuaternion(new K(s().orientation.x,s().orientation.y,s().orientation.z,s().orientation.w)),h.updateMatrix();o?.()}),u.push(()=>{c?.()})}k(()=>u.forEach(g=>g()))}let ue=[ge,we,pe,ce,ye,be,ve,Pe,Te,ke,Se,me,ze];function ge(e,b,o,y,r){return z(()=>{if(e.children==null)return[];let t=new X;return $({group:t,components:e.children,rerender:b,isLayerVisible:o,showDebugMarkings:y,textured:r}),[t]})}function we(e,b,o,y,r){let t,s=z(()=>{if(t!=null&&(t(),t=void 0),e.ceeProperties!=null&&e.length!=null){let u=.001,g=new G;{let v=e.ceeProperties().webSize*u,w=e.ceeProperties().flangeSize*u,i=e.ceeProperties().thickness*u;g.moveTo(0,0),g.lineTo(v,0),g.lineTo(v,w),g.lineTo(v-i,w),g.lineTo(v-i,i),g.lineTo(i,i),g.lineTo(i,w),g.lineTo(0,w),g.closePath()}let c=new _(g,{depth:e.length()/1e3,bevelEnabled:!1});if(c.rotateZ(90*Math.PI/180),c.rotateY(90*Math.PI/180),e.frontBackCutAngle!=null||e.backBackCutAngle!=null){let v=(e.frontBackCutAngle??(()=>0))(),w=(e.backBackCutAngle??(()=>0))();if(v!=0||w!=0){let i=[],f=c.attributes.position;for(let p=0;p<f.array.length;p++)i.push(f.array[p]);if(v!=0){let p=.5*e.length()/1e3,j=.5*e.ceeProperties().webSize/1e3,U=e.ceeProperties().webSize/1e3,D=Math.tan(v*Math.PI/180);if(v>0)for(let T=0;T<i.length;T+=3){let C=i[T],A=i[T+1];C<p&&A>j&&(i[T]=C+A*D)}else for(let T=0;T<f.array.length;T+=3){let C=f.array[T],A=f.array[T+1];C<p&&A<j&&(i[T]=C+(U-A)*-D)}}if(w!=0){let p=.5*e.length()/1e3,j=.5*e.ceeProperties().webSize/1e3,U=e.ceeProperties().webSize/1e3,D=Math.tan(w*Math.PI/180);if(w>0)for(let T=0;T<i.length;T+=3){let C=i[T],A=i[T+1];C>p&&A>j&&(i[T]=C-A*D)}else for(let T=0;T<f.array.length;T+=3){let C=f.array[T],A=f.array[T+1];C>p&&A<j&&(i[T]=C-(U-A)*-D)}}c.setAttribute("position",new Y(new Float32Array(i),3))}}let d;r!=null&&r()?d=J(()=>{b?.()}):(d=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#808080"}),k(()=>{d.dispose()}));const h=new O({color:"#000000"}),l=new S(c,d);l.castShadow=!0;let n=new x(c);const a=new m(n,h);t=()=>{c.dispose(),n.dispose(),h.dispose()};let P=new X;if(y!=null){let v=e.length(),w=e.ceeProperties(),i=new O({color:"#0000FF"});k(()=>{i.dispose()}),F(()=>{if(P.clear(),y()){let f=new V;k(()=>{f.dispose()}),f.setFromPoints([new H(0,(.5*w.webSize-.5*w.webHoleDistApart)*u,0),new H(v*u,(.5*w.webSize-.5*w.webHoleDistApart)*u,0),new H(0,(.5*w.webSize-.5*w.webHoleDistApart)*u,w.thickness*u),new H(v*u,(.5*w.webSize-.5*w.webHoleDistApart)*u,w.thickness*u),new H(0,(.5*w.webSize+.5*w.webHoleDistApart)*u,0),new H(v*u,(.5*w.webSize+.5*w.webHoleDistApart)*u,0),new H(0,(.5*w.webSize+.5*w.webHoleDistApart)*u,w.thickness*u),new H(v*u,(.5*w.webSize+.5*w.webHoleDistApart)*u,w.thickness*u)]);let p=new m(f,i);P.add(p),r!=null&&r()&&P.add(a)}b?.()})}return[l,...r!=null&&r()?[]:[a],P]}else return[]});return k(()=>{t?.()}),s}function pe(e,b){let o,y=z(()=>{if(o!=null&&(o(),o=void 0),e.panelMemberProperties!=null&&e.length!=null){let r=.001,t=new G;{let l=e.panelMemberProperties().webSize*r,n=e.panelMemberProperties().flangeSize*r,a=1*r;t.moveTo(0,0),t.lineTo(l,0),t.lineTo(l,n),t.lineTo(l-a,n),t.lineTo(l-a,a),t.lineTo(a,a),t.lineTo(a,n),t.lineTo(0,n),t.closePath()}let s=new _(t,{depth:e.length()/1e3,bevelEnabled:!1});s.rotateZ(90*Math.PI/180),s.rotateY(90*Math.PI/180);const u=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#808080"}),g=new O({color:"#000000"});let c=new S(s,u),d=new x(s);const h=new m(d,g);return o=()=>{s.dispose(),d.dispose(),u.dispose(),g.dispose()},[c,h]}else return[]});return k(()=>{o?.()}),y}function ce(e,b,o,y,r){let t=z(()=>{if(e.flatProperties!=null&&e.length!=null){let s=e.flatProperties(),u=e.length(),g=.001,c=new X;return F(()=>{let d=e.holes2d==null?[]:e.holes2d(),h,l=new G;l.moveTo(0,0),l.lineTo(u*g,0),l.lineTo(u*g,s.width*g),l.lineTo(0,s.width*g),l.closePath();for(let i of d){let f=new G;f.absellipse(i.x*g,i.y*g,9*g,9*g,0,2*Math.PI,!1,0),l.holes.push(f)}h=new _(l,{depth:s.thickness*g,bevelEnabled:!1});let n;if(e.material!=null&&e.material()=="Cement"&&r!=null&&r())n=N(()=>{b?.()});else{let i,f=e.colour?.call(e);f!=null?i=E[f]?.colourHex??"#808080":i="#808080",n=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:i}),k(()=>{n.dispose()})}const a=new O({color:"#000000"}),P=new S(h,n);P.receiveShadow=r!=null&&r();let v=new x(h);const w=new m(v,a);c.add(P),c.add(w),k(()=>{c.remove(P),c.remove(w),h.dispose(),v.dispose(),a.dispose()}),b?.()}),[c]}else return[]});return k(()=>{}),t}function ye(e,b){let o,y=z(()=>{if(o!=null&&(o(),o=void 0),e.ubProperties!=null&&e.length!=null){let r=.001,t=new G;{let l=e.ubProperties().webSize*r,n=e.ubProperties().flangeSize*r,a=e.ubProperties().thickness*r;t.moveTo(0,0),t.lineTo(a,0),t.lineTo(a,.5*n-.5*a),t.lineTo(l-a,.5*n-.5*a),t.lineTo(l-a,0),t.lineTo(l,0),t.lineTo(l,n),t.lineTo(l-a,n),t.lineTo(l-a,.5*n+.5*a),t.lineTo(a,.5*n+.5*a),t.lineTo(a,n),t.lineTo(0,n),t.closePath()}let s=new _(t,{depth:e.length()/1e3,bevelEnabled:!1});s.rotateZ(90*Math.PI/180),s.rotateY(90*Math.PI/180);const u=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#808080"}),g=new O({color:"#000000"}),c=new S(s,u),d=new x(s),h=new m(d,g);return o=()=>{s.dispose(),d.dispose(),u.dispose(),g.dispose()},[c,h]}else return[]});return k(()=>{o?.()}),y}function be(e,b){let o,y=z(()=>{if(o!=null&&(o(),o=void 0),e.shsProperties!=null&&e.length!=null){const r=new Z(e.length()/1e3,e.shsProperties().size/1e3,e.shsProperties().size/1e3),t=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#808080"}),s=new O({color:"#000000"});if(r.translate(.5*e.length()/1e3,.5*e.shsProperties().size/1e3,.5*e.shsProperties().size/1e3),e.frontBackCutAngle!=null||e.backBackCutAngle!=null){let d=(e.frontBackCutAngle??(()=>0))(),h=(e.backBackCutAngle??(()=>0))();if(d!=0||h!=0){let l=[],n=r.attributes.position;for(let a=0;a<n.array.length;a++)l.push(n.array[a]);if(d!=0){let a=.5*e.length()/1e3,P=.5*e.shsProperties().size/1e3,v=e.shsProperties().size/1e3,w=Math.tan(d*Math.PI/180);if(d>0)for(let i=0;i<l.length;i+=3){let f=l[i],p=l[i+2];f<a&&p>P&&(l[i]=f+p*w)}else for(let i=0;i<n.array.length;i+=3){let f=n.array[i],p=n.array[i+2];f<a&&p<P&&(l[i]=f+(v-p)*-w)}}if(h!=0){let a=.5*e.length()/1e3,P=.5*e.shsProperties().size/1e3,v=e.shsProperties().size/1e3,w=Math.tan(h*Math.PI/180);if(h>0)for(let i=0;i<l.length;i+=3){let f=l[i],p=l[i+2];f>a&&p>P&&(l[i]=f-p*w)}else for(let i=0;i<n.array.length;i+=3){let f=n.array[i],p=n.array[i+2];f>a&&p<P&&(l[i]=f-(v-p)*-w)}}r.setAttribute("position",new Y(new Float32Array(l),3))}}const u=new S(r,t);let g=new x(r);const c=new m(g,s);return o=()=>{r.dispose(),g.dispose(),t.dispose(),s.dispose()},[u,c]}else return[]});return k(()=>{o?.()}),y}function ve(e,b){let o,y=z(()=>{if(o!=null&&(o(),o=void 0),e.rhsProperties!=null&&e.length!=null){const r=new Z(e.length()/1e3,e.rhsProperties().webSize/1e3,e.rhsProperties().flangeSize/1e3),t=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#808080"}),s=new O({color:"#000000"});if(r.translate(.5*e.length()/1e3,.5*e.rhsProperties().webSize/1e3,.5*e.rhsProperties().flangeSize/1e3),e.frontBackCutAngle!=null||e.backBackCutAngle!=null){let d=(e.frontBackCutAngle??(()=>0))(),h=(e.backBackCutAngle??(()=>0))();if(d!=0||h!=0){let l=[],n=r.attributes.position;for(let a=0;a<n.array.length;a++)l.push(n.array[a]);if(d!=0){let a=.5*e.length()/1e3,P=.5*e.rhsProperties().flangeSize/1e3,v=e.rhsProperties().flangeSize/1e3,w=Math.tan(d*Math.PI/180);if(d>0)for(let i=0;i<l.length;i+=3){let f=l[i],p=l[i+2];f<a&&p>P&&(l[i]=f+p*w)}else for(let i=0;i<n.array.length;i+=3){let f=n.array[i],p=n.array[i+2];f<a&&p<P&&(l[i]=f+(v-p)*-w)}}if(h!=0){let a=.5*e.length()/1e3,P=.5*e.rhsProperties().flangeSize/1e3,v=e.rhsProperties().flangeSize/1e3,w=Math.tan(h*Math.PI/180);if(h>0)for(let i=0;i<l.length;i+=3){let f=l[i],p=l[i+2];f>a&&p>P&&(l[i]=f-p*w)}else for(let i=0;i<n.array.length;i+=3){let f=n.array[i],p=n.array[i+2];f>a&&p<P&&(l[i]=f-(v-p)*-w)}}r.setAttribute("position",new Y(new Float32Array(l),3))}}if(e.frontBackCutAngleType2!=null||e.backBackCutAngleType2!=null){let d=(e.frontBackCutAngleType2??(()=>0))(),h=(e.backBackCutAngleType2??(()=>0))();if(d!=0||h!=0){let l=[],n=r.attributes.position;for(let a=0;a<n.array.length;a++)l.push(n.array[a]);if(d!=0){let a=.5*e.length()/1e3,P=.5*e.rhsProperties().webSize/1e3,v=e.rhsProperties().webSize/1e3,w=Math.tan(d*Math.PI/180);if(d>0)for(let i=0;i<l.length;i+=3){let f=l[i],p=l[i+1];f<a&&p>P&&(l[i]=f+p*w)}else for(let i=0;i<n.array.length;i+=3){let f=n.array[i],p=n.array[i+1];f<a&&p<P&&(l[i]=f+(v-p)*-w)}}if(h!=0){let a=.5*e.length()/1e3,P=.5*e.rhsProperties().webSize/1e3,v=e.rhsProperties().webSize/1e3,w=Math.tan(h*Math.PI/180);if(h>0)for(let i=0;i<l.length;i+=3){let f=l[i],p=l[i+1];f>a&&p>P&&(l[i]=f-p*w)}else for(let i=0;i<n.array.length;i+=3){let f=n.array[i],p=n.array[i+1];f>a&&p<P&&(l[i]=f-(v-p)*-w)}}r.setAttribute("position",new Y(new Float32Array(l),3))}}const u=new S(r,t);let g=new x(r);const c=new m(g,s);return o=()=>{r.dispose(),g.dispose(),t.dispose(),s.dispose()},[u,c]}else return[]});return k(()=>{o?.()}),y}function Pe(e,b){let o,y=z(()=>{if(o!=null&&(o(),o=void 0),e.topHatProperties!=null&&e.length!=null){let r=.001,t=new G;{let l=e.topHatProperties().width*r,n=e.topHatProperties().height*r,a=e.topHatProperties().topWidth*r,P=.5*a,v=1*r;t.moveTo(0,0),t.lineTo(P,0),t.lineTo(.5*l-.5*a,n-v),t.lineTo(.5*l+.5*a,n-v),t.lineTo(l-P,0),t.lineTo(l,0),t.lineTo(l,v),t.lineTo(l-P,v),t.lineTo(.5*l+.5*a,n),t.lineTo(.5*l-.5*a,n),t.lineTo(P,v),t.lineTo(0,v),t.closePath()}let s=new _(t,{depth:e.length()/1e3,bevelEnabled:!1});s.rotateZ(90*Math.PI/180),s.rotateY(90*Math.PI/180);const u=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#808080"}),g=new O({color:"#000000"}),c=new S(s,u),d=new x(s),h=new m(d,g);return o=()=>{s.dispose(),d.dispose(),u.dispose(),g.dispose()},[c,h]}else return[]});return k(()=>{o?.()}),y}function Te(e,b){let o,y=z(()=>{if(o!=null&&(o(),o=void 0),e.timberProperties!=null&&e.length!=null){const r=new Z(e.length()/1e3,e.timberProperties().webSize/1e3,e.timberProperties().flangeSize/1e3),t=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#C08000"});if(e.colour!=null&&b!=null){let d=e.colour,h=b;F(()=>{let l=d(),n=E[l],a;n==null?a="#C08000":a=n.colourHex,t.color.setStyle(a),h()})}const s=new O({color:"#000000"});if(r.translate(.5*e.length()/1e3,.5*e.timberProperties().webSize/1e3,.5*e.timberProperties().flangeSize/1e3),e.frontBackCutAngle!=null||e.backBackCutAngle!=null){let d=(e.frontBackCutAngle??(()=>0))(),h=(e.backBackCutAngle??(()=>0))();if(d!=0||h!=0){let l=[],n=r.attributes.position;for(let a=0;a<n.array.length;a++)l.push(n.array[a]);if(d!=0){let a=.5*e.length()/1e3,P=.5*e.timberProperties().webSize/1e3,v=e.timberProperties().webSize/1e3,w=Math.tan(d*Math.PI/180);if(d>0)for(let i=0;i<l.length;i+=3){let f=l[i],p=l[i+1];f<a&&p>P&&(l[i]=f+p*w)}else for(let i=0;i<n.array.length;i+=3){let f=n.array[i],p=n.array[i+1];f<a&&p<P&&(l[i]=f+(v-p)*-w)}}if(h!=0){let a=.5*e.length()/1e3,P=.5*e.timberProperties().webSize/1e3,v=e.timberProperties().webSize/1e3,w=Math.tan(h*Math.PI/180);if(h>0)for(let i=0;i<l.length;i+=3){let f=l[i],p=l[i+1];f>a&&p>P&&(l[i]=f-p*w)}else for(let i=0;i<n.array.length;i+=3){let f=n.array[i],p=n.array[i+1];f>a&&p<P&&(l[i]=f-(v-p)*-w)}}r.setAttribute("position",new Y(new Float32Array(l),3))}}const u=new S(r,t);let g=new x(r);const c=new m(g,s);return o=()=>{r.dispose(),g.dispose(),t.dispose(),s.dispose()},[u,c]}else return[]});return k(()=>{o?.()}),y}function ke(e,b){let o,y=z(()=>{if(o!=null&&(o(),o=void 0),e.flashingProfile!=null&&e.flashingProfile().start!=null&&e.length!=null){let r=ne(e.flashingProfile(),1);if(r!=null){let t=.001,s=new G;s.moveTo(r[0].x*t,r[0].y*t);for(let P of r)s.lineTo(P.x*t,P.y*t);s.closePath();let u=new _(s,{depth:e.length()/1e3,bevelEnabled:!1});u.rotateZ(90*Math.PI/180),u.rotateY(90*Math.PI/180);let g,c=e.colour?.call(e);c!=null?g=E[c]?.colourHex??"#808080":g="#808080";const d=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:g}),h=new O({color:"#000000"}),l=new S(u,d),n=new x(u),a=new m(n,h);return o=()=>{u.dispose(),n.dispose(),d.dispose(),h.dispose()},[l,a]}else return[]}else return[]});return k(()=>{o?.()}),y}function Se(e,b){let o=z(()=>e.mkObject3d!=null?[e.mkObject3d()(b??(()=>{}))]:[]);return k(()=>{}),o}function me(e,b){let o,y=z(()=>{if(o!=null&&(o(),o=void 0),e.openingProperties!=null){let r=e.openingProperties();if(r.type=="PA Door"){let t=.001,s=100,u=50;const g=new G;g.moveTo(0,0),g.lineTo(r.width*t,0),g.lineTo(r.width*t,r.height*t),g.lineTo(0,r.height*t),g.closePath();let c=r.height*.55;{const B=new G;B.moveTo(s*t,s*t),B.lineTo((r.width-s)*t,s*t),B.lineTo((r.width-s)*t,(c-.5*s)*t),B.lineTo(s*t,(c-.5*s)*t),B.closePath(),g.holes.push(B)}{const B=new G;B.moveTo(s*t,(c+.5*s)*t),B.lineTo((r.width-s)*t,(c+.5*s)*t),B.lineTo((r.width-s)*t,(r.height-s)*t),B.lineTo(s*t,(r.height-s)*t),B.closePath(),g.holes.push(B)}const d=new _(g,{bevelEnabled:!1,depth:.5*u*t});d.rotateX(.5*Math.PI);let h=20,l=40,n=new Q(.5*h*t,.5*h*t,h*t),a;r.swapHingSide??!1?a=.5*s*t:a=.5*(r.width-s+r.width)*t,n.translate(a,-u*t,c*t);let P=new oe(.5*l*t);P.translate(a,-(u+h*t+.5*l)*t,c*t);const v=new Z(e.openingProperties().width/1e3,60/1e3,e.openingProperties().height/1e3);let w,i=e.colour?.call(e);i!=null?w=E[i]?.colourHex??"#804000":w="#804000";const f=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:w}),p=new O({color:"#000000"}),j=new M({color:"#808080"});v.translate(.5*e.openingProperties().width/1e3,.03,.5*e.openingProperties().height/1e3);const U=new S(v,f);let D=new x(v);const T=new m(D,p),C=new S(d,f);let A=new x(d),R=new m(A,p),ee=new S(n,j),te=new S(P,j);return o=()=>{v.dispose(),D.dispose(),d.dispose(),A.dispose(),n.dispose(),P.dispose(),f.dispose(),p.dispose(),j.dispose()},r.removeHandle??!1?[U,T,C,R]:[U,T,C,R,ee,te]}else if(r.type=="Window"){let t=.001,s=20;const u=new G;u.moveTo(0,0),u.lineTo(r.width*t,0),u.lineTo(r.width*t,r.height*t),u.lineTo(0,r.height*t),u.closePath();{const f=new G;f.moveTo(s*t,s*t),f.lineTo((.5*r.width-.5*s)*t,s*t),f.lineTo((.5*r.width-.5*s)*t,(r.height-s)*t),f.lineTo(s*t,(r.height-s)*t),f.closePath(),u.holes.push(f)}{const f=new G;f.moveTo((.5*r.width+.5*s)*t,s*t),f.lineTo((r.width-s)*t,s*t),f.lineTo((r.width-s)*t,(r.height-s)*t),f.lineTo((.5*r.width+.5*s)*t,(r.height-s)*t),f.closePath(),u.holes.push(f)}const g=new _(u,{bevelEnabled:!1,depth:.5*s*t});g.rotateX(.5*Math.PI);const c=new Z((e.openingProperties().width-2*s)/1e3,5/1e3,(e.openingProperties().height-2*s)/1e3),d=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#000000",transparent:!0,opacity:.5}),h=new O({color:"#000000"}),l=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#804000"});c.translate(.5*e.openingProperties().width/1e3,-.5*(.5*s)/1e3,.5*e.openingProperties().height/1e3);const n=new S(c,d);let a=new x(c);const P=new m(a,h),v=new S(g,l);let w=new x(g);const i=new m(w,h);return n.renderOrder=1,o=()=>{g.dispose(),w.dispose(),c.dispose(),a.dispose(),d.dispose(),h.dispose(),l.dispose()},[v,i,n,P]}else{const t=new Z(e.openingProperties().width/1e3,.1,e.openingProperties().height/1e3),s=new M({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,color:"#808080"}),u=new O({color:"#000000"});t.translate(.5*e.openingProperties().width/1e3,.05,.5*e.openingProperties().height/1e3);const g=new S(t,s);let c=new x(t);const d=new m(c,u);return o=()=>{t.dispose(),c.dispose(),s.dispose(),u.dispose()},[g,d]}}else return[]});return k(()=>{o?.()}),y}function ze(e,b){return e.wireProperties==null||e.length==null?()=>[]:z(()=>{if(e.wireProperties==null||e.length==null)return[];let y=.001,r=.5*e.wireProperties().diameter,t=new Q(r*y,r*y,e.length()*y,8);t.rotateZ(.5*Math.PI),t.translate(.5*e.length()*y,0,0);let s=new M({color:"#808080"});return k(()=>{t.dispose(),s.dispose()}),[new S(t,s)]})}function Be(e,b,o){let y=z(()=>b().flatMap(c=>{let d=[c],h=[];for(;;){let l=d.pop();if(l==null)break;if(l.children!=null){let n=l.children();for(let a=n.length-1;a>=0;--a)d.push(n[a])}l.line!=null&&h.push(l.line())}return h}),[],{equals:(c,d)=>{if(c.length!=d.length)return!1;for(let h=0;h<d.length;++h)if(c[h]!==d[h])return!1;return!0}}),r=500,t=new V,s=new Float32Array(r*3*2);t.setAttribute("position",new Y(s,3)),t.setDrawRange(0,0);let u=new O({color:"black"}),g=new m(t,u);e.add(g),k(()=>{e.remove(g),t.dispose(),u.dispose()}),F(()=>{let c=y();if(c.length>r){for(;c.length>r;)r*=2;s=new Float32Array(r*3*2),t.setAttribute("position",new Y(s,3))}let d=.001,h=0;for(let l of c){let n=l;s[h]=n.v1.x*d,s[h+1]=n.v1.y*d,s[h+2]=n.v1.z*d,s[h+3]=n.v2.x*d,s[h+4]=n.v2.y*d,s[h+5]=n.v2.z*d,h+=6}t.setDrawRange(0,c.length*2),t.getAttribute("position").needsUpdate=!0,t.computeBoundingSphere(),o()})}export{fe as T,Oe as a,Be as b,he as h};
