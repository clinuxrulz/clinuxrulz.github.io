var fe=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},k=[],F=[],ar=typeof Uint8Array<"u"?Uint8Array:Array,Qe=!1;function wt(){Qe=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)k[e]=t[e],F[t.charCodeAt(e)]=e;F["-".charCodeAt(0)]=62,F["_".charCodeAt(0)]=63}function ur(t){Qe||wt();var e,r,n,i,o,s,f=t.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o=t[f-2]==="="?2:t[f-1]==="="?1:0,s=new ar(f*3/4-o),n=o>0?f-4:f;var a=0;for(e=0,r=0;e<n;e+=4,r+=3)i=F[t.charCodeAt(e)]<<18|F[t.charCodeAt(e+1)]<<12|F[t.charCodeAt(e+2)]<<6|F[t.charCodeAt(e+3)],s[a++]=i>>16&255,s[a++]=i>>8&255,s[a++]=i&255;return o===2?(i=F[t.charCodeAt(e)]<<2|F[t.charCodeAt(e+1)]>>4,s[a++]=i&255):o===1&&(i=F[t.charCodeAt(e)]<<10|F[t.charCodeAt(e+1)]<<4|F[t.charCodeAt(e+2)]>>2,s[a++]=i>>8&255,s[a++]=i&255),s}function lr(t){return k[t>>18&63]+k[t>>12&63]+k[t>>6&63]+k[t&63]}function cr(t,e,r){for(var n,i=[],o=e;o<r;o+=3)n=(t[o]<<16)+(t[o+1]<<8)+t[o+2],i.push(lr(n));return i.join("")}function it(t){Qe||wt();for(var e,r=t.length,n=r%3,i="",o=[],s=16383,f=0,a=r-n;f<a;f+=s)o.push(cr(t,f,f+s>a?a:f+s));return n===1?(e=t[r-1],i+=k[e>>2],i+=k[e<<4&63],i+="=="):n===2&&(e=(t[r-2]<<8)+t[r-1],i+=k[e>>10],i+=k[e>>4&63],i+=k[e<<2&63],i+="="),o.push(i),o.join("")}function Oe(t,e,r,n,i){var o,s,f=i*8-n-1,a=(1<<f)-1,l=a>>1,h=-7,c=r?i-1:0,w=r?-1:1,y=t[e+c];for(c+=w,o=y&(1<<-h)-1,y>>=-h,h+=f;h>0;o=o*256+t[e+c],c+=w,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=s*256+t[e+c],c+=w,h-=8);if(o===0)o=1-l;else{if(o===a)return s?NaN:(y?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-l}return(y?-1:1)*s*Math.pow(2,o-n)}function yt(t,e,r,n,i,o){var s,f,a,l=o*8-i-1,h=(1<<l)-1,c=h>>1,w=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:o-1,I=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(f=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-s))<1&&(s--,a*=2),s+c>=1?e+=w/a:e+=w*Math.pow(2,1-c),e*a>=2&&(s++,a/=2),s+c>=h?(f=0,s=h):s+c>=1?(f=(e*a-1)*Math.pow(2,i),s=s+c):(f=e*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[r+y]=f&255,y+=I,f/=256,i-=8);for(s=s<<i|f,l+=i;l>0;t[r+y]=s&255,y+=I,s/=256,l-=8);t[r+y-I]|=g*128}var hr={}.toString,bt=Array.isArray||function(t){return hr.call(t)=="[object Array]"},dr=50;u.TYPED_ARRAY_SUPPORT=fe.TYPED_ARRAY_SUPPORT!==void 0?fe.TYPED_ARRAY_SUPPORT:!0;Se();function Se(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function $(t,e){if(Se()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=u.prototype):(t===null&&(t=new u(e)),t.length=e),t}function u(t,e,r){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(t,e,r);if(typeof t=="number"){if(typeof e=="string")throw new Error("If encoding is specified then the first argument must be a string");return He(this,t)}return vt(this,t,e,r)}u.poolSize=8192;u._augment=function(t){return t.__proto__=u.prototype,t};function vt(t,e,r,n){if(typeof e=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer?gr(t,e,r,n):typeof e=="string"?mr(t,e,r):_r(t,e)}u.from=function(t,e,r){return vt(null,t,e,r)};u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&u[Symbol.species]);function Et(t){if(typeof t!="number")throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function pr(t,e,r,n){return Et(e),e<=0?$(t,e):r!==void 0?typeof n=="string"?$(t,e).fill(r,n):$(t,e).fill(r):$(t,e)}u.alloc=function(t,e,r){return pr(null,t,e,r)};function He(t,e){if(Et(e),t=$(t,e<0?0:Ge(e)|0),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}u.allocUnsafe=function(t){return He(null,t)};u.allocUnsafeSlow=function(t){return He(null,t)};function mr(t,e,r){if((typeof r!="string"||r==="")&&(r="utf8"),!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=xt(e,r)|0;t=$(t,n);var i=t.write(e,r);return i!==n&&(t=t.slice(0,i)),t}function ze(t,e){var r=e.length<0?0:Ge(e.length)|0;t=$(t,r);for(var n=0;n<r;n+=1)t[n]=e[n]&255;return t}function gr(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return r===void 0&&n===void 0?e=new Uint8Array(e):n===void 0?e=new Uint8Array(e,r):e=new Uint8Array(e,r,n),u.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=u.prototype):t=ze(t,e),t}function _r(t,e){if(j(e)){var r=Ge(e.length)|0;return t=$(t,r),t.length===0||e.copy(t,0,0,r),t}if(e){if(typeof ArrayBuffer<"u"&&e.buffer instanceof ArrayBuffer||"length"in e)return typeof e.length!="number"||Br(e.length)?$(t,0):ze(t,e);if(e.type==="Buffer"&&bt(e.data))return ze(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Ge(t){if(t>=Se())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Se().toString(16)+" bytes");return t|0}u.isBuffer=O;function j(t){return!!(t!=null&&t._isBuffer)}u.compare=function(e,r){if(!j(e)||!j(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var n=e.length,i=r.length,o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0};u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};u.concat=function(e,r){if(!bt(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return u.alloc(0);var n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var i=u.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!j(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,o),o+=s.length}return i};function xt(t,e){if(j(t))return t.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;typeof t!="string"&&(t=""+t);var r=t.length;if(r===0)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Ie(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Nt(t).length;default:if(n)return Ie(t).length;e=(""+e).toLowerCase(),n=!0}}u.byteLength=xt;function wr(t,e,r){var n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return Ar(this,e,r);case"utf8":case"utf-8":return Rt(this,e,r);case"ascii":return Rr(this,e,r);case"latin1":case"binary":return Or(this,e,r);case"base64":return Sr(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Cr(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}u.prototype._isBuffer=!0;function K(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}u.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)K(this,r,r+1);return this};u.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)K(this,r,r+3),K(this,r+1,r+2);return this};u.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)K(this,r,r+7),K(this,r+1,r+6),K(this,r+2,r+5),K(this,r+3,r+4);return this};u.prototype.toString=function(){var e=this.length|0;return e===0?"":arguments.length===0?Rt(this,0,e):wr.apply(this,arguments)};u.prototype.equals=function(e){if(!j(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:u.compare(this,e)===0};u.prototype.inspect=function(){var e="",r=dr;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"};u.prototype.compare=function(e,r,n,i,o){if(!j(e))throw new TypeError("Argument must be a Buffer");if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;for(var s=o-i,f=n-r,a=Math.min(s,f),l=this.slice(i,o),h=e.slice(r,n),c=0;c<a;++c)if(l[c]!==h[c]){s=l[c],f=h[c];break}return s<f?-1:f<s?1:0};function St(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=u.from(e,n)),j(e))return e.length===0?-1:ot(t,e,r,n,i);if(typeof e=="number")return e=e&255,u.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):ot(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function ot(t,e,r,n,i){var o=1,s=t.length,f=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;o=2,s/=2,f/=2,r/=2}function a(y,I){return o===1?y[I]:y.readUInt16BE(I*o)}var l;if(i){var h=-1;for(l=r;l<s;l++)if(a(t,l)===a(e,h===-1?0:l-h)){if(h===-1&&(h=l),l-h+1===f)return h*o}else h!==-1&&(l-=l-h),h=-1}else for(r+f>s&&(r=s-f),l=r;l>=0;l--){for(var c=!0,w=0;w<f;w++)if(a(t,l+w)!==a(e,w)){c=!1;break}if(c)return l}return-1}u.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};u.prototype.indexOf=function(e,r,n){return St(this,e,r,n,!0)};u.prototype.lastIndexOf=function(e,r,n){return St(this,e,r,n,!1)};function yr(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;if(o%2!==0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var f=parseInt(e.substr(s*2,2),16);if(isNaN(f))return s;t[r+s]=f}return s}function br(t,e,r,n){return Ne(Ie(e,t.length-r),t,r,n)}function It(t,e,r,n){return Ne(Mr(e),t,r,n)}function vr(t,e,r,n){return It(t,e,r,n)}function Er(t,e,r,n){return Ne(Nt(e),t,r,n)}function xr(t,e,r,n){return Ne(Fr(e,t.length-r),t,r,n)}u.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r|0,isFinite(n)?(n=n|0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-r;if((n===void 0||n>o)&&(n=o),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return yr(this,e,r,n);case"utf8":case"utf-8":return br(this,e,r,n);case"ascii":return It(this,e,r,n);case"latin1":case"binary":return vr(this,e,r,n);case"base64":return Er(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xr(this,e,r,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Sr(t,e,r){return e===0&&r===t.length?it(t):it(t.slice(e,r))}function Rt(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o=t[i],s=null,f=o>239?4:o>223?3:o>191?2:1;if(i+f<=r){var a,l,h,c;switch(f){case 1:o<128&&(s=o);break;case 2:a=t[i+1],(a&192)===128&&(c=(o&31)<<6|a&63,c>127&&(s=c));break;case 3:a=t[i+1],l=t[i+2],(a&192)===128&&(l&192)===128&&(c=(o&15)<<12|(a&63)<<6|l&63,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:a=t[i+1],l=t[i+2],h=t[i+3],(a&192)===128&&(l&192)===128&&(h&192)===128&&(c=(o&15)<<18|(a&63)<<12|(l&63)<<6|h&63,c>65535&&c<1114112&&(s=c))}}s===null?(s=65533,f=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=f}return Ir(n)}var st=4096;function Ir(t){var e=t.length;if(e<=st)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=st));return r}function Rr(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function Or(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function Ar(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=Dr(t[o]);return i}function Cr(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}u.prototype.slice=function(e,r){var n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);var i;if(u.TYPED_ARRAY_SUPPORT)i=this.subarray(e,r),i.__proto__=u.prototype;else{var o=r-e;i=new u(o,void 0);for(var s=0;s<o;++s)i[s]=this[s+e]}return i};function A(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUIntLE=function(e,r,n){e=e|0,r=r|0,n||A(e,r,this.length);for(var i=this[e],o=1,s=0;++s<r&&(o*=256);)i+=this[e+s]*o;return i};u.prototype.readUIntBE=function(e,r,n){e=e|0,r=r|0,n||A(e,r,this.length);for(var i=this[e+--r],o=1;r>0&&(o*=256);)i+=this[e+--r]*o;return i};u.prototype.readUInt8=function(e,r){return r||A(e,1,this.length),this[e]};u.prototype.readUInt16LE=function(e,r){return r||A(e,2,this.length),this[e]|this[e+1]<<8};u.prototype.readUInt16BE=function(e,r){return r||A(e,2,this.length),this[e]<<8|this[e+1]};u.prototype.readUInt32LE=function(e,r){return r||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};u.prototype.readUInt32BE=function(e,r){return r||A(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};u.prototype.readIntLE=function(e,r,n){e=e|0,r=r|0,n||A(e,r,this.length);for(var i=this[e],o=1,s=0;++s<r&&(o*=256);)i+=this[e+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*r)),i};u.prototype.readIntBE=function(e,r,n){e=e|0,r=r|0,n||A(e,r,this.length);for(var i=r,o=1,s=this[e+--i];i>0&&(o*=256);)s+=this[e+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*r)),s};u.prototype.readInt8=function(e,r){return r||A(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};u.prototype.readInt16LE=function(e,r){r||A(e,2,this.length);var n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};u.prototype.readInt16BE=function(e,r){r||A(e,2,this.length);var n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};u.prototype.readInt32LE=function(e,r){return r||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};u.prototype.readInt32BE=function(e,r){return r||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};u.prototype.readFloatLE=function(e,r){return r||A(e,4,this.length),Oe(this,e,!0,23,4)};u.prototype.readFloatBE=function(e,r){return r||A(e,4,this.length),Oe(this,e,!1,23,4)};u.prototype.readDoubleLE=function(e,r){return r||A(e,8,this.length),Oe(this,e,!0,52,8)};u.prototype.readDoubleBE=function(e,r){return r||A(e,8,this.length),Oe(this,e,!1,52,8)};function L(t,e,r,n,i,o){if(!j(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}u.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r|0,n=n|0,!i){var o=Math.pow(2,8*n)-1;L(this,e,r,n,o,0)}var s=1,f=0;for(this[r]=e&255;++f<n&&(s*=256);)this[r+f]=e/s&255;return r+n};u.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r|0,n=n|0,!i){var o=Math.pow(2,8*n)-1;L(this,e,r,n,o,0)}var s=n-1,f=1;for(this[r+s]=e&255;--s>=0&&(f*=256);)this[r+s]=e/f&255;return r+n};u.prototype.writeUInt8=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[r]=e&255,r+1};function Ae(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}u.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[r]=e&255,this[r+1]=e>>>8):Ae(this,e,r,!0),r+2};u.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=e&255):Ae(this,e,r,!1),r+2};function Ce(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>(n?i:3-i)*8&255}u.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255):Ce(this,e,r,!0),r+4};u.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255):Ce(this,e,r,!1),r+4};u.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r|0,!i){var o=Math.pow(2,8*n-1);L(this,e,r,n,o-1,-o)}var s=0,f=1,a=0;for(this[r]=e&255;++s<n&&(f*=256);)e<0&&a===0&&this[r+s-1]!==0&&(a=1),this[r+s]=(e/f>>0)-a&255;return r+n};u.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r|0,!i){var o=Math.pow(2,8*n-1);L(this,e,r,n,o-1,-o)}var s=n-1,f=1,a=0;for(this[r+s]=e&255;--s>=0&&(f*=256);)e<0&&a===0&&this[r+s+1]!==0&&(a=1),this[r+s]=(e/f>>0)-a&255;return r+n};u.prototype.writeInt8=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[r]=e&255,r+1};u.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[r]=e&255,this[r+1]=e>>>8):Ae(this,e,r,!0),r+2};u.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=e&255):Ae(this,e,r,!1),r+2};u.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24):Ce(this,e,r,!0),r+4};u.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r|0,n||L(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255):Ce(this,e,r,!1),r+4};function Ot(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function At(t,e,r,n,i){return i||Ot(t,e,r,4),yt(t,e,r,n,23,4),r+4}u.prototype.writeFloatLE=function(e,r,n){return At(this,e,r,!0,n)};u.prototype.writeFloatBE=function(e,r,n){return At(this,e,r,!1,n)};function Ct(t,e,r,n,i){return i||Ot(t,e,r,8),yt(t,e,r,n,52,8),r+8}u.prototype.writeDoubleLE=function(e,r,n){return Ct(this,e,r,!0,n)};u.prototype.writeDoubleBE=function(e,r,n){return Ct(this,e,r,!1,n)};u.prototype.copy=function(e,r,n,i){if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var o=i-n,s;if(this===e&&n<r&&r<i)for(s=o-1;s>=0;--s)e[s+r]=this[s+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(s=0;s<o;++s)e[s+r]=this[s+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),r);return o};u.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),e.length===1){var o=e.charCodeAt(0);o<256&&(e=o)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!u.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof e=="number"&&(e=e&255);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);var s;if(typeof e=="number")for(s=r;s<n;++s)this[s]=e;else{var f=j(e)?e:Ie(new u(e,i).toString()),a=f.length;for(s=0;s<n-r;++s)this[s+r]=f[s%a]}return this};var Nr=/[^+\/0-9A-Za-z-_]/g;function Tr(t){if(t=Lr(t).replace(Nr,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function Lr(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Dr(t){return t<16?"0"+t.toString(16):t.toString(16)}function Ie(t,e){e=e||1/0;for(var r,n=t.length,i=null,o=[],s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function Mr(t){for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function Fr(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function Nt(t){return ur(Tr(t))}function Ne(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Br(t){return t!==t}function O(t){return t!=null&&(!!t._isBuffer||Tt(t)||Ur(t))}function Tt(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function Ur(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&Tt(t.slice(0,0))}var qr;function Z(){}Z.prototype=Object.create(null);function _(){_.init.call(this)}_.EventEmitter=_;_.usingDomains=!1;_.prototype.domain=void 0;_.prototype._events=void 0;_.prototype._maxListeners=void 0;_.defaultMaxListeners=10;_.init=function(){this.domain=null,_.usingDomains&&qr.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Z,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};_.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this};function Lt(t){return t._maxListeners===void 0?_.defaultMaxListeners:t._maxListeners}_.prototype.getMaxListeners=function(){return Lt(this)};function kr(t,e,r){if(e)t.call(r);else for(var n=t.length,i=he(t,n),o=0;o<n;++o)i[o].call(r)}function jr(t,e,r,n){if(e)t.call(r,n);else for(var i=t.length,o=he(t,i),s=0;s<i;++s)o[s].call(r,n)}function $r(t,e,r,n,i){if(e)t.call(r,n,i);else for(var o=t.length,s=he(t,o),f=0;f<o;++f)s[f].call(r,n,i)}function Pr(t,e,r,n,i,o){if(e)t.call(r,n,i,o);else for(var s=t.length,f=he(t,s),a=0;a<s;++a)f[a].call(r,n,i,o)}function zr(t,e,r,n){if(e)t.apply(r,n);else for(var i=t.length,o=he(t,i),s=0;s<i;++s)o[s].apply(r,n)}_.prototype.emit=function(e){var r,n,i,o,s,f,a,l=e==="error";if(f=this._events,f)l=l&&f.error==null;else if(!l)return!1;if(a=this.domain,l){if(r=arguments[1],a)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=a,r.domainThrown=!1,a.emit("error",r);else{if(r instanceof Error)throw r;var h=new Error('Uncaught, unspecified "error" event. ('+r+")");throw h.context=r,h}return!1}if(n=f[e],!n)return!1;var c=typeof n=="function";switch(i=arguments.length,i){case 1:kr(n,c,this);break;case 2:jr(n,c,this,arguments[1]);break;case 3:$r(n,c,this,arguments[1],arguments[2]);break;case 4:Pr(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(i-1),s=1;s<i;s++)o[s-1]=arguments[s];zr(n,c,this,o)}return!0};function Dt(t,e,r,n){var i,o,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(o=t._events,o?(o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]):(o=t._events=new Z,t._eventsCount=0),!s)s=o[e]=r,++t._eventsCount;else if(typeof s=="function"?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=Lt(t),i&&i>0&&s.length>i)){s.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=t,f.type=e,f.count=s.length,Jr(f)}return t}function Jr(t){typeof console.warn=="function"?console.warn(t):console.log(t)}_.prototype.addListener=function(e,r){return Dt(this,e,r,!1)};_.prototype.on=_.prototype.addListener;_.prototype.prependListener=function(e,r){return Dt(this,e,r,!0)};function Mt(t,e,r){var n=!1;function i(){t.removeListener(e,i),n||(n=!0,r.apply(t,arguments))}return i.listener=r,i}_.prototype.once=function(e,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,Mt(this,e,r)),this};_.prototype.prependOnceListener=function(e,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Mt(this,e,r)),this};_.prototype.removeListener=function(e,r){var n,i,o,s,f;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[e],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Z:(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(o=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){f=n[s].listener,o=s;break}if(o<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Z,this;delete i[e]}else Vr(n,o);i.removeListener&&this.emit("removeListener",e,f||r)}return this};_.prototype.removeAllListeners=function(e){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Z,this._eventsCount=0):n[e]&&(--this._eventsCount===0?this._events=new Z:delete n[e]),this;if(arguments.length===0){for(var i=Object.keys(n),o=0,s;o<i.length;++o)s=i[o],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Z,this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r)do this.removeListener(e,r[r.length-1]);while(r[0]);return this};_.prototype.listeners=function(e){var r,n,i=this._events;return i?(r=i[e],r?typeof r=="function"?n=[r.listener||r]:n=Yr(r):n=[]):n=[],n};_.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Ft.call(t,e)};_.prototype.listenerCount=Ft;function Ft(t){var e=this._events;if(e){var r=e[t];if(typeof r=="function")return 1;if(r)return r.length}return 0}_.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Vr(t,e){for(var r=e,n=r+1,i=t.length;n<i;r+=1,n+=1)t[r]=t[n];t.pop()}function he(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}function Yr(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Bt(){throw new Error("setTimeout has not been defined")}function Ut(){throw new Error("clearTimeout has not been defined")}var H=Bt,G=Ut;typeof fe.setTimeout=="function"&&(H=setTimeout);typeof fe.clearTimeout=="function"&&(G=clearTimeout);function qt(t){if(H===setTimeout)return setTimeout(t,0);if((H===Bt||!H)&&setTimeout)return H=setTimeout,setTimeout(t,0);try{return H(t,0)}catch{try{return H.call(null,t,0)}catch{return H.call(this,t,0)}}}function Wr(t){if(G===clearTimeout)return clearTimeout(t);if((G===Ut||!G)&&clearTimeout)return G=clearTimeout,clearTimeout(t);try{return G(t)}catch{try{return G.call(null,t)}catch{return G.call(this,t)}}}var P=[],oe=!1,ee,ye=-1;function Qr(){!oe||!ee||(oe=!1,ee.length?P=ee.concat(P):ye=-1,P.length&&kt())}function kt(){if(!oe){var t=qt(Qr);oe=!0;for(var e=P.length;e;){for(ee=P,P=[];++ye<e;)ee&&ee[ye].run();ye=-1,e=P.length}ee=null,oe=!1,Wr(t)}}function M(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];P.push(new jt(t,e)),P.length===1&&!oe&&qt(kt)}function jt(t,e){this.fun=t,this.array=e}jt.prototype.run=function(){this.fun.apply(null,this.array)};var Hr="browser",Gr="browser",Zr=!0,Xr={},Kr=[],en="",tn={},rn={},nn={};function te(){}var on=te,sn=te,fn=te,an=te,un=te,ln=te,cn=te;function hn(t){throw new Error("process.binding is not supported")}function dn(){return"/"}function pn(t){throw new Error("process.chdir is not supported")}function mn(){return 0}var ie=fe.performance||{},gn=ie.now||ie.mozNow||ie.msNow||ie.oNow||ie.webkitNow||function(){return new Date().getTime()};function _n(t){var e=gn.call(ie)*.001,r=Math.floor(e),n=Math.floor(e%1*1e9);return t&&(r=r-t[0],n=n-t[1],n<0&&(r--,n+=1e9)),[r,n]}var wn=new Date;function yn(){var t=new Date,e=t-wn;return e/1e3}var be={nextTick:M,title:Hr,browser:Zr,env:Xr,argv:Kr,version:en,versions:tn,on,addListener:sn,once:fn,off:an,removeListener:un,removeAllListeners:ln,emit:cn,binding:hn,cwd:dn,chdir:pn,umask:mn,hrtime:_n,platform:Gr,release:rn,config:nn,uptime:yn},Je;typeof Object.create=="function"?Je=function(e,r){e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:Je=function(e,r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e};var re=Je,bn=/%[sdj%]/g;function Ze(t){if(!Le(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(J(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,i=n.length,o=String(t).replace(bn,function(f){if(f==="%%")return"%";if(r>=i)return f;switch(f){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch{return"[Circular]"}default:return f}}),s=n[r];r<i;s=n[++r])Te(s)||!ae(s)?o+=" "+s:o+=" "+J(s);return o}function Xe(t,e){if(z(fe.process))return function(){return Xe(t,e).apply(this,arguments)};if(be.noDeprecation===!0)return t;var r=!1;function n(){if(!r){if(be.throwDeprecation)throw new Error(e);be.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}return n}var ge={},Ue;function $t(t){if(z(Ue)&&(Ue=be.env.NODE_DEBUG||""),t=t.toUpperCase(),!ge[t])if(new RegExp("\\b"+t+"\\b","i").test(Ue)){var e=0;ge[t]=function(){var r=Ze.apply(null,arguments);console.error("%s %d: %s",t,e,r)}}else ge[t]=function(){};return ge[t]}function J(t,e){var r={seen:[],stylize:En};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),Ke(e)?r.showHidden=e:e&&Jt(r,e),z(r.showHidden)&&(r.showHidden=!1),z(r.depth)&&(r.depth=2),z(r.colors)&&(r.colors=!1),z(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=vn),Re(r,t,r.depth)}J.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};J.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function vn(t,e){var r=J.styles[e];return r?"\x1B["+J.colors[r][0]+"m"+t+"\x1B["+J.colors[r][1]+"m":t}function En(t,e){return t}function xn(t){var e={};return t.forEach(function(r,n){e[r]=!0}),e}function Re(t,e,r){if(t.customInspect&&e&&xe(e.inspect)&&e.inspect!==J&&!(e.constructor&&e.constructor.prototype===e)){var n=e.inspect(r,t);return Le(n)||(n=Re(t,n,r)),n}var i=Sn(t,e);if(i)return i;var o=Object.keys(e),s=xn(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),Ee(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return qe(e);if(o.length===0){if(xe(e)){var f=e.name?": "+e.name:"";return t.stylize("[Function"+f+"]","special")}if(ve(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(Ye(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Ee(e))return qe(e)}var a="",l=!1,h=["{","}"];if(Pt(e)&&(l=!0,h=["[","]"]),xe(e)){var c=e.name?": "+e.name:"";a=" [Function"+c+"]"}if(ve(e)&&(a=" "+RegExp.prototype.toString.call(e)),Ye(e)&&(a=" "+Date.prototype.toUTCString.call(e)),Ee(e)&&(a=" "+qe(e)),o.length===0&&(!l||e.length==0))return h[0]+a+h[1];if(r<0)return ve(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var w;return l?w=In(t,e,r,s,o):w=o.map(function(y){return Ve(t,e,r,s,y,l)}),t.seen.pop(),Rn(w,a,h)}function Sn(t,e){if(z(e))return t.stylize("undefined","undefined");if(Le(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(zt(e))return t.stylize(""+e,"number");if(Ke(e))return t.stylize(""+e,"boolean");if(Te(e))return t.stylize("null","null")}function qe(t){return"["+Error.prototype.toString.call(t)+"]"}function In(t,e,r,n,i){for(var o=[],s=0,f=e.length;s<f;++s)Vt(e,String(s))?o.push(Ve(t,e,r,n,String(s),!0)):o.push("");return i.forEach(function(a){a.match(/^\d+$/)||o.push(Ve(t,e,r,n,a,!0))}),o}function Ve(t,e,r,n,i,o){var s,f,a;if(a=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},a.get?a.set?f=t.stylize("[Getter/Setter]","special"):f=t.stylize("[Getter]","special"):a.set&&(f=t.stylize("[Setter]","special")),Vt(n,i)||(s="["+i+"]"),f||(t.seen.indexOf(a.value)<0?(Te(r)?f=Re(t,a.value,null):f=Re(t,a.value,r-1),f.indexOf(`
`)>-1&&(o?f=f.split(`
`).map(function(l){return"  "+l}).join(`
`).substr(2):f=`
`+f.split(`
`).map(function(l){return"   "+l}).join(`
`))):f=t.stylize("[Circular]","special")),z(s)){if(o&&i.match(/^\d+$/))return f;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+f}function Rn(t,e,r){var n=t.reduce(function(i,o){return o.indexOf(`
`)>=0,i+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?r[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function Pt(t){return Array.isArray(t)}function Ke(t){return typeof t=="boolean"}function Te(t){return t===null}function On(t){return t==null}function zt(t){return typeof t=="number"}function Le(t){return typeof t=="string"}function An(t){return typeof t=="symbol"}function z(t){return t===void 0}function ve(t){return ae(t)&&et(t)==="[object RegExp]"}function ae(t){return typeof t=="object"&&t!==null}function Ye(t){return ae(t)&&et(t)==="[object Date]"}function Ee(t){return ae(t)&&(et(t)==="[object Error]"||t instanceof Error)}function xe(t){return typeof t=="function"}function Cn(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t>"u"}function Nn(t){return O(t)}function et(t){return Object.prototype.toString.call(t)}function ke(t){return t<10?"0"+t.toString(10):t.toString(10)}var Tn=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ln(){var t=new Date,e=[ke(t.getHours()),ke(t.getMinutes()),ke(t.getSeconds())].join(":");return[t.getDate(),Tn[t.getMonth()],e].join(" ")}function Dn(){console.log("%s - %s",Ln(),Ze.apply(null,arguments))}function Jt(t,e){if(!e||!ae(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}function Vt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Yt={inherits:re,_extend:Jt,log:Dn,isBuffer:Nn,isPrimitive:Cn,isFunction:xe,isError:Ee,isDate:Ye,isObject:ae,isRegExp:ve,isUndefined:z,isSymbol:An,isString:Le,isNumber:zt,isNullOrUndefined:On,isNull:Te,isBoolean:Ke,isArray:Pt,inspect:J,deprecate:Xe,format:Ze,debuglog:$t};function ne(){this.head=null,this.tail=null,this.length=0}ne.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length};ne.prototype.unshift=function(t){var e={data:t,next:this.head};this.length===0&&(this.tail=e),this.head=e,++this.length};ne.prototype.shift=function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}};ne.prototype.clear=function(){this.head=this.tail=null,this.length=0};ne.prototype.join=function(t){if(this.length===0)return"";for(var e=this.head,r=""+e.data;e=e.next;)r+=t+e.data;return r};ne.prototype.concat=function(t){if(this.length===0)return u.alloc(0);if(this.length===1)return this.head.data;for(var e=u.allocUnsafe(t>>>0),r=this.head,n=0;r;)r.data.copy(e,n),n+=r.data.length,r=r.next;return e};var Mn=u.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Fn(t){if(t&&!Mn(t))throw new Error("Unknown encoding: "+t)}function de(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),Fn(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Un;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=qn;break;default:this.write=Bn;return}this.charBuffer=new u(6),this.charReceived=0,this.charLength=0}de.prototype.write=function(t){for(var e="";this.charLength;){var r=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";t=t.slice(r,t.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var i=e.charCodeAt(e.length-1);if(i>=55296&&i<=56319){this.charLength+=this.surrogateSize,e="";continue}if(this.charReceived=this.charLength=0,t.length===0)return e;break}this.detectIncompleteChar(t);var n=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,n),n-=this.charReceived),e+=t.toString(this.encoding,0,n);var n=e.length-1,i=e.charCodeAt(n);if(i>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),e.substring(0,n)}return e};de.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var r=t[t.length-e];if(e==1&&r>>5==6){this.charLength=2;break}if(e<=2&&r>>4==14){this.charLength=3;break}if(e<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=e};de.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;e+=n.slice(0,r).toString(i)}return e};function Bn(t){return t.toString(this.encoding)}function Un(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function qn(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}R.ReadableState=Wt;var x=$t("stream");re(R,_);function kn(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function jn(t,e){return t.listeners(e).length}function Wt(t,e){t=t||{},this.objectMode=!!t.objectMode,e instanceof B&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,n=this.objectMode?16:16*1024;this.highWaterMark=r||r===0?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new ne,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(this.decoder=new de(t.encoding),this.encoding=t.encoding)}function R(t){if(!(this instanceof R))return new R(t);this._readableState=new Wt(t,this),this.readable=!0,t&&typeof t.read=="function"&&(this._read=t.read),_.call(this)}R.prototype.push=function(t,e){var r=this._readableState;return!r.objectMode&&typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=u.from(t,e),e="")),Qt(this,r,t,e,!1)};R.prototype.unshift=function(t){var e=this._readableState;return Qt(this,e,t,"",!0)};R.prototype.isPaused=function(){return this._readableState.flowing===!1};function Qt(t,e,r,n,i){var o=zn(e,r);if(o)t.emit("error",o);else if(r===null)e.reading=!1,Jn(t,e);else if(e.objectMode||r&&r.length>0)if(e.ended&&!i){var s=new Error("stream.push() after EOF");t.emit("error",s)}else if(e.endEmitted&&i){var f=new Error("stream.unshift() after end event");t.emit("error",f)}else{var a;e.decoder&&!i&&!n&&(r=e.decoder.write(r),a=!e.objectMode&&r.length===0),i||(e.reading=!1),a||(e.flowing&&e.length===0&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&De(t))),Vn(t,e)}else i||(e.reading=!1);return $n(e)}function $n(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}R.prototype.setEncoding=function(t){return this._readableState.decoder=new de(t),this._readableState.encoding=t,this};var ft=8388608;function Pn(t){return t>=ft?t=ft:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function at(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=Pn(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}R.prototype.read=function(t){x("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return x("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?je(this):De(this),null;if(t=at(t,e),t===0&&e.ended)return e.length===0&&je(this),null;var n=e.needReadable;x("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,x("length less than watermark",n)),e.ended||e.reading?(n=!1,x("reading or ended",n)):n&&(x("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=at(r,e)));var i;return t>0?i=Ht(t,e):i=null,i===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&je(this)),i!==null&&this.emit("data",i),i};function zn(t,e){var r=null;return!O(e)&&typeof e!="string"&&e!==null&&e!==void 0&&!t.objectMode&&(r=new TypeError("Invalid non-string/buffer chunk")),r}function Jn(t,e){if(!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,De(t)}}function De(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(x("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?M(ut,t):ut(t))}function ut(t){x("emit readable"),t.emit("readable"),tt(t)}function Vn(t,e){e.readingMore||(e.readingMore=!0,M(Yn,t,e))}function Yn(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(x("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}R.prototype._read=function(t){this.emit("error",new Error("not implemented"))};R.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,x("pipe count=%d opts=%j",n.pipesCount,e);var i=!e||e.end!==!1,o=i?f:h;n.endEmitted?M(o):r.once("end",o),t.on("unpipe",s);function s(E){x("onunpipe"),E===r&&h()}function f(){x("onend"),t.end()}var a=Wn(r);t.on("drain",a);var l=!1;function h(){x("cleanup"),t.removeListener("close",I),t.removeListener("finish",g),t.removeListener("drain",a),t.removeListener("error",y),t.removeListener("unpipe",s),r.removeListener("end",f),r.removeListener("end",h),r.removeListener("data",w),l=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&a()}var c=!1;r.on("data",w);function w(E){x("ondata"),c=!1;var m=t.write(E);m===!1&&!c&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&Gt(n.pipes,t)!==-1)&&!l&&(x("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,c=!0),r.pause())}function y(E){x("onerror",E),N(),t.removeListener("error",y),jn(t,"error")===0&&t.emit("error",E)}kn(t,"error",y);function I(){t.removeListener("finish",g),N()}t.once("close",I);function g(){x("onfinish"),t.removeListener("close",I),N()}t.once("finish",g);function N(){x("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(x("pipe resume"),r.resume()),t};function Wn(t){return function(){var e=t._readableState;x("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&t.listeners("data").length&&(e.flowing=!0,tt(t))}}R.prototype.unpipe=function(t){var e=this._readableState;if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var o=Gt(e.pipes,t);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)};R.prototype.on=function(t,e){var r=_.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var n=this._readableState;!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&De(this):M(Qn,this))}return r};R.prototype.addListener=R.prototype.on;function Qn(t){x("readable nexttick read 0"),t.read(0)}R.prototype.resume=function(){var t=this._readableState;return t.flowing||(x("resume"),t.flowing=!0,Hn(this,t)),this};function Hn(t,e){e.resumeScheduled||(e.resumeScheduled=!0,M(Gn,t,e))}function Gn(t,e){e.reading||(x("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),tt(t),e.flowing&&!e.reading&&t.read(0)}R.prototype.pause=function(){return x("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(x("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function tt(t){var e=t._readableState;for(x("flow",e.flowing);e.flowing&&t.read()!==null;);}R.prototype.wrap=function(t){var e=this._readableState,r=!1,n=this;t.on("end",function(){if(x("wrapped end"),e.decoder&&!e.ended){var s=e.decoder.end();s&&s.length&&n.push(s)}n.push(null)}),t.on("data",function(s){if(x("wrapped data"),e.decoder&&(s=e.decoder.write(s)),!(e.objectMode&&s==null)&&!(!e.objectMode&&(!s||!s.length))){var f=n.push(s);f||(r=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(s){return function(){return t[s].apply(t,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return ti(o,function(s){t.on(s,n.emit.bind(n,s))}),n._read=function(s){x("wrapped _read",s),r&&(r=!1,t.resume())},n};R._fromList=Ht;function Ht(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.head.data:r=e.buffer.concat(e.length),e.buffer.clear()):r=Zn(t,e.buffer,e.decoder),r}function Zn(t,e,r){var n;return t<e.head.data.length?(n=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?n=e.shift():n=r?Xn(t,e):Kn(t,e),n}function Xn(t,e){var r=e.head,n=1,i=r.data;for(t-=i.length;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),t-=s,t===0){s===o.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++n}return e.length-=n,i}function Kn(t,e){var r=u.allocUnsafe(t),n=e.head,i=1;for(n.data.copy(r),t-=n.data.length;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(o.copy(r,r.length-t,0,s),t-=s,t===0){s===o.length?(++i,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(s));break}++i}return e.length-=i,r}function je(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,M(ei,e,t))}function ei(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function ti(t,e){for(var r=0,n=t.length;r<n;r++)e(t[r],r)}function Gt(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}C.WritableState=rt;re(C,_);function ri(){}function ni(t,e,r){this.chunk=t,this.encoding=e,this.callback=r,this.next=null}function rt(t,e){Object.defineProperty(this,"buffer",{get:Xe(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),t=t||{},this.objectMode=!!t.objectMode,e instanceof B&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,n=this.objectMode?16:16*1024;this.highWaterMark=r||r===0?r:n,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=t.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(o){li(e,o)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new er(this)}rt.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};function C(t){if(!(this instanceof C)&&!(this instanceof B))return new C(t);this._writableState=new rt(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev)),_.call(this)}C.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function ii(t,e){var r=new Error("write after end");t.emit("error",r),M(e,r)}function oi(t,e,r,n){var i=!0,o=!1;return r===null?o=new TypeError("May not write null values to stream"):!u.isBuffer(r)&&typeof r!="string"&&r!==void 0&&!e.objectMode&&(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),M(n,o),i=!1),i}C.prototype.write=function(t,e,r){var n=this._writableState,i=!1;return typeof e=="function"&&(r=e,e=null),u.isBuffer(t)?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=ri),n.ended?ii(this,r):oi(this,n,t,r)&&(n.pendingcb++,i=fi(this,n,t,e,r)),i};C.prototype.cork=function(){var t=this._writableState;t.corked++};C.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.finished&&!t.bufferProcessing&&t.bufferedRequest&&Zt(this,t))};C.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function si(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=u.from(e,r)),e}function fi(t,e,r,n,i){r=si(e,r,n),u.isBuffer(r)&&(n="buffer");var o=e.objectMode?1:r.length;e.length+=o;var s=e.length<e.highWaterMark;if(s||(e.needDrain=!0),e.writing||e.corked){var f=e.lastBufferedRequest;e.lastBufferedRequest=new ni(r,n,i),f?f.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else We(t,e,!1,o,r,n,i);return s}function We(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function ai(t,e,r,n,i){--e.pendingcb,r?M(i,n):i(n),t._writableState.errorEmitted=!0,t.emit("error",n)}function ui(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function li(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(ui(r),e)ai(t,r,n,e,i);else{var o=Xt(r);!o&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&Zt(t,r),n?M(lt,t,r,o,i):lt(t,r,o,i)}}function lt(t,e,r,n){r||ci(t,e),e.pendingcb--,n(),Kt(t,e)}function ci(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function Zt(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),o=e.corkedRequestsFree;o.entry=r;for(var s=0;r;)i[s]=r,r=r.next,s+=1;We(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new er(e)}else{for(;r;){var f=r.chunk,a=r.encoding,l=r.callback,h=e.objectMode?1:f.length;if(We(t,e,!1,h,f,a,l),r=r.next,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequestCount=0,e.bufferedRequest=r,e.bufferProcessing=!1}C.prototype._write=function(t,e,r){r(new Error("not implemented"))};C.prototype._writev=null;C.prototype.end=function(t,e,r){var n=this._writableState;typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),!n.ending&&!n.finished&&hi(this,n,r)};function Xt(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function ct(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function Kt(t,e){var r=Xt(e);return r&&(e.pendingcb===0?(ct(t,e),e.finished=!0,t.emit("finish")):ct(t,e)),r}function hi(t,e,r){e.ending=!0,Kt(t,e),r&&(e.finished?M(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function er(t){var e=this;this.next=null,this.entry=null,this.finish=function(r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}}re(B,R);var ht=Object.keys(C.prototype);for(var $e=0;$e<ht.length;$e++){var Pe=ht[$e];B.prototype[Pe]||(B.prototype[Pe]=C.prototype[Pe])}function B(t){if(!(this instanceof B))return new B(t);R.call(this,t),C.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",di)}function di(){this.allowHalfOpen||this._writableState.ended||M(pi,this)}function pi(t){t.end()}re(U,B);function mi(t){this.afterTransform=function(e,r){return gi(t,e,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function gi(t,e,r){var n=t._transformState;n.transforming=!1;var i=n.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,r!=null&&t.push(r),i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}function U(t){if(!(this instanceof U))return new U(t);B.call(this,t),this._transformState=new mi(this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(r){dt(e,r)}):dt(e)})}U.prototype.push=function(t,e){return this._transformState.needTransform=!1,B.prototype.push.call(this,t,e)};U.prototype._transform=function(t,e,r){throw new Error("Not implemented")};U.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};U.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};function dt(t,e){if(e)return t.emit("error",e);var r=t._writableState,n=t._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}re(ce,U);function ce(t){if(!(this instanceof ce))return new ce(t);U.call(this,t)}ce.prototype._transform=function(t,e,r){r(null,t)};re(D,_);D.Readable=R;D.Writable=C;D.Duplex=B;D.Transform=U;D.PassThrough=ce;D.Stream=D;function D(){_.call(this)}D.prototype.pipe=function(t,e){var r=this;function n(h){t.writable&&t.write(h)===!1&&r.pause&&r.pause()}r.on("data",n);function i(){r.readable&&r.resume&&r.resume()}t.on("drain",i),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",s),r.on("close",f));var o=!1;function s(){o||(o=!0,t.end())}function f(){o||(o=!0,typeof t.destroy=="function"&&t.destroy())}function a(h){if(l(),_.listenerCount(this,"error")===0)throw h}r.on("error",a),t.on("error",a);function l(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",s),r.removeListener("close",f),r.removeListener("error",a),t.removeListener("error",a),r.removeListener("end",l),r.removeListener("close",l),t.removeListener("close",l)}return r.on("end",l),r.on("close",l),t.on("close",l),t.emit("pipe",r),t};const _i=t=>({start_time:t.duration?Date.now():null,fixed_size_buffer:"",count_written:0,count_created:0}),_e=function(t={}){return t.seed?t.seed=t.seed*Math.PI*100%100/100:Math.random()},pt={ascii:function({options:t}){const e=[],r=Math.ceil(_e(t)*t.maxWordLength);for(let n=0;n<r;n++){const i=Math.floor(_e(t)*32);e.push(String.fromCharCode(i+(i<16?65:97-16)))}return e.join("")},int:function({options:t}){return Math.floor(_e(t)*Math.pow(2,52))},bool:function({options:t}){return Math.floor(_e(t)*2)}},wi=function(t){return t.replace(/_([a-z])/gi,function(e,r){return r.toUpperCase()})},yi=t=>{t.high_water_mark&&(t.highWaterMark=t.high_water_mark),t.object_mode&&(t.objectMode=t.object_mode);const e={};for(const i in t)e[wi(i)]=t[i];const r={columns:8,delimiter:",",duration:null,encoding:null,end:null,eof:!1,fixedSize:!1,length:-1,maxWordLength:16,rowDelimiter:`
`,seed:!1,sleep:0};for(const i in r)e[i]===void 0&&(e[i]=r[i]);e.eof===!0&&(e.eof=e.rowDelimiter),typeof e.columns=="number"&&(e.columns=new Array(e.columns));const n=Object.keys(pt).filter(i=>!["super_","camelize"].includes(i));for(let i=0;i<e.columns.length;i++){const o=e.columns[i]||"ascii";if(typeof o=="string"){if(!n.includes(o))throw Error(`Invalid column type: got "${o}", default values are ${JSON.stringify(n)}`);e.columns[i]=pt[o]}}return e},bi=(t,e,r,n,i)=>{const o=[];let s=e.fixed_size_buffer.length;for(s!==0&&o.push(e.fixed_size_buffer);;){if(e.count_created===t.length||t.end&&Date.now()>t.end||t.duration&&Date.now()>e.start_time+t.duration){if(o.length){if(t.objectMode)for(const l of o)n(l);else n(o.join("")+(t.eof?t.eof:""));e.end=!0}else i();return}let f=[],a;for(const l of t.columns){const h=l({options:t,state:e}),c=typeof h;if(h!==null&&c!=="string"&&c!=="number")return Error(["INVALID_VALUE:","values returned by column function must be","a string, a number or null,",`got ${JSON.stringify(h)}`].join(" "));f.push(h)}if(t.objectMode){a=0;for(const l of f)a+=l.length}else f=(e.count_created===0?"":t.rowDelimiter)+f.join(t.delimiter),a=f.length;if(e.count_created++,s+a>r){if(t.objectMode){o.push(f);for(const l of o)n(l)}else t.fixedSize?(e.fixed_size_buffer=f.substr(r-s),o.push(f.substr(0,r-s))):o.push(f),n(o.join(""));return}s+=a,o.push(f)}},Me=function(t={}){return this.options=yi(t),D.Readable.call(this,this.options),this.state=_i(this.options),this};Yt.inherits(Me,D.Readable);Me.prototype.end=function(){this.push(null)};Me.prototype._read=function(t){const e=this,r=bi(this.options,this.state,t,function(n){e.__push(n)},function(){e.push(null)});r&&this.destroy(r)};Me.prototype.__push=function(t){const e=()=>{if(this.state.count_written++,this.push(t),this.state.end===!0)return this.push(null)};this.options.sleep>0?setTimeout(e,this.options.sleep):e()};const tr=function(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)};class v extends Error{constructor(e,r,n,...i){Array.isArray(r)&&(r=r.join(" ")),super(r),Error.captureStackTrace!==void 0&&Error.captureStackTrace(this,v),this.code=e;for(const o of i)for(const s in o){const f=o[s];this[s]=O(f)?f.toString(n.encoding):f==null?f:JSON.parse(JSON.stringify(f))}}}const rr=function(t){const e=[];for(let r=0,n=t.length;r<n;r++){const i=t[r];if(i==null||i===!1)e[r]={disabled:!0};else if(typeof i=="string")e[r]={name:i};else if(tr(i)){if(typeof i.name!="string")throw new v("CSV_OPTION_COLUMNS_MISSING_NAME",["Option columns missing name:",`property "name" is required at position ${r}`,"when column is an object literal"]);e[r]=i}else throw new v("CSV_INVALID_COLUMN_DEFINITION",["Invalid column definition:","expect a string or a literal object,",`got ${JSON.stringify(i)} at position ${r}`])}return e};class mt{constructor(e=100){this.size=e,this.length=0,this.buf=u.allocUnsafe(e)}prepend(e){if(O(e)){const r=this.length+e.length;if(r>=this.size&&(this.resize(),r>=this.size))throw Error("INVALID_BUFFER_STATE");const n=this.buf;this.buf=u.allocUnsafe(this.size),e.copy(this.buf,0),n.copy(this.buf,e.length),this.length+=e.length}else{const r=this.length++;r===this.size&&this.resize();const n=this.clone();this.buf[0]=e,n.copy(this.buf,1,0,r)}}append(e){const r=this.length++;r===this.size&&this.resize(),this.buf[r]=e}clone(){return u.from(this.buf.slice(0,this.length))}resize(){const e=this.length;this.size=this.size*2;const r=u.allocUnsafe(this.size);this.buf.copy(r,0,0,e),this.buf=r}toString(e){return e?this.buf.slice(0,this.length).toString(e):Uint8Array.prototype.slice.call(this.buf.slice(0,this.length))}toJSON(){return this.toString("utf8")}reset(){this.length=0}}const vi=12,Ei=13,xi=10,Si=32,Ii=9,Ri=function(t){return{bomSkipped:!1,bufBytesStart:0,castField:t.cast_function,commenting:!1,error:void 0,enabled:t.from_line===1,escaping:!1,escapeIsQuote:O(t.escape)&&O(t.quote)&&u.compare(t.escape,t.quote)===0,expectedRecordLength:Array.isArray(t.columns)?t.columns.length:void 0,field:new mt(20),firstLineToHeaders:t.cast_first_line_to_header,needMoreDataSize:Math.max(t.comment!==null?t.comment.length:0,...t.delimiter.map(e=>e.length),t.quote!==null?t.quote.length:0),previousBuf:void 0,quoting:!1,stop:!1,rawBuffer:new mt(100),record:[],recordHasError:!1,record_length:0,recordDelimiterMaxLength:t.record_delimiter.length===0?0:Math.max(...t.record_delimiter.map(e=>e.length)),trimChars:[u.from(" ",t.encoding)[0],u.from("	",t.encoding)[0]],wasQuoting:!1,wasRowDelimiter:!1,timchars:[u.from(u.from([Ei],"utf8").toString(),t.encoding),u.from(u.from([xi],"utf8").toString(),t.encoding),u.from(u.from([vi],"utf8").toString(),t.encoding),u.from(u.from([Si],"utf8").toString(),t.encoding),u.from(u.from([Ii],"utf8").toString(),t.encoding)]}},Oi=function(t){return t.replace(/([A-Z])/g,function(e,r){return"_"+r.toLowerCase()})},gt=function(t){const e={};for(const n in t)e[Oi(n)]=t[n];if(e.encoding===void 0||e.encoding===!0)e.encoding="utf8";else if(e.encoding===null||e.encoding===!1)e.encoding=null;else if(typeof e.encoding!="string"&&e.encoding!==null)throw new v("CSV_INVALID_OPTION_ENCODING",["Invalid option encoding:","encoding must be a string or null to return a buffer,",`got ${JSON.stringify(e.encoding)}`],e);if(e.bom===void 0||e.bom===null||e.bom===!1)e.bom=!1;else if(e.bom!==!0)throw new v("CSV_INVALID_OPTION_BOM",["Invalid option bom:","bom must be true,",`got ${JSON.stringify(e.bom)}`],e);if(e.cast_function=null,e.cast===void 0||e.cast===null||e.cast===!1||e.cast==="")e.cast=void 0;else if(typeof e.cast=="function")e.cast_function=e.cast,e.cast=!0;else if(e.cast!==!0)throw new v("CSV_INVALID_OPTION_CAST",["Invalid option cast:","cast must be true or a function,",`got ${JSON.stringify(e.cast)}`],e);if(e.cast_date===void 0||e.cast_date===null||e.cast_date===!1||e.cast_date==="")e.cast_date=!1;else if(e.cast_date===!0)e.cast_date=function(n){const i=Date.parse(n);return isNaN(i)?n:new Date(i)};else if(typeof e.cast_date!="function")throw new v("CSV_INVALID_OPTION_CAST_DATE",["Invalid option cast_date:","cast_date must be true or a function,",`got ${JSON.stringify(e.cast_date)}`],e);if(e.cast_first_line_to_header=null,e.columns===!0)e.cast_first_line_to_header=void 0;else if(typeof e.columns=="function")e.cast_first_line_to_header=e.columns,e.columns=!0;else if(Array.isArray(e.columns))e.columns=rr(e.columns);else if(e.columns===void 0||e.columns===null||e.columns===!1)e.columns=!1;else throw new v("CSV_INVALID_OPTION_COLUMNS",["Invalid option columns:","expect an array, a function or true,",`got ${JSON.stringify(e.columns)}`],e);if(e.group_columns_by_name===void 0||e.group_columns_by_name===null||e.group_columns_by_name===!1)e.group_columns_by_name=!1;else{if(e.group_columns_by_name!==!0)throw new v("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","expect an boolean,",`got ${JSON.stringify(e.group_columns_by_name)}`],e);if(e.columns===!1)throw new v("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","the `columns` mode must be activated."],e)}if(e.comment===void 0||e.comment===null||e.comment===!1||e.comment==="")e.comment=null;else if(typeof e.comment=="string"&&(e.comment=u.from(e.comment,e.encoding)),!O(e.comment))throw new v("CSV_INVALID_OPTION_COMMENT",["Invalid option comment:","comment must be a buffer or a string,",`got ${JSON.stringify(e.comment)}`],e);const r=JSON.stringify(e.delimiter);if(Array.isArray(e.delimiter)||(e.delimiter=[e.delimiter]),e.delimiter.length===0)throw new v("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${r}`],e);if(e.delimiter=e.delimiter.map(function(n){if(n==null||n===!1)return u.from(",",e.encoding);if(typeof n=="string"&&(n=u.from(n,e.encoding)),!O(n)||n.length===0)throw new v("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${r}`],e);return n}),e.escape===void 0||e.escape===!0?e.escape=u.from('"',e.encoding):typeof e.escape=="string"?e.escape=u.from(e.escape,e.encoding):(e.escape===null||e.escape===!1)&&(e.escape=null),e.escape!==null&&!O(e.escape))throw new Error(`Invalid Option: escape must be a buffer, a string or a boolean, got ${JSON.stringify(e.escape)}`);if(e.from===void 0||e.from===null)e.from=1;else if(typeof e.from=="string"&&/\d+/.test(e.from)&&(e.from=parseInt(e.from)),Number.isInteger(e.from)){if(e.from<0)throw new Error(`Invalid Option: from must be a positive integer, got ${JSON.stringify(t.from)}`)}else throw new Error(`Invalid Option: from must be an integer, got ${JSON.stringify(e.from)}`);if(e.from_line===void 0||e.from_line===null)e.from_line=1;else if(typeof e.from_line=="string"&&/\d+/.test(e.from_line)&&(e.from_line=parseInt(e.from_line)),Number.isInteger(e.from_line)){if(e.from_line<=0)throw new Error(`Invalid Option: from_line must be a positive integer greater than 0, got ${JSON.stringify(t.from_line)}`)}else throw new Error(`Invalid Option: from_line must be an integer, got ${JSON.stringify(t.from_line)}`);if(e.ignore_last_delimiters===void 0||e.ignore_last_delimiters===null)e.ignore_last_delimiters=!1;else if(typeof e.ignore_last_delimiters=="number")e.ignore_last_delimiters=Math.floor(e.ignore_last_delimiters),e.ignore_last_delimiters===0&&(e.ignore_last_delimiters=!1);else if(typeof e.ignore_last_delimiters!="boolean")throw new v("CSV_INVALID_OPTION_IGNORE_LAST_DELIMITERS",["Invalid option `ignore_last_delimiters`:","the value must be a boolean value or an integer,",`got ${JSON.stringify(e.ignore_last_delimiters)}`],e);if(e.ignore_last_delimiters===!0&&e.columns===!1)throw new v("CSV_IGNORE_LAST_DELIMITERS_REQUIRES_COLUMNS",["The option `ignore_last_delimiters`","requires the activation of the `columns` option"],e);if(e.info===void 0||e.info===null||e.info===!1)e.info=!1;else if(e.info!==!0)throw new Error(`Invalid Option: info must be true, got ${JSON.stringify(e.info)}`);if(e.max_record_size===void 0||e.max_record_size===null||e.max_record_size===!1)e.max_record_size=0;else if(!(Number.isInteger(e.max_record_size)&&e.max_record_size>=0))if(typeof e.max_record_size=="string"&&/\d+/.test(e.max_record_size))e.max_record_size=parseInt(e.max_record_size);else throw new Error(`Invalid Option: max_record_size must be a positive integer, got ${JSON.stringify(e.max_record_size)}`);if(e.objname===void 0||e.objname===null||e.objname===!1)e.objname=void 0;else if(O(e.objname)){if(e.objname.length===0)throw new Error("Invalid Option: objname must be a non empty buffer");e.encoding===null||(e.objname=e.objname.toString(e.encoding))}else if(typeof e.objname=="string"){if(e.objname.length===0)throw new Error("Invalid Option: objname must be a non empty string")}else if(typeof e.objname!="number")throw new Error(`Invalid Option: objname must be a string or a buffer, got ${e.objname}`);if(e.objname!==void 0){if(typeof e.objname=="number"){if(e.columns!==!1)throw Error("Invalid Option: objname index cannot be combined with columns or be defined as a field")}else if(e.columns===!1)throw Error("Invalid Option: objname field must be combined with columns or be defined as an index")}if(e.on_record===void 0||e.on_record===null)e.on_record=void 0;else if(typeof e.on_record!="function")throw new v("CSV_INVALID_OPTION_ON_RECORD",["Invalid option `on_record`:","expect a function,",`got ${JSON.stringify(e.on_record)}`],e);if(e.quote===null||e.quote===!1||e.quote==="")e.quote=null;else if(e.quote===void 0||e.quote===!0?e.quote=u.from('"',e.encoding):typeof e.quote=="string"&&(e.quote=u.from(e.quote,e.encoding)),!O(e.quote))throw new Error(`Invalid Option: quote must be a buffer or a string, got ${JSON.stringify(e.quote)}`);if(e.raw===void 0||e.raw===null||e.raw===!1)e.raw=!1;else if(e.raw!==!0)throw new Error(`Invalid Option: raw must be true, got ${JSON.stringify(e.raw)}`);if(e.record_delimiter===void 0)e.record_delimiter=[];else if(typeof e.record_delimiter=="string"||O(e.record_delimiter)){if(e.record_delimiter.length===0)throw new v("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer,",`got ${JSON.stringify(e.record_delimiter)}`],e);e.record_delimiter=[e.record_delimiter]}else if(!Array.isArray(e.record_delimiter))throw new v("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer,",`got ${JSON.stringify(e.record_delimiter)}`],e);if(e.record_delimiter=e.record_delimiter.map(function(n,i){if(typeof n!="string"&&!O(n))throw new v("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer",`at index ${i},`,`got ${JSON.stringify(n)}`],e);if(n.length===0)throw new v("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer",`at index ${i},`,`got ${JSON.stringify(n)}`],e);return typeof n=="string"&&(n=u.from(n,e.encoding)),n}),typeof e.relax_column_count!="boolean")if(e.relax_column_count===void 0||e.relax_column_count===null)e.relax_column_count=!1;else throw new Error(`Invalid Option: relax_column_count must be a boolean, got ${JSON.stringify(e.relax_column_count)}`);if(typeof e.relax_column_count_less!="boolean")if(e.relax_column_count_less===void 0||e.relax_column_count_less===null)e.relax_column_count_less=!1;else throw new Error(`Invalid Option: relax_column_count_less must be a boolean, got ${JSON.stringify(e.relax_column_count_less)}`);if(typeof e.relax_column_count_more!="boolean")if(e.relax_column_count_more===void 0||e.relax_column_count_more===null)e.relax_column_count_more=!1;else throw new Error(`Invalid Option: relax_column_count_more must be a boolean, got ${JSON.stringify(e.relax_column_count_more)}`);if(typeof e.relax_quotes!="boolean")if(e.relax_quotes===void 0||e.relax_quotes===null)e.relax_quotes=!1;else throw new Error(`Invalid Option: relax_quotes must be a boolean, got ${JSON.stringify(e.relax_quotes)}`);if(typeof e.skip_empty_lines!="boolean")if(e.skip_empty_lines===void 0||e.skip_empty_lines===null)e.skip_empty_lines=!1;else throw new Error(`Invalid Option: skip_empty_lines must be a boolean, got ${JSON.stringify(e.skip_empty_lines)}`);if(typeof e.skip_records_with_empty_values!="boolean")if(e.skip_records_with_empty_values===void 0||e.skip_records_with_empty_values===null)e.skip_records_with_empty_values=!1;else throw new Error(`Invalid Option: skip_records_with_empty_values must be a boolean, got ${JSON.stringify(e.skip_records_with_empty_values)}`);if(typeof e.skip_records_with_error!="boolean")if(e.skip_records_with_error===void 0||e.skip_records_with_error===null)e.skip_records_with_error=!1;else throw new Error(`Invalid Option: skip_records_with_error must be a boolean, got ${JSON.stringify(e.skip_records_with_error)}`);if(e.rtrim===void 0||e.rtrim===null||e.rtrim===!1)e.rtrim=!1;else if(e.rtrim!==!0)throw new Error(`Invalid Option: rtrim must be a boolean, got ${JSON.stringify(e.rtrim)}`);if(e.ltrim===void 0||e.ltrim===null||e.ltrim===!1)e.ltrim=!1;else if(e.ltrim!==!0)throw new Error(`Invalid Option: ltrim must be a boolean, got ${JSON.stringify(e.ltrim)}`);if(e.trim===void 0||e.trim===null||e.trim===!1)e.trim=!1;else if(e.trim!==!0)throw new Error(`Invalid Option: trim must be a boolean, got ${JSON.stringify(e.trim)}`);if(e.trim===!0&&t.ltrim!==!1?e.ltrim=!0:e.ltrim!==!0&&(e.ltrim=!1),e.trim===!0&&t.rtrim!==!1?e.rtrim=!0:e.rtrim!==!0&&(e.rtrim=!1),e.to===void 0||e.to===null)e.to=-1;else if(typeof e.to=="string"&&/\d+/.test(e.to)&&(e.to=parseInt(e.to)),Number.isInteger(e.to)){if(e.to<=0)throw new Error(`Invalid Option: to must be a positive integer greater than 0, got ${JSON.stringify(t.to)}`)}else throw new Error(`Invalid Option: to must be an integer, got ${JSON.stringify(t.to)}`);if(e.to_line===void 0||e.to_line===null)e.to_line=-1;else if(typeof e.to_line=="string"&&/\d+/.test(e.to_line)&&(e.to_line=parseInt(e.to_line)),Number.isInteger(e.to_line)){if(e.to_line<=0)throw new Error(`Invalid Option: to_line must be a positive integer greater than 0, got ${JSON.stringify(t.to_line)}`)}else throw new Error(`Invalid Option: to_line must be an integer, got ${JSON.stringify(t.to_line)}`);return e},_t=function(t){return t.every(e=>e==null||e.toString&&e.toString().trim()==="")},Ai=13,Ci=10,we={utf8:u.from([239,187,191]),utf16le:u.from([255,254])},Ni=function(t={}){const e={bytes:0,comment_lines:0,empty_lines:0,invalid_field_length:0,lines:1,records:0},r=gt(t);return{info:e,original_options:t,options:r,state:Ri(r),__needMoreData:function(n,i,o){if(o)return!1;const{encoding:s,escape:f,quote:a}=this.options,{quoting:l,needMoreDataSize:h,recordDelimiterMaxLength:c}=this.state,w=i-n-1,y=Math.max(h,c===0?u.from(`\r
`,s).length:c,l?(f===null?0:f.length)+a.length:0,l?a.length+c:0);return w<y},parse:function(n,i,o,s){const{bom:f,from_line:a,ltrim:l,max_record_size:h,raw:c,relax_quotes:w,rtrim:y,skip_empty_lines:I,to:g,to_line:N}=this.options;let{comment:E,escape:m,quote:p,record_delimiter:q}=this.options;const{bomSkipped:V,previousBuf:Y,rawBuffer:X,escapeIsQuote:Be}=this.state;let b;if(Y===void 0)if(n===void 0){s();return}else b=n;else Y!==void 0&&n===void 0?b=Y:b=u.concat([Y,n]);if(V===!1)if(f===!1)this.state.bomSkipped=!0;else if(b.length<3){if(i===!1){this.state.previousBuf=b;return}}else{for(const S in we)if(we[S].compare(b,0,we[S].length)===0){const Q=we[S].length;this.state.bufBytesStart+=Q,b=b.slice(Q),this.options=gt({...this.original_options,encoding:S}),{comment:E,escape:m,quote:p}=this.options;break}this.state.bomSkipped=!0}const W=b.length;let d;for(d=0;d<W&&!this.__needMoreData(d,W,i);d++){if(this.state.wasRowDelimiter===!0&&(this.info.lines++,this.state.wasRowDelimiter=!1),N!==-1&&this.info.lines>N){this.state.stop=!0,s();return}this.state.quoting===!1&&q.length===0&&this.__autoDiscoverRecordDelimiter(b,d)&&(q=this.options.record_delimiter);const S=b[d];if(c===!0&&X.append(S),(S===Ai||S===Ci)&&this.state.wasRowDelimiter===!1&&(this.state.wasRowDelimiter=!0),this.state.escaping===!0)this.state.escaping=!1;else{if(m!==null&&this.state.quoting===!0&&this.__isEscape(b,d,S)&&d+m.length<W)if(Be){if(this.__isQuote(b,d+m.length)){this.state.escaping=!0,d+=m.length-1;continue}}else{this.state.escaping=!0,d+=m.length-1;continue}if(this.state.commenting===!1&&this.__isQuote(b,d))if(this.state.quoting===!0){const T=b[d+p.length],nt=y&&this.__isCharTrimable(b,d+p.length),pe=E!==null&&this.__compareBytes(E,b,d+p.length,T),ue=this.__isDelimiter(b,d+p.length,T),me=q.length===0?this.__autoDiscoverRecordDelimiter(b,d+p.length):this.__isRecordDelimiter(T,b,d+p.length);if(m!==null&&this.__isEscape(b,d,S)&&this.__isQuote(b,d+m.length))d+=m.length-1;else if(!T||ue||me||pe||nt){this.state.quoting=!1,this.state.wasQuoting=!0,d+=p.length-1;continue}else if(w===!1){const le=this.__error(new v("CSV_INVALID_CLOSING_QUOTE",["Invalid Closing Quote:",`got "${String.fromCharCode(T)}"`,`at line ${this.info.lines}`,"instead of delimiter, record delimiter, trimable character","(if activated) or comment"],this.options,this.__infoField()));if(le!==void 0)return le}else this.state.quoting=!1,this.state.wasQuoting=!0,this.state.field.prepend(p),d+=p.length-1}else if(this.state.field.length!==0){if(w===!1){const T=this.__error(new v("INVALID_OPENING_QUOTE",["Invalid Opening Quote:",`a quote is found inside a field at line ${this.info.lines}`],this.options,this.__infoField(),{field:this.state.field}));if(T!==void 0)return T}}else{this.state.quoting=!0,d+=p.length-1;continue}if(this.state.quoting===!1){const T=this.__isRecordDelimiter(S,b,d);if(T!==0){if(this.state.commenting&&this.state.wasQuoting===!1&&this.state.record.length===0&&this.state.field.length===0)this.info.comment_lines++;else{if(this.state.enabled===!1&&this.info.lines+(this.state.wasRowDelimiter===!0?1:0)>=a){this.state.enabled=!0,this.__resetField(),this.__resetRecord(),d+=T-1;continue}if(I===!0&&this.state.wasQuoting===!1&&this.state.record.length===0&&this.state.field.length===0){this.info.empty_lines++,d+=T-1;continue}this.info.bytes=this.state.bufBytesStart+d;const me=this.__onField();if(me!==void 0)return me;this.info.bytes=this.state.bufBytesStart+d+T;const le=this.__onRecord(o);if(le!==void 0)return le;if(g!==-1&&this.info.records>=g){this.state.stop=!0,s();return}}this.state.commenting=!1,d+=T-1;continue}if(this.state.commenting)continue;if((E===null?0:this.__compareBytes(E,b,d,S))!==0){this.state.commenting=!0;continue}const pe=this.__isDelimiter(b,d,S);if(pe!==0){this.info.bytes=this.state.bufBytesStart+d;const ue=this.__onField();if(ue!==void 0)return ue;d+=pe-1;continue}}}if(this.state.commenting===!1&&h!==0&&this.state.record_length+this.state.field.length>h)return this.__error(new v("CSV_MAX_RECORD_SIZE",["Max Record Size:","record exceed the maximum number of tolerated bytes",`of ${h}`,`at line ${this.info.lines}`],this.options,this.__infoField()));const Q=l===!1||this.state.quoting===!0||this.state.field.length!==0||!this.__isCharTrimable(b,d),fr=y===!1||this.state.wasQuoting===!1;if(Q===!0&&fr===!0)this.state.field.append(S);else{if(y===!0&&!this.__isCharTrimable(b,d))return this.__error(new v("CSV_NON_TRIMABLE_CHAR_AFTER_CLOSING_QUOTE",["Invalid Closing Quote:","found non trimable byte after quote",`at line ${this.info.lines}`],this.options,this.__infoField()));Q===!1&&(d+=this.__isCharTrimable(b,d)-1);continue}}if(i===!0)if(this.state.quoting===!0){const S=this.__error(new v("CSV_QUOTE_NOT_CLOSED",["Quote Not Closed:",`the parsing is finished with an opening quote at line ${this.info.lines}`],this.options,this.__infoField()));if(S!==void 0)return S}else if(this.state.wasQuoting===!0||this.state.record.length!==0||this.state.field.length!==0){this.info.bytes=this.state.bufBytesStart+d;const S=this.__onField();if(S!==void 0)return S;const Q=this.__onRecord(o);if(Q!==void 0)return Q}else this.state.wasRowDelimiter===!0?this.info.empty_lines++:this.state.commenting===!0&&this.info.comment_lines++;else this.state.bufBytesStart+=d,this.state.previousBuf=b.slice(d);this.state.wasRowDelimiter===!0&&(this.info.lines++,this.state.wasRowDelimiter=!1)},__onRecord:function(n){const{columns:i,group_columns_by_name:o,encoding:s,info:f,from:a,relax_column_count:l,relax_column_count_less:h,relax_column_count_more:c,raw:w,skip_records_with_empty_values:y}=this.options,{enabled:I,record:g}=this.state;if(I===!1)return this.__resetRecord();const N=g.length;if(i===!0){if(y===!0&&_t(g)){this.__resetRecord();return}return this.__firstLineToColumns(g)}if(i===!1&&this.info.records===0&&(this.state.expectedRecordLength=N),N!==this.state.expectedRecordLength){const E=i===!1?new v("CSV_RECORD_INCONSISTENT_FIELDS_LENGTH",["Invalid Record Length:",`expect ${this.state.expectedRecordLength},`,`got ${N} on line ${this.info.lines}`],this.options,this.__infoField(),{record:g}):new v("CSV_RECORD_INCONSISTENT_COLUMNS",["Invalid Record Length:",`columns length is ${i.length},`,`got ${N} on line ${this.info.lines}`],this.options,this.__infoField(),{record:g});if(l===!0||h===!0&&N<this.state.expectedRecordLength||c===!0&&N>this.state.expectedRecordLength)this.info.invalid_field_length++,this.state.error=E;else{const m=this.__error(E);if(m)return m}}if(y===!0&&_t(g)){this.__resetRecord();return}if(this.state.recordHasError===!0){this.__resetRecord(),this.state.recordHasError=!1;return}if(this.info.records++,a===1||this.info.records>=a){const{objname:E}=this.options;if(i!==!1){const m={};for(let p=0,q=g.length;p<q;p++)i[p]===void 0||i[p].disabled||(o===!0&&m[i[p].name]!==void 0?Array.isArray(m[i[p].name])?m[i[p].name]=m[i[p].name].concat(g[p]):m[i[p].name]=[m[i[p].name],g[p]]:m[i[p].name]=g[p]);if(w===!0||f===!0){const p=Object.assign({record:m},w===!0?{raw:this.state.rawBuffer.toString(s)}:{},f===!0?{info:this.__infoRecord()}:{}),q=this.__push(E===void 0?p:[m[E],p],n);if(q)return q}else{const p=this.__push(E===void 0?m:[m[E],m],n);if(p)return p}}else if(w===!0||f===!0){const m=Object.assign({record:g},w===!0?{raw:this.state.rawBuffer.toString(s)}:{},f===!0?{info:this.__infoRecord()}:{}),p=this.__push(E===void 0?m:[g[E],m],n);if(p)return p}else{const m=this.__push(E===void 0?g:[g[E],g],n);if(m)return m}}this.__resetRecord()},__firstLineToColumns:function(n){const{firstLineToHeaders:i}=this.state;try{const o=i===void 0?n:i.call(null,n);if(!Array.isArray(o))return this.__error(new v("CSV_INVALID_COLUMN_MAPPING",["Invalid Column Mapping:","expect an array from column function,",`got ${JSON.stringify(o)}`],this.options,this.__infoField(),{headers:o}));const s=rr(o);this.state.expectedRecordLength=s.length,this.options.columns=s,this.__resetRecord();return}catch(o){return o}},__resetRecord:function(){this.options.raw===!0&&this.state.rawBuffer.reset(),this.state.error=void 0,this.state.record=[],this.state.record_length=0},__onField:function(){const{cast:n,encoding:i,rtrim:o,max_record_size:s}=this.options,{enabled:f,wasQuoting:a}=this.state;if(f===!1)return this.__resetField();let l=this.state.field.toString(i);if(o===!0&&a===!1&&(l=l.trimRight()),n===!0){const[h,c]=this.__cast(l);if(h!==void 0)return h;l=c}this.state.record.push(l),s!==0&&typeof l=="string"&&(this.state.record_length+=l.length),this.__resetField()},__resetField:function(){this.state.field.reset(),this.state.wasQuoting=!1},__push:function(n,i){const{on_record:o}=this.options;if(o!==void 0){const s=this.__infoRecord();try{n=o.call(null,n,s)}catch(f){return f}if(n==null)return}i(n)},__cast:function(n){const{columns:i,relax_column_count:o}=this.options;if(Array.isArray(i)===!0&&o&&this.options.columns.length<=this.state.record.length)return[void 0,void 0];if(this.state.castField!==null)try{const f=this.__infoField();return[void 0,this.state.castField.call(null,n,f)]}catch(f){return[f]}if(this.__isFloat(n))return[void 0,parseFloat(n)];if(this.options.cast_date!==!1){const f=this.__infoField();return[void 0,this.options.cast_date.call(null,n,f)]}return[void 0,n]},__isCharTrimable:function(n,i){return((s,f)=>{const{timchars:a}=this.state;e:for(let l=0;l<a.length;l++){const h=a[l];for(let c=0;c<h.length;c++)if(h[c]!==s[f+c])continue e;return h.length}return 0})(n,i)},__isFloat:function(n){return n-parseFloat(n)+1>=0},__compareBytes:function(n,i,o,s){if(n[0]!==s)return 0;const f=n.length;for(let a=1;a<f;a++)if(n[a]!==i[o+a])return 0;return f},__isDelimiter:function(n,i,o){const{delimiter:s,ignore_last_delimiters:f}=this.options;if(f===!0&&this.state.record.length===this.options.columns.length-1)return 0;if(f!==!1&&typeof f=="number"&&this.state.record.length===f-1)return 0;e:for(let a=0;a<s.length;a++){const l=s[a];if(l[0]===o){for(let h=1;h<l.length;h++)if(l[h]!==n[i+h])continue e;return l.length}}return 0},__isRecordDelimiter:function(n,i,o){const{record_delimiter:s}=this.options,f=s.length;e:for(let a=0;a<f;a++){const l=s[a],h=l.length;if(l[0]===n){for(let c=1;c<h;c++)if(l[c]!==i[o+c])continue e;return l.length}}return 0},__isEscape:function(n,i,o){const{escape:s}=this.options;if(s===null)return!1;const f=s.length;if(s[0]===o){for(let a=0;a<f;a++)if(s[a]!==n[i+a])return!1;return!0}return!1},__isQuote:function(n,i){const{quote:o}=this.options;if(o===null)return!1;const s=o.length;for(let f=0;f<s;f++)if(o[f]!==n[i+f])return!1;return!0},__autoDiscoverRecordDelimiter:function(n,i){const{encoding:o}=this.options,s=[u.from(`\r
`,o),u.from(`
`,o),u.from("\r",o)];e:for(let f=0;f<s.length;f++){const a=s[f].length;for(let l=0;l<a;l++)if(s[f][l]!==n[i+l])continue e;return this.options.record_delimiter.push(s[f]),this.state.recordDelimiterMaxLength=s[f].length,s[f].length}return 0},__error:function(n){const{encoding:i,raw:o,skip_records_with_error:s}=this.options,f=typeof n=="string"?new Error(n):n;if(s){this.state.recordHasError=!0,this.options.on_skip!==void 0&&this.options.on_skip(f,o?this.state.rawBuffer.toString(i):void 0);return}else return f},__infoDataSet:function(){return{...this.info,columns:this.options.columns}},__infoRecord:function(){const{columns:n,raw:i,encoding:o}=this.options;return{...this.__infoDataSet(),error:this.state.error,header:n===!0,index:this.state.record.length,raw:i?this.state.rawBuffer.toString(o):void 0}},__infoField:function(){const{columns:n}=this.options,i=Array.isArray(n);return{...this.__infoRecord(),column:i===!0?n.length>this.state.record.length?n[this.state.record.length].name:null:this.state.record.length,quoting:this.state.wasQuoting}}}};class Ti extends U{constructor(e={}){super({readableObjectMode:!0,...e,encoding:null}),this.api=Ni(e),this.api.options.on_skip=(r,n)=>{this.emit("skip",r,n)},this.state=this.api.state,this.options=this.api.options,this.info=this.api.info}_transform(e,r,n){if(this.state.stop===!0)return;const i=this.api.parse(e,!1,o=>{this.push.call(this,o)},()=>{this.push.call(this,null)});i!==void 0&&(this.state.stop=!0),n(i)}_flush(e){if(this.state.stop===!0)return;const r=this.api.parse(void 0,!0,n=>{this.push.call(this,n)},()=>{this.push.call(this,null)});e(r)}}const Wi=function(){let t,e,r;for(const i in arguments){const o=arguments[i],s=typeof o;if(t===void 0&&(typeof o=="string"||O(o)))t=o;else if(e===void 0&&tr(o))e=o;else if(r===void 0&&s==="function")r=o;else throw new v("CSV_INVALID_ARGUMENT",["Invalid argument:",`got ${JSON.stringify(o)} at index ${i}`],e||{})}const n=new Ti(e);if(r){const i=e===void 0||e.objname===void 0?[]:{};n.on("readable",function(){let o;for(;(o=this.read())!==null;)e===void 0||e.objname===void 0?i.push(o):i[o[0]]=o[1]}),n.on("error",function(o){r(o,void 0,n.api.__infoDataSet())}),n.on("end",function(){r(void 0,i,n.api.__infoDataSet())})}if(t!==void 0){const i=function(){n.write(t),n.end()};typeof setImmediate=="function"?setImmediate(i):setTimeout(i,0)}return n},Fe=function(t={},e){return this.options=t,(t.consume===void 0||t.consume===null)&&(this.options.consume=!1),this.options.objectMode=!0,(t.parallel===void 0||t.parallel===null)&&(this.options.parallel=100),(t.params===void 0||t.params===null)&&(t.params=null),this.handler=e,D.Transform.call(this,this.options),this.state={running:0,started:0,finished:0},this};Yt.inherits(Fe,D.Transform);Fe.prototype._transform=function(t,e,r){this.state.started++,this.state.running++,this.state.running<this.options.parallel&&(r(),r=null);try{let n=this.handler.length;if(this.options.params!==null&&n--,n===1)this.__done(null,[this.handler.call(this,t,this.options.params)],r);else if(n===2){const i=(o,...s)=>this.__done(o,s,r);this.handler.call(this,t,i,this.options.params)}else throw Error("Invalid handler arguments");return!1}catch(n){this.__done(n)}};Fe.prototype._flush=function(t){this.state.running===0?t():this._ending=function(){t()}};Fe.prototype.__done=function(t,e,r){if(this.state.running--,t)return this.emit("error",t);this.state.finished++;for(let n of e)typeof n=="number"&&(n=`${n}`),n!=null&&n!==""&&this.push(n);r&&r(),this._ending&&this.state.running===0&&this._ending()};class se extends Error{constructor(e,r,...n){Array.isArray(r)&&(r=r.join(" ")),super(r),Error.captureStackTrace!==void 0&&Error.captureStackTrace(this,se),this.code=e;for(const i of n)for(const o in i){const s=i[o];this[o]=O(s)?s.toString():s==null?s:JSON.parse(JSON.stringify(s))}}}const nr=function(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)},Li=".".charCodeAt(0),Di=/\\(\\)?/g,Mi=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g"),Fi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Bi=/^\w*$/,Ui=function(t){return Object.prototype.toString.call(t)},ir=function(t){const e=typeof t;return e==="symbol"||e==="object"&&t&&Ui(t)==="[object Symbol]"},qi=function(t,e){if(Array.isArray(t))return!1;const r=typeof t;return r==="number"||r==="symbol"||r==="boolean"||!t||ir(t)?!0:Bi.test(t)||!Fi.test(t)||e!=null&&t in Object(e)},ki=function(t){const e=[];return t.charCodeAt(0)===Li&&e.push(""),t.replace(Mi,function(r,n,i,o){let s=r;i?s=o.replace(Di,"$1"):n&&(s=n.trim()),e.push(s)}),e},ji=function(t,e){return Array.isArray(t)?t:qi(t,e)?[t]:ki(t)},$i=function(t){if(typeof t=="string"||ir(t))return t;const e=`${t}`;return e=="0"&&1/t==-INFINITY?"-0":e},Pi=function(t,e){e=ji(e,t);let r=0;const n=e.length;for(;t!=null&&r<n;)t=t[$i(e[r++])];return r&&r===n?t:void 0},or=function(t){if(t==null)return[void 0,void 0];if(typeof t!="object")return[Error('Invalid option "columns": expect an array or an object')];if(Array.isArray(t)){const e=[];for(const r of t)if(typeof r=="string")e.push({key:r,header:r});else if(typeof r=="object"&&r!==null&&!Array.isArray(r)){if(!r.key)return[Error('Invalid column definition: property "key" is required')];r.header===void 0&&(r.header=r.key),e.push(r)}else return[Error("Invalid column definition: expect a string or an object")];t=e}else{const e=[];for(const r in t)e.push({key:r,header:t[r]});t=e}return[void 0,t]},zi=function(t){return t.replace(/([A-Z])/g,function(e,r){return"_"+r.toLowerCase()})},sr=function(t){const e={};for(const i in t)e[zi(i)]=t[i];if(e.bom===void 0||e.bom===null||e.bom===!1)e.bom=!1;else if(e.bom!==!0)return[new se("CSV_OPTION_BOOLEAN_INVALID_TYPE",["option `bom` is optional and must be a boolean value,",`got ${JSON.stringify(e.bom)}`])];if(e.delimiter===void 0||e.delimiter===null)e.delimiter=",";else if(O(e.delimiter))e.delimiter=e.delimiter.toString();else if(typeof e.delimiter!="string")return[new se("CSV_OPTION_DELIMITER_INVALID_TYPE",["option `delimiter` must be a buffer or a string,",`got ${JSON.stringify(e.delimiter)}`])];if(e.quote===void 0||e.quote===null)e.quote='"';else if(e.quote===!0)e.quote='"';else if(e.quote===!1)e.quote="";else if(O(e.quote))e.quote=e.quote.toString();else if(typeof e.quote!="string")return[new se("CSV_OPTION_QUOTE_INVALID_TYPE",["option `quote` must be a boolean, a buffer or a string,",`got ${JSON.stringify(e.quote)}`])];if((e.quoted===void 0||e.quoted===null)&&(e.quoted=!1),(e.quoted_empty===void 0||e.quoted_empty===null)&&(e.quoted_empty=void 0),e.quoted_match===void 0||e.quoted_match===null||e.quoted_match===!1?e.quoted_match=null:Array.isArray(e.quoted_match)||(e.quoted_match=[e.quoted_match]),e.quoted_match)for(const i of e.quoted_match){const o=typeof i=="string",s=i instanceof RegExp;if(!o&&!s)return[Error(`Invalid Option: quoted_match must be a string or a regex, got ${JSON.stringify(i)}`)]}if((e.quoted_string===void 0||e.quoted_string===null)&&(e.quoted_string=!1),(e.eof===void 0||e.eof===null)&&(e.eof=!0),e.escape===void 0||e.escape===null)e.escape='"';else if(O(e.escape))e.escape=e.escape.toString();else if(typeof e.escape!="string")return[Error(`Invalid Option: escape must be a buffer or a string, got ${JSON.stringify(e.escape)}`)];if(e.escape.length>1)return[Error(`Invalid Option: escape must be one character, got ${e.escape.length} characters`)];(e.header===void 0||e.header===null)&&(e.header=!1);const[r,n]=or(e.columns);if(r!==void 0)return[r];if(e.columns=n,(e.quoted===void 0||e.quoted===null)&&(e.quoted=!1),(e.cast===void 0||e.cast===null)&&(e.cast={}),(e.cast.bigint===void 0||e.cast.bigint===null)&&(e.cast.bigint=i=>""+i),(e.cast.boolean===void 0||e.cast.boolean===null)&&(e.cast.boolean=i=>i?"1":""),(e.cast.date===void 0||e.cast.date===null)&&(e.cast.date=i=>""+i.getTime()),(e.cast.number===void 0||e.cast.number===null)&&(e.cast.number=i=>""+i),(e.cast.object===void 0||e.cast.object===null)&&(e.cast.object=i=>JSON.stringify(i)),(e.cast.string===void 0||e.cast.string===null)&&(e.cast.string=function(i){return i}),e.on_record!==void 0&&typeof e.on_record!="function")return[Error('Invalid Option: "on_record" must be a function.')];if(e.record_delimiter===void 0||e.record_delimiter===null)e.record_delimiter=`
`;else if(O(e.record_delimiter))e.record_delimiter=e.record_delimiter.toString();else if(typeof e.record_delimiter!="string")return[Error(`Invalid Option: record_delimiter must be a buffer or a string, got ${JSON.stringify(e.record_delimiter)}`)];switch(e.record_delimiter){case"auto":e.record_delimiter=null;break;case"unix":e.record_delimiter=`
`;break;case"mac":e.record_delimiter="\r";break;case"windows":e.record_delimiter=`\r
`;break;case"ascii":e.record_delimiter="";break;case"unicode":e.record_delimiter="\u2028";break}return[void 0,e]},Ji=u.from([239,187,191]),Vi=function(t,e,r){return{options:t,state:e,info:r,__transform:function(n,i){if(!Array.isArray(n)&&typeof n!="object")return Error(`Invalid Record: expect an array or an object, got ${JSON.stringify(n)}`);if(this.info.records===0){if(Array.isArray(n)){if(this.options.header===!0&&this.options.columns===void 0)return Error("Undiscoverable Columns: header option requires column option or object records")}else if(this.options.columns===void 0){const[f,a]=or(Object.keys(n));if(f)return;this.options.columns=a}}if(this.info.records===0){this.bom(i);const f=this.headers(i);if(f)return f}try{this.options.on_record&&this.options.on_record(n,this.info.records)}catch(f){return f}let o,s;if(this.options.eof){if([o,s]=this.stringify(n),o)return o;if(s===void 0)return;s=s+this.options.record_delimiter}else{if([o,s]=this.stringify(n),o)return o;if(s===void 0)return;(this.options.header||this.info.records)&&(s=this.options.record_delimiter+s)}this.info.records++,i(s)},stringify:function(n,i=!1){if(typeof n!="object")return[void 0,n];const{columns:o}=this.options,s=[];if(Array.isArray(n)){o&&n.splice(o.length);for(let a=0;a<n.length;a++){const l=n[a],[h,c]=this.__cast(l,{index:a,column:a,records:this.info.records,header:i});if(h)return[h];s[a]=[c,l]}}else for(let a=0;a<o.length;a++){const l=Pi(n,o[a].key),[h,c]=this.__cast(l,{index:a,column:o[a].key,records:this.info.records,header:i});if(h)return[h];s[a]=[c,l]}let f="";for(let a=0;a<s.length;a++){let l,h,[c,w]=s[a];if(typeof c=="string")l=this.options;else if(nr(c)){if(l=c,c=l.value,delete l.value,typeof c!="string"&&c!==void 0&&c!==null&&h)return[Error(`Invalid Casting Value: returned value must return a string, null or undefined, got ${JSON.stringify(c)}`)];if(l={...this.options,...l},[h,l]=sr(l),h!==void 0)return[h]}else if(c==null)l=this.options;else return[Error(`Invalid Casting Value: returned value must return a string, an object, null or undefined, got ${JSON.stringify(c)}`)];const{delimiter:y,escape:I,quote:g,quoted:N,quoted_empty:E,quoted_string:m,quoted_match:p,record_delimiter:q}=l;if(c===""&&w===""){let V=p&&p.filter(X=>typeof X=="string"?c.indexOf(X)!==-1:X.test(c));V=V&&V.length>0,(V||E===!0||m===!0&&E!==!1)===!0&&(c=g+c+g),f+=c}else if(c){if(typeof c!="string")return[Error(`Formatter must return a string, null or undefined, got ${JSON.stringify(c)}`)];const V=y.length&&c.indexOf(y)>=0,Y=g!==""&&c.indexOf(g)>=0,X=c.indexOf(I)>=0&&I!==g,Be=c.indexOf(q)>=0,b=m&&typeof w=="string";let W=p&&p.filter(S=>typeof S=="string"?c.indexOf(S)!==-1:S.test(c));W=W&&W.length>0;const d=Y===!0||V||Be||N||b||W;if(d===!0&&X===!0){const S=I==="\\"?new RegExp(I+I,"g"):new RegExp(I,"g");c=c.replace(S,I+I)}if(Y===!0){const S=new RegExp(g,"g");c=c.replace(S,I+g)}d===!0&&(c=g+c+g),f+=c}else(E===!0||w===""&&m===!0&&E!==!1)&&(f+=g+g);a!==s.length-1&&(f+=y)}return[void 0,f]},bom:function(n){this.options.bom===!0&&n(Ji)},headers:function(n){if(this.options.header===!1||this.options.columns===void 0)return;let i,o=this.options.columns.map(s=>s.header);if(this.options.eof?([i,o]=this.stringify(o,!0),o+=this.options.record_delimiter):[i,o]=this.stringify(o),i)return i;n(o)},__cast:function(n,i){const o=typeof n;try{return o==="string"?[void 0,this.options.cast.string(n,i)]:o==="bigint"?[void 0,this.options.cast.bigint(n,i)]:o==="number"?[void 0,this.options.cast.number(n,i)]:o==="boolean"?[void 0,this.options.cast.boolean(n,i)]:n instanceof Date?[void 0,this.options.cast.date(n,i)]:o==="object"&&n!==null?[void 0,this.options.cast.object(n,i)]:[void 0,n,n]}catch(s){return[s]}}}};class Yi extends U{constructor(e={}){super({writableObjectMode:!0,...e});const[r,n]=sr(e);if(r!==void 0)throw r;this.options=n,this.state={stop:!1},this.info={records:0},this.api=Vi(this.options,this.state,this.info),this.api.options.on_record=(...i)=>{this.emit("record",...i)}}_transform(e,r,n){if(this.state.stop===!0)return;const i=this.api.__transform(e,this.push.bind(this));i!==void 0&&(this.state.stop=!0),n(i)}_flush(e){if(this.state.stop!==!0){if(this.info.records===0){this.api.bom(this.push.bind(this));const r=this.api.headers(this.push.bind(this));r&&e(r)}e()}}}const Qi=function(){let t,e,r;for(const i in arguments){const o=arguments[i],s=typeof o;if(t===void 0&&Array.isArray(o))t=o;else if(e===void 0&&nr(o))e=o;else if(r===void 0&&s==="function")r=o;else throw new se("CSV_INVALID_ARGUMENT",["Invalid argument:",`got ${JSON.stringify(o)} at index ${i}`])}const n=new Yi(e);if(r){const i=[];n.on("readable",function(){let o;for(;(o=this.read())!==null;)i.push(o)}),n.on("error",function(o){r(o)}),n.on("end",function(){r(void 0,i.join(""))})}if(t!==void 0){const i=function(){for(const o of t)n.write(o);n.end()};typeof setImmediate=="function"?setImmediate(i):setTimeout(i,0)}return n};export{Wi as p,Qi as s};
