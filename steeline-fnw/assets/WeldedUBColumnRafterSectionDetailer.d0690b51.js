import{J as oe,_ as ie,o as ue,c as q,a as S,i as _,b as v,S as ce,M as H,I as U,e as O,s as z,C as fe,d as de,f as he,t as y}from"./index.5aba22ff.js";import{D as ge}from"./DocumentsView.ab8d138b.js";import{x as A,P as me,m as B,j as pe}from"./PropertiesForm.c69fa44e.js";import{V as D,a as M}from"./Vec3.ce1f4f7a.js";import{W as ve}from"./WeldedUBColumnRafterSection.79a51e85.js";import{m as be,a as _e,S as ye}from"./SvgWithPanZoomState.e2089103.js";import"./DocumentView.3a121409.js";import"./Component.6024a649.js";const $e=y('<button class="btn btn-primary" style="margin-left: 5px; margin-bottom: 5px;">Close</button>'),Me=y("<br>"),ke=y('<svg><polygon stroke="green" fill="none" vector-effect="non-scaling-stroke"></polygon></svg>',4,!0),Se=y('<div style="flex-grow: 1; display: flex; flex-direction: row;"><div></div></div>'),Pe=y('<div style="flex-grow: 1; display: flex; flex-direction: column; overflow-y: scroll;"><div style="flex-grow: 1;"><table class="table"><thead><tr><th style="background: #FFF;">Item Name</th><th style="background: #FFF;">Qty</th><th style="background: #FFF;">Length</th><th style="background: #FFF;">Usage</th></tr></thead><tbody></tbody></table></div></div>'),V=y('<div style="flex-grow: 1; display: flex; flex-direction: column;"></div>'),we=y('<div style="flex-grow: 1; display: flex; flex-direction: column; overflow-y: hidden;"><div><h2>Welded UB Column Rafter Section Detailer</h2></div><ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link" style="cursor: pointer;">Model</a></li><li class="nav-item"><a class="nav-link" style="cursor: pointer;">BOM</a></li><li class="nav-item"><a class="nav-link" style="cursor: pointer;">3D</a></li><li class="nav-item"><a class="nav-link" style="cursor: pointer;">Workshop Drawings</a></li></ul></div>'),xe=y('<svg><rect vector-effect="non-scaling-stroke"></rect></svg>',4,!0),Ce=y('<svg><polygon stroke="black" fill="none" vector-effect="non-scaling-stroke"></polygon></svg>',4,!0),Ne=y("<tr><td></td><td></td><td></td><td></td></tr>"),ze=oe(()=>ie(()=>import("./ComponentScene3D.8d7811a7.js"),["ComponentScene3D.8d7811a7.js","index.5aba22ff.js","index.8628b9c4.css","Component.6024a649.js","Vec3.ce1f4f7a.js","OrbitControls.3e0e93be.js","GLTFExporter.c7bd8ba1.js","PropertiesForm.c69fa44e.js","three_js_component_renderer.95a2237b.js","LineKit.f6b732de.js","Component.fa73bdbc.js","Line3D.2b8117f1.js"],import.meta.url));var h;(function(b){b[b.Model=0]="Model",b[b.BOM=1]="BOM",b[b._3D=2]="_3D",b[b.WorkshopDrawings=3]="WorkshopDrawings"})(h||(h={}));const qe=b=>{ue(()=>{document.title="Tool Box - Welded UB Column Rafter Section Detailer"});const[$,T]=q({svgWidth:400,svgHeight:300,unitScale:100/8,selectedTab:h.Model}),[u,P]=q({span:12e3,height:4300,pitch:15,girtHeight:102,purlinHeight:102,frameItemName:"UB25025"}),a=l=>l/$.unitScale,[L,Z]=q({...be(),panX:a(-1e3),panY:a(-9e3)}),E=S(()=>!1);let W=new _e({state:L,setState:Z,disablePan:E}),G=l=>{W.onMouseDown(l)},j=l=>{W.onMouseUp(l)},Q=l=>{W.onMouseMove(l)},J=l=>{W.onWheel(l)};const K=new ve({span:()=>u.span,height:()=>u.height,pitch:()=>u.pitch,ubMemberProperties:()=>{let l=A[u.frameItemName];return{itemName:u.frameItemName,webSize:l.webSize,flangeSize:l.flangeSize,thickness:l.thickness}},plateThickness:()=>10,girtHeight:()=>u.girtHeight,purlinHeight:()=>u.purlinHeight,hasCentreMullion:()=>!0,mullionProperties:()=>{let l=A[u.frameItemName];return{itemName:u.frameItemName,webSize:l.webSize,flangeSize:l.flangeSize,thickness:l.thickness}}}),F=S(()=>K.components()),X=S(()=>{let l=F(),c={};for(let t of l){if(t.itemName==null)continue;let n;t.length==null?n="--":n=Math.round(t.length()).toFixed(0)+" mm";let i=t.itemName+"_"+n,r=c[i];if(r==null){let f=new Map;t.usage!=null&&f.set(t.usage(),t.qty==null?1:t.qty()),c[i]={itemName:t.itemName(),qty:t.qty==null?1:t.qty(),usage:f,length:n}}else if(r.qty+=t.qty==null?1:t.qty(),t.usage!=null){let f=r.usage.get(t.usage())??0;r.usage.set(t.usage(),f+(t.qty==null?1:t.qty()))}}let e=[];for(let t in c){let n=c[t],i="";{let r=!0;for(let[f,g]of n.usage)r?r=!1:i+="; ",i+=f+" ("+g+")"}e.push({itemName:n.itemName,qty:n.qty,length:n.length,usage:i})}return e.sort((t,n)=>{let i=t.itemName.localeCompare(n.itemName);if(i!=0)return i;{let r=Number.parseFloat(t.length),f=Number.parseFloat(n.length);return Number.isFinite(r)&&Number.isFinite(f)?r-f:t.length.localeCompare(n.length)}}),e}),Y=()=>{T("selectedTab",h.Model)},ee=()=>{T("selectedTab",h.BOM)},te=()=>{T("selectedTab",h._3D)},ne=()=>{T("selectedTab",h.WorkshopDrawings)},re=S(()=>{let l="",c=u.height+.5*u.span*Math.tan(u.pitch*Math.PI/180),e=[D.create(0,0),D.create(u.span,0),D.create(u.span,u.height),D.create(.5*u.span,c),D.create(0,u.height)];{let t=!0;for(let n of e)t?t=!1:l+=" ",l+=a(n.x)+","+a(-n.y)}return{pointsStr:l}}),le=S(()=>{let l=F(),c=[];for(let e of l)if(e.transform!=null&&e.length!=null&&e.ubProperties!=null){if(Math.abs(1-Math.abs(e.transform().w.y))>.001)continue;let t,n;if(e.frontBackCutAngle!=null)if(e.frontBackCutAngle()>0){const d=Math.tan(e.frontBackCutAngle()*Math.PI/180);t=e.ubProperties().webSize*d,n=0}else{const d=Math.tan(-e.frontBackCutAngle()*Math.PI/180);t=0,n=e.ubProperties().webSize*d}else t=0,n=0;let i,r;if(e.backBackCutAngle!=null)if(e.backBackCutAngle()>0){const d=Math.tan(e.backBackCutAngle()*Math.PI/180);i=e.ubProperties().webSize*d,r=0}else{const d=Math.tan(-e.backBackCutAngle()*Math.PI/180);i=0,r=e.ubProperties().webSize*d}else i=0,r=0;let f=e.transform(),g=[M.create(t,0,0),M.create(e.length()-i,0,0),M.create(e.length()-r,e.ubProperties().webSize,0),M.create(n,e.ubProperties().webSize,0)].map(d=>f.pointFromThisSpace(d)),x="";{let d=!0;for(let s of g)d?d=!1:x+=" ",x+=a(s.x)+","+a(-s.z)}c.push({pointsStr:x})}return c}),se=S(()=>{let l=F(),c=[];for(let e of l)if(e.transform!=null&&e.length!=null){if(e.ceeProperties!=null){let t=Math.atan2(-e.transform().u.z,e.transform().u.x)*180/Math.PI,n;{let r;e.transform().v.y<0?r=M.zero:r=e.transform().w.scale(e.ceeProperties().flangeSize),n=e.transform().o.add(r)}let i="translate("+a(n.x)+","+a(-n.z)+") rotate("+t+")";c.push({transform:i,width:a(e.length()),height:a(e.ceeProperties().flangeSize),colour:"rgb(0,0,0)"})}if(e.ubProperties!=null){if(Math.abs(1-Math.abs(e.transform().w.x))>.001)continue;let t=Math.atan2(-e.transform().u.z,e.transform().u.x)*180/Math.PI,n;{let g;e.transform().v.y<0?g=M.zero:g=e.transform().w.scale(e.ubProperties().flangeSize),n=e.transform().o.add(g)}let i="translate("+a(n.x)+","+a(-n.z)+") rotate("+t+")";c.push({transform:i,width:a(e.length()),height:a(e.ubProperties().flangeSize),colour:"rgb(0,0,0)"});let r;{let g;e.transform().v.y<0?g=e.transform().w.scale(.5*e.ubProperties().flangeSize-.5*e.ubProperties().thickness):g=e.transform().w.scale(.5*e.ubProperties().flangeSize),r=e.transform().o.add(g)}let f="translate("+a(r.x)+","+a(-r.z)+") rotate("+t+")";c.push({transform:f,width:a(e.length()),height:a(e.ubProperties().thickness),colour:"rgb(0,0,255)"})}if(e.flatProperties!=null){if(Math.abs(1-Math.abs(e.transform().v.y))<=.001){let t=Math.atan2(-e.transform().u.z,e.transform().u.x)*180/Math.PI,n;{let r;e.transform().v.y<0?r=M.zero:r=e.transform().w.scale(e.flatProperties().thickness),n=e.transform().o.add(r)}let i="translate("+a(n.x)+","+a(-n.z)+") rotate("+t+")";c.push({transform:i,width:a(e.length()),height:a(e.flatProperties().thickness),colour:"rgb(255,0,0)"})}else if(Math.abs(1-Math.abs(e.transform().v.x))<=.001){let t=Math.atan2(-e.transform().v.z,e.transform().v.x)*180/Math.PI,n;{let r;e.transform().u.y>0?r=M.zero:r=e.transform().w.scale(e.flatProperties().thickness),n=e.transform().o.add(r)}let i="translate("+a(n.x)+","+a(-n.z)+") rotate("+t+")";c.push({transform:i,width:a(e.flatProperties().width),height:a(e.flatProperties().thickness),colour:"rgb(255,0,0)"})}}}return c});return(()=>{const l=we.cloneNode(!0),c=l.firstChild;c.firstChild;const e=c.nextSibling,t=e.firstChild,n=t.firstChild,i=t.nextSibling,r=i.firstChild,f=i.nextSibling,g=f.firstChild,x=f.nextSibling,d=x.firstChild;return _(c,v(ce,{get when(){return b.onClose!=null},get children(){return[(()=>{const s=$e.cloneNode(!0);return s.$$click=()=>{b.onClose!=null&&b.onClose()},s})(),Me.cloneNode(!0)]}}),null),n.$$click=()=>Y(),r.$$click=()=>ee(),g.$$click=()=>te(),d.$$click=()=>ne(),_(l,v(de,{get children(){return[v(H,{get when(){return $.selectedTab==h.Model},get children(){const s=Se.cloneNode(!0),w=s.firstChild;return _(w,v(me,{get fieldGroups(){return[{displayName:"Section",fields:[B({displayName:()=>"Span",value:()=>u.span,setValue:o=>P("span",o)}),B({displayName:()=>"Height",value:()=>u.height,setValue:o=>P("height",o)}),B({displayName:()=>"Pitch",value:()=>u.pitch,setValue:o=>P("pitch",o)}),B({displayName:()=>"Girt Height",value:()=>u.girtHeight,setValue:o=>P("girtHeight",o)}),B({displayName:()=>"Purlin Height",value:()=>u.purlinHeight,setValue:o=>P("purlinHeight",o)}),pe({displayName:()=>"Frame Size",value:()=>u.frameItemName,setValue:o=>P("frameItemName",o),possibleValues:S(()=>Object.keys(A))})],expanded:()=>!0}]}})),_(s,v(ye,{showGrid:!0,fontSize:12,state:L,onMouseDown:G,onMouseUp:j,onMouseMove:Q,onWheel:J,style:{"flex-grow":"1"},get children(){return[v(U,{get each(){return se()},children:o=>(()=>{const p=xe.cloneNode(!0);return O(m=>{const k=o().transform,C=o().width,N=o().height,I="stroke-width:1;stroke:"+o().colour+";fill:none;";return k!==m._v$5&&z(p,"transform",m._v$5=k),C!==m._v$6&&z(p,"width",m._v$6=C),N!==m._v$7&&z(p,"height",m._v$7=N),m._v$8=fe(p,I,m._v$8),m},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),p})()}),v(U,{get each(){return le()},children:o=>(()=>{const p=Ce.cloneNode(!0);return O(()=>z(p,"points",o().pointsStr)),p})()}),(()=>{const o=ke.cloneNode(!0);return O(()=>z(o,"points",re().pointsStr)),o})()]}}),null),s}}),v(H,{get when(){return $.selectedTab==h.BOM},get children(){const s=Pe.cloneNode(!0),w=s.firstChild,o=w.firstChild,p=o.firstChild,m=p.nextSibling;return _(m,v(U,{get each(){return X()},children:k=>(()=>{const C=Ne.cloneNode(!0),N=C.firstChild,I=N.nextSibling,R=I.nextSibling,ae=R.nextSibling;return _(N,()=>k().itemName),_(I,()=>k().qty),_(R,()=>k().length),_(ae,()=>k().usage),C})()})),s}}),v(H,{get when(){return $.selectedTab==h._3D},get children(){const s=V.cloneNode(!0);return _(s,v(ze,{get components(){return F()}})),s}}),v(H,{get when(){return $.selectedTab==h.WorkshopDrawings},get children(){const s=V.cloneNode(!0);return _(s,v(ge,{documents:[]})),s}})]}}),null),O(s=>{const w=$.selectedTab==h.Model,o=$.selectedTab==h.BOM,p=$.selectedTab==h._3D,m=$.selectedTab==h.WorkshopDrawings;return w!==s._v$&&n.classList.toggle("active",s._v$=w),o!==s._v$2&&r.classList.toggle("active",s._v$2=o),p!==s._v$3&&g.classList.toggle("active",s._v$3=p),m!==s._v$4&&d.classList.toggle("active",s._v$4=m),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),l})()};he(["click"]);export{qe as default};
