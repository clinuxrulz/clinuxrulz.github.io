import{D as F,b as D,$ as h,a as M,g as K,c as k}from"./dev-B9-ass9r.js";const _=Symbol("store-raw"),a=Symbol("store-node"),w=Symbol("store-has"),V=Symbol("store-self"),U={onStoreNodeUpdate:null};function W(e){let n=e[h];if(!n&&(Object.defineProperty(e,h,{value:n=new Proxy(e,X)}),!Array.isArray(e))){const o=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let i=0,t=o.length;i<t;i++){const f=o[i];r[f].get&&Object.defineProperty(e,f,{enumerable:r[f].enumerable,get:r[f].get.bind(n)})}}return n}function O(e){let n;return e!=null&&typeof e=="object"&&(e[h]||!(n=Object.getPrototypeOf(e))||n===Object.prototype||Array.isArray(e))}function j(e,n=new Set){let o,r,i,t;if(o=e!=null&&e[_])return o;if(!O(e)||n.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):n.add(e);for(let f=0,d=e.length;f<d;f++)i=e[f],(r=j(i,n))!==i&&(e[f]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):n.add(e);const f=Object.keys(e),d=Object.getOwnPropertyDescriptors(e);for(let s=0,l=f.length;s<l;s++)t=f[s],!d[t].get&&(i=e[t],(r=j(i,n))!==i&&(e[t]=r))}return e}function E(e,n){let o=e[n];return o||Object.defineProperty(e,n,{value:o=Object.create(null)}),o}function P(e,n,o){if(e[n])return e[n];const[r,i]=k(o,{equals:!1,internal:!0});return r.$=i,e[n]=r}function q(e,n){const o=Reflect.getOwnPropertyDescriptor(e,n);return!o||o.get||!o.configurable||n===h||n===a||(delete o.value,delete o.writable,o.get=()=>e[h][n]),o}function C(e){K()&&P(E(e,a),V)()}function G(e){return C(e),Reflect.ownKeys(e)}const X={get(e,n,o){if(n===_)return e;if(n===h)return o;if(n===M)return C(e),o;const r=E(e,a),i=r[n];let t=i?i():e[n];if(n===a||n===w||n==="__proto__")return t;if(!i){const f=Object.getOwnPropertyDescriptor(e,n);K()&&(typeof t!="function"||e.hasOwnProperty(n))&&!(f&&f.get)&&(t=P(r,n,t)())}return O(t)?W(t):t},has(e,n){return n===_||n===h||n===M||n===a||n===w||n==="__proto__"?!0:(K()&&P(E(e,w),n)(),n in e)},set(){return console.warn("Cannot mutate a Store directly"),!0},deleteProperty(){return console.warn("Cannot mutate a Store directly"),!0},ownKeys:G,getOwnPropertyDescriptor:q};function b(e,n,o,r=!1){if(!r&&e[n]===o)return;const i=e[n],t=e.length;U.onStoreNodeUpdate&&U.onStoreNodeUpdate(e,n,o,i),o===void 0?(delete e[n],e[w]&&e[w][n]&&i!==void 0&&e[w][n].$()):(e[n]=o,e[w]&&e[w][n]&&i===void 0&&e[w][n].$());let f=E(e,a),d;if((d=P(f,n,i))&&d.$(()=>o),Array.isArray(e)&&e.length!==t){for(let s=e.length;s<t;s++)(d=f[s])&&d.$();(d=P(f,"length",t))&&d.$(e.length)}(d=f[V])&&d.$()}function H(e,n){const o=Object.keys(n);for(let r=0;r<o.length;r+=1){const i=o[r];b(e,i,n[i])}}function Y(e,n){if(typeof n=="function"&&(n=n(e)),n=j(n),Array.isArray(n)){if(e===n)return;let o=0,r=n.length;for(;o<r;o++){const i=n[o];e[o]!==i&&b(e,o,i)}b(e,"length",r)}else H(e,n)}function x(e,n,o=[]){let r,i=e;if(n.length>1){r=n.shift();const f=typeof r,d=Array.isArray(e);if(Array.isArray(r)){for(let s=0;s<r.length;s++)x(e,[r[s]].concat(n),o);return}else if(d&&f==="function"){for(let s=0;s<e.length;s++)r(e[s],s)&&x(e,[s].concat(n),o);return}else if(d&&f==="object"){const{from:s=0,to:l=e.length-1,by:c=1}=r;for(let u=s;u<=l;u+=c)x(e,[u].concat(n),o);return}else if(n.length>1){x(e[r],n,[r].concat(o));return}i=e[r],o=[r].concat(o)}let t=n[0];typeof t=="function"&&(t=t(i,o),t===i)||r===void 0&&t==null||(t=j(t),r===void 0||O(i)&&O(t)&&!Array.isArray(t)?H(i,t):b(e,r,t))}function Z(...[e,n]){const o=j(e||{}),r=Array.isArray(o);if(typeof o!="object"&&typeof o!="function")throw new Error(`Unexpected type ${typeof o} received when initializing 'createStore'. Expected an object.`);const i=W(o);F.registerGraph({value:o,name:n&&n.name});function t(...f){D(()=>{r&&f.length===1?Y(o,f[0]):x(o,f)})}return[i,t]}function B(e,n){const o=Reflect.getOwnPropertyDescriptor(e,n);return!o||o.get||o.set||!o.configurable||n===h||n===a||(delete o.value,delete o.writable,o.get=()=>e[h][n],o.set=r=>e[h][n]=r),o}const J={get(e,n,o){if(n===_)return e;if(n===h)return o;if(n===M)return C(e),o;const r=E(e,a),i=r[n];let t=i?i():e[n];if(n===a||n===w||n==="__proto__")return t;if(!i){const f=Object.getOwnPropertyDescriptor(e,n),d=typeof t=="function";if(K()&&(!d||e.hasOwnProperty(n))&&!(f&&f.get))t=P(r,n,t)();else if(t!=null&&d&&t===Array.prototype[n])return(...s)=>D(()=>Array.prototype[n].apply(o,s))}return O(t)?I(t):t},has(e,n){return n===_||n===h||n===M||n===a||n===w||n==="__proto__"?!0:(K()&&P(E(e,w),n)(),n in e)},set(e,n,o){return D(()=>b(e,n,j(o))),!0},deleteProperty(e,n){return D(()=>b(e,n,void 0,!0)),!0},ownKeys:G,getOwnPropertyDescriptor:B};function I(e){let n=e[h];if(!n){Object.defineProperty(e,h,{value:n=new Proxy(e,J)});const o=Object.keys(e),r=Object.getOwnPropertyDescriptors(e),i=Object.getPrototypeOf(e),t=i!==null&&e!==null&&typeof e=="object"&&!Array.isArray(e)&&i!==Object.prototype;if(t){const f=Object.getOwnPropertyDescriptors(i);o.push(...Object.keys(f)),Object.assign(r,f)}for(let f=0,d=o.length;f<d;f++){const s=o[f];if(!(t&&s==="constructor")){if(r[s].get){const l=r[s].get.bind(n);Object.defineProperty(e,s,{get:l,configurable:!0})}if(r[s].set){const l=r[s].set;Object.defineProperty(e,s,{set:u=>D(()=>l.call(n,u)),configurable:!0})}}}}return n}function m(e,n){const o=j(e||{});if(typeof o!="object"&&typeof o!="function")throw new Error(`Unexpected type ${typeof o} received when initializing 'createMutable'. Expected an object.`);const r=I(o);return F.registerGraph({value:o,name:n&&n.name}),r}function v(e,n){D(()=>n(j(e)))}const z=Symbol("store-root");function $(e,n,o,r,i){const t=n[o];if(e===t)return;const f=Array.isArray(e);if(o!==z&&(!O(e)||!O(t)||f!==Array.isArray(t)||i&&e[i]!==t[i])){b(n,o,e);return}if(f){if(e.length&&t.length&&(!r||i&&e[0]&&e[0][i]!=null)){let l,c,u,y,A,g,p,S;for(u=0,y=Math.min(t.length,e.length);u<y&&(t[u]===e[u]||i&&t[u]&&e[u]&&t[u][i]===e[u][i]);u++)$(e[u],t,u,r,i);const N=new Array(e.length),R=new Map;for(y=t.length-1,A=e.length-1;y>=u&&A>=u&&(t[y]===e[A]||i&&t[u]&&e[u]&&t[y][i]===e[A][i]);y--,A--)N[A]=t[y];if(u>A||u>y){for(c=u;c<=A;c++)b(t,c,e[c]);for(;c<e.length;c++)b(t,c,N[c]),$(e[c],t,c,r,i);t.length>e.length&&b(t,"length",e.length);return}for(p=new Array(A+1),c=A;c>=u;c--)g=e[c],S=i&&g?g[i]:g,l=R.get(S),p[c]=l===void 0?-1:l,R.set(S,c);for(l=u;l<=y;l++)g=t[l],S=i&&g?g[i]:g,c=R.get(S),c!==void 0&&c!==-1&&(N[c]=t[l],c=p[c],R.set(S,c));for(c=u;c<e.length;c++)c in N?(b(t,c,N[c]),$(e[c],t,c,r,i)):b(t,c,e[c])}else for(let l=0,c=e.length;l<c;l++)$(e[l],t,l,r,i);t.length>e.length&&b(t,"length",e.length);return}const d=Object.keys(e);for(let l=0,c=d.length;l<c;l++)$(e[d[l]],t,d[l],r,i);const s=Object.keys(t);for(let l=0,c=s.length;l<c;l++)e[s[l]]===void 0&&b(t,s[l],void 0)}function ee(e,n={}){const{merge:o,key:r="id"}=n,i=j(e);return t=>{if(!O(t)||!O(i))return i;const f=$(i,{[z]:t},z,o,r);return f===void 0?t:f}}const T=new WeakMap,L={get(e,n){if(n===_)return e;const o=e[n];let r;return O(o)?T.get(o)||(T.set(o,r=new Proxy(o,L)),r):o},set(e,n,o){return b(e,n,j(o)),!0},deleteProperty(e,n){return b(e,n,void 0,!0),!0}};function ne(e){return n=>{if(O(n)){let o;(o=T.get(n))||T.set(n,o=new Proxy(n,L)),e(o)}return n}}const oe={$NODE:a,isWrappable:O,hooks:U};export{_ as $,oe as D,Z as a,m as c,v as m,ne as p,ee as r,j as u};
