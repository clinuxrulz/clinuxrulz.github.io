const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CodeMirror-Cp4M-tSB.js","./lib-B0KXb3kF.js","./index-XNH-lkY3.js","./dev-B9-ass9r.js","./dev-CC7pdsS5.js","./AppV2-Czx9TzPz.js","./PixelEditor-DGvm_DMy.js","./ColourPicker-Dch4C5kZ.js","./ScriptEditor-CnveHCsF.js","./solid-js-C16mITwu.js","./pixi-js-CTVzrHHI.js","./FederatedEventTarget-DFQx8mKK.js","./Filter-BDK7ILDO.js","./State-3sV0XrC-.js","./CanvasTextSystem-BKHjFPHo.js","./colorToUniform-W8Zlj3HA.js","./SharedSystems-BwGi1NkL.js","./AnimatedSprite-CrPahPC5.js","./WebGLRenderer-DzfsPnmv.js","./WebGPURenderer-DziseXTR.js","./solid-js-store-D4PqY48D.js","./AppV2-DQoE4ujd.css","./KittyDemo-CDb76M4C.js","./ReactiveSimulator-BJmldc9l.js","./VectorEditor-DIbet-a-.js","./GravityTest-Dl3GkS9z.js","./ThreeBody-CHmZOjlU.js","./VirtualFileSystemTest-D8wFMUEt.js","./AutomergeWebRtcTest-BYCGml_W.js","./DebugProjection-D1jchVOu.js","./AutoFormsTest-Tb85Oz9c.js"])))=>i.map(i=>d[i]);
import{dG as Yr,i as Ai,d as Gu,dH as Hu,_ as Be}from"./index-XNH-lkY3.js";import{M as Zu,d as $e,J as is,w as Ke,x as ke,i as Y,u as ve,t as Z,N as Xr,n as Gt,P as ut,Vec2 as ci,v as Ut,s as J,Q as os,k as Mi,g as po,R as Wu,W as Yu,X as fo,Y as ho,Z as Xu}from"./lib-B0KXb3kF.js";import{U as as,q as C,C as Ni,n as ss,Z as ls,c as K,s as Q,N as se,X as Ku,T as Ju,b as Le,Y as me,l as M,k as cs,K as Qu,S as de,u as Pt,O as Te,V as An,m as ge,F as st,h as Oi,M as Ht,J as It,Q as bn,p as Ce,W as Fi,H as qe,t as ed}from"./dev-B9-ass9r.js";import{a as Me,p as kr}from"./dev-CC7pdsS5.js";function td(e,r){for(var t=0;t<r.length;t++){const n=r[t];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function us(){let e=new Set;function r(i){return e.add(i),()=>e.delete(i)}let t=!1;function n(i,o){if(t)return!(t=!1);const a={to:i,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const l of e)l.listener({...a,from:l.location,retry:u=>{u&&(t=!0),l.navigate(i,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:r,confirm:n}}let ui;function zi(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),ui=window.history.state._depth}zi();function rd(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function nd(e,r){let t=!1;return()=>{const n=ui;zi();const i=n==null?null:ui-n;if(t){t=!1;return}i&&r(i)?(t=!0,window.history.go(-i)):e()}}const id=/^(?:[a-z0-9]+:)?\/\//i,od=/^\/+|(\/)\/+$/g,ds="http://sr";function Tr(e,r=!1){const t=e.replace(od,"$1");return t?r||/^[?#]/.test(t)?t:"/"+t:""}function sn(e,r,t){if(id.test(r))return;const n=Tr(e),i=t&&Tr(t);let o="";return!i||r.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+Tr(r,!o)}function ad(e,r){if(e==null)throw new Error(r);return e}function sd(e,r){return Tr(e).replace(/\/*(\*.*)?$/g,"")+Tr(r)}function ps(e){const r={};return e.searchParams.forEach((t,n)=>{n in r?Array.isArray(r[n])?r[n].push(t):r[n]=[r[n],t]:r[n]=t}),r}function ld(e,r,t){const[n,i]=e.split("/*",2),o=n.split("/").filter(Boolean),a=o.length;return l=>{const u=l.split("/").filter(Boolean),s=u.length-a;if(s<0||s>0&&i===void 0&&!r)return null;const c={path:a?"":"/",params:{}},p=f=>t===void 0?void 0:t[f];for(let f=0;f<a;f++){const d=o[f],h=d[0]===":",m=h?u[f]:u[f].toLowerCase(),g=h?d.slice(1):d.toLowerCase();if(h&&Mn(m,p(g)))c.params[g]=m;else if(h||!Mn(m,g))return null;c.path+=`/${m}`}if(i){const f=s?u.slice(-s).join("/"):"";if(Mn(f,p(i)))c.params[i]=f;else return null}return c}}function Mn(e,r){const t=n=>n===e;return r===void 0?!0:typeof r=="string"?t(r):typeof r=="function"?r(e):Array.isArray(r)?r.some(t):r instanceof RegExp?r.test(e):!1}function cd(e){const[r,t]=e.pattern.split("/*",2),n=r.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(t===void 0?0:1))}function fs(e){const r=new Map,t=Ni();return new Proxy({},{get(n,i){return r.has(i)||as(t,()=>r.set(i,C(()=>e()[i]))),r.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function hs(e){let r=/(\/?\:[^\/]+)\?/.exec(e);if(!r)return[e];let t=e.slice(0,r.index),n=e.slice(r.index+r[0].length);const i=[t,t+=r[1]];for(;r=/^(\/\:[^\/]+)\?/.exec(n);)i.push(t+=r[1]),n=n.slice(r[0].length);return hs(n).reduce((o,a)=>[...o,...i.map(l=>l+a)],[])}const ud=100,ms=ss(),gs=ss(),dd=()=>ad(ls(ms),"<A> and 'use' router primitives can be only used inside a Route."),pd=()=>dd().navigatorFactory();function fd(e,r=""){const{component:t,preload:n,load:i,children:o,info:a}=e,l=!o||Array.isArray(o)&&!o.length,u={key:e,component:t,preload:n||i,info:a};return ys(e.path).reduce((s,c)=>{for(const p of hs(c)){const f=sd(r,p);let d=l?f:f.split("/*",1)[0];d=d.split("/").map(h=>h.startsWith(":")||h.startsWith("*")?h:encodeURIComponent(h)).join("/"),s.push({...u,originalPath:c,pattern:d,matcher:ld(d,!l,e.matchFilters)})}return s},[])}function hd(e,r=0){return{routes:e,score:cd(e[e.length-1])*1e4-r,matcher(t){const n=[];for(let i=e.length-1;i>=0;i--){const o=e[i],a=o.matcher(t);if(!a)return null;n.unshift({...a,route:o})}return n}}}function ys(e){return Array.isArray(e)?e:[e]}function bs(e,r="",t=[],n=[]){const i=ys(e);for(let o=0,a=i.length;o<a;o++){const l=i[o];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const u=fd(l,r);for(const s of u){t.push(s);const c=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!c)bs(l.children,s.pattern,t,n);else{const p=hd([...t],n.length);n.push(p)}t.pop()}}}return t.length?n:n.sort((o,a)=>a.score-o.score)}function Nn(e,r){for(let t=0,n=e.length;t<n;t++){const i=e[t].matcher(r);if(i)return i}return[]}function md(e,r,t){const n=new URL(ds),i=C(c=>{const p=e();try{return new URL(p,n)}catch{return console.error(`Invalid path ${p}`),c}},n,{equals:(c,p)=>c.href===p.href}),o=C(()=>i().pathname),a=C(()=>i().search,!0),l=C(()=>i().hash),u=()=>"",s=se(a,()=>ps(i()));return{get pathname(){return o()},get search(){return a()},get hash(){return l()},get state(){return r()},get key(){return u()},query:t?t(s):fs(s)}}let jt;function gd(){return jt}function yd(e,r,t,n={}){const{signal:[i,o],utils:a={}}=e,l=a.parsePath||(N=>N),u=a.renderPath||(N=>N),s=a.beforeLeave||us(),c=sn("",n.base||"");if(c===void 0)throw new Error(`${c} is not a valid base path`);c&&!i().value&&o({value:c,replace:!0,scroll:!1});const[p,f]=K(!1);let d;const h=(N,R)=>{R.value===m()&&R.state===y()||(d===void 0&&f(!0),jt=N,d=R,Ku(()=>{d===R&&(g(d.value),b(d.state),Ju(),k[1](O=>O.filter(L=>L.pending)))}).finally(()=>{d===R&&Le(()=>{jt=void 0,N==="navigate"&&I(d),f(!1),d=void 0})}))},[m,g]=K(i().value),[y,b]=K(i().state),w=md(m,y,a.queryWrapper),v=[],k=K([]),_=C(()=>typeof n.transformUrl=="function"?Nn(r(),n.transformUrl(w.pathname)):Nn(r(),w.pathname)),S=()=>{const N=_(),R={};for(let O=0;O<N.length;O++)Object.assign(R,N[O].params);return R},P=a.paramsWrapper?a.paramsWrapper(S,r):fs(S),T={pattern:c,path:()=>c,outlet:()=>null,resolvePath(N){return sn(c,N)}};return Q(se(i,N=>h("native",N),{defer:!0})),{base:T,location:w,params:P,isRouting:p,renderPath:u,parsePath:l,navigatorFactory:x,matches:_,beforeLeave:s,preloadRoute:F,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:k};function $(N,R,O){me(()=>{if(typeof R=="number"){R&&(a.go?a.go(R):console.warn("Router integration does not support relative routing"));return}const L=!R||R[0]==="?",{replace:B,resolve:U,scroll:H,state:ne}={replace:!1,resolve:!L,scroll:!0,...O},ce=U?N.resolvePath(R):sn(L&&w.pathname||"",R);if(ce===void 0)throw new Error(`Path '${R}' is not a routable path`);if(v.length>=ud)throw new Error("Too many redirects");const fe=m();(ce!==fe||ne!==y())&&(Zu||s.confirm(ce,O)&&(v.push({value:fe,replace:B,scroll:H,state:y()}),h("navigate",{value:ce,state:ne})))})}function x(N){return N=N||ls(gs)||T,(R,O)=>$(N,R,O)}function I(N){const R=v[0];R&&(o({...N,replace:R.replace,scroll:R.scroll}),v.length=0)}function F(N,R){const O=Nn(r(),N.pathname),L=jt;jt="preload";for(let B in O){const{route:U,params:H}=O[B];U.component&&U.component.preload&&U.component.preload();const{preload:ne}=U;R&&ne&&as(t(),()=>ne({params:H,location:{pathname:N.pathname,search:N.search,hash:N.hash,query:ps(N),state:null,key:""},intent:"preload"}))}jt=L}}function bd(e,r,t,n){const{base:i,location:o,params:a}=e,{pattern:l,component:u,preload:s}=n().route,c=C(()=>n().path);u&&u.preload&&u.preload();const p=s?s({params:a,location:o,intent:jt||"initial"}):void 0;return{parent:r,pattern:l,path:c,outlet:()=>u?M(u,{params:a,location:o,data:p,get children(){return t()}}):t(),resolvePath(d){return sn(i.path(),d,c())}}}const vd=e=>r=>{const{base:t}=r,n=cs(()=>r.children),i=C(()=>bs(n(),r.base||""));let o;const a=yd(e,i,()=>o,{base:t,singleFlight:r.singleFlight,transformUrl:r.transformUrl});return e.create&&e.create(a),M(ms.Provider,{value:a,get children(){return M(wd,{routerState:a,get root(){return r.root},get preload(){return r.rootPreload||r.rootLoad},get children(){return[C(()=>(o=Ni())&&null),M(kd,{routerState:a,get branches(){return i()}})]}})}})};function wd(e){const r=e.routerState.location,t=e.routerState.params,n=C(()=>e.preload&&me(()=>{e.preload({params:t,location:r,intent:gd()||"initial"})}));return M(de,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:i=>M(i,{params:t,location:r,get data(){return n()},get children(){return e.children}})})}function kd(e){const r=[];let t;const n=C(se(e.routerState.matches,(i,o,a)=>{let l=o&&i.length===o.length;const u=[];for(let s=0,c=i.length;s<c;s++){const p=o&&o[s],f=i[s];a&&p&&f.route.key===p.route.key?u[s]=a[s]:(l=!1,r[s]&&r[s](),Pt(d=>{r[s]=d,u[s]=bd(e.routerState,u[s-1]||e.routerState.base,mo(()=>n()[s+1]),()=>e.routerState.matches()[s])}))}return r.splice(i.length).forEach(s=>s()),a&&l?a:(t=u[0],u)}));return mo(()=>n()&&t)()}const mo=e=>()=>M(de,{get when(){return e()},keyed:!0,children:r=>M(gs.Provider,{value:r,get children(){return r.outlet()}})}),Ee=e=>{const r=cs(()=>e.children);return Qu(e,{get children(){return r()}})};function xd([e,r],t,n){return[e,n?i=>r(n(i)):r]}function _d(e){let r=!1;const t=i=>typeof i=="string"?{value:i}:i,n=xd(K(t(e.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!r&&e.set(i),An.registry&&!An.done&&(An.done=!0),i));return e.init&&Te(e.init((i=e.get())=>{r=!0,n[1](t(i)),r=!1})),vd({signal:n,create:e.create,utils:e.utils})}function Sd(e,r,t){return e.addEventListener(r,t),()=>e.removeEventListener(r,t)}function Cd(e,r){const t=e&&document.getElementById(e);t?t.scrollIntoView():r&&window.scrollTo(0,0)}const Pd=new Map;function Td(e=!0,r=!1,t="/_server",n){return i=>{const o=i.base.path(),a=i.navigatorFactory(i.base);let l,u;function s(m){return m.namespaceURI==="http://www.w3.org/2000/svg"}function c(m){if(m.defaultPrevented||m.button!==0||m.metaKey||m.altKey||m.ctrlKey||m.shiftKey)return;const g=m.composedPath().find(_=>_ instanceof Node&&_.nodeName.toUpperCase()==="A");if(!g||r&&!g.hasAttribute("link"))return;const y=s(g),b=y?g.href.baseVal:g.href;if((y?g.target.baseVal:g.target)||!b&&!g.hasAttribute("state"))return;const v=(g.getAttribute("rel")||"").split(/\s+/);if(g.hasAttribute("download")||v&&v.includes("external"))return;const k=y?new URL(b,document.baseURI):new URL(b);if(!(k.origin!==window.location.origin||o&&k.pathname&&!k.pathname.toLowerCase().startsWith(o.toLowerCase())))return[g,k]}function p(m){const g=c(m);if(!g)return;const[y,b]=g,w=i.parsePath(b.pathname+b.search+b.hash),v=y.getAttribute("state");m.preventDefault(),a(w,{resolve:!1,replace:y.hasAttribute("replace"),scroll:!y.hasAttribute("noscroll"),state:v?JSON.parse(v):void 0})}function f(m){const g=c(m);if(!g)return;const[y,b]=g;i.preloadRoute(b,y.getAttribute("preload")!=="false")}function d(m){clearTimeout(l);const g=c(m);if(!g)return u=null;const[y,b]=g;u!==y&&(l=setTimeout(()=>{i.preloadRoute(b,y.getAttribute("preload")!=="false"),u=y},20))}function h(m){if(m.defaultPrevented)return;let g=m.submitter&&m.submitter.hasAttribute("formaction")?m.submitter.getAttribute("formaction"):m.target.getAttribute("action");if(!g)return;if(!g.startsWith("https://action/")){const b=new URL(g,ds);if(g=i.parsePath(b.pathname+b.search),!g.startsWith(t))return}if(m.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const y=Pd.get(g);if(y){m.preventDefault();const b=new FormData(m.target,m.submitter);y.call({r:i,f:m.target},m.target.enctype==="multipart/form-data"?b:new URLSearchParams(b))}}$e(["click","submit"]),document.addEventListener("click",p),e&&(document.addEventListener("mousemove",d,{passive:!0}),document.addEventListener("focusin",f,{passive:!0}),document.addEventListener("touchstart",f,{passive:!0})),document.addEventListener("submit",h),Te(()=>{document.removeEventListener("click",p),e&&(document.removeEventListener("mousemove",d),document.removeEventListener("focusin",f),document.removeEventListener("touchstart",f)),document.removeEventListener("submit",h)})}}function $d(e){const r=e.replace(/^.*?#/,"");if(!r.startsWith("/")){const[,t="/"]=window.location.hash.split("#",2);return`${t}#${r}`}return r}function Ed(e){const r=()=>window.location.hash.slice(1),t=us();return _d({get:r,set({value:n,replace:i,scroll:o,state:a}){i?window.history.replaceState(rd(a),"","#"+n):window.history.pushState(a,"","#"+n);const l=n.indexOf("#"),u=l>=0?n.slice(l+1):"";Cd(u,o),zi()},init:n=>Sd(window,"hashchange",nd(n,i=>!t.confirm(i&&i<0?i:r()))),create:Td(e.preload,e.explicitLinks,e.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:$d,beforeLeave:t}})(e)}var ln={exports:{}},Id=ln.exports,go;function Rd(){return go||(go=1,function(e,r){(function(t,n){n()})(Id,function(){function t(s,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function n(s,c,p){var f=new XMLHttpRequest;f.open("GET",s),f.responseType="blob",f.onload=function(){u(f.response,c,p)},f.onerror=function(){console.error("could not download file")},f.send()}function i(s){var c=new XMLHttpRequest;c.open("HEAD",s,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function o(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(c)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Yr=="object"&&Yr.global===Yr?Yr:void 0,l=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(s,c,p){var f=a.URL||a.webkitURL,d=document.createElement("a");c=c||s.name||"download",d.download=c,d.rel="noopener",typeof s=="string"?(d.href=s,d.origin===location.origin?o(d):i(d.href)?n(s,c,p):o(d,d.target="_blank")):(d.href=f.createObjectURL(s),setTimeout(function(){f.revokeObjectURL(d.href)},4e4),setTimeout(function(){o(d)},0))}:"msSaveOrOpenBlob"in navigator?function(s,c,p){if(c=c||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(t(s,p),c);else if(i(s))n(s,c,p);else{var f=document.createElement("a");f.href=s,f.target="_blank",setTimeout(function(){o(f)})}}:function(s,c,p,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof s=="string")return n(s,c,p);var d=s.type==="application/octet-stream",h=/constructor/i.test(a.HTMLElement)||a.safari,m=/CriOS\/[\d]+/.test(navigator.userAgent);if((m||d&&h||l)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var w=g.result;w=m?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=w:location=w,f=null},g.readAsDataURL(s)}else{var y=a.URL||a.webkitURL,b=y.createObjectURL(s);f?f.location=b:location.href=b,f=null,setTimeout(function(){y.revokeObjectURL(b)},4e4)}});a.saveAs=u.saveAs=u,e.exports=u})}(ln)),ln.exports}var Ad=Rd();const vs=Ai(Ad);let aw=async e=>{let r=e.vfs,t=new is,n=async(i,o)=>{let a=o.contents;for(let l of a)switch(l.type){case"File":{let u=await new Promise(c=>{Pt(p=>{let f=o.openFileById(l.id);ge(()=>{let d=f();if(d.type=="Pending")return;if(p(),d.type=="Failed"){c(Ke(d.message));return}let h=d.value,m;if(h.name().toLowerCase().endsWith(".json"))m=new Blob([JSON.stringify(h.doc,void 0,2)],{type:"application/json"});else if(h.name().toLowerCase().endsWith(".ts"))m=new Blob([h.doc.source],{type:"application/typescript"});else{let g=h.doc.mimeType,y=h.doc.data;m=new Blob([y],{type:g})}c(ke(m))})})});if(u.type=="Err")continue;let s=u.value;i.file(l.name,s);break}case"Folder":{let u=i.folder(l.name);if(u==null)continue;await new Promise(s=>{Pt(c=>{let p=o.openFolderById(l.id);ge(()=>{let f=p();if(f.type=="Pending")return;if(f.type=="Failed"){console.log(f.message),c(),s();return}let d=f.value;(async()=>(await n(u,d),c(),s()))()})})});break}}};Pt(i=>{let o=r.rootFolder();ge(()=>{let a=o();if(a.type!="Pending"){if(a.type=="Failed"){console.log(a.message),i();return}(async()=>{let l=a.value;await n(t,l);let u=await t.generateAsync({type:"blob"});vs.saveAs(u,"kitty_export.zip"),i()})()}})})},Md=async e=>{let r=e.vfs,t;{let n=await new Promise(i=>{Pt(o=>{let a=r.rootFolder();ge(()=>{let l=a();if(l.type=="Pending")return;if(l.type=="Failed"){o(),i(Ke(l.message));return}let u=l.value;me(()=>{let s=u.contents;for(let c of s)u.removeFileOrFolderById(c.id)}),o(),i(ke(u))})})});if(n.type=="Err")return n;t=n.value}{let n=await is.loadAsync(e.file);async function i(o,a){let l;if(o=="")l=n;else{let c=n.folder(o);if(c==null)return;l=c}if(!l){console.warn(`Folder "${o}" not found in the zip.`);return}const u=[];l.forEach((c,p)=>{const f=o+(o&&!o.endsWith("/")?"/":"")+c;u.push({name:f,relativePath:c,isFolder:p.dir})});let s=[];for(let c of u)c.isFolder&&s.push(c.relativePath);for(const c of u)if(!s.some(p=>c.relativePath.startsWith(p))&&!c.isFolder){let p=n.file(c.name);if(p==null)continue;let f=await p.async("blob");if(c.relativePath.toLowerCase().endsWith(".json")){let d=await f.text(),h=JSON.parse(d);a.createFile(c.relativePath,h)}else if(c.relativePath.toLowerCase().endsWith(".ts")){let d=await f.text();a.createFile(c.relativePath,{source:d})}else{let d=new Uint8Array(await f.arrayBuffer());a.createFile(c.relativePath,{mimeType:f.type,data:d})}}for(const c of u)if(c.isFolder){let p=c.relativePath;p.endsWith("/")&&(p=p.slice(0,p.length-1));let f=a.createFolder(p);if(f.type=="Err")continue;let{id:d}=f.value;await new Promise(h=>{Pt(m=>{let g=a.openFolderById(d);ge(se(g,y=>{if(y.type=="Pending")return;if(y.type=="Failed"){console.log(y.message),m(),h();return}let b=y.value;(async()=>(await i(c.name,b),m(),h()))()}))})})}}await i("",t)}return ke({})};var Nd=Z('<div style=flex-grow:1;overflow:auto;><button class="btn btn-primary">Share Virtual File System</button><br><button class="btn btn-secondary">Delete Virtual File System</button><br><br><b>Links:</b><br><div><div><button class=btn>Kitty Demo</button><button class=btn>Pixel Editor</button><button class=btn>Level Builder</button><button class=btn>Music Editor</button><button class=btn>Model Editor</button><button class=btn>Script Editor</button><button class=btn>Colour Picker</button><button class=btn>Reactive Simulator</button><button class=btn>Vector Editor</button><button class=btn>Gravity Test</button><button class=btn>Three Body</button><button class=btn>Virtual File System Test</button><button class=btn>Automerge WebRTC Test</button><button class=btn>Connection Management</button><button class=btn>Debug Projection</button><button class=btn>App</button><button class=btn>Auto Forms Test'),Od=Z('<button class="btn btn-primary">Import Virtual File System<input type=file hidden>');const Fd=e=>{let r=pd();return(()=>{var t=Nd(),n=t.firstChild,i=n.nextSibling,o=i.nextSibling,a=o.nextSibling,l=a.nextSibling,u=l.nextSibling,s=u.nextSibling,c=s.nextSibling,p=c.firstChild,f=p.firstChild,d=f.nextSibling,h=d.nextSibling,m=h.nextSibling,g=m.nextSibling,y=g.nextSibling,b=y.nextSibling,w=b.nextSibling,v=w.nextSibling,k=v.nextSibling,_=k.nextSibling,S=_.nextSibling,P=S.nextSibling,T=P.nextSibling,$=T.nextSibling,x=$.nextSibling,I=x.nextSibling;return n.$$click=()=>{e.onShareVfs()},o.$$click=()=>{window.confirm("Are you sure you wish to delete your virtual file system?")&&e.onDeleteVfs()},Y(t,()=>me(()=>{let F;return(()=>{var N=Od(),R=N.firstChild,O=R.nextSibling;N.$$click=()=>{F.click()},O.addEventListener("change",()=>{let B=F.files;B!=null&&B.length==1&&Md({file:B[0],vfs:e.vfs})});var L=F;return typeof L=="function"?ve(L,O):F=O,N})()}),l),c.style.setProperty("margin-left","10px"),c.style.setProperty("margin-top","10px"),c.style.setProperty("display","inline-block"),p.style.setProperty("display","flex"),p.style.setProperty("flex-direction","column"),f.$$click=()=>r("/kitty-demo"),d.$$click=()=>r("/pixel-editor"),h.$$click=()=>r("/level-builder"),m.$$click=()=>r("/music-editor"),g.$$click=()=>r("/model-editor"),y.$$click=()=>r("/script-editor"),b.$$click=()=>r("/colour-picker"),w.$$click=()=>r("/reactive-sim"),v.$$click=()=>r("/vector-editor"),k.$$click=()=>r("/gravity-test"),_.$$click=()=>r("/three-body"),S.$$click=()=>r("/vfs-test"),P.$$click=()=>r("/automerge-webrtc-test"),T.$$click=()=>r("/connection-management"),$.$$click=()=>r("/debug-projection"),x.$$click=()=>r("/app"),I.$$click=()=>r("/auto-forms-test"),t})()};$e(["click"]);class zd extends Gu{peerId;peerMetadata}var On={},Ot={},Kr={},yo;function Dd(){return yo||(yo=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.default=["other","new","good","old","little","great","small","young","long","black","high","only","big","white","political","right","large","real","sure","different","important","public","possible","full","whole","certain","human","major","military","bad","social","dead","true","economic","open","early","free","national","strong","hard","special","clear","local","private","wrong","late","short","poor","recent","dark","fine","foreign","ready","red","cold","low","heavy","serious","single","personal","difficult","left","blue","federal","necessary","general","easy","likely","beautiful","happy","past","hot","close","common","afraid","simple","natural","main","various","available","nice","present","final","sorry","entire","current","similar","deep","huge","rich","nuclear","empty","strange","quiet","front","wide","modern","concerned","green","very","alone","particular","bright","supposed","basic","medical","aware","total","financial","legal","original","international","soft","alive","interested","tall","warm","popular","tiny","top","normal","powerful","silent","religious","impossible","quick","safe","thin","familiar","gray","fresh","physical","individual","willing","crazy","sick","angry","perfect","tired","wild","moral","brown","dangerous","famous","married","terrible","successful","fair","professional","official","obvious","glad","central","chief","effective","light","complete","interesting","thick","proper","involved","responsible","narrow","civil","industrial","dry","yellow","specific","sharp","sudden","direct","following","growing","significant","traditional","slow","previous","vast","surprised","busy","usual","clean","funny","regular","scientific","ordinary","ancient","senior","sweet","future","annual","secret","equal","independent","wonderful","tough","broad","additional","careful","domestic","brief","enormous","commercial","grand","average","sexual","nervous","pale","immediate","critical","proud","like","complex","separate","considerable","still","extra","expensive","guilty","active","mad","asleep","wooden","cool","presidential","apparent","weak","essential","living","pretty","cultural","useful","actual","unusual","daily","potential","wet","solid","lovely","comfortable","formal","outside","massive","sad","corporate","distant","loose","rare","stupid","visible","liberal","flat","pleased","pure","curious","practical","upper","technical","male","appropriate","fat","just","due","mere","handsome","mental","conservative","positive","leading","naked","false","drunk","dirty","friendly","constant","well","used","emotional","internal","odd","historical","female","ill","broken","capable","southern","pleasant","bare","minor","eager","lucky","urban","steady","fiscal","rough","primary","reasonable","typical","inner","favorite","attractive","slight","innocent","limited","straight","pink","excellent","double","dramatic","violent","honest","electric","fellow","substantial","opposite","awful","severe","joint","armed","hungry","remarkable","increased","gentle","illegal","middle","bitter","mass","permanent","increasing","damn","golden","correct","intense","round","northern","proposed","so-called","criminal","healthy","plain","vital","blind","native","intellectual","unknown","extreme","existing","raw","prime","brilliant","sensitive","extraordinary","sufficient","remaining","ultimate","unique","royal","initial","negative","fundamental","nearby","smart","strategic","educational","unlikely","smooth","modest","conventional","giant","scared","cheap","dear","delicate","anxious","valuable","standard","desperate","lonely","diplomatic","firm","wise","principal","congressional","occasional","ugly","vice","radical","faint","working","absolute","intelligent","racial","mutual","silly","fast","musical","tight","complicated","numerous","crucial","square","contemporary","bloody","western","endless","inevitable","environmental","constitutional","rapid","worried","lost","genuine","temporary","democratic","rural","regional","given","painful","literary","chemical","sophisticated","decent","academic","awake","conscious","revolutionary","surprising","elderly","agricultural","psychological","pregnant","live","adequate","superior","grateful","prominent","frightened","remote","overall","stiff","harsh","electronic","spiritual","okay","closed","excited","convinced","long-term","unexpected","dull","evident","civilian","mysterious","romantic","impressive","continuing","exciting","logical","peculiar","exact","widespread","foolish","extensive","evil","continued","confident","generous","legislative","stable","vulnerable","elegant","embarrassed","hostile","efficient","blond","dumb","advanced","defensive","outer","neat","estimated","wealthy","dying","loud","creative","acceptable","unhappy","sheer","competitive","concrete","reluctant","precious","tremendous","burning","precise","uncertain","holy","artificial","vague","ideal","universal","moderate","subtle","mild","peaceful","assistant","invisible","casual","crowded","crude","running","classic","controversial","ridiculous","frequent","grim","accurate","detailed","goddamn","fun","fierce","cruel","incredible","blank","dim","suitable","classical","elaborate","collective","eastern","legitimate","aggressive","rear","administrative","automatic","dependent","ashamed","distinct","fit","clever","brave","ethnic","maximum","relative","primitive","uncomfortable","profound","sacred","biological","identical","furious","loyal","rational","mechanical","mean","naval","noble","ambitious","purple","historic","dominant","suburban","developing","calm","frozen","subsequent","charming","damp","fixed","rigid","offensive","electrical","shy","continuous","urgent","weary","immense","splendid","downtown","uneasy","disappointed","helpless","voluntary","polite","junior","gross","striking","overwhelming","unconscious","steep","outstanding","tender","tragic","costly","miserable","near","useless","welcome","external","helpful","weekly","middle-aged","suspicious","old-fashioned","technological","damned","awkward","visual","organized","ideological","orange","horrible","strict","magnificent","deadly","dusty","mighty","puzzled","bold","global","passing","magic","fond","judicial","missing","definite","changing","rubber","theoretical","satisfied","promising","abstract","excessive","comparable","fatal","distinguished","inadequate","slender","artistic","known","sympathetic","favorable","cheerful","faithful","delighted","unnecessary","sole","cautious","productive","reliable","patient","sensible","desirable","depressed","atomic","able","instant","relevant","alien","spectacular","lesser","swift","comic","enthusiastic","marvelous","experimental","weird","retired","fascinating","content","medieval","inclined","bored","ruling","flying","consistent","organic","alleged","grave","smiling","realistic","amazing","exotic","symbolic","confused","underground","spare","philosophical","vigorous","troubled","shallow","amused","lively","genetic","impatient","brutal","solar","unfair","formidable","tense","unfortunate","minimum","sleeping","secondary","shiny","jealous","insane","gay","vivid","wounded","hurt","intimate","monthly","sour","socialist","worthy","preliminary","colonial","middle-class","alternative","influential","unpleasant","comprehensive","devoted","upset","secure","absurd","neutral","frightening","profitable","fragile","civilized","slim","partial","added","fearful","optimistic","isolated","eternal","vocal","beloved","alert","verbal","rising","skilled","antique","municipal","written","restless","outdoor","governmental","driving","sore","informal","loving","retail","hidden","determined","monetary","convenient","thoughtful","colored","progressive","bizarre","sweeping","fancy","expected","fantastic","editorial","intact","bottom","multiple","well-known","nasty","protective","acute","combined","related","fortunate","earnest","divine","passionate","icy","noisy","vicious","dreadful","apt","boring","unprecedented","decisive","sunny","marked","experienced","disturbing","satisfactory","sober","random","electoral","shocked","deliberate","coming","orderly","surrounding","unwilling","inherent","mixed","naive","dense","hopeless","aesthetic","supreme","encouraging","institutional","solemn","stubborn","required","relaxed","bald","frantic","exclusive","rotten","filthy","flexible","explicit","glorious","lean","ignorant","extended","embarrassing","architectural","mortal","corrupt","hopeful","regulatory","valid","characteristic","tribal","capitalist","diverse","functional","improved","ironic","graceful","unaware","respectable","eligible","lousy","established","postwar","objective","wary","elementary","moving","superb","cute","minimal","meaningful","notable","structural","developed","rolling","fashionable","persistent","distinctive","terrific","thorough","skeptical","secular","chronic","level","everyday","visiting","infinite","short-term","terrorist","youthful","unemployed","forced","liquid","explosive","rude","colorful","renewed","semantic","astonishing","passive","heroic","gleaming","indifferent","vertical","prior","anonymous","absent","customary","mobile","uniform","solitary","probable","amazed","petty","bleak","athletic","tentative","harmless","ample","right-wing","polished","obscure","sincere","dried","intensive","equivalent","convincing","idle","vacant","mature","amusing","competent","ominous","savage","motionless","tropical","blunt","drunken","delicious","lazy","ragged","longtime","nationwide","startling","civic","freezing","muscular","circular","imperial","irrelevant","countless","gloomy","startled","disastrous","skinny","hollow","upward","ethical","underlying","careless","wholesale","abandoned","unfamiliar","mandatory","imaginary","bewildered","annoyed","magnetic","dazzling","lengthy","stern","surgical","clinical","full-time","metropolitan","moist","unlike","doubtful","prosperous","keen","awesome","humble","interior","psychiatric","clumsy","outraged","theatrical","educated","gigantic","scattered","privileged","sleepy","battered","meaningless","predictable","gradual","miniature","radioactive","prospective","aging","destructive","authentic","portable","bearded","balanced","shining","spontaneous","bureaucratic","inferior","sturdy","cynical","exquisite","talented","immune","imaginative","ripe","shared","kind","parliamentary","glowing","frail","astonished","forward","inside","operational","faded","closing","pro","coastal","shrewd","preoccupied","celebrated","wicked","bourgeois","marginal","transparent","dynamic","psychic","plump","coarse","bleeding","striped","eventual","residential","hysterical","pathetic","planned","fake","imminent","sentimental","stunning","worldwide","militant","sizable","representative","incapable","provincial","poetic","injured","tactical","selfish","winning","foul","repeated","novel","dubious","part-time","abrupt","lone","overseas","grey","varied","cooperative","muddy","scheduled","legendary","arrogant","conspicuous","varying","devastating","vulgar","martial","amateur","mathematical","deaf","scarce","specialized","honorable","outrageous","confidential","fallen","goddamned","five-year","feminine","monstrous","brisk","systematic","exhausted","frank","lunar","daring","shadowy","respected","stark","accepted","successive","pending","prolonged","unseen","uniformed","wretched","sullen","arbitrary","drastic","crooked","resulting","intricate","unpredictable","printed","utter","satisfying","delightful","linguistic","shabby","statistical","accessible","prestigious","trivial","waiting","futile","prepared","aged","misleading","cognitive","shocking","childish","elected","magical","forthcoming","exceptional","gifted","stricken","fiery","cardboard","shaky","conflicting","commanding","starving","accustomed","rocky","long-range","floating","sinister","potent","phony","lasting","understandable","curved","barren","lethal","toxic","deserted","ambiguous","notorious","synthetic","worthwhile","imported","intent","reduced","painted","taut","sociological","questionable","crisp","pointed","harmful","horizontal","rival","somber","benign","prevailing","selected","organizational","excess","dedicated","veteran","implicit","prudent","plausible","confusing","smoking","large-scale","subdued","constructive","marital","scarlet","rugged","darkened","untouched","above","matching","covert","communal","sticky","affluent","energetic","stale","controlled","qualified","reminiscent","shut","blonde","handy","ritual","straightforward","terminal","dizzy","sane","twisted","occupied","finished","opposing","sly","depressing","irregular","marine","communist","obscene","wrinkled","unsuccessful","gracious","static","consecutive","reserve","exposed","scholarly","sleek","reckless","oral","comforting","pressing","swollen","viable","carved","obsessed","projected","hideous","unthinkable","mock","susceptible","respective","goddam","downward","memorable","worn","raised","glittering","beneficial","lingering","patriotic","stunned","hairy","worrying","lighted","sexy","abundant","tangled","perpetual","irresistible","terrified","compelling","unmistakable","feeble","uneven","trained","folded","relentless","killed","gorgeous","conservation","serene","eerie","premature","dismal","competing","risky","unacceptable","indirect","witty","muffled","feasible","interstate","heated","uncommon","accidental","queer","innovative","parallel","fried","unnatural","cracked","persuasive","integrated","ongoing","homosexual","sound","fertile","canned","preceding","worldly","onstage","declining","advisory","juvenile","slippery","numb","postal","olive","eccentric","lay","chilly","shrill","ceremonial","registered","boiling","contradictory","irresponsible","then","industrialized","obsolete","rusty","inflationary","split","discreet","intolerable","barefoot","territorial","outspoken","audible","adverse","associate","impending","decorative","luminous","two-year","expanding","unchanged","outstretched","momentary","good-looking","cunning","overnight","sprawling","unbelievable","bland","liable","terrifying","televised","appealing","breathless","alarming","supporting","greasy","affirmative","guiding","homeless","triumphant","rainy","stolen","empirical","timid","provocative","knowledgeable","pragmatic","touching","desired","amiable","attempted","humane","adjacent","superficial","greedy","assorted","elusive","ruthless","lush","soothing","imposing","preferred","lavish","pervasive","managing","sandy","inappropriate","desolate","nude","reassuring","shimmering","first-class","unfinished","insistent","comparative","conceivable","admirable","courageous","aristocratic","meager","subjective","vain","disgusted","dual","towering","responsive","ailing","compact","torn","sortal","entertaining","dreary","metallic","tedious","irrational","immoral","teen-age","interim","jagged","selective","volatile","cozy","unanimous","unlimited","hired","cosmic","indoor","retarded","gold","fabulous","dignified","long-distance","high-school","classified","luxurious","insufficient","pious","incomplete","oblivious","imperialist","stately","lifelong","subordinate","extravagant","intrinsic","unpopular","scant","surplus","radiant","ruined","grotesque","hazardous","disabled","intriguing","worthless","reported","hoarse","utmost","muted","bony","disgusting","monumental","pleasing","sterile","agreeable","three-year","tricky","lucrative","respectful","inexpensive","bulky","troublesome","affectionate","coherent","unreasonable","nineteenth-century","curly","indispensable","nursing","incompetent","governing","alternate","suspected","left-wing","refined","overt","chilling","virtual","devoid","perverse","enduring","outright","overhead","unnoticed","nonprofit","pointless","appalling","dental","chosen","enlightened","robust","commonplace","damaging","conscientious","eloquent","erratic","applied","merry","ardent","flowing","incoming","chaotic","noticeable","pitiful","locked","swelling","definitive","homemade","super","pronounced","kindly","prone","attentive","unstable","unrelated","charitable","armored","unclear","tangible","medium","winding","slick","credible","frustrating","shifting","spacious","day-to-day","surviving","expanded","arid","unwanted","unbearable","hesitant","recognizable","multinational","abdominal","murderous","glossy","mute","working-class","insignificant","ingenious","masculine","blessed","gaunt","miraculous","unconstitutional","parental","rigorous","bodily","impersonal","backward","computerized","four-year","unmarried","wry","resident","luxury","high-level","partisan","powerless","seasonal","self-conscious","triple","onetime","ecological","periodic","racist","exaggerated","facial","erotic","unreal","durable","manual","rounded","concentrated","literal","mystical","stimulating","staggering","tempting","last-minute","erect","feudal","head","emerging","hind","brooding","candid","paranoid","defective","linear","immortal","shattered","unsure","swinging","compatible","ghastly","investigative","rosy","convicted","sensational","committed","makeshift","tolerant","forceful","supernatural","joyous","limp","improper","hanging","sliding","renowned","tattered","nonexistent","supportive","frustrated","undercover","handicapped","apprehensive","plentiful","authoritative","sustained","disappointing","hereditary","photographic","impoverished","ornate","respiratory","substantive","acting","nutritional","unofficial","innumerable","prevalent","dire","menacing","outward","brittle","hasty","sparkling","sled","geographical","therapeutic","melancholy","adolescent","hearty","disturbed","sweaty","poisonous","paid","ineffective","humorous","burly","rebellious","reddish","stout","teenage","eminent","rhythmic","physiological","guaranteed","opaque","folding","fleeting","full-scale","low-income","infectious","stringent","stained","beige","stirring","soaring","glamorous","airborne","improbable","austere","anticipated","designated","oval","restrictive","yearly","precarious","relieved","said","feverish","occupational","holding","speculative","abnormal","challenging","healing","boyish","forbidding","divorced","famed","sluggish","struggling","united","undesirable","steaming","consulting","answering","recreational","accompanying","cramped","journalistic","neighboring","fictional","chopped","phenomenal","bankrupt","illicit","advancing","upcoming","racing","protected","padded","venerable","fuzzy","behavioral","roast","mocking","reactionary","inefficient","packed","sloppy","sparse","foster","revealing","reverse","gaping","blue-collar","thankful","down","unimportant","traveling","corresponding","maternal","autonomous","conceptual","smoky","baked","stuffed","murky","totalitarian","ghostly","seeming","flickering","sensual","clenched","offshore","stinging","oppressive","strained","messy","executive","evolutionary","theological","damaged","unrealistic","rectangular","off","mainstream","benevolent","thirsty","blinding","loaded","applicable","unused","crushed","tan","factual","involuntary","brand-new","akin","scary","modified","mindless","born","feminist","integral","uncanny","aloof","spreading","watery","playful","stocky","wasted","compulsory","indignant","pertinent","incredulous","simultaneous","turbulent","framed","aching","falling","cardiac","trim","silvery","accused","pastoral","barbed","adjoining","inspired","courteous","skillful","majestic","gilded","published","perennial","upright","seasoned","continual","papal","victorious","optical","ecstatic","agonizing","shameful","expressive","inconsistent","insulting","cloudy","defiant","restricted","approaching","aggregate","orthodox","unified","all-out","wooded","nationalist","favored","lofty","assured","smug","earthly","improving","instrumental","stray","clandestine","managerial","animated","intended","flawed","bent","clerical","outgoing","righteous","unspoken","poignant","faulty","defeated","authoritarian","treacherous","catastrophic","refreshing","unidentified","suicidal","sickly","disciplined","meticulous","preferable","trusted","hectic","husky","distraught","select","snowy","ferocious","crumpled","humiliating","divided","crippled","infamous","chic","broke","sovereign","continental","idealistic","first-rate","guarded","learned","nameless","runaway","metaphysical","senseless","boiled","needy","silver","recorded","polar","real-estate","stormy","incomprehensible","wiry","raging","composite","flamboyant","crimson","reproductive","intermediate","ubiquitous","repressive","hefty","listening","good-natured","parochial","stylish","high-tech","flaming","coronary","overweight","bathing","three-day","tidy","beleaguered","manifest","ludicrous","indigenous","adamant","placid","inept","exuberant","stony","salty","seductive","accomplished","impassive","grazing","congenial","misguided","wide-eyed","revised","bass","sonic","budgetary","halfway","ensuing","admiring","palpable","nightly","hooded","best-known","eighteenth-century","dissident","morbid","incumbent","demanding","inexperienced","hazy","revolving","rented","disadvantaged","innate","dietary","minute","cultivated","sealed","contemptuous","rhetorical","conciliatory","articulate","jobless","macho","forgotten","lifeless","proven","latent","secretive","perilous","token","graphic","alcoholic","overdue","permissible","shattering","preventive","illiterate","back","atmospheric","thermal","quaint","negotiated","preposterous","temporal","restrained","triangular","mayoral","spatial","heady","biblical","fitting","pessimistic","mammoth","allied","failed","intuitive","nagging","tidal","angular","speechless","finishing","protracted","watchful","businesslike","automated","versatile","booming","pouring","misty","deceptive","sunken","singular","suspended","unworthy","immigrant","expressionless","airy","mournful","neurotic","cubic","unauthorized","economical","fund-raising","captive","blatant","far-reaching","subversive","imperfect","jolly","inaccurate","resentful","strenuous","suffering","hardened","malicious","unjust","perceptive","newborn","promised","differing","virgin","alarmed","grassy","frivolous","apologetic","wasteful","endangered","unarmed","adept","unavoidable","approved","trembling","stuck","high-ranking","crushing","prescribed","dependable","fragrant","expansive","unfriendly","covered","bemused","digital","probing","sloping","man-made","festive","unilateral","unmarked","bipartisan","statewide","burgeoning","devout","sickening","mediocre","adventurous","elevated","suggestive","accountable","virtuous","lame","heavenly","bruised","unbroken","irritable","affected","inconceivable","sometime","vile","baggy","timely","glistening","imagined","unprepared","unresolved","windy","humanitarian","overriding","detached","annoying","narrative","interminable","appalled","penal","unsatisfactory","instinctive","variable","cumulative","obedient","deficient","colossal","unaffected","extinct","routine","microscopic","compassionate","nominal","forlorn","distorted","mistaken","enclosed","infected","fervent","analogous","frigid","instructive","appointed","one-way","gnarled","problematic","sardonic","two-hour","hypothetical","prompt","anguished","electromagnetic","sensuous","homely","beaten","malignant","rotting","concealed","peripheral","creaking","impeccable","khaki","grinning","irreversible","rampant","wondrous","inward","manufactured","grisly","cooked","discriminatory","cerebral","knowing","auxiliary","operative","losing","genial","phonetic","ecclesiastical","sarcastic","incorrect","ruddy","well-to-do","inexplicable","unreliable","developmental","woolen","agitated","lyrical","consequent","calculated","molecular","pompous","present-day","shaggy","even","inhuman","sublime","diagnostic","manly","raucous","balding","after","bilateral","mounted","blackened","assembled","separated","gaudy","evangelical","darling","juicy","impotent","receptive","irritating","pulmonary","dazed","cross-country","unavailable","parked","habitual","lexical","lowered","unwise","planetary","throbbing","enigmatic","superstitious","threatening","manned","childlike","sporting","right-hand","adult","reflective","white-haired","discernible","celestial","prodigious","translucent","equitable","epic","frayed","arduous","flimsy","penetrating","howling","disparate","alike","all-time","deformed","comical","inert","procedural","resistant","vibrant","geographic","wistful","specified","rightful","spirited","unborn","enjoyable","regal","cumbersome","burned","frenzied","gubernatorial","deteriorating","haunted","evasive","neglected","anthropological","inescapable","clear-cut","visionary","bloated","accumulated","agrarian","pained","dwindling","heightened","gray-haired","distressing","grinding","insecure","archaic","piercing","fluent","leisurely","giddy","slimy","oncoming","short-lived","spinal","wholesome","unanswered","illegitimate","staunch","two-day","rumpled","speedy","soaked","rocking","invaluable","gallant","tacit","finite","inviting","sporadic","powdered","cheery","volcanic","optional","mischievous","flowered","contagious","automotive","inflated","mythic","analytical","infrared","two-week","binding","ancestral","dissatisfied","upstate","veritable","unaccustomed","oily","monotonous","seated","feeding","fluorescent","undue","impassioned","picturesque","vocational","tranquil","tumultuous","rustic","patterned","two-story","pagan","flash","playing","exhilarating","maiden","three-dimensional","mythical","thriving","drab","black-and-white","honorary","dingy","founding","imperative","indistinguishable","lightweight","avid","dreamy","everlasting","obsessive","tional","homogeneous","inner-city","changed","tame","colorless","haggard","implacable","altered","unequal","focal","perceptual","literate","priceless","diminishing","harmonious","dark-haired","fatty","squat","undecided","banal","fruitful","pioneering","innocuous","cordial","rewarding","unsafe","maritime","overcrowded","timeless","fledgling","nostalgic","abreast","one-time","humid","astronomical","one-man","deepening","blazing","fleshy","dishonest","succeeding","qualitative","needless","rickety","joyful","stated","ambivalent","hybrid","six-month","limiting","workable","sleepless","unpaid","mundane","flashy","stagnant","bumper","recurring","sinful","immaculate","synonymous","measured","thrilling","long-standing","unruly","bewildering","unfit","edgy","numerical","sumptuous","fragmented","puffy","elastic","high-pitched","momentous","woven","unsteady","unnamed","cosmetic","snap","impenetrable","floral","waving","promotional","tenuous","lonesome","embroidered","strident","cherished","aghast","fundamentalist","white-collar","afloat","disruptive","law-enforcement","gathered","indefinite","intervening","publicized","geometric","disciplinary","descriptive","wavy","edible","disgruntled","obligatory","untrue","amber","snug","resolute","awed","simplistic","grandiose","crippling","high-speed","mounting","glaring","small-town","cavernous","hushed","wage-price","demographic","diseased","unpublished","causal","defenseless","sheltered","dormant","compulsive","loved","willful","truthful","punitive","disposable","ajar","drowsy","statutory","tanned","proprietary","informed","unheard","decision-making","transient","unlawful","dour","negligible","underwater","optimum","illusory","imaginable","borrowed","divergent","looking","exempt","contentious","forbidden","cowardly","masked","crazed","silken","parched","furry","wandering","insensitive","over-all","elated","waxed","veiled","envious","insidious","scrawny","unwarranted","lithe","abrasive","pretentious","far-off","murdered","deft","prickly","musty","shapeless","incongruous","gruesome","honored","perceived","grieving","unspecified","dizzying","privy","noteworthy","charred","median","fearless","twisting","unattractive","flawless","welcoming","flushed","hardy","glum","scenic","devious","recurrent","distasteful","jubilant","ballistic","hilarious","naughty","bustling","discarded","pristine","exemplary","fading","complacent","incessant","engaging","twentieth-century","protectionist","rudimentary","traumatic","steamy","emphatic","hard-line","teeming","generating","stuffy","connecting","stationary","genteel","populist","supple","hateful","retrospective","glazed","lawful","arched","tiresome","lucid","reserved","pivotal","grimy","surly","anti-Soviet","contrary","quarterly","old-time","residual","spiral","decaying","threatened","docile","appreciative","jovial","fascist","worrisome","red-haired","undisturbed","creamy","well-dressed","serial","existential","mountainous","pastel","self-sufficient","spoken","express","tasty","maroon","infrequent","deceased","full-fledged","transitional","leafy","gravitational","furtive","prophetic","nasal","unwelcome","troubling","immobile","merciful","uncontrollable","impartial","unfavorable","attendant","associated","high-rise","vascular","fateful","concerted","rash","stubby","paramount","impulsive","fraudulent","drooping","reciprocal","usable","fast-food","touchy","astute","oversized","mottled","slack","fruitless","unhealthy","decorated","shady","shaped","fanciful","quivering","charismatic","sordid","oppressed","inaccessible","fastidious","brazen","gloved","crumbling","underdeveloped","scarred","rambling","incipient","remedial","derelict","incompatible","fanatical","smoked","secondhand","hypnotic","failing","marching","flattened","paradoxical","unskilled","esthetic","tolerable","pungent","substitute","soggy","terse","tiring","fictitious","manageable","inventive","haughty","normative","premier","grudging","vested","exhausting","cross-legged","self-evident","away","horrified","prolific","incoherent","quantitative","full-length","year-round","unkind","provisional","exterior","brash","inconclusive","landed","breathtaking","acrid","noted","resultant","long-time","resounding","lovable","hypocritical","plush","foggy","acknowledged","idiotic","tracking","ceramic","taxable","enterprising","flashing","wee","barbaric","deafening","orbital","lurid","dated","hated","buoyant","mating","pictorial","overlapping","lax","archetypal","manic","limitless","puzzling","condescending","hapless","meek","faceless","uncommitted","horrid","greenish","unorthodox","unending","accelerated","day-care","undeniable","bushy","searing","fearsome","unharmed","divisive","overpowering","diving","telling","determining","uptight","cast","enlarged","ebullient","disagreeable","insatiable","grown-up","demented","puffing","inconvenient","uncontrolled","inland","repulsive","unintelligible","blue-eyed","pallid","nonviolent","dilapidated","unyielding","astounded","marvellous","low-cost","purposeful","courtly","predominant","conversational","erroneous","resourceful","converted","disconcerting","oblique","dreaded","indicative","silky","six-year","front-page","biting","flowering","sunlit","licensed","unspeakable","adrift","awash","identifiable","girlish","zealous","spooky","uncompromising","deserving","driven","certified","unlucky","temperate","budding","impractical","public-relations","inflexible","sensory","pornographic","outlandish","resonant","belligerent","wan","leftover","spotted","soybean","easygoing","vengeful","proportional","inaugural","dank","screaming","heterosexual","sliced","year-old","considerate","thunderous","distressed","warring","assertive","foreseeable","psychotic","intermittent","anti-Communist","generalized","unable","molten","excruciating","illustrious","voluminous","offending","trustworthy","grating","laughing","one-year","industrious","uninterrupted","dashing","speaking","metabolic","flattering","one-sided","ineffectual","primal","digestive","taped","floppy","jaunty","practiced","walled","hospitable","dutiful","melodramatic","intestinal","cluttered","conclusive","complementary","unprotected","buzzing","attributable","tasteless","forthright","wily","hourly","delayed","sweating","affable","studied","chubby","thyroid","chilled","conducive","childless","faltering","authorized","buried","land-based","observable","hurried","curving","dismayed","pernicious","upturned","believable","questioning","syndicated","pharmaceutical","high-risk","resigned","discrete","likable","imprisoned","cocky","outdated","autocratic","ablaze","askew","grammatical","wintry","incidental","matter-of-fact","disputed","exorbitant","low-level","sodden","skeletal","disproportionate","soiled","cellular","ephemeral","perfunctory","inconsequential","flourishing","intentional","two-way","elemental","whispered","four-day","stinking","informative","tenacious","outlying","virulent","horrendous","horrifying","burnt","longstanding","senile","unmoving","deprived","interpersonal","intimidating","posh","dainty","portly","nondescript","inquisitive","exiled","capricious","scandalous","severed","debilitating","widowed","horny","sallow","up-to-date","self-contained","carefree","boisterous","coordinated","anti-Semitic","superfluous","metric","expressed","enchanting","disorderly","paternal","wanton","frightful","free-lance","extremist","lined","scornful","inseparable","obese","ponderous","imperious","indistinct","adrenal","belated","rippling","valiant","livid","mystic","cracking","subterranean","invading","rusted","esoteric","red-faced","segregated","lanky","departmental","allergic","predatory","enforced","anti-inflation","implied","flagrant","best-selling","haphazard","trailing","seedy","real-life","unannounced","utilitarian","roving","despairing","immature","simulated","embattled","poisoned","patronizing","baffled","centralized","weathered","weeping","mutilated","painstaking","tax-exempt","socioeconomic","tearful","stringy","projecting","low-key","single-minded","shadowed","vehement","darn","fluffy","apocalyptic","completed","intelligible","furnished","elongated","worsening","eclectic","bacterial","earthy","sagging","wide-ranging","face-to-face","settled","dogmatic","anti","secluded","baffling","coy","pathological","echoing","bridal","autobiographical","instantaneous","ornamental","satirical","voluptuous","movable","kinetic","merciless","tireless","three-month","unconcerned","impromptu","turning","follow-up","retaliatory","arcane","waterproof","justifiable","glassy","unearthly","shuttered","inverted","bogus","petrified","simmering","guided","gritty","widening","generic","pretrial","returning","boundless","swirling","northeastern","swell","tive","minuscule","estranged","upbeat","explanatory","repetitive","repressed","vindictive","shrinking","canny","little-known","hydraulic","unrelenting","looming","supersonic","justified","lukewarm","unmoved","blurred","double-breasted","sanitary","unforgettable","diligent","unconventional","ashen","wordless","stainless","inlaid","irritated","spotless","pudgy","yellowish","lateral","adopted","lowly","obnoxious","utopian","called","unimaginable","hairless","foregoing","opulent","garish","nocturnal","rousing","unexplained","cosmopolitan","milky","medium-sized","all-night","bloodshot","rueful","hard-working","crafty","familial","iced","violet","arctic","ceaseless","exasperated","warped","aquatic","gruff","terrestrial","contrasting","egalitarian","needful","spent","untrained","escalating","liberated","long-haired","abortive","syntactic","consummate","lumpy","spoiled","ten-year-old","talkative","whimsical","weighty","audio","inflammatory","deplorable","spicy","corrugated","morose","sobering","southwestern","three-year-old","methodical","prehistoric","carpeted","smelly","processed","overheated","interstellar","agile","approximate","sadistic","living-room","irate","smashed","frontal","venereal","indiscriminate","suggested","cultured","creeping","recognized","toothless","handmade","mellow","fetal","disinterested","gratifying","trusting","small-scale","intravenous","crashing","exhaustive","afire","clammy","sleazy","florid","heartless","transcendent","restored","demonic","abusive","avowed","shrunken","objectionable","tailored","arms-control","listless","polluted","palatable","funded","elective","entrenched","classy","operatic","daunting","roaring","preferential","languid","three-hour","virile","inspiring","enhanced","scrupulous","bottomless","ginger","wispy","advantageous","rapt","umbilical","uphill","ordered","enraged","detrimental","curt","exalted","hard-pressed","intangible","fussy","forgiving","facile","populous","condemned","mashed","hard-boiled","introductory","rowdy","switching","perplexing","spilled","southeastern","undulating","fractured","inherited","inscrutable","measurable","stunted","hormonal","stylized","hierarchical","air-conditioned","aimless","subsidized","paying","symmetrical","nomadic","cloudless","reigning","thatched","perceptible","anesthetic","anti-American","miscellaneous","homesick","preparatory","seven-year","big-city","decadent","searching","all-important","inanimate","senatorial","diminutive","soft-spoken","contingent","dusky","smashing","precipitous","bulging","standardized","biographical","restive","indecent","upper-class","ecumenical","interchangeable","lumbering","fascinated","untidy","indulgent","leaden","wanted","endemic","doomed","wanting","receiving","engaged","unparalleled","abbreviated","malevolent","wishful","carnival","world-wide","protruding","resplendent","stranded","structured","biased","frosty","northwestern","viral","mindful","paved","indeterminate","painless","second-floor","geological","permissive","downhill","unsuspecting","expectant","fabled","jittery","windowless","evocative","unsolved","disoriented","monastic","soluble","misshapen","antiquated","repugnant","non-Communist","retiring","shaded","combative","high-powered","resilient","antagonistic","starched","vice-presidential","speckled","lopsided","bluish","late-night","prim","unrestrained","almighty","tyrannical","unkempt","menstrual","bleached","overgrown","idiosyncratic","shoddy","hallowed","trying","halting","princely","drugged","gratuitous","descending","fatherly","avant-garde","laborious","pinched","disguised","caustic","bespectacled","handwritten","goodly","itinerant","cryptic","undisclosed","affordable","outmoded","expedient","moody","tepid","firsthand","digging","elitist","observed","chartered","slain","five-day","unimpressed","tactful","idyllic","prostrate","ramshackle","expert","deferred","undistinguished","prized","transatlantic","crystalline","tacky","haunting","nutritious","bereft","turquoise","time-consuming","sanguine","culinary","fraught","precocious","assigned","scrambled","advisable","nationalistic","long-awaited","unwrapped","unchallenged","circumstantial","pleasurable","compressed","humanistic","unforeseen","diversified","frenetic","disapproving","proletarian","conspiratorial","featureless","going","commendable","no-nonsense","chipped","surreal","salient","pissed","insurmountable","backstage","contented","indebted","adoring","one-room","prewar","potted","accelerating","thorny","possessive","abiding","ever-increasing","bloodless","high-technology","counterproductive","attracting","entrepreneurial","cooling","unoccupied","craggy","leathery","degenerate","additive","weakened","quilted","untold","incandescent","intractable","middle-income","abject","self-made","gaseous","anal","displaced","unabashed","immutable","fluttering","ten-year","bearable","stamped","darkening","beefy","petite","charging","high-quality","left-hand","age-old","checkered","stupendous","priestly","loath","endearing","exacting","correctional","freak","sneaky","disgraceful","unholy","oriental","wayward","societal","hard-core","bilingual","flipping","staid","paramilitary","heartfelt","shapely","kosher","heedless","incurable","controlling","in-house","choral","manicured","cardinal","inconspicuous","steely","vanishing","misplaced","centre-fire","enchanted","unfounded","wrecked","womanly","delirious","deposed","panicky","differential","tawny","articulated","coded","wide-open","unregulated","lenient","feathered","simplified","beguiling","sectarian","producing","tiled","inorganic","frosted","lusty","scented","rotating","grievous","dissimilar","salaried","unequivocal","strangled","grubby","alluring","downcast","restraining","unjustified","contaminated","lacy","cinematic","second-class","splintered","adorable","derisive","state-owned","requisite","fleeing","uncomplicated","motherly","inter","high-heeled","climatic","republican","unqualified","leveraged","intercontinental","uncharacteristic","compositional","unwritten","patriarchal","brusque","unresponsive","replete","corrective","reflected","scraping","doctoral","premium","deductible","alternating","amorous","overjoyed","recalcitrant","presumptuous","vaulted","declared","inexorable","groggy","diminished","restful","retroactive","presumed","monolithic","curtained","tortured","ground","trendy","brassy","prosaic","inactive","chaste","bumpy","aggrieved","corny","centrist","trapped","noxious","jerky","concomitant","withholding","poorly","stolid","unguarded","methodological","primordial","retreating","telescopic","sidelong","off-duty","pleated","dissenting","agreed","double-action","optimal","plaintive","banned","kindred","quintessential","impervious","jumping","disenchanted","observant","congested","second-rate","reasoned","extrinsic","infantile","transitory","coveted","small-time","doctrinal","incomparable","jaded","special-interest","sociable","shameless","coloured","ascending","fraternal","queasy","wont","exhilarated","salted","disquieting","listed","unchanging","nine-year-old","unrestricted","uppermost","reputable","dummy","skimpy","crusty","corrosive","bubbling","decrepit","unsuitable","snarling","destitute","illuminating","systemic","material","unwashed","rushing","dialectical","jeweled","attached","liberating","judicious","errant","vanished","worn-out","erstwhile","uninformed","twelve-year-old","longterm","petulant","twin","self-righteous","afflicted","snappy","tantamount","sworn","unethical","drained","hydroelectric","perplexed","logistical","concentric","unifying","lunatic","invincible","diffident","inexhaustible","discouraging","dreamlike","artful","rolled","suppressed","secretarial","smoldering","redundant","forensic","million-dollar","self-styled","earned","weightless","signed","compensatory","glacial","unmanned","stalwart","funky","intensified","uninterested","submerged","urbane","glib","ascetic","contractual","warlike","high-priced","diagonal","cylindrical","gargantuan","illuminated","unconditional","hulking","supplementary","dictatorial","puny","sedate","moonlit","eight-year-old","gullible","counterfeit","alienated","spinning","analytic","nimble","adaptive","individualistic","numbered","blissful","insolent","supplemental","delectable","inordinate","unbalanced","tormented","unchecked","aspiring","punishing","self-serving","crossed","discretionary","box-office","snow-covered","improvised","squalid","orphaned","grizzled","unsmiling","disappearing","affiliated","readable","blocking","bullish","contending","burned-out","bloodied","subsidiary","complimentary","unclean","scanty","uprooted","farfetched","solicitous","regulated","threadbare","choppy","ever-present","negligent","nonstop","one-day","wild-eyed","infuriating","vivacious","abominable","wrought","inaudible","braided","transcendental","desultory","climactic","appellate","interlocking","submissive","unmatched","dapper","demeaning","adaptable","well-meaning","lustrous","tax-free","ungrateful","gentlemanly","missed","loathsome","incalculable","blistering","amenable","tremulous","massed","nonpartisan","unsettled","three-story","succulent","trite","masterful","reticent","unsettling","proverbial","strapping","spurious","invulnerable","paltry","embryonic","repeating","neural","sultry","metaphorical","foreign-policy","linked","pubic","beaming","ministerial","phantom","quizzical","hilly","cold-blooded","gregarious","three-piece","untroubled","bisexual","pensive","unpretentious","exploratory","unscathed","irrepressible","pelvic","newfound","starry","corned","overworked","illogical","unfaithful","interrelated","saintly","overcast","connected","ungainly","organizing","carnal","philosophic","nationalized","fickle","ultraviolet","crass","undeveloped","unprofitable","sheepish","archaeological","out-of-town","balmy","spongy","infallible","callous","scathing","rheumatic","audacious","participating","swarthy","hand-held","comatose","modernist","stellar","antinuclear","delinquent","time-honored","presiding","relaxing","high-pressure","impetuous","hypodermic","fringed","favourite","unscrupulous","inspirational","mystified","wobbly","intrepid","deferential","burdensome","stored","supervisory","seventeenth-century","six-day","interdependent","updated","all-powerful","unitary","stand-up","laconic","penniless","steadfast","dogged","scholastic","convertible","mingled","sorrowful","symptomatic","stylistic","well-intentioned","consuming","sketchy","weakening","generative","atrocious","first-quarter","irrevocable","charged","stoned","dividing","apathetic","debatable","uncomprehending","overhanging","galloping","kinky","uncritical","suave","undisputed","spiky","inarticulate","extracurricular","guttural","impressed","departing","yellowed","discontented","adroit","high-fiber","second-hand","blinking","formless","unsavory","new-found","withered","collected","menial","unobserved","flabby","afterward","vanquished","stained-glass","hour-long","bittersweet","invalid","incriminating","commensurate","all-American","assumed","tried","cursory","absorbing","clearing","confirmed","stressful","depleted","eight-year","participatory","stripped","concave","regrettable","fortified","effortless","regressive","irreverent","collegiate","defunct","grainy","inhospitable","gripping","grizzly","restoring","arterial","busted","indomitable","demure","rabid","headlong","blue-green","bound","breezy","materialistic","uneducated","scruffy","cohesive","full-blown","cranky","motivated","mauve","hardworking","melodic","genital","decorous","comely","rife","purported","hurtful","six-foot","macabre","odious","convulsive","well-trained","heterogeneous","curled","pearly","spindly","latter-day","innermost","clipped","checked","masterly","laughable","naturalistic","tinkling","impudent","fitful","illustrated","speeding","roasted","in-depth","helluva","vigilant","empty-handed","forged","wrought-iron","disgraced","agonized","infirm","preserving","tasteful","onerous","shredded","impregnable","slanted","tainted","opened","first-time","machine-gun","bottled","seismic","fetid","saturated","insubstantial","full-page","aromatic","stingy","promiscuous","unlit","regimental","spellbound","streamlined","bereaved","ruffled","creepy","treasured","ensconced","one-party","well-educated","pert","mercantile","all-purpose","voracious","tortuous","despised","unadorned","offhand","qualifying","manipulative","indelible","well-established","revolting","ethereal","roasting","prohibitive","domed","whipped","overstuffed","garrulous","skittish","revived","heartening","jumpy","grilled","melted","unfocused","spectral","unproductive","top-level","life-size","three-way","negotiable","disloyal","turn-of-the-century","four-hour","unopened","devilish","amorphous","antiseptic","sharpened","primeval","unrecognizable","ineligible","expendable","deathly","auspicious","insoluble","inimical","unquestioned","far-flung","medicinal","deep-seated","formative","iridescent","fragmentary","distinguishable","auburn","closed-circuit","emeritus","third-floor","hazel","tumbling","departed","obstinate","portentous","quixotic","scorched","adjustable","winged","intrusive","taxing","high-ceilinged","barbarous","decreasing","sleeveless","unattended","tight-lipped","concluding","unobtrusive","starved","quirky","big-time","sooty","copious","stalled","scriptural","unconvincing","earthen","throaty","august","extant","sexist","exultant","cancerous","psychedelic","yielding","matched","chunky","unfathomable","concise","admitting","knitted","projective","euphoric","garbled","divisional","despondent","recommended","passable","vegetarian","indefatigable","irreparable","feisty","untenable","contrite","angelic","reputed","untimely","dejected","appreciable","remembered","hellish","rear-view","open-air","ill-fated","nonpolitical","factional","separatist","contributing","post-war","uneventful","metaphoric","unsound","unwitting","venomous","harried","engraved","collapsing","reformist","thematic","inclusive","cheering","springy","obliging","contemplative","unbridled","state-run","reflex","allegorical","geopolitical","disembodied","issuing","bountiful","alright","overbearing","muddled","congenital","distinguishing","absorbed","tart","french","autumnal","verifiable","grueling","crackling","aft","punishable","freckled","indestructible","imprecise","hard-nosed","thoughtless","through","proficient","pent-up","never-ending","hunted","defensible","arresting","across-the-board","spotty","orchestral","undefined","stacked","implausible","antitank","unwary","inflamed","sacrificial","oil-producing","leaky","mint","chronological","conquering","jumbo","three-week","addictive","uninhibited","substandard","contracting","degenerative","triumphal","flowery","cardiovascular","shaken","undefeated","unassuming","luscious","unperturbed","gleeful","sentencing","brawny","perfumed","mild-mannered","healthful","left-handed","rancid","well-defined","unmanageable","drowning","clinging","anachronistic","revered","enriched","capitalistic","good-by","invigorating","practicing","unsold","long-legged","unruffled","aboriginal","inane","bedraggled","early-morning","run-down","straight-backed","reverent","acquired","bestselling","top-secret","woolly","foolhardy","sticking","blue-black","impassable","overcome","coiled","front-line","tinted","acquisitive","slatted","octagonal","receding","investing","doctrinaire","all-white","caring","prejudiced","slow-moving","circulating","science-fiction","shortsighted","disaffected","lawless","chastened","lewd","rubbery","foaming","unsympathetic","ladylike","betrayed","neurological","shouting","good-sized","electrostatic","untoward","flabbergasted","citywide","unanticipated","knotted","whitewashed","year-end","enticing","migratory","multicolored","hashish","ascorbic","topless","heathen","spherical","filmy","deviant","centennial","proportionate","instructional","contrived","savvy","over-the-counter","fast-moving","measuring","uptown","compliant","favourable","unforgivable","undamaged","psychoanalytic","gebling","bubbly","ready-made","caged","ostentatious","superhuman","busing","cream-colored","self-destructive","ostensible","cobbled","whirling","released","showy","baleful","red-hot","named","monogamous","fallow","disdainful","cyclical","long-running","pitiless","diffuse","omnipresent","mossy","cutting","astounding","lyric","dark-blue","unsophisticated","indigent","coincidental","imperceptible","veterinary","coercive","multilateral","ageless","law-abiding","functioning","beneficent","crawling","overturned","steamed","comprehensible","oil-rich","undetected","ribbed","nautical","textured","fast-growing","nauseous","vaunted","paralyzed","maimed","short-range","impure","unintended","practicable","intermediate-range","unfulfilled","behind-the-scenes","backhand","voluble","goofy","apolitical","contraceptive","waning","blasted","sundry","profane","binary","rock-and-roll","ruinous","open-ended","next-door","withering","conical","flustered","decided","able-bodied","round-trip","decreased","half-empty","sponsored","riotous","stereotyped","five-minute","irreplaceable","harrowing","uninteresting","salutary","frugal","disjointed","cupped","freshwater","shaven","ravenous","bulbous","stepped-up","swaying","two-room","valued","planted","bright-eyed","unreadable","trucking","infatuated","dysfunctional","pinkish","futuristic","airtight","unseemly","sizzling","mercurial","conic","unfettered","undisciplined","unrecognized","well-publicized","income-tax","self-appointed","ice-cold","biochemical","contemptible","barefooted","droll","mythological","tree-lined","rearing","luxuriant","heartbreaking","tufted","well-organized","selfless","world-class","unwieldy","contested","rasping","downright","ingratiating","self-proclaimed","parasitic","graying","reformed","cautionary","untested","beaded","maniacal","eucalyptus","pliable","air-conditioning","moot","traceable","anti-abortion","antisocial","reprehensible","self-imposed","yellowing","teasing","porous","ersatz","unwavering","untouchable","underprivileged","auditory","escaping","subservient","unspoiled","anterior","fatuous","lordly","infernal","bouncing","taboo","orthopedic","spiteful","surging","nuts","esteemed","outlawed","pushy","displeased","self-confident","attainable","bowed","cast-iron","despicable","unconvinced","famished","coed","bygone","nonaligned","sectional","typed","squeaky","disparaging","cut-rate","heart-shaped","offbeat","velvety","well-worn","upsetting","leery","long-lost","horse-drawn","puritanical","payable","fertilized","predicted","allowable","peaceable","soundless","marshy","discordant","intoxicating","concurrent","uncut","tantalizing","pedagogical","accursed","two-man","connective","hawkish","ripped","cleared","double-digit","unencumbered","yawning","manifold","stopped","untreated","subliminal","grayish","gory","upper-middle-class","avenging","self-fulfilling","equatorial","saucy","barred","arch","midwestern","blue-gray","tarnished","leafless","incisive","unearned","botanical","feline","extraneous","prep","intransigent","change-minimizing","insurgent","acrimonious","thermonuclear","blue-chip","crummy","acoustic","oversize","fated","galactic","cantankerous","ill-advised","detectable","lower-class","sacrosanct","palatial","conditional","insulated","step-by-step","nebulous","two-dimensional","well-heeled","bronchial","subatomic","semifinal","first-year","dark-eyed","tinny","attacking","indecisive","anatomical","brotherly","blooming","sinuous","meditative","socalled","rheumatoid","received","bleary","half-naked","leaded","woody","averse","shuddering","door-to-door","heretical","suspect","untapped","ravaged","decentralized","rutted","ineffable","intolerant","mechanized","fortuitous","equestrian","seven-year-old","darting","consoling","modern-day","ground-floor","emblematic","lurking","two-year-old","purplish","disorganized","vaudeville","circulatory","eight-hour","presentable","anarchic","unsatisfied","labored","maudlin","trampled","gibberish","unaccountable","sedentary","heavy-duty","thrilled","tutoring","self-centered","do-it-yourself","inquiring","uncaring","disillusioned","bloodstained","surface-to-air","consular","subconscious","four-year-old","collaborative","terraced","figurative","sinewy","horn-rimmed","impertinent","hit-and-run","standby","medium-size","peremptory","incremental","first-aid","dyed","centrifugal","omnipotent","lascivious","two-month","unionized","discredited","mass-produced","feathery","self-indulgent","liturgical","enviable","fifteen-year-old","buxom","abashed","urinary","newsworthy","flailing","beastly","undiscovered","strong-willed","prenatal","brownish","announced","flaky","washed","nightmarish","broad-shouldered","short-sleeved","two-bit","self-assured","whitish","suffocating","black-haired","full-size","self-help","created","uninhabited","smokeless","no-fault","unfashionable","mushy","forested","adhesive","creased","insufferable","down-to-earth","trifling","landless","disreputable","self-effacing","sporty","confined","adoptive","monogrammed","motley","duplicate","silver-haired","rejected","undifferentiated","blasphemous","institutionalized","blue-and-white","hip","winsome","button-down","discerning","abused","clean-cut","bracing","self-supporting","unsupported","premarital","flattered","studious","repetitious","marketable","anemic","meaty","airless","unhurried","galvanized","feal","peace-keeping","rapacious","bulletproof","well-placed","helmeted","packaged","court-ordered","aggravated","gastrointestinal","hand-to-hand","sixteen-year-old","fretful","fourth-quarter","conquered","satiric","nutty","befuddled","humorless","pitched","burnished","mirrored","fishy","fluted","conditioned","military-industrial","one-story","barbarian","branching","dynastic","unthinking","unconscionable","hunched","post-World","capital","putative","incendiary","shaving","topical","self-satisfied","farcical","narcissistic","kneeling","born-again","old-line","amateurish","ill-fitting","scaly","unpainted","eroding"]),Kr}var Jr={},bo;function Ld(){return bo||(bo=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.default=["man","world","hand","room","face","thing","place","door","woman","house","money","father","government","country","mother","water","state","family","voice","fact","moment","power","city","business","war","school","system","car","number","office","point","body","wife","air","mind","girl","home","company","table","group","boy","problem","bed","death","hair","child","sense","job","light","question","idea","law","word","party","food","floor","book","reason","story","son","heart","friend","interest","right","town","history","land","program","game","control","matter","policy","oil","window","nation","position","ground","blood","action","wall","street","husband","fire","mouth","arm","sound","service","chance","information","price","building","road","paper","court","attention","space","trouble","form","society","art","market","force","effect","nature","chair","period","order","television","president","tax","field","glass","thought","industry","process","phone","plan","center","truth","couple","decision","change","eye","campaign","issue","situation","effort","report","sun","experience","peace","letter","level","energy","role","development","result","evidence","meeting","smile","support","baby","team","show","community","brother","picture","kitchen","production","press","study","daughter","director","dinner","class","defense","piece","record","desk","stage","earth","movement","future","board","security","sea","horse","language","public","church","course","bill","river","coffee","wind","bank","corner","committee","pain","help","answer","subject","hospital","film","economy","trade","feeling","member","apartment","ship","silence","seat","gold","education","leader","pressure","doctor","shoulder","sight","scene","figure","crowd","fear","telephone","labor","success","population","style","station","value","sky","growth","foot","radio","sign","strength","capital","neck","college","budget","breath","choice","direction","guy","agreement","speech","skin","will","amount","plane","practice","marriage","audience","movie","gun","living","hall","concern","income","quality","dog","cause","hotel","race","difference","stone","box","army","trip","distance","attack","chairman","election","presence","computer","science","color","theory","spring","machine","purpose","organization","material","image","tree","surface","officer","administration","act","statement","battle","page","suit","lady","play","stock","list","freedom","bar","relationship","farm","authority","student","conference","ball","structure","nose","plant","career","wood","basis","deal","source","chest","message","stuff","middle","sister","drink","majority","sex","store","trial","character","boat","union","animal","ice","front","firm","heat","hope","rock","weight","disease","spirit","memory","king","response","manner","opinion","operation","increase","lawyer","expression","kid","bag","department","crime","train","executive","aid","dream","beginning","rain","prison","conversation","shirt","lunch","possibility","pleasure","management","danger","rule","throat","wine","behavior","return","hat","surprise","snow","property","flight","training","ability","project","camp","range","approach","agency","treatment","reality","village","bottle","attempt","crisis","drug","violence","inflation","enemy","responsibility","opposition","newspaper","victory","dress","condition","darkness","opportunity","account","degree","pocket","performance","manager","visit","threat","failure","brain","driver","charge","beer","coat","shot","metal","activity","influence","intelligence","bit","official","existence","example","truck","note","construction","shape","event","screen","faith","safety","path","culture","chief","relief","grass","contract","product","investment","weather","soul","murder","bedroom","magazine","model","cup","leg","traffic","writer","beauty","song","share","cancer","patient","credit","club","argument","speed","quarter","design","desire","vision","candidate","bottom","pattern","date","finger","teacher","tea","section","article","flesh","island","balance","spot","meaning","technology","crew","proposal","leadership","concept","object","impact","guard","analysis","birth","shop","knife","advantage","generation","appearance","variety","anger","religion","reaction","fight","star","exchange","agent","investigation","milk","judge","silver","region","steel","ear","sugar","strike","youth","hole","thinking","attitude","supply","start","jacket","jury","taste","secretary","mountain","confidence","master","artist","spokesman","demand","cigarette","track","captain","network","whole","university","conflict","noise","smoke","commission","mirror","accident","plastic","garden","debate","interview","command","tradition","protection","dust","watch","lead","solution","measure","motion","discussion","mission","opening","respect","extent","struggle","goal","tongue","moon","author","iron","breakfast","competition","cover","legislation","environment","sake","justice","fuel","hill","key","length","shock","band","version","contact","engine","settlement","mistake","restaurant","revolution","estate","camera","beach","post","pool","fashion","football","border","touch","laughter","title","background","principle","strategy","roof","forest","philosophy","entrance","pause","doubt","bird","tape","belief","card","ring","occasion","wheel","capacity","cat","collection","passage","writing","bridge","owner","novel","pride","damage","contrast","judgment","gift","division","professor","bathroom","plate","explanation","smell","district","park","wave","player","present","theater","atmosphere","emergency","leather","impression","painting","neighborhood","block","function","circle","sentence","priest","method","warning","editor","ceiling","target","tour","gate","site","baseball","airport","shadow","walk","approval","gesture","individual","difficulty","attorney","criticism","affair","request","doorway","reputation","minority","consumer","notion","general","convention","being","honor","partner","chain","commitment","weapon","joke","coal","meal","reading","detail","library","debt","other","mail","drive","fellow","profit","soldier","forehead","housing","excitement","soil","literature","pilot","dance","reform","volume","scale","imagination","challenge","desert","secret","poet","cabin","average","factor","corn","check","wonder","absence","search","wedding","yard","hero","address","confusion","fool","package","victim","fault","platform","democracy","regime","terror","nurse","stream","offer","medicine","flow","grain","row","county","self","glance","humor","promise","employment","advance","planet","recreation","trail","chicken","storm","creature","mass","stand","gaze","poetry","coast","lake","council","breast","corridor","conclusion","talent","tension","reporter","cut","appeal","total","belt","jail","passion","mayor","claim","combination","highway","wire","rifle","cheek","frame","exercise","incident","testimony","ticket","coach","connection","expert","disaster","valley","minister","deck","territory","chin","universe","independence","counter","resistance","cell","governor","salt","elevator","loan","release","schedule","porch","sheet","cloth","personality","actor","bomb","temperature","bench","break","code","journey","childhood","emphasis","aspect","pot","branch","identity","guest","arrival","recognition","hearing","lap","diet","factory","horror","fence","survey","fate","habit","lobby","bone","routine","discovery","comment","burden","treaty","knee","route","cry","ocean","fund","map","signal","ride","bear","deficit","height","element","sword","birthday","standing","cream","panel","fighting","travel","grandfather","creation","appointment","chapter","funeral","phrase","shore","planning","couch","survival","engineer","wagon","suggestion","waste","guilt","chamber","commander","clock","establishment","flag","content","supper","consciousness","proof","pack","beard","portion","comfort","resolution","sunlight","substance","benefit","honey","protest","prayer","stick","description","device","cloud","display","uniform","gasoline","tail","satisfaction","blanket","mess","consumption","drop","invasion","theme","mystery","belly","association","prospect","port","pipe","reference","skill","rear","heaven","destruction","worker","concentration","file","flat","cab","consideration","uncle","customer","laugh","radiation","favor","studio","boss","transportation","wage","fortune","tent","poem","procedure","clerk","surgery","percentage","expense","cap","household","match","bunch","column","intention","cousin","involvement","host","definition","wheat","permission","can","warmth","draft","silk","aide","lip","conviction","rope","illness","instrument","gap","string","adult","sweat","lover","evil","faculty","enthusiasm","farmer","missile","grin","tank","expansion","emotion","waist","discipline","distinction","technique","profession","wisdom","square","laboratory","tie","review","stranger","communication","pile","arrangement","palm","ceremony","tower","sympathy","deputy","script","nomination","friendship","institution","pass","civilization","magic","client","standard","significance","sport","defeat","announcement","reduction","grandmother","bowl","closet","genius","league","citizen","delivery","button","necessity","reader","lesson","trust","green","experiment","escape","craft","pistol","limit","witness","error","assistant","grace","salary","alarm","fist","potential","withdrawal","phase","bell","perspective","rose","score","amendment","fever","tip","god","crop","vehicle","barn","symbol","tale","exception","shift","scheme","tendency","logic","license","pollution","trend","bath","focus","producer","distribution","cotton","alternative","vacation","muscle","cycle","steam","palace","harm","location","beef","shame","policeman","compromise","tube","participation","fat","item","curiosity","blade","membership","lord","departure","shade","acid","enterprise","jet","selection","jungle","bond","retirement","alliance","bow","railroad","soup","airline","divorce","sofa","gear","gentleman","robe","plot","speaker","examination","egg","handful","recovery","embassy","entry","bastard","improvement","grip","invitation","barrel","context","controversy","fiction","revenue","reply","garage","crash","collar","landscape","grief","pen","teaching","angle","trunk","acceptance","recession","abortion","explosion","application","counsel","dignity","paint","landing","mixture","triumph","stove","winner","summit","thumb","depth","feature","setting","payment","grave","notice","museum","cop","graduate","sidewalk","taxi","trick","lamp","photograph","index","tray","essence","empire","tragedy","alcohol","flower","phenomenon","contribution","shower","castle","cross","booth","lawn","intensity","abuse","determination","passenger","opera","publication","wrist","hint","learning","punishment","ad","skirt","servant","prisoner","physician","midst","purse","rank","neighbor","elbow","contempt","round","cave","coverage","weakness","panic","basketball","juice","shooting","exposure","brick","miracle","unity","accent","coalition","fur","envelope","horizon","glory","stress","delight","politician","conscience","despair","rail","virtue","parent","dispute","killing","corruption","pound","core","stake","proportion","assault","curtain","efficiency","infant","count","suspicion","complex","formation","lock","entertainment","conduct","wit","outcome","shuttle","companion","discrimination","aunt","anxiety","shelter","confrontation","tool","climate","peak","cage","darling","assumption","stability","well","flame","marketing","currency","electricity","text","regulation","comedy","automobile","scientist","cake","scandal","contest","glow","cigar","arrest","brush","boom","basement","document","assembly","output","hut","slave","marble","breathing","pitch","loyalty","affection","resignation","guide","frustration","bureau","adviser","fleet","sector","privacy","awareness","fantasy","speculation","queen","tide","brass","formula","curve","zone","skull","sin","cable","corporation","foundation","achievement","countryside","monster","killer","strain","mask","breeze","whiskey","gang","rhythm","interpretation","basket","extension","tissue","satellite","doctrine","motor","hunger","intervention","kiss","fee","portrait","drawer","analyst","economist","reflection","visitor","transit","reception","provision","slope","sheriff","tunnel","complaint","devil","liquor","throne","hook","temple","tribe","preparation","handle","shoe","origin","helicopter","ruling","injury","crack","flash","gown","jaw","hallway","consequence","depression","subway","leave","drawing","cabinet","initiative","embarrassment","holiday","wilderness","towel","purchase","indication","sink","morality","impulse","rent","enforcement","utility","detective","comparison","critic","dish","hack","photo","crown","operator","conspiracy","rhetoric","bull","inquiry","humanity","demonstration","grade","alley","male","plain","pillow","remark","beast","seed","observation","guerrilla","straw","occupation","champion","excuse","possession","kingdom","snake","nerve","roll","horn","objective","cargo","mate","offense","resort","sequence","apple","bullet","presidency","strip","stroke","pig","print","champagne","saddle","dialogue","suitcase","protein","cook","quantity","toilet","chill","ranch","squad","priority","concert","van","adventure","representative","custom","shell","pension","prince","wound","video","courtroom","suffering","clay","actress","pencil","assignment","shelf","primary","waiter","charm","wool","sweater","soap","psychology","widow","delay","obligation","therapy","sergeant","shortage","myth","collapse","delegation","wish","perception","receiver","sauce","painter","reach","dear","fabric","carrier","ladder","hatred","dancing","cottage","opponent","dealer","prosecution","whisper","spread","poll","beam","exhibition","sigh","fog","harbor","successor","relation","gallery","prize","fireplace","fighter","pit","representation","prosecutor","liberty","bargaining","ownership","root","tin","celebration","stretch","nightmare","transport","link","diplomat","flood","architect","peasant","female","lab","category","inside","tune","carpet","mercy","fraud","introduction","facility","net","temper","rug","conception","eating","legend","tourist","refusal","disappointment","sensation","innocence","transfer","powder","parade","pursuit","parlor","pine","orbit","promotion","senator","colony","cart","interior","productivity","trap","identification","ambition","hip","admiration","corpse","emperor","patch","realm","barrier","ambassador","carriage","residence","maid","gathering","switch","lieutenant","sorrow","contrary","legislature","cliff","lightning","ritual","mist","salad","separation","flour","continent","poison","elite","radar","assessment","outfit","ideology","pad","exile","praise","employee","succession","gain","illusion","option","gravity","journalist","businessman","constitution","singer","sentiment","scope","transition","warrior","cast","march","herd","intent","inspection","episode","uncertainty","spell","isolation","observer","glimpse","privilege","spy","toy","thread","margin","anniversary","irony","organ","lecture","misery","needle","revolver","composition","admission","odor","candy","bid","classroom","bride","vitamin","refrigerator","sandwich","subcommittee","rescue","lad","defendant","blast","angel","compartment","vegetable","minimum","violation","agony","edition","compensation","evolution","treasure","salesman","log","clinic","layer","pitcher","publisher","suite","estimate","airplane","tournament","trace","hammer","reward","broadcasting","running","raid","specialist","mortgage","oak","pole","rocket","aisle","brandy","bureaucracy","mustache","vessel","penalty","export","orange","ignorance","hostility","integration","motive","ban","consultant","timing","equivalent","patrol","liver","assassination","instruction","leaf","railway","freeze","mention","designer","daylight","velvet","amusement","bush","fly","cloak","copper","orchestra","mechanism","chocolate","instinct","circuit","feed","courtyard","mob","profile","bombing","retreat","favorite","revenge","infection","historian","theatre","consent","bucket","mill","insult","pregnancy","psychiatrist","employer","presentation","swing","removal","financing","destiny","label","finish","ghost","channel","equality","requirement","dock","statue","doll","fan","mistress","oven","rim","scent","restraint","frontier","twin","framework","surveillance","diamond","pie","lion","cord","posture","wallet","stool","rally","realization","banker","invention","province","colonel","ally","inspiration","encounter","makeup","certainty","venture","takeover","daddy","ratio","fatigue","verdict","pardon","caution","scream","sleeve","coin","album","acquisition","laundry","transformation","handkerchief","candle","terminal","elephant","madness","appetite","rod","manufacturer","voyage","locker","pulse","indictment","riot","giant","sample","heritage","instance","hay","cure","clan","navy","monopoly","photographer","cowboy","bishop","linen","sacrifice","mortality","dilemma","frequency","harmony","junk","component","bargain","dragon","ruler","replacement","maker","blessing","resentment","surge","costume","editorial","mansion","hood","cellar","bout","driveway","championship","ambulance","sickness","guitar","rejection","compound","launch","journal","sculpture","preference","balcony","lid","toast","chart","motel","agenda","sadness","dimension","verse","scholar","submarine","confession","carbon","thunder","canal","socialism","merchant","bolt","insight","tub","topic","wolf","ridge","shed","gambling","arrow","con","lodge","bicycle","complexity","liberation","disorder","urge","circulation","pickup","distress","spine","romance","anticipation","military","lamb","gloom","pond","republic","ballet","bankruptcy","appreciation","rebellion","custody","feast","fluid","expedition","altar","recipe","array","anguish","harvest","sack","fraction","loneliness","trailer","notebook","surgeon","slip","festival","inability","pan","clearing","making","revival","rack","flashlight","sociology","heir","segment","moonlight","reign","exploration","burst","pet","charity","bundle","assurance","murderer","thrust","conservation","confirmation","outrage","quest","grant","perfection","liquid","stance","jar","essay","addition","diplomacy","rat","outlook","capability","broadcast","cocktail","breeding","immigration","optimism","urgency","helmet","correspondent","breakdown","domain","dressing","dancer","pork","colleague","crystal","insistence","guarantee","lane","dependence","chapel","transmission","hunt","turkey","veto","canoe","interference","sailor","arena","refuge","attraction","thesis","waitress","trigger","founder","briefcase","scholarship","commissioner","stack","lift","greeting","mining","partnership","cane","devotion","thief","troop","menu","finance","coincidence","sleeping","picnic","lounge","dose","jeep","brand","reasoning","proposition","administrator","cylinder","execution","commodity","drum","bronze","staircase","pin","whistle","robbery","catch","thigh","descent","canyon","ballot","shotgun","curb","nod","continuity","shaft","guess","gossip","jurisdiction","revolt","worry","recording","repair","saw","suspect","dome","globe","runway","resident","cemetery","conversion","black","passport","cease-fire","imitation","salvation","cement","creek","nephew","buddy","lung","embrace","ink","simplicity","sunset","astonishment","butt","oath","typewriter","outline","tribute","deadline","hostage","underwear","revelation","reluctance","dread","nest","nut","disposal","disclosure","destination","terrain","procession","recommendation","recorder","potato","ramp","accounting","bat","precision","heap","justification","fork","idiot","biography","prey","ivory","rumor","toll","robot","mix","glare","seal","sweep","haven","bike","courtesy","interaction","secrecy","ham","superiority","synagogue","calendar","ledge","engagement","lace","timber","turmoil","tooth","perfume","magnitude","veteran","lemon","cutting","tomb","accord","ammunition","spear","hunter","acquaintance","grocery","coming","pump","reservation","slide","award","institute","fringe","freight","accuracy","spectrum","ski","diameter","battery","desperation","pounding","variation","ankle","pepper","encouragement","cathedral","expectation","calf","monkey","suburb","rabbit","objection","dismay","boot","pipeline","lust","firing","aggression","ghetto","armor","merger","sphere","texture","moisture","kidney","broker","auction","hose","patent","hesitation","mound","cruise","goat","declaration","regret","conductor","terrace","contention","crap","manuscript","incentive","buyer","gin","principal","steak","novelist","criminal","heel","intellectual","conservative","quarterback","collector","motorcycle","refugee","punch","cluster","clown","preacher","torture","headache","pact","lump","buying","flavor","toe","spectacle","apron","banner","convenience","import","attendant","kindness","verge","dairy","umbrella","dam","inventory","turning","homeland","remainder","gum","plight","container","diversity","drought","reporting","biology","chemistry","curse","scar","merit","spray","reactor","shield","clarity","bamboo","metaphor","vocabulary","runner","luxury","diagnosis","bunk","white","statute","knock","garment","breed","railing","zoo","rival","supermarket","streak","pavement","discomfort","congregation","twilight","bacon","slot","scarf","dime","charter","grammar","theft","sensitivity","mainland","classification","coffin","rider","competence","adoption","reserve","fascination","specialty","mike","temptation","yield","evaluation","passing","intimacy","translation","philosopher","cafe","sitting","superintendent","pill","housewife","signature","correspondence","siege","inn","leftist","injustice","assertion","restoration","registration","farmhouse","denial","endorsement","predecessor","final","demon","greed","transaction","repression","mattress","nobility","embargo","bosom","gym","tenure","addiction","apology","double","litter","nail","incidence","merchandise","volunteer","labour","basin","fiber","whip","payroll","microphone","ax","supervisor","resource","maturity","resemblance","cult","stadium","limousine","welcome","knot","probability","menace","nominee","characteristic","stare","vodka","obsession","nursery","paragraph","discourse","candidacy","battlefield","saint","hierarchy","precedent","imperialism","pope","intake","burial","freshman","rebel","mandate","clause","tile","electorate","torch","adjustment","implication","farewell","curriculum","fountain","satin","subsidiary","humiliation","slaughter","discount","crest","princess","asset","greenhouse","reorganization","irritation","ending","messenger","jealousy","breakthrough","mineral","baggage","mouse","tiger","memorandum","kit","substitute","paradise","stride","deed","accumulation","pledge","hull","projection","apprehension","glue","excellence","composer","decay","ditch","slice","beating","syndrome","parole","pony","saying","vulnerability","rental","wax","renewal","disk","athlete","warehouse","organism","disagreement","suspension","documentary","soda","availability","dedication","delegate","reminder","domination","leap","span","obstacle","counselor","taxation","grandson","banana","rehabilitation","stamp","anchor","diary","tunic","boycott","meadow","backyard","dismissal","rating","disc","glove","pasture","catalogue","inspector","exploitation","missionary","density","sail","excess","chemical","disposition","headline","wartime","atom","bartender","blue","wash","shark","negotiation","monument","mom","faction","echo","tomato","scrap","expenditure","plague","fortress","web","briefing","luncheon","vanity","ribbon","nostalgia","drill","frown","dioxide","sovereignty","sweetheart","cot","tag","laser","purity","melody","sanctuary","citizenship","poster","pal","marketplace","girlfriend","programme","retaliation","researcher","allowance","bedside","yacht","scenario","concession","offering","instructor","motivation","litigation","tolerance","puzzle","compliance","duration","quarrel","aura","crusade","salute","intellect","debut","eternity","monastery","immunity","flock","choir","stern","medal","meter","auditorium","equity","fairy","windshield","mare","conquest","razor","push","kick","battalion","generosity","whale","den","mama","emptiness","hysteria","hillside","ideal","landlord","stem","drain","temperament","orientation","spoon","associate","ash","wig","elimination","bark","boost","activist","stature","liar","vein","tract","telegram","completion","pizza","urine","hollow","ordeal","admiral","psychologist","rehearsal","questioning","musician","installation","ministry","puppet","axe","nitrogen","contractor","poker","arch","tractor","reverse","relative","buffalo","deployment","outbreak","pier","veil","summary","courthouse","academy","confinement","catastrophe","technician","specimen","bachelor","lobster","tyranny","discharge","graduation","shout","monitor","traveler","dope","user","vegetation","deposit","investigator","attic","rabbi","reversal","knight","innovation","probe","altitude","legacy","raft","boyfriend","twist","plaza","paradox","witch","folly","physicist","prophet","threshold","plaster","dentist","telescope","vault","climax","parish","balloon","probation","prescription","liability","wheelchair","blackness","colour","booze","exhibit","vest","abundance","hatch","sketch","cartoon","horseback","investor","violin","hazard","trader","stall","healing","prejudice","scorn","rum","accomplishment","limb","produce","epidemic","tumor","camel","starvation","insect","tenderness","cockpit","maximum","patriotism","chauffeur","parliament","capsule","deficiency","massacre","dessert","bail","meditation","petition","hypothesis","ruin","voter","wait","saving","imprisonment","nationalism","lawsuit","surrender","celebrity","contradiction","disgrace","betrayal","slogan","thrill","enjoyment","narrative","canopy","might","vaccine","fort","stereo","hearth","relaxation","avenue","fright","drift","width","guardian","portfolio","longing","brutality","frenzy","chaplain","chop","tactic","viewpoint","chip","banquet","closing","re-election","impeachment","wardrobe","cradle","facade","finding","tangle","adaptation","hamburger","analogy","fancy","counterpart","dissent","skepticism","gut","advocate","granite","equation","slump","vice-president","nap","foam","buildup","geography","scratch","major","preservation","folder","entity","defiance","nickel","monarchy","shack","teaspoon","chase","remedy","disappearance","foreman","seller","rag","youngster","allegiance","earthquake","columnist","goose","feather","bulb","imagery","bomber","overcoat","harassment","outsider","maze","reproduction","printing","reconciliation","kinship","grease","harp","parallel","stew","particle","accusation","criterion","garlic","boundary","scalp","recess","bearing","warrant","dictatorship","breach","bladder","elegance","fervor","disapproval","monk","tweed","loser","hen","shrug","junta","disguise","gulf","landmark","bourbon","reconstruction","decency","register","feat","hostess","workshop","accommodation","wreck","referendum","viewer","niece","flank","autopsy","boarding","grove","decoration","stain","cape","prophecy","bubble","asylum","commentary","grandeur","subsidy","seizure","badge","limitation","armchair","pro","spark","blaze","centre","split","peril","fusion","goodbye","ringing","solitude","handwriting","crossing","onion","rubber","forefinger","bait","solidarity","measurement","multitude","dump","novelty","truce","perimeter","alien","decree","opposite","constituency","maneuver","ransom","supplier","performer","murmur","coordination","hobby","dough","lantern","cherry","fox","quota","deterioration","flaw","millionaire","raincoat","skeleton","bum","washing","plantation","spotlight","arsenal","villa","sermon","compliment","podium","collision","ratification","jam","loft","theology","escort","tyrant","ore","caste","brokerage","lighter","screw","inheritance","eagle","annoyance","napkin","rationale","flurry","mall","dresser","autobiography","slate","cheer","sulfur","assortment","memorial","electron","detachment","addict","shrine","mold","rookie","astronaut","diesel","neon","heroine","clash","recollection","sweetness","complexion","stewardess","adversary","trance","virgin","screening","classic","nuisance","uprising","shipment","mug","stairway","supporter","famine","stench","click","stupidity","bug","throw","lumber","current","mentality","regiment","galaxy","patron","tap","mischief","contingent","gospel","racket","liaison","honeymoon","foliage","leak","doom","irrigation","mechanic","chef","viewing","swamp","void","mule","lottery","pastor","steward","ranking","survivor","tuition","medication","misunderstanding","prediction","forum","oppression","ale","expanse","consultation","pawn","attachment","franchise","intercom","chunk","mat","pioneer","prairie","familiarity","undergraduate","tenant","chimney","cereal","pub","packet","aftermath","outburst","habitat","federation","deduction","pageant","circumstance","discontent","microscope","sausage","coma","want","intersection","detention","shrimp","deception","illustration","manipulation","ecstasy","dash","eyebrow","ray","persuasion","builder","injunction","foe","inclination","precinct","slab","anthropologist","amnesty","loaf","radical","intrusion","dwelling","calculation","paperback","usage","paste","ashtray","shovel","capture","ferry","preoccupation","joint","filing","spit","womb","puff","quilt","squadron","playwright","rotation","lease","brilliance","burn","cough","spouse","assassin","flu","cabbage","reliance","console","carpenter","dependency","advertisement","lipstick","mahogany","disadvantage","holder","furnace","certificate","alienation","collaboration","extinction","austerity","pupil","tenor","foyer","bluff","whisky","similarity","pouch","chant","nun","hike","babe","com","input","pianist","treason","brake","shake","dividend","repetition","fisherman","pinch","persecution","brightness","disdain","sunrise","gleam","premise","shawl","kettle","forecast","recipient","strap","outlet","chalk","plywood","nickname","fulfillment","doorbell","keyboard","peanut","compass","interval","intuition","clearance","format","shuffling","dent","ambush","chatter","lettuce","harness","hiring","ache","continuation","fit","friction","pretense","velocity","tavern","abdomen","scout","splendor","barber","flap","plateau","hedge","raising","visa","dictator","housekeeper","cafeteria","enrollment","sailing","ingenuity","limp","bard","consistency","ordinance","bathrobe","gauge","strand","taxpayer","spider","coward","reservoir","brigade","self-interest","crackdown","crib","hum","roommate","traitor","blend","kitten","setup","dagger","sophistication","clout","goddess","disability","touchdown","fertilizer","punk","agitation","seminar","hitter","crust","comprehension","nightgown","gamble","freak","stump","microwave","lever","libel","playground","exhaust","abstraction","picket","diversion","advancement","bourgeoisie","coordinator","myriad","dial","diagram","sensibility","donor","endurance","prominence","playgroup","transmitter","revision","consolation","storyteller","jewel","mourning","burglary","competitor","narrator","verb","butterfly","rationality","ant","mister","satire","placement","reunion","plunge","comb","commuter","carving","hormone","creator","swim","clip","necklace","frost","fix","allocation","thickness","happening","disruption","caravan","rodeo","axis","submission","insanity","protocol","caller","porcelain","aristocracy","interrogation","boyhood","muzzle","delicacy","teenager","undertaking","textile","tailor","defence","comeback","zero","wizard","cupboard","cynicism","behaviour","holster","bulletin","broom","receptionist","listener","exemption","flicker","exam","treasury","hug","interruption","no","drugstore","roast","trifle","jerk","exclusion","inmate","contra","permit","gene","melancholy","alcoholic","trainer","perspiration","instability","doorman","deterrent","occurrence","hem","pricing","wear","hog","cushion","commune","courtship","paradigm","down","participant","triangle","apprentice","prevention","forearm","symptom","flush","newcomer","announcer","gorge","frog","platoon","hawk","rivalry","trench","geometry","clubhouse","feller","hymn","dictionary","showing","homicide","crow","pneumonia","gourmet","flannel","congress","dislike","illumination","jockey","superpower","papa","absorption","fragment","catalog","genre","hypocrisy","duel","cone","organizer","fraternity","cubicle","hardship","restriction","gasp","authorization","partition","barrage","groan","waterfront","aerial","cinema","proximity","mockery","compulsion","slum","default","evacuation","fugitive","carton","chariot","masterpiece","nylon","dialect","tee","bathtub","congressman","vapor","disturbance","mailbox","take","groin","moss","shepherd","formulation","foreigner","solo","elder","textbook","predicament","trait","reef","intruder","captivity","commotion","farce","royalty","exasperation","developer","expulsion","plaid","believer","migration","gal","fitness","idealism","galley","offensive","hometown","sophomore","clump","launching","mast","slowdown","generator","make-up","mount","worm","chuckle","prototype","catcher","crotch","interpreter","graveyard","mane","premium","cuisine","jeopardy","reassurance","vantage","condemnation","vase","blackout","token","abandonment","maple","magician","bust","syrup","cassette","pick","madman","cleaner","throng","hanging","riding","villain","squeeze","wallpaper","lime","blur","modification","clatter","anonymity","lineup","polish","accountant","setback","neutrality","modernization","borrowing","kill","dwarf","amateur","expectancy","donkey","fella","contamination","ballroom","kidnapping","popcorn","entourage","crook","ambiguity","coral","roadside","fragrance","slack","spectator","stimulation","groom","rattle","synthesis","tan","skipper","distrust","siren","spin","revulsion","signing","booster","savage","glamour","flute","civilian","flask","tug","misfortune","therapist","plug","standpoint","weed","ecology","footing","patio","decor","malpractice","residue","passageway","chopper","batch","acceleration","depot","quarry","hound","pilgrimage","deference","splash","heartbeat","rap","wedge","indicator","pretext","make","saloon","clientele","poisoning","hemisphere","grotto","ignition","cover-up","ape","transcript","blizzard","crab","ration","puck","propriety","hunch","madam","imbalance","jug","manual","raise","silhouette","sponsor","bore","volcano","crate","humility","devaluation","rocker","rainbow","chap","informant","freezer","limestone","guise","valve","appraisal","handicap","correction","bra","sinking","turnout","manure","pail","cardinal","grape","bee","rumble","miner","dissatisfaction","pamphlet","plaque","chat","injection","pulpit","platter","symphony","molecule","rib","pyramid","shudder","dissolution","vinegar","calling","acreage","chick","cuff","scrub","orphan","porter","saucer","antenna","trophy","rig","convent","good-bye","troupe","ploy","niche","veal","semester","contender","grenade","hilt","spiral","stink","marathon","boulder","treasurer","cookie","peninsula","freeway","rainfall","showdown","parody","telling","statesman","decrease","symbolism","pillar","tremor","penetration","carcass","breadth","psyche","hiss","suppression","pottery","dormitory","scare","overtime","bean","schoolteacher","timetable","buzzer","mesh","jack","marshal","windfall","lance","uterus","inconvenience","chrome","brute","gardener","whim","pearl","fold","trim","ravine","critique","adultery","stretcher","trolley","elevation","worthy","vibration","bracelet","plank","jelly","foil","wrestling","colon","layout","quotation","sting","son-in-law","jargon","likeness","knack","defect","sedan","tilt","chore","moratorium","convoy","piety","acknowledgment","formality","thud","blockade","chord","hush","takeoff","lining","marsh","manifestation","humidity","ingredient","crater","liking","pigeon","abolition","granddaughter","vintage","flourish","playoff","prostitute","prick","oblivion","sociologist","helping","locomotive","contraction","bookstore","surrogate","hippie","sherry","scotch","packing","wink","spasm","conglomerate","ensemble","dugout","insider","sect","inclusion","feedback","trumpet","massage","constituent","brotherhood","directory","newsletter","comrade","grid","turtle","restructuring","reel","spur","comet","dummy","combustion","moustache","oversight","motto","mantle","handshake","mouthful","monologue","buffet","miss","crunch","waking","gray","exaggeration","gait","clutch","courier","hangar","dive","curator","ridicule","diaphragm","tow","projector","eclipse","parcel","lure","transplant","township","squash","commentator","mentor","gutter","stint","treat","germ","infinity","impasse","burglar","proprietor","tariff","dispatch","torment","dove","superstition","going","tempo","warden","sponge","rooster","barge","gorilla","draw","wharf","stallion","countenance","orchard","navigation","tar","biographer","wheelbarrow","imposition","hurricane","stronghold","distortion","starter","rash","feud","parting","interviewer","wrongdoing","lavender","low","leash","envoy","stairwell","backup","doorstep","negotiator","heading","excursion","sewer","endeavor","backbone","rite","vine","gypsy","directive","defender","scoring","esteem","torrent","gland","consortium","nightclub","swell","employe","obscenity","cavity","pulp","lifestyle","butler","peach","tack","fossil","glitter","liner","destroyer","flyer","individuality","roller","outcry","felony","artery","cruiser","bedding","dude","bounty","blindness","bodyguard","corral","coroner","spice","martini","contingency","gag","serving","wail","wrench","sock","safe","spite","broth","trustee","moth","vice","gender","cartel","casting","puppy","prohibition","ox","sculptor","treachery","stir","printer","audit","brim","handbag","lobbyist","jolt","comedian","distraction","challenger","telegraph","homage","evasion","detector","filling","overhead","cartridge","walnut","sonar","puddle","quake","flooding","crescent","thrift","following","tanker","stoop","clergyman","opener","latitude","anatomy","convertible","arbitration","leukemia","absurdity","stab","biologist","baseman","fuse","specialization","carnival","gangster","stalemate","trickle","mallet","working","receipt","charcoal","mortar","drainage","mother-in-law","regularity","emigration","plasma","condominium","muck","workplace","roster","stroll","softness","serpent","owl","infield","sill","swallow","backdrop","fidelity","historiography","thicket","baking","omen","yell","functioning","bribe","dynasty","trough","pudding","alcove","ancestor","ripple","flint","bracket","cube","pasta","proxy","groove","commercial","holocaust","countess","scroll","bang","planting","premiere","norm","bloom","gunman","vow","arithmetic","accelerator","postcard","relish","semblance","whine","inventor","sarcasm","designation","pat","symmetry","quiet","chisel","experimentation","cutter","differentiation","stud","apathy","relay","seminary","escalation","life-style","coil","mythology","futility","intimidation","childbirth","flare","glint","rue","mural","whiff","deposition","vogue","animation","migrant","caretaker","dot","mediator","lookout","captive","blackboard","pocketbook","recourse","negation","plaintiff","shriek","obstruction","latch","manor","casualty","grunt","gambler","erection","nationality","epic","starch","delusion","linkage","provocation","avalanche","offender","melodrama","contentment","appropriation","tonic","salon","accompaniment","paranoia","grimace","communion","cancellation","pendulum","shoreline","hail","refinery","subtlety","videotape","commando","repertoire","refinement","dryer","rust","lapse","haircut","errand","ailment","reanimation","ther","tab","prom","contemplation","bin","gilt","bunker","protector","sage","hilltop","hue","blueprint","correlation","brochure","roadway","arson","remnant","breaking","bouquet","exertion","garrison","beneficiary","colt","turbulence","refuse","bravery","indulgence","assimilation","coastline","livelihood","swarm","configuration","lecturer","paw","upheaval","switchboard","sub","claw","downfall","dye","immigrant","specter","deprivation","shrink","marker","sampling","fellowship","beak","pantry","mouthpiece","gratification","qualification","finality","debacle","extortion","chieftain","speaking","totalitarianism","mole","incumbent","jumper","crush","stubble","terrorist","comic","farmland","contributor","gravy","blossom","keeper","craftsman","pavilion","obscurity","loading","affiliation","vacancy","proclamation","gaiety","yarn","enclosure","clamor","sucker","recruitment","subversion","boiler","emblem","spade","stocking","staple","vocation","sling","maniac","musket","primitive","periphery","idol","snack","antique","redemption","listing","airliner","bandage","bulge","glimmer","priesthood","diner","astronomer","ovation","kindergarten","module","lifting","radiator","booklet","resurrection","precaution","affinity","thinker","quote","turbine","tally","vise","landslide","bakery","portal","majesty","abyss","admirer","turnaround","airfield","wastebasket","lapel","pennant","complication","slick","initiation","rustle","hearse","schooner","carrot","inscription","wench","embryo","vet","poise","disintegration","procurement","speck","kite","vent","plow","homosexual","membrane","waterfall","teevee","matron","utterance","buffer","memoir","cork","recital","loathing","cameraman","throttle","insecurity","trooper","hinge","hoard","umpire","slug","mountainside","affliction","pastime","felt","sentry","denomination","mushroom","linebacker","parachute","teller","fender","trademark","specification","harem","plum","metabolism","certification","neutron","organisation","heresy","relocation","payoff","lizard","termination","dropout","torpedo","stepmother","helm","resonance","heed","progression","braid","cardboard","walkout","shiver","gust","foreground","replica","repertory","sparkle","seam","bump","substitution","rapport","casket","dew","squirrel","palate","hitch","rebirth","reverie","boon","pirate","foresight","vinyl","delta","moat","presumption","tablespoon","aroma","digging","heartland","healer","malaise","creed","archway","exterior","screenplay","examiner","parity","copyright","strawberry","outpost","bookcase","cashmere","bikini","sheaf","pastry","respite","divinity","impossibility","legislator","saga","thump","inauguration","seaman","degradation","strategist","emerald","anthem","affront","burner","entrepreneur","thorn","marvel","stair","cavern","swivel","outlaw","underside","cleanup","fin","catalyst","forage","tapestry","dosage","covering","proletariat","turnover","notch","misconduct","onslaught","upbringing","coyote","bumper","champ","creep","boxer","mileage","vigil","fodder","occupant","dashboard","rarity","centerpiece","consul","ascent","paddle","martyr","doctorate","runoff","grudge","tattoo","robber","carbine","holding","oratory","distributor","heavyweight","footnote","terminology","infrastructure","drummer","chili","tableau","dung","magnet","deceit","caricature","itch","refund","cripple","rectangle","mortal","ancestry","inequality","generalization","furor","relativity","jukebox","dune","endowment","pathology","calibre","subpoena","attrition","hump","congestion","reflex","hoax","honour","herb","mantel","articulation","washer","judgement","brace","printout","helper","wording","crisp","shortstop","boulevard","characterization","cashier","matrix","documentation","deadlock","oyster","chasm","outing","expiration","heater","nutrient","beacon","bile","grievance","janitor","skyline","patrolman","juncture","antagonism","rump","hardwood","solace","warhead","assent","litany","enactment","chimpanzee","rye","feeding","suede","coke","inference","ivy","mosquito","eruption","symposium","variable","cooler","filter","storeroom","mailing","chancellor","beggar","antiquity","inertia","motif","absentee","float","blush","embankment","riverbank","demeanor","vampire","disciple","inadequacy","reinforcement","pedestrian","persona","berserker","tumult","incline","beaver","grill","morgue","denim","wreath","grouping","relic","syndicate","rancher","idiom","hegemony","seating","affirmation","physiology","repose","blight","jest","turret","slit","goalie","clarification","avoidance","volley","redhead","inefficiency","folklore","embodiment","afterthought","steer","cyanide","digestion","continuum","mania","giggle","buggy","willow","pantomime","fireman","growl","devastation","navel","halo","yearning","laborer","alligator","prelude","verification","brown","bead","midget","sleeper","riddle","portrayal","counterattack","lectern","tutor","chestnut","remembrance","aversion","taking","billing","regimen","translator","headmaster","duke","ace","snort","fanfare","imprint","calamity","exposition","cedar","intrigue","transistor","bowel","boardwalk","tramp","ornament","sticker","processor","voltage","sovereign","whistling","caliber","exuberance","snout","enclave","kilt","bombardment","corporal","overhaul","syllable","curfew","layman","consolidation","insignia","mediocrity","coherence","hospitalization","flick","pew","coloring","sanction","baritone","radicalism","savagery","pallet","stead","cadet","shutdown","supplement","unicorn","stepfather","excise","spelling","rebound","puzzlement","tenement","souvenir","veneer","safari","quartet","whirlwind","hamlet","practitioner","parasite","installment","emission","kissing","chronology","mosque","chairmanship","blonde","steamer","caption","shave","standstill","maiden","polling","condor","twinge","campfire","drinker","exhilaration","seafood","gala","crane","hickory","cathode","graph","deliberation","planner","marrow","bud","mediation","cutoff","tit","tic","parchment","noun","culprit","lair","showcase","hangover","chemist","aggregate","thriller","smack","efficacy","smear","heiress","crank","fig","finale","pea","staging","die","rebuke","curry","scum","potency","acclaim","collateral","schoolboy","canteen","radius","deportation","grate","madame","mop","pronunciation","sheen","respiration","breakup","professional","omission","gunshot","ugliness","fanatic","barbecue","dorm","trot","flattery","stereotype","hatchet","capitalist","purge","brew","totality","fern","enzyme","plumber","subscription","cholera","bruise","forge","nipple","commencement","superstar","ether","gem","sash","extraction","spaceship","golfer","realist","encampment","necktie","repayment","skillet","darky","disparity","bedspread","haul","questionnaire","promoter","wand","windowsill","victor","rector","enamel","hoop","coronation","patriot","chandelier","watchdog","glade","renovation","goblet","zipper","communique","crevice","motorcade","sequel","scourge","serum","single","icebox","junction","cache","berth","streetcar","syringe","antithesis","bureaucrat","blacksmith","oval","bun","loot","fiasco","tomahawk","ulcer","pinball","jersey","asthma","brook","pedestal","feeder","soot","inevitability","alteration","carrying","showroom","gimmick","lunatic","gall","fir","borough","hash","woe","controller","sponsorship","applicant","twig","screaming","librarian","intermission","sister-in-law","bushel","inflammation","pomp","vial","extravagance","pate","prostate","dolphin","tuxedo","mathematician","guinea","veranda","aperture","disillusionment","gavel","dating","knocking","oasis","nebula","woodland","yellow","ambivalence","hardness","oxide","socket","wasteland","leopard","blazer","follower","asking","urn","weaving","swimmer","closure","dart","loudspeaker","bazaar","bog","transfusion","reproach","sham","parka","affiliate","scowl","primate","attacker","rink","funnel","spate","elaboration","legality","tablet","heyday","tripod","bully","sharpness","demolition","flip","dandy","appliance","slant","sentimentality","knoll","gloss","defection","explorer","ram","stupor","clone","baton","cohesion","bearer","penance","bandit","aberration","gallop","swirl","coconut","spree","pedal","detergent","canon","teen","brood","phonograph","tabletop","enlargement","sniper","cohort","fable","rising","spill","affidavit","imperative","snapshot","apparition","stunt","wristwatch","chute","teammate","carelessness","over","stripe","postponement","rapture","savior","pacifist","admonition","pear","junkie","surcharge","wavelength","horseman","hag","confessional","comptroller","orthodoxy","financier","snarl","cliche","refreshment","adolescent","teapot","seaweed","drilling","roadblock","antibody","sheath","pallor","constable","misuse","arcade","lee","keep","anarchist","watering","rhyme","exclamation","backseat","great-grandfather","han","pod","daughter-in-law","mailman","alphabet","sloop","reckoning","grower","simulation","homer","birthplace","ence","actuality","depletion","novice","diffusion","concealment","cadre","pathway","fungus","ouster","loner","autograph","descendant","aspiration","better","sick","variant","fragmentation","pesticide","frigate","bestseller","propensity","foul","senate","trouser","airstrip","insurrection","chronicle","coating","stigma","toothbrush","pumpkin","apprenticeship","widower","paycheck","query","teen-ager","shifting","informer","doorknob","ardor","pebble","finesse","scrapbook","fiddle","dowager","sod","wrap","turtleneck","clipboard","rogue","mutiny","suitor","bulkhead","babble","fad","billboard","beverage","hairline","grille","exporter","pathologist","mesa","goblin","scapegoat","crucifix","backpack","observance","forgery","dungeon","methodology","gauze","bonanza","inkling","beret","shouting","ex-wife","wickedness","toil","preview","porridge","cornerstone","scanner","smoker","rebate","mite","brawl","axle","easel","allegation","grab","parrot","antidote","drawl","hijacker","telltale","venom","el","baron","intermediary","seduction","birch","contour","redistribution","cam","protagonist","enmity","hulk","stockbroker","decorator","cookbook","protege","mage","cricket","smock","apex","cortex","modem","shareholder","lament","determinism","rift","tablecloth","trajectory","preface","sneer","gamma","rendition","insemination","aristocrat","hare","labyrinth","thaw","invalid","staffer","alpha","fingernail","medic","crutch","entertainer","jade","eminence","discrepancy","yawn","flea","ledger","orphanage","getaway","manifesto","hijacking","incarnation","elm","adobe","spruce","gist","grit","boar","oracle","mobilization","cantor","crypt","cutback","musical","fallacy","corduroy","fray","racetrack","buckle","foreboding","pest","clap","ber","notation","peek","sow","ballad","brat","constellation","lard","industrialist","hunk","assailant","splinter","bridegroom","dip","fixture","cadence","watchman","windmill","prerogative","drawback","bungalow","heaving","nationalization","mating","writ","rationalization","milking","modernism","landlady","calculator","animosity","workout","skirmish","glycogen","discord","portico","vestibule","renegade","overdose","iceberg","lineage","mosaic","liturgy","watershed","playing","lobe","dowel","ranger","dossier","anvil","co-operation","satchel","fa","corollary","bridle","gateway","brothel","monotony","vendor","mysticism","saucepan","accomplice","hernia","guild","pup","hoof","sparrow","dreamer","craving","outpouring","blink","overlap","duct","brownstone","maneuvering","stagger","foothold","craze","monsoon","induction","handgun","scan","constraint","citadel","rigidity","anecdote","halter","occupancy","rightist","convict","tribunal","stalk","waterway","debtor","yoke","audition","inconsistency","peg","sliver","midwife","premonition","ruby","conduit","excavation","fart","condenser","hop","poodle","upsurge","attainment","stitch","crimson","anomaly","backlog","yeast","chimp","awning","gig","parable","drumming","tiptoe","prow","bypass","crease","reformer","intestine","counterpoint","enormity","anthology","rudder","shroud","magistrate","twitch","commonwealth","circumference","stuffing","sweating","scattering","lender","dripping","legion","refrain","mummy","covenant","morbidity","prop","initial","alignment","licence","infusion","unification","rebuttal","adjective","humour","larceny","mistrust","horde","assemblage","delinquency","testament","convert","patrician","dissension","cider","infidelity","bonnet","displacement","crackle","edifice","conciliation","bondage","schizophrenia","embroidery","standoff","monotone","oddity","mobile","tornado","semicircle","panorama","ex","ping","yogurt","screech","underdog","quay","tai-pan","extract","podesta","ticking","shrubbery","backside","communicator","sorcerer","interlude","dominion","battleground","taboo","blunder","conjecture","drone","cove","maverick","secondary","companionway","rook","gauntlet","ordering","violinist","rooftop","slash","thermometer","vomit","anteroom","deity","nave","acquittal","talker","reed","concussion","malfunction","tundra","cub","anemia","constructivist","cocoon","divide","keeping","percussion","freighter","noose","narcotic","expediency","grandchild","gully","innkeeper","pigment","bloodstream","quiver","alderman","halftime","stable","fission","aggressor","denunciation","abduction","expressway","uniformity","faucet","buff","broiler","allusion","jock","spike","herald","polyester","genocide","fer","parapet","classmate","tinge","sandstone","lurch","skunk","huddle","mum","tranquilizer","pharmacy","susceptibility","penicillin","lark","hoe","lily","hanger","headset","john","appointee","advisor","twine","slumber","magnetism","schoolgirl","smash","screwdriver","newsman","sleet","cleavage","lacquer","milestone","commandant","crick","splitting","rosary","edict","hurdle","fixation","appendix","lock-mechanism","eyelid","swath","fingerprint","carbohydrate","tick","magnate","heck","sailboat","donation","malady","polishing","clipping","collective","sensuality","loom","swagger","facet","variance","mean","walkway","aptitude","prodigy","solemnity","understatement","ebb","scoop","wrapper","narration","icon","prerequisite","planter","gash","interplay","evangelist","drip","vulgarity","subdivision","backwater","euphemism","lotion","corpus","broadcaster","toothpaste","curmudgeon","fo","thong","thatch","baptism","peacock","workman","downturn","scoundrel","machete","creak","five-year-old","dissertation","dishwasher","pimp","electrician","tycoon","otter","shove","snail","rendering","nobleman","booking","pronghorn","deadpan","shutter","escalator","girdle","fling","hire","alibi","flop","stampede","prognosis","itinerary","cologne","spoonful","detour","violet","watcher","falsehood","hype","locale","estimation","propeller","squaw","pickle","lass","pun","racist","scratching","rout","downpour","casing","complacency","camper","equator","reticence","learner","outcast","brunette","improvisation","stag","maxim","loophole","livery","blasphemy","shoot","solvent","misdemeanor","buyout","tiller","jetliner","checkbook","awakening","sideboard","romanticism","squire","newsstand","nuance","consulate","excrement","reprisal","bastion","beginner","obituary","softball","conjunction","scripture","phalanx","vindication","grub","swig","inaction","redwood","scabbard","bonfire","casserole","ovulation","unreality","totem","palette","choreographer","peasantry","skyscraper","penitentiary","outfield","melon","bounce","yolk","diver","archbishop","plurality","amber","recurrence","adulation","piston","insurgency","stoan","coop","tart","eyeball","toss","giveaway","cross-examination","dissident","hermit","ruse","ture","pore","leaving","dowry","gunner","epitome","snowstorm","summation","switchblade","crock","ity","frock","luster","piazza","rotor","impropriety","pivot","blender","immediacy","borrower","slaying","feminist","preserve","bidder","depiction","parasol","clover","intern","asteroid","stub","barricade","medley","multiplier","smirk","knapsack","hank","cognac","headway","treatise","homestead","troublemaker","giraffe","mover","allotment","drowning","naturalist","orderly","attribute","scalpel","shipyard","estrogen","educator","enrichment","grandstand","sire","sideline","landowner","confidant","gel","deviation","clemency","liberal","bigotry","filly","six-year-old","lifeguard","shred","adversity","shelling","pineapple","referee","knockout","jigsaw","retailer","extremity","outgrowth","amplifier","sinner","campground","teasing","steamboat","turban","mutton","cobra","contraption","chopping","schoolhouse","varnish","pane","observatory","ballerina","czar","immensity","lethargy","reimbursement","undershirt","concierge","fracture","variability","accordion","slime","meanness","gelding","practicality","advertiser","graft","gull","stockholder","pilgrim","hooker","puritan","benediction","barbershop","stanza","hallmark","mishap","harpy","silage","enchantment","whirlpool","conditioner","gadget","divestiture","lathe","incarceration","amalgam","antibiotic","annexation","martyrdom","pyre","shank","alert","shale","artifact","interchange","mystic","meet","grinding","triple","boutique","antagonist","fermentation","twinkle","sweetie","shin","creditor","amulet","pall","posse","homeowner","skier","vastness","smith","allegory","oxidation","cracker","levy","ark","sporophyte","enthusiast","snob","spinster","searchlight","waistband","lorry","repeat","reprieve","slalom","respirator","visor","reviewer","putt","miscalculation","shortfall","concourse","dialectic","native","hairdresser","normality","immorality","sprinkling","allure","lick","drudgery","habitation","gondola","vista","ice-cream","cheerleader","predator","countdown","juxtaposition","stumbling","muffler","derby","timer","salvage","boast","cabbie","clam","windbreaker","retardation","antelope","shampoo","raccoon","bible","glider","momma","valise","coffeepot","emissary","compression","grail","guideline","lavatory","glaze","outpatient","thunderstorm","foray","co-op","valet","baker","sycamore","thumbnail","nozzle","timidity","orator","liquidation","spokeswoman","militant","jig","naivete","motorist","dumping","armpit","margarine","exultation","headboard","plume","amplitude","flutter","pronouncement","finery","trepidation","airing","coupon","knuckle","gametophyte","deathbed","extermination","alleyway","hybrid","gambit","nova","binge","original","froth","lighthouse","coolant","continuance","collaborator","fuselage","profanity","whirl","saber","filmmaker","checkup","shaman","rancor","retort","earring","sieve","post-mortem","implantation","conceit","simplification","vat","proficiency","deluge","kiosk","outlay","tantrum","flooring","veterinarian","fireball","carousel","bandanna","glacier","censure","citation","oar","fridge","metamorphosis","superior","approximation","girth","tirade","grocer","holdup","forward","snobbery","cleansing","replay","recitation","facsimile","patter","jubilation","snare","frailty","rampage","pick-up","overture","tumble","residency","prevalence","repository","reentry","battleship","mutation","hammock","importation","thug","semiconductor","ballast","spurt","extreme","artichoke","convergence","circular","rigor","realignment","physique","handbook","bugle","precipice","sauna","skater","furcot","volatility","valuation","barbarian","peddler","layoff","overall","deliverance","chromosome","innuendo","lexicon","empress","polarization","dictum","fitting","impediment","piracy","crocodile","cucumber","keel","sitcom","hypocrite","roaring","encroachment","steamship","resin","fairway","eyewitness","broadside","washroom","sighting","mantra","swan","supposition","governess","upswing","rep","solicitude","rustling","invocation","heather","rectory","orchid","brocade","raiser","invective","fragility","acronym","ostrich","col","absolutism","vicar","psychotherapy","navigator","cartoonist","doe","landfill","invader","werowance","ble","flatness","locality","druid","visitation","headlight","rapist","benefactor","colonization","excerpt","nick","kangaroo","pink","buy","cascade","campsite","slander","headdress","topcoat","causality","karma","trestle","atheist","checkpoint","renunciation","eater","payload","pointer","theologian","beet","undertaker","lineman","hart","gourd","doubling","shuffle","cabaret","periscope","bodice","shootout","grandma","wildcat","proton","dioxin","sorcery","torchlight","stopover","executioner","collage","mesquite","reincarnation","kidnaping","programmer","disloyalty","muslin","throb","mint","aquarium","tel","eccentricity","purification","kerchief","warranty","rigging","breeder","nite","conservatory","fastball","magnification","spa","favour","regeneration","incision","saxophone","detriment","scam","android","coloration","bunny","restitution","rake","serf","despotism","pollen","sidewinder","upstart","revisionist","birthright","multiple","lifeline","queue","follow-up","swipe","boardinghouse","armament","travesty","stirrup","caper","chloride","crepe","primer","clich","inflection","skid","repudiation","serve","spire","peep","inducement","clothesline","fabrication","morsel","spleen","coon","bustle","crossword","back-up","assessor","biopsy","sidecar","hassle","shingle","tint","fixing","collarbone","taint","pusher","gestation","mantelpiece","vaulting","ra","peat","indignity","adequacy","genus","scrape","scaffolding","serial","neurologist","duffel","cipher","rote","horseshoe","bulldog","electrode","joker","juror","fibre","misconception","rut","connoisseur","flowering","op","flirtation","highlander","wisp","sounding","bugger","pharmacist","doughnut","toaster","pinnacle","slob","promenade","amphitheater","singsong","beau","whimper","importer","locket","watermelon","marking","beta","co-author","crossbow","atrocity","desktop","inhibition","draught","rowboat","volleyball","snowfall","extravaganza","teddy","miscarriage","storefront","toxicity","abode","hearty","handyman","centurion","phrasing","anachronism","newspaperman","annex","walker","till","volition","tributary","close-up","nook","cleric","ferment","proverb","inlet","heretic","waistcoat","duet","sniff","crewman","campaigner","wearing","grizzly","p","optimist","placard","overflow","pedigree","clang","brig","cinder","bunting","wag","dishonor","denominator","gong","siding","trilogy","deli","fluoride","questioner","squat","competency","partisan","putter","entree","cynic","tombstone","scoreboard","biscuit","souffle","homecoming","overseer","hideout","brewery","emancipation","interface","premier","auditor","troll","conscription","stout","trucker","beetle","dealing","bookkeeper","build-up","yardstick","da","polity","wick","wrinkle","private","outflow","borderline","outfielder","visage","leper","chiffon","arbor","weave","barnyard","checklist","granny","insensitivity","ex-husband","barometer","rupture","infirmary","desertion","wonderment","encyclopedia","slaughterhouse","nostril","ineptitude","implant","infatuation","laundromat","warship","rub","benchmark","polygraph","dinghy","behind","tween","filibuster","wearer","crayon","sensor","hustler","sinew","progeny","dig","pediatrician","foursome","buckskin","cornfield","safeguard","divergence","ting","coupling","dislocation","the","immersion","purchaser","cleft","overhang","booty","scuffle","rattlesnake","teacup","retinue","hallucination","potion","yeshiva","tapping","rip","multiplication","canister","gallantry","morn","thermostat","grind","aviator","ecosystem","pariah","recruit","vestige","ro","phosphate","abomination","laurel","sweatshirt","vaccination","psychoanalyst","blind","psychosis","sidekick","shopkeeper","theorist","delicatessen","sheepskin","billionaire","receptacle","salami","paddock","glen","beech","leer","mime","ty","perfectionist","seedling","wil","bind","intolerance","dint","plural","rouge","skylight","mammy","drab","microcosm","sole","organist","court-martial","matinee","bulwark","must","expatriate","stethoscope","daydream","backer","godfather","breech","artifice","auxiliary","adventurer","atrium","counterman","idiocy","grotesque","dishonesty","runaway","digit","baseline","reflector","preamble","sellout","falcon","scribe","retainer","louse","grapevine","sojourn","lash","marquee","schoolmaster","squeak","squeal","shooter","townhouse","nationalist","billiard","backfield","auctioneer","aria","avant-garde","hostler","smattering","giving","coaster","arraignment","duo","malignancy","throwback","doc","turnabout","seeker","deletion","vernacular","bulldozer","tedium","hustle","raspberry","estrangement","mutilation","styling","incinerator","wrong","shortcut","mastectomy","infringement","bonding","timbre","cameo","workroom","grassland","spraying","cooperative","tarpaulin","determinant","thyme","innocent","clique","racer","leakage","conflagration","jingle","duplicity","diaper","conqueror","committeeman","robin","reprimand","marina","cross-section","flagship","denouement","recluse","homemaker","moron","rind","gent","magnificence","dispatcher","detonation","harbour","toddler","rotunda","sedition","fell","dolly","laureate","woodsman","syndication","clot","guitarist","blemish","password","overview","eggplant","incantation","drapery","incapacity","florist","hive","civility","mod","screenwriter","intoxication","barman","ern","furrow","cant","clapboard","tumbler","walkie-talkie","pajama","vortex","defenseman","hostel","subjugation","interception","armory","fanaticism","sibling","inhalation","undercurrent","husk","mead","maw","padlock","abnormality","penguin","undersecretary","damnation","independent","airlift","peel","schoolroom","rascal","fingertip","cartilage","dichotomy","blank","lingo","clasp","racquet","acknowledgement","rebuff","bier","aerosol","taping","checkout","arse","thoroughfare","pelt","copse","keg","fissure","tern","mirage","blockbuster","balm","arbiter","shutout","schism","fluff","circumcision","insertion","pseudonym","heathen","eulogy","snowball","penthouse","kinsman","gebling","regulator","proponent","yearbook","barbarism","mutt","reopening","paunch","governorship","differential","airship","subscriber","alloy","adjunct","impairment","incongruity","pheasant","grownup","predicate","loo","sleigh","seer","flitter","sunburn","plebiscite","stockade","pout","sledge","stipulation","lordship","bayonet","wretch","vulture","postman","breaker","newsroom","consort","grinder","ballpoint","tequila","unpleasantness","wrapping","squall","adage","monograph","privation","streetlight","hilarity","sacrament","diminution","mannequin","duplication","banishment","rasp","biochemist","goatee","cranberry","sultan","blip","disservice","idealist","middleman","shaping","apocalypse","strut","oligarchy","moor","zombie","certitude","javelin","azure","turnpike","forger","commode","bleach","sideshow","banister","closeup","dysentery","steeple","offence","commandment","furlough","best-seller","filament","mountaintop","censor","snowmobile","kaleidoscope","elf","imp","slipper","lunacy","telecast","nanny","kernel","eventuality","subordination","sonnet","nitrate","foal","prank","expropriation","fedora","zigzag","resale","namesake","highlight","supplication","concurrence","medallion","jailer","loin","tread","quill","cardigan","prune","slur","surtax","internist","strait","smuggler","panacea","turd","wanderer","crude","darlin","epitaph","docking","seashore","cheeseburger","netting","provider","dispenser","intonation","marching","caress","hootch","morass","chum","sanctum","headband","powerhouse","axiom","terrier","springboard","tot","latrine","toad","clink","herbicide","figger","hick","manger","poppy","chaise","archetype","undoing","beehive","illustrator","withholding","sterility","paddy","coven","custodian","half-life","embezzlement","armoire","kickoff","possessor","rectum","sit","daisy","housecoat","pollster","policewoman","ointment","expressionist","stockpile","bombshell","impresario","co-pilot","chessboard","dazzle","scepter","archdiocese","linguist","odyssey","capitol","accession","lute","liter","multimillionaire","decoy","warp","conveyor","grandpa","ance","mumble","betterment","bullfighter","chador","ampule","indiscretion","shake-up","clarinet","catapult","normalcy","shanty","dinosaur","epithet","tang","scaffold","immunization","repairman","suntan","mu","environmentalist","nightcap","tempest","artisan","orbiter","spiel","needlepoint","geologist","humanist","stutter","perplexity","roundup","concoction","treadmill","cacophony","antipathy","blackberry","bloodbath","brassiere","allergy","hitchhiker","grunting","choke","sitter","elixir","ba","repatriation","whack","decanter","crusader","burlap","incursion","lyric","compilation","seaport","coachman","philanthropy","secretion","collie","inquest","taper","moral","quartermaster","jeweler","salutation","confluence","gullet","tram","hideaway","by-product","drybone","copulation","divorcee","mausoleum","peeling","annuity","set-up","skiff","neurosis","windpipe","buoy","glide","archaeologist","pendant","junkyard","bullhorn","porthole","quandary","irrationality","acidity","pragmatist","derivation","stylist","duplicate","panther","brigadier","introspection","depravity","keynote","vexation","psi","weighing","deserter","speculator","teak","armful","remission","precursor","sorghum","harmonica","olive","gangway","contraband","defector","purgatory","genie","expedient","crowbar","desecration","bathhouse","enhancement","tenet","seasoning","wrangling","downhill","venue","tracery","dictation","bailout","undertone","pecker","prep","forerunner","bandstand","letdown","luminosity","tonnage","catwalk","brunch","sapphire","ballplayer","wineglass","readout","genealogy","horsepower","messiah","blackjack","hemorrhage","damask","registry","gunwale","jerkin","humorist","bowler","tingle","engraving","chauvinist","spirituality","eyepiece","twang","constancy","blot","blob","chard","highschool","sportswriter","tiara","domino","contestant","migraine","newscast","mainstay","hammering","tracker","wager","offshoot","buster","informality","python","felon","imperfection","slag","convulsion","sedative","cellblock","punt","headwaiter","outhouse","monstrosity","nonwhite","override","raisin","inversion","pancake","flavour","cataract","reclamation","churchyard","pidgin","suction","chanting","aggravation","dynamo","pee","fistful","hogan","byproduct","brooch","lullaby","workday","slop","silencer","dealership","earner","anchorman","pittance","crumb","custard","rainstorm","tote","mulch","mason","earl","barroom","levee","discouragement","falsity","compressor","lodging","gynecologist","divination","calico","bibliography","cyclone","senor","gatehouse","lagoon","squirt","artwork","songwriter","derivative","supernova","divan","photon","surety","cobbler","fatality","gout","eleven-year-old","ent","cropping","mainspring","prism","confederation","weaver","neighbour","yuppie","muffin","juniper","ovum","lesbian","pi","shimmer","fax","increment","co-ordination","splashing","thanksgiving","exaltation","confiscation","fairy-tale","fudge","brief","priestess","re-creation","hydrocarbon","ford","usurper","maelstrom","spaceport","swordsman","vegetarian","newness","grad","potter","manservant","fullback","fiend","giver","subculture","debutante","striving","scorer","catechism","charger","armada","blond","paign","handball","wince","appetizer","guidebook","jog","millet","hoot","inferno","pardner","mash","mousse","mammography","launcher","battering","predilection","portent","beep","exhortation","notification","warm-up","diatribe","panda","menstruation","telex","revitalization","workingman","cordon","charmer","fumble","hamper","moralist","settler","chowder","ley","mannerism","drunkard","posting","turquoise","elasticity","abbot","bookie","tusk","paragon","precondition","rollback","lunge","conundrum","eviction","sealer","cellist","cosmology","turntable","outside","fortification","nightstand","spook","shoemaker","sac","sulfate","isle","antigen","steed","bacterium","utopia","stunner","hillock","clove","irritant","tat","memento","rung","gaffe","portraiture","solicitor","rodent","barter","intensification","gallbladder","condom","antiquarian","peck","cheering","meteor","inflow","stenographer","blinking","icing","jackass","dweller","fiesta","irrelevance","harpoon","appendage","stipend","mommy","cassock","microfilm","dead-end","vermouth","scarecrow","fielder","referral","mart","burger","ticker","hindrance","coverlet","speedboat","wafer","sluice","bellboy","hangout","figurehead","midterm","petticoat","matador","skein","beholder","flier","waiver","flotilla","smudge","inequity","mixer","sulfide","banality","roach","billy","tailgate","gaggle","softening","loincloth","gore","bib","chrissake","changer","muse","longitude","tourney","mil","aorta","poop","regression","soviet","placing","winch","apostle","constant","squabble","blimp","abdication","porpoise","puncture","workbench","parameter","conventionalist","flagpole","unfairness","reptile","typist","bookshop","hesitancy","strongman","headland","sprint","manhole","blowing","archipelago","ideologue","slouch","poke","gush","stratum","mulatto","echelon","postmaster","sheik","emigre","alto","affectation","rad","climber","deerskin","bower","idolatry","reciprocity","sweet","wasp","dissection","baby-sitter","purple","toothpick","lyre","archer","sprawl","councilor","contrivance","flake","kynd","suffocation","damp","ware","travail","candelabra","wrestler","patina","moaning","paisley","recruiter","moderator","respondent","marmalade","bellow","harpsichord","atrophy","ejector","jetty","stripper","monorail","dramatist","hysterectomy","riverbed","revaluation","stoppage","conspirator","fetish","sunflower","cognition","scrim","rec","retriever","aphrodisiac","redneck","palsy","pullover","flywheel","roundness","peculiarity","ernment","nectar","ruck","swimsuit","curd","underclass","polka","conservationist","mire","drumbeat","cinch","cordiality","deacon","speechwriter","purr","gelatin","muddle","booby","solid","cloakroom","stopwatch","sportsman","burlesque","overload","mademoiselle","divider","bailiff","handout","ordination","stiff","languor","paperweight","opiate","snap","causation","mower","snatch","touchstone","self-indulgence","shrub","interceptor","mammoth","proceeding","cheekbone","spoke","repellent","cardiologist","reminiscence","sprinter","evocation","postscript","enlistment","blotter","troika","dacha","cabdriver","fund-raiser","switching","para","tendon","fireside","effigy","leech","veneration","reek","schoolyard","pellet","shellac","weasel","jab","carcinogen","restroom","cauliflower","levity","caftan","topside","fruitcake","bickering","drawing-room","dovetail","culvert","chateau","bugging","tinker","hobo","corset","automaker","actualization","oration","handhold","nutmeg","tentacle","quicksand","handler","panoply","bowhead","testimonial","mammal","bellhop","devotee","technicality","trainee","mongrel","newscaster","aggregation","footpath","fawn","accreditation","heave","jib","rationalist","vendetta","midpoint","buckboard","screwball","hatchway","disinfectant","cramp","causeway","tease","corkscrew","sledgehammer","sloth","materialist","mogul","stopper","bevel","carbonate","berry","snore","throwaway","agribusiness","rerun","guillotine","nip","computation","keyhole","storybook","watercolor","cer","porcupine","urging","cockroach","esse","headman","settee","usher","short","obstetrician","faggot","ballpark","palisade","whimsy","co-owner","spout","nub","pectin","dun","cypress","trombone","scat","lite","dame","quip","invisibility","baboon","sneeze","swish","originator","biennial","newsreel","chameleon","dressmaker","storehouse","trapping","statistician","bloke","helmsman","ewe","drape","trump","great-grandmother","cloister","caterer","grounding","hotbed","life-span","urinal","funk","bedchamber","boudoir","theoretician","oddball","nameplate","raven","ditty","canary","anticommunist","reconsideration","playboy","skate","transparency","uplift","six-pack","rambling","commendation","wimp","pestilence","sufferer","kelp","counterforce","self-doubt","deformity","croak","marine","marksman","directorate","reversion","stimulant","dence","beloved","eraser","slurry","tracing","bigot","compendium","entitlement","monolith","misrepresentation","darkroom","nutshell","torque","concubine","peephole","lesion","bogey","spindle","birdie","nugget","tenon","supercomputer","weakling","provenance","vowel","empiricist","filet","co-founder","prelate","onlooker","tricycle","sax","catheter","accessory","fresco","prod","oscillator","self-image","refraction","excretion","prance","insurer","cask","impersonation","rangeland","toothache","magnum","accuser","rubbing","carver","carnation","masquerade","trapdoor","shaker","mittee","tux","poignancy","payday","captor","couplet","mutant","jogger","raider","dilution","sickle","prowl","blister","reassessment","infirmity","matchmaker","workload","restaurateur","tuning","wiretap","perpetrator","davenport","lamppost","inductivist","affect","sterilization","booming","rucksack","repurchase","starship","bystander","taker","spaniel","teletype","cuckoo","sneaker","aspen","soundtrack","sacrilege","surname","succor","co-chairman","anticlimax","hopper","jumpsuit","rinse","rummy","cigaret","washcloth","butchery","almond","cooker","implement","effluent","cheat","threshing","silicone","draining","vector","shopper","dandelion","pecking","brazier","cobblestone","slugger","sacrificer","airlock","lunchroom","zebra","ejection","cutthroat","wizardry","crony","kennel","internship","cohabitation","omelet","wheelhouse","redundancy","schema","psychopath","buttock","grasshopper","playmate","lamentation","socialite","cornucopia","lichen","coterie","warlord","discomfiture","frieze","montage","traveller","curvature","condensation","vineyard","scraper","generality","archive","half-sister","gangplank","intimation","doublet","pleading","tome","quadrangle","connotation","lifeboat","blueberry","coinage","prospector","bash","disciplinarian","dualism","bookshelf","adjutant","clod","apportionment","footbridge","tourniquet","spore","slicker","jetport","magenta","schizophrenic","oilman","harbinger","trespass","merry-go-round","sabra","old-timer","vigilante","melanoma","torpor","gliding","refutation","dab","jurist","plumage","kitty","cauldron","abbey","jasmine","lefty","cabal","detonator","retiree","abatement","clamp","roost","councilman","halfback","centimeter","shirttail","whispering","stratagem","exponent","cheesecake","truism","jaunt","node","ironclad","undertow","self-portrait","urchin","idealization","splendour","antechamber","living-room","sampler","friar","irregularity","lateness","playback","binder","washbasin","tummy","capitulation","felicity","canter","birthrate","earthenware","kitchenette","foundry","ladle","babushka","chlorophyll","adjournment","villager","recrimination","hotshot","blaster","pruning","soloist","hummingbird","recuperation","bequest","hemlock","cottonwood","drawbridge","alternation","malt","interconnection","mugger","tuft","keystone","riverboat","thrall","ayatollah","highland","mistrial","bunkhouse","anesthesiologist","dredging","anode","salsa","prizefighter","neckline","chile","foreclosure","cola","digression","scythe","lout","chamberlain","minefield","sabbatical","appraiser","isotope","demarcation","garnet","buzzard","repulsion","lowland","snifter","bending","weekly","dispensation","botanist","sari","stabbing","ovary","skullcap","journeyman","thievery","look-alike","parson","heartbreak","distillate","neophyte","blower","storekeeper","firmament","taxicab","corona","fusillade","publicist","resume","breather","casement","smokestack","interrogator","outcropping","mecca","dilettante","shoestring","belch","behemoth","negligee","heath","smut","negative","fistfight","regent","incumbency","curragh","toga","ministration","turnip","beamer","stepladder","loon","businesswoman","jumbo","whining","spoor","posturing","parlour","concertina","alkali","rampart","chime","warmup","taffeta","hyena","firehouse","sweetener","guessing","pronoun","madhouse","lioness","breadwinner","diocese","escarpment","mimic","retina","larder","gnat","hothouse","ponytail","markup","bevy","revocation","depressive","garner","redefinition","lifter","stateroom","nutritionist","isolationist","surveyor","polemic","ornamentation","gouge","counterweight","thrower","illegality","joining","lumberyard","wholesaler","obeisance","stagecoach","substage","lockup","nudge","rejoinder","compost","carburetor","peacemaker","prologue","swinger","right-of-way","precipitate","sprinkler","crone","valentine","vassal","tabloid","minstrel","nursemaid","attribution","courtier","docket","spool","convocation","serviceman","letterhead","zealot","negro","cackle","masthead","dispersion","underwriting","armload","noodle","squawk","periodical","reformation","boa","starlet","about-face","ejaculation","encore","harangue","woodpile","earlobe","reaffirmation","handlebar","compunction","contemporary","midriff","nimbus","householder","postgraduate","quirk","innovator","sneak","straitjacket","pussycat","belle","kidnapper","spacing","laying","standout","estuary","duster","jackpot","motorboat","welterweight","kicker","expectant","revue","senior","epistemology","yeoman","firearm","granddaddy","projectile","stammer","crossfire","toxin","hookup","phantom","transgression","flagstone","acuity","twick","acolyte","directorship","corpsman","worktable","mammogram","wart","liqueur","unbutton","receivership","duchess","delinquent","picker","earphone","blare","promontory","formalism","infamy","operative","hock","crusher","megaphone","retrenchment","chaser","dementia","wane","triviality","quadrant","curate","pairing","forging","dermatologist","mango","bon","moccasin","hayloft","marionette","seedship","ooze","interloper","twill","solicitation","trowel","professorship","scrimmage","scrawl","blockage","parkway","motorman","snapper","transcription","vasectomy","binary","flagon","choirboy","butte","throbbing","bound","thunderbolt","dike","cowbell","elect","prodding","lynching","rant","drifter","snot","preservative","brogue","tary","tortoise","lattice","strudel","composite","churn","median","neurosurgeon","mariner","kiln","boarder","ama","petal","friendly","clearinghouse","swastika","filler","enquiry","dispensary","chump","archeologist","rescuer","dy","draftsman","snicker","shakedown","romp","construct","conclave","winery","polarity","breakin","wailing","gurgle","bedroll","commissar","albatross","shading","peal","taverna","chicanery","has-been","waistline","oaf","satirist","faint","myosin","dimple","landfall","smithy","tough","gunboat","busboy","cassava","poplar","discontinuity","obelisk","blubber","demonstrator","meltdown","abolitionist","thorax","holler","pimple","sending","druggist","indirection","leotard","ken","showman","despot","ombudsman","lyricist","dearie","lumberjack","gaff","pagan","cremation","infarction","sturgeon","publican","bottleneck","chambermaid","pectoral","purser","godsend","whisk","canard","concentrate","copter","shipwreck","laundering","clipper","notepad","jackal","indentation","basilica","adhesive","mermaid","knighthood","personage","omelette","whoosh","embellishment","misgiving","tracer","brawling","crucifixion","steal","transference","sleight","threesome","windowpane","bereavement","viceroy","betrothal","refresher","seagull","jay","needler","discoverer","goiter","caterpillar","impostor","diminutive","cation","playpen","amputation","confidante","dockside","inquisition","chronicler","seamstress","lath","absolutist","cadaver","perusal","subterfuge","self-satisfaction","sawmill","agitator","shortcoming","breakwater","microcomputer","lima","greatcoat","mahout","prima","undress","superstructure","stopgap","moo","bio","fret","pomposity","bough","autocracy","anchorage","samovar","gen","burrow","rosebud","segregationist","mortise","hydrant","postmortem","oversimplification","entryway","paintbrush","rea","balustrade","chuck","trumpeter","ferret","opportunist","pinnace","salamander","transom","mace","individualist","synthesizer","thoroughbred","cupola","tomboy","ensign","bottling","whir","poultice","entranceway","saver","gurdwara","renegotiation","tossing","ruffle","footprint","skeptic","birthmark","tailspin","kickback","chalice","plagiarism","passer","inhumanity","ceremonial","sapling","babysitter","creeper","galleon","bellman","holly","hacienda","cur","transplantation","scab","ballgame","demotion","flimsy","hovel","lug","layup","firefighter","gravestone","nymph","cajole","tickle","boxcar","secession","refractor","somersault","personification","treacle","tutorial","voucher","thimble","stickler","front-runner","paroxysm","exorcism","psalm","infestation","scrubbing","castor","peppermint","orchestration","extremist","oppressor","lode","prompting","watchword","swindle","statehouse","floater","nightdress","bloak","elegy","woodshed","trembling","banning","adornment","redoubt","lightweight","postulate","anti-Semite","tasting","viewscreen","sentinel","nation-state","heft","nurture","villainy","manhunt","invoice","sprig","self-denial","selector","piglet","commemoration","crucible","piper","curtsy","lackey","breastplate","gadfly","octave","epilogue","self-examination","thyroid","apologist","chemise","super","figment","waif","essayist","brewer","miniature","sediment","cannibal","tulip","caramel","caseload","synonym","analogue","ver","shirtwaist","cornerback","insecticide","debauchery","lien","strangulation","intricacy","guesthouse","crumbling","glassware","cachet","thumping","damper","colonist","frolic","ogre","heist","sorting","pawl","muttering","refill","cowl","imbecile","painkiller","garter","creole","overpass","simile","potpourri","piling","predisposition","corsage","mobster","sandal","aphorism","vice-chairman","heartache","converter","pecan","ecologist","substrate","quagmire","trenchcoat","voyce","overstatement","soapbox","rediscovery","effusion","agronomist","firecracker","haunt","murmuring","henhouse","fluctuation","signora","mulberry","hoist","bullfight","discotheque","finder","tureen","hairstyle","dignitary","consummation","spar","pogrom","beeper","read","outboard","sho","skit","impurity","sadist","parafoil","bouncer","spender","locust","boardroom","burnout","inoculation","surfeit","welder","propagandist","mortuary","pessimist","equivalence","juke","spatter","incubator","reproof","gulch","notary","speedometer","lodger","mitt","southpaw","footman","amity","bloodline","cleaver","coffeehouse","confederate","assist","ation","lecher","abrasion","daybed","knit","laddie","forfeit","kebele","filigree","frisbee","cantina","oscillation","countryman","juggler","scion","acrobat","hourglass","realtor","onyx","pettiness","chancellery","footfall","slippage","mandarin","eral","lob","impertinence","providence","dom","idyll","democrat","deferral","sorority","slamming","badger","mutter","ling","strobe","explosive","municipality","crossover","bedstead","spatula","tug-of-war","goon","pauper","lation","sacking","alder","nightstick","salve","infraction","prowler","falsification","pant","drunk","rumbling","ce","minuet","plaything","yelling","kiddie","duction","buttress","carapace","sobbing","insufficiency","prig","bidet","bloodhound","madwoman","buffoon","vignette","doorjamb","caprice","gable","converse","cad","creche","mullah","spectre","spotter","ingenue","chalet","automatic","stash","truckload","tailback","static","productivist","dissipation","haunch","nag","awl","self-delusion","rattler","blacklist","beagle","trapeze","obstinacy","fiddler","theorem","rearrangement","changeover","reassignment","courtesan","fillet","nay","cutout","luncheonette","purveyor","incitement","remarriage","amelioration","executor","buttonhole","duality","churchman","sickroom","farmstead","jester","perfidy","cuticle","weal","snub","pretension","roadbed","furnishing","quickie","workweek","conveyance","pseudopatient","turbocharger","fleece","abbreviation","spigot","leaflet","great-aunt","ninny","beaker","experimenter","validation","inhabitant","grading","cantaloupe","potentiality","flue","commoner","playroom","readjustment","boathouse","vivacity","brakeman","petitioner","singularity","gage","delineation","fester","paratrooper","font","pitchfork","signifier","crossbar","playhouse","tripe","stylus","pacemaker","clustering","hone","runt","emporium","ragtag","aneurysm","trapper","pulley","thrashing","candlestick","checkerboard","swoop","surcoat","dystrophy","bristle","beck","toolbox","hunchback","subcompact","doze","seaway","disclaimer","arbitrator","miller","crackpot","loafer","instigation","sen","bale","skim","skip","dollop","tender","oeuvre","goner","sor","tort","cropland","profundity","caf","zoom","gabardine","quack","cataclysm","condolence","foxhole","circlet","brave","misfit","bivouac","artificiality","dachshund","puke","bagel","sortie","nomad","opal","ethnicity","firebox","ratchet","cud","worsted","squabbling","cheque","jean","avatar","dirge","footstool","velour","barrister","pression","microchip","coda","reappraisal","cess","hangman","centenary","plough","broomstick","headstone","tormentor","sore","rathorn","voyeur","world-view","co-star","warren","fail","deflation","noble","fleck","saleswoman","hap","machinist","waffle","tom","ell","prefab","suckling","guardhouse","sabre","entanglement","integrator","quarterly","paraffin","heifer","frivolity","good","bougainvillea","excommunication","distillation","cyclist","meteorologist","rubric","cul-de-sac","misnomer","phobia","demagogue","bloodletting","raconteur","ger","astrologer","zygote","counterrevolution","reinstatement","anchovy","getup","tryout","scullery","turnstile","cyst","mustang","gaslight","self-deception","emanation","grown-up","escapade","versity","fishery","paprika","grailstone","gurney","fount","holdout","licensee","jackknife","asterisk","still","fundamentalist","humbug","repast","christening","butternut","miniskirt","fortune-teller","spillway","ference","salver","payout","nodule","high","tugboat","gizzard","sympathizer","fibrillation","incompatibility","dodge","trove","mercenary","pigtail","matchbook","masterwork","barb","endeavour","confection","ephor","yarmulke","char","mimeograph","holdover","subtitle","saddlebag","metronome","tine","testicle","caveat","etching","auntie","guarantor","ringer","airman","boatman","carnivore","armband","polder","tryst","lem","sitting-room","barrow","reappearance","pastiche","bankroll","stroller","saxophonist","blanc","redesign","plotting","gruel","juicer","slat","scooter","socialist","gradient","ember","scorecard","remembering","bo","forecaster","flirt","backache","parakeet","pixie","guffaw","anesthetist","logjam","pursuer","physiologist","follicle","coverall","patsy","bunt","lubricant","jawbone","numeral","mourner","rune","bettor","solder","nitrite","rime","pinstripe","pistachio","monocle","equivocation","crystallization","twit","two-year-old","toupee","eyelash","recognizance","cy","sophistry","seesaw","loony","do-gooder","dusting","commonality","yearling","disbarment","self-congratulation","tsar","vagabond","rhinestone","viper","planetoid","crochet","laird","flatland","prompt","catamaran","wigwam","mainframe","shivering","stringer","vane","iniquity","hoodlum","tableware","smelter","overlay","umber","placenta","yew","right-hander","laggard","cornice","philanthropist","scouring","dissenter","mainsail","showplace","conch","sentimentalist","protectorate","sanitarium","truancy","angler","showpiece","carotene","pollutant","diabetic","hairbrush","videodisc","intellectualist","pothole","setter","tense","grader","kneecap","birdbath","dell","typhoid","tuba","torturer","commie","houseboat","revelry","medalist","hinterland","jowl","splotch","sable","mouf","ripoff","coolie","streetlamp","damn","sharecropper","oral","schoolmate","commander-in-chief","capitalization","flex","shtetl","chenille","pullback","pharaoh","claret","fulfilment","glower","remuneration","internationalist","pap","pediment","sonata","toke","co-director","dollhouse","salesgirl","greenback","analog","ofa","freelancer","hairpin","aphasia","kicking","bummer","lawmaker","thickening","juggernaut","comma","sander","claimant","triad","rhizome","prolongation","placer","transvestite","faceplate","shortening","coffle","surfer","greengrocer","roughage","dumbbell","coiffure","pinky","ex-President","start-up","bobby","sidearm","paean","raiment","conceptualization","surmise","agnostic","cranny","tassel","infarct","pitchman","minor","stationmaster","sublet","puter","dramatization","mounting","washstand","counsellor","penknife","curtailment","remake","millimeter","sextant","vocalist","blowup","walleye","pickax","fanny","ascendant","brushing","highball","bandleader","winning","godmother","horoscope","disequilibrium","run-up","grazer","sandbar","motorbike","hassock","piggy","teat","reprise","wheeling","psychotherapist","calabash","cob","relativist","packer","slayer","digger","banshee","autocrat","knave","muskrat","extinguisher","foreleg","sobriquet","hospice","accretion","mastermind","figurine","newsmagazine","epidemiologist","pic","minaret","dereliction","city-state","jawline","escapist","legation","weatherman","sinker","cabby","guardrail","objector","timepiece","cistern","werewolf","decadent","harlot","epiphany","bricklayer","doorkeeper","obsidian","bedpost","constriction","refectory","blackbird","enforcer","riposte","schmuck","squab","pop-up","handrail","sandbag","superman","underbelly","alarmist","sesame","paratroop","droplet","proclivity","theorizing","quark","tactician","sundae","poolhall","behaviorist","dipper","postmark","co-conspirator","carload","electrocution","mould","goodnight","appendectomy","statuette","coefficient","cornet","scolding","prude","platitude","carport","lilac","geisha","foist","mitigation","percussionist","lechery","wyrm","charlatan","tussle","slough","jamb","twister","lakeshore","scavenger","pinkie","changeling","pinhead","muster","exploring","fief","critter","haystack","skimmer","geyser","stumble","update","tabernacle","gargoyle","projectionist","requisite","suffix","ramrod","betrayer","perience","tance","fluting","flare-up","fatherland","guardianship","douche","good-night","trawler","headsman","stoplight","operetta","spend","hater","teakettle","geneticist","particular","wardroom","slider","deuce","gingham","telethon","acclamation","centrifuge","workstation","pretender","prong","lampshade","ureter","hiccup","acetate","molding","wallop","vagrant","three-star","carafe","blowout","equinox","rave","junior","spoof","confessor","troubleshooter","braggart","judgeship","rapier","landmass","stoic","cuckold","inheritor","forester","jangle","gymnast","wingman","stein","gnome","drumstick","whatnot","yachtsman","realty","glob","by-election","academic","deflection","knocker","wondering","mugging","petit","frosting","pillowcase","panelling","grendel","tribune","tabulation","simulator","whaler","stork","gill","cavalcade","workhorse","locksmith","preppie","henchman","countertop","groundcar","puree","wellspring","debasement","prankster","tration","insert","put-down","typer","chartreuse","crematorium","headpiece","noncom","wipe","drove","sportscaster","impersonator","shrew","twitching","loader","magnolia","dropping","functionary","dissonance","cudgel","forfeiture","glutton","reject","doubleheader","tarp","suburbanite","afghan","chaperone","bas-relief","oscilloscope","imposter","newel","trusteeship","shocker","cannonball","half-breed","woodpecker","tumbleweed","snip","consignment","left-hander","spoil","also-ran","exhalation","signification","tester","ashram","gardenia","deductible","frontline","subtraction","bowstring","upland","bearskin","gramophone","mock-up","serenade","mix-up","extrapolation","tidbit","semaphore","banging","dogwood","carol","mapping","exchanger","ignominy","retraction","videocassette","precept","sirloin","mortification","pagoda","belfry","cubbyhole","mindstone","greyhound","clank","snowbank","instep","sanatorium","savanna","longshoreman","copier","nightshirt","boatyard","brigand","usurpation","understudy","interrelationship","undercarriage","sulphate","quasar","marshmallow","thrush","sweeper","alleviation","feint","chimera","infidel","modifier","perennial","simpleton","gridiron","overlord","airway","binding","abstention","algorithm","amalgamation","ascension","herdsman","lollipop","pastel","laminate","tendril","synopsis","drawstring","intermarriage","restorer","swoon","firefight","civilisation","self-criticism","hanky","ventricle","jot","interferon","circel","avenger","stepson","amethyst","beachhead","loggia","sizzle","burp","watchtower","endearment","dryad","prefect","tong","croissant","blocker","brioche","thistle","sunburst","savor","dumpling","checker","soliloquy","marketer","wheeze","molar","oboe","inbound","masochist","superficiality","tabby","outcrop","deputation","bassist","particularity","strop","thang","doggy","zation","ghoul","domestic","frostbite","relapse","floorboard","clicking","paraphrase","sinkhole","pushcart","overdraft","spinnaker","sourdough","sweatshop","meteorite","lander","caboose","junket","planer","iguana","brouhaha","reaper","sharpshooter","eggshell","self-sacrifice","minnow","skyrocket","connexion","effrontery","oblong","biker","flinch","cog","bullock","retrial","underwriter","gentlewoman","noggin","sissy","collect","dogmatism","sweatsuit","biplane","polariser","server","hiker","electrolyte","thunderclap","bronc","snooze","mascot","sherbet","carillon","decal","womanizer","underground","tailcoat","worshipper","automaton","proscription","sleuth","honeybee","abutment","foller","palladium","partake","jailing","counterfeit","pompadour","moneymaker","acacia","monthly","geographer","doghouse","bludgeon","fitter","conservator","indecency","atoll","fife","acquit","barracuda","mortician","striker","plait","untruth","hoarding","eighteen-wheeler","shakeup","grounder","abuser","hamstring","parishioner","cherub","cubist","antler","kisser","shunt","cravat","admixture","whinny","scorpion","amenity","matchup","spacer","settling","insinuation","possum","tenancy","girder","adapter","mousetrap","cubble","steppe","hypochondriac","covey","whipping","taunt","pocketful","pug","panhandle","conga","citron","foul-up","plaint","nouveau","oilskin","meridian","lifer","bolster","wren","gripe","mountaineer","transceiver","treetop","hex","harrow","tampering","photocopy","redskin","cesspool","barrette","cleanser","missive","breakfront","mini","ridgeline","semi","pasha","byword","phoneme","seducer","miser","cookstove","limerick","cummerbund","labourer","ascot","wraith","tarantula","toffee","pituitary","liana","cleat","line-up","helix","highboy","bicep","partment","coed","expletive","dumpster","deferment","progenitor","sandbox","mignon","typhoon","sublimation","backdoor","alchemist","pacifier","insomniac","hairpiece","lintel","indemnity","blurb","republican","electrocardiogram","futurist","recliner","mote","sketchbook","fulcrum","gratuity","aqueduct","adherent","masque","sundial","template","handmaiden","hedgehog","coding","corsair","solstice","orifice","sonobuoy","prizewinner","spinner","townsman","rosette","mind-set","unkindness","pushover","bility","infielder","hutch","erasure","parallelism","avowal","fastness","broadcloth","hellhole","grandparent","toehold","ident","sleepwalker","watching","aerie","database","mismatch","hombre","scrambler","spoiler","putdown","rookery","spinoff","ringleader","duchy","sealskin","transformer","doggie","bedsheet","cowhide","ceramic","prostration","cheroot","houseboy","giantess","tomcat","speedster","basalt","minicomputer","rapacity","spaceman","in-law","equerry","humpback","academician","harvester","fairground","ream","carat","entreaty","groundswell","obfuscation","provocateur","fugue","denigration","rifleman","manipulator","panting","synod","glitch","nightie","goaltender","kingpin","comforter","anesthetic","klaxon","hijack","orb","hostelry","gladiator","misadventure","bombard","fixity","tanner","stringency","wonderland","x-ray","plainclothesman","roadhouse","travelogue","gasket","nibble","hacking","nude","tincture","receptor","fink","schoolmarm","washtub","homesteader","hacker","portiere","hatbox","tamer","howitzer","grouper","frontage","amoeba","clime","flashback","teamster","accolade","polluter","officeholder","inpatient","altercation","reverberation","coproduction","phosphor","substation","bandana","sapper","preserver","pigeonhole","prefecture","milkman","avocation","argyle","amphetamine","linker","leviathan","hamster","bondsman","comer","bumpkin","sheikh","beefsteak","tyke","discoloration","kingmaker","quotient","excision","whitey","asymmetry","trill","discourtesy","bleat","hatching","crier","creel","seabed","witticism","riser","lurcher","moviemaker","pantsuit","linchpin","deformation","deodorant","soybean","washboard","egotist","underpass","dysfunction","tingling","barstool","paramour","udder","microbe","radiologist","qualm","welt","salesperson","signpost","sepulcher","lumpectomy","slaver","shopgirl","peregrine","siesta","reiteration","profligacy","iodide","iconoclast","rollcall","fillip","oratorio","splat","incoherence","accompanist","motorcar","nunnery","busybody","carryall","nettle","jaguar","pretence","odometer","potentate","mussel","prophetess","monetarist","proach","typescript","hacksaw","broadsword","miter","fatty","terrarium","archangel","powerboat","stooge","cannery","pylon","pulsation","misstep","yucca","hearthstone","rumour","lockout","toboggan","trampoline","concatenation","debility","acorn","forklift","psion","dragonet","ligament","folio","tie-up","picking","swatch","arrowhead","martinet","fisher","quintet","ellipse","legitimation","nightwatch","hardback","schemer","conversationalist","collectivist","reallocation","diorama","cutaway","point-of-view","cattleman","abscess","talc","incubus","dribble","sis","rhododendron","rolling","spiderweb","nonsmoker","crissake","refusenik","save","obstructionist","suture","parenthesis","reefer","great-grandson","steelworker","bumblebee","bullfrog","festivity","embolism","defeatist","tankard","ferryman","garret","co-worker","consonant","copywriter","bookseller","compress","dogfight","embezzler","quiche","liege","dissector","taskmaster","prosthesis","emulsion","spitball","modulation","squint","retelling","baiting","whirr","air-conditioner","individuation","geezer","aspirant","pensioner","re-enactment","flapper","looker","marshland","sexton","adverb","coenzyme","misapprehension","inaccuracy","barmaid","beautician","daredevil","racehorse","oxford","spume","busload","tradesman","manicure","propellant","apothecary","ruffian","titillation","instigator","siting","ringmaster","enumeration","twirl","bookmaker","technocrat","mouth-harp","quaver","icehouse","ventilator","roadster","subpena","carter","comedienne","savannah","milkmaid","pumper","signer","deadbeat","cofounder","bootlegger","tribesman","wildfire","shard","hailstorm","struction","routing","dolmen","idiosyncrasy","poniard","honky-tonk","spendthrift","draftee","hermaphrodite","pinafore","roundabout","frill","redeployment","ophthalmologist","caldron","reinvestment","troubadour","fjord","leave-taking","elongation","clinch","trinket","suasion","neutralist","finalist","whiplash","ventriloquist","violator","monarchist","spanking","grindstone","initiator","standard-bearer","sender","atelier","distemper","ingot","frontiersman","altarpiece","endgame","homily","synapse","pillbox","ochre","scimitar","jubilee","presentiment","tation","aggrandizement","truncheon","damsel","fallibility","papaya","piggyback","puppeteer","workhouse","nightingale","entomologist","wicket","debriefing","logician","moorland","minimalist","matte","skirmishing","tonality","maidservant","yam","gatekeeper","whammy","drudge","angora","garland","manoeuvre","moviegoer","slingshot","titan","re-evaluation","ironwork","ambassadorship","lanch","pollination","riage","vocalization","brawler","shaving","particulate","inhaler","impoundment","surfboard","waterman","almanac","pepperoni","kook","colonnade","infantryman","scruple","functionalist","wisecrack","conscript","boor","bannister","pretzel","analgesic","firebrand","microprocessor","frame-up","guardsman","teetotaler","broad","pallbearer","airframe","wrangle","backboard","knockdown","reparation","poorhouse","milkshake","battlement","dragonfly","paymaster","snuffler","crudeness","nerd","blockhouse","donut","backhoe","principality","dimmer","wounding","collier","beater","footlocker","barkeep","absurdist","brickwork","great-uncle","rumination","appellation","joiner","hydrolysis","interlocutor","raindrop","hardtop","groping","cymbal","miscellany","pomegranate","hearer","abortionist","corncob","shoal","dunce","bellowing","bridgehead","mangrove","blotch","boxwood","briar","which","trickster","epileptic","dependent","encumbrance","claque","pickpocket","half-truth","bilge","overrun","caveman","posterior","derriere","sty","maggot","vibrator","imbecility","hang-up","syllogism","blindfold","sunbeam","chrysanthemum","amour","ne'er-do-well","odour","flowerpot","satrap","reconnoiter","tonsillectomy","clampdown","coliseum","warbler","hubcap","crudity","baseboard","lithograph","homeroom","stanchion","amphitheatre","disquisition","commonplace","feedlot","reprint","shire","kraken","careerist","goatskin","worldview","waddle","washout","doormat","diadem","sniffer","spat","superhighway","snooper","libation","zoologist","subtext","bailiwick","exterminator","popsicle","actuary","cabinetmaker","swami","contraceptive","softener","margarita","hatter","tention","earpiece","dormer","timberland","katun","crooner","one-liner","adjudication","snitch","referent","subset","disavowal","starburst","merchantman","dalliance","polymer","hypnotist","monogram","peerage","claymore","satyr","twerp","matchstick","rubber-stamp","clapper","exhibitionist","warhorse","eatery","seashell","radish","router","dinette","trombonist","rivet","requiem","breakaway","hard-liner","locator","shindig","corrective","truffle","whelp","expediter","savant","mitten","canton","wobble","misinterpretation","fense","headwrap","conciliator","chine","topping","assemblyman","divine","scuffling","boomlet","dervish","yellow-green","stockyard","hummock","trimming","royalist","calumny","vandal","prickle","strikeout","apologia","afterburner","hunker","flippancy","fop","embrasure","hornet","tithe","oilfield","lawman","turnkey","fledgling","coauthor","blowpipe","subjectivist","backstop","fishbowl","bedpan","sedge","protrusion","crybaby","freedman","seminarian","spacesuit","tautology","footstep","fiveyear","stoneware","mance","generalist","quitter","domicile","requisition","seance","cabana","wastrel","underling","looter","glassful","wallow","boater","disharmony","shiksa","herringbone","flyleaf","eyesore","lawnmower","walk-up","hemline","wiggle","posing","whirring","cropper","reappointment","psychodrama","shaver","orthodontist","granary","extrovert","calfskin","thinning","foghorn","trainload","carbide","metier","harpist","minim","ballcarrier","rayon","bursting","flipper","fastening","mullet","exploit","squatter","nullity","commodore","newlywed","eavesdropper","chiropractor","miler","arsonist","wrecker","transmutation","incompetency","subcontractor","tress","meatball","bobcat","distributorship","camcorder","pasty","glimmering","groaning","classicist","stakeout","supplicant","repeater","crackling","cryptographer","croupier","honeycomb","insincerity","inhibitor","mystification","greaser","barker","anthill","barbarity","strangle","myrtle","segmentation","marlin","capon","toenail","flip-flop","auger","blasphemer","dipping","pawnshop","penumbra","mohole","bauble","rube","flophouse","triplicate","sardine","master-mason","fang","brainstorm","derangement","hanker","molestation","smokescreen","cavalryman","edging","layover","signalman","clavicle","crewcut","tricolor","cochairman","liberationist","foreskin","bleacher","semi-circle","quince","flatcar","abattoir","farmboy","tibia","thrum","conformist","southerner","docudrama","whorl","break-up","conglomeration","exhibitor","bramble","cutie","woodchuck","compatriot","stole","tuner","housemother","dharma","femme","teahouse","banquette","bottomland","arranger","philistine","vacillation","chiton","retch","caddie","reissue","teaser","swampland","deejay","libertarian","pegboard","greenhorn","dork","cellmate","jobber","wishbone","millstone","haunting","blow-up","snorkel","snowplow","trespasser","punter","snowflake","snowdrift","gunnysack","surround","evergreen","clog","radioisotope","cougar","pundit","wattle","subgroup","oviduct","mixup","misstatement","sulfite","pansy","splint","counterproposal","pulsar","remove","landau","four-year-old","rebbe","disconnection","neomort","exegesis","meteoroid","meringue","sheepherder","radioman","strumpet","opment","millionth","speakeasy","conformation","cultivator","goof","annual","gazelle","demitasse","fishhook","preferment","homebody","skewer","chancre","sorbet","hologram","rivulet","oldster","prisoner-of-war","tulle","riff","restatement","debit","emplacement","repre","invariance","half-circle","objectivist","passer-by","scarlet","flail","impala","persimmon","purist","gation","burgher","snowman","starling","barony","annulment","lifespan","herder","embolden","swathe","ex-convict","trouper","half-wit","fuchsia","grange","ricochet","stinker","opacity","colander","absorber","armadillo","pleasantry","noncommunist","taxiway","overtone","debater","taillight","advisement","birdcage","baroness","aureole","breakout","colouring","astrophysicist","flatboat","stilt","eyeshade","barbell","deliverer","fishnet","prise","jackrabbit","manifold","chattel","jimmy","workshirt","thornbush","chatty","frisson","recount","patentee","oceanographer","forepaw","murderess","whalebone","frontrunner","cerebrum","jector","militiaman","lobsterman","earthling","clean","swindler","scree","begat","doorsill","housedress","strangler","shantytown","roughhouse","scenarist","foothill","contaminant","hamadryad","phony","fairyland","seascape","treble","prodigality","hobble","gantry","backroom","enticement","sawhorse","interviewee","cliffside","dustpan","scrubber","imbroglio","acquaintanceship","woodworker","aesthete","octogenarian","mauling","archivist","pungency","interweaving","jabber","bassinet","doubler","torte","linkup","outdoorsman","fixer","caddy","fumbling","defile","meristem","microbiologist","urologist","stovepipe","tambourine","constructionist","egomaniac","adjuster","liniment","impiety","timeline","cowgirl","sinecure","chillun","foreword","frat","retary","bagpipe","coif","visualization","colleen","shirtmaker","flounce","adder","riffle","underboss","reinterpretation","bender","seeding","fiver","sicken","decoder","holothete","figuring","stave","earplug","acrylic","epigraph","fairytale","flasher","sally","inkwell","nitwit","hussy","constrictor","stabilizer","stickup","seaplane","shimmy","dredge","updraft","speciality","insulator","frond","storyboard","shill","rafter","blowgun","dukedom","favourite","populist","striper","blowtorch","mallard","licking","poetess","tetracycline","ad-lib","toxicologist","fencer","gnawing","eration","photocell","golem","heirloom","penitence","gence","latecomer","broil","outdistance","howler","canine","replenishment","traditionalist","emcee","eyeglass","billow","eyelet","khaki","assignation","tepee","buccaneer","bellyache","parkland","musicologist","phaeton","spirochete","lanyard","mischance","tobacconist","blusher","castaway","meson","bouillabaisse","scrivener","stinger","life-cycle","harridan","motivator","mooring","crimp","inlay","purveyance","vertical","jackhammer","strongbox","dishpan","cobweb","couturier","chalkboard","basilisk","duckling","penitent","footrest","tangent","facing","peroration","floodlight","nouvelle","truss","sprite","drier","esplanade","banding","insulter","dialog","pincer","battlefront","missal","hayseed","parvenu","baronet","shipwright","whisker","no-hitter","double-dealing","moire","conjurer","rickshaw","crevasse","switchback","nicety","provincialism","novella","liberator","biggie","tune-up","ferryboat","remover","twosome","loveseat","tektite","sharpener","cartwheel","diva","flirting","disproportion","tortilla","rover","whodunit","birder","parley","birdsong","fiefdom","augury","harrier","tamale","judging","snakebite","diagnostician","tannin","qualifier","cheetah","distillery","protester","stockroom","factotum","newswoman","cosmopolitan","iridescence","aeroplane","toddy","co-defendant","parry","duocorn","boasting","elector","clarinetist","undergarment","psych","supergiant","armature","environ","collectivity","keepsake","gunfighter","wingspan","perforation","worshiper","groupie","cityscape","worrier","shipload","scallop","hatchery","portraitist","screamer","blaspheme","pacer","presenter","malcontent","seine","equivalency","scriptwriter","lieve","discard","bantam","centaur","typology","loiter","drubbing","airfoil","curio","grandmaster","finisher","luminary","alliteration","phantasy","blooper","fasting","samba","gearbox","islet","apricot","smidgen","inset","firestorm","madcap","seedbed","gunsight","forelock","disjunction","writhing","huckleberry","abstract","squirm","ironist","monosaccharide","pushbutton","terracotta","artiste","showgirl","cornea","temptress","popularization","free-fall","scribbling","conviviality","flange","thwack","droop","rower","sweatband","gopher","mandolin","slobber","stricture","calyx","dietician","rehash","padre","ancient","dotage","jacaranda","pensione","contravention","undulation","ironworker","currant","hankie","face-lift","anthropoid","depressant","war-horse","tithing","greeter","matchbox","woodcutter","magpie","wayfarer","handcuff","lawgiver","traverse","minion","cavalier","sonarman","defoliant","scamp","snowshoe","polyp","gainer","honkie","bottler","halloo","amputee","ontology","bromide","brisket","goodie","tavern-keeper","choker","preaching","molester","tonsure","recapitulation","aviary","stevedore","raffle","bootstrap","angiogram","plantain","tipper","hooting","seismometer","persecutor","lobotomy","pigsty","virologist","gamete","presbytery","stepping-stone","dressing-room","cyclamate","chipmunk","platelet","flogging","tuber","reservist","blinker","demographer","turncoat","demesne","fancier","ideologist","self-justification","bucketful","m'lord","rapping","bestiality","irrelevancy","oiler","mackinaw","flutist","trafficker","categorization","pram","world-system","cathouse","deceiver","idjit","double-take","reformulation","brushfire","separator","neigh","whimpering","crisscross","regurgitation","auteur","backwash","refiner","broadsheet","hedonist","recitative","nonentity","codger","tinting","policymaker","tutu","boondoggle","entrant","wok","small","boatload","searcher","taMing","sycophant","substructure","megalomaniac","rusher","saleslady","registrar","blackguard","neckerchief","oldie","clinician","flushing","pinwheel","dition","charioteer","beastie","stridency","verity","eyedropper","canvass","desperado","teardrop","farmyard","mannerist","macaw","valedictorian","whopper","pertinence","assay","puncher","manse","anatomist","dishtowel","nuke","egalitarian","tribulation","cinematographer","sailer","icicle","legume","spiritualist","nativist","these","progressive","blastocyst","harpooner","pedant","instrumentality","connector","masseur","vertebra","moonshiner","bowsprit","grabber","stele","clanking","renter","antihero","bankbook","jailbird","handicraft","fighter-bomber","streamer","retardant","wallflower","flamethrower","agate","cairn","bantamweight","agglomeration","roustabout","linden","roughneck","formance","moray","cession","rashness","capstone","derailment","declivity","snowfield","talon","haymaker","abductor","diffuser","geosector","camisole"]),Jr}var vo;function wo(){if(vo)return Ot;vo=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.nouns=Ot.adjectives=void 0;const e=Dd();Ot.adjectives=e.default;const r=Ld();return Ot.nouns=r.default,Ot}var ko;function Ud(){return ko||(ko=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.nouns=e.adjectives=e.uniqueUsernameGenerator=e.generateUsername=e.generateFromEmail=void 0;const r=wo(),t=(u=0,s=4294967295)=>Math.random()*((s|0)-(u|0)+1)+(u|0)|0,n=u=>{let s;switch(u){case 1:s=Math.floor(t(1,9)).toString();break;case 2:s=Math.floor(t(10,90)).toString();break;case 3:s=Math.floor(t(100,900)).toString();break;case 4:s=Math.floor(t(1e3,9e3)).toString();break;case 5:s=Math.floor(t(1e4,9e4)).toString();break;case 6:s=Math.floor(t(1e5,9e5)).toString();break;default:s="";break}return s};function i(u,s){return u.replace(/@.+/,"").replace(/[&/\\#,+()$~%._@'":*?<>{}]/g,"")+n(s)}e.generateFromEmail=i;function o(u,s,c,p){const f=r.nouns[Math.floor(Math.random()*r.nouns.length)],d=p?p.replace(/\s{2,}/g," ").replace(/\s/g,u??"").toLocaleLowerCase():r.adjectives[Math.floor(Math.random()*r.adjectives.length)];let h;return u?h=d+u+f+n(s):h=d+f+n(s),c?h.substring(0,c):h}e.generateUsername=o;function a(u){if(u.dictionaries){const s=h=>u.dictionaries[h][t(0,u.dictionaries[h].length-1)],c=u.dictionaries.length,p=u.separator||"";let f="";for(let h=0;h<c;h++){const m=s(h);f?f+=p+m:f=m}let d=f+n(u.randomDigits);if(d=d.toLowerCase(),u.style==="lowerCase")d=d.toLowerCase();else if(u.style==="capital"){const[h,...m]=d.split("");d=h.toUpperCase()+m.join("")}else u.style==="upperCase"&&(d=d.toUpperCase());return u.length?d.substring(0,u.length):d.substring(0,15)}else throw new Error("Cannot find any dictionary. Please provide at least one, or leave the 'dictionary' field empty in the config object")}e.uniqueUsernameGenerator=a;var l=wo();Object.defineProperty(e,"adjectives",{enumerable:!0,get:function(){return l.adjectives}}),Object.defineProperty(e,"nouns",{enumerable:!0,get:function(){return l.nouns}})}(On)),On}var jd=Ud();class Bd{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(r){this.flush(),this._parts.push(r)}append(r){this._pieces.push(r)}flush(){if(this._pieces.length>0){const r=new Uint8Array(this._pieces);this._parts.push(r),this._pieces=[]}}toArrayBuffer(){const r=[];for(const t of this._parts)r.push(t);return qd(r).buffer}}function qd(e){let r=0;for(const i of e)r+=i.byteLength;const t=new Uint8Array(r);let n=0;for(const i of e){const o=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);t.set(o,n),n+=i.byteLength}return t}function ws(e){return new Vd(e).unpack()}function ks(e){const r=new Gd,t=r.pack(e);return t instanceof Promise?t.then(()=>r.getBuffer()):r.getBuffer()}class Vd{constructor(r){this.index=0,this.dataBuffer=r,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const r=this.unpack_uint8();if(r<128)return r;if((r^224)<32)return(r^224)-32;let t;if((t=r^160)<=15)return this.unpack_raw(t);if((t=r^176)<=15)return this.unpack_string(t);if((t=r^144)<=15)return this.unpack_array(t);if((t=r^128)<=15)return this.unpack_map(t);switch(r){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){const r=this.dataView[this.index]&255;return this.index++,r}unpack_uint16(){const r=this.read(2),t=(r[0]&255)*256+(r[1]&255);return this.index+=2,t}unpack_uint32(){const r=this.read(4),t=((r[0]*256+r[1])*256+r[2])*256+r[3];return this.index+=4,t}unpack_uint64(){const r=this.read(8),t=((((((r[0]*256+r[1])*256+r[2])*256+r[3])*256+r[4])*256+r[5])*256+r[6])*256+r[7];return this.index+=8,t}unpack_int8(){const r=this.unpack_uint8();return r<128?r:r-256}unpack_int16(){const r=this.unpack_uint16();return r<32768?r:r-65536}unpack_int32(){const r=this.unpack_uint32();return r<2**31?r:r-2**32}unpack_int64(){const r=this.unpack_uint64();return r<2**63?r:r-2**64}unpack_raw(r){if(this.length<this.index+r)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${r} ${this.length}`);const t=this.dataBuffer.slice(this.index,this.index+r);return this.index+=r,t}unpack_string(r){const t=this.read(r);let n=0,i="",o,a;for(;n<r;)o=t[n],o<160?(a=o,n++):(o^192)<32?(a=(o&31)<<6|t[n+1]&63,n+=2):(o^224)<16?(a=(o&15)<<12|(t[n+1]&63)<<6|t[n+2]&63,n+=3):(a=(o&7)<<18|(t[n+1]&63)<<12|(t[n+2]&63)<<6|t[n+3]&63,n+=4),i+=String.fromCodePoint(a);return this.index+=r,i}unpack_array(r){const t=new Array(r);for(let n=0;n<r;n++)t[n]=this.unpack();return t}unpack_map(r){const t={};for(let n=0;n<r;n++){const i=this.unpack();t[i]=this.unpack()}return t}unpack_float(){const r=this.unpack_uint32(),t=r>>31,n=(r>>23&255)-127,i=r&8388607|8388608;return(t===0?1:-1)*i*2**(n-23)}unpack_double(){const r=this.unpack_uint32(),t=this.unpack_uint32(),n=r>>31,i=(r>>20&2047)-1023,a=(r&1048575|1048576)*2**(i-20)+t*2**(i-52);return(n===0?1:-1)*a}read(r){const t=this.index;if(t+r<=this.length)return this.dataView.subarray(t,t+r);throw new Error("BinaryPackFailure: read index out of range")}}class Gd{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(r){if(typeof r=="string")this.pack_string(r);else if(typeof r=="number")Math.floor(r)===r?this.pack_integer(r):this.pack_double(r);else if(typeof r=="boolean")r===!0?this._bufferBuilder.append(195):r===!1&&this._bufferBuilder.append(194);else if(r===void 0)this._bufferBuilder.append(192);else if(typeof r=="object")if(r===null)this._bufferBuilder.append(192);else{const t=r.constructor;if(r instanceof Array){const n=this.pack_array(r);if(n instanceof Promise)return n.then(()=>this._bufferBuilder.flush())}else if(r instanceof ArrayBuffer)this.pack_bin(new Uint8Array(r));else if("BYTES_PER_ELEMENT"in r){const n=r;this.pack_bin(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}else if(r instanceof Date)this.pack_string(r.toString());else{if(r instanceof Blob)return r.arrayBuffer().then(n=>{this.pack_bin(new Uint8Array(n)),this._bufferBuilder.flush()});if(t==Object||t.toString().startsWith("class")){const n=this.pack_object(r);if(n instanceof Promise)return n.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${t.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof r}" not yet supported`);this._bufferBuilder.flush()}pack_bin(r){const t=r.length;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this._bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(r)}pack_string(r){const t=this._textEncoder.encode(r),n=t.length;if(n<=15)this.pack_uint8(176+n);else if(n<=65535)this._bufferBuilder.append(216),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_array(r){const t=r.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this._bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");const n=i=>{if(i<t){const o=this.pack(r[i]);return o instanceof Promise?o.then(()=>n(i+1)):n(i+1)}};return n(0)}pack_integer(r){if(r>=-32&&r<=127)this._bufferBuilder.append(r&255);else if(r>=0&&r<=255)this._bufferBuilder.append(204),this.pack_uint8(r);else if(r>=-128&&r<=127)this._bufferBuilder.append(208),this.pack_int8(r);else if(r>=0&&r<=65535)this._bufferBuilder.append(205),this.pack_uint16(r);else if(r>=-32768&&r<=32767)this._bufferBuilder.append(209),this.pack_int16(r);else if(r>=0&&r<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(r);else if(r>=-2147483648&&r<=2147483647)this._bufferBuilder.append(210),this.pack_int32(r);else if(r>=-9223372036854776e3&&r<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(r);else if(r>=0&&r<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(r);else throw new Error("Invalid integer")}pack_double(r){let t=0;r<0&&(t=1,r=-r);const n=Math.floor(Math.log(r)/Math.LN2),i=r/2**n-1,o=Math.floor(i*2**52),a=2**32,l=t<<31|n+1023<<20|o/a&1048575,u=o%a;this._bufferBuilder.append(203),this.pack_int32(l),this.pack_int32(u)}pack_object(r){const t=Object.keys(r),n=t.length;if(n<=15)this.pack_uint8(128+n);else if(n<=65535)this._bufferBuilder.append(222),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(n);else throw new Error("Invalid length");const i=o=>{if(o<t.length){const a=t[o];if(r.hasOwnProperty(a)){this.pack(a);const l=this.pack(r[a]);if(l instanceof Promise)return l.then(()=>i(o+1))}return i(o+1)}};return i(0)}pack_uint8(r){this._bufferBuilder.append(r)}pack_uint16(r){this._bufferBuilder.append(r>>8),this._bufferBuilder.append(r&255)}pack_uint32(r){const t=r&4294967295;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_uint64(r){const t=r/4294967296,n=r%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_int8(r){this._bufferBuilder.append(r&255)}pack_int16(r){this._bufferBuilder.append((r&65280)>>8),this._bufferBuilder.append(r&255)}pack_int32(r){this._bufferBuilder.append(r>>>24&255),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int64(r){const t=Math.floor(r/4294967296),n=r%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}constructor(){this._bufferBuilder=new Bd,this._textEncoder=new TextEncoder}}let xs=!0,_s=!0;function xr(e,r,t){const n=e.match(r);return n&&n.length>=t&&parseFloat(n[t],10)}function Xt(e,r,t){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(a,l){if(a!==r)return i.apply(this,arguments);const u=s=>{const c=t(s);c&&(l.handleEvent?l.handleEvent(c):l(c))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(l,u),i.apply(this,[a,u])};const o=n.removeEventListener;n.removeEventListener=function(a,l){if(a!==r||!this._eventMap||!this._eventMap[r])return o.apply(this,arguments);if(!this._eventMap[r].has(l))return o.apply(this,arguments);const u=this._eventMap[r].get(l);return this._eventMap[r].delete(l),this._eventMap[r].size===0&&delete this._eventMap[r],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[a,u])},Object.defineProperty(n,"on"+r,{get(){return this["_on"+r]},set(a){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),a&&this.addEventListener(r,this["_on"+r]=a)},enumerable:!0,configurable:!0})}function Hd(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(xs=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Zd(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(_s=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Ss(){if(typeof window=="object"){if(xs)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Di(e,r){_s&&console.warn(e+" is deprecated, please use "+r+" instead.")}function Wd(e){const r={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return r.browser="Not a browser.",r;const{navigator:t}=e;if(t.userAgentData&&t.userAgentData.brands){const n=t.userAgentData.brands.find(i=>i.brand==="Chromium");if(n)return{browser:"chrome",version:parseInt(n.version,10)}}if(t.mozGetUserMedia)r.browser="firefox",r.version=parseInt(xr(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)r.browser="chrome",r.version=parseInt(xr(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))r.browser="safari",r.version=parseInt(xr(t.userAgent,/AppleWebKit\/(\d+)\./,1)),r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,r._safariVersion=xr(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return r.browser="Not a supported browser.",r;return r}function xo(e){return Object.prototype.toString.call(e)==="[object Object]"}function Cs(e){return xo(e)?Object.keys(e).reduce(function(r,t){const n=xo(e[t]),i=n?Cs(e[t]):e[t],o=n&&!Object.keys(i).length;return i===void 0||o?r:Object.assign(r,{[t]:i})},{}):e}function di(e,r,t){!r||t.has(r.id)||(t.set(r.id,r),Object.keys(r).forEach(n=>{n.endsWith("Id")?di(e,e.get(r[n]),t):n.endsWith("Ids")&&r[n].forEach(i=>{di(e,e.get(i),t)})}))}function _o(e,r,t){const n=t?"outbound-rtp":"inbound-rtp",i=new Map;if(r===null)return i;const o=[];return e.forEach(a=>{a.type==="track"&&a.trackIdentifier===r.id&&o.push(a)}),o.forEach(a=>{e.forEach(l=>{l.type===n&&l.trackId===a.id&&di(e,l,i)})}),i}const So=Ss;function Ps(e,r){const t=e&&e.navigator;if(!t.mediaDevices)return;const n=function(l){if(typeof l!="object"||l.mandatory||l.optional)return l;const u={};return Object.keys(l).forEach(s=>{if(s==="require"||s==="advanced"||s==="mediaSource")return;const c=typeof l[s]=="object"?l[s]:{ideal:l[s]};c.exact!==void 0&&typeof c.exact=="number"&&(c.min=c.max=c.exact);const p=function(f,d){return f?f+d.charAt(0).toUpperCase()+d.slice(1):d==="deviceId"?"sourceId":d};if(c.ideal!==void 0){u.optional=u.optional||[];let f={};typeof c.ideal=="number"?(f[p("min",s)]=c.ideal,u.optional.push(f),f={},f[p("max",s)]=c.ideal,u.optional.push(f)):(f[p("",s)]=c.ideal,u.optional.push(f))}c.exact!==void 0&&typeof c.exact!="number"?(u.mandatory=u.mandatory||{},u.mandatory[p("",s)]=c.exact):["min","max"].forEach(f=>{c[f]!==void 0&&(u.mandatory=u.mandatory||{},u.mandatory[p(f,s)]=c[f])})}),l.advanced&&(u.optional=(u.optional||[]).concat(l.advanced)),u},i=function(l,u){if(r.version>=61)return u(l);if(l=JSON.parse(JSON.stringify(l)),l&&typeof l.audio=="object"){const s=function(c,p,f){p in c&&!(f in c)&&(c[f]=c[p],delete c[p])};l=JSON.parse(JSON.stringify(l)),s(l.audio,"autoGainControl","googAutoGainControl"),s(l.audio,"noiseSuppression","googNoiseSuppression"),l.audio=n(l.audio)}if(l&&typeof l.video=="object"){let s=l.video.facingMode;s=s&&(typeof s=="object"?s:{ideal:s});const c=r.version<66;if(s&&(s.exact==="user"||s.exact==="environment"||s.ideal==="user"||s.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete l.video.facingMode;let p;if(s.exact==="environment"||s.ideal==="environment"?p=["back","rear"]:(s.exact==="user"||s.ideal==="user")&&(p=["front"]),p)return t.mediaDevices.enumerateDevices().then(f=>{f=f.filter(h=>h.kind==="videoinput");let d=f.find(h=>p.some(m=>h.label.toLowerCase().includes(m)));return!d&&f.length&&p.includes("back")&&(d=f[f.length-1]),d&&(l.video.deviceId=s.exact?{exact:d.deviceId}:{ideal:d.deviceId}),l.video=n(l.video),So("chrome: "+JSON.stringify(l)),u(l)})}l.video=n(l.video)}return So("chrome: "+JSON.stringify(l)),u(l)},o=function(l){return r.version>=64?l:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[l.name]||l.name,message:l.message,constraint:l.constraint||l.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(l,u,s){i(l,c=>{t.webkitGetUserMedia(c,u,p=>{s&&s(o(p))})})};if(t.getUserMedia=a.bind(t),t.mediaDevices.getUserMedia){const l=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(u){return i(u,s=>l(s).then(c=>{if(s.audio&&!c.getAudioTracks().length||s.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(p=>{p.stop()}),new DOMException("","NotFoundError");return c},c=>Promise.reject(o(c))))}}}function Ts(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function $s(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",i=>{let o;e.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(l=>l.track&&l.track.id===i.track.id):o={track:i.track};const a=new Event("track");a.track=i.track,a.receiver=o,a.transceiver={receiver:o},a.streams=[n.stream],this.dispatchEvent(a)}),n.stream.getTracks().forEach(i=>{let o;e.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(l=>l.track&&l.track.id===i.id):o={track:i};const a=new Event("track");a.track=i,a.receiver=o,a.transceiver={receiver:o},a.streams=[n.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else Xt(e,"track",r=>(r.transceiver||Object.defineProperty(r,"transceiver",{value:{receiver:r.receiver}}),r))}function Es(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const r=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(l,u){let s=i.apply(this,arguments);return s||(s=r(this,l),this._senders.push(s)),s};const o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(l){o.apply(this,arguments);const u=this._senders.indexOf(l);u!==-1&&this._senders.splice(u,1)}}const t=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],t.apply(this,[o]),o.getTracks().forEach(a=>{this._senders.push(r(this,a))})};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(a=>{const l=this._senders.find(u=>u.track===a);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const n=r.apply(this,[]);return n.forEach(i=>i._pc=this),n},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Is(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const o=t.apply(this,[]);return o.forEach(a=>a._pc=this),o});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const o=n.apply(this,arguments);return o._pc=this,o}),e.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(a=>_o(a,o.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(o=>o._pc=this),i}),Xt(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>_o(o,i.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const n=arguments[0];let i,o,a;return this.getSenders().forEach(l=>{l.track===n&&(i?a=!0:i=l)}),this.getReceivers().forEach(l=>(l.track===n&&(o?a=!0:o=l),l.track===n)),a||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function Rs(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(a,l){if(!l)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const u=r.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(u)===-1&&this._shimmedLocalStreams[l.id].push(u):this._shimmedLocalStreams[l.id]=[l,u],u};const t=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(s=>{if(this.getSenders().find(p=>p.track===s))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();t.apply(this,arguments);const u=this.getSenders().filter(s=>l.indexOf(s)===-1);this._shimmedLocalStreams[a.id]=[a].concat(u)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],n.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const u=this._shimmedLocalStreams[l].indexOf(a);u!==-1&&this._shimmedLocalStreams[l].splice(u,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),i.apply(this,arguments)}}function As(e,r){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&r.version>=65)return Rs(e);const t=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const c=t.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(p=>this._reverseStreams[p.id])};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(p=>{if(this.getSenders().find(d=>d.track===p))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const p=new e.MediaStream(c.getTracks());this._streams[c.id]=p,this._reverseStreams[p.id]=c,c=p}n.apply(this,[c])};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},e.RTCPeerConnection.prototype.addTrack=function(c,p){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(m=>m===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const h=this._streams[p.id];if(h)h.addTrack(c),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new e.MediaStream([c]);this._streams[p.id]=m,this._reverseStreams[m.id]=p,this.addStream(m)}return this.getSenders().find(m=>m.track===c)};function o(s,c){let p=c.sdp;return Object.keys(s._reverseStreams||[]).forEach(f=>{const d=s._reverseStreams[f],h=s._streams[d.id];p=p.replace(new RegExp(h.id,"g"),d.id)}),new RTCSessionDescription({type:c.type,sdp:p})}function a(s,c){let p=c.sdp;return Object.keys(s._reverseStreams||[]).forEach(f=>{const d=s._reverseStreams[f],h=s._streams[d.id];p=p.replace(new RegExp(d.id,"g"),h.id)}),new RTCSessionDescription({type:c.type,sdp:p})}["createOffer","createAnswer"].forEach(function(s){const c=e.RTCPeerConnection.prototype[s],p={[s](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?c.apply(this,[h=>{const m=o(this,h);f[0].apply(null,[m])},h=>{f[1]&&f[1].apply(null,h)},arguments[2]]):c.apply(this,arguments).then(h=>o(this,h))}};e.RTCPeerConnection.prototype[s]=p[s]});const l=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?l.apply(this,arguments):(arguments[0]=a(this,arguments[0]),l.apply(this,arguments))};const u=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const s=u.get.apply(this);return s.type===""?s:o(this,s)}}),e.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(c._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(d=>{this._streams[d].getTracks().find(m=>c.track===m)&&(f=this._streams[d])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function pi(e,r){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]})}function Ms(e,r){Xt(e,"negotiationneeded",t=>{const n=t.target;if(!((r.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")&&n.signalingState!=="stable"))return t})}const Co=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Ms,shimAddTrackRemoveTrack:As,shimAddTrackRemoveTrackWithNative:Rs,shimGetSendersWithDtmf:Es,shimGetUserMedia:Ps,shimMediaStream:Ts,shimOnTrack:$s,shimPeerConnection:pi,shimSenderReceiverGetStats:Is},Symbol.toStringTag,{value:"Module"}));function Ns(e,r){const t=e&&e.navigator,n=e&&e.MediaStreamTrack;if(t.getUserMedia=function(i,o,a){Di("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(o,a)},!(r.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(a,l,u){l in a&&!(u in a)&&(a[u]=a[l],delete a[l])},o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a.audio,"autoGainControl","mozAutoGainControl"),i(a.audio,"noiseSuppression","mozNoiseSuppression")),o(a)},n&&n.prototype.getSettings){const a=n.prototype.getSettings;n.prototype.getSettings=function(){const l=a.apply(this,arguments);return i(l,"mozAutoGainControl","autoGainControl"),i(l,"mozNoiseSuppression","noiseSuppression"),l}}if(n&&n.prototype.applyConstraints){const a=n.prototype.applyConstraints;n.prototype.applyConstraints=function(l){return this.kind==="audio"&&typeof l=="object"&&(l=JSON.parse(JSON.stringify(l)),i(l,"autoGainControl","mozAutoGainControl"),i(l,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[l])}}}}function Yd(e,r){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return n.video===!0?n.video={mediaSource:r}:n.video.mediaSource=r,e.navigator.mediaDevices.getUserMedia(n)})}function Os(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fi(e,r){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=e.RTCPeerConnection.prototype[i],a={[i](){return arguments[0]=new(i==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};e.RTCPeerConnection.prototype[i]=a[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[o,a,l]=arguments;return n.apply(this,[o||null]).then(u=>{if(r.version<53&&!a)try{u.forEach(s=>{s.type=t[s.type]||s.type})}catch(s){if(s.name!=="TypeError")throw s;u.forEach((c,p)=>{u.set(p,Object.assign({},c,{type:t[c.type]||c.type}))})}return u}).then(a,l)}}function Fs(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=r.apply(this,[]);return i.forEach(o=>o._pc=this),i});const t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function zs(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const n=r.apply(this,[]);return n.forEach(i=>i._pc=this),n}),Xt(e,"track",t=>(t.receiver._pc=t.srcElement,t)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Ds(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){Di("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function Ls(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Us(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.addTransceiver;r&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];const i=n.length>0;i&&n.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=r.apply(this,arguments);if(i){const{sender:a}=o,l=a.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=n,a.sendEncodings=n,this.setParametersPromises.push(a.setParameters(l).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return o})}function js(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const r=e.RTCRtpSender.prototype.getParameters;r&&(e.RTCRtpSender.prototype.getParameters=function(){const n=r.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function Bs(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}function qs(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}const Po=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:Us,shimCreateAnswer:qs,shimCreateOffer:Bs,shimGetDisplayMedia:Yd,shimGetParameters:js,shimGetUserMedia:Ns,shimOnTrack:Os,shimPeerConnection:fi,shimRTCDataChannel:Ls,shimReceiverGetStats:zs,shimRemoveStream:Ds,shimSenderGetStats:Fs},Symbol.toStringTag,{value:"Module"}));function Vs(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(i=>r.call(this,i,n)),n.getVideoTracks().forEach(i=>r.call(this,i,n))},e.RTCPeerConnection.prototype.addTrack=function(n,...i){return i&&i.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),r.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(n===-1)return;this._localStreams.splice(n,1);const i=t.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function Gs(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(o)>=0)return;n._remoteStreams.push(o);const a=new Event("addstream");a.stream=o,n.dispatchEvent(a)})}),r.apply(n,arguments)}}}function Hs(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,t=r.createOffer,n=r.createAnswer,i=r.setLocalDescription,o=r.setRemoteDescription,a=r.addIceCandidate;r.createOffer=function(s,c){const p=arguments.length>=2?arguments[2]:arguments[0],f=t.apply(this,[p]);return c?(f.then(s,c),Promise.resolve()):f},r.createAnswer=function(s,c){const p=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[p]);return c?(f.then(s,c),Promise.resolve()):f};let l=function(u,s,c){const p=i.apply(this,[u]);return c?(p.then(s,c),Promise.resolve()):p};r.setLocalDescription=l,l=function(u,s,c){const p=o.apply(this,[u]);return c?(p.then(s,c),Promise.resolve()):p},r.setRemoteDescription=l,l=function(u,s,c){const p=a.apply(this,[u]);return c?(p.then(s,c),Promise.resolve()):p},r.addIceCandidate=l}function Zs(e){const r=e&&e.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const t=r.mediaDevices,n=t.getUserMedia.bind(t);r.mediaDevices.getUserMedia=i=>n(Ws(i))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=function(n,i,o){r.mediaDevices.getUserMedia(n).then(i,o)}.bind(r))}function Ws(e){return e&&e.video!==void 0?Object.assign({},e,{video:Cs(e.video)}):e}function Ys(e){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection;e.RTCPeerConnection=function(n,i){if(n&&n.iceServers){const o=[];for(let a=0;a<n.iceServers.length;a++){let l=n.iceServers[a];l.urls===void 0&&l.url?(Di("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,o.push(l)):o.push(n.iceServers[a])}n.iceServers=o}return new r(n,i)},e.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return r.generateCertificate}})}function Xs(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ks(e){const r=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const i=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):n.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const o=this.getTransceivers().find(a=>a.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):n.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}}function Js(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}const To=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:Js,shimCallbacksAPI:Hs,shimConstraints:Ws,shimCreateOfferLegacy:Ks,shimGetUserMedia:Zs,shimLocalStreamsAPI:Vs,shimRTCIceServerUrls:Ys,shimRemoteStreamsAPI:Gs,shimTrackEventTransceiver:Xs},Symbol.toStringTag,{value:"Module"}));var Fn={exports:{}},$o;function Xd(){return $o||($o=1,function(e){const r={};r.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},r.localCName=r.generateIdentifier(),r.splitLines=function(t){return t.trim().split(`
`).map(n=>n.trim())},r.splitSections=function(t){return t.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},r.getDescription=function(t){const n=r.splitSections(t);return n&&n[0]},r.getMediaSections=function(t){const n=r.splitSections(t);return n.shift(),n},r.matchPrefix=function(t,n){return r.splitLines(t).filter(i=>i.indexOf(n)===0)},r.parseCandidate=function(t){let n;t.indexOf("a=candidate:")===0?n=t.substring(12).split(" "):n=t.substring(10).split(" ");const i={foundation:n[0],component:{1:"rtp",2:"rtcp"}[n[1]]||n[1],protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]};for(let o=8;o<n.length;o+=2)switch(n[o]){case"raddr":i.relatedAddress=n[o+1];break;case"rport":i.relatedPort=parseInt(n[o+1],10);break;case"tcptype":i.tcpType=n[o+1];break;case"ufrag":i.ufrag=n[o+1],i.usernameFragment=n[o+1];break;default:i[n[o]]===void 0&&(i[n[o]]=n[o+1]);break}return i},r.writeCandidate=function(t){const n=[];n.push(t.foundation);const i=t.component;i==="rtp"?n.push(1):i==="rtcp"?n.push(2):n.push(i),n.push(t.protocol.toUpperCase()),n.push(t.priority),n.push(t.address||t.ip),n.push(t.port);const o=t.type;return n.push("typ"),n.push(o),o!=="host"&&t.relatedAddress&&t.relatedPort&&(n.push("raddr"),n.push(t.relatedAddress),n.push("rport"),n.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(n.push("tcptype"),n.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(n.push("ufrag"),n.push(t.usernameFragment||t.ufrag)),"candidate:"+n.join(" ")},r.parseIceOptions=function(t){return t.substring(14).split(" ")},r.parseRtpMap=function(t){let n=t.substring(9).split(" ");const i={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),i.name=n[0],i.clockRate=parseInt(n[1],10),i.channels=n.length===3?parseInt(n[2],10):1,i.numChannels=i.channels,i},r.writeRtpMap=function(t){let n=t.payloadType;t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+n+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},r.parseExtmap=function(t){const n=t.substring(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1],attributes:n.slice(2).join(" ")}},r.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},r.parseFmtp=function(t){const n={};let i;const o=t.substring(t.indexOf(" ")+1).split(";");for(let a=0;a<o.length;a++)i=o[a].trim().split("="),n[i[0].trim()]=i[1];return n},r.writeFmtp=function(t){let n="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const o=[];Object.keys(t.parameters).forEach(a=>{t.parameters[a]!==void 0?o.push(a+"="+t.parameters[a]):o.push(a)}),n+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return n},r.parseRtcpFb=function(t){const n=t.substring(t.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},r.writeRtcpFb=function(t){let n="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(o=>{n+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),n},r.parseSsrcMedia=function(t){const n=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,n),10)},o=t.indexOf(":",n);return o>-1?(i.attribute=t.substring(n+1,o),i.value=t.substring(o+1)):i.attribute=t.substring(n+1),i},r.parseSsrcGroup=function(t){const n=t.substring(13).split(" ");return{semantics:n.shift(),ssrcs:n.map(i=>parseInt(i,10))}},r.getMid=function(t){const n=r.matchPrefix(t,"a=mid:")[0];if(n)return n.substring(6)},r.parseFingerprint=function(t){const n=t.substring(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1].toUpperCase()}},r.getDtlsParameters=function(t,n){return{role:"auto",fingerprints:r.matchPrefix(t+n,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(t,n){let i="a=setup:"+n+`\r
`;return t.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},r.parseCryptoLine=function(t){const n=t.substring(9).split(" ");return{tag:parseInt(n[0],10),cryptoSuite:n[1],keyParams:n[2],sessionParams:n.slice(3)}},r.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?r.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},r.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const n=t.substring(7).split("|");return{keyMethod:"inline",keySalt:n[0],lifeTime:n[1],mkiValue:n[2]?n[2].split(":")[0]:void 0,mkiLength:n[2]?n[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},r.getCryptoParameters=function(t,n){return r.matchPrefix(t+n,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(t,n){const i=r.matchPrefix(t+n,"a=ice-ufrag:")[0],o=r.matchPrefix(t+n,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},r.writeIceParameters=function(t){let n="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(n+=`a=ice-lite\r
`),n},r.parseRtpParameters=function(t){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=r.splitLines(t)[0].split(" ");n.profile=o[2];for(let l=3;l<o.length;l++){const u=o[l],s=r.matchPrefix(t,"a=rtpmap:"+u+" ")[0];if(s){const c=r.parseRtpMap(s),p=r.matchPrefix(t,"a=fmtp:"+u+" ");switch(c.parameters=p.length?r.parseFmtp(p[0]):{},c.rtcpFeedback=r.matchPrefix(t,"a=rtcp-fb:"+u+" ").map(r.parseRtcpFb),n.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(c.name.toUpperCase());break}}}r.matchPrefix(t,"a=extmap:").forEach(l=>{n.headerExtensions.push(r.parseExtmap(l))});const a=r.matchPrefix(t,"a=rtcp-fb:* ").map(r.parseRtcpFb);return n.codecs.forEach(l=>{a.forEach(u=>{l.rtcpFeedback.find(c=>c.type===u.type&&c.parameter===u.parameter)||l.rtcpFeedback.push(u)})}),n},r.writeRtpDescription=function(t,n){let i="";i+="m="+t+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,n.codecs.forEach(a=>{i+=r.writeRtpMap(a),i+=r.writeFmtp(a),i+=r.writeRtcpFb(a)});let o=0;return n.codecs.forEach(a=>{a.maxptime>o&&(o=a.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),n.headerExtensions&&n.headerExtensions.forEach(a=>{i+=r.writeExtmap(a)}),i},r.parseRtpEncodingParameters=function(t){const n=[],i=r.parseRtpParameters(t),o=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,l=r.matchPrefix(t,"a=ssrc:").map(f=>r.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),u=l.length>0&&l[0].ssrc;let s;const c=r.matchPrefix(t,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(h=>parseInt(h,10)));c.length>0&&c[0].length>1&&c[0][0]===u&&(s=c[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let d={ssrc:u,codecPayloadType:parseInt(f.parameters.apt,10)};u&&s&&(d.rtx={ssrc:s}),n.push(d),o&&(d=JSON.parse(JSON.stringify(d)),d.fec={ssrc:u,mechanism:a?"red+ulpfec":"red"},n.push(d))}}),n.length===0&&u&&n.push({ssrc:u});let p=r.matchPrefix(t,"b=");return p.length&&(p[0].indexOf("b=TIAS:")===0?p=parseInt(p[0].substring(7),10):p[0].indexOf("b=AS:")===0?p=parseInt(p[0].substring(5),10)*1e3*.95-50*40*8:p=void 0,n.forEach(f=>{f.maxBitrate=p})),n},r.parseRtcpParameters=function(t){const n={},i=r.matchPrefix(t,"a=ssrc:").map(l=>r.parseSsrcMedia(l)).filter(l=>l.attribute==="cname")[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const o=r.matchPrefix(t,"a=rtcp-rsize");n.reducedSize=o.length>0,n.compound=o.length===0;const a=r.matchPrefix(t,"a=rtcp-mux");return n.mux=a.length>0,n},r.writeRtcpParameters=function(t){let n="";return t.reducedSize&&(n+=`a=rtcp-rsize\r
`),t.mux&&(n+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(n+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),n},r.parseMsid=function(t){let n;const i=r.matchPrefix(t,"a=msid:");if(i.length===1)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const o=r.matchPrefix(t,"a=ssrc:").map(a=>r.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(o.length>0)return n=o[0].value.split(" "),{stream:n[0],track:n[1]}},r.parseSctpDescription=function(t){const n=r.parseMLine(t),i=r.matchPrefix(t,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const a=r.matchPrefix(t,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:n.fmt,maxMessageSize:o};const l=r.matchPrefix(t,"a=sctpmap:");if(l.length>0){const u=l[0].substring(10).split(" ");return{port:parseInt(u[0],10),protocol:u[1],maxMessageSize:o}}},r.writeSctpDescription=function(t,n){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+n.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+n.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+n.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+n.port+" "+n.protocol+` 65535\r
`],n.maxMessageSize!==void 0&&i.push("a=max-message-size:"+n.maxMessageSize+`\r
`),i.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,22)},r.writeSessionBoilerplate=function(t,n,i){let o;const a=n!==void 0?n:2;return t?o=t:o=r.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},r.getDirection=function(t,n){const i=r.splitLines(t);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return n?r.getDirection(n):"sendrecv"},r.getKind=function(t){return r.splitLines(t)[0].split(" ")[0].substring(2)},r.isRejected=function(t){return t.split(" ",2)[1]==="0"},r.parseMLine=function(t){const i=r.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},r.parseOLine=function(t){const i=r.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},r.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const n=r.splitLines(t);for(let i=0;i<n.length;i++)if(n[i].length<2||n[i].charAt(1)!=="=")return!1;return!0},e.exports=r}(Fn)),Fn.exports}var Qs=Xd();const nr=Ai(Qs),Kd=td({__proto__:null,default:nr},[Qs]);function cn(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const r=e.RTCIceCandidate;e.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substring(2)),n.candidate&&n.candidate.length){const i=new r(n),o=nr.parseCandidate(n.candidate);for(const a in o)a in i||Object.defineProperty(i,a,{value:o[a]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new r(n)},e.RTCIceCandidate.prototype=r.prototype,Xt(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function hi(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Xt(e,"icecandidate",r=>{if(r.candidate){const t=nr.parseCandidate(r.candidate.candidate);t.type==="relay"&&(r.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return r})}function un(e,r){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(l){if(!l||!l.sdp)return!1;const u=nr.splitSections(l.sdp);return u.shift(),u.some(s=>{const c=nr.parseMLine(s);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})},n=function(l){const u=l.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(u===null||u.length<2)return-1;const s=parseInt(u[1],10);return s!==s?-1:s},i=function(l){let u=65536;return r.browser==="firefox"&&(r.version<57?l===-1?u=16384:u=2147483637:r.version<60?u=r.version===57?65535:65536:u=2147483637),u},o=function(l,u){let s=65536;r.browser==="firefox"&&r.version===57&&(s=65535);const c=nr.matchPrefix(l.sdp,"a=max-message-size:");return c.length>0?s=parseInt(c[0].substring(19),10):r.browser==="firefox"&&u!==-1&&(s=2147483637),s},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r.browser==="chrome"&&r.version>=76){const{sdpSemantics:u}=this.getConfiguration();u==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const u=n(arguments[0]),s=i(u),c=o(arguments[0],u);let p;s===0&&c===0?p=Number.POSITIVE_INFINITY:s===0||c===0?p=Math.max(s,c):p=Math.min(s,c);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return p}}),this._sctp=f}return a.apply(this,arguments)}}function dn(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function r(n,i){const o=n.send;n.send=function(){const l=arguments[0],u=l.length||l.size||l.byteLength;if(n.readyState==="open"&&i.sctp&&u>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(n,arguments)}}const t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return r(i,this),i},Xt(e,"datachannel",n=>(r(n.channel,n.target),n))}function mi(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const n=r[t];r[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const a=new Event("connectionstatechange",i);o.dispatchEvent(a)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function gi(e,r){if(!e.RTCPeerConnection||r.browser==="chrome"&&r.version>=71||r.browser==="safari"&&r._safariVersion>=13.1)return;const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&i instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return t.apply(this,arguments)}}function pn(e,r){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const t=e.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(r.browser==="chrome"&&r.version<78||r.browser==="firefox"&&r.version<68||r.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function fn(e,r){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const t=e.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(e.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>t.apply(this,[a]))})}const Jd=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:gi,shimAddIceCandidateNullOrEmpty:pn,shimConnectionState:mi,shimMaxMessageSize:un,shimParameterlessSetLocalDescription:fn,shimRTCIceCandidate:cn,shimRTCIceCandidateRelayProtocol:hi,shimSendThrowTypeError:dn},Symbol.toStringTag,{value:"Module"}));function Qd({window:e}={},r={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=Ss,n=Wd(e),i={browserDetails:n,commonShim:Jd,extractVersion:xr,disableLog:Hd,disableWarnings:Zd,sdp:Kd};switch(n.browser){case"chrome":if(!Co||!pi||!r.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(n.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=Co,pn(e,n),fn(e),Ps(e,n),Ts(e),pi(e,n),$s(e),As(e,n),Es(e),Is(e),Ms(e,n),cn(e),hi(e),mi(e),un(e,n),dn(e),gi(e,n);break;case"firefox":if(!Po||!fi||!r.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=Po,pn(e,n),fn(e),Ns(e,n),fi(e,n),Os(e),Ds(e),Fs(e),zs(e),Ls(e),Us(e),js(e),Bs(e),qs(e),cn(e),mi(e),un(e,n),dn(e);break;case"safari":if(!To||!r.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=To,pn(e,n),fn(e),Ys(e),Ks(e),Hs(e),Vs(e),Gs(e),Xs(e),Zs(e),Js(e),cn(e),hi(e),un(e,n),dn(e),gi(e,n);break;default:t("Unsupported browser!");break}return i}const Eo=Qd({window:typeof window>"u"?void 0:window});function Kt(e,r,t,n){Object.defineProperty(e,r,{get:t,set:n,enumerable:!0,configurable:!0})}class el{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=r=>{const t=[],n=r.byteLength,i=Math.ceil(n/this.chunkedMTU);let o=0,a=0;for(;a<n;){const l=Math.min(n,a+this.chunkedMTU),u=r.slice(a,l),s={__peerData:this._dataCount,n:o,data:u,total:i};t.push(s),a=l,o++}return this._dataCount++,t}}}function ep(e){let r=0;for(const i of e)r+=i.byteLength;const t=new Uint8Array(r);let n=0;for(const i of e)t.set(i,n),n+=i.byteLength;return t}const zn=Eo.default||Eo,hr=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const e=this.getBrowser(),r=this.getVersion();return this.supportedBrowsers.includes(e)?e==="chrome"?r>=this.minChromeVersion:e==="firefox"?r>=this.minFirefoxVersion:e==="safari"?!this.isIOS&&r>=this.minSafariVersion:!1:!1}getBrowser(){return zn.browserDetails.browser}getVersion(){return zn.browserDetails.version||0}isUnifiedPlanSupported(){const e=this.getBrowser(),r=zn.browserDetails.version||0;if(e==="chrome"&&r<this.minChromeVersion)return!1;if(e==="firefox"&&r>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t,n=!1;try{t=new RTCPeerConnection,t.addTransceiver("audio"),n=!0}catch{}finally{t&&t.close()}return n}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},tp=e=>!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e),tl=()=>Math.random().toString(36).slice(2),Io={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class rp extends el{noop(){}blobToArrayBuffer(r,t){const n=new FileReader;return n.onload=function(i){i.target&&t(i.target.result)},n.readAsArrayBuffer(r),n}binaryStringToArrayBuffer(r){const t=new Uint8Array(r.length);for(let n=0;n<r.length;n++)t[n]=r.charCodeAt(n)&255;return t.buffer}isSecure(){return location.protocol==="https:"}constructor(...r){super(...r),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=Io,this.browser=hr.getBrowser(),this.browserVersion=hr.getVersion(),this.pack=ks,this.unpack=ws,this.supports=function(){const t={browser:hr.isBrowserSupported(),webRTC:hr.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;let n;try{n=new RTCPeerConnection(Io),t.audioVideo=!0;let i;try{i=n.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!i.ordered;try{i.binaryType="blob",t.binaryBlob=!hr.isIOS}catch{}}catch{}finally{i&&i.close()}}catch{}finally{n&&n.close()}return t}(),this.validateId=tp,this.randomToken=tl}}const Ge=new rp,np="PeerJS: ";var Ro;(function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"})(Ro||(Ro={}));class ip{get logLevel(){return this._logLevel}set logLevel(r){this._logLevel=r}log(...r){this._logLevel>=3&&this._print(3,...r)}warn(...r){this._logLevel>=2&&this._print(2,...r)}error(...r){this._logLevel>=1&&this._print(1,...r)}setLogFunction(r){this._print=r}_print(r,...t){const n=[np,...t];for(const i in n)n[i]instanceof Error&&(n[i]="("+n[i].name+") "+n[i].message);r>=3?console.log(...n):r>=2?console.warn("WARNING",...n):r>=1&&console.error("ERROR",...n)}constructor(){this._logLevel=0}}var V=new ip,Li={},op=Object.prototype.hasOwnProperty,je="~";function Ar(){}Object.create&&(Ar.prototype=Object.create(null),new Ar().__proto__||(je=!1));function ap(e,r,t){this.fn=e,this.context=r,this.once=t||!1}function rl(e,r,t,n,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new ap(t,n||e,i),a=je?je+r:r;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],o]:e._events[a].push(o):(e._events[a]=o,e._eventsCount++),e}function hn(e,r){--e._eventsCount===0?e._events=new Ar:delete e._events[r]}function ze(){this._events=new Ar,this._eventsCount=0}ze.prototype.eventNames=function(){var r=[],t,n;if(this._eventsCount===0)return r;for(n in t=this._events)op.call(t,n)&&r.push(je?n.slice(1):n);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r};ze.prototype.listeners=function(r){var t=je?je+r:r,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a};ze.prototype.listenerCount=function(r){var t=je?je+r:r,n=this._events[t];return n?n.fn?1:n.length:0};ze.prototype.emit=function(r,t,n,i,o,a){var l=je?je+r:r;if(!this._events[l])return!1;var u=this._events[l],s=arguments.length,c,p;if(u.fn){switch(u.once&&this.removeListener(r,u.fn,void 0,!0),s){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,a),!0}for(p=1,c=new Array(s-1);p<s;p++)c[p-1]=arguments[p];u.fn.apply(u.context,c)}else{var f=u.length,d;for(p=0;p<f;p++)switch(u[p].once&&this.removeListener(r,u[p].fn,void 0,!0),s){case 1:u[p].fn.call(u[p].context);break;case 2:u[p].fn.call(u[p].context,t);break;case 3:u[p].fn.call(u[p].context,t,n);break;case 4:u[p].fn.call(u[p].context,t,n,i);break;default:if(!c)for(d=1,c=new Array(s-1);d<s;d++)c[d-1]=arguments[d];u[p].fn.apply(u[p].context,c)}}return!0};ze.prototype.on=function(r,t,n){return rl(this,r,t,n,!1)};ze.prototype.once=function(r,t,n){return rl(this,r,t,n,!0)};ze.prototype.removeListener=function(r,t,n,i){var o=je?je+r:r;if(!this._events[o])return this;if(!t)return hn(this,o),this;var a=this._events[o];if(a.fn)a.fn===t&&(!i||a.once)&&(!n||a.context===n)&&hn(this,o);else{for(var l=0,u=[],s=a.length;l<s;l++)(a[l].fn!==t||i&&!a[l].once||n&&a[l].context!==n)&&u.push(a[l]);u.length?this._events[o]=u.length===1?u[0]:u:hn(this,o)}return this};ze.prototype.removeAllListeners=function(r){var t;return r?(t=je?je+r:r,this._events[t]&&hn(this,t)):(this._events=new Ar,this._eventsCount=0),this};ze.prototype.off=ze.prototype.removeListener;ze.prototype.addListener=ze.prototype.on;ze.prefixed=je;ze.EventEmitter=ze;Li=ze;var Jt={};Kt(Jt,"ConnectionType",()=>pt);Kt(Jt,"PeerErrorType",()=>Se);Kt(Jt,"BaseConnectionErrorType",()=>Mr);Kt(Jt,"DataConnectionErrorType",()=>Nr);Kt(Jt,"SerializationType",()=>or);Kt(Jt,"SocketEventType",()=>dt);Kt(Jt,"ServerMessageType",()=>Ae);var pt;(function(e){e.Data="data",e.Media="media"})(pt||(pt={}));var Se;(function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"})(Se||(Se={}));var Mr;(function(e){e.NegotiationFailed="negotiation-failed",e.ConnectionClosed="connection-closed"})(Mr||(Mr={}));var Nr;(function(e){e.NotOpenYet="not-open-yet",e.MessageToBig="message-too-big"})(Nr||(Nr={}));var or;(function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json",e.None="raw"})(or||(or={}));var dt;(function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"})(dt||(dt={}));var Ae;(function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"})(Ae||(Ae={}));var Ui={};Ui=JSON.parse('{"name":"peerjs","version":"1.5.4","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stückler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Sören Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.1.0","webrtc-adapter":"^9.0.0"},"alias":{"process":false,"buffer":false}}');class sp extends Li.EventEmitter{constructor(r,t,n,i,o,a=5e3){super(),this.pingInterval=a,this._disconnected=!0,this._messagesQueue=[];const l=r?"wss://":"ws://";this._baseUrl=l+t+":"+n+i+"peerjs?key="+o}start(r,t){this._id=r;const n=`${this._baseUrl}&id=${r}&token=${t}`;this._socket||!this._disconnected||(this._socket=new WebSocket(n+"&version="+Ui.version),this._disconnected=!1,this._socket.onmessage=i=>{let o;try{o=JSON.parse(i.data),V.log("Server message received:",o)}catch{V.log("Invalid server message",i.data);return}this.emit(dt.Message,o)},this._socket.onclose=i=>{this._disconnected||(V.log("Socket closed.",i),this._cleanup(),this._disconnected=!0,this.emit(dt.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),V.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){V.log("Cannot send heartbeat, because socket closed");return}const r=JSON.stringify({type:Ae.Heartbeat});this._socket.send(r),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const r=[...this._messagesQueue];this._messagesQueue=[];for(const t of r)this.send(t)}send(r){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(r);return}if(!r.type){this.emit(dt.Error,"Invalid message");return}if(!this._wsOpen())return;const t=JSON.stringify(r);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class nl{constructor(r){this.connection=r}startConnection(r){const t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===pt.Media&&r._stream&&this._addTracksToConnection(r._stream,t),r.originator){const n=this.connection,i={ordered:!!r.reliable},o=t.createDataChannel(n.label,i);n._initializeDataChannel(o),this._makeOffer()}else this.handleSDP("OFFER",r.sdp)}_startPeerConnection(){V.log("Creating RTCPeerConnection.");const r=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(r),r}_setupListeners(r){const t=this.connection.peer,n=this.connection.connectionId,i=this.connection.type,o=this.connection.provider;V.log("Listening for ICE candidates."),r.onicecandidate=a=>{!a.candidate||!a.candidate.candidate||(V.log(`Received ICE candidates for ${t}:`,a.candidate),o.socket.send({type:Ae.Candidate,payload:{candidate:a.candidate,type:i,connectionId:n},dst:t}))},r.oniceconnectionstatechange=()=>{switch(r.iceConnectionState){case"failed":V.log("iceConnectionState is failed, closing connections to "+t),this.connection.emitError(Mr.NegotiationFailed,"Negotiation of connection to "+t+" failed."),this.connection.close();break;case"closed":V.log("iceConnectionState is closed, closing connections to "+t),this.connection.emitError(Mr.ConnectionClosed,"Connection to "+t+" closed."),this.connection.close();break;case"disconnected":V.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":r.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",r.iceConnectionState)},V.log("Listening for data channel"),r.ondatachannel=a=>{V.log("Received data channel");const l=a.channel;o.getConnection(t,n)._initializeDataChannel(l)},V.log("Listening for remote stream"),r.ontrack=a=>{V.log("Received remote stream");const l=a.streams[0],u=o.getConnection(t,n);if(u.type===pt.Media){const s=u;this._addStreamToMediaConnection(l,s)}}}cleanup(){V.log("Cleaning up PeerConnection to "+this.connection.peer);const r=this.connection.peerConnection;if(!r)return;this.connection.peerConnection=null,r.onicecandidate=r.oniceconnectionstatechange=r.ondatachannel=r.ontrack=()=>{};const t=r.signalingState!=="closed";let n=!1;const i=this.connection.dataChannel;i&&(n=!!i.readyState&&i.readyState!=="closed"),(t||n)&&r.close()}async _makeOffer(){const r=this.connection.peerConnection,t=this.connection.provider;try{const n=await r.createOffer(this.connection.options.constraints);V.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await r.setLocalDescription(n),V.log("Set localDescription:",n,`for:${this.connection.peer}`);let i={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===pt.Data){const o=this.connection;i={...i,label:o.label,reliable:o.reliable,serialization:o.serialization}}t.socket.send({type:Ae.Offer,payload:i,dst:this.connection.peer})}catch(i){i!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(Se.WebRTC,i),V.log("Failed to setLocalDescription, ",i))}}catch(n){t.emitError(Se.WebRTC,n),V.log("Failed to createOffer, ",n)}}async _makeAnswer(){const r=this.connection.peerConnection,t=this.connection.provider;try{const n=await r.createAnswer();V.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await r.setLocalDescription(n),V.log("Set localDescription:",n,`for:${this.connection.peer}`),t.socket.send({type:Ae.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(i){t.emitError(Se.WebRTC,i),V.log("Failed to setLocalDescription, ",i)}}catch(n){t.emitError(Se.WebRTC,n),V.log("Failed to create answer, ",n)}}async handleSDP(r,t){t=new RTCSessionDescription(t);const n=this.connection.peerConnection,i=this.connection.provider;V.log("Setting remote description",t);const o=this;try{await n.setRemoteDescription(t),V.log(`Set remoteDescription:${r} for:${this.connection.peer}`),r==="OFFER"&&await o._makeAnswer()}catch(a){i.emitError(Se.WebRTC,a),V.log("Failed to setRemoteDescription, ",a)}}async handleCandidate(r){V.log("handleCandidate:",r);try{await this.connection.peerConnection.addIceCandidate(r),V.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(Se.WebRTC,t),V.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(r,t){if(V.log(`add tracks from stream ${r.id} to peer connection`),!t.addTrack)return V.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");r.getTracks().forEach(n=>{t.addTrack(n,r)})}_addStreamToMediaConnection(r,t){V.log(`add stream ${r.id} to media connection ${t.connectionId}`),t.addStream(r)}}class il extends Li.EventEmitter{emitError(r,t){V.error("Error:",t),this.emit("error",new lp(`${r}`,t))}}class lp extends Error{constructor(r,t){typeof t=="string"?super(t):(super(),Object.assign(this,t)),this.type=r}}class ol extends il{get open(){return this._open}constructor(r,t,n){super(),this.peer=r,this.provider=t,this.options=n,this._open=!1,this.metadata=n.metadata}}class vn extends ol{static#e=this.ID_PREFIX="mc_";get type(){return pt.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(r,t,n){super(r,t,n),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||vn.ID_PREFIX+Ge.randomToken(),this._negotiator=new nl(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(r){this.dataChannel=r,this.dataChannel.onopen=()=>{V.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{V.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(r){V.log("Receiving stream",r),this._remoteStream=r,super.emit("stream",r)}handleMessage(r){const t=r.type,n=r.payload;switch(r.type){case Ae.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case Ae.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:V.warn(`Unrecognized message type:${t} from peer:${this.peer}`);break}}answer(r,t={}){if(this._localStream){V.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=r,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:r});const n=this.provider._getMessages(this.connectionId);for(const i of n)this.handleMessage(i);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class cp{constructor(r){this._options=r}_buildRequest(r){const t=this._options.secure?"https":"http",{host:n,port:i,path:o,key:a}=this._options,l=new URL(`${t}://${n}:${i}${o}${a}/${r}`);return l.searchParams.set("ts",`${Date.now()}${Math.random()}`),l.searchParams.set("version",Ui.version),fetch(l.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const r=await this._buildRequest("id");if(r.status!==200)throw new Error(`Error. Status:${r.status}`);return r.text()}catch(r){V.error("Error retrieving ID",r);let t="";throw this._options.path==="/"&&this._options.host!==Ge.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{const r=await this._buildRequest("peers");if(r.status!==200){if(r.status===401){let t="";throw this._options.host===Ge.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)}throw new Error(`Error. Status:${r.status}`)}return r.json()}catch(r){throw V.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r)}}}class wn extends ol{static#e=this.ID_PREFIX="dc_";static#n=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return pt.Data}constructor(r,t,n){super(r,t,n),this.connectionId=this.options.connectionId||wn.ID_PREFIX+tl(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new nl(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(r){this.dataChannel=r,this.dataChannel.onopen=()=>{V.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{V.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{V.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(r){if(r?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(r,t=!1){if(!this.open){this.emitError(Nr.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(r,t)}async handleMessage(r){const t=r.payload;switch(r.type){case Ae.Answer:await this._negotiator.handleSDP(r.type,t.sdp);break;case Ae.Candidate:await this._negotiator.handleCandidate(t.candidate);break;default:V.warn("Unrecognized message type:",r.type,"from peer:",this.peer);break}}}class ji extends wn{get bufferSize(){return this._bufferSize}_initializeDataChannel(r){super._initializeDataChannel(r),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(r){(this._buffering||!this._trySend(r))&&(this._buffer.push(r),this._bufferSize=this._buffer.length)}_trySend(r){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>wn.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(r)}catch(t){return V.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const r=this._buffer[0];this._trySend(r)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(r){if(r?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...r){super(...r),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class Dn extends ji{close(r){super.close(r),this._chunkedData={}}constructor(r,t,n){super(r,t,n),this.chunker=new el,this.serialization=or.Binary,this._chunkedData={}}_handleDataMessage({data:r}){const t=ws(r),n=t.__peerData;if(n){if(n.type==="close"){this.close();return}this._handleChunk(t);return}this.emit("data",t)}_handleChunk(r){const t=r.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:r.total};if(n.data[r.n]=new Uint8Array(r.data),n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];const i=ep(n.data);this._handleDataMessage({data:i})}}_send(r,t){const n=ks(r);if(n instanceof Promise)return this._send_blob(n);if(!t&&n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}async _send_blob(r){const t=await r;if(t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}_sendChunks(r){const t=this.chunker.chunk(r);V.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(const n of t)this.send(n,!0)}}class up extends ji{_handleDataMessage({data:r}){super.emit("data",r)}_send(r,t){this._bufferedSend(r)}constructor(...r){super(...r),this.serialization=or.None}}class dp extends ji{_handleDataMessage({data:r}){const t=this.parse(this.decoder.decode(r)),n=t.__peerData;if(n&&n.type==="close"){this.close();return}this.emit("data",t)}_send(r,t){const n=this.encoder.encode(this.stringify(r));if(n.byteLength>=Ge.chunkedMTU){this.emitError(Nr.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(n)}constructor(...r){super(...r),this.serialization=or.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class Bi extends il{static#e=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const r=Object.create(null);for(const[t,n]of this._connections)r[t]=n;return r}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(r,t){super(),this._serializers={raw:up,json:dp,binary:Dn,"binary-utf8":Dn,default:Dn},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let n;if(r&&r.constructor==Object?t=r:r&&(n=r.toString()),t={debug:0,host:Ge.CLOUD_HOST,port:Ge.CLOUD_PORT,path:"/",key:Bi.DEFAULT_KEY,token:Ge.randomToken(),config:Ge.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...t},this._options=t,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Ge.CLOUD_HOST?this._options.secure=Ge.isSecure():this._options.host==Ge.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&V.setLogFunction(this._options.logFunction),V.logLevel=this._options.debug||0,this._api=new cp(t),this._socket=this._createServerConnection(),!Ge.supports.audioVideo&&!Ge.supports.data){this._delayedAbort(Se.BrowserIncompatible,"The current browser does not support WebRTC");return}if(n&&!Ge.validateId(n)){this._delayedAbort(Se.InvalidID,`ID "${n}" is invalid`);return}n?this._initialize(n):this._api.retrieveId().then(i=>this._initialize(i)).catch(i=>this._abort(Se.ServerError,i))}_createServerConnection(){const r=new sp(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return r.on(dt.Message,t=>{this._handleMessage(t)}),r.on(dt.Error,t=>{this._abort(Se.SocketError,t)}),r.on(dt.Disconnected,()=>{this.disconnected||(this.emitError(Se.Network,"Lost connection to server."),this.disconnect())}),r.on(dt.Close,()=>{this.disconnected||this._abort(Se.SocketClosed,"Underlying socket is already closed.")}),r}_initialize(r){this._id=r,this.socket.start(r,this._options.token)}_handleMessage(r){const t=r.type,n=r.payload,i=r.src;switch(t){case Ae.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case Ae.Error:this._abort(Se.ServerError,n.msg);break;case Ae.IdTaken:this._abort(Se.UnavailableID,`ID "${this.id}" is taken`);break;case Ae.InvalidKey:this._abort(Se.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case Ae.Leave:V.log(`Received leave message from ${i}`),this._cleanupPeer(i),this._connections.delete(i);break;case Ae.Expire:this.emitError(Se.PeerUnavailable,`Could not connect to peer ${i}`);break;case Ae.Offer:{const o=n.connectionId;let a=this.getConnection(i,o);if(a&&(a.close(),V.warn(`Offer received for existing Connection ID:${o}`)),n.type===pt.Media){const u=new vn(i,this,{connectionId:o,_payload:n,metadata:n.metadata});a=u,this._addConnection(i,a),this.emit("call",u)}else if(n.type===pt.Data){const u=new this._serializers[n.serialization](i,this,{connectionId:o,_payload:n,metadata:n.metadata,label:n.label,serialization:n.serialization,reliable:n.reliable});a=u,this._addConnection(i,a),this.emit("connection",u)}else{V.warn(`Received malformed connection type:${n.type}`);return}const l=this._getMessages(o);for(const u of l)a.handleMessage(u);break}default:{if(!n){V.warn(`You received a malformed message from ${i} of type ${t}`);return}const o=n.connectionId,a=this.getConnection(i,o);a&&a.peerConnection?a.handleMessage(r):o?this._storeMessage(o,r):V.warn("You received an unrecognized message:",r);break}}}_storeMessage(r,t){this._lostMessages.has(r)||this._lostMessages.set(r,[]),this._lostMessages.get(r).push(t)}_getMessages(r){const t=this._lostMessages.get(r);return t?(this._lostMessages.delete(r),t):[]}connect(r,t={}){if(t={serialization:"default",...t},this.disconnected){V.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(Se.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const n=new this._serializers[t.serialization](r,this,t);return this._addConnection(r,n),n}call(r,t,n={}){if(this.disconnected){V.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(Se.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!t){V.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const i=new vn(r,this,{...n,_stream:t});return this._addConnection(r,i),i}_addConnection(r,t){V.log(`add connection ${t.type}:${t.connectionId} to peerId:${r}`),this._connections.has(r)||this._connections.set(r,[]),this._connections.get(r).push(t)}_removeConnection(r){const t=this._connections.get(r.peer);if(t){const n=t.indexOf(r);n!==-1&&t.splice(n,1)}this._lostMessages.delete(r.connectionId)}getConnection(r,t){const n=this._connections.get(r);if(!n)return null;for(const i of n)if(i.connectionId===t)return i;return null}_delayedAbort(r,t){setTimeout(()=>{this._abort(r,t)},0)}_abort(r,t){V.error("Aborting!"),this.emitError(r,t),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(V.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const r of this._connections.keys())this._cleanupPeer(r),this._connections.delete(r);this.socket.removeAllListeners()}_cleanupPeer(r){const t=this._connections.get(r);if(t)for(const n of t)n.close()}disconnect(){if(this.disconnected)return;const r=this.id;V.log(`Disconnect peer with ID:${r}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=r,this._id=null,this.emit("disconnected",r)}reconnect(){if(this.disconnected&&!this.destroyed)V.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)V.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(r=t=>{}){this._api.listAllPeers().then(t=>r(t)).catch(t=>this._abort(Se.ServerError,t))}}var Ao=Bi,Ln={exports:{}},Un={exports:{}},Mo;function pp(){return Mo||(Mo=1,function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(t,n){return t<<n|t>>>32-n},rotr:function(t,n){return t<<32-n|t>>>n},endian:function(t){if(t.constructor==Number)return r.rotl(t,8)&16711935|r.rotl(t,24)&4278255360;for(var n=0;n<t.length;n++)t[n]=r.endian(t[n]);return t},randomBytes:function(t){for(var n=[];t>0;t--)n.push(Math.floor(Math.random()*256));return n},bytesToWords:function(t){for(var n=[],i=0,o=0;i<t.length;i++,o+=8)n[o>>>5]|=t[i]<<24-o%32;return n},wordsToBytes:function(t){for(var n=[],i=0;i<t.length*32;i+=8)n.push(t[i>>>5]>>>24-i%32&255);return n},bytesToHex:function(t){for(var n=[],i=0;i<t.length;i++)n.push((t[i]>>>4).toString(16)),n.push((t[i]&15).toString(16));return n.join("")},hexToBytes:function(t){for(var n=[],i=0;i<t.length;i+=2)n.push(parseInt(t.substr(i,2),16));return n},bytesToBase64:function(t){for(var n=[],i=0;i<t.length;i+=3)for(var o=t[i]<<16|t[i+1]<<8|t[i+2],a=0;a<4;a++)i*8+a*6<=t.length*8?n.push(e.charAt(o>>>6*(3-a)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/ig,"");for(var n=[],i=0,o=0;i<t.length;o=++i%4)o!=0&&n.push((e.indexOf(t.charAt(i-1))&Math.pow(2,-2*o+8)-1)<<o*2|e.indexOf(t.charAt(i))>>>6-o*2);return n}};Un.exports=r}()),Un.exports}var jn,No;function Oo(){if(No)return jn;No=1;var e={utf8:{stringToBytes:function(r){return e.bin.stringToBytes(unescape(encodeURIComponent(r)))},bytesToString:function(r){return decodeURIComponent(escape(e.bin.bytesToString(r)))}},bin:{stringToBytes:function(r){for(var t=[],n=0;n<r.length;n++)t.push(r.charCodeAt(n)&255);return t},bytesToString:function(r){for(var t=[],n=0;n<r.length;n++)t.push(String.fromCharCode(r[n]));return t.join("")}}};return jn=e,jn}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Bn,Fo;function fp(){if(Fo)return Bn;Fo=1,Bn=function(t){return t!=null&&(e(t)||r(t)||!!t._isBuffer)};function e(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function r(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&e(t.slice(0,0))}return Bn}var zo;function hp(){return zo||(zo=1,function(){var e=pp(),r=Oo().utf8,t=fp(),n=Oo().bin,i=function(o,a){o.constructor==String?a&&a.encoding==="binary"?o=n.stringToBytes(o):o=r.stringToBytes(o):t(o)?o=Array.prototype.slice.call(o,0):!Array.isArray(o)&&o.constructor!==Uint8Array&&(o=o.toString());for(var l=e.bytesToWords(o),u=o.length*8,s=1732584193,c=-271733879,p=-1732584194,f=271733878,d=0;d<l.length;d++)l[d]=(l[d]<<8|l[d]>>>24)&16711935|(l[d]<<24|l[d]>>>8)&4278255360;l[u>>>5]|=128<<u%32,l[(u+64>>>9<<4)+14]=u;for(var h=i._ff,m=i._gg,g=i._hh,y=i._ii,d=0;d<l.length;d+=16){var b=s,w=c,v=p,k=f;s=h(s,c,p,f,l[d+0],7,-680876936),f=h(f,s,c,p,l[d+1],12,-389564586),p=h(p,f,s,c,l[d+2],17,606105819),c=h(c,p,f,s,l[d+3],22,-1044525330),s=h(s,c,p,f,l[d+4],7,-176418897),f=h(f,s,c,p,l[d+5],12,1200080426),p=h(p,f,s,c,l[d+6],17,-1473231341),c=h(c,p,f,s,l[d+7],22,-45705983),s=h(s,c,p,f,l[d+8],7,1770035416),f=h(f,s,c,p,l[d+9],12,-1958414417),p=h(p,f,s,c,l[d+10],17,-42063),c=h(c,p,f,s,l[d+11],22,-1990404162),s=h(s,c,p,f,l[d+12],7,1804603682),f=h(f,s,c,p,l[d+13],12,-40341101),p=h(p,f,s,c,l[d+14],17,-1502002290),c=h(c,p,f,s,l[d+15],22,1236535329),s=m(s,c,p,f,l[d+1],5,-165796510),f=m(f,s,c,p,l[d+6],9,-1069501632),p=m(p,f,s,c,l[d+11],14,643717713),c=m(c,p,f,s,l[d+0],20,-373897302),s=m(s,c,p,f,l[d+5],5,-701558691),f=m(f,s,c,p,l[d+10],9,38016083),p=m(p,f,s,c,l[d+15],14,-660478335),c=m(c,p,f,s,l[d+4],20,-405537848),s=m(s,c,p,f,l[d+9],5,568446438),f=m(f,s,c,p,l[d+14],9,-1019803690),p=m(p,f,s,c,l[d+3],14,-187363961),c=m(c,p,f,s,l[d+8],20,1163531501),s=m(s,c,p,f,l[d+13],5,-1444681467),f=m(f,s,c,p,l[d+2],9,-51403784),p=m(p,f,s,c,l[d+7],14,1735328473),c=m(c,p,f,s,l[d+12],20,-1926607734),s=g(s,c,p,f,l[d+5],4,-378558),f=g(f,s,c,p,l[d+8],11,-2022574463),p=g(p,f,s,c,l[d+11],16,1839030562),c=g(c,p,f,s,l[d+14],23,-35309556),s=g(s,c,p,f,l[d+1],4,-1530992060),f=g(f,s,c,p,l[d+4],11,1272893353),p=g(p,f,s,c,l[d+7],16,-155497632),c=g(c,p,f,s,l[d+10],23,-1094730640),s=g(s,c,p,f,l[d+13],4,681279174),f=g(f,s,c,p,l[d+0],11,-358537222),p=g(p,f,s,c,l[d+3],16,-722521979),c=g(c,p,f,s,l[d+6],23,76029189),s=g(s,c,p,f,l[d+9],4,-640364487),f=g(f,s,c,p,l[d+12],11,-421815835),p=g(p,f,s,c,l[d+15],16,530742520),c=g(c,p,f,s,l[d+2],23,-995338651),s=y(s,c,p,f,l[d+0],6,-198630844),f=y(f,s,c,p,l[d+7],10,1126891415),p=y(p,f,s,c,l[d+14],15,-1416354905),c=y(c,p,f,s,l[d+5],21,-57434055),s=y(s,c,p,f,l[d+12],6,1700485571),f=y(f,s,c,p,l[d+3],10,-1894986606),p=y(p,f,s,c,l[d+10],15,-1051523),c=y(c,p,f,s,l[d+1],21,-2054922799),s=y(s,c,p,f,l[d+8],6,1873313359),f=y(f,s,c,p,l[d+15],10,-30611744),p=y(p,f,s,c,l[d+6],15,-1560198380),c=y(c,p,f,s,l[d+13],21,1309151649),s=y(s,c,p,f,l[d+4],6,-145523070),f=y(f,s,c,p,l[d+11],10,-1120210379),p=y(p,f,s,c,l[d+2],15,718787259),c=y(c,p,f,s,l[d+9],21,-343485551),s=s+b>>>0,c=c+w>>>0,p=p+v>>>0,f=f+k>>>0}return e.endian([s,c,p,f])};i._ff=function(o,a,l,u,s,c,p){var f=o+(a&l|~a&u)+(s>>>0)+p;return(f<<c|f>>>32-c)+a},i._gg=function(o,a,l,u,s,c,p){var f=o+(a&u|l&~u)+(s>>>0)+p;return(f<<c|f>>>32-c)+a},i._hh=function(o,a,l,u,s,c,p){var f=o+(a^l^u)+(s>>>0)+p;return(f<<c|f>>>32-c)+a},i._ii=function(o,a,l,u,s,c,p){var f=o+(l^(a|~u))+(s>>>0)+p;return(f<<c|f>>>32-c)+a},i._blocksize=16,i._digestsize=16,Ln.exports=function(o,a){if(o==null)throw new Error("Illegal argument "+o);var l=e.wordsToBytes(i(o,a));return a&&a.asBytes?l:a&&a.asString?n.bytesToString(l):e.bytesToHex(l)}}()),Ln.exports}var mp=hp();const gp=Ai(mp),yp="7ae48d46-10f2-kitty-";function bp(){let e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="";for(let t=0;t<6;++t){let n=Math.floor(Math.random()*e.length);r+=e.substring(n,n+1)}return r}function Do(e){return gp(yp+e)}var vp=Z("<button class=btn>Copy"),wp=Z('<div class="toast toast-center toast-middle">'),kp=Z('<div><div><div class=pb-2><label><div style=display:inline-block;padding-right:5px;>Nickname:</div><input type=text class=input></label></div></div><div><button class="btn btn-outline btn-primary ml-1">Invite</button><button class="btn btn-outline btn-primary ml-1">Join</button></div><div><div>Connections:<table class="table table-zebra"><thead><tr><th></th><th>Nickname</th><th></th></tr></thead><tbody></tbody></table></div><div>Pending Invites:<table class="table table-zebra"><thead><tr><th></th><th>Invite Code</th><th></th></tr></thead><tbody></tbody></table></div></div><dialog class=modal><div class=modal-box>Invite Code:<input type=text class="input ml-2"><button class="btn btn-primary">Paste</button><div class=modal-action><button class="btn btn-primary">OK</button><form method=dialog><button class=btn>Close'),xp=Z('<tr><td></td><td></td><td><button class="btn btn-primary">Kick'),_p=Z('<tr><td></td><td></td><td><button class="btn btn-primary">Copy</button><button class="btn btn-primary ml-1">Delete'),Sp=Z('<div class="alert alert-info">');function Cp(e){let[r,t]=Me({nickname:jd.generateUsername("_"),connections:[],pendingInvites:[],toastStack:[],joinDialogInviteCode:""}),[n,i]=K(),o=C(()=>r.connections.map(f=>f.value)),a=f=>{let d={};t("toastStack",kr(m=>m.push(new Xr({id:d,Render:f}))));let h=setTimeout(()=>{t("toastStack",r.toastStack.filter(m=>m.value.id!==d)),clearTimeout(h)},5e3)},l=()=>{let[f,d]=K(!1),h=bp(),m=Do(h),g=new Ao(m),y={inviteCode:h,peer:g};g.on("open",()=>{g.on("connection",b=>{b.once("data",w=>{typeof w=="string"&&(t("connections",kr(v=>v.push(new Xr({nickname:w,peer:g,conn:b})))),b.send({nickname:r.nickname,documentUrl:e.documentUrl()??null}),t("pendingInvites",r.pendingInvites.filter(v=>v.value!=y)))}),b.once("close",()=>{t("connections",r.connections.filter(w=>w.value.peer!==g))})}),t("pendingInvites",kr(b=>b.push(new Xr(y)))),a(()=>["Invite Code: ",h,(()=>{var b=vp();return b.$$click=async()=>{await navigator.clipboard.writeText(h),d(!0);let w=setTimeout(()=>{clearTimeout(w),d(!1)},1e3)},b})(),M(de,{get when(){return f()},children:"Copied"})])})},u=()=>{t("joinDialogInviteCode",""),n()?.showModal()},s=()=>{n()?.close();let f=r.joinDialogInviteCode;t("joinDialogInviteCode","");let d=Do(f),h=new Ao;h.on("open",()=>{let m=h.connect(d);m.on("open",()=>{m.once("data",g=>{let y=g.nickname,b=g.documentUrl;typeof y=="string"&&typeof b=="string"&&(e.setDocumentUrl(b),t("connections",kr(w=>w.push(new Xr({nickname:y,peer:h,conn:m})))))}),m.send(r.nickname),m.once("close",()=>{t("connections",r.connections.filter(g=>g.value.peer!==h))})})})},c=f=>{f.peer.destroy()};return{connections:o,Render:()=>(()=>{var f=kp(),d=f.firstChild,h=d.firstChild,m=h.firstChild,g=m.firstChild,y=g.nextSibling,b=d.nextSibling,w=b.firstChild,v=w.nextSibling,k=b.nextSibling,_=k.firstChild,S=_.firstChild,P=S.nextSibling,T=P.firstChild,$=T.nextSibling,x=_.nextSibling,I=x.firstChild,F=I.nextSibling,N=F.firstChild,R=N.nextSibling,O=k.nextSibling,L=O.firstChild,B=L.firstChild,U=B.nextSibling,H=U.nextSibling,ne=H.nextSibling,ce=ne.firstChild;f.style.setProperty("width","100%"),f.style.setProperty("height","100%"),f.style.setProperty("display","flex"),f.style.setProperty("flex-direction","column"),f.style.setProperty("padding","10px"),f.style.setProperty("position","relative"),y.$$input=z=>{t("nickname",z.currentTarget.validationMessage)},w.$$click=()=>l(),v.$$click=()=>u(),k.style.setProperty("flex-grow","1"),k.style.setProperty("display","flex"),k.style.setProperty("flex-direction","column"),k.style.setProperty("margin-top","10px"),_.style.setProperty("flex-grow","1"),_.style.setProperty("overflow-y","auto"),Y($,M(st,{get each(){return r.connections},children:z=>(()=>{var oe=xp(),ye=oe.firstChild,he=ye.nextSibling,q=he.nextSibling,re=q.firstChild;return Y(he,()=>z.value.nickname),re.$$click=()=>{c(z.value)},oe})()})),x.style.setProperty("flex-grow","1"),x.style.setProperty("overflow-y","auto"),Y(R,M(st,{get each(){return r.pendingInvites},children:z=>{let[oe,ye]=K(!1);return(()=>{var he=_p(),q=he.firstChild,re=q.nextSibling,pe=re.nextSibling,Oe=pe.firstChild,et=Oe.nextSibling;return Y(re,()=>z.value.inviteCode),Oe.$$click=async()=>{await navigator.clipboard.writeText(z.value.inviteCode),ye(!0);let at=setTimeout(()=>{clearTimeout(at),ye(!1)},1e3)},et.$$click=()=>{z.value.peer.destroy(),t("pendingInvites",r.pendingInvites.filter(at=>at.value!==z.value))},Y(pe,M(de,{get when(){return oe()},children:"Copied"}),null),he})()}})),Y(f,M(de,{get when(){return r.toastStack.length!=0},get children(){var z=wp();return Y(z,M(st,{get each(){return r.toastStack},children:oe=>(()=>{var ye=Sp();return Y(ye,M(oe.value.Render,{})),ye})()})),z}}),O);var fe=i;return typeof fe=="function"?ve(fe,O):i=O,U.addEventListener("change",()=>{s()}),U.$$input=z=>{t("joinDialogInviteCode",z.currentTarget.value)},H.$$click=async()=>{let z=await navigator.clipboard.readText();t("joinDialogInviteCode",z)},ce.$$click=()=>s(),Q(()=>y.value=r.nickname),Q(()=>U.value=r.joinDialogInviteCode),f})()}}$e(["click","input"]);class Pp extends zd{#e=!1;#n;connection;#r=!1;#i;#a=new Promise(r=>{this.#i=r});#t=[];isReady(){return this.#r}whenReady(){return this.#a}#s(){this.#r||(this.#r=!0,this.#i?.())}constructor(r){super(),this.#n=r,this.connection=r.connection}connect(r,t){this.peerId=r,this.peerMetadata=t,this.#e=!1,this.connection.on("data",n=>{if(typeof n!="string")return;const i=JSON.parse(n);if(console.log("message in, ",i),"targetId"in i&&i.targetId!==this.peerId||this.#e)return;const{senderId:o,type:a}=i;switch(a){case"arrive":{const{peerMetadata:l}=i;this.connection.send(JSON.stringify({senderId:this.peerId,targetId:o,type:"welcome",peerMetadata:this.peerMetadata})),this.#o(o,l)}break;case"welcome":{const{peerMetadata:l}=i;this.#o(o,l)}break;case"leave":this.#t=this.#t.filter(l=>l!==o),this.emit("peer-disconnected",{peerId:o});break;default:if(!("data"in i))this.emit("message",i);else{if(!i.data)throw new Error("We got a message without data, we can't send this.");const l=i.data;this.emit("message",{...i,data:new Uint8Array(l)})}break}}),this.connection.send(JSON.stringify({senderId:this.peerId,type:"arrive",peerMetadata:t}))}#o(r,t){this.#s(),this.#t.push(r),this.emit("peer-candidate",{peerId:r,peerMetadata:t})}send(r){if(this.#e)return!1;if("data"in r){let t=r.data?r.data.buffer.slice(r.data.byteOffset,r.data.byteOffset+r.data.byteLength):void 0,n=t==null?void 0:Array.from(new Uint8Array(t));this.connection.send(JSON.stringify({...r,data:n}))}else this.connection.send(JSON.stringify(r))}disconnect(){this.connection.send(JSON.stringify({senderId:this.peerId,type:"leave"}));for(const r of this.#t)this.emit("peer-disconnected",{peerId:r});this.#e=!0}}const Tp=261.63,Lo=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}];class $p{audioContext=void 0;pianoNodes=[];constructor(){}async init(){if(this.audioContext){this.audioContext.state==="suspended"?await this.audioContext.resume():this.audioContext.state==="running"&&await this.audioContext.suspend();return}this.audioContext=new AudioContext,await this.audioContext.audioWorklet.addModule(yi),await this.audioContext.audioWorklet.addModule(al),await this.audioContext.audioWorklet.addModule(sl),await this.audioContext.audioWorklet.addModule(ll);let r=this.audioContext.createGain();r.gain.value=.1,r.connect(this.audioContext.destination),this.pianoNodes=[];for(let t=0;t<12;++t){let n=new AudioWorkletNode(this.audioContext,"piano-processor");n.connect(r),this.pianoNodes.push(n)}}async noteOn(r){if(this.audioContext==null){await this.init();return}this.audioContext.state==="suspended"&&await this.audioContext.resume();let t=Lo.findIndex(i=>i.name==r);if(t==-1)return;let n=Tp*Math.pow(2,t/12);this.pianoNodes[t].port.postMessage({type:"noteOn",frequency:n})}async noteOff(r){this.audioContext==null&&await this.init();let t=Lo.findIndex(n=>n.name==r);t!=-1&&this.pianoNodes[t].port.postMessage({type:"noteOff"})}play(){this.init()}}const Ep=`
class SineProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = Math.sin(this.phase); // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('sine-processor', SineProcessor);
`,Ip=new Blob([Ep],{type:"application/javascript"}),yi=URL.createObjectURL(Ip),Rp=`
class SawProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = this.phase; // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('saw-processor', SawProcessor);
`,Ap=new Blob([Rp],{type:"application/javascript"}),al=URL.createObjectURL(Ap),Mp=`
class SquareProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = (this.phase < Math.PI ? 0 : 1); // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('square-processor', SquareProcessor);
`,Np=new Blob([Mp],{type:"application/javascript"}),sl=URL.createObjectURL(Np),Op=`
class PianoProcessor extends AudioWorkletProcessor {
    constructor() {
        super();
        this.phase = 0;
        this.sampleRate = sampleRate; // Global sampleRate from AudioWorkletGlobalScope

        // Define harmonics (fundamental + a few overtones) and their relative gains
        // These values are simplified and can be tweaked for different piano sounds
        this.harmonics = [
            { freqMultiplier: 1, gain: 1.0 },   // Fundamental
            { freqMultiplier: 2, gain: 0.6 },   // 1st overtone (octave)
            { freqMultiplier: 3, gain: 0.4 },   // 2nd overtone (fifth above octave)
            { freqMultiplier: 4, gain: 0.3 },   // 3rd overtone (two octaves)
            { freqMultiplier: 5, gain: 0.2 },   // 4th overtone (major third)
        ];

        // ADSR envelope parameters (simplified)
        this.attackTime = 0.01; // Very fast attack
        this.decayTime = 0.1;
        this.sustainLevel = 0.6;
        this.releaseTime = 0.8;

        this.envelopePhase = 0; // 0: idle, 1: attack, 2: decay, 3: sustain, 4: release
        this.currentGain = 0;
        this.noteOnTime = 0;
        this.noteOffTime = 0;
        this.frequency = 0; // Will be set via port.onmessage

        this.port.onmessage = (event) => {
            if (event.data.type === 'noteOn') {
                this.frequency = event.data.frequency;
                this.noteOnTime = currentTime; // Global currentTime from AudioWorkletGlobalScope
                this.envelopePhase = 1; // Start attack
                this.phase = 0; // Reset phase for new note
            } else if (event.data.type === 'noteOff') {
                this.noteOffTime = currentTime;
                this.envelopePhase = 4; // Start release
            }
        };
    }

    process(inputs, outputs, parameters) {
        const output = outputs[0]; // Assuming mono output for simplicity
        const channel = output[0]; // Get the first channel

        for (let i = 0; i < channel.length; ++i) {
            let sample = 0;

            // Update envelope
            if (this.envelopePhase === 1) { // Attack
                const timeElapsed = currentTime - this.noteOnTime;
                if (timeElapsed < this.attackTime) {
                    this.currentGain = timeElapsed / this.attackTime;
                } else {
                    this.currentGain = 1.0;
                    this.envelopePhase = 2; // Move to decay
                    this.decayStartTime = currentTime;
                }
            } else if (this.envelopePhase === 2) { // Decay
                const timeElapsed = currentTime - this.decayStartTime;
                if (timeElapsed < this.decayTime) {
                    this.currentGain = 1.0 - (1.0 - this.sustainLevel) * (timeElapsed / this.decayTime);
                } else {
                    this.currentGain = this.sustainLevel;
                    this.envelopePhase = 3; // Move to sustain
                }
            } else if (this.envelopePhase === 3) { // Sustain (maintain currentGain)
                // Nothing to do, just hold the sustain level
            } else if (this.envelopePhase === 4) { // Release
                const timeElapsed = currentTime - this.noteOffTime;
                if (timeElapsed < this.releaseTime) {
                    this.currentGain = this.sustainLevel * (1.0 - (timeElapsed / this.releaseTime));
                } else {
                    this.currentGain = 0;
                    this.envelopePhase = 0; // Go to idle
                    this.frequency = 0; // Stop generating sound
                }
            }

            // Generate sound if frequency and gain are active
            if (this.frequency > 0 && this.currentGain > 0.001) { // Threshold to prevent silence from generating
                for (const harmonic of this.harmonics) {
                    const freq = this.frequency * harmonic.freqMultiplier;
                    sample += Math.sin(this.phase * freq * 2 * Math.PI) * harmonic.gain;
                }
                sample *= this.currentGain; // Apply envelope gain
            } else {
                sample = 0; // No sound
            }

            channel[i] = sample;

            // Advance phase for the next sample
            this.phase += 1 / this.sampleRate;
            if (this.phase >= 1) {
                this.phase -= 1; // Keep phase within [0, 1)
            }
        }

        // Return false when the sound is completely silent to allow garbage collection
        //return this.envelopePhase !== 0 || this.currentGain > 0.001;
        return true;
    }
}

registerProcessor('piano-processor', PianoProcessor);`,Fp=new Blob([Op],{type:"application/javascript"}),ll=URL.createObjectURL(Fp);window.addEventListener("beforeunload",()=>{yi&&(URL.revokeObjectURL(yi),URL.revokeObjectURL(al),URL.revokeObjectURL(sl),URL.revokeObjectURL(ll))});var zp=Z("<div class=piano>"),Dp=Z("<div class=white-key>"),Lp=Z("<div class=black-key>");const Up=e=>{const r=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}],t=150,n=80;let i,o=new Gt,a=new ut;return(()=>{var l=zp();l.$$pointermove=s=>{if(!o.get(s.pointerId))return;let c=i.getBoundingClientRect();o.set(s.pointerId,ci.create(s.clientX-c.left,s.clientY-c.top))},l.addEventListener("pointercancel",s=>{o.delete(s.pointerId),i.releasePointerCapture(s.pointerId)}),l.$$pointerup=s=>{o.delete(s.pointerId),i.releasePointerCapture(s.pointerId)},l.$$pointerdown=s=>{let c=i.getBoundingClientRect();o.set(s.pointerId,ci.create(s.clientX-c.left,s.clientY-c.top)),i.setPointerCapture(s.pointerId)};var u=i;return typeof u=="function"?ve(u,l):i=l,l.style.setProperty("display","flex"),l.style.setProperty("flex-direction","row"),l.style.setProperty("overflow-x","auto"),l.style.setProperty("user-select","none"),l.style.setProperty("touch-action","none"),Y(l,M(st,{each:r,children:s=>{let[c,p]=K();s.type=="black"&&ge(()=>{let d=c();d!=null&&(a.add(d),Te(()=>a.delete(d)))});let f=C(()=>{let d=c();if(d==null)return!1;let h=i.getBoundingClientRect(),m=d.getBoundingClientRect();for(let g of o.values()){let y=h.left+g.x-m.left,b=h.top+g.y-m.top;if(0<y&&y<m.width&&0<b&&b<m.height){if(s.type=="white")for(let w of a){let v=w.getBoundingClientRect(),k=h.left+g.x-v.left,_=h.top+g.y-v.top;if(0<k&&k<v.width&&0<_&&_<v.height)return!1}return!0}}return!1});return ge(se(f,d=>{d?e.onNoteOn(s.name):e.onNoteOff(s.name)},{defer:!0})),M(Oi,{get children(){return[M(Ht,{get when(){return s.type=="white"},get children(){var d=Dp(),h=p;return typeof h=="function"?ve(h,d):p=d,d.style.setProperty("width","50px"),d.style.setProperty("pointer-events","none"),Q(m=>{var g=!!f(),y=`${t+(f()?2:0)}px`;return g!==m.e&&d.classList.toggle("pressed",m.e=g),y!==m.t&&((m.t=y)!=null?d.style.setProperty("height",y):d.style.removeProperty("height")),m},{e:void 0,t:void 0}),d}}),M(Ht,{get when(){return s.type=="black"},get children(){var d=Lp(),h=p;return typeof h=="function"?ve(h,d):p=d,d.style.setProperty("margin-left","-16px"),d.style.setProperty("margin-right","-14px"),d.style.setProperty("width","30px"),d.style.setProperty("pointer-events","none"),Q(m=>{var g=!!f(),y=`${n+(f()?2:0)}px`;return g!==m.e&&d.classList.toggle("pressed",m.e=g),y!==m.t&&((m.t=y)!=null?d.style.setProperty("height",y):d.style.removeProperty("height")),m},{e:void 0,t:void 0}),d}})]}})}})),l})()};$e(["pointerdown","pointerup","pointermove"]);function D(e){return{type:"MaybeUndefined",element:e}}function jp(){return{type:"Boolean"}}function Je(){return{type:"Number"}}function mt(){return{type:"String"}}function W(e){return{type:"Object",properties:e}}function ee(e){return{type:"Array",element:e}}function qi(e,r,t){return{type:"Invarant",fromFn:e,toFn:r,inner:t}}function cl(e,r){return{type:"Default",value:e,inner:r}}function De(e,r){switch(e.type){case"Boolean":return typeof r!="boolean"?Ke("Expected a boolean."):ke(r);case"Number":return typeof r!="number"?Ke("Expected a number."):ke(r);case"String":return typeof r!="string"?Ke("Expected a string."):ke(r);case"MaybeUndefined":return r==null?ke(void 0):De(e.element,r);case"MaybeNull":return r==null?ke(null):De(e.element,r);case"Union":{let t=r[e.selector];if(typeof t!="string")return Ke("Missing type param for union.");let n={...r};delete n[e.selector];let i=W(e.parts[t]),o=De(i,n);if(o.type=="Err")return Ke(`Problem parsing union part ${t}: ${o.message}`);let l={...o.value};return l[e.selector]=t,ke(l)}case"Array":{let t=[];for(let n of r){let i=De(e.element,n);if(i.type=="Err")return i;t.push(i.value)}return ke(t)}case"Object":{let t={};for(let n of Object.keys(e.properties)){let i=e.properties[n];Object.hasOwn(r,n)||(t[n]=Ze(i));let o=De(e.properties[n],r[n]);if(o.type=="Err")return Ke(`Problem parsing field ${n}: ${o.message}`);t[n]=o.value}return ke(t)}case"Recursive":{let t=e.inner();return De(t,r)}case"Invarant":{let t=e.fromFn,n=De(e.inner,r);return n.type=="Err"?n:ke(t(n.value))}case"Default":{let t=e.inner,n;try{n=De(t,r)}catch(i){n=Ke(""+i)}return n.type=="Err"?ke(e.value):ke(n.value)}case"Json":return ke(r)}}function Ze(e){switch(e.type){case"Boolean":return!1;case"Number":return 0;case"String":return"";case"MaybeUndefined":return;case"MaybeNull":return null;case"Union":{let r=Object.keys(e.parts)[0],t=Ze(W(e.parts[r]));return t[e.selector]=r,t}case"Array":return[];case"Object":{let r={};for(let t of Object.keys(e.properties)){let n=e.properties[t];r[t]=Ze(n)}return r}case"Recursive":{let r=e.inner();return Ze(r)}case"Invarant":{let r=e.fromFn,t=Ze(e.inner);return r(t)}case"Default":return e.value;case"Json":return null}}function He(e,r){switch(e.type){case"Boolean":return r;case"Number":return r;case"String":return r;case"MaybeUndefined":return r==null?null:He(e.element,r);case"MaybeNull":return r==null?null:He(e.element,r);case"Union":{let t=r[e.selector],n={...r};delete n[e.selector];let i=He(W(e.parts[t]),n);return i[e.selector]=t,i}case"Object":{let t={};for(let n of Object.keys(e.properties))t[n]=He(e.properties[n],r[n]);return t}case"Array":return r.map(t=>He(e.element,t));case"Recursive":{let t=e.inner();return He(t,r)}case"Invarant":{let t=e.toFn,n=t(r);return He(e.inner,n)}case"Default":return He(e.inner,r);case"Json":return r}}function Vi(e,r,t){if(typeof e!="object"||e.type!="Object")return Ke("Only projections of objects are supported");let n={};for(let[i,o]of Object.entries(e.properties)){let a=o;Object.defineProperty(n,i,{get(){let l=r?.[i];if(typeof o=="object"){if(o.type=="Object"){let s=Vi(a,l,c=>t(p=>c(p[i])));if(s.type=="Err")throw new Error("Unreachable");return s.value}if(o.type=="Array"){let s=ul(a,l,c=>t(p=>{c(p[i])}));if(s.type=="Err")throw new Error("Unreachable");return s.value}}let u=De(a,l);return u.type=="Err"?Ze(a):u.value},set(l){let u=He(a,l);JSON.stringify(r[i])!=JSON.stringify(u)&&t(s=>s[i]=u)}})}return ke(n)}function ul(e,r,t){if(typeof e!="object"||e.type!="Array")return Ke("Expected an array for projection");let n=e.element,i=[],o=new Proxy(i,{get(a,l,u){if(l=="length")return i.length=r.length,r.length;if(typeof l=="string"&&!Number.isNaN(Number.parseInt(l))){let s=Number.parseInt(l),c=r?.[s];if(typeof n=="object"){if(n.type=="Object"){let f=Vi(n,c,d=>t(h=>{d(h[s])}));if(f.type=="Err")throw new Error("Unreachable");return f.value}if(n.type=="Array"){let f=ul(n,c,d=>t(h=>{d(h[l])}));if(f.type=="Err")throw new Error("Unreachable");return f.value}}let p=De(n,c);return p.type=="Err"?Ze(n):p.value}return Reflect.get(i,l,i)},set(a,l,u,s){if(typeof l=="string"&&!Number.isNaN(Number.parseInt(l))){let c=Number.parseInt(l),p=He(n,u);if(JSON.stringify(r[c])==JSON.stringify(u))return!1;t(f=>f[c]=p)}return Reflect.set(i,l,u,i)}});return ke(o)}function kn(e,r,t){if(typeof t!="object"||t.type!="Object")throw new Error("Expected object.");{let o=Uo.get(e);if(o!=null)return o}let n=t.properties,i=new Proxy({},{defineProperty(o,a,l){return Reflect.defineProperty(o,a,l)},deleteProperty(o,a){return Reflect.deleteProperty(o,a)},getOwnPropertyDescriptor(o,a){if(n[a]!=null){let l=Reflect.getOwnPropertyDescriptor(n,a);return l==null?void 0:(l={...l},l.value=i[a],l)}return Reflect.getOwnPropertyDescriptor(o,a)},getPrototypeOf(o){return Reflect.getPrototypeOf(o)},has(o,a){return n[a]!=null?!0:Reflect.has(o,a)},isExtensible(o){return Reflect.isExtensible(o)},ownKeys(o){return[...Reflect.ownKeys(n),...Reflect.ownKeys(o)]},preventExtensions(o){return Reflect.preventExtensions(o)},setPrototypeOf(o,a){return Reflect.setPrototypeOf(o,a)},get(o,a,l){if(typeof a=="symbol")return o[a];if(typeof a=="string"){let u=n[a];if(u!=null){if(u.type=="Object")return kn(e[a],c=>r(p=>c(p[a])),u);if(u.type=="Array")return bi(e[a],c=>r(p=>c(p[a])),u);let s=De(u,e[a]);return s.type=="Err"?Ze(u):s.value}}return Reflect.get(o,a,l)},set(o,a,l,u){if(typeof a=="symbol")return o[a]=l,!0;if(typeof a=="string"){let s=n[a];if(s!=null){let c=He(s,l);return r(p=>p[a]=c),!0}}return Reflect.set(o,a,l,u)}});return Uo.set(e,i),i}function bi(e,r,t){if(typeof t!="object"||t.type!="Array")throw new Error("Expected object.");{let a=jo.get(e);if(a!=null)return a}let n=t.element,i=function*(){for(let a=0;a<e.length;++a)yield o[a]},o=new Proxy([void 0],{defineProperty(a,l,u){return Reflect.defineProperty(a,l,u)},deleteProperty(a,l){return Reflect.deleteProperty(a,l)},getOwnPropertyDescriptor(a,l){let u=typeof l=="string"?Number.parseInt(l):void 0;if(Number.isNaN(u)&&(u=void 0),u!=null){let c=Reflect.getOwnPropertyDescriptor(a,0);return c==null?void 0:(c={...c},c.value=o[l],c)}let s=Reflect.getOwnPropertyDescriptor(a,l);if(s!=null)return l==="length"&&(s={...s},s.value=e.length),s},getPrototypeOf(a){return Reflect.getPrototypeOf(a)},has(a,l){let u=typeof l=="string"?Number.parseInt(l):void 0;return Number.isNaN(u)&&(u=void 0),u!=null?0<=u&&u<e.length:Reflect.has(a,l)},isExtensible(a){return Reflect.isExtensible(a)},ownKeys(a){return[...Array(e.length).fill(void 0).map((l,u)=>u.toString()),...Reflect.ownKeys(a).filter(l=>l!="0")]},preventExtensions(a){return Reflect.preventExtensions(a)},setPrototypeOf(a,l){return Reflect.setPrototypeOf(a,l)},get(a,l,u){if(l==Symbol.iterator)return i;if(typeof l=="symbol")return a[l];if(l==="length")return e.length;if(l==="findIndex")return function(s,c){console.log("Intercepted findIndex call!");const p=[];for(let f=0;f<e.length;f++)if(n.type=="Object")p.push(kn(e[f],d=>r(h=>d(h[f])),n));else if(n.type=="Array")p.push(bi(e[f],d=>r(h=>d(h[f])),n));else{let d=De(n,e[f]);d.type=="Err"?p.push(Ze(n)):p.push(d.value)}return Array.prototype.findIndex.call(p,s,c)};if(typeof l=="string"){let s=typeof l=="string"?Number.parseInt(l):void 0;if(Number.isNaN(s)&&(s=void 0),s!=null&&0<=s&&s<e.length){if(n.type=="Object")return kn(e[s],p=>r(f=>p(f[l])),n);if(n.type=="Array")return bi(e[s],p=>r(f=>p(f[l])),n);let c=De(n,e[s]);return c.type=="Err"?Ze(n):c.value}}return Reflect.get(a,l,u)},set(a,l,u,s){if(typeof l=="symbol")return a[l]=u,!0;if(l==="length"){let p=u-e.length;if(p>0){let f=Array(p).fill(void 0).map(d=>Ze(n));r(d=>d.push(...f))}else p<0&&r(f=>f.splice(e.length+p,-p));return!0}if(typeof l=="string"){let c=typeof l=="string"?Number.parseInt(l):void 0;if(Number.isNaN(c)&&(c=void 0),c!=null){let p=He(n,u);return r(f=>f[l]=p),!0}}return Reflect.set(a,l,u,s)}});return jo.set(e,o),o}let Uo=new WeakMap,jo=new WeakMap;class X{typeName;typeSchema;constructor(r){this.typeName=r.typeName,this.typeSchema=r.typeSchema}create(r){let[t,n]=Me(r);return new Qr({type:this,state:t,setState:n})}createJsonProjectionV3(r,t){let n=kn(r,t,this.typeSchema),[i,o]=me(()=>Me(n));return ke(new Qr({type:this,state:n,setState:o}))}createJsonProjectionV2(r,t){let n=Vi(this.typeSchema,r,t);if(n.type=="Err")return Ke(n.message);let i=n.value,[o,a]=me(()=>Me(i));return ke(new Qr({type:this,state:o,setState:a}))}createJsonProjection(r,t){let n=C(()=>De(this.typeSchema,r())),i=C(()=>{let l=n();return l.type=="Err"?l:ke(n)},void 0,{equals:(l,u)=>l.type=="Ok"&&u.type=="Ok"?l.value==u.value:!1}),o=C(()=>{let l=i();return l.type=="Err"?l:ke(C(()=>l.value().value))}),a=C(()=>{let l=o();if(l.type=="Err")return l;let u=l.value;return ke(C(()=>{let[s,c]=Me(me(u));ge(se(u,f=>c(f),{defer:!0}));let p=C(()=>{let f=He(this.typeSchema,s);return{json:f,jsonString:JSON.stringify(f)}},void 0,{equals:(f,d)=>f.jsonString==d.jsonString});return ge(se(()=>p().json,f=>{t(f)},{defer:!0})),new Qr({type:this,state:s,setState:c})}))});return C(()=>{let l=a();return l.type=="Err"?l:ke(l.value())})}}class Qr{type;state;setState;constructor(r){this.type=r.type,this.state=r.state,this.setState=r.setState}}const Bp=W({childIds:ee(mt())}),_r=new X({typeName:"Children",typeSchema:Bp}),qp=W({parentId:mt()}),Sr=new X({typeName:"Parent",typeSchema:qp}),Vp=W({orderIndex:Je()}),Gp=new X({typeName:"SortOrderIndex",typeSchema:Vp});class Gi{componentTypes;componentTypeMap;constructor(r){this.componentTypes=r,this.componentTypeMap=new Map(r.map(t=>[t.typeName,t]))}}const dl=new Gi([_r,Sr,Gp]);class G{x;y;constructor(r,t){this.x=r,this.y=t}static create(r,t){return new G(r,t)}static zero=G.create(0,0);static unitX=G.create(1,0);static unitY=G.create(0,1);add(r){return G.create(this.x+r.x,this.y+r.y)}sub(r){return G.create(this.x-r.x,this.y-r.y)}multScalar(r){return G.create(this.x*r,this.y*r)}cross(r){return this.x*r.y-this.y*r.x}distanceSquared(r){let t=r.x-this.x,n=r.y-this.y;return t*t+n*n}distance(r){return Math.sqrt(this.distanceSquared(r))}lengthSquared(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.lengthSquared())}normalize(){return this.multScalar(1/this.length())}}class xe{x;y;static rot0=new xe(1,0);constructor(r,t){this.x=r,this.y=t}static xy(r){return new xe(r.x,r.y)}static fromAngle(r){let t=r*Math.PI/180;return new xe(Math.cos(t),Math.sin(t))}get u(){return G.create(this.x,this.y)}get v(){return G.create(-this.y,this.x)}getLengthSquared(){return this.x*this.x+this.y*this.y}getLength(){return Math.sqrt(this.getLengthSquared())}normalize(){let r=this.getLength();return new xe(this.x/r,this.y/r)}times(r){let t=this;return new xe(t.x*r.x-t.y*r.y,t.x*r.y+t.y*r.x)}conjugate(){return new xe(this.x,-this.y)}rotate(r){let t=this.x,n=this.y,i=-n,o=t;return G.create(r.x*t+r.y*i,r.x*n+r.y*o)}getAngle(){return(r=>r*180/Math.PI)(Math.atan2(this.y,this.x))}}class j{_x;_y;_z;static zero;static zero_$LI$(){return j.zero==null&&(j.zero=j.create(0,0,0)),j.zero}static unitX;static unitX_$LI$(){return j.unitX==null&&(j.unitX=j.create(1,0,0)),j.unitX}static unitY;static unitY_$LI$(){return j.unitY==null&&(j.unitY=j.create(0,1,0)),j.unitY}static unitZ;static unitZ_$LI$(){return j.unitZ==null&&(j.unitZ=j.create(0,0,1)),j.unitZ}static negUnitX;static negUnitX_$LI$(){return j.negUnitX==null&&(j.negUnitX=j.create(-1,0,0)),j.negUnitX}static negUnitY;static negUnitY_$LI$(){return j.negUnitY==null&&(j.negUnitY=j.create(0,-1,0)),j.negUnitY}static negUnitZ;static negUnitZ_$LI$(){return j.negUnitZ==null&&(j.negUnitZ=j.create(0,0,-1)),j.negUnitZ}constructor(r,t,n){this._x=r,this._y=t,this._z=n}static create(r,t,n){return new j(r,t,n)}get x(){return this._x}get y(){return this._y}get z(){return this._z}xy(){return G.create(this._x,this._y)}xz(){return G.create(this._x,this._z)}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}add(r){return j.create(this.x+r.x,this.y+r.y,this.z+r.z)}sub(r){return j.create(this.x-r.x,this.y-r.y,this.z-r.z)}scale(r){return j.create(this.x*r,this.y*r,this.z*r)}negate(){return j.create(-this.x,-this.y,-this.z)}cross(r){return j.create(this.y*r.z-this.z*r.y,this.z*r.x-this.x*r.z,this.x*r.y-this.y*r.x)}normalize(){let r=this.length();return j.create(this.x/r,this.y/r,this.z/r)}lengthSquared(){return this.dot(this)}length(){return Math.sqrt(this.lengthSquared())}distanceSquared(r){let t=this.x-r.x,n=this.y-r.y,i=this.z-r.z;return t*t+n*n+i*i}distance(r){return Math.sqrt(this.distanceSquared(r))}lerp(r,t){return j.create(this.x+(r.x-this.x)*t,this.y+(r.y-this.y)*t,this.z+(r.z-this.z)*t)}toJSON(){return{x:this.x,y:this.y,z:this.z}}static fromJSON(r){return j.create(r.x,r.y,r.z)}toString(){return"("+(""+this.x)+", "+(""+this.y)+", "+(""+this.z)+")"}}j.negUnitZ_$LI$();j.negUnitY_$LI$();j.negUnitX_$LI$();j.unitZ_$LI$();j.unitY_$LI$();j.unitX_$LI$();j.zero_$LI$();class Lt{_n;_d;constructor(r,t){this._n=r,this._d=t}static create(r,t){return new Lt(r,t)}static fromKnownPtAndNormal(r,t){return Lt.create(t,-t.dot(r))}get n(){return this._n}get d(){return this._d}moveInNormalDirection(r){return new Lt(this.n,this.d-r*this.n.length())}closestPoint(r){let t=-(this.d+r.dot(this.n))/this.n.dot(this.n);return r.add(this.n.scale(t))}threePlaneIntersection(r,t){let n=this,i=n.closestPoint(j.zero_$LI$()),o=r.closestPoint(j.zero_$LI$()),a=t.closestPoint(j.zero_$LI$()),l=n.n,u=r.n,s=t.n,c=u.cross(s).scale(i.dot(l)).add(s.cross(l).scale(o.dot(u))).add(l.cross(u).scale(a.dot(s))),p=l.x,f=l.y,d=l.z,h=u.x,m=u.y,g=u.z,y=s.x,b=s.y,w=s.z,v=p*(m*w-b*g)+h*(b*d-f*w)+y*(f*g-m*d);if(!(Math.abs(v)<.001))return c.scale(1/v)}fromSpace(r){let t=this.closestPoint(j.zero_$LI$()),n=r.vectorFromThisSpace(this.n),i=r.pointFromThisSpace(t);return Lt.fromKnownPtAndNormal(i,n)}toSpace(r){let t=this.closestPoint(j.zero_$LI$()),n=r.vectorToThisSpace(this.n),i=r.pointToThisSpace(t);return Lt.fromKnownPtAndNormal(i,n)}static xyPlane=Lt.create(j.unitZ,0)}class be{_w;_x;_y;_z;static identity;static identity_$LI$(){return be.identity==null&&(be.identity=be.Builder.fromWXYZ().setWXYZ(1,0,0,0).build()),be.identity}constructor(r,t,n,i){this._w=r,this._x=t,this._y=n,this._z=i}static fromAxisAngle(r,t){return be.Builder.fromAxisAngle().setAxis(r).setAngle(t).build()}static fromUV(r,t){return be.Builder.fromUVW().setU(r).setV(t).setW(r.cross(t)).build()}static fromVW(r,t){return be.Builder.fromUVW().setU(r.cross(t)).setV(r).setW(t).build()}static fromWU(r,t){return be.Builder.fromUVW().setU(t).setV(r.cross(t)).setW(r).build()}get w(){return this._w}get x(){return this._x}get y(){return this._y}get z(){return this._z}getLengthSquared(){return this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z}getLength(){return Math.sqrt(this.getLengthSquared())}normalize(){let r=this.getLength();return new be(this.w/r,this.x/r,this.y/r,this.z/r)}times(r){let t=this;return new be(t.w*r.w-t.x*r.x-t.y*r.y-t.z*r.z,t.w*r.x+t.x*r.w+t.y*r.z-t.z*r.y,t.w*r.y-t.x*r.z+t.y*r.w+t.z*r.x,t.w*r.z+t.x*r.y-t.y*r.x+t.z*r.w)}dotProduct(r){let t=this;return t.w*r.w+t.x*r.x+t.y*r.y+t.z*r.z}conjugate(){return new be(this.w,-this.x,-this.y,-this.z)}rotate$Quaternion(r){return this.times(r).times(this.conjugate())}rotate(r){if(r!=null&&r instanceof be||r===null)return this.rotate$Quaternion(r);if(r!=null&&r instanceof j||r===null)return this.rotate$Vec3(r);throw new Error("invalid overload")}rotate$Vec3(r){let t=this.times(be.Builder.fromWXYZ().setWXYZ(0,r.x,r.y,r.z).build()).times(this.conjugate());return j.create(t.x,t.y,t.z)}slerp(r,t,n){let i=this,o=r,a=i.dotProduct(o),l,u;if(1-Math.abs(a)<.01)l=1-t,u=t;else{let s=Math.acos(Math.abs(a)),c=Math.sin(s);l=Math.sin(s*(1-t))/c,u=Math.sin(s*t)/c}return n&&a<0&&(l=-l),new be(l*i.w+u*o.w,l*i.x+u*o.x,l*i.y+u*o.y,l*i.z+u*o.z)}toJSON(){return{w:this.w,x:this.x,y:this.y,z:this.z}}static fromJSON(r){return new be(r.w,r.x,r.y,r.z)}toString(){return"Quaternion "+this.w+" "+this.x+" "+this.y+" "+this.z}}be.__class="Quaternion";(e=>{class r{w;x;y;z;setW(a){return this.w=a,this}setWXYZ(a,l,u,s){return this.w=a,this.x=l,this.y=u,this.z=s,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}build(){return new e(this.w,this.x,this.y,this.z)}constructor(){this.w=0,this.x=0,this.y=0,this.z=0}}e.FromWXYZBuilder=r,r.__class="Quaternion.FromWXYZBuilder",r.__interfaces=["Quaternion.BuildStep","Quaternion.FromWXYZSetWStep","Quaternion.FromWXYZSetXStep","Quaternion.FromWXYZSetZStep","Quaternion.FromWXYZSetYStep"];class t{axisX;axisY;axisZ;angle;setAxisX(a){return this.axisX=a,this}setAxisXYZ(a,l,u){return this.axisX=a,this.axisY=l,this.axisZ=u,this}setAxis(a){return this.axisX=a.x,this.axisY=a.y,this.axisZ=a.z,this}setAxisY(a){return this.axisY=a,this}setAxisZ(a){return this.axisZ=a,this}setAngle(a){return this.angle=a,this}build(){let a=Math.sqrt(this.axisX*this.axisX+this.axisY*this.axisY+this.axisZ*this.axisZ);this.axisX/=a,this.axisY/=a,this.axisZ/=a;let l=Math.cos((s=>s*Math.PI/180)(.5*this.angle)),u=Math.sin((s=>s*Math.PI/180)(.5*this.angle));return new e(l,u*this.axisX,u*this.axisY,u*this.axisZ)}constructor(){this.axisX=0,this.axisY=0,this.axisZ=0,this.angle=0}}e.FromAxisAngleBuilder=t,t.__class="Quaternion.FromAxisAngleBuilder",t.__interfaces=["Quaternion.FromAxisAngleSetAxisYStep","Quaternion.FromAxisAngleSetAngleStep","Quaternion.FromAxisAngleSetAxisXStep","Quaternion.BuildStep","Quaternion.FromAxisAngleSetAxisZStep"];class n{u;v;w;setU(a){return this.u=a,this}setV(a){return this.v=a,this}setW(a){return this.w=a,this}build(){if(this.u==null||this.v==null||this.w==null)throw"Fields not all set";let a=this.u.x,l=this.u.y,u=this.u.z,s=this.v.x,c=this.v.y,p=this.v.z,f=this.w.x,d=this.w.y,h=this.w.z,m=a+c+h,g,y,b,w;if(m>0){let v=Math.sqrt(m+1)*2;g=.25*v,y=(p-d)/v,b=(f-u)/v,w=(l-s)/v}else if(((v,k)=>v&&k)(a>c,a>h)){let v=Math.sqrt(1+a-c-h)*2;g=(p-d)/v,y=.25*v,b=(s+l)/v,w=(f+u)/v}else if(c>h){let v=Math.sqrt(1+c-a-h)*2;g=(f-u)/v,y=(s+l)/v,b=.25*v,w=(d+p)/v}else{let v=Math.sqrt(1+h-a-c)*2;g=(l-s)/v,y=(f+u)/v,b=(d+p)/v,w=.25*v}return new e(g,y,b,w)}constructor(){this.u=null,this.v=null,this.w=null}}e.FromUVWBuilder=n,n.__class="Quaternion.FromUVWBuilder",n.__interfaces=["Quaternion.FromUVWSetUStep","Quaternion.BuildStep","Quaternion.FromUVWSetWStep","Quaternion.FromUVWSetVStep"];class i{static fromWXYZ(){return new e.FromWXYZBuilder}static fromAxisAngle(){return new e.FromAxisAngleBuilder}static fromUVW(){return new e.FromUVWBuilder}constructor(){}}e.Builder=i,i.__class="Quaternion.Builder"})(be||(be={}));be.identity_$LI$();class _e{origin;orientation;static identity=new _e(G.zero,xe.rot0);constructor(r,t){this.origin=r,this.orientation=t}static create(r,t){return new _e(r,t)}get u(){return this.orientation.u}get v(){return this.orientation.v}pointFromSpace(r){return this.orientation.rotate(r).add(this.origin)}pointToSpace(r){return this.orientation.conjugate().rotate(r.sub(this.origin))}vectorFromSpace(r){return this.orientation.rotate(r)}vectorToSpace(r){return this.orientation.conjugate().rotate(r)}transformFromSpace(r){return _e.create(this.pointFromSpace(r.origin),r.orientation.times(this.orientation))}transformToSpace(r){return _e.create(this.pointToSpace(r.origin),this.orientation.conjugate().times(r.orientation))}}class Fe{_origin;_orientation;static identity;static identity_$LI$(){return Fe.identity==null&&(Fe.identity=Fe.Builder.fromOriginOrientation().setOrigin(j.zero_$LI$()).setOrientation(be.identity_$LI$()).build()),Fe.identity}constructor(r,t){this._origin=r,this._orientation=t}static create(r,t){return new Fe(r,t)}get origin(){return this._origin}get orientation(){return this._orientation}get o(){return this.origin}get u(){return this.orientation.rotate$Vec3(j.unitX_$LI$())}get v(){return this.orientation.rotate$Vec3(j.unitY_$LI$())}get w(){return this.orientation.rotate$Vec3(j.unitZ_$LI$())}pointToThisSpace(r){return this.orientation.conjugate().rotate$Vec3(r.sub(this.origin))}vectorToThisSpace(r){return this.orientation.conjugate().rotate$Vec3(r)}toThisSpace(r){return Fe.Builder.fromOriginOrientation().setOrigin(this.pointToThisSpace(r.origin)).setOrientation(this.orientation.conjugate().times(r.orientation)).build()}pointFromThisSpace(r){return this.orientation.rotate$Vec3(r).add(this.origin)}vectorFromThisSpace(r){return this.orientation.rotate$Vec3(r)}fromThisSpace(r){return Fe.Builder.fromOriginOrientation().setOrigin(this.pointFromThisSpace(r.origin)).setOrientation(this.orientation.times(r.orientation)).build()}invert(){return Fe.Builder.fromOriginOrientation().setOrigin(this.orientation.conjugate().rotate$Vec3(this.origin.scale(-1))).setOrientation(this.orientation.conjugate()).build()}times(r){return this.fromThisSpace(r)}toJSON(){return{origin:this.origin,orientation:this.orientation}}static fromJSON(r){return Fe.create(j.fromJSON(r.origin),be.fromJSON(r.orientation))}toString(){return"(origin:"+this.origin.toString()+", orientation: "+this.orientation.toString()+")"}}Fe.__class="Transform3D";(e=>{class r{originX;originY;originZ;orientation;setOrigin(i){return this.originX=i.x,this.originY=i.y,this.originZ=i.z,this}setOriginX(i){return this.originX=i,this}setOriginXYZ(i,o,a){return this.originX=i,this.originY=o,this.originZ=a,this}setOriginY(i){return this.originY=i,this}setOriginZ(i){return this.originZ=i,this}setOrientation(i){return this.orientation=i,this}build(){if(this.orientation==null)throw"Fields not all set";return new e(j.create(this.originX,this.originY,this.originZ),this.orientation)}constructor(){this.originX=0,this.originY=0,this.originZ=0,this.orientation=null}}e.FromOriginOrientationBuilder=r,r.__class="Transform3D.FromOriginOrientationBuilder",r.__interfaces=["Transform3D.FromOriginOrientationSetOriginYStep","Transform3D.FromOriginOrientationSetOrientationStep","Transform3D.FromOriginOrientationSetOriginXStep","Transform3D.BuildStep","Transform3D.FromOriginOrientationSetOriginZStep"];class t{static fromOriginOrientation(){return new e.FromOriginOrientationBuilder}constructor(){}}e.Builder=t,t.__class="Transform3D.Builder"})(Fe||(Fe={}));Fe.identity_$LI$();function Hp(e){let r=new Gt,t=C(()=>{let n=[];for(let[i,o]of r.entries())n.push({id:i,pos:o});return n.sort((i,o)=>i.id-o.id),n});{let n=C(()=>t().length==1);ge(()=>{if((e.disableOneFingerPan?.()??!1)||!n())return;let i=C(()=>t()[0].pos),o=me(()=>e.pan()),a=me(()=>e.scale()),l=me(()=>i()),u=1/a;Number.isFinite(u)&&ge(se(i,s=>{e.setPan(o.sub(s.sub(l).multScalar(u)))},{defer:!0}))})}{let n=C(()=>t().length==2);ge(()=>{if(!n())return;let i=C(()=>t()[0].pos),o=C(()=>t()[1].pos),a=C(()=>i().add(o()).multScalar(.5)),l=C(()=>i().distance(o())),u=me(()=>e.pan()),s=me(()=>e.scale()),c=me(()=>a()),p=me(()=>l()),f=me(()=>c.multScalar(1/s).add(u));!Number.isFinite(f.x)||!Number.isFinite(f.y)||ge(se([a,l],([d,h])=>{let m=s*h/p,g=f.sub(d.multScalar(1/m));Le(()=>{Number.isFinite(m)&&Number.isFinite(g.x)&&Number.isFinite(g.y)&&(e.setPan(g),e.setScale(m))})},{defer:!0}))})}return{onPointerDown(n){let i,o;if(n.currentTarget instanceof Element){let a=n.currentTarget.getBoundingClientRect();i=a.left,o=a.top}else i=0,o=0;r.set(n.pointerId,G.create(n.clientX-i,n.clientY-o))},onPointerUp(n){r.delete(n.pointerId),e.releasePointerCapture(n.pointerId)},onPointerCancel(n){r.delete(n.pointerId),e.releasePointerCapture(n.pointerId)},onPointerMove(n){if(!r.has(n.pointerId))return;let i,o;if(n.currentTarget instanceof Element){let a=n.currentTarget.getBoundingClientRect();i=a.left,o=a.top}else i=0,o=0;r.set(n.pointerId,G.create(n.clientX-i,n.clientY-o))},onWheel(n){let i,o;if(n.currentTarget instanceof Element){let c=n.currentTarget.getBoundingClientRect();i=c.left,o=c.top}else i=0,o=0;let a=G.create(n.clientX-i,n.clientY-o),l=e.scale(),u=e.scale();if(n.deltaY<0)u*=1.1;else if(n.deltaY>0)u/=1.1;else return;let s=e.pan().add(a.multScalar(1/l-1/u));Le(()=>{e.setPan(s),e.setScale(u)})},numTouches:C(()=>t().length)}}class Zp{canUndo;canRedo;undoDisplayName;redoDisplayName;undo;redo;pushUndoUnit;clear;constructor(){let r=[],t=-1,[n,i]=K(!1),[o,a]=K(!1),[l,u]=K(),[s,c]=K(),p=()=>{Le(()=>{if(i(()=>t!=-1),a(()=>t<r.length-1),t!=-1){let m=r[t];u(m.displayName)}else u(void 0);if(t<r.length-1){let m=r[t+1];c(m.displayName)}else c(void 0)})},f=()=>{if(t==-1)return;r[t].run(!0),--t,p()},d=()=>{if(t>=r.length-1)return;++t,r[t].run(!1),p()},h=m=>{t<r.length-1&&r.splice(t+1,r.length-1-t),++t,r.push(m),p()};this.clear=()=>{r.splice(0,r.length),t=-1,p()},this.canUndo=n,this.canRedo=o,this.undoDisplayName=l,this.redoDisplayName=s,this.undo=f,this.redo=d,this.pushUndoUnit=h}}function pl(e){return e==null?[]:[e]}function Wp(e,r){let t,n=()=>{},i=0;return()=>{if(Ni()==null)return t!=null?t():e();if(t==null){let{cache:o,dispose:a}=Pt(l=>({cache:C(e),dispose:l}));t=o,n=a,i=1}else++i;return Te(()=>{--i==0&&(n(),n=()=>{},r?.(),t=void 0)}),t()}}class qr{value;constructor(r){this.value=r}}function fl(e){for(var r="",t=e.byteLength,n=0;n<t;n++)r+=String.fromCharCode(e[n]);return window.btoa(r)}function hl(e){for(var r=atob(e),t=new Uint8Array(r.length),n=0;n<r.length;n++)t[n]=r.charCodeAt(n);return t}class Rt{entityMap;componentTypeEntitiesMap;componentTypeEntitiesMap_=new Map;constructor(){this.entityMap=new Gt,this.componentTypeEntitiesMap=new Gt}entities(){return Array.from(this.entityMap.keys())}entitiesWithComponentType(r){{let n=this.componentTypeEntitiesMap_.get(r.typeName);if(n!=null)return n()}let t=Wp(()=>{let n=this.componentTypeEntitiesMap.get(r.typeName);if(n==null)return[];let i=[];for(let o of n)i.push(o);return i},()=>{this.componentTypeEntitiesMap_.delete(r.typeName)});return this.componentTypeEntitiesMap_.set(r.typeName,t),t()}createEntityWithId(r,t){me(()=>Le(()=>{this.entityMap.set(r,new Gt(t.map(n=>[n.type.typeName,n])));for(let n of t){let i=this.componentTypeEntitiesMap.get(n.type.typeName);i==null&&(i=new ut,this.componentTypeEntitiesMap.set(n.type.typeName,i)),i.add(r)}}))}createEntity(r){let t=Ut();return this.createEntityWithId(t,r),t}destroyEntity(r){me(()=>Le(()=>{let t=this.entityMap.get(r);if(t!=null)for(let n of t.values()){let i=this.componentTypeEntitiesMap.get(n.type.typeName);i?.delete(r)}this.entityMap.delete(r)}))}attachToParent(r,t){me(()=>{this.getComponent(r,Sr)?.state?.parentId!=null&&this.detactFromParent(r);let n=this.getComponent(t,_r);n==null?(n=_r.create({childIds:[r]}),this.setComponent(t,n)):n.setState("childIds",kr(i=>i.push(r))),this.setComponent(r,Sr.create({parentId:t}))})}detactFromParent(r){me(()=>{let t=this.getComponent(r,Sr);if(t!=null){this.unsetComponent(r,Sr);let n=t.state.parentId,i=this.getComponent(n,_r);if(i!=null){let o=i.state.childIds.filter(a=>a!==r);o.length==0?this.unsetComponent(n,_r):i.setState("childIds",o)}}})}getComponent(r,t){let n=this.entityMap.get(r);if(n!=null)return n.get(t.typeName)}getComponents(r){return Array.from(this.entityMap.get(r)?.values()??[])}setComponent(r,t){this.setComponents(r,[t])}setComponents(r,t){let n=this.entityMap.get(r);if(n!=null)for(let i of t)n.set(i.type.typeName,i)}unsetComponent(r,t){let n=this.entityMap.get(r);n?.delete(t.typeName)}unsetComponents(r,t){let n=this.entityMap.get(r);if(n!=null)for(let i of t)n.delete(i.typeName)}toJson(){let r={};for(let t of this.entities()){let n={};for(let i of this.getComponents(t))n[i.type.typeName]=He(i.type.typeSchema,i.state);r[t]=n}return r}static fromJson(r,t){let n=new Rt;for(let i of Object.keys(t)){let o=t[i],a=Object.keys(o),l=[];for(let u of a){let s=r.componentTypeMap.get(u);if(s==null)return Ke(`${u} not found`);let c=De(s.typeSchema,o[u]);if(c.type=="Err")return c;let p=c.value,f=s.create(p);l.push(f)}n.createEntityWithId(i,l)}return ke(n)}}const Yp=qi(e=>G.create(e.x,e.y),e=>({x:e.x,y:e.y}),W({x:Je(),y:Je()})),Xp=qi(e=>new xe(e.x,e.y),e=>({x:e.x,y:e.y}),W({x:Je(),y:Je()})),Kp=qi(({origin:e,orientation:r})=>_e.create(e,r),e=>({origin:e.origin,orientation:e.orientation}),W({origin:Yp,orientation:Xp})),Jp=W({transform:Kp}),Ie=new X({typeName:"Transform2D",typeSchema:Jp});class ml{nodeTypes=[];noteTypeNameToNodeTypeMap=new Map;registerNodeType(r){this.nodeTypes.push(r),this.noteTypeNameToNodeTypeMap.set(r.componentType.typeName,r)}registerNodeTypes(r){for(let t of r)this.registerNodeType(t)}lookupNodeType(r){return this.noteTypeNameToNodeTypeMap.get(r)}}const E=W({target:mt(),pin:mt()});var Qp=Z("<svg><path fill=none stroke=blue stroke-width=2 vector-effect=non-scaling-stroke></svg>",!1,!0),ef=Z("<svg><g><rect x=0 stroke=black rx=5 ry=5></rect><text style=user-select:none;></svg>",!1,!0),tf=Z("<svg><foreignObject x=5></svg>",!1,!0),Bo=Z("<svg><circle r=1></svg>",!1,!0),qo=Z("<svg><text></svg>",!1,!0);class vi{Render;constructor(r){this.Render=()=>[M(st,{get each(){return r.nodes()},children:t=>M(nf,{node:t,get isHighlighted(){return r.highlightedEntitySet.has(t.node.nodeParams.entity)},get isSelected(){return r.selectedEntitySet.has(t.node.nodeParams.entity)}})}),M(st,{get each(){return r.nodes()},children:t=>M(st,{get each(){return t.node.inputPins?.()??[]},children:n=>M(de,{get when(){return n.source()},children:i=>{let o=C(()=>r.lookupNodeById(i().target)),a=C(()=>{let u=o();if(u==null)return;let s=u.outputPinPositionMap()?.get(i().pin);if(s!=null)return u.space().pointFromSpace(s)}),l=C(()=>{let u=t.inputPinPositionMap()?.get(n.name);if(u!=null)return t.space().pointFromSpace(u)});return M(de,{get when(){return a()},children:u=>M(de,{get when(){return l()},children:s=>{let c=C(()=>gl(u().x,-u().y,s().x,-s().y,0));return(()=>{var p=Qp();return Q(()=>J(p,"d",c())),p})()}})})}})})})]}}let qn=(()=>{let e=new Map;return r=>{let t=e.get(r);if(t!=null)return t;let{svg:n,dispose:i}=Pt(u=>({svg:af(),dispose:u})),o=document.createElementNS("http://www.w3.org/2000/svg","text"),a=document.createTextNode(r);o.appendChild(a),n.appendChild(o);let l=o.getBBox();return i(),t=G.create(l.width,l.height),e.set(r,t),t}})(),rf=(()=>{let e=new Map;return(r,t)=>{let n=e.get(r);return n!=null||(n=t(),e.set(r,n)),n}})();function nf(e){let r=C(()=>qn(e.node.node.type.componentType.typeName)),t=C(It(()=>e.node.node.inputPins?.()??[],w=>{let v=qn(w.name);return{name:w.name,size:v}})),n=C(It(()=>e.node.node.outputPins?.()??[],w=>{let v=qn(w.name);return{name:w.name,size:v}})),i=C(()=>{let w=e.node.node.ui?.();if(w!=null)return rf(e.node.node.type.componentType.typeName,()=>{let v=of(),k=document.createElement("div");k.style.setProperty("display","inline-block"),v.append(k);let _=os(()=>M(w,{}),k),S=k.getBoundingClientRect();return _(),G.create(S.width,S.height)})});const o=5,a=5,l=C(()=>{let w=0;for(let v of t())w+=v.size.y;return w}),u=C(()=>{let w=0;for(let v of n())w+=v.size.y;return w});let s=C(()=>{let w=0;for(let v of t())w=Math.max(w,v.size.x);return w}),c=C(()=>{let w=0;for(let v of n())w=Math.max(w,v.size.x);return w}),p=C(()=>r().y+Math.max(l(),u())+(i()?.y??0)+2*o),f=C(()=>Math.max(r().x,s()+c()+4*a,i()?.x??0)+2*o),d=C(()=>G.create(f(),p())),h=C(()=>{let w={},v=p()-r().y;for(let k of t())v-=k.size.y,w[k.name]={dotPos:G.create(a,v+.28*k.size.y),textPos:G.create(2*a,v)};return w}),m=C(()=>{let w={},v=p()-r().y;for(let k of n())v-=k.size.y,w[k.name]={dotPos:G.create(f()-a,v+.28*k.size.y),textPos:G.create(f()-2*a-k.size.x,v)};return w}),g=C(()=>{let w=new Map;for(let[v,{dotPos:k}]of Object.entries(h()))w.set(v,k);return w}),y=C(()=>{let w=new Map;for(let[v,{dotPos:k}]of Object.entries(m()))w.set(v,k);return w});bn(()=>{e.node.setRenderSizeAccessor(d),e.node.setInputPinPositionMapAccessor(g),e.node.setOutputPinPositionMapAccessor(y)});let b=C(()=>{let w=e.node.space(),v=w.origin,k=w.u,_=v.x,S=-v.y,P=k.x,T=-k.y,$=-T;return`matrix(${P} ${$} ${T} ${P} ${_} ${S})`});return(()=>{var w=ef(),v=w.firstChild,k=v.nextSibling;return Y(w,M(de,{get when(){return i()},children:_=>M(de,{get when(){return e.node.node.ui?.()},keyed:!0,children:S=>(()=>{var P=tf();return Y(P,M(S,{})),Q(T=>{var $=-_().y-o,x=_().x,I=_().y;return $!==T.e&&J(P,"y",T.e=$),x!==T.t&&J(P,"width",T.t=x),I!==T.a&&J(P,"height",T.a=I),T},{e:void 0,t:void 0,a:void 0}),P})()})}),k),Y(k,()=>e.node.node.type.componentType.typeName),Y(w,M(st,{get each(){return e.node.node.inputPins?.()??[]},children:_=>{let S=C(()=>h()[_.name]),P=_.isEffectPin??!1;return M(de,{get when(){return S()},children:T=>[(()=>{var $=Bo();return J($,"fill",P?"purple":"black"),Q(x=>{var I=T().dotPos.x,F=-T().dotPos.y;return I!==x.e&&J($,"cx",x.e=I),F!==x.t&&J($,"cy",x.t=F),x},{e:void 0,t:void 0}),$})(),(()=>{var $=qo();return J($,"font-weight",P?"bold":"normal"),J($,"fill",P?"purple":"black"),Y($,()=>_.name),Q(x=>{var I=T().textPos.x,F=-T().textPos.y;return I!==x.e&&J($,"x",x.e=I),F!==x.t&&J($,"y",x.t=F),x},{e:void 0,t:void 0}),$})()]})}}),null),Y(w,M(st,{get each(){return e.node.node.outputPins?.()??[]},children:_=>{let S=C(()=>m()[_.name]),P=_.isEffectPin??!1;return M(de,{get when(){return S()},children:T=>[(()=>{var $=Bo();return J($,"fill",P?"purple":"black"),Q(x=>{var I=T().dotPos.x,F=-T().dotPos.y;return I!==x.e&&J($,"cx",x.e=I),F!==x.t&&J($,"cy",x.t=F),x},{e:void 0,t:void 0}),$})(),(()=>{var $=qo();return J($,"font-weight",P?"bold":"normal"),J($,"fill",P?"purple":"black"),Y($,()=>_.name),Q(x=>{var I=T().textPos.x,F=-T().textPos.y;return I!==x.e&&J($,"x",x.e=I),F!==x.t&&J($,"y",x.t=F),x},{e:void 0,t:void 0}),$})()]})}}),null),Q(_=>{var S=b(),P=-p(),T=f(),$=p(),x=e.isSelected?"green":e.isHighlighted?"blue":"white",I=.5*(f()-r().x),F=-p()+r().y;return S!==_.e&&J(w,"transform",_.e=S),P!==_.t&&J(v,"y",_.t=P),T!==_.a&&J(v,"width",_.a=T),$!==_.o&&J(v,"height",_.o=$),x!==_.i&&J(v,"fill",_.i=x),I!==_.n&&J(k,"x",_.n=I),F!==_.s&&J(k,"y",_.s=F),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w})()}const of=(()=>{let e=0,r;return()=>(r!=null?++e:(r=document.createElement("div"),r.style.setProperty("position","absolute"),r.style.setProperty("left","-1000px"),r.style.setProperty("top","-1000px"),r.style.setProperty("width","500px"),r.style.setProperty("height","500px"),document.body.append(r),e=1),Te(()=>{--e,e==0&&window.queueMicrotask(()=>{e==0&&r!=null&&(document.body.removeChild(r),r=void 0)})}),r)})(),af=(()=>{let e=0,r;return()=>(r!=null?++e:(r=document.createElementNS("http://www.w3.org/2000/svg","svg"),r.style.setProperty("position","absolute"),r.style.setProperty("left","-1000px"),r.style.setProperty("top","-1000px"),document.body.append(r),e=1),Te(()=>{--e,e==0&&window.queueMicrotask(()=>{e==0&&r!=null&&(document.body.removeChild(r),r=void 0)})}),r)})();function gl(e,r,t,n,i=.5){const o=(e+t)/2,a=(r+n)/2;let l,u,s,c;return l=e+(o-e)*(1-i),u=r+(a-r)*i,s=t-(t-o)*(1-i),c=n-(n-a)*i,`M ${e} ${r} C ${l} ${u}, ${s} ${c}, ${t} ${n}`}var sf=Z("<svg><path fill=none stroke-width=2 pointer-events=none vector-effect=non-scaling-stroke></svg>",!1,!0);class lf{overlaySvg;dragEnd;disablePan=()=>!0;constructor(r){let t=r.modeParams,n=C(()=>t.nodesSystem.lookupNodeById(r.fromNodeId)),i=C(()=>{let l=n();if(l==null)return;let u=l.outputPinPositionMap()?.get(r.fromPin.name);if(u!=null)return l.space().pointFromSpace(u)}),o=C(()=>{let l=t.mousePos();if(l!=null)return t.screenPtToWorldPt(l)}),a=C(()=>{let l=t.pickingSystem.nodeUnderMouseById();if(l==null)return;let u=t.nodesSystem.lookupNodeById(l);if(u==null)return;let s=t.pickingSystem.pinUnderMouse();if(s?.type=="Input")return{nodeId:l,node:u,pin:s}});this.overlaySvg=()=>M(de,{get when(){return i()},children:l=>M(de,{get when(){return o()},children:u=>{let s=C(()=>gl(l().x,-l().y,u().x,-u().y,0)),c=C(()=>a()!=null);return(()=>{var p=sf();return Q(f=>{var d=s(),h=c()?"blue":"red";return d!==f.e&&J(p,"d",f.e=d),h!==f.t&&J(p,"stroke",f.t=h),f},{e:void 0,t:void 0}),p})()}})}),this.dragEnd=()=>{let l=a();if(l!=null){let u=n();if(u!=null){let s=u.node.outputPins?.()??[],c;for(let p of s)if(p.name==r.fromPin.name){c=p;break}if(c!=null){let p=l.node.node.inputPins?.()??[];for(let f of p)if(f.name==l.pin.name){{let d={target:l.nodeId,pin:l.pin.name},h=!1;for(let m of c.sinks())if(m.target==d.target&&m.pin==d.pin){h=!0;break}h||c.setSinks([...c.sinks(),d])}{let d={target:r.fromNodeId,pin:r.fromPin.name};f.setSource(d)}}}}}t.onDone()}}}var cf=Z("<svg><circle fill=blue pointer-events=none></svg>",!1,!0);class Vo{overlaySvg;click;dragStart;dragEnd;highlightedObjectsById;selectedObjectsById;disablePan;constructor(r){let[t,n]=Me({dragging:void 0}),i=new ut,o=C(()=>Array.from(i)),a=()=>r.pickingSystem.nodeUnderMouseById(),l=()=>r.pickingSystem.pinUnderMouse();Ce(()=>{if(t.dragging==null)return;let s=t.dragging.value,c=r.mousePos();if(c==null)return;let p=r.screenPtToWorldPt(c);if(p==null)return;let f=r.nodesSystem.lookupNodeById(s.nodeId);f?.setSpace(_e.create(p.sub(s.pickupOffset),xe.rot0))}),this.overlaySvg=()=>M(de,{get when(){return l()},children:s=>M(de,{get when(){return r.nodesSystem.lookupNodeById(s().nodeId)},keyed:!0,children:c=>{let p=C(()=>{let f=s(),d;if(f.type=="Input"){let h=c.inputPinPositionMap()?.get(f.name);if(h==null)return;d=h}else if(f.type=="Output"){let h=c.outputPinPositionMap()?.get(f.name);if(h==null)return;d=h}else return;return c.space().pointFromSpace(d)});return M(de,{get when(){return p()},children:f=>(()=>{var d=cf();return Q(h=>{var m=f().x,g=-f().y,y=5/r.scale();return m!==h.e&&J(d,"cx",h.e=m),g!==h.t&&J(d,"cy",h.t=g),y!==h.a&&J(d,"r",h.a=y),h},{e:void 0,t:void 0,a:void 0}),d})()})}})}),this.click=()=>{let s=a();i.clear(),s!=null&&i.add(s)},this.dragStart=()=>{let s=r.mousePos();if(s==null)return;let c=r.screenPtToWorldPt(s);if(c==null)return;{let h=l();if(h!=null&&h.type=="Output"){let m={type:"Output",name:h.name};r.setMode(()=>new lf({modeParams:r,fromNodeId:h.nodeId,fromPin:m}));return}}if(r.nodesSystem.disablePan())return;let p=a();if(p==null||!i.has(p))return;let f=r.nodesSystem.lookupNodeById(p);if(f==null)return;let d=f.space().pointToSpace(c);n("dragging",new qr({nodeId:p,pickupOffset:d}))},this.dragEnd=()=>{n("dragging",void 0)};const u=[];this.highlightedObjectsById=C(()=>l()!=null?u:pl(a())),this.selectedObjectsById=o,this.disablePan=C(()=>l()!=null||t.dragging!=null)}}class wi{nodes;lookupNodeById;disablePan;constructor(r){let t=r.nodeRegistry,n=C(It(()=>r.world().entities(),u=>{let s=C(()=>{for(let c of r.world().getComponents(u)){let p=t.lookupNodeType(c.type.typeName);if(p!=null)return{nodeType:p,nodeComponent:c}}});return C(()=>{let c=s();if(c==null)return;let{nodeType:p,nodeComponent:f}=c,d=f,h=p.create({entity:u,state:d.state,setState:d.setState}),m=C(()=>r.world().getComponent(u,Ie)?.state.transform??_e.identity),g=P=>me(()=>{let T=r.world().getComponent(u,Ie);T==null?(T=Ie.create({transform:P}),r.world().setComponents(u,[T])):T.setState("transform",P)}),[y,b]=K(),[w,v]=K(),[k,_]=K();return{node:h,space:m,setSpace:g,setRenderSizeAccessor:P=>b(()=>P),setInputPinPositionMapAccessor:P=>v(()=>P),setOutputPinPositionMapAccessor:P=>_(()=>P),renderSize:()=>y()?.(),inputPinPositionMap:()=>w()?.(),outputPinPositionMap:()=>k()?.()}})})),i=C(()=>n().flatMap(u=>pl(u()))),o=new Gt,a=C(()=>{It(i,u=>{let s=u.node.nodeParams.entity;o.set(s,u),Te(()=>{o.delete(s)})})()}),l=u=>(a(),o.get(u));this.nodes=i,this.lookupNodeById=l,this.disablePan=C(()=>{for(let u of i())if(u.node.disablePan?.()??!1)return!0;return!1})}}const Go=20,Ho=Go*Go;class yl{nodeUnderMouseById;pinUnderMouse;constructor(r){let t=C(()=>{let o=r.mousePos();if(o==null)return;let a=r.screenPtToWorldPt(o);if(a!=null)for(let l of r.nodes()){let u=l.renderSize();if(u==null)continue;let s=l.space().pointToSpace(a);if(!(s.x<0||s.y<0||s.x>u.x||s.y>u.y))return l}}),n=()=>t()?.node.nodeParams.entity,i=C(()=>{let o=r.mousePos();if(o==null)return;let a,l;for(let u of r.nodes()){let s=u.inputPinPositionMap();if(s!=null)for(let[p,f]of s.entries()){let d=u.space().pointFromSpace(f),h=r.worldPtToScreenPt(d);if(h==null)continue;let m=h.distanceSquared(o);m>Ho||(l==null||m<l)&&(a={type:"Input",nodeId:u.node.nodeParams.entity,name:p},l=m)}let c=u.outputPinPositionMap();if(c!=null)for(let[p,f]of c.entries()){let d=u.space().pointFromSpace(f),h=r.worldPtToScreenPt(d);if(h==null)continue;let m=h.distanceSquared(o);m>Ho||(l==null||m<l)&&(a={type:"Output",nodeId:u.node.nodeParams.entity,name:p},l=m)}}return a});this.nodeUnderMouseById=n,this.pinUnderMouse=i}}var uf=Z('<button class="btn btn-primary">End Mode'),df=Z("<div>"),pf=Z("<svg>"),ff=Z("<div><svg><g>");class hf{instructions;overlayHtmlUi;sideForm;constructor(r){let[t,n]=Me({pan:G.zero,scale:1,formMousePos:void 0,dragging:void 0}),i=new Rt,o=0;for(let _ of r.nodeRegistry.nodeTypes)o-=80,i.createEntity([_.componentType.create(Ze(_.componentType.typeSchema)),Ie.create({transform:_e.create(G.create(0,o),xe.rot0)})]);let a=_=>G.create(t.pan.x+_.x/t.scale,-(t.pan.y+_.y/t.scale)),l=_=>G.create((_.x-t.pan.x)*t.scale,(-_.y-t.pan.y)*t.scale),u=new wi({nodeRegistry:r.nodeRegistry,world:()=>i}),s=new yl({mousePos:()=>t.formMousePos,screenPtToWorldPt:a,worldPtToScreenPt:l,nodes:()=>u.nodes()}),c=()=>s.nodeUnderMouseById(),p=new ut,f=new ut;ge(()=>{let _=c();_==null?p.clear():(p.clear(),p.add(_))});let d=new vi({nodes:()=>u.nodes(),lookupNodeById:_=>u.lookupNodeById(_),highlightedEntitySet:p,selectedEntitySet:f}),h=C(()=>{let _={},S=0;for(let P of u.nodes()){let T=P.renderSize();if(T==null)return;S-=T.y,_[P.node.nodeParams.entity]=G.create(0,S)}return _}),m=C(()=>{let _=h();if(_==null)return 0;let S=0;for(let P of Object.values(_))S=Math.min(S,P.y);return Math.abs(S)});ge(()=>{let _=h();if(_!=null)for(let S of i.entities())me(()=>{let P=_[S];if(P==null)return;let T=i.getComponent(S,Ie);T?.setState("transform",_e.create(P,xe.rot0))})});let[g,y]=K(),b,w=_=>{{let S=b.getBoundingClientRect();n("formMousePos",G.create(_.clientX-S.left,_.clientY-S.top))}b.setPointerCapture(_.pointerId),queueMicrotask(()=>{let S=t.formMousePos;if(S==null)return;let P=c();if(P==null)return;let T=u.lookupNodeById(P);if(T==null)return;let $=T.space().origin,x=a(S);x!=null&&n("dragging",new qr({nodeType:T.node.type,nodeSize:T.renderSize()??G.create(100,50),pickupOffset:x.sub($)}))})},v=_=>{b.releasePointerCapture(_.pointerId);let S=g();if(t.formMousePos!=null&&t.dragging!=null&&S!=null){let P=t.formMousePos,T=b.getBoundingClientRect(),$=S.getBoundingClientRect(),x=t.dragging.value.pickupOffset,I=G.create(T.left-$.left+P.x-x.x,T.top-$.top+P.y+x.y),F=r.screenPtToWorldPt(I);if(F==null)return;r.world().createEntity([t.dragging.value.nodeType.componentType.create(Ze(t.dragging.value.nodeType.componentType.typeSchema)),Ie.create({transform:_e.create(F,xe.rot0)})]),n("dragging",void 0)}},k=_=>{let S=b.getBoundingClientRect();n("formMousePos",G.create(_.clientX-S.left,_.clientY-S.top))};this.instructions=()=>(()=>{var _=uf();return _.$$click=()=>{r.onDone()},_})(),this.overlayHtmlUi=()=>M(de,{get when(){return t.dragging?.value},children:_=>M(de,{get when(){return t.formMousePos},children:S=>{let[P,T]=K(!0);Te(()=>{y(void 0)}),bn(()=>T(!1));let $=C(()=>{if(P())return;let R=g();if(R==null)return;let O=b.getBoundingClientRect(),L=R.getBoundingClientRect();return S().add(G.create(O.left-L.left-_().pickupOffset.x,O.top-L.top-_().nodeSize.y+_().pickupOffset.y))}),x=new Rt,I=x.createEntity([me(()=>_().nodeType.componentType.create(Ze(_().nodeType.componentType.typeSchema))),Ie.create({transform:_e.create(G.create(0,me(()=>-_().nodeSize.y)),xe.rot0)})]),F=new wi({nodeRegistry:r.nodeRegistry,world:()=>x}),N=new vi({nodes:()=>F.nodes(),lookupNodeById:R=>F.lookupNodeById(R),highlightedEntitySet:new ut([I]),selectedEntitySet:new ut});return(()=>{var R=df(),O=y;return typeof O=="function"?ve(O,R):y=R,R.style.setProperty("position","absolute"),R.style.setProperty("left","0"),R.style.setProperty("top","0"),R.style.setProperty("right","0"),R.style.setProperty("bottom","0"),R.style.setProperty("pointer-events","none"),Y(R,M(de,{get when(){return $()},children:L=>(()=>{var B=pf();return B.style.setProperty("position","absolute"),B.style.setProperty("touch-action","none"),B.style.setProperty("user-select","none"),Y(B,M(N.Render,{})),Q(U=>{var H=`${L().x}px`,ne=`${L().y}px`,ce=`${_().nodeSize.x}px`,fe=`${_().nodeSize.y}px`;return H!==U.e&&((U.e=H)!=null?B.style.setProperty("left",H):B.style.removeProperty("left")),ne!==U.t&&((U.t=ne)!=null?B.style.setProperty("top",ne):B.style.removeProperty("top")),ce!==U.a&&((U.a=ce)!=null?B.style.setProperty("width",ce):B.style.removeProperty("width")),fe!==U.o&&((U.o=fe)!=null?B.style.setProperty("height",fe):B.style.removeProperty("height")),U},{e:void 0,t:void 0,a:void 0,o:void 0}),B})()})),R})()}})}),this.sideForm=C(()=>()=>(()=>{var _=ff(),S=_.firstChild,P=S.firstChild;_.style.setProperty("width","150px"),_.style.setProperty("height","100%"),_.style.setProperty("overflow-x","hidden"),_.style.setProperty("overflow-y","auto"),S.$$pointermove=k,S.$$pointerup=v,S.$$pointerdown=w;var T=b;return typeof T=="function"?ve(T,S):b=S,S.style.setProperty("width","100%"),S.style.setProperty("touch-action","pan-y"),S.style.setProperty("user-select","none"),Y(P,M(d.Render,{})),Q($=>($=`${m()}px`)!=null?S.style.setProperty("height",$):S.style.removeProperty("height")),_})())}}$e(["click","pointerdown","pointerup","pointermove"]);var mf=Z('<div><div><div><button class="btn btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-t"></i></button><button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-upload"></i></button><input type=file hidden><button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-download"></i></button><button class="btn btn-primary"style=margin-left:5px;>Add Node</button><button class="btn btn-primary"style=margin-left:5px;>Delete</button><label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Freeze Pan/Zoom</label></div><div><svg><g>'),gf=Z('<details class=dropdown><summary class="btn btn-primary"><i class="fa-solid fa-bars"></i></summary><div tabindex=-1>'),yf=Z("<div>"),Zo=Z("<div><div>");function bl(e){let[r,t]=Fi(e,["onInit","componentRegistry","nodeRegistry","world","menu","toolbar"]),n=r.nodeRegistry,[i,o]=Me({pan:G.zero,scale:1,mousePos:void 0,mkMode:()=>new Vo(w),showCode:!1,makeSound:!1,freezePanZoom:!1,filename:"node-graph"}),a=new Zp,l,[u,s]=K(G.zero);bn(()=>{{let oe=l.getBoundingClientRect();o("pan",G.create(0,-oe.height))}let z=new ResizeObserver(()=>{let oe=l.getBoundingClientRect();queueMicrotask(()=>{s(G.create(oe.width,oe.height))})});z.observe(l),Te(()=>{z.unobserve(l),z.disconnect()})});let c=C(()=>`scale(${i.scale}) translate(${-i.pan.x} ${-i.pan.y})`),p=z=>{o("mkMode",()=>z)},f=z=>G.create(i.pan.x+z.x/i.scale,-(i.pan.y+z.y/i.scale)),d=z=>G.create((z.x-i.pan.x)*i.scale,(-z.y-i.pan.y)*i.scale),h=new wi({nodeRegistry:n,world:()=>r.world}),m=new yl({mousePos:()=>i.mousePos,screenPtToWorldPt:f,worldPtToScreenPt:d,nodes:()=>h.nodes()}),g=new ut,y=new ut,b=new vi({nodes:()=>h.nodes(),lookupNodeById:z=>h.lookupNodeById(z),highlightedEntitySet:g,selectedEntitySet:y}),w={undoManager:a,nodeRegistry:n,nodesSystem:h,pickingSystem:m,mousePos:()=>i.mousePos,screenPtToWorldPt:f,worldPtToScreenPt:d,world:()=>r.world,onDone:()=>{p(()=>new Vo(w))},pan:()=>i.pan,setPan:z=>o("pan",z),scale:()=>i.scale,setScale:z=>o("scale",z),setMode:p},v=C(()=>i.mkMode()),k=Hp({pan:()=>i.pan,setPan:z=>o("pan",z),scale:()=>i.scale,setScale:z=>o("scale",z),setPointerCapture:z=>l.setPointerCapture(z),releasePointerCapture:z=>l.releasePointerCapture(z),disableOneFingerPan:C(()=>(v().disablePan?.()??!1)||i.freezePanZoom||h.disablePan())}),_=C(()=>v().highlightedObjectsById?.()??[]),S=C(()=>v().selectedObjectsById?.()??[]);ge(It(_,z=>{g.add(z),Te(()=>{g.delete(z)})})),ge(It(S,z=>{y.add(z),Te(()=>{y.delete(z)})}));let P=()=>{v().click?.()},T,$=!1,x=z=>{let oe=l.getBoundingClientRect();o("mousePos",G.create(z.clientX-oe.left,z.clientY-oe.top)),v().dragStart?.(),$=!0,k.onPointerDown(z)},I=z=>{k.onPointerUp(z),k.numTouches()==0&&P(),$&&v().dragEnd?.(),window.clearTimeout(T),T=void 0},F=z=>{k.onPointerCancel(z)},N=z=>{let oe=l.getBoundingClientRect();o("mousePos",G.create(z.clientX-oe.left,z.clientY-oe.top)),k.onPointerMove(z)},R=z=>{k.numTouches()==0&&o("mousePos",void 0)},O=z=>{k.onWheel(z)},L=()=>{for(let z of S())r.world.destroyEntity(z);y.clear()},[B,U]=K();r.onInit({nodesSystem:h,closeMenu:()=>{let z=B();z!=null&&(z.open=!1)}});let[H,ne]=K();const ce=async z=>{let oe=await z.text().then(re=>JSON.parse(re)),ye=Rt.fromJson(r.componentRegistry,oe);if(ye.type=="Err"){alert(ye.message);return}let he=ye.value;Le(()=>{let re=r.world;for(let pe of[...re.entities()])re.destroyEntity(pe);for(let pe of he.entities()){let Oe=he.getComponents(pe);re.createEntityWithId(pe,Oe)}});let q=z.name;q.endsWith(".json")&&(q=q.slice(0,q.length-5)),o("filename",q)},fe=()=>{let z=JSON.stringify(r.world.toJson(),void 0,2),oe=new Blob([z],{type:"application/json"});vs.saveAs(oe,`${i.filename}.json`)};return(()=>{var z=mf(),oe=z.firstChild,ye=oe.firstChild,he=ye.firstChild,q=he.nextSibling,re=q.nextSibling,pe=re.nextSibling,Oe=pe.nextSibling,et=Oe.nextSibling,at=et.nextSibling,Mt=at.firstChild,tt=ye.nextSibling,le=tt.firstChild,rt=le.firstChild;Mi(z,t,!1,!0),oe.style.setProperty("width","100%"),oe.style.setProperty("height","100%"),oe.style.setProperty("display","flex"),oe.style.setProperty("flex-direction","column"),Y(ye,M(de,{get when(){return r.menu},keyed:!0,children:A=>{let ie,Pe,Ve=!1;return bn(()=>{U(ie)}),(()=>{var Ye=gf(),xt=Ye.firstChild,Nt=xt.nextSibling;Ye.$$mouseout=()=>{Ve=!1},Ye.$$mouseover=()=>{Ve=!0},Ye.addEventListener("toggle",Wr=>{Wr.currentTarget.open&&Pe.focus()});var pr=ie;typeof pr=="function"?ve(pr,Ye):ie=Ye,Nt.$$focusout=()=>{Ve||(ie.open=!1)};var er=Pe;return typeof er=="function"?ve(er,Nt):Pe=Nt,Y(Nt,A),Ye})()}}),he),he.$$click=()=>{let A=window.prompt("Enter new filename:",i.filename);A!=null&&(A=A.trim(),A!=""&&o("filename",A))},q.$$click=()=>H()?.click(),re.addEventListener("change",A=>{let ie=A.currentTarget.files;if(ie?.length!=1)return;let Pe=ie[0];ce(Pe),A.currentTarget.value=""});var wt=ne;typeof wt=="function"?ve(wt,re):ne=re,pe.$$click=()=>fe(),Oe.$$click=()=>p(()=>new hf(w)),et.$$click=()=>{L()},Y(ye,()=>r.toolbar,at),Mt.addEventListener("change",A=>o("freezePanZoom",A.currentTarget.checked)),tt.style.setProperty("flex-grow","1"),tt.style.setProperty("position","relative"),le.$$pointerout=R,le.addEventListener("wheel",O),le.$$pointermove=N,le.addEventListener("pointercancel",F),le.$$pointerup=I,le.$$pointerdown=x;var kt=l;return typeof kt=="function"?ve(kt,le):l=le,le.style.setProperty("position","absolute"),le.style.setProperty("left","0"),le.style.setProperty("top","0"),le.style.setProperty("width","100%"),le.style.setProperty("height","100%"),le.style.setProperty("touch-action","none"),le.style.setProperty("user-select","none"),Y(rt,M(b.Render,{}),null),Y(rt,M(de,{get when(){return v().overlaySvg},keyed:!0,children:A=>M(A,{})}),null),Y(tt,M(de,{get when(){return v().sideForm?.()==null},get children(){return M(de,{get when(){return v().instructions},keyed:!0,children:A=>(()=>{var ie=yf();return ie.style.setProperty("position","absolute"),ie.style.setProperty("left","0"),ie.style.setProperty("top","0"),Y(ie,M(A,{})),ie})()})}}),null),Y(tt,M(de,{get when(){return v().sideForm?.()},keyed:!0,children:A=>(()=>{var ie=Zo(),Pe=ie.firstChild;return ie.style.setProperty("position","absolute"),ie.style.setProperty("left","0"),ie.style.setProperty("top","0"),ie.style.setProperty("height","100%"),ie.style.setProperty("display","flex"),ie.style.setProperty("flex-direction","row"),ie.style.setProperty("pointer-events","none"),Pe.style.setProperty("background","black"),Pe.style.setProperty("pointer-events","auto"),Y(Pe,M(A,{})),Y(ie,M(de,{get when(){return v().instructions},keyed:!0,children:Ve=>(()=>{var Ye=Zo(),xt=Ye.firstChild;return xt.style.setProperty("pointer-events","auto"),Y(xt,M(Ve,{})),Ye})()}),null),ie})()}),null),Y(tt,M(de,{get when(){return v().overlayHtmlUi},keyed:!0,children:A=>M(A,{})}),null),Q(A=>{var ie=y.size==0,Pe=c();return ie!==A.e&&(et.disabled=A.e=ie),Pe!==A.t&&J(rt,"transform",A.t=Pe),A},{e:void 0,t:void 0}),Q(()=>Mt.checked=i.freezePanZoom),z})()}$e(["click","pointerdown","pointerup","pointermove","pointerout","mouseover","mouseout","focusout"]);const bf=W({frequency:D(E),amplitude:D(E),centre:D(E),out:ee(E)}),Hi=new X({typeName:"SineWave",typeSchema:bf});let vf=class{nextFieldIdx=0;fieldDeclarations="";constructorCode="";messageHandlers=new Map;globalCode="";code_="";postCode="";allocField(r){let t=`x${this.nextFieldIdx++}`;return this.fieldDeclarations+=`  ${t} = ${r};\r
`,`this.${t}`}allocFieldNoDecl(){return`this.${`x${this.nextFieldIdx++}`}`}addDeclToExistingForField(r,t){r.startsWith("this.")&&(r=r.substring(5)),this.fieldDeclarations+=`  ${r} = ${t};\r
`}insertConstructorCode(r){this.constructorCode+=r.map(t=>`      ${t}\r
`).join("")}insertMessageHandlerCode(r,t){this.messageHandlers.get(r);let n=t.map(i=>`        ${i}\r
`).join("");this.messageHandlers.set(r,n)}insertGlobalCode(r){this.globalCode+=r.map(t=>`${t}\r
`).join("")}insertCode(r){this.code_+=r.map(t=>`      ${t}\r
`).join("")}insertPostCode(r){this.postCode+=r.map(t=>`      ${t}\r
`).join("")}get code(){let r="";return this.messageHandlers.size!=0?r=[`    this.port.onmessage = (e) => {\r
`,`      let data = e.data;\r
`,...this.messageHandlers.entries().map(([t,n],i)=>{let o,a=i==this.messageHandlers.size-1;return i==0?o="      if":o="      } else if",`${o} (data.type == "${t}") {\r
        let params = data.params;\r
${n}${a?`      }\r
`:""}`}),`    };\r
`].join(""):r="",[this.globalCode,"class CompiledGraphAudioWorkletProcessor extends AudioWorkletProcessor {","  runningEffectsHead = null;","  runningEffectsTail = null;","  variables = {};",this.fieldDeclarations,"  constructor(options) {","    super();",`${this.constructorCode}${r}  }`,"","  insertRunningEffect(effect) {","    if (this.runningEffectsTail == null) {","      this.runningEffectsHead = effect;","      this.runningEffectsTail = effect;","    } else {","      this.runningEffectsTail.next = effect;","      effect.prev = this.runningEffectsTail;","      this.runningEffectsTail = effect;","    }","  }","","  removeRunningEffect(effect) {","    if (effect.prev != null) {","      effect.prev.next = effect.next;","    }","    if (effect.next != null) {","      effect.next.prev = effect.prev;","    }","    if (this.runningEffectsHead == effect) {","      this.runningEffectsHead = effect.next;","    }","    if (this.runningEffectsTail == effect) {","      this.runningEffectsTail = effect.prev;","    }","    effect.prev = null;","    effect.next = null;","  }","","  process(inputs, outputs, parameters) {","    let output = outputs[0][0];","    debugger;","    for (let i = 0; i < output.length; ++i) {","      let result = 0.0;",`${this.code_}${this.postCode}      let effect = this.runningEffectsHead;`,"      while (effect != null) {","        let isDone = effect.update();","        if (isDone) {","          this.removeRunningEffect(effect);","          for (let onDone of effect.onDone) {","            onDone();","          }","        }","        effect = effect.next;","      }","      output[i] = result;","    }","    return true;","  }","}","",'registerProcessor("compiled-graph-audio-worklet-processor", CompiledGraphAudioWorkletProcessor);'].join(`\r
`)}};function wf(e,r){let t=new Map,n=[e];for(;;){let i=n.pop();if(i==null)break;if(t.has(i))continue;let o={};for(let l of Object.entries(i.inputs))o[l[0]]={...l[1]};let a={id:0,inputs:o,outputs:{},height:i.height,node:i.node};r(a),t.set(i,a);for(let l of Object.values(i.outputs))for(let u of l)n.push(u.node)}for(let i of t.values())for(let o of Object.entries(i.inputs)){let a=t.get(o[1].node);a!=null&&(o[1].node=a)}for(let i of t.values())for(let[o,{node:a,pin:l}]of Object.entries(i.inputs)){let u=a.outputs[l],s={node:i,pin:o};u==null?(u=[s],a.outputs[l]=u):u.push(s)}return t.get(e)}function kf(e){let r=e.nodesSystem,t=[];{let a=new Map;for(let l of r.nodes()){let u={id:0,inputs:{},outputs:{},height:0,node:l};a.set(l.node.nodeParams.entity,u),t.push(u)}for(let l of a.values())for(let u of l.node.node.inputPins?.()??[]){let s=u.source();if(s==null)continue;let c=a.get(s.target);c!=null&&(l.inputs[u.name]={node:c,pin:s.pin})}}for(let a of t)for(let[l,{node:u,pin:s}]of Object.entries(a.inputs)){let c=u.outputs[s],p={node:a,pin:l};c==null?(c=[p],u.outputs[s]=c):c.push(p)}let n=[];{let a=new Set;for(;;){let l=!1;Wo(t);for(let u of t){let s=n[u.height];s==null?(s=[u],n[u.height]=s):s.push(u)}for(let u=0;u<n.length;++u){let s=n[u]??[];for(let c of s){if(a.has(c))continue;let p=c.node.node;if(p.ext.macro!=null){p.ext.macro(c,f=>t.push(f)),a.add(c),l=!0;break}}if(l)break}if(!l)break}}Wo(t);{let a=0;for(let l of t)l.id=a++}let i=new vf;{let a=new Set;for(let l of r.nodes()){let u=l.node.type;a.has(u.componentType.typeName)||(a.add(u.componentType.typeName),u.ext.generateInitOnceCode?.({ctx:i}))}}n.splice(0,n.length);for(let a of t){let l=n[a.height];l==null?(l=[a],n[a.height]=l):l.push(a)}let o=new Map;for(let a=0;a<n.length;++a){let l=n[a]??[];for(let u of l){let s=u.node.node,c=new Map;for(let p of Object.entries(u.inputs)){let f=o.get(p[1].node)?.get(p[1].pin);f!=null?c.set(p[0],f):c.set(p[0],`this.n_${p[1].node.id}_${p[1].pin}`)}if(s.ext.generateCode!=null){let p=s.ext.generateCode({ctx:i,inputAtoms:c,codeGenNodeId:u.id});if(p.length==1){let f=p[0].outputAtoms;o.set(u,f)}}}}return i.code}function Wo(e){let r=new Set,t=[...e],n=[];for(;;){let i=t.pop();if(i==null){let l=t;if(t=n,n=l,i=t.pop(),i==null)break}if(r.has(i))continue;let o=!0;for(let[l,{node:u}]of Object.entries(i.inputs))if(!(i.node.node.inputPins?.().find(s=>s.name==l)?.isEffectPin??!1)&&!r.has(u)){o=!1;break}if(!o){n.push(i);continue}let a=0;for(let[,{node:l,pin:u}]of Object.entries(i.inputs))(l.node.node.outputPins?.().find(({name:s})=>s==u)?.isEffectPin??!1)||l.height>=a&&(a=l.height+1);i.height=a,r.add(i)}}var Ft={},en={},Vn,Yo;function xf(){if(Yo)return Vn;Yo=1;function e(i){var o=new n(i),a=o.readChunk();if(a.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+a.id+"'";for(var l=r(a.data),u=[],s=0;!o.eof()&&s<l.numTracks;s++){var c=o.readChunk();if(c.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+c.id+"'";var p=t(c.data);u.push(p)}return{header:l,tracks:u}}function r(i){var o=new n(i),a=o.readUInt16(),l=o.readUInt16(),u={format:a,numTracks:l},s=o.readUInt16();return s&32768?(u.framesPerSecond=256-(s>>8),u.ticksPerFrame=s&255):u.ticksPerBeat=s,u}function t(i){for(var o=new n(i),a=[];!o.eof();){var l=s();a.push(l)}return a;var u;function s(){var c={};c.deltaTime=o.readVarInt();var p=o.readUInt8();if((p&240)===240)if(p===255){c.meta=!0;var f=o.readUInt8(),d=o.readVarInt();switch(f){case 0:if(c.type="sequenceNumber",d!==2)throw"Expected length for sequenceNumber event is 2, got "+d;return c.number=o.readUInt16(),c;case 1:return c.type="text",c.text=o.readString(d),c;case 2:return c.type="copyrightNotice",c.text=o.readString(d),c;case 3:return c.type="trackName",c.text=o.readString(d),c;case 4:return c.type="instrumentName",c.text=o.readString(d),c;case 5:return c.type="lyrics",c.text=o.readString(d),c;case 6:return c.type="marker",c.text=o.readString(d),c;case 7:return c.type="cuePoint",c.text=o.readString(d),c;case 32:if(c.type="channelPrefix",d!=1)throw"Expected length for channelPrefix event is 1, got "+d;return c.channel=o.readUInt8(),c;case 33:if(c.type="portPrefix",d!=1)throw"Expected length for portPrefix event is 1, got "+d;return c.port=o.readUInt8(),c;case 47:if(c.type="endOfTrack",d!=0)throw"Expected length for endOfTrack event is 0, got "+d;return c;case 81:if(c.type="setTempo",d!=3)throw"Expected length for setTempo event is 3, got "+d;return c.microsecondsPerBeat=o.readUInt24(),c;case 84:if(c.type="smpteOffset",d!=5)throw"Expected length for smpteOffset event is 5, got "+d;var h=o.readUInt8(),m={0:24,32:25,64:29,96:30};return c.frameRate=m[h&96],c.hour=h&31,c.min=o.readUInt8(),c.sec=o.readUInt8(),c.frame=o.readUInt8(),c.subFrame=o.readUInt8(),c;case 88:if(c.type="timeSignature",d!=2&&d!=4)throw"Expected length for timeSignature event is 4 or 2, got "+d;return c.numerator=o.readUInt8(),c.denominator=1<<o.readUInt8(),d===4?(c.metronome=o.readUInt8(),c.thirtyseconds=o.readUInt8()):(c.metronome=36,c.thirtyseconds=8),c;case 89:if(c.type="keySignature",d!=2)throw"Expected length for keySignature event is 2, got "+d;return c.key=o.readInt8(),c.scale=o.readUInt8(),c;case 127:return c.type="sequencerSpecific",c.data=o.readBytes(d),c;default:return c.type="unknownMeta",c.data=o.readBytes(d),c.metatypeByte=f,c}}else if(p==240){c.type="sysEx";var d=o.readVarInt();return c.data=o.readBytes(d),c}else if(p==247){c.type="endSysEx";var d=o.readVarInt();return c.data=o.readBytes(d),c}else throw"Unrecognised MIDI event type byte: "+p;else{var g;if(p&128)g=o.readUInt8(),u=p;else{if(u===null)throw"Running status byte encountered before status byte";g=p,p=u,c.running=!0}var y=p>>4;switch(c.channel=p&15,y){case 8:return c.type="noteOff",c.noteNumber=g,c.velocity=o.readUInt8(),c;case 9:var b=o.readUInt8();return c.type=b===0?"noteOff":"noteOn",c.noteNumber=g,c.velocity=b,b===0&&(c.byte9=!0),c;case 10:return c.type="noteAftertouch",c.noteNumber=g,c.amount=o.readUInt8(),c;case 11:return c.type="controller",c.controllerType=g,c.value=o.readUInt8(),c;case 12:return c.type="programChange",c.programNumber=g,c;case 13:return c.type="channelAftertouch",c.amount=g,c;case 14:return c.type="pitchBend",c.value=g+(o.readUInt8()<<7)-8192,c;default:throw"Unrecognised MIDI event type: "+y}}}}function n(i){this.buffer=i,this.bufferLen=this.buffer.length,this.pos=0}return n.prototype.eof=function(){return this.pos>=this.bufferLen},n.prototype.readUInt8=function(){var i=this.buffer[this.pos];return this.pos+=1,i},n.prototype.readInt8=function(){var i=this.readUInt8();return i&128?i-256:i},n.prototype.readUInt16=function(){var i=this.readUInt8(),o=this.readUInt8();return(i<<8)+o},n.prototype.readInt16=function(){var i=this.readUInt16();return i&32768?i-65536:i},n.prototype.readUInt24=function(){var i=this.readUInt8(),o=this.readUInt8(),a=this.readUInt8();return(i<<16)+(o<<8)+a},n.prototype.readInt24=function(){var i=this.readUInt24();return i&8388608?i-16777216:i},n.prototype.readUInt32=function(){var i=this.readUInt8(),o=this.readUInt8(),a=this.readUInt8(),l=this.readUInt8();return(i<<24)+(o<<16)+(a<<8)+l},n.prototype.readBytes=function(i){var o=this.buffer.slice(this.pos,this.pos+i);return this.pos+=i,o},n.prototype.readString=function(i){var o=this.readBytes(i);return String.fromCharCode.apply(null,o)},n.prototype.readVarInt=function(){for(var i=0;!this.eof();){var o=this.readUInt8();if(o&128)i+=o&127,i<<=7;else return i+o}return i},n.prototype.readChunk=function(){var i=this.readString(4),o=this.readUInt32(),a=this.readBytes(o);return{id:i,length:o,data:a}},Vn=e,Vn}var Gn,Xo;function _f(){if(Xo)return Gn;Xo=1;function e(o,a){if(typeof o!="object")throw"Invalid MIDI data";a=a||{};var l=o.header||{},u=o.tracks||[],s,c=u.length,p=new i;for(r(p,l,c),s=0;s<c;s++)t(p,u[s],a);return p.buffer}function r(o,a,l){var u=a.format==null?1:a.format,s=128;a.timeDivision?s=a.timeDivision:a.ticksPerFrame&&a.framesPerSecond?s=-(a.framesPerSecond&255)<<8|a.ticksPerFrame&255:a.ticksPerBeat&&(s=a.ticksPerBeat&32767);var c=new i;c.writeUInt16(u),c.writeUInt16(l),c.writeUInt16(s),o.writeChunk("MThd",c.buffer)}function t(o,a,l){var u=new i,s,c=a.length,p=null;for(s=0;s<c;s++)(l.running===!1||!l.running&&!a[s].running)&&(p=null),p=n(u,a[s],p,l.useByte9ForNoteOff);o.writeChunk("MTrk",u.buffer)}function n(o,a,l,u){var s=a.type,c=a.deltaTime,p=a.text||"",f=a.data||[],d=null;switch(o.writeVarInt(c),s){case"sequenceNumber":o.writeUInt8(255),o.writeUInt8(0),o.writeVarInt(2),o.writeUInt16(a.number);break;case"text":o.writeUInt8(255),o.writeUInt8(1),o.writeVarInt(p.length),o.writeString(p);break;case"copyrightNotice":o.writeUInt8(255),o.writeUInt8(2),o.writeVarInt(p.length),o.writeString(p);break;case"trackName":o.writeUInt8(255),o.writeUInt8(3),o.writeVarInt(p.length),o.writeString(p);break;case"instrumentName":o.writeUInt8(255),o.writeUInt8(4),o.writeVarInt(p.length),o.writeString(p);break;case"lyrics":o.writeUInt8(255),o.writeUInt8(5),o.writeVarInt(p.length),o.writeString(p);break;case"marker":o.writeUInt8(255),o.writeUInt8(6),o.writeVarInt(p.length),o.writeString(p);break;case"cuePoint":o.writeUInt8(255),o.writeUInt8(7),o.writeVarInt(p.length),o.writeString(p);break;case"channelPrefix":o.writeUInt8(255),o.writeUInt8(32),o.writeVarInt(1),o.writeUInt8(a.channel);break;case"portPrefix":o.writeUInt8(255),o.writeUInt8(33),o.writeVarInt(1),o.writeUInt8(a.port);break;case"endOfTrack":o.writeUInt8(255),o.writeUInt8(47),o.writeVarInt(0);break;case"setTempo":o.writeUInt8(255),o.writeUInt8(81),o.writeVarInt(3),o.writeUInt24(a.microsecondsPerBeat);break;case"smpteOffset":o.writeUInt8(255),o.writeUInt8(84),o.writeVarInt(5);var h={24:0,25:32,29:64,30:96},m=a.hour&31|h[a.frameRate];o.writeUInt8(m),o.writeUInt8(a.min),o.writeUInt8(a.sec),o.writeUInt8(a.frame),o.writeUInt8(a.subFrame);break;case"timeSignature":o.writeUInt8(255),o.writeUInt8(88),o.writeVarInt(4),o.writeUInt8(a.numerator);var g=Math.floor(Math.log(a.denominator)/Math.LN2)&255;o.writeUInt8(g),o.writeUInt8(a.metronome),o.writeUInt8(a.thirtyseconds||8);break;case"keySignature":o.writeUInt8(255),o.writeUInt8(89),o.writeVarInt(2),o.writeInt8(a.key),o.writeUInt8(a.scale);break;case"sequencerSpecific":o.writeUInt8(255),o.writeUInt8(127),o.writeVarInt(f.length),o.writeBytes(f);break;case"unknownMeta":a.metatypeByte!=null&&(o.writeUInt8(255),o.writeUInt8(a.metatypeByte),o.writeVarInt(f.length),o.writeBytes(f));break;case"sysEx":o.writeUInt8(240),o.writeVarInt(f.length),o.writeBytes(f);break;case"endSysEx":o.writeUInt8(247),o.writeVarInt(f.length),o.writeBytes(f);break;case"noteOff":var y=u!==!1&&a.byte9||u&&a.velocity==0?144:128;d=y|a.channel,d!==l&&o.writeUInt8(d),o.writeUInt8(a.noteNumber),o.writeUInt8(a.velocity);break;case"noteOn":d=144|a.channel,d!==l&&o.writeUInt8(d),o.writeUInt8(a.noteNumber),o.writeUInt8(a.velocity);break;case"noteAftertouch":d=160|a.channel,d!==l&&o.writeUInt8(d),o.writeUInt8(a.noteNumber),o.writeUInt8(a.amount);break;case"controller":d=176|a.channel,d!==l&&o.writeUInt8(d),o.writeUInt8(a.controllerType),o.writeUInt8(a.value);break;case"programChange":d=192|a.channel,d!==l&&o.writeUInt8(d),o.writeUInt8(a.programNumber);break;case"channelAftertouch":d=208|a.channel,d!==l&&o.writeUInt8(d),o.writeUInt8(a.amount);break;case"pitchBend":d=224|a.channel,d!==l&&o.writeUInt8(d);var b=8192+a.value,w=b&127,v=b>>7&127;o.writeUInt8(w),o.writeUInt8(v);break;default:throw"Unrecognized event type: "+s}return d}function i(){this.buffer=[]}return i.prototype.writeUInt8=function(o){this.buffer.push(o&255)},i.prototype.writeInt8=i.prototype.writeUInt8,i.prototype.writeUInt16=function(o){var a=o>>8&255,l=o&255;this.writeUInt8(a),this.writeUInt8(l)},i.prototype.writeInt16=i.prototype.writeUInt16,i.prototype.writeUInt24=function(o){var a=o>>16&255,l=o>>8&255,u=o&255;this.writeUInt8(a),this.writeUInt8(l),this.writeUInt8(u)},i.prototype.writeInt24=i.prototype.writeUInt24,i.prototype.writeUInt32=function(o){var a=o>>24&255,l=o>>16&255,u=o>>8&255,s=o&255;this.writeUInt8(a),this.writeUInt8(l),this.writeUInt8(u),this.writeUInt8(s)},i.prototype.writeInt32=i.prototype.writeUInt32,i.prototype.writeBytes=function(o){this.buffer=this.buffer.concat(Array.prototype.slice.call(o,0))},i.prototype.writeString=function(o){var a,l=o.length,u=[];for(a=0;a<l;a++)u.push(o.codePointAt(a));this.writeBytes(u)},i.prototype.writeVarInt=function(o){if(o<0)throw"Cannot write negative variable-length integer";if(o<=127)this.writeUInt8(o);else{var a=o,l=[];for(l.push(a&127),a>>=7;a;){var u=a&127|128;l.push(u),a>>=7}this.writeBytes(l.reverse())}},i.prototype.writeChunk=function(o,a){this.writeString(o),this.writeUInt32(a.length),this.writeBytes(a)},Gn=e,Gn}var Ko;function vl(){return Ko||(Ko=1,en.parseMidi=xf(),en.writeMidi=_f()),en}var Hn={},zt={},Jo;function wl(){if(Jo)return zt;Jo=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.insert=zt.search=void 0;function e(t,n,i){i===void 0&&(i="ticks");var o=0,a=t.length,l=a;if(a>0&&t[a-1][i]<=n)return a-1;for(;o<l;){var u=Math.floor(o+(l-o)/2),s=t[u],c=t[u+1];if(s[i]===n){for(var p=u;p<t.length;p++){var f=t[p];f[i]===n&&(u=p)}return u}else{if(s[i]<n&&c[i]>n)return u;s[i]>n?l=u:s[i]<n&&(o=u+1)}}return-1}zt.search=e;function r(t,n,i){if(i===void 0&&(i="ticks"),t.length){var o=e(t,n[i],i);t.splice(o+1,0,n)}else t.push(n)}return zt.insert=r,zt}var Qo;function ki(){return Qo||(Qo=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.keySignatureKeys=void 0;var r=wl(),t=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var n=function(){function i(o){var a=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",t.set(this,480),o){t.set(this,o.header.ticksPerBeat),o.tracks.forEach(function(u){u.forEach(function(s){s.meta&&(s.type==="timeSignature"?a.timeSignatures.push({ticks:s.absoluteTime,timeSignature:[s.numerator,s.denominator]}):s.type==="setTempo"?a.tempos.push({bpm:6e7/s.microsecondsPerBeat,ticks:s.absoluteTime}):s.type==="keySignature"&&a.keySignatures.push({key:e.keySignatureKeys[s.key+7],scale:s.scale===0?"major":"minor",ticks:s.absoluteTime}))})});var l=0;o.tracks[0].forEach(function(u){l+=u.deltaTime,u.meta&&(u.type==="trackName"?a.name=u.text:(u.type==="text"||u.type==="cuePoint"||u.type==="marker"||u.type==="lyrics")&&a.meta.push({text:u.text,ticks:l,type:u.type}))}),this.update()}}return i.prototype.update=function(){var o=this,a=0,l=0;this.tempos.sort(function(u,s){return u.ticks-s.ticks}),this.tempos.forEach(function(u,s){var c=s>0?o.tempos[s-1].bpm:o.tempos[0].bpm,p=u.ticks/o.ppq-l,f=60/c*p;u.time=f+a,a=u.time,l+=p}),this.timeSignatures.sort(function(u,s){return u.ticks-s.ticks}),this.timeSignatures.forEach(function(u,s){var c=s>0?o.timeSignatures[s-1]:o.timeSignatures[0],p=(u.ticks-c.ticks)/o.ppq,f=p/c.timeSignature[0]/(c.timeSignature[1]/4);c.measures=c.measures||0,u.measures=f+c.measures})},i.prototype.ticksToSeconds=function(o){var a=(0,r.search)(this.tempos,o);if(a!==-1){var l=this.tempos[a],u=l.time,s=(o-l.ticks)/this.ppq;return u+60/l.bpm*s}else{var c=o/this.ppq;return 60/120*c}},i.prototype.ticksToMeasures=function(o){var a=(0,r.search)(this.timeSignatures,o);if(a!==-1){var l=this.timeSignatures[a],u=(o-l.ticks)/this.ppq;return l.measures+u/(l.timeSignature[0]/l.timeSignature[1])/4}else return o/this.ppq/4},Object.defineProperty(i.prototype,"ppq",{get:function(){return t.get(this)},enumerable:!1,configurable:!0}),i.prototype.secondsToTicks=function(o){var a=(0,r.search)(this.tempos,o,"time");if(a!==-1){var l=this.tempos[a],u=l.time,s=o-u,c=s/(60/l.bpm);return Math.round(l.ticks+c*this.ppq)}else{var p=o/.5;return Math.round(p*this.ppq)}},i.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(o){return{bpm:o.bpm,ticks:o.ticks}}),timeSignatures:this.timeSignatures}},i.prototype.fromJSON=function(o){this.name=o.name,this.tempos=o.tempos.map(function(a){return Object.assign({},a)}),this.timeSignatures=o.timeSignatures.map(function(a){return Object.assign({},a)}),this.keySignatures=o.keySignatures.map(function(a){return Object.assign({},a)}),this.meta=o.meta.map(function(a){return Object.assign({},a)}),t.set(this,o.ppq),this.update()},i.prototype.setTempo=function(o){this.tempos=[{bpm:o,ticks:0}],this.update()},i}();e.Header=n}(Hn)),Hn}var mr={},Zn={},ea;function kl(){return ea||(ea=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ControlChange=e.controlChangeIds=e.controlChangeNames=void 0,e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce(function(i,o){return i[e.controlChangeNames[o]]=o,i},{});var r=new WeakMap,t=new WeakMap,n=function(){function i(o,a){r.set(this,a),t.set(this,o.controllerType),this.ticks=o.absoluteTime,this.value=o.value}return Object.defineProperty(i.prototype,"number",{get:function(){return t.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"time",{get:function(){var o=r.get(this);return o.ticksToSeconds(this.ticks)},set:function(o){var a=r.get(this);this.ticks=a.secondsToTicks(o)},enumerable:!1,configurable:!0}),i.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},i}();e.ControlChange=n}(Zn)),Zn}var gr={},ta;function Sf(){if(ta)return gr;ta=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.createControlChanges=void 0;var e=kl();function r(){return new Proxy({},{get:function(t,n){if(t[n])return t[n];if(e.controlChangeIds.hasOwnProperty(n))return t[e.controlChangeIds[n]]},set:function(t,n,i){return e.controlChangeIds.hasOwnProperty(n)?t[e.controlChangeIds[n]]=i:t[n]=i,!0}})}return gr.createControlChanges=r,gr}var yr={},ra;function Cf(){if(ra)return yr;ra=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.PitchBend=void 0;var e=new WeakMap,r=function(){function t(n,i){e.set(this,i),this.ticks=n.absoluteTime,this.value=n.value}return Object.defineProperty(t.prototype,"time",{get:function(){var n=e.get(this);return n.ticksToSeconds(this.ticks)},set:function(n){var i=e.get(this);this.ticks=i.secondsToTicks(n)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},t}();return yr.PitchBend=r,yr}var br={},gt={},na;function Pf(){return na||(na=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.DrumKitByPatchID=gt.InstrumentFamilyByID=gt.instrumentByPatchID=void 0,gt.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],gt.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],gt.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}),gt}var ia;function Tf(){if(ia)return br;ia=1,Object.defineProperty(br,"__esModule",{value:!0}),br.Instrument=void 0;var e=Pf(),r=new WeakMap,t=function(){function n(i,o){if(this.number=0,r.set(this,o),this.number=0,i){var a=i.find(function(l){return l.type==="programChange"});a&&(this.number=a.programNumber)}}return Object.defineProperty(n.prototype,"name",{get:function(){return this.percussion?e.DrumKitByPatchID[this.number]:e.instrumentByPatchID[this.number]},set:function(i){var o=e.instrumentByPatchID.indexOf(i);o!==-1&&(this.number=o)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"family",{get:function(){return this.percussion?"drums":e.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"percussion",{get:function(){var i=r.get(this);return i.channel===9},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},n.prototype.fromJSON=function(i){this.number=i.number},n}();return br.Instrument=t,br}var vr={},oa;function $f(){if(oa)return vr;oa=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.Note=void 0;function e(a){var l=Math.floor(a/12)-1;return r(a)+l.toString()}function r(a){var l=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],u=a%12;return l[u]}function t(a){var l=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return l.indexOf(a)}var n=function(){var a=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,l={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(u){var s=a.exec(u),c=s[1],p=s[2],f=l[c.toLowerCase()];return f+(parseInt(p,10)+1)*12}}(),i=new WeakMap,o=function(){function a(l,u,s){i.set(this,s),this.midi=l.midi,this.velocity=l.velocity,this.noteOffVelocity=u.velocity,this.ticks=l.ticks,this.durationTicks=u.ticks-l.ticks}return Object.defineProperty(a.prototype,"name",{get:function(){return e(this.midi)},set:function(l){this.midi=n(l)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(l){var u=l-this.octave;this.midi+=u*12},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pitch",{get:function(){return r(this.midi)},set:function(l){this.midi=12*(this.octave+1)+t(l)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){var l=i.get(this);return l.ticksToSeconds(this.ticks+this.durationTicks)-l.ticksToSeconds(this.ticks)},set:function(l){var u=i.get(this),s=u.secondsToTicks(this.time+l);this.durationTicks=s-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){var l=i.get(this);return l.ticksToSeconds(this.ticks)},set:function(l){var u=i.get(this);this.ticks=u.secondsToTicks(l)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bars",{get:function(){var l=i.get(this);return l.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},a}();return vr.Note=o,vr}var aa;function sa(){if(aa)return mr;aa=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.Track=void 0;var e=wl(),r=kl(),t=Sf(),n=Cf(),i=Tf(),o=$f(),a=new WeakMap,l=function(){function u(s,c){var p=this;if(this.name="",this.notes=[],this.controlChanges=(0,t.createControlChanges)(),this.pitchBends=[],a.set(this,c),s){var f=s.find(function(v){return v.type==="trackName"});this.name=f?f.text:""}if(this.instrument=new i.Instrument(s,this),this.channel=0,s){for(var d=s.filter(function(v){return v.type==="noteOn"}),h=s.filter(function(v){return v.type==="noteOff"}),m=function(){var v=d.shift();g.channel=v.channel;var k=h.findIndex(function(S){return S.noteNumber===v.noteNumber&&S.absoluteTime>=v.absoluteTime});if(k!==-1){var _=h.splice(k,1)[0];g.addNote({durationTicks:_.absoluteTime-v.absoluteTime,midi:v.noteNumber,noteOffVelocity:_.velocity/127,ticks:v.absoluteTime,velocity:v.velocity/127})}},g=this;d.length;)m();var y=s.filter(function(v){return v.type==="controller"});y.forEach(function(v){p.addCC({number:v.controllerType,ticks:v.absoluteTime,value:v.value/127})});var b=s.filter(function(v){return v.type==="pitchBend"});b.forEach(function(v){p.addPitchBend({ticks:v.absoluteTime,value:v.value/Math.pow(2,13)})});var w=s.find(function(v){return v.type==="endOfTrack"});this.endOfTrackTicks=w!==void 0?w.absoluteTime:void 0}}return u.prototype.addNote=function(s){var c=a.get(this),p=new o.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},c);return Object.assign(p,s),(0,e.insert)(this.notes,p,"ticks"),this},u.prototype.addCC=function(s){var c=a.get(this),p=new r.ControlChange({controllerType:s.number},c);return delete s.number,Object.assign(p,s),Array.isArray(this.controlChanges[p.number])||(this.controlChanges[p.number]=[]),(0,e.insert)(this.controlChanges[p.number],p,"ticks"),this},u.prototype.addPitchBend=function(s){var c=a.get(this),p=new n.PitchBend({},c);return Object.assign(p,s),(0,e.insert)(this.pitchBends,p,"ticks"),this},Object.defineProperty(u.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var s=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,c=0;c<this.notes.length-1;c++){var p=this.notes[c].time+this.notes[c].duration;s<p&&(s=p)}return s},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var s=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,c=0;c<this.notes.length-1;c++){var p=this.notes[c].ticks+this.notes[c].durationTicks;s<p&&(s=p)}return s},enumerable:!1,configurable:!0}),u.prototype.fromJSON=function(s){var c=this;this.name=s.name,this.channel=s.channel,this.instrument=new i.Instrument(void 0,this),this.instrument.fromJSON(s.instrument),s.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=s.endOfTrackTicks);for(var p in s.controlChanges)s.controlChanges[p]&&s.controlChanges[p].forEach(function(f){c.addCC({number:f.number,ticks:f.ticks,value:f.value})});s.notes.forEach(function(f){c.addNote({durationTicks:f.durationTicks,midi:f.midi,ticks:f.ticks,velocity:f.velocity})})},u.prototype.toJSON=function(){for(var s={},c=0;c<127;c++)this.controlChanges.hasOwnProperty(c)&&(s[c]=this.controlChanges[c].map(function(f){return f.toJSON()}));var p={channel:this.channel,controlChanges:s,pitchBends:this.pitchBends.map(function(f){return f.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(f){return f.toJSON()})};return this.endOfTrackTicks!==void 0&&(p.endOfTrackTicks=this.endOfTrackTicks),p},u}();return mr.Track=l,mr}var Dt={};function Ef(e){var r=[];return xl(e,r),r}function xl(e,r){for(var t=0;t<e.length;t++){var n=e[t];Array.isArray(n)?xl(n,r):r.push(n)}}const If=Object.freeze(Object.defineProperty({__proto__:null,flatten:Ef},Symbol.toStringTag,{value:"Module"})),Rf=Hu(If);var la;function Af(){if(la)return Dt;la=1;var e=Dt&&Dt.__spreadArray||function(y,b,w){if(w||arguments.length===2)for(var v=0,k=b.length,_;v<k;v++)(_||!(v in b))&&(_||(_=Array.prototype.slice.call(b,0,v)),_[v]=b[v]);return y.concat(_||Array.prototype.slice.call(b))};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.encode=void 0;var r=vl(),t=ki(),n=Rf;function i(y,b){return[{absoluteTime:y.ticks,channel:b,deltaTime:0,noteNumber:y.midi,type:"noteOn",velocity:Math.floor(y.velocity*127)},{absoluteTime:y.ticks+y.durationTicks,channel:b,deltaTime:0,noteNumber:y.midi,type:"noteOff",velocity:Math.floor(y.noteOffVelocity*127)}]}function o(y){return(0,n.flatten)(y.notes.map(function(b){return i(b,y.channel)}))}function a(y,b){return{absoluteTime:y.ticks,channel:b,controllerType:y.number,deltaTime:0,type:"controller",value:Math.floor(y.value*127)}}function l(y){for(var b=[],w=0;w<127;w++)y.controlChanges.hasOwnProperty(w)&&y.controlChanges[w].forEach(function(v){b.push(a(v,y.channel))});return b}function u(y,b){return{absoluteTime:y.ticks,channel:b,deltaTime:0,type:"pitchBend",value:y.value}}function s(y){var b=[];return y.pitchBends.forEach(function(w){b.push(u(w,y.channel))}),b}function c(y){return{absoluteTime:0,channel:y.channel,deltaTime:0,programNumber:y.instrument.number,type:"programChange"}}function p(y){return{absoluteTime:0,deltaTime:0,meta:!0,text:y,type:"trackName"}}function f(y){return{absoluteTime:y.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/y.bpm),type:"setTempo"}}function d(y){return{absoluteTime:y.ticks,deltaTime:0,denominator:y.timeSignature[1],meta:!0,metronome:24,numerator:y.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function h(y){var b=t.keySignatureKeys.indexOf(y.key);return{absoluteTime:y.ticks,deltaTime:0,key:b+7,meta:!0,scale:y.scale==="major"?0:1,type:"keySignature"}}function m(y){return{absoluteTime:y.ticks,deltaTime:0,meta:!0,text:y.text,type:y.type}}function g(y){var b={header:{format:1,numTracks:y.tracks.length+1,ticksPerBeat:y.header.ppq},tracks:e([e(e(e(e([{absoluteTime:0,deltaTime:0,meta:!0,text:y.header.name,type:"trackName"}],y.header.keySignatures.map(function(w){return h(w)}),!0),y.header.meta.map(function(w){return m(w)}),!0),y.header.tempos.map(function(w){return f(w)}),!0),y.header.timeSignatures.map(function(w){return d(w)}),!0)],y.tracks.map(function(w){return e(e(e([p(w.name),c(w)],o(w),!0),l(w),!0),s(w),!0)}),!0)};return b.tracks=b.tracks.map(function(w){w=w.sort(function(k,_){return k.absoluteTime-_.absoluteTime});var v=0;return w.forEach(function(k){k.deltaTime=k.absoluteTime-v,v=k.absoluteTime,delete k.absoluteTime}),w.push({deltaTime:0,meta:!0,type:"endOfTrack"}),w}),new Uint8Array((0,r.writeMidi)(b))}return Dt.encode=g,Dt}var ca;function Mf(){return ca||(ca=1,function(e){var r=Ft&&Ft.__awaiter||function(p,f,d,h){function m(g){return g instanceof d?g:new d(function(y){y(g)})}return new(d||(d=Promise))(function(g,y){function b(k){try{v(h.next(k))}catch(_){y(_)}}function w(k){try{v(h.throw(k))}catch(_){y(_)}}function v(k){k.done?g(k.value):m(k.value).then(b,w)}v((h=h.apply(p,f||[])).next())})},t=Ft&&Ft.__generator||function(p,f){var d={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},h,m,g,y;return y={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function b(v){return function(k){return w([v,k])}}function w(v){if(h)throw new TypeError("Generator is already executing.");for(;d;)try{if(h=1,m&&(g=v[0]&2?m.return:v[0]?m.throw||((g=m.return)&&g.call(m),0):m.next)&&!(g=g.call(m,v[1])).done)return g;switch(m=0,g&&(v=[v[0]&2,g.value]),v[0]){case 0:case 1:g=v;break;case 4:return d.label++,{value:v[1],done:!1};case 5:d.label++,m=v[1],v=[0];continue;case 7:v=d.ops.pop(),d.trys.pop();continue;default:if(g=d.trys,!(g=g.length>0&&g[g.length-1])&&(v[0]===6||v[0]===2)){d=0;continue}if(v[0]===3&&(!g||v[1]>g[0]&&v[1]<g[3])){d.label=v[1];break}if(v[0]===6&&d.label<g[1]){d.label=g[1],g=v;break}if(g&&d.label<g[2]){d.label=g[2],d.ops.push(v);break}g[2]&&d.ops.pop(),d.trys.pop();continue}v=f.call(p,d)}catch(k){v=[6,k],m=0}finally{h=g=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.Track=e.Midi=void 0;var n=vl(),i=ki(),o=sa(),a=Af(),l=function(){function p(f){var d=this,h=null;if(f){var m=f instanceof ArrayBuffer?new Uint8Array(f):f;h=(0,n.parseMidi)(m),h.tracks.forEach(function(g){var y=0;g.forEach(function(b){y+=b.deltaTime,b.absoluteTime=y})}),h.tracks=c(h.tracks)}this.header=new i.Header(h),this.tracks=[],f&&(this.tracks=h.tracks.map(function(g){return new o.Track(g,d.header)}),h.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return p.fromUrl=function(f){return r(this,void 0,void 0,function(){var d,h;return t(this,function(m){switch(m.label){case 0:return[4,fetch(f)];case 1:return d=m.sent(),d.ok?[4,d.arrayBuffer()]:[3,3];case 2:return h=m.sent(),[2,new p(h)];case 3:throw new Error("Could not load '".concat(f,"'"))}})})},Object.defineProperty(p.prototype,"name",{get:function(){return this.header.name},set:function(f){this.header.name=f},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"duration",{get:function(){var f=this.tracks.map(function(d){return d.duration});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"durationTicks",{get:function(){var f=this.tracks.map(function(d){return d.durationTicks});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),p.prototype.addTrack=function(){var f=new o.Track(void 0,this.header);return this.tracks.push(f),f},p.prototype.toArray=function(){return(0,a.encode)(this)},p.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(f){return f.toJSON()})}},p.prototype.fromJSON=function(f){var d=this;this.header=new i.Header,this.header.fromJSON(f.header),this.tracks=f.tracks.map(function(h){var m=new o.Track(void 0,d.header);return m.fromJSON(h),m})},p.prototype.clone=function(){var f=new p;return f.fromJSON(this.toJSON()),f},p}();e.Midi=l;var u=sa();Object.defineProperty(e,"Track",{enumerable:!0,get:function(){return u.Track}});var s=ki();Object.defineProperty(e,"Header",{enumerable:!0,get:function(){return s.Header}});function c(p){for(var f=[],d=0;d<p.length;d++)for(var h=f.length,m=new Map,g=Array(16).fill(0),y=0,b=p[d];y<b.length;y++){var w=b[y],v=h,k=w.channel;if(k!==void 0){w.type==="programChange"&&(g[k]=w.programNumber);var _=g[k],S="".concat(_," ").concat(k);m.has(S)?v=m.get(S):(v=h+m.size,m.set(S,v))}f[v]||f.push([]),f[v].push(w)}return f}}(Ft)),Ft}var _l=Mf();const Nf=W({prev:D(E),delay:D(E),next:ee(E)}),Zi=new X({typeName:"Delay",typeSchema:Nf}),Of=W({next:ee(E)}),Wi=new X({typeName:"Start",typeSchema:Of}),Ff=W({value:Je(),out:ee(E)}),$r=new X({typeName:"Number",typeSchema:Ff}),zf=W({id:mt(),prev:D(E),value:D(E),next:ee(E)}),Yi=new X({typeName:"SetVariable",typeSchema:zf}),Df=W({id:mt(),value:ee(E)}),Xi=new X({typeName:"Variable",typeSchema:Df}),Lf=W({frequency:D(E),out:ee(E)}),Ki=new X({typeName:"Meow",typeSchema:Lf}),Uf=W({in:D(E)}),Ji=new X({typeName:"Speaker",typeSchema:Uf});async function jf(e,r){let t=[],n=new _l.Midi(await r.arrayBuffer());for(let m of n.tracks)for(let g of m.notes)t.push({time:g.time,type:"NoteOn",note:g.midi}),t.push({time:g.time+g.duration,type:"NoteOff",note:g.midi});t.sort((m,g)=>m.time-g.time);let i=1e3,o=new Set,a=new Map,l=0;for(let m of t){let g=a.get(m.time);if(g==null?(g=[m],a.set(m.time,g)):g.push(m),o.add(m.note),++l,l>=i)break}let u=0,s=0,c,p;{let m=Wi.create({next:[]});p=y=>{m.setState("next",b=>[...b,y])},c={target:e.createEntity([m,Ie.create({transform:_e.create(G.create(s,0),xe.rot0)})]),pin:"next"}}s+=200;let f=[],d,h=-200;for(let m=21;m<=108;++m){if(!o.has(m))continue;let g=261.63*Math.pow(2,(m-60)/12),y=$r.create({value:g,out:[]}),b=e.createEntity([y,Ie.create({transform:_e.create(G.create(s,h),xe.rot0)})]);f[m]={id:b,c:y},h-=100}{let m=$r.create({value:0,out:[]});d={id:e.createEntity([m,Ie.create({transform:_e.create(G.create(s,h),xe.rot0)})]),c:m}}for(let m=21;m<=108;++m){if(!o.has(m))continue;let g=Xi.create({id:`n${m}`,value:[]}),y=e.createEntity([g,Ie.create({transform:_e.create(G.create(s,h),xe.rot0)})]),b=Ki.create({frequency:{target:y,pin:"value"},out:[]}),w=e.createEntity([b,Ie.create({transform:_e.create(G.create(s+150,h),xe.rot0)})]);g.setState("value",[{target:w,pin:"frequency"}]);let v=Ji.create({in:{target:w,pin:"out"}}),k=e.createEntity([v,Ie.create({transform:_e.create(G.create(s+300,h),xe.rot0)})]);b.setState("out",[{target:k,pin:"in"}]),h-=100}for(let[m,g]of a.entries()){let y=m-u;u=m;{let b=Zi.create({prev:c,delay:void 0,next:[]});p=_=>{b.setState("next",S=>[...S,_])};let w=e.createEntity([b,Ie.create({transform:_e.create(G.create(s,0),xe.rot0)})]),v=e.createEntity([$r.create({value:y*1e3,out:[{target:w,pin:"delay"}]}),Ie.create({transform:_e.create(G.create(s,-100),xe.rot0)})]);b.setState("delay",{target:v,pin:"out"}),c={target:w,pin:"next"};let k=-250;for(let _ of g){_.type=="NoteOn"&&261.63*Math.pow(2,(_.note-128)/12);let S=Yi.create({id:`n${_.note}`,prev:{...c},value:void 0,next:[]}),P=e.createEntity([S,Ie.create({transform:_e.create(G.create(s,k),xe.rot0)})]);if(_.type=="NoteOn"){let T=f[_.note];T.c.setState("out",$=>[...$,{target:P,pin:"value"}]),S.setState("value",{target:T.id,pin:"out"})}else d.c.setState("out",T=>[...T,{target:P,pin:"value"}]),S.setState("value",{target:d.id,pin:"out"});p({target:P,pin:"prev"}),k-=200}}if(s+=200,i-=g.length,await new Promise(b=>requestAnimationFrame(()=>b())),i<=0)break}}const Bf=W({a:D(E),b:D(E),out:ee(E)}),Sl=new X({typeName:"Add",typeSchema:Bf});class qf{componentType=Sl;ext={};create(r){return new Vf(r)}}const Cl=new qf;class Vf{type=Cl;nodeParams;inputPins;outputPins;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"a",source:()=>t.a,setSource:i=>n("a",i)},{name:"b",source:()=>t.b,setSource:i=>n("b",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext={generateCode:({ctx:i,inputAtoms:o})=>{let a=o.get("a");if(a==null)return[];let l=o.get("b");if(l==null)return[];let u=i.allocField("0.0");i.insertCode([`${u} = ${a} + ${l}`]);let s=new Map;return s.set("out",u),[{outputAtoms:s}]}}}}const Gf=W({timeToOne:D(E),out:ee(E)}),Pl=new X({typeName:"Attack",typeSchema:Gf});class Hf{componentType=Pl;ext={};create(r){return new Zf(r)}}const Tl=new Hf;class Zf{type=Tl;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"timeToOne",source:()=>t.timeToOne,setSource:i=>n("timeToOne",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}])}}class Wf{componentType=Zi;ext={};create(r){return new Yf(r)}}const $l=new Wf;class Yf{type=$l;nodeParams;inputPins;outputPins;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"prev",source:()=>t.prev,setSource:i=>n("prev",i),isEffectPin:!0},{name:"delay",source:()=>t.delay,setSource:i=>n("delay",i)}]),this.outputPins=C(()=>[{name:"next",sinks:()=>t.next,setSinks:i=>n("next",i),isEffectPin:!0}]),this.ext={generateCode:({ctx:i,inputAtoms:o,codeGenNodeId:a})=>{let l=o.get("prev");if(l==null)return[];let u=o.get("delay");if(u==null)return[];let s=`this.n_${a}_next`;i.addDeclToExistingForField(s,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`);let c=i.allocField("0.0");i.insertConstructorCode([`${l}.onDone.push(() => {`,`  ${c} = currentTime * 1000.0;`,`  this.insertRunningEffect(${s});`,"});",`${s}.update = () => {`,`  let time = currentTime * 1000.0 - ${c};`,"  // return true when done.",`  return time >= ${u};`,"};"]);let p=`${s}`,f=new Map;return f.set("next",p),[{outputAtoms:f}]}}}}const Xf=W({prev:D(E),entry:D(E),next:ee(E)}),El=new X({typeName:"Goto",typeSchema:Xf});class Kf{componentType=El;ext={};create(r){return new Jf(r)}}const Il=new Kf;class Jf{type=Il;nodeParams;inputPins;outputPins;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"prev",source:()=>t.prev,setSource:i=>n("prev",i),isEffectPin:!0},{name:"entry",source:()=>t.entry,setSource:i=>n("entry",i),isEffectPin:!0}]),this.outputPins=C(()=>[{name:"next",sinks:()=>t.next,setSinks:i=>n("next",i),isEffectPin:!0}]),this.ext={generateCode:({ctx:i,inputAtoms:o,codeGenNodeId:a})=>{let l=o.get("prev");if(l==null)return[];let u=o.get("entry");if(u==null)return[];let s=`this.n_${a}_next`;i.addDeclToExistingForField(s,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),i.insertConstructorCode([`${l}.onDone.push(() => {`,`  this.insertRunningEffect(${s});`,"});",`${u}.onDone.push(() => {`,`  this.insertRunningEffect(${s});`,"});",`${s}.update = () => true;`]);let c=`${s}`,p=new Map;return p.set("next",c),[{outputAtoms:p}]}}}}const Qf=W({out:ee(E)}),Qi=new X({typeName:"Knob",typeSchema:Qf});var eh=Z(`<svg version=1.1 viewBox="-16 -16 32 32"><defs><linearGradient id=shape-fill x1=0 x2=0 y1=0 y2=1><stop offset=0% stop-color="rgb(80, 80, 81)"></stop><stop offset=100% stop-color="rgb(30, 30, 31)"></stop></linearGradient><path id=shape d="
        M14.876 -5.890A-16 -16 0 0 0 14.876 5.890A16 16 0 0 112.539 9.938A-16 -16 0 0 0 2.337 15.828
        A16 16 0 0 1-2.337 15.828A-16 -16 0 0 0 -12.539 9.938A16 16 0 0 1-14.876 5.890A-16 -16 0 0 0 -14.876 -5.890
        A16 16 0 0 1-12.539 -9.938A-16 -16 0 0 0 -2.337 -15.828A16 16 0 0 12.337 -15.828A-16 -16 0 0 0 12.539 -9.938
        A16 16 0 0 114.876 -5.890"></path><clipPath id=shape-mask style="transform:rotate(var(--rot)) scale(0.87)"><use href=#shape></use></clipPath><filter id=lights></filter><filter id=shadow></filter></defs><circle cx=0 cy=0 r=15.0 fill="rgb(36, 36, 37)"stroke="rgb(28, 28, 29)"stroke-width=0.5></circle><g filter=url(#shadow)><g filter=url(#lights)><g clip-path=url(#shape-mask)><rect x=-16 y=-16 width=32 height=32 fill=url(#shape-fill)></rect><circle cx=-28 cy=-28 r=32 fill="rgba(250, 250, 255, .16)"></circle></g></g></g><g style=transform:rotate(var(--rot))><circle cx=0 cy=-11 r=1.1 fill=black></circle><circle cx=0 cy=-11 r=0.8 fill=white></circle></g><circle cx=0 cy=0 r=9 stroke="rgb(50, 50, 51)"stroke-width=0.7 fill=none></circle><foreignObject x=-9 y=-9 width=18 height=18><div style=width:18px;height:18px;border-radius:50%;background-image:conic-gradient(#aaa,#666,#aaa,#666,#aaa,#666,#aaa);>`);const th=e=>{let[r,t]=Me({dragging:void 0}),[n,i]=K();Te(()=>{r.dragging&&e.setDisablePan(!1)});let o=-165,a=-o,l=C(()=>o+(e.value-e.minValue)*(a-o)/(e.maxValue-e.minValue)),u=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");u.setAttribute("dx","-0.3"),u.setAttribute("dy","-0.3"),u.setAttribute("stdDeviation","0.1"),u.setAttribute("flood-opacity","0.7"),u.setAttribute("flood-color","white");let s=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");s.setAttribute("dx","1.5"),s.setAttribute("dy","1.5"),s.setAttribute("stdDeviation","0.5"),s.setAttribute("flood-opacity","0.9"),s.setAttribute("flood-color","black");let c=d=>{let h=n(),m=h.getBoundingClientRect(),g=d.clientX-m.left,y=d.clientY-m.top,b=g-.5*m.width,w=y-.5*m.width;console.log("x",g.toFixed()),console.log("y",y.toFixed()),console.log("dx",b.toFixed()),console.log("dy",w.toFixed());let v=b*b+w*w;if(v>m.width*m.width)return;let k=Math.sqrt(v),S=360/(2*Math.PI*k),P=w>0?-S:S,T=b>0?S:-S;t("dragging",new qr({pointerId:d.pointerId,startX:g,startY:y,startValue:e.value,dadx:P,dady:T})),h.setPointerCapture(d.pointerId),e.setDisablePan(!0)},p=d=>{if(r.dragging==null||d.pointerId!=r.dragging.value.pointerId)return;let h=n(),m=r.dragging.value,g=h.getBoundingClientRect(),y=d.clientX-g.left,b=d.clientY-g.top,w=o+(m.startValue-e.minValue)*(a-o)/(e.maxValue-e.minValue)+(y-m.startX)*m.dadx+(b-m.startY)*m.dady,v=e.minValue+(w-o)*(e.maxValue-e.minValue)/(a-o);v=Math.max(e.minValue,Math.min(e.maxValue,v)),e.setValue(v)},f=d=>{r.dragging!=null&&r.dragging.value.pointerId==d.pointerId&&(n().releasePointerCapture(r.dragging.value.pointerId),e.setDisablePan(!1))};return(()=>{var d=eh(),h=d.firstChild,m=h.firstChild,g=m.nextSibling,y=g.nextSibling,b=y.nextSibling,w=b.nextSibling;d.$$pointerup=f,d.$$pointermove=p,d.$$pointerdown=c;var v=i;return typeof v=="function"?ve(v,d):i=d,d.style.setProperty("user-select","none"),d.style.setProperty("outline","none"),Y(b,u),Y(w,s),Q(k=>{var _=`${e.size}px`,S=`${e.size}px`,P=`${l()}deg`;return _!==k.e&&((k.e=_)!=null?d.style.setProperty("width",_):d.style.removeProperty("width")),S!==k.t&&((k.t=S)!=null?d.style.setProperty("height",S):d.style.removeProperty("height")),P!==k.a&&((k.a=P)!=null?d.style.setProperty("--rot",P):d.style.removeProperty("--rot")),k},{e:void 0,t:void 0,a:void 0}),d})()};$e(["pointerdown","pointermove","pointerup"]);var rh=Z("<div><div><label class=input>min<input type=text value=0.00></label><label class=input>max<input type=text value=1.00></label><label class=input>value<input type=text>");class nh{componentType=Qi;ext;constructor(){this.ext={generateInitOnceCode:({ctx:r})=>{r.insertGlobalCode(["let knobValues = {};"]),r.insertMessageHandlerCode("KnobChange",["knobValues[params.id] = params.value;"])}}}create(r){return new ih(r)}}const Rl=new nh;class ih{type=Rl;nodeParams;outputPins;ui;disablePan;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:u=>n("out",u)}]);let[i,o]=K(!1),[a,l]=K();this.ui=C(()=>()=>{let[u,s]=K(0);ge(se(u,p=>{let f=a();f?.port.postMessage({type:"KnobChange",params:{id:`${r.entity}`,value:p}})})),Te(()=>o(!1));let c=100;return(()=>{var p=rh(),f=p.firstChild,d=f.firstChild,h=d.nextSibling,m=h.nextSibling,g=m.firstChild,y=g.nextSibling;return f.style.setProperty("max-width","100px"),Y(p,M(th,{size:c,indentSize:10,minValue:0,maxValue:1,get value(){return u()},setValue:s,setDisablePan:o}),null),Q(()=>y.value=u().toFixed(2)),p})()}),this.disablePan=i,this.ext={init:async u=>{l(u)},generateCode:({ctx:u})=>{u.insertGlobalCode([`knobValues["${r.entity}"] = 0.0;`]);let s=`knobValues["${r.entity}"]`,c=new Map;return c.set("out",s),[{outputAtoms:c}]}}}}var Wn={exports:{}},ua;function oh(){return ua||(ua=1,function(e,r){(function(t,n){e.exports=n()})(window,function(){return function(t){var n={};function i(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=t,i.c=n,i.d=function(o,a,l){i.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:l})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,a){if(1&a&&(o=i(o)),8&a||4&a&&typeof o=="object"&&o&&o.__esModule)return o;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:o}),2&a&&typeof o!="string")for(var u in o)i.d(l,u,function(s){return o[s]}.bind(null,u));return l},i.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(a,"a",a),a},i.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},i.p="",i(i.s="./src/index.ts")}({"./src/chunk.ts":function(t,n,i){i.r(n),i.d(n,"SF2Chunk",function(){return d});var o=i("./src/riff/index.ts"),a=i("./src/constants.ts"),l=i("./src/chunks/index.ts");function u(h){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(h)}function s(h,m){for(var g=0;g<m.length;g++){var y=m[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(h,y.key,y)}}function c(h){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(h)}function p(h,m){return(p=Object.setPrototypeOf||function(g,y){return g.__proto__=y,g})(h,m)}function f(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}var d=function(h){function m(b){var w,v,k,_,S,P;return function(T,$){if(!(T instanceof $))throw new TypeError("Cannot call a class as a function")}(this,m),v=this,w=!(k=c(m).call(this,b.id,b.length,b.buffer,b.subChunks))||u(k)!=="object"&&typeof k!="function"?f(v):k,_=f(f(w)),P=void 0,(S="subChunks")in _?Object.defineProperty(_,S,{value:P,enumerable:!0,configurable:!0,writable:!0}):_[S]=P,w.subChunks=b.subChunks.map(function(T){return new m(T)}),w}var g,y;return function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&p(b,w)}(m,h),g=m,(y=[{key:"getMetaData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var b=this.subChunks.reduce(function(w,v){if(v.id==="ifil"||v.id==="iver"){if(v.length!==a.SF_VERSION_LENGTH)throw new o.ParseError("Invalid size for the '".concat(v.id,"' sub-chunk"));w[v.id]="".concat(v.getInt16(),".").concat(v.getInt16(2))}else w[v.id]=v.getString();return w},{});if(!b.ifil)throw new o.ParseError("Missing required 'ifil' sub-chunk");if(!b.INAM)throw new o.ParseError("Missing required 'INAM' sub-chunk");return{version:b.ifil,soundEngine:b.isng||"EMU8000",name:b.INAM,rom:b.irom,romVersion:b.iver,creationDate:b.ICRD,author:b.IENG,product:b.IPRD,copyright:b.ICOP,comments:b.ICMT,createdBy:b.ISFT}}},{key:"getSampleData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var b=this.subChunks[0];if(b.id!=="smpl")throw new o.ParseError("Invalid chunk signature","'smpl'","'".concat(b.id,"'"));return b.buffer}},{key:"getPresetData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));return{presetHeaders:Object(l.getPresetHeaders)(this.subChunks[0]),presetZones:Object(l.getZones)(this.subChunks[1],"pbag"),presetModulators:Object(l.getModulators)(this.subChunks[2],"pmod"),presetGenerators:Object(l.getGenerators)(this.subChunks[3],"pgen"),instrumentHeaders:Object(l.getInstrumentHeaders)(this.subChunks[4]),instrumentZones:Object(l.getZones)(this.subChunks[5],"ibag"),instrumentModulators:Object(l.getModulators)(this.subChunks[6],"imod"),instrumentGenerators:Object(l.getGenerators)(this.subChunks[7],"igen"),sampleHeaders:Object(l.getSampleHeaders)(this.subChunks[8])}}}])&&s(g.prototype,y),m}(o.RIFFChunk)},"./src/chunks/generators.ts":function(t,n,i){i.r(n),i.d(n,"getGenerators",function(){return p});var o=i("./src/riff/index.ts"),a=i("./src/types/index.ts"),l=i("./src/constants.ts"),u=[a.GeneratorType.StartAddrsOffset,a.GeneratorType.EndAddrsOffset,a.GeneratorType.StartLoopAddrsOffset,a.GeneratorType.EndLoopAddrsOffset,a.GeneratorType.StartAddrsCoarseOffset,a.GeneratorType.EndAddrsCoarseOffset,a.GeneratorType.StartLoopAddrsCoarseOffset,a.GeneratorType.KeyNum,a.GeneratorType.Velocity,a.GeneratorType.EndLoopAddrsCoarseOffset,a.GeneratorType.SampleModes,a.GeneratorType.ExclusiveClass,a.GeneratorType.OverridingRootKey],s=[a.GeneratorType.Unused1,a.GeneratorType.Unused2,a.GeneratorType.Unused3,a.GeneratorType.Unused4,a.GeneratorType.Reserved1,a.GeneratorType.Reserved2,a.GeneratorType.Reserved3],c=[a.GeneratorType.KeyRange,a.GeneratorType.VelRange],p=function(f,d){if(f.id!==d)throw new o.ParseError("Unexpected chunk ID","'".concat(d,"'"),"'".concat(f.id,"'"));if(f.length%l.SF_GENERATOR_SIZE)throw new o.ParseError("Invalid size for the '".concat(d,"' sub-chunk"));return f.iterate(function(h){var m=h.getInt16();return a.GeneratorType[m]?d==="pgen"&&u.includes(m)||d==="igen"&&s.includes(m)?null:c.includes(m)?{id:m,range:{lo:h.getByte(),hi:h.getByte()}}:{id:m,value:h.getInt16BE()}:null})}},"./src/chunks/index.ts":function(t,n,i){i.r(n);var o=i("./src/chunks/instruments/index.ts");i.d(n,"getInstrumentHeaders",function(){return o.getInstrumentHeaders});var a=i("./src/chunks/presets/index.ts");i.d(n,"getPresetHeaders",function(){return a.getPresetHeaders});var l=i("./src/chunks/samples/index.ts");i.d(n,"getSampleHeaders",function(){return l.getSampleHeaders});var u=i("./src/chunks/generators.ts");i.d(n,"getGenerators",function(){return u.getGenerators});var s=i("./src/chunks/modulators.ts");i.d(n,"getModulators",function(){return s.getModulators});var c=i("./src/chunks/zones.ts");i.d(n,"getZones",function(){return c.getZones}),i.d(n,"getItemsInZone",function(){return c.getItemsInZone})},"./src/chunks/instruments/headers.ts":function(t,n,i){i.r(n),i.d(n,"getInstrumentHeaders",function(){return l});var o=i("./src/riff/index.ts"),a=i("./src/constants.ts"),l=function(u){if(u.id!=="inst")throw new o.ParseError("Unexpected chunk ID","'inst'","'".concat(u.id,"'"));if(u.length%a.SF_INSTRUMENT_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'inst' sub-chunk");return u.iterate(function(s){return{name:s.getString(),bagIndex:s.getInt16()}})}},"./src/chunks/instruments/index.ts":function(t,n,i){i.r(n);var o=i("./src/chunks/instruments/headers.ts");i.d(n,"getInstrumentHeaders",function(){return o.getInstrumentHeaders})},"./src/chunks/modulators.ts":function(t,n,i){i.r(n),i.d(n,"getModulators",function(){return u});var o=i("./src/riff/index.ts"),a=i("./src/constants.ts"),l=function(s){return{type:s>>10&63,polarity:s>>9&1,direction:s>>8&1,palette:s>>7&1,index:127&s}},u=function(s,c){if(s.id!==c)throw new o.ParseError("Unexpected chunk ID","'".concat(c,"'"),"'".concat(s.id,"'"));if(s.length%a.SF_MODULATOR_SIZE)throw new o.ParseError("Invalid size for the '".concat(c,"' sub-chunk"));return s.iterate(function(p){return{source:l(p.getInt16BE()),id:p.getInt16BE(),value:p.getInt16BE(),valueSource:l(p.getInt16BE()),transform:p.getInt16BE()}})}},"./src/chunks/presets/headers.ts":function(t,n,i){i.r(n),i.d(n,"getPresetHeaders",function(){return l});var o=i("./src/riff/index.ts"),a=i("./src/constants.ts"),l=function(u){if(u.id!=="phdr")throw new o.ParseError("Invalid chunk ID","'phdr'","'".concat(u.id,"'"));if(u.length%a.SF_PRESET_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'phdr' sub-chunk");return u.iterate(function(s){return{name:s.getString(),preset:s.getInt16(),bank:s.getInt16(),bagIndex:s.getInt16(),library:s.getUInt32(),genre:s.getUInt32(),morphology:s.getUInt32()}})}},"./src/chunks/presets/index.ts":function(t,n,i){i.r(n);var o=i("./src/chunks/presets/headers.ts");i.d(n,"getPresetHeaders",function(){return o.getPresetHeaders})},"./src/chunks/samples/headers.ts":function(t,n,i){i.r(n),i.d(n,"getSampleHeaders",function(){return l});var o=i("./src/riff/index.ts"),a=i("./src/constants.ts"),l=function(u){if(u.id!=="shdr")throw new o.ParseError("Unexpected chunk ID","'shdr'","'".concat(u.id,"'"));if(u.length%a.SF_SAMPLE_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'shdr' sub-chunk");return u.iterate(function(s){return{name:s.getString(),start:s.getUInt32(),end:s.getUInt32(),startLoop:s.getUInt32(),endLoop:s.getUInt32(),sampleRate:s.getUInt32(),originalPitch:s.getByte(),pitchCorrection:s.getChar(),link:s.getInt16(),type:s.getInt16()}})}},"./src/chunks/samples/index.ts":function(t,n,i){i.r(n);var o=i("./src/chunks/samples/headers.ts");i.d(n,"getSampleHeaders",function(){return o.getSampleHeaders})},"./src/chunks/zones.ts":function(t,n,i){i.r(n),i.d(n,"getZones",function(){return u}),i.d(n,"getItemsInZone",function(){return s});var o=i("./src/riff/index.ts"),a=i("./src/constants.ts"),l=i("./src/types/index.ts"),u=function(d,h){if(d.id!==h)throw new o.ParseError("Unexpected chunk ID","'".concat(h,"'"),"'".concat(d.id,"'"));if(d.length%a.SF_BAG_SIZE)throw new o.ParseError("Invalid size for the '".concat(h,"' sub-chunk"));return d.iterate(function(m){return{generatorIndex:m.getInt16(),modulatorIndex:m.getInt16()}})},s=function(d,h,m,g,y,b){for(var w=[],v=0;v<d.length;v++){for(var k=d[v],_=d[v+1],S=k.bagIndex,P=_?_.bagIndex:h.length,T=[],$=void 0,x=S;x<P;x++){var I=c(x,h,m),F=p(x,h,g),N=F[l.GeneratorType.KeyRange]&&F[l.GeneratorType.KeyRange].range,R=F[b];if(R){var O=y[R.value];O&&T.push({keyRange:N,modulators:I,generators:F,reference:O})}else x-S==0&&($={keyRange:N,modulators:I,generators:F})}w.push({header:k,globalZone:$,zones:T})}return w},c=function(d,h,m){var g=h[d],y=h[d+1],b=g.modulatorIndex,w=y?y.modulatorIndex:h.length;return f(b,w,m)},p=function(d,h,m){var g=h[d],y=h[d+1],b=g.generatorIndex,w=y?y.generatorIndex:h.length;return f(b,w,m)},f=function(d,h,m){for(var g={},y=d;y<h;y++){var b=m[y];b&&(g[b.id]=b)}return g}},"./src/constants.ts":function(t,n,i){i.r(n),i.d(n,"SF_VERSION_LENGTH",function(){return o}),i.d(n,"SF_PRESET_HEADER_SIZE",function(){return a}),i.d(n,"SF_BAG_SIZE",function(){return l}),i.d(n,"SF_MODULATOR_SIZE",function(){return u}),i.d(n,"SF_GENERATOR_SIZE",function(){return s}),i.d(n,"SF_INSTRUMENT_HEADER_SIZE",function(){return c}),i.d(n,"SF_SAMPLE_HEADER_SIZE",function(){return p}),i.d(n,"DEFAULT_SAMPLE_RATE",function(){return f});var o=4,a=38,l=4,u=10,s=4,c=22,p=46,f=22050},"./src/index.ts":function(t,n,i){i.r(n);var o=i("./src/types/index.ts");for(var a in o)["default"].indexOf(a)<0&&function(c){i.d(n,c,function(){return o[c]})}(a);var l=i("./src/chunk.ts");i.d(n,"SF2Chunk",function(){return l.SF2Chunk});var u=i("./src/constants.ts");i.d(n,"SF_VERSION_LENGTH",function(){return u.SF_VERSION_LENGTH}),i.d(n,"SF_PRESET_HEADER_SIZE",function(){return u.SF_PRESET_HEADER_SIZE}),i.d(n,"SF_BAG_SIZE",function(){return u.SF_BAG_SIZE}),i.d(n,"SF_MODULATOR_SIZE",function(){return u.SF_MODULATOR_SIZE}),i.d(n,"SF_GENERATOR_SIZE",function(){return u.SF_GENERATOR_SIZE}),i.d(n,"SF_INSTRUMENT_HEADER_SIZE",function(){return u.SF_INSTRUMENT_HEADER_SIZE}),i.d(n,"SF_SAMPLE_HEADER_SIZE",function(){return u.SF_SAMPLE_HEADER_SIZE}),i.d(n,"DEFAULT_SAMPLE_RATE",function(){return u.DEFAULT_SAMPLE_RATE});var s=i("./src/soundFont2.ts");i.d(n,"SoundFont2",function(){return s.SoundFont2})},"./src/riff/chunkIterator.ts":function(t,n,i){i.r(n),i.d(n,"ChunkIterator",function(){return s});var o=i("./src/utils/index.ts");function a(c,p){if(!(c instanceof p))throw new TypeError("Cannot call a class as a function")}function l(c,p){for(var f=0;f<p.length;f++){var d=p[f];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function u(c,p,f){return p in c?Object.defineProperty(c,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[p]=f,c}var s=function(){function c(d){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;a(this,c),u(this,"target",[]),u(this,"chunk",void 0),u(this,"position",0),this.chunk=d,this.position=h}var p,f;return p=c,(f=[{key:"iterate",value:function(d){for(;this.position<this.chunk.length;){var h=d(this);h&&this.target.push(h)}}},{key:"getString",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20,h=Object(o.getStringFromBuffer)(this.getBuffer(this.position,d));return this.position+=d,h}},{key:"getInt16",value:function(){return this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8}},{key:"getInt16BE",value:function(){return this.getInt16()<<16>>16}},{key:"getUInt32",value:function(){return(this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8|this.chunk.buffer[this.position++]<<16|this.chunk.buffer[this.position++]<<24)>>>0}},{key:"getByte",value:function(){return this.chunk.buffer[this.position++]}},{key:"getChar",value:function(){return this.chunk.buffer[this.position++]<<24>>24}},{key:"skip",value:function(d){this.position+=d}},{key:"getBuffer",value:function(d,h){return this.chunk.buffer.subarray(d,d+h)}},{key:"currentPosition",get:function(){return this.position}}])&&l(p.prototype,f),c}()},"./src/riff/index.ts":function(t,n,i){i.r(n);var o=i("./src/riff/chunkIterator.ts");i.d(n,"ChunkIterator",function(){return o.ChunkIterator});var a=i("./src/riff/parseError.ts");i.d(n,"ParseError",function(){return a.ParseError});var l=i("./src/riff/parser.ts");i.d(n,"parseBuffer",function(){return l.parseBuffer}),i.d(n,"getChunk",function(){return l.getChunk}),i.d(n,"getChunkLength",function(){return l.getChunkLength}),i.d(n,"getSubChunks",function(){return l.getSubChunks}),i.d(n,"getChunkId",function(){return l.getChunkId});var u=i("./src/riff/riffChunk.ts");i.d(n,"RIFFChunk",function(){return u.RIFFChunk})},"./src/riff/parseError.ts":function(t,n,i){function o(d){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(d)}function a(d,h){return!h||o(h)!=="object"&&typeof h!="function"?function(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}(d):h}function l(d){var h=typeof Map=="function"?new Map:void 0;return(l=function(m){if(m===null||(g=m,Function.toString.call(g).indexOf("[native code]")===-1))return m;var g;if(typeof m!="function")throw new TypeError("Super expression must either be null or a function");if(h!==void 0){if(h.has(m))return h.get(m);h.set(m,y)}function y(){return s(m,arguments,p(this).constructor)}return y.prototype=Object.create(m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),c(y,m)})(d)}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function s(d,h,m){return(s=u()?Reflect.construct:function(g,y,b){var w=[null];w.push.apply(w,y);var v=new(Function.bind.apply(g,w));return b&&c(v,b.prototype),v}).apply(null,arguments)}function c(d,h){return(c=Object.setPrototypeOf||function(m,g){return m.__proto__=g,m})(d,h)}function p(d){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(d)}i.r(n),i.d(n,"ParseError",function(){return f});var f=function(d){function h(m,g,y){return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,h),a(this,p(h).call(this,"".concat(m).concat(g&&y?", expected ".concat(g,", received ").concat(y):"")))}return function(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),g&&c(m,g)}(h,d),h}(l(Error))},"./src/riff/parser.ts":function(t,n,i){i.r(n),i.d(n,"parseBuffer",function(){return u}),i.d(n,"getChunk",function(){return s}),i.d(n,"getChunkLength",function(){return c}),i.d(n,"getSubChunks",function(){return p}),i.d(n,"getChunkId",function(){return f});var o=i("./src/riff/parseError.ts"),a=i("./src/utils/buffer.ts"),l=i("./src/riff/riffChunk.ts"),u=function(d){var h=f(d);if(h!=="RIFF")throw new o.ParseError("Invalid file format","RIFF",h);var m=f(d,8);if(m!=="sfbk")throw new o.ParseError("Invalid signature","sfbk",m);var g=d.subarray(8),y=p(g.subarray(4));return new l.RIFFChunk(h,g.length,g,y)},s=function(d,h){var m=f(d,h),g=c(d,h+4),y=[];return m!=="RIFF"&&m!=="LIST"||(y=p(d.subarray(h+12))),new l.RIFFChunk(m,g,d.subarray(h+8),y)},c=function(d,h){return((d=d.subarray(h,h+4))[0]|d[1]<<8|d[2]<<16|d[3]<<24)>>>0},p=function(d){for(var h=[],m=0;m<=d.length-8;){var g=s(d,m);h.push(g),m=(m+=8+g.length)%2?m+1:m}return h},f=function(d){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Object(a.getStringFromBuffer)(d.subarray(h,h+4))}},"./src/riff/riffChunk.ts":function(t,n,i){i.r(n),i.d(n,"RIFFChunk",function(){return s});var o=i("./src/riff/chunkIterator.ts"),a=i("./src/utils/index.ts");function l(c,p){for(var f=0;f<p.length;f++){var d=p[f];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function u(c,p,f){return p in c?Object.defineProperty(c,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[p]=f,c}var s=function(){function c(d,h,m,g){(function(y,b){if(!(y instanceof b))throw new TypeError("Cannot call a class as a function")})(this,c),u(this,"id",void 0),u(this,"length",void 0),u(this,"buffer",void 0),u(this,"subChunks",void 0),this.id=d,this.length=h,this.buffer=m,this.subChunks=g}var p,f;return p=c,(f=[{key:"getString",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,h=arguments.length>1?arguments[1]:void 0;return Object(a.getStringFromBuffer)(this.getBuffer(d,h||this.length-d))}},{key:"getInt16",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[d++]|this.buffer[d]<<8}},{key:"getUInt32",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(this.buffer[d++]|this.buffer[d++]<<8|this.buffer[d++]<<16|this.buffer[d]<<24)>>>0}},{key:"getByte",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[d]}},{key:"getChar",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[d]<<24>>24}},{key:"iterator",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new o.ChunkIterator(this,d)}},{key:"iterate",value:function(d){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,m=new o.ChunkIterator(this,h);return m.iterate(d),m.target}},{key:"getBuffer",value:function(d,h){return this.buffer.subarray(d,d+h)}}])&&l(p.prototype,f),c}()},"./src/soundFont2.ts":function(t,n,i){i.r(n),i.d(n,"SoundFont2",function(){return h});var o=i("./src/types/index.ts"),a=i("./src/chunk.ts"),l=i("./src/riff/index.ts"),u=i("./src/chunks/index.ts"),s=i("./src/utils/index.ts");function c(m){for(var g=1;g<arguments.length;g++){var y=arguments[g]!=null?arguments[g]:{},b=Object.keys(y);typeof Object.getOwnPropertySymbols=="function"&&(b=b.concat(Object.getOwnPropertySymbols(y).filter(function(w){return Object.getOwnPropertyDescriptor(y,w).enumerable}))),b.forEach(function(w){d(m,w,y[w])})}return m}function p(m,g){for(var y=0;y<g.length;y++){var b=g[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(m,b.key,b)}}function f(m,g,y){return g&&p(m.prototype,g),y&&p(m,y),m}function d(m,g,y){return g in m?Object.defineProperty(m,g,{value:y,enumerable:!0,configurable:!0,writable:!0}):m[g]=y,m}var h=function(){function m(g){if(function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,m),d(this,"chunk",void 0),d(this,"metaData",void 0),d(this,"sampleData",void 0),d(this,"samples",void 0),d(this,"presetData",void 0),d(this,"instruments",void 0),d(this,"presets",void 0),d(this,"banks",void 0),!(g instanceof a.SF2Chunk)){var y=Object(l.parseBuffer)(g);g=new a.SF2Chunk(y)}if(g.subChunks.length!==3)throw new l.ParseError("Invalid sfbk structure","3 chunks","".concat(g.subChunks.length," chunks"));this.chunk=g,this.metaData=g.subChunks[0].getMetaData(),this.sampleData=g.subChunks[1].getSampleData(),this.presetData=g.subChunks[2].getPresetData(),this.samples=this.getSamples(),this.instruments=this.getInstruments(),this.presets=this.getPresets(),this.banks=this.getBanks()}return f(m,null,[{key:"from",value:function(g){return new m(g)}}]),f(m,[{key:"getKeyData",value:function(g){var y=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Object(s.memoize)(function(v,k,_){var S=y.banks[k];if(S){var P=S.presets[_];if(P){var T=P.zones.filter(function(he){return y.isKeyInRange(he,v)});if(T.length>0){var $=!0,x=!1,I=void 0;try{for(var F,N=T[Symbol.iterator]();!($=(F=N.next()).done);$=!0){var R=F.value,O=R.instrument,L=O.zones.filter(function(he){return y.isKeyInRange(he,v)});if(L.length>0){var B=!0,U=!1,H=void 0;try{for(var ne,ce=L[Symbol.iterator]();!(B=(ne=ce.next()).done);B=!0){var fe=ne.value,z=fe.sample,oe=c({},R.generators,fe.generators),ye=c({},R.modulators,fe.modulators);return{keyNumber:v,preset:P,instrument:O,sample:z,generators:oe,modulators:ye}}}catch(he){U=!0,H=he}finally{try{B||ce.return==null||ce.return()}finally{if(U)throw H}}}}}catch(he){x=!0,I=he}finally{try{$||N.return==null||N.return()}finally{if(x)throw I}}}}}return null})(g,b,w)}},{key:"isKeyInRange",value:function(g,y){return g.keyRange===void 0||g.keyRange.lo<=y&&g.keyRange.hi>=y}},{key:"getBanks",value:function(){return this.presets.reduce(function(g,y){var b=y.header.bank;return g[b]||(g[b]={presets:[]}),g[b].presets[y.header.preset]=y,g},[])}},{key:"getPresets",value:function(){var g=this.presetData,y=g.presetHeaders,b=g.presetZones,w=g.presetGenerators,v=g.presetModulators;return Object(u.getItemsInZone)(y,b,v,w,this.instruments,o.GeneratorType.Instrument).filter(function(k){return k.header.name!=="EOP"}).map(function(k){return{header:k.header,globalZone:k.globalZone,zones:k.zones.map(function(_){return{keyRange:_.keyRange,generators:_.generators,modulators:_.modulators,instrument:_.reference}})}})}},{key:"getInstruments",value:function(){var g=this.presetData,y=g.instrumentHeaders,b=g.instrumentZones,w=g.instrumentModulators,v=g.instrumentGenerators;return Object(u.getItemsInZone)(y,b,w,v,this.samples,o.GeneratorType.SampleId).filter(function(k){return k.header.name!=="EOI"}).map(function(k){return{header:k.header,globalZone:k.globalZone,zones:k.zones.map(function(_){return{keyRange:_.keyRange,generators:_.generators,modulators:_.modulators,sample:_.reference}})}})}},{key:"getSamples",value:function(){var g=this;return this.presetData.sampleHeaders.filter(function(y){return y.name!=="EOS"}).map(function(y){if(y.name!=="EOS"&&y.sampleRate<=0)throw new Error("Illegal sample rate of ".concat(y.sampleRate," hz in sample '").concat(y.name,"'"));return y.originalPitch>=128&&y.originalPitch<=254&&(y.originalPitch=60),y.startLoop-=y.start,y.endLoop-=y.start,{header:y,data:new Int16Array(new Uint8Array(g.sampleData.subarray(2*y.start,2*y.end)).buffer)}})}}]),m}()},"./src/types/bank.ts":function(t,n){},"./src/types/generator.ts":function(t,n,i){var o,a;function l(s,c,p){return c in s?Object.defineProperty(s,c,{value:p,enumerable:!0,configurable:!0,writable:!0}):s[c]=p,s}i.r(n),i.d(n,"GeneratorType",function(){return a}),i.d(n,"DEFAULT_GENERATOR_VALUES",function(){return u}),function(s){s[s.StartAddrsOffset=0]="StartAddrsOffset",s[s.EndAddrsOffset=1]="EndAddrsOffset",s[s.StartLoopAddrsOffset=2]="StartLoopAddrsOffset",s[s.EndLoopAddrsOffset=3]="EndLoopAddrsOffset",s[s.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",s[s.ModLFOToPitch=5]="ModLFOToPitch",s[s.VibLFOToPitch=6]="VibLFOToPitch",s[s.ModEnvToPitch=7]="ModEnvToPitch",s[s.InitialFilterFc=8]="InitialFilterFc",s[s.InitialFilterQ=9]="InitialFilterQ",s[s.ModLFOToFilterFc=10]="ModLFOToFilterFc",s[s.ModEnvToFilterFc=11]="ModEnvToFilterFc",s[s.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",s[s.ModLFOToVolume=13]="ModLFOToVolume",s[s.Unused1=14]="Unused1",s[s.ChorusEffectsSend=15]="ChorusEffectsSend",s[s.ReverbEffectsSend=16]="ReverbEffectsSend",s[s.Pan=17]="Pan",s[s.Unused2=18]="Unused2",s[s.Unused3=19]="Unused3",s[s.Unused4=20]="Unused4",s[s.DelayModLFO=21]="DelayModLFO",s[s.FreqModLFO=22]="FreqModLFO",s[s.DelayVibLFO=23]="DelayVibLFO",s[s.FreqVibLFO=24]="FreqVibLFO",s[s.DelayModEnv=25]="DelayModEnv",s[s.AttackModEnv=26]="AttackModEnv",s[s.HoldModEnv=27]="HoldModEnv",s[s.DecayModEnv=28]="DecayModEnv",s[s.SustainModEnv=29]="SustainModEnv",s[s.ReleaseModEnv=30]="ReleaseModEnv",s[s.KeyNumToModEnvHold=31]="KeyNumToModEnvHold",s[s.KeyNumToModEnvDecay=32]="KeyNumToModEnvDecay",s[s.DelayVolEnv=33]="DelayVolEnv",s[s.AttackVolEnv=34]="AttackVolEnv",s[s.HoldVolEnv=35]="HoldVolEnv",s[s.DecayVolEnv=36]="DecayVolEnv",s[s.SustainVolEnv=37]="SustainVolEnv",s[s.ReleaseVolEnv=38]="ReleaseVolEnv",s[s.KeyNumToVolEnvHold=39]="KeyNumToVolEnvHold",s[s.KeyNumToVolEnvDecay=40]="KeyNumToVolEnvDecay",s[s.Instrument=41]="Instrument",s[s.Reserved1=42]="Reserved1",s[s.KeyRange=43]="KeyRange",s[s.VelRange=44]="VelRange",s[s.StartLoopAddrsCoarseOffset=45]="StartLoopAddrsCoarseOffset",s[s.KeyNum=46]="KeyNum",s[s.Velocity=47]="Velocity",s[s.InitialAttenuation=48]="InitialAttenuation",s[s.Reserved2=49]="Reserved2",s[s.EndLoopAddrsCoarseOffset=50]="EndLoopAddrsCoarseOffset",s[s.CoarseTune=51]="CoarseTune",s[s.FineTune=52]="FineTune",s[s.SampleId=53]="SampleId",s[s.SampleModes=54]="SampleModes",s[s.Reserved3=55]="Reserved3",s[s.ScaleTuning=56]="ScaleTuning",s[s.ExclusiveClass=57]="ExclusiveClass",s[s.OverridingRootKey=58]="OverridingRootKey",s[s.Unused5=59]="Unused5",s[s.EndOper=60]="EndOper"}(a||(a={}));var u=(l(o={},a.StartAddrsOffset,0),l(o,a.EndAddrsOffset,0),l(o,a.StartLoopAddrsOffset,0),l(o,a.EndLoopAddrsOffset,0),l(o,a.StartAddrsCoarseOffset,0),l(o,a.ModLFOToPitch,0),l(o,a.VibLFOToPitch,0),l(o,a.ModEnvToPitch,0),l(o,a.InitialFilterFc,13500),l(o,a.InitialFilterQ,0),l(o,a.ModLFOToFilterFc,0),l(o,a.ModEnvToFilterFc,0),l(o,a.EndAddrsCoarseOffset,0),l(o,a.ModLFOToVolume,0),l(o,a.ChorusEffectsSend,0),l(o,a.ReverbEffectsSend,0),l(o,a.Pan,0),l(o,a.DelayModLFO,-12e3),l(o,a.FreqModLFO,0),l(o,a.DelayVibLFO,-12e3),l(o,a.FreqVibLFO,0),l(o,a.DelayModEnv,-12e3),l(o,a.AttackModEnv,-12e3),l(o,a.HoldModEnv,-12e3),l(o,a.DecayModEnv,-12e3),l(o,a.SustainModEnv,0),l(o,a.ReleaseModEnv,-12e3),l(o,a.KeyNumToModEnvHold,0),l(o,a.KeyNumToModEnvDecay,0),l(o,a.DelayVolEnv,-12e3),l(o,a.AttackVolEnv,-12e3),l(o,a.HoldVolEnv,-12e3),l(o,a.DecayVolEnv,-12e3),l(o,a.SustainVolEnv,0),l(o,a.ReleaseVolEnv,-12e3),l(o,a.KeyNumToVolEnvHold,0),l(o,a.KeyNumToVolEnvDecay,0),l(o,a.StartLoopAddrsCoarseOffset,0),l(o,a.KeyNum,-1),l(o,a.Velocity,-1),l(o,a.InitialAttenuation,0),l(o,a.EndLoopAddrsCoarseOffset,0),l(o,a.CoarseTune,0),l(o,a.FineTune,0),l(o,a.SampleModes,0),l(o,a.ScaleTuning,100),l(o,a.ExclusiveClass,0),l(o,a.OverridingRootKey,-1),o)},"./src/types/index.ts":function(t,n,i){i.r(n);var o=i("./src/types/bank.ts");for(var a in o)["default"].indexOf(a)<0&&function(g){i.d(n,g,function(){return o[g]})}(a);var l=i("./src/types/generator.ts");i.d(n,"GeneratorType",function(){return l.GeneratorType}),i.d(n,"DEFAULT_GENERATOR_VALUES",function(){return l.DEFAULT_GENERATOR_VALUES});var u=i("./src/types/instrument.ts");for(var a in u)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(y){i.d(n,y,function(){return u[y]})}(a);var s=i("./src/types/key.ts");for(var a in s)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(y){i.d(n,y,function(){return s[y]})}(a);var c=i("./src/types/metaData.ts");for(var a in c)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(y){i.d(n,y,function(){return c[y]})}(a);var p=i("./src/types/modulator.ts");i.d(n,"ControllerType",function(){return p.ControllerType}),i.d(n,"ControllerPolarity",function(){return p.ControllerPolarity}),i.d(n,"ControllerDirection",function(){return p.ControllerDirection}),i.d(n,"ControllerPalette",function(){return p.ControllerPalette}),i.d(n,"Controller",function(){return p.Controller}),i.d(n,"TransformType",function(){return p.TransformType}),i.d(n,"DEFAULT_INSTRUMENT_MODULATORS",function(){return p.DEFAULT_INSTRUMENT_MODULATORS});var f=i("./src/types/preset.ts");for(var a in f)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(a)<0&&function(y){i.d(n,y,function(){return f[y]})}(a);var d=i("./src/types/presetData.ts");for(var a in d)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(a)<0&&function(y){i.d(n,y,function(){return d[y]})}(a);var h=i("./src/types/sample.ts");i.d(n,"SampleType",function(){return h.SampleType});var m=i("./src/types/zone.ts");for(var a in m)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","SampleType"].indexOf(a)<0&&function(y){i.d(n,y,function(){return m[y]})}(a)},"./src/types/instrument.ts":function(t,n){},"./src/types/key.ts":function(t,n){},"./src/types/metaData.ts":function(t,n){},"./src/types/modulator.ts":function(t,n,i){i.r(n),i.d(n,"ControllerType",function(){return o}),i.d(n,"ControllerPolarity",function(){return a}),i.d(n,"ControllerDirection",function(){return l}),i.d(n,"ControllerPalette",function(){return u}),i.d(n,"Controller",function(){return s}),i.d(n,"TransformType",function(){return c}),i.d(n,"DEFAULT_INSTRUMENT_MODULATORS",function(){return f});var o,a,l,u,s,c,p=i("./src/types/generator.ts");(function(d){d[d.Linear=0]="Linear",d[d.Concave=1]="Concave",d[d.Convex=2]="Convex",d[d.Switch=3]="Switch"})(o||(o={})),function(d){d[d.Unipolar=0]="Unipolar",d[d.Bipolar=1]="Bipolar"}(a||(a={})),function(d){d[d.Increasing=0]="Increasing",d[d.Decreasing=1]="Decreasing"}(l||(l={})),function(d){d[d.GeneralController=0]="GeneralController",d[d.MidiController=1]="MidiController"}(u||(u={})),function(d){d[d.NoController=0]="NoController",d[d.NoteOnVelocity=2]="NoteOnVelocity",d[d.NoteOnKeyNumber=3]="NoteOnKeyNumber",d[d.PolyPressure=10]="PolyPressure",d[d.ChannelPressure=13]="ChannelPressure",d[d.PitchWheel=14]="PitchWheel",d[d.PitchWheelSensitivity=16]="PitchWheelSensitivity",d[d.Link=127]="Link"}(s||(s={})),function(d){d[d.Linear=0]="Linear",d[d.Absolute=2]="Absolute"}(c||(c={}));var f=[{id:p.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:l.Decreasing,palette:u.GeneralController,index:s.NoteOnVelocity},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:p.GeneratorType.InitialFilterFc,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Decreasing,palette:u.GeneralController,index:s.NoteOnVelocity},value:-2400,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:p.GeneratorType.VibLFOToPitch,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.ChannelPressure},value:50,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:p.GeneratorType.VibLFOToPitch,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.MidiController,index:1},value:50,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:p.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:l.Decreasing,palette:u.MidiController,index:7},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:p.GeneratorType.InitialAttenuation,source:{type:o.Linear,polarity:a.Bipolar,direction:l.Increasing,palette:u.MidiController,index:10},value:1e3,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:p.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:l.Decreasing,palette:u.MidiController,index:11},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:p.GeneratorType.ReverbEffectsSend,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.MidiController,index:91},value:200,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:p.GeneratorType.ChorusEffectsSend,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.MidiController,index:93},value:200,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:p.GeneratorType.CoarseTune,source:{type:o.Linear,polarity:a.Bipolar,direction:l.Increasing,palette:u.GeneralController,index:s.PitchWheel},value:12700,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.PitchWheelSensitivity},transform:c.Linear}]},"./src/types/preset.ts":function(t,n){},"./src/types/presetData.ts":function(t,n){},"./src/types/sample.ts":function(t,n,i){var o;i.r(n),i.d(n,"SampleType",function(){return o}),function(a){a[a.EOS=0]="EOS",a[a.Mono=1]="Mono",a[a.Right=2]="Right",a[a.Left=4]="Left",a[a.Linked=8]="Linked",a[a.RomMono=32769]="RomMono",a[a.RomRight=32770]="RomRight",a[a.RomLeft=32772]="RomLeft",a[a.RomLinked=32776]="RomLinked"}(o||(o={}))},"./src/types/zone.ts":function(t,n){},"./src/utils/buffer.ts":function(t,n,i){i.r(n),i.d(n,"getStringFromBuffer",function(){return o});var o=function(a){var l=new TextDecoder("utf8").decode(a),u=l.indexOf("\0");return(u===-1?l:l.slice(0,u)).trim()}},"./src/utils/index.ts":function(t,n,i){i.r(n);var o=i("./src/utils/buffer.ts");i.d(n,"getStringFromBuffer",function(){return o.getStringFromBuffer});var a=i("./src/utils/memoize.ts");i.d(n,"memoize",function(){return a.memoize})},"./src/utils/memoize.ts":function(t,n,i){i.r(n),i.d(n,"memoize",function(){return o});var o=function(a){var l={};return function(){for(var u=arguments.length,s=new Array(u),c=0;c<u;c++)s[c]=arguments[c];var p=JSON.stringify(s);if(p in l)return l[p];var f=a.apply(void 0,s);return l[p]=f,f}}}})})}(Wn)),Wn.exports}var Al=oh(),ah=Z("<img width=120px height=120px src=./cat-node.jpg>");class sh{componentType=Ki;ext;constructor(){this.ext={initAudioCtx:async(r,t)=>{const i=await fetch("./Thurston Waffles.sf2").then(m=>m.arrayBuffer()),o=new Al.SoundFont2(new Uint8Array(i)),a=o.presets[0];if(!a)throw new Error("Preset at index 0 not found.");const l=o.instruments[a.header.bagIndex];if(!l)throw new Error("No instrument found for preset at index 0");const u=(m,g)=>{for(const y of m.zones)if(y.keyRange!=null&&g>=y.keyRange.lo&&g<=y.keyRange.hi)return y.sample;return null};let s=60;const c=u(l,s);if(!c)throw new Error(`No sample found for note ${s} in preset 0.`);const p=c.header.sampleRate,f=c.data.length,d=new Float32Array(f);for(let m=0;m<f;m++)d[m]=c.data[m]/32768;const h=c.header.originalPitch;t.port.postMessage({type:"meowData",params:{meowOriginalPitch:h,meowSampleRate:p,meowData:d}})},generateInitOnceCode:({ctx:r})=>{r.insertGlobalCode(["let meowOriginalPitch = undefined;","let meowSampleRate = undefined;","let meowData = undefined;","let meowStepPerHz = undefined;"]),r.insertMessageHandlerCode("meowData",["meowOriginalPitch = params.meowOriginalPitch;","meowSampleRate = params.meowSampleRate;","meowData = params.meowData;",`meowStepPerHz = meowSampleRate / (sampleRate * ${261.625565});`])}}}create(r){return new lh(r)}}const Ml=new sh;class lh{type=Ml;nodeParams;inputPins;outputPins;ui;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"frequency",source:()=>t.frequency,setSource:i=>n("frequency",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ui=C(()=>()=>ah()),this.ext={generateCode:({ctx:i,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let l=i.allocField("0.0"),u=i.allocField("0.0"),s=new Map,c=i.allocField("0.0"),p=i.allocField("0");return i.insertCode([`if (meowData == undefined || ${a} != ${l}) {`,`  ${u} = 0.0;`,`  ${c} = 0.0;`,`  ${l} = ${a};`,"} else {",`  if (${c} >= meowData.length) {`,`    ${u} = 0.0;`,"  } else {",`    ${p} = Math.floor(${c});`,`    let value = meowData[${p}];`,`    ${u} = value;`,`    let step = ${a} * meowStepPerHz;`,`    ${c} += step;`,"  }","}"]),s.set("out",u),[{outputAtoms:s}]}}}}const ch=W({a:D(E),b:D(E),out:ee(E)}),Nl=new X({typeName:"Mult",typeSchema:ch});class uh{componentType=Nl;ext={};create(r){return new dh(r)}}const Ol=new uh;class dh{type=Ol;nodeParams;inputPins;outputPins;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"a",source:()=>t.a,setSource:i=>n("a",i)},{name:"b",source:()=>t.b,setSource:i=>n("b",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext={generateCode:({ctx:i,inputAtoms:o})=>{let a=o.get("a");if(a==null)return[];let l=o.get("b");if(l==null)return[];let u=i.allocField("0.0");i.insertCode([`${u} = ${a} * ${l}`]);let s=new Map;return s.set("out",u),[{outputAtoms:s}]}}}}const ph=W({out:ee(E)}),Fl=new X({typeName:"NoiseWave",typeSchema:ph});class fh{componentType=Fl;ext={};create(r){return new hh(r)}}const zl=new fh;class hh{type=zl;nodeParams;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}])}}const mh=W({entity:mt(),note:mt(),out:ee(E)}),Dl=new X({typeName:"Note",typeSchema:mh});class gh{componentType=Dl;ext={};create(r){return new yh(r)}}const eo=new gh;class yh{type=eo;nodeParams;outputPins;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:a=>n("out",a)}]);const i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=261.63;this.ext={generateCode:({ctx:a,inputAtoms:l})=>{let u=i.indexOf(t.note);if(u==-1)return[];let s=o*Math.pow(2,u/12),c=a.allocField("0.0"),p=new Map;return p.set("out",c),a.insertCode([`if (noteDown["${t.entity}/${t.note}"]) {`,`  ${c} = ${s};`,"} else {",`  ${c} = 0.0;`,"}"]),[{outputAtoms:p}]}}}}var bh=Z("<input class=input type=text size=8>");let vh=class{componentType=$r;ext={};create(r){return new wh(r)}};const Ll=new vh;let wh=class{type=Ll;nodeParams;outputPins;ui;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ui=C(()=>()=>{let[i,o]=Me({valueText:me(()=>t.value.toFixed(3))});return ge(se(()=>i.valueText,()=>{let a=Number.parseFloat(i.valueText);Number.isNaN(a)||n("value",a)},{defer:!0})),(()=>{var a=bh();return a.$$input=l=>{o("valueText",l.currentTarget.value)},Q(()=>a.value=i.valueText),a})()}),this.ext={generateCode:({ctx:i})=>{let o=new Map;return o.set("out",`${t.value}`),[{outputAtoms:o}]}}}};$e(["input"]);const kh=W({out:ee(E)}),Ul=new X({typeName:"PianoKeys",typeSchema:kh});var xh=Z("<div class=piano>"),_h=Z("<div class=white-key>"),Sh=Z("<div class=black-key>");const Ch=e=>{const r=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}],t=150,n=80;let i,o=new Gt,a=new ut;return(()=>{var l=xh();l.$$pointermove=s=>{if(!o.get(s.pointerId))return;let c=i.getBoundingClientRect();o.set(s.pointerId,G.create(s.clientX-c.left,s.clientY-c.top))},l.addEventListener("pointercancel",s=>{o.delete(s.pointerId),i.releasePointerCapture(s.pointerId)}),l.$$pointerup=s=>{o.delete(s.pointerId),i.releasePointerCapture(s.pointerId)},l.$$pointerdown=s=>{let c=i.getBoundingClientRect();o.set(s.pointerId,G.create(s.clientX-c.left,s.clientY-c.top)),i.setPointerCapture(s.pointerId)};var u=i;return typeof u=="function"?ve(u,l):i=l,l.style.setProperty("display","flex"),l.style.setProperty("flex-direction","row"),l.style.setProperty("overflow-x","auto"),l.style.setProperty("user-select","none"),l.style.setProperty("touch-action","none"),Y(l,M(st,{each:r,children:s=>{let[c,p]=K();s.type=="black"&&ge(()=>{let d=c();d!=null&&(a.add(d),Te(()=>a.delete(d)))});let f=C(()=>{let d=c();if(d==null)return!1;let h=i.getBoundingClientRect(),m=d.getBoundingClientRect();for(let g of o.values()){let y=h.left+g.x-m.left,b=h.top+g.y-m.top;if(0<y&&y<m.width&&0<b&&b<m.height){if(s.type=="white")for(let w of a){let v=w.getBoundingClientRect(),k=h.left+g.x-v.left,_=h.top+g.y-v.top;if(0<k&&k<v.width&&0<_&&_<v.height)return!1}return!0}}return!1});return ge(se(f,d=>{d?e.onNoteOn(s.name):e.onNoteOff(s.name)},{defer:!0})),M(Oi,{get children(){return[M(Ht,{get when(){return s.type=="white"},get children(){var d=_h(),h=p;return typeof h=="function"?ve(h,d):p=d,d.style.setProperty("width","50px"),d.style.setProperty("pointer-events","none"),Q(m=>{var g=!!f(),y=`${t+(f()?2:0)}px`;return g!==m.e&&d.classList.toggle("pressed",m.e=g),y!==m.t&&((m.t=y)!=null?d.style.setProperty("height",y):d.style.removeProperty("height")),m},{e:void 0,t:void 0}),d}}),M(Ht,{get when(){return s.type=="black"},get children(){var d=Sh(),h=p;return typeof h=="function"?ve(h,d):p=d,d.style.setProperty("margin-left","-16px"),d.style.setProperty("margin-right","-14px"),d.style.setProperty("width","30px"),d.style.setProperty("pointer-events","none"),Q(m=>{var g=!!f(),y=`${n+(f()?2:0)}px`;return g!==m.e&&d.classList.toggle("pressed",m.e=g),y!==m.t&&((m.t=y)!=null?d.style.setProperty("height",y):d.style.removeProperty("height")),m},{e:void 0,t:void 0}),d}})]}})}})),l})()};$e(["pointerdown","pointerup","pointermove"]);class Ph{componentType=Ul;ext;constructor(){this.ext={generateInitOnceCode:({ctx:r})=>{r.insertGlobalCode(["let noteDown = {};"]),r.insertMessageHandlerCode("NoteOn",["noteDown[params.id] = true;"]),r.insertMessageHandlerCode("NoteOff",["noteDown[params.id] = false;"])}}}create(r){return new Th(r)}}const jl=new Ph;class Th{type=jl;nodeParams;outputPins;ui;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:l=>n("out",l)}]);let[i,o]=K();this.ui=C(()=>()=>M(Ch,{onNoteOn:l=>{let u=i();u?.port.postMessage({type:"NoteOn",params:{id:`${r.entity}/${l}`}})},onNoteOff:l=>{let u=i();u?.port.postMessage({type:"NoteOff",params:{id:`${r.entity}/${l}`}})}}));const a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];this.ext={macro:(l,u)=>{let s=[],c=[...l.outputs.out];for(let f of c){s.push(f);for(let d=0;d<a.length-1;++d){let h=wf(f.node,u);s.push({node:h,pin:f.pin})}}let p=0;for(let{node:f,pin:d}of s){let[h,m]=Me({entity:r.entity,note:a[p],out:[]}),y={node:eo.create({entity:Ut(),state:h,setState:m}),space:()=>_e.identity,setSpace:()=>{},setRenderSizeAccessor:()=>{},setInputPinPositionMapAccessor:()=>{},setOutputPinPositionMapAccessor:()=>{},renderSize:()=>{},inputPinPositionMap:()=>{},outputPinPositionMap:()=>{}},b={id:0,inputs:{},outputs:{out:[{node:f,pin:d}]},height:0,node:y};u(b),f.inputs[d]={node:b,pin:"out"},++p,p>=a.length&&(p=0)}l.outputs.out=[]},generateCode:({ctx:l})=>{{let u=[];for(let s of a)u.push(`noteDown["${r.entity}/${s}"] = false;`);l.insertGlobalCode(u)}return[{outputAtoms:new Map}]},init:async l=>{o(l)}}}}const $h=W({timeToZero:D(E),out:ee(E)}),Bl=new X({typeName:"Release",typeSchema:$h});class Eh{componentType=Bl;ext={};create(r){return new Ih(r)}}const ql=new Eh;class Ih{type=ql;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"timeToZero",source:()=>t.timeToZero,setSource:i=>n("timeToZero",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}])}}const Rh=W({frequency:D(E),amplitude:D(E),centre:D(E),out:ee(E)}),Vl=new X({typeName:"SawWave",typeSchema:Rh});class Ah{componentType=Vl;ext={};create(r){return new Mh(r)}}const Gl=new Ah;class Mh{type=Gl;nodeParams;inputPins;outputPins;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"frequency",source:()=>t.frequency,setSource:i=>n("frequency",i)},{name:"amplitude",source:()=>t.amplitude,setSource:i=>n("amplitude",i)},{name:"centre",source:()=>t.centre,setSource:i=>n("centre",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext={generateCode:({ctx:i,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let l=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",s=new Map,c=i.allocField("0.0"),p=i.allocField("0.0");return i.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${p} = ${l} * ((${c} / Math.PI) - 1.0) + ${u};`,`${c} %= 2 * Math.PI;`]),s.set("out",p),[{outputAtoms:s}]}}}}var Nh=Z("<label><span style=color:black;padding-right:5px;>Id:</span><input class=input type=text size=8>");class Oh{componentType=Yi;ext={};create(r){return new Fh(r)}}const Hl=new Oh;class Fh{type=Hl;nodeParams;inputPins;outputPins;ui;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"prev",source:()=>t.prev,setSource:i=>n("prev",i),isEffectPin:!0},{name:"value",source:()=>t.value,setSource:i=>n("value",i)}]),this.outputPins=C(()=>[{name:"next",sinks:()=>t.next,setSinks:i=>n("next",i),isEffectPin:!0}]),this.ui=C(()=>()=>(()=>{var i=Nh(),o=i.firstChild,a=o.nextSibling;return a.$$input=l=>{n("id",l.currentTarget.value)},Q(()=>a.value=t.id),i})()),this.ext={generateCode:({ctx:i,inputAtoms:o,codeGenNodeId:a})=>{let l=o.get("prev");if(l==null)return[];let u=o.get("value");if(u==null)return[];let s=`this.n_${a}_next`;i.addDeclToExistingForField(s,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),i.insertConstructorCode([`${l}.onDone.push(() => {`,`  this.insertRunningEffect(${s});`,"});",`${s}.update = () => {`,`  this.variables["${t.id}"] = ${u};`,"  return true;","};"]);let c=`${s}`,p=new Map;return p.set("next",c),[{outputAtoms:p}]}}}}$e(["input"]);class zh{componentType=Hi;ext={};create(r){return new Dh(r)}}const Zl=new zh;class Dh{type=Zl;nodeParams;inputPins;outputPins;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"frequency",source:()=>t.frequency,setSource:i=>n("frequency",i)},{name:"amplitude",source:()=>t.amplitude,setSource:i=>n("amplitude",i)},{name:"centre",source:()=>t.centre,setSource:i=>n("centre",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext={generateCode:({ctx:i,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let l=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",s=new Map,c=i.allocField("0.0"),p=i.allocField("0.0");return i.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${p} = ${l} * Math.sin(${c}) + ${u};`,`${c} %= 2 * Math.PI;`]),s.set("out",p),[{outputAtoms:s}]}}}}var Lh=Z('<i class="fa-solid fa-volume-high">');class Uh{componentType=Ji;ext={};create(r){return new jh(r)}}const Wl=new Uh;class jh{type=Wl;nodeParams;inputPins;ui;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"in",source:()=>t.in,setSource:i=>n("in",i)}]),this.ui=C(()=>()=>(()=>{var i=Lh();return i.style.setProperty("font-size","24px"),i.style.setProperty("color","green"),i})()),this.ext={generateCode:({ctx:i,inputAtoms:o})=>{let a=o.get("in");return a==null?[]:(i.insertCode([`result += ${a}`]),[{outputAtoms:new Map}])}}}}const Bh=W({frequency:D(E),amplitude:D(E),centre:D(E),out:ee(E)}),Yl=new X({typeName:"SquareWave",typeSchema:Bh});class qh{componentType=Yl;ext={};create(r){return new Vh(r)}}const Xl=new qh;class Vh{type=Xl;nodeParams;inputPins;outputPins;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"frequency",source:()=>t.frequency,setSource:i=>n("frequency",i)},{name:"amplitude",source:()=>t.amplitude,setSource:i=>n("amplitude",i)},{name:"centre",source:()=>t.centre,setSource:i=>n("centre",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext={generateCode:({ctx:i,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let l=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",s=new Map,c=i.allocField("0.0"),p=i.allocField("0.0");return i.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${p} = ${l} * (${c} < Math.PI ? -1 : 1) + ${u};`,`${c} %= 2 * Math.PI;`]),s.set("out",p),[{outputAtoms:s}]}}}}class Gh{componentType=Wi;ext={};create(r){return new Hh(r)}}const Kl=new Gh;class Hh{type=Kl;nodeParams;outputPins;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.outputPins=C(()=>[{name:"next",sinks:()=>t.next,setSinks:i=>n("next",i),isEffectPin:!0}]),this.ext={generateCode:({ctx:i,inputAtoms:o,codeGenNodeId:a})=>{let l=`this.n_${a}_next`;i.addDeclToExistingForField(l,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),i.insertConstructorCode([`${l}.update = () => true;`,`this.insertRunningEffect(${l});`]);let u=`${l}`,s=new Map;return s.set("next",u),[{outputAtoms:s}]}}}}var Zh=Z("<label><span style=color:black;padding-right:5px;>Id:</span><input class=input type=text size=8>");class Wh{componentType=Xi;ext={};create(r){return new Yh(r)}}const Jl=new Wh;class Yh{type=Jl;nodeParams;outputPins;ui;ext;constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.outputPins=C(()=>[{name:"value",sinks:()=>t.value,setSinks:i=>n("value",i)}]),this.ui=C(()=>()=>(()=>{var i=Zh(),o=i.firstChild,a=o.nextSibling;return a.$$input=l=>{n("id",l.currentTarget.value)},Q(()=>a.value=t.id),i})()),this.ext={generateCode:({ctx:i,inputAtoms:o})=>{i.insertConstructorCode([`this.variables["${t.id}"] = 0.0;`]);let a=`this.variables["${t.id}"]`,l=new Map;return l.set("value",a),[{outputAtoms:l}]}}}}$e(["input"]);const Ql=new ml;Ql.registerNodeTypes([Cl,Tl,$l,Il,Rl,Ml,Ol,zl,eo,Ll,jl,ql,Gl,Hl,Zl,Wl,Xl,Kl,Jl]);const Xh=new Gi([...dl.componentTypes,Sl,Pl,Zi,El,Qi,Ki,Nl,Fl,Dl,$r,Ul,Bl,Vl,Yi,Hi,Ji,Yl,Wi,Ie,Xi]);var Kh=Z("<div><div>"),Jh=Z('<button class="btn btn-primary">Import Midi<input type=file hidden>'),Qh=Z("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Show Code"),em=Z("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Make Sound"),tm=Z("<div><pre>");const rm=e=>{let[r,t]=Fi(e,["world"]),[n,i]=Me({showCode:!1,makeSound:!1}),[o,a]=K();setTimeout(()=>{let c=r.world;c.entities().length==0&&c.createEntity([Hi.create({frequency:void 0,amplitude:void 0,centre:void 0,out:[]}),Ie.create({transform:_e.create(G.create(50,50),xe.rot0)})])});let l=C(()=>{let c=o();if(c!=null&&(n.showCode||n.makeSound))return kf({nodesSystem:c})});ge(se([()=>n.makeSound,l],([c,p])=>{let f=o();if(f==null||!c||p==null)return;let d=URL.createObjectURL(new Blob([p],{type:"text/javascript"})),h=new AudioContext;(async()=>{await h.audioWorklet.addModule(d);let m=new AudioWorkletNode(h,"compiled-graph-audio-worklet-processor"),g=new Set;for(let y of f.nodes()){let b=y.node.type;g.has(b.componentType.typeName)||(g.add(b.componentType.typeName),await b.ext.initAudioCtx?.(h,m))}for(let y of f.nodes())await y.node.ext.init?.(m);m.connect(h.destination)})(),Te(()=>{(async()=>(await h.close(),URL.revokeObjectURL(d)))()})}));let[u,s]=K();return(()=>{var c=Kh(),p=c.firstChild;return Mi(c,t,!1,!0),p.style.setProperty("width","100%"),p.style.setProperty("height","100%"),p.style.setProperty("display","flex"),p.style.setProperty("flex-direction","column"),p.style.setProperty("position","relative"),Y(p,M(bl,{style:{"flex-grow":"1"},onInit:f=>{a(f.nodesSystem)},componentRegistry:Xh,nodeRegistry:Ql,get world(){return r.world},get toolbar(){return[(()=>{var f=Jh(),d=f.firstChild,h=d.nextSibling;f.$$click=()=>{let g=u();g?.click()},h.$$input=g=>{let y=g.currentTarget.files;if(y==null||y.length!=1)return;let b=y[0];jf(r.world,b),g.currentTarget.value=""};var m=s;return typeof m=="function"?ve(m,h):s=h,f})(),(()=>{var f=Qh(),d=f.firstChild;return d.addEventListener("change",h=>i("showCode",h.currentTarget.checked)),Q(()=>d.checked=n.showCode),f})(),(()=>{var f=em(),d=f.firstChild;return d.addEventListener("change",h=>i("makeSound",h.currentTarget.checked)),Q(()=>d.checked=n.makeSound),f})()]}}),null),Y(p,M(de,{get when(){return C(()=>!!n.showCode)()?l():void 0},children:f=>(()=>{var d=tm(),h=d.firstChild;return d.style.setProperty("position","absolute"),d.style.setProperty("right","0"),d.style.setProperty("top","0"),d.style.setProperty("bottom","0"),d.style.setProperty("overflow","auto"),d.style.setProperty("width","50%"),Q(()=>h.innerText=f()),d})()}),null),c})()};$e(["click","input"]);const nm=""+new URL("music-audio-worklet-processor-D_ZxFmGc.js",import.meta.url).href,im=`attribute vec4 aVertexPosition;

uniform mat4 uModelViewMatrix;

void main(void) {
  gl_Position = uModelViewMatrix * aVertexPosition;
}
`,om=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif

uniform float time;
uniform float uOffsetY;
uniform vec2 resolution;
uniform float uFocalLength;

float sdRoundBox(vec3 p, vec3 b, float r){
  vec3 q = abs(p) - b + r;
  return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0) - r;
}

float map(vec3 p) {
  p.x += 700.0;
  float b = 100.0*7.0/12.0;
  vec3 p3 = p;
  vec3 p2 = p;
  p.x = mod(p.x + 100.0, 200.0) - 100.0;
  float i = mod(floor((p2.x) / (2.0*b)) - 6.0,12.0);
  p2.x = mod(p2.x, b*2.0);
  bool skipB = false;
  float w = 52.0 * 200.0;
  if ( i == 0.0 || i == 2.0 ||
       i == 4.0 || i == 6.0 ||
       i == 7.0 || i == 9.0 || i == 11.0 ||
       p3.x < -0.5*w+900.0 ||
       p3.x > 0.5*w+600.0
  ) {
    skipB = true;
  }
  float d3;
  float d1 = sdRoundBox(p, vec3(100,600,100), 30.0);
  if (skipB) {
    d3 = d1;
  } else {
    d3 = min(
      d1,
      sdRoundBox(p2 + vec3(-b,-180,-150), vec3(100*7/12,420,50), 20.0)
    );
  }
  return max(d3,
    max(
      p3.x - 0.5 * w - 700.0,
      -p3.x - 0.5 * w + 700.0
    )
  );
}

bool march(vec3 ro, vec3 rd, out float t) {
  vec3 p = ro;
  t = 0.0;
  for (int i = 0; i < 20; ++i) {
    vec3 p = ro + rd*t;
    float d = map(p);
    if (abs(d) < 1.0) {
      return true;
    }
    t += d;
  }
  return false;
}

vec3 normal(vec3 p) {
  float d = 0.001;
  float mp = map(p);
  float dx = map(p + vec3(d,0,0)) - mp;
  float dy = map(p + vec3(0,d,0)) - mp;
  float dz = map(p + vec3(0,0,d)) - mp;
  return normalize(vec3(dx,dy,dz));
}

void main(void) {
  float fl = uFocalLength;
  float d = 52.0 * 200.0 * fl / resolution.x;
  float mx = max(resolution.x, resolution.y);
  vec2 uv = gl_FragCoord.xy / mx;
  vec3 w = normalize(vec3(0, -1, 3));
  vec3 ro = w * d + vec3(0.0, -600.0, 50.0);
  vec3 u = normalize(cross(vec3(0,1,0),w));
  vec3 v = cross(w,u);
  vec3 rd = normalize(
    (gl_FragCoord.x - 0.5 * resolution.x) * u +
    (gl_FragCoord.y - 0.5 * resolution.y) * v +
    -fl * w
  );
  ro -= uOffsetY * v;
  float t = 0.0;
  bool hit = march(ro, rd, t);
  if (!hit) {
    gl_FragColor = vec4(0.2, 0.2, 0.2, 1.0);
    return;
  }
  vec3 p = ro + rd*t;
  vec3 n = normal(p);
  float s = dot(n,normalize(vec3(1,1,1))) + 0.2;
  if (p.z > 101.0) {
    s *= 0.5;
  }
  gl_FragColor = vec4(s,s,s,1.0);
}
`;var am=Z('<div><div><button class="btn btn-primary">Import Midi</button><input type=file hidden><button class="btn btn-primary">Run</button></div><div><canvas>');const sm=50,mn=1e4,lm=e=>{let[r,t]=K(),[n,i]=K(),[o,a]=K();Ce(se([r,n],([m,g])=>{if(m==null||g==null)return;let y=m.getBoundingClientRect();g.width=y.width*window.devicePixelRatio,g.height=y.height*window.devicePixelRatio,g.style.setProperty("width",`${y.width}px`),g.style.setProperty("height",`${y.height}px`),a(g.getContext("webgl")??void 0)}));let l=C(se([o,n],([m,g])=>{if(m!=null&&g!=null)return pm(m,g)})),[u,s]=K(),c=!1,p=!0,f=0,d=m=>{let g=o();if(g==null)return;let y=l();if(y==null||(p&&(f=m,p=!1),!c))return;let b=m-f;y.time=b,dm(y),fm(g,y),requestAnimationFrame(d)},h=async()=>{let m=l();if(m==null)return;let[g,y]=await gm(),b=[],w=m.notesHead,v=0;for(;w!=null;){let k=v++;b.push({id:k,time:w.startTime*.001,note:w.note,type:"On"}),b.push({id:k,time:(w.startTime+w.holdTime)*.001,note:w.note,type:"Off"}),w=w.next}b.sort((k,_)=>{let S=k.time-_.time;return S!=0||(S=k.note-_.note,S!=0)?S:k.type==_.type?0:k.type=="Off"?-1:1}),y.port.postMessage({type:"musicData",params:{noteEvents:b}}),c=!0,p=!0,requestAnimationFrame(d)};return(()=>{var m=am(),g=m.firstChild,y=g.firstChild,b=y.nextSibling,w=b.nextSibling,v=g.nextSibling,k=v.firstChild;m.style.setProperty("flex-grow","1"),m.style.setProperty("display","flex"),m.style.setProperty("flex-direction","column"),m.style.setProperty("overflow","hidden"),y.$$click=()=>{u()?.click()},b.addEventListener("change",T=>{let $=l();if($==null)return;let x=T.currentTarget.files;if(x==null||x.length==0)return;let I=x[0];cm($,I),T.currentTarget.value=""});var _=s;typeof _=="function"?ve(_,b):s=b,w.$$click=()=>h();var S=t;typeof S=="function"?ve(S,v):t=v,v.style.setProperty("flex-grow","1");var P=i;return typeof P=="function"?ve(P,k):i=k,m})()};async function cm(e,r){let t=new _l.Midi(await r.arrayBuffer()),n=[];for(let i of t.tracks){let o=mm();for(let a of i.notes){let l={startTime:a.time*1e3,holdTime:a.duration*1e3,note:a.midi,colourR:o.r,colourG:o.g,colourB:o.b,colourA:1,isAlive:!1,prev:void 0,next:void 0};l.prev=l,n.push(l)}}n.sort((i,o)=>i.startTime-o.startTime);for(let i of n)um(e,i)}function um(e,r){if(e.notesHead==null)e.notesHead=e.notesTail=r;else{let t=e.notesTail;t.next=r,r.prev=t,e.notesTail=r}}function dm(e){let r=e.time-e.height/e.fallSpeed,t=e.time,n=e.visibleNotesEnd?.next??e.notesHead;for(;n!=null&&!(n.startTime>=t);)e.visibleNotesEnd==null?e.visibleNotesStart=e.visibleNotesEnd=n:e.visibleNotesEnd=n,e.numVisibleNotes++,n=n.next;for(n=e.visibleNotesStart;;){if(n==null){e.numVisibleNotes=0,e.visibleNotesStart=e.visibleNotesEnd=void 0;break}if(n.startTime+n.holdTime<=r){e.numVisibleNotes--,n=n.next,e.visibleNotesStart=n;continue}break}}function pm(e,r){const t=.5*r.height/Math.tan(.5*sm*Math.PI/180);let n={width:r.width,height:r.height,time:0,fallSpeed:.5,maxNotes:mn,numNotes:0,notesVertices:new Float32Array(mn*8*6),notesGLVertexBuffer:e.createBuffer(),notesHead:void 0,notesTail:void 0,freeNotesHead:void 0,freeNotesTail:void 0,visibleNotesStart:void 0,visibleNotesEnd:void 0,numVisibleNotes:0,program:void 0,positionLocation:-1,colourLocation:-1,textureCoordLocation:-1,pianoVertices:new Float32Array(12),pianoGLVertexBuffer:e.createBuffer(),pianoProgram:void 0,pianoPositionLocation:-1};for(let g=0,y=0;g<mn;++g)n.notesVertices[y+6]=0,n.notesVertices[y+7]=0,y+=8,n.notesVertices[y+6]=1,n.notesVertices[y+7]=0,y+=8,n.notesVertices[y+6]=1,n.notesVertices[y+7]=1,y+=8,n.notesVertices[y+6]=0,n.notesVertices[y+7]=0,y+=8,n.notesVertices[y+6]=1,n.notesVertices[y+7]=1,y+=8,n.notesVertices[y+6]=0,n.notesVertices[y+7]=1,y+=8;const a=pa(e,`
    attribute vec4 aVertexPosition;
    attribute vec4 aColour;
    attribute vec2 aTextureCoord;

    uniform mat4 uModelViewMatrix;

    varying highp vec4 vColour;
    varying highp vec2 vTextureCoord;

    void main(void) {
        gl_Position = uModelViewMatrix * aVertexPosition;
        vTextureCoord = aTextureCoord;
        vColour = aColour;
    }
  `,`
    varying highp vec4 vColour;
    varying highp vec2 vTextureCoord;

    void main(void) {
        gl_FragColor = vColour;
    }
  `);if(a==null)return;const l=pa(e,im,om);if(l==null)return;n.program=a,n.pianoProgram=l,e.useProgram(a);const u=e.getUniformLocation(a,"uModelViewMatrix");function s(g,y,b,w){var v=-1,k=1,_=y-g,S=w-b,P=k-v;return[2/_,0,0,0,0,2/S,0,0,0,0,-2/P,0,-(y+g)/_,-(w+b)/S,-(k+v)/P,1]}const c=new Float32Array(s(0,n.width,0,n.height));e.uniformMatrix4fv(u,!1,c),n.positionLocation=e.getAttribLocation(a,"aVertexPosition"),n.colourLocation=e.getAttribLocation(a,"aColour"),n.textureCoordLocation=e.getAttribLocation(a,"aTextureCoord"),e.bindBuffer(e.ARRAY_BUFFER,n.notesGLVertexBuffer),e.bufferData(e.ARRAY_BUFFER,n.notesVertices,e.DYNAMIC_DRAW),e.vertexAttribPointer(n.positionLocation,2,e.FLOAT,!1,8*4,0*4),e.vertexAttribPointer(n.colourLocation,4,e.FLOAT,!1,8*4,4*4),e.vertexAttribPointer(n.textureCoordLocation,2,e.FLOAT,!1,8*4,6*4),e.useProgram(l);const p=e.getUniformLocation(l,"uModelViewMatrix");e.uniformMatrix4fv(p,!1,c);const f=e.getUniformLocation(l,"uFocalLength");e.uniform1f(f,t);const d=e.getUniformLocation(l,"resolution"),h=e.getUniformLocation(l,"uOffsetY");let m;{let g=10400*t/n.width,y=-1,b=3,w=Math.sqrt(y*y+b*b);y/=w,b/=w;let v=b,k=-y,_=y*g-600,S=b*g+50,P=(-600-_)*-y+(-50-S)*-b,T=P*-.5*n.height/t,$=P,x=T+1200*v+400*-y,I=$+1200*k+400*-b,F=T+200*-y,N=T*t/$,R=x*t/I;m=Math.abs(R-N),e.uniform1f(h,F)}return e.uniform2f(d,n.width,n.height),n.pianoPositionLocation=e.getAttribLocation(l,"aVertexPosition"),n.pianoVertices[0]=0,n.pianoVertices[1]=0,n.pianoVertices[2]=n.width,n.pianoVertices[3]=0,n.pianoVertices[4]=n.width,n.pianoVertices[5]=m,n.pianoVertices[6]=0,n.pianoVertices[7]=0,n.pianoVertices[8]=n.width,n.pianoVertices[9]=m,n.pianoVertices[10]=0,n.pianoVertices[11]=m,e.bindBuffer(e.ARRAY_BUFFER,n.pianoGLVertexBuffer),e.bufferData(e.ARRAY_BUFFER,n.pianoVertices,e.DYNAMIC_DRAW),e.vertexAttribPointer(n.pianoPositionLocation,2,e.FLOAT,!1,0,0),e.viewport(0,0,r.width,r.height),n}function fm(e,r){if(r.program==null||r.pianoProgram==null)return;let t=0,n=r.visibleNotesStart,i=0,o=r.width/88;for(e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT);n!=r.visibleNotesEnd?.next&&n!=null;){let a=0;for(;n!=r.visibleNotesEnd?.next&&n!=null;){let l=i+(n.note-21)*o,u=r.height-(r.time-n.startTime)*r.fallSpeed,s=l+o,c=u,p=s,f=c+n.holdTime*r.fallSpeed,d=l,h=f;if(r.notesVertices[t+0]=l,r.notesVertices[t+1]=u,r.notesVertices[t+2]=n.colourR,r.notesVertices[t+3]=n.colourG,r.notesVertices[t+4]=n.colourB,r.notesVertices[t+5]=n.colourA,t+=8,r.notesVertices[t+0]=s,r.notesVertices[t+1]=c,r.notesVertices[t+2]=n.colourR,r.notesVertices[t+3]=n.colourG,r.notesVertices[t+4]=n.colourB,r.notesVertices[t+5]=n.colourA,t+=8,r.notesVertices[t+0]=p,r.notesVertices[t+1]=f,r.notesVertices[t+2]=n.colourR,r.notesVertices[t+3]=n.colourG,r.notesVertices[t+4]=n.colourB,r.notesVertices[t+5]=n.colourA,t+=8,r.notesVertices[t+0]=l,r.notesVertices[t+1]=u,r.notesVertices[t+2]=n.colourR,r.notesVertices[t+3]=n.colourG,r.notesVertices[t+4]=n.colourB,r.notesVertices[t+5]=n.colourA,t+=8,r.notesVertices[t+0]=p,r.notesVertices[t+1]=f,r.notesVertices[t+2]=n.colourR,r.notesVertices[t+3]=n.colourG,r.notesVertices[t+4]=n.colourB,r.notesVertices[t+5]=n.colourA,t+=8,r.notesVertices[t+0]=d,r.notesVertices[t+1]=h,r.notesVertices[t+2]=n.colourR,r.notesVertices[t+3]=n.colourG,r.notesVertices[t+4]=n.colourB,r.notesVertices[t+5]=n.colourA,t+=8,n=n.next,++a,a>=mn)break}a!=null&&(e.useProgram(r.program),e.bindBuffer(e.ARRAY_BUFFER,r.notesGLVertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,r.notesVertices.subarray(0,a*8*6)),e.vertexAttribPointer(r.positionLocation,2,e.FLOAT,!1,8*4,0*4),e.vertexAttribPointer(r.colourLocation,4,e.FLOAT,!1,8*4,4*4),e.vertexAttribPointer(r.textureCoordLocation,2,e.FLOAT,!1,8*4,6*4),e.enableVertexAttribArray(r.positionLocation),e.enableVertexAttribArray(r.colourLocation),e.enableVertexAttribArray(r.textureCoordLocation),e.drawArrays(e.TRIANGLES,0,a*6),e.disableVertexAttribArray(r.positionLocation),e.disableVertexAttribArray(r.colourLocation),e.disableVertexAttribArray(r.textureCoordLocation))}e.useProgram(r.pianoProgram),e.bindBuffer(e.ARRAY_BUFFER,r.pianoGLVertexBuffer),e.vertexAttribPointer(r.pianoPositionLocation,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r.pianoPositionLocation),e.drawArrays(e.TRIANGLES,0,6),e.disableVertexAttribArray(r.pianoPositionLocation)}function da(e,r,t){const n=e.createShader(r);if(n!=null){if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(n)),e.deleteShader(n);return}return n}}function pa(e,r,t){const n=da(e,e.VERTEX_SHADER,r),i=da(e,e.FRAGMENT_SHADER,t);if(n==null||i==null)return;const o=e.createProgram();if(e.attachShader(o,n),e.attachShader(o,i),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS)){console.error("Unable to initialize the shader program: "+e.getProgramInfoLog(o));return}return o}function hm(e,r,t){let n,i,o;const a=Math.floor(e*6),l=e*6-a,u=t*(1-r),s=t*(1-l*r),c=t*(1-(1-l)*r);switch(a%6){case 0:n=t,i=c,o=u;break;case 1:n=s,i=t,o=u;break;case 2:n=u,i=t,o=c;break;case 3:n=u,i=s,o=t;break;case 4:n=c,i=u,o=t;break;case 5:n=t,i=u,o=s;break;default:n=0,i=0,o=0;break}return{r:n,g:i,b:o}}function mm(){const e=Math.random(),r=Math.random()*(1-.7)+.7;return hm(e,r,1)}async function gm(){let e=new AudioContext;await e.audioWorklet.addModule(nm);let r=new AudioWorkletNode(e,"music-audio-worklet-processor");return ym(e,r),r.connect(e.destination),[e,r]}let ym=async(e,r)=>{const n=await fetch("./Thurston Waffles.sf2").then(h=>h.arrayBuffer()),i=new Al.SoundFont2(new Uint8Array(n)),o=i.presets[0];if(!o)throw new Error("Preset at index 0 not found.");const a=i.instruments[o.header.bagIndex];if(!a)throw new Error("No instrument found for preset at index 0");const l=(h,m)=>{for(const g of h.zones)if(g.keyRange!=null&&m>=g.keyRange.lo&&m<=g.keyRange.hi)return g.sample;return null};let u=60;const s=l(a,u);if(!s)throw new Error(`No sample found for note ${u} in preset 0.`);const c=s.header.sampleRate,p=s.data.length,f=new Float32Array(p);for(let h=0;h<p;h++)f[h]=s.data[h]/32768;const d=s.header.originalPitch;r.port.postMessage({type:"meowData",params:{meowOriginalPitch:d,meowSampleRate:c,meowData:f}})};$e(["click"]);var bm=Z('<div><div role=tablist class="tabs tabs-box">'),vm=Z("<a role=tab class=tab>");const wm=e=>{const r=["Piano Keys","Waterfall","Instrument Editor"];let[t,n]=Me({selectedTab:"Piano Keys"}),i=new $p;i.init();let o=new Rt;return(()=>{var a=bm(),l=a.firstChild;return a.style.setProperty("flex-grow","1"),a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("overflow","hidden"),Y(l,()=>r.map(u=>me(()=>(()=>{var s=vm();return s.$$click=()=>{n("selectedTab",u)},Y(s,u),Q(()=>s.classList.toggle("tab-active",t.selectedTab==u)),s})()))),Y(a,M(Oi,{get children(){return[M(Ht,{get when(){return t.selectedTab=="Piano Keys"},get children(){return M(Up,{onNoteOn:u=>i.noteOn(u),onNoteOff:u=>i.noteOff(u)})}}),M(Ht,{get when(){return t.selectedTab=="Waterfall"},get children(){return M(lm,{})}}),M(Ht,{get when(){return t.selectedTab=="Instrument Editor"},get children(){return M(rm,{style:{"flex-grow":"1"},world:o})}})]}}),null),a})()};$e(["click"]);const km=W({radius:D(E),out:ee(E)}),ec=new X({typeName:"Sphere",typeSchema:km});var xm=Object.defineProperty,_m=(e,r)=>{for(var t in r)xm(e,t,{get:r[t],enumerable:!0})},fa=new WeakMap;function Sm(e){if(e instanceof WebGL2RenderingContext)return e;const r=fa.get(e);if(r)return r;const t=e.getExtension("ANGLE_instanced_arrays");if(!t)return;const n={drawArraysInstanced:t.drawArraysInstancedANGLE.bind(t),drawElementsInstanced:t.drawElementsInstancedANGLE.bind(t),vertexAttribDivisor:t.vertexAttribDivisorANGLE.bind(t)};return fa.set(e,n),n}var ha=new WeakMap;function Cm(e){if(e instanceof WebGL2RenderingContext)return e;const r=ha.get(e);if(r)return r;const t=e.getExtension("OES_vertex_array_object");if(!t)return null;const n={bindVertexArray:t.bindVertexArrayOES.bind(t),createVertexArray:t.createVertexArrayOES.bind(t),deleteVertexArray:t.deleteVertexArrayOES.bind(t)};return ha.set(e,n),n}var At={};_m(At,{forEach:()=>tc,map:()=>Pm});function tc(e,r){let t=0;for(const n in e)r(e[n],n,t),t++;for(const n of Object.getOwnPropertySymbols(e))r(e[n],n,t),t++}function Pm(e,r){const t={};return tc(e,(n,i,o)=>{t[i]=r(n,i,o)}),t}function Cn(e,r){if(e==null)throw new Error(r);return e}function ma(e,r,t){const n=e.createShader(r);if(!n)throw new Error("Failed to create shader");if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){const i=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error(`Failed to compile ${r===e.VERTEX_SHADER?"vertex":"fragment"} shader: ${i}`)}return n}function Tm(e,r,t){const n=e.createProgram();if(!n)throw new Error("Failed to create WebGL program");const i=ma(e,e.VERTEX_SHADER,r),o=ma(e,e.FRAGMENT_SHADER,t);if(e.attachShader(n,i),e.attachShader(n,o),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){const a=e.getProgramInfoLog(n);throw e.deleteProgram(n),e.deleteShader(i),e.deleteShader(o),new Error(`Failed to link program: ${a}`)}return e.deleteShader(i),e.deleteShader(o),n}var $m=e=>{switch(e[0]){case"m":return"Matrix"+e.slice(3)+"fv";case"s":case"b":case"i":return(e.match(/\d/)?.[0]??"1")+"i";case"u":return(e[4]||"1")+"ui";case"v":return e[3]+"f";default:switch(e){case"float":return"1f";case"uint":return"1ui";default:return"1i"}}},rc=e=>{switch(e[0]){case"m":const[r,t]=e.match(/\d+/g).map(Number);return r*(t??r);case"v":case"i":case"b":case"u":const n=e.match(/\d/);return n?+n[0]:1;default:return 1}},Em=e=>e.includes("mat"),Im=e=>e.includes("sampler");function Rm(e){const r=new(e??Map);return Object.assign(r,{getOrInsert(t,n){let i=r.get(t);return i||(i=n(),r.set(t,i),i)}})}var Am=0,Mm="VIEW_GL_ALIAS",Nm=navigator.userAgent.toLowerCase().indexOf("firefox")>=0,Om=Rm(Nm?Map:WeakMap);function _t(e){return typeof e=="string"?e:typeof e=="symbol"?Om.getOrInsert(e,()=>`${Mm}_${Am++}`):e.toString()}function Fm(e,r,t,n){return{uniforms:t.uniforms?zm(e,r,t.uniforms):void 0,attributes:t.attributes?Dm(e,r,t.attributes,n):void 0,interleavedAttributes:t.interleavedAttributes?Lm(e,r,t.interleavedAttributes,n):void 0,buffers:t.buffers?Um(e,t.buffers):void 0}}function zm(e,r,t){return At.map(t,({kind:n,size:i},o)=>{const a=_t(o),l=e.getUniformLocation(r,a);if(Im(n))return{set(c){e.uniform1i(l,c)}};const u=`uniform${$m(n)}${i?"v":""}`,s=e[u].bind(e);return Em(n)?{set(...c){s(l,!1,c[0])}}:{set(...c){s(l,...c)}}})}function nc(e,r,t,n,i,o,a){e.enableVertexAttribArray(r),e.vertexAttribPointer(r,t,e[o],!1,n,i),a&&Cn(Sm(e)).vertexAttribDivisor(r,1)}function Dm(e,r,t,{signal:n}={}){const i=At.map(t,({kind:o,instanced:a,buffer:l=Cn(e.createBuffer())},u)=>{const s=_t(u),c=e.getAttribLocation(r,s);if(c<0)throw new Error(`Attribute '${s}' not found`);const p=rc(o),f=o.startsWith("i")?"INT":"FLOAT";return{buffer:l,bind(){e.bindBuffer(e.ARRAY_BUFFER,l),nc(e,c,p,0,0,f,a)},dispose(){e.deleteBuffer(l)},set(d,h="STATIC_DRAW"){return e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,d,e[h]),this}}});return n?.addEventListener("abort",function(){At.forEach(i,a=>a.dispose())}),i}function Lm(e,r,t,{signal:n}={}){const i=At.map(t,({layout:o,instanced:a})=>{let l=0;const u=o.map(d=>{const h=_t(d.key),m=e.getAttribLocation(r,h);if(m<0)throw new Error(`Attribute '${h}' not found`);const g=rc(d.kind),y=l,b=d.kind.startsWith("i")?"INT":"FLOAT";return l+=g*4,()=>nc(e,m,g,s,y,b,a)}),s=l,c=Cn(e.createBuffer());let p;const f=Cm(e);if(f){const d=f.createVertexArray();f.bindVertexArray(d),e.bindBuffer(e.ARRAY_BUFFER,c);for(const h of u)h();f.bindVertexArray(null),p={unbind(){f.bindVertexArray(null)},bind(){f.bindVertexArray(d)},dispose(){f.deleteVertexArray(d)}}}return{bind(){if(e.bindBuffer(e.ARRAY_BUFFER,c),p)p.bind();else for(const d of u)d()},unbind(){p&&p.unbind()},dispose(){e.deleteBuffer(c),p&&p.dispose()},set(d,h="STATIC_DRAW"){p?p.bind():e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,d,e[h]),p&&p.unbind()}}});return n?.addEventListener("abort",function(){At.forEach(i,a=>a.dispose())}),i}function Um(e,r,{signal:t}={}){const n=At.map(r,({target:i="ARRAY_BUFFER",usage:o="STATIC_DRAW"})=>{const a=Cn(e.createBuffer());return{bind(){e.bindBuffer(e[i],a)},dispose(){e.deleteBuffer(a)},set(l){e.bindBuffer(e[i],a),e.bufferData(e[i],l,e[o])}}});return t?.addEventListener("abort",function(){At.forEach(n,o=>o.dispose())}),n}function te(e,...r){return{template:e,slots:r,type:"glsl"}}var to=new Proxy({},{get(e,r){return typeof r=="symbol"?e[r]:(t,n)=>({type:"uniform",key:t,kind:r,...n})}});new Proxy({},{get(e,r){return typeof r=="symbol"?e[r]:(t,n)=>({type:"attribute",key:t,kind:r,...n})}});function it(e,r,t,n){const i=ga(r),o=ga(t),a={uniforms:{...i.schema.uniforms,...o.schema.uniforms},attributes:{...i.schema.attributes,...o.schema.attributes},interleavedAttributes:{...i.schema.interleavedAttributes,...o.schema.interleavedAttributes}};for(const u in n){const s=a[u],c=n[u];for(const p in c)s[p]={...s[p],...c[p]}}const l=Tm(e,i.template,o.template);return{program:l,schema:a,view:Fm(e,l,a),vertex:i.template,fragment:o.template}}function ga(e){return{template:it.toString(e),schema:it.toSchema(e)}}it.toSchema=function(e){const r={uniforms:{},attributes:{},interleavedAttributes:{}};function t(n){if(Array.isArray(n)){n.forEach(t);return}if(typeof n!="object")return;if(n.type==="glsl"){const{uniforms:l,attributes:u,interleavedAttributes:s}=it.toSchema(n);r.uniforms={...r.uniforms,...l},r.attributes={...r.attributes,...u},r.interleavedAttributes={...r.interleavedAttributes,...s};return}const{key:i,type:o,...a}=n;r[`${o}s`][i]=a}return e.slots.forEach(t),r};it.toString=function({template:[e,...r],slots:t}){const n=!!e?.startsWith("#version 300 es");let i=e??"";for(let o=0;o<r.length;o++)i+=`${ic(t[o],n)}${r[o]}`;return i};function ic(e,r){return typeof e!="object"?_t(e):Array.isArray(e)?e.map(t=>ic(t,r)).join(""):e.type==="glsl"?it.toString(e):e.type==="interleavedAttribute"?e.layout.reduce((t,n)=>r?`${t}in ${n.kind} ${_t(n.key)};
`:`${t}attribute ${n.kind} ${_t(n.key)};
`,""):e.type==="uniform"&&"size"in e?`${e.type} ${e.kind} ${_t(e.key)}[${e.size}];`:`${e.type==="attribute"&&r?"in":e.type} ${e.kind} ${_t(e.key)};`}class jm{componentType=ec;ext={};create(r){return new Bm(r)}}const oc=new jm;class Bm{type=oc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"radius",source:()=>t.radius,setSource:i=>n("radius",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let l=a.value,u=i.allocVar();return i.insertGlobalCode(te`
        float ${u}(vec3 p) {
          return length(p) - ${l};
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:"defaultColour"}}]])}}}const qm=W({value:Je(),out:ee(E)}),ac=new X({typeName:"Number",typeSchema:qm});var Vm=Z("<input class=input type=text size=8>");class Gm{componentType=ac;ext={};create(r){return new Hm(r)}}const sc=new Gm;class Hm{type=sc;nodeParams;outputPins;ui;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ui=C(()=>()=>{let[i,o]=Me({valueText:me(()=>t.value.toFixed(3))});return ge(se(()=>i.valueText,()=>{let a=Number.parseFloat(i.valueText);Number.isNaN(a)||n("value",a)},{defer:!0})),(()=>{var a=Vm();return a.$$input=l=>{o("valueText",l.currentTarget.value)},Q(()=>a.value=i.valueText),a})()}),this.ext.generateCode=({ctx:i,inputs:o})=>new Map([["out",{type:"Atom",value:Zm(t.value)}]])}}function Zm(e){let r=e.toString();return!r.includes(".")&&!r.includes("e")&&!r.includes("E")&&(r+=".0"),r}$e(["input"]);const Wm=W({visible:cl(!0,jp()),in:D(E)}),lc=new X({typeName:"Display",typeSchema:Wm});var Ym=Object.defineProperty,Xm=(e,r)=>{for(var t in r)Ym(e,t,{get:r[t],enumerable:!0})},cc={};Xm(cc,{forEach:()=>uc,map:()=>Km});function uc(e,r){let t=0;for(const n in e)r(e[n],n,t),t++;for(const n of Object.getOwnPropertySymbols(e))r(e[n],n,t),t++}function Km(e,r){const t={};return uc(e,(n,i,o)=>{t[i]=r(n,i,o)}),t}var Jm=e=>{switch(e[0]){case"m":return"Matrix"+e.slice(3)+"fv";case"s":case"b":case"i":return(e.match(/\d/)?.[0]??"1")+"i";case"u":return(e[4]||"1")+"ui";case"v":return e[3]+"f";default:switch(e){case"float":return"1f";case"uint":return"1ui";default:return"1i"}}},Qm=e=>e.includes("mat"),eg=e=>e.includes("sampler");function tg(e){const r=new(e??Map);return Object.assign(r,{getOrInsert(t,n){let i=r.get(t);return i||(i=n(),r.set(t,i),i)}})}var rg=0,ng="VIEW_GL_ALIAS",ig=navigator.userAgent.toLowerCase().indexOf("firefox")>=0,og=tg(ig?Map:WeakMap);function ag(e){return typeof e=="string"?e:typeof e=="symbol"?og.getOrInsert(e,()=>`${ng}_${rg++}`):e.toString()}function ro(e,r,t){return cc.map(t,({kind:n,size:i},o)=>{const a=ag(o),l=e.getUniformLocation(r,a);if(eg(n))return{set(c){e.uniform1i(l,c)}};const u=`uniform${Jm(n)}${i?"v":""}`,s=e[u].bind(e);return Qm(n)?{set(...c){s(l,!1,c[0])}}:{set(...c){s(l,...c)}}})}var sg=Z('<div class="bg-base-200 mt-2 mb-2"><label class=label><input class="checkbox checkbox-sm pl-2"type=checkbox>Visible'),lg=Z('<i class="fa-solid fa-desktop">');class cg{componentType=lc;ext={};create(r){return new ug(r)}}const dc=new cg;class ug{type=dc;nodeParams;inputPins;ui;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"in",source:()=>t.in,setSource:i=>n("in",i)}]),this.ui=C(()=>()=>[(()=>{var i=sg(),o=i.firstChild,a=o.firstChild;return a.addEventListener("change",l=>{n("visible",l.currentTarget.checked)}),Q(()=>a.checked=t.visible),i})(),(()=>{var i=lg();return i.style.setProperty("font-size","24px"),i.style.setProperty("color","green"),i})()]),this.ext.generateCode=({ctx:i,inputs:o,onInit:a})=>{let l=o.get("in");if(l?.type!="Model")return;let u=l.value,{sdfFuncName:s,colourFuncName:c}=u,p=i.allocVar(),f=te`
        ${to.bool(p)}
      `;i.insertGlobalCode(f),i.insertCode(te`
        if (${p}) {
          d = min(d, ${s}(p));
        }
      `);let d=i.allocVar();return i.insertColourCode(te`
        if (${p}) {
          float ${d} = ${s}(p);
          if (${d} < d) {
            d = ${d};
            ${c}(p, c);
          }
        }
      `),a(({gl:h,program:m,rerender:g})=>{let y=ro(h,m,it.toSchema(f).uniforms);Ce(se(()=>t.visible,b=>{y[p].set(b?1:0),g()}))}),new Map}}}const dg=W({x:D(E),y:D(E),z:D(E),out:ee(E)}),pc=new X({typeName:"Vec3",typeSchema:dg});class pg{componentType=pc;ext={};create(r){return new fg(r)}}const fc=new pg;class fg{type=fc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"x",source:()=>t.x,setSource:i=>n("x",i)},{name:"y",source:()=>t.y,setSource:i=>n("y",i)},{name:"z",source:()=>t.z,setSource:i=>n("z",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("x"),l=o.get("y"),u=o.get("z"),s,c,p;return a?.type=="Atom"?s=a.value:s="0.0",l?.type=="Atom"?c=l.value:c="0.0",u?.type=="Atom"?p=u.value:p="0.0",new Map([["out",{type:"Atom",value:`vec3(${s}, ${c}, ${p})`}]])}}}const hg=W({model:D(E),offset:D(E),out:ee(E)}),hc=new X({typeName:"Translate",typeSchema:hg});class mg{componentType=hc;ext={};create(r){return new gg(r)}}const mc=new mg;class gg{type=mc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)},{name:"offset",source:()=>t.offset,setSource:i=>n("offset",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("offset");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          return ${l.sdfFuncName}(p - ${s});
        }
      `);let p=i.allocVar();return i.insertGlobalCode(te`
        void ${p}(vec3 p, out vec4 c) {
          ${l.colourFuncName}(p - ${s}, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:p}}]])}}}const yg=W({size:D(E),out:ee(E)}),gc=new X({typeName:"Box",typeSchema:yg});class bg{componentType=gc;ext={};create(r){return new vg(r)}}const yc=new bg;class vg{type=yc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"size",source:()=>t.size,setSource:i=>n("size",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("size");if(a?.type!="Atom")return;let l=a.value,u=i.allocVar();return i.insertGlobalCode(te`
        float ${u}(vec3 p) {
          vec3 q = abs(p) - 0.5 * ${l};
          return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:"defaultColour"}}]])}}}const wg=W({model1:D(E),model2:D(E),k:D(E),out:ee(E)}),bc=new X({typeName:"Union",typeSchema:wg});class kg{componentType=bc;ext={};create(r){return new xg(r)}}const vc=new kg;class xg{type=vc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model1",source:()=>t.model1,setSource:i=>n("model1",i)},{name:"model2",source:()=>t.model2,setSource:i=>n("model2",i)},{name:"k",source:()=>t.k,setSource:i=>n("k",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let p=i.allocVar();if(c?.type=="Atom"){let d=c.value;i.insertGlobalCode(te`
          float ${p}(vec3 p) {
            float k = ${d} * 4.0;
            float d1 = ${l.sdfFuncName}(p);
            float d2 = ${s.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return min(d1, d2) - h*h*0.25/k;
          }
        `)}else i.insertGlobalCode(te`
          float ${p}(vec3 p) {
            return min(${l.sdfFuncName}(p), ${s.sdfFuncName}(p));
          }
        `);let f=i.allocVar();return i.insertGlobalCode(te`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:p,colourFuncName:f}}]])}}}const _g=W({model1:D(E),model2:D(E),k:D(E),out:ee(E)}),wc=new X({typeName:"Difference",typeSchema:_g});class Sg{componentType=wc;ext={};create(r){return new Cg(r)}}const kc=new Sg;class Cg{type=kc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model1",source:()=>t.model1,setSource:i=>n("model1",i)},{name:"model2",source:()=>t.model2,setSource:i=>n("model2",i)},{name:"k",source:()=>t.k,setSource:i=>n("k",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let p=i.allocVar();if(c?.type=="Atom"){let d=c.value;i.insertGlobalCode(te`
          float ${p}(vec3 p) {
            float k = ${d} * 4.0;
            float d1 = -${l.sdfFuncName}(p);
            float d2 = ${s.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return -(min(d1, d2) - h*h*0.25/k);
          }
        `)}else i.insertGlobalCode(te`
          float ${p}(vec3 p) {
            return -min(-${l.sdfFuncName}(p), ${s.sdfFuncName}(p));
          }
        `);let f=i.allocVar();return i.insertGlobalCode(te`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:p,colourFuncName:f}}]])}}}const Pg=W({model:D(E),step:D(E),out:ee(E)}),xc=new X({typeName:"Repeat",typeSchema:Pg});class Tg{componentType=xc;ext={};create(r){return new $g(r)}}const _c=new Tg;class $g{type=_c;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)},{name:"step",source:()=>t.step,setSource:i=>n("step",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("step");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          vec3 s = ${s};
          vec3 id = vec3(floor(p.x/s.x + 0.5),floor(p.y/s.y + 0.5),floor(p.z/s.z + 0.5));
          vec3  o = sign(p-s*id);
          float d = 1e20;
          for( int k=0; k<2; k++ )
          for( int j=0; j<2; j++ )
          for( int i=0; i<2; i++ )
          {
            vec3 rid = id + vec3(i,j,k)*o;
            vec3 r = p - s*rid;
            d = min( d, ${l.sdfFuncName}(r));
          }
          return d;
        }
      `);let p=i.allocVar();return i.insertGlobalCode(te`
        void ${p}(vec3 p, out vec4 c) {
          vec3 s = ${s};
          vec3 id = vec3(floor(p.x/s.x + 0.5),floor(p.y/s.y + 0.5),floor(p.z/s.z + 0.5));
          p = p-s*id;
          ${l.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:p}}]])}}}const Eg=W({model:D(E),scale:D(E),out:ee(E)}),Sc=new X({typeName:"Scale",typeSchema:Eg});class Ig{componentType=Sc;ext={};create(r){return new Rg(r)}}const Cc=new Ig;class Rg{type=Cc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)},{name:"scale",source:()=>t.scale,setSource:i=>n("scale",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("scale");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          return ${l.sdfFuncName}(p / ${s}) * ${s};
        }
      `);let p=i.allocVar();return i.insertGlobalCode(te`
        void ${p}(vec3 p, out vec4 c) {
          ${l.colourFuncName}(p / ${s}, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:p}}]])}}}const Ag=W({model:D(E),axis:D(E),angle:D(E),out:ee(E)}),Pc=new X({typeName:"Rotate",typeSchema:Ag});class Mg{componentType=Pc;ext={};create(r){return new Ng(r)}}const Tc=new Mg;class Ng{type=Tc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)},{name:"axis",source:()=>t.axis,setSource:i=>n("axis",i)},{name:"angle",source:()=>t.angle,setSource:i=>n("angle",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("axis");if(u?.type!="Atom")return;let s=u.value,c=o.get("angle");if(c?.type!="Atom")return;let p=c.value,f=i.allocVar();i.insertGlobalCode(te`
        float ${f}(vec3 p) {
          float a = 0.5 * ${p} * ${Math.PI/180};
          vec3 tmp = sin(a) * normalize(${s});
          vec4 q = vec4(tmp.x, tmp.y, tmp.z, cos(a));
          p = p + 2.0 * cross(-q.xyz, cross(-q.xyz, p) + q.w * p);
          return ${l.sdfFuncName}(p);
        }
      `);let d=i.allocVar();return i.insertGlobalCode(te`
        void ${d}(vec3 p, out vec4 c) {
          float a = 0.5 * ${p} * ${Math.PI/180};
          vec3 tmp = sin(a) * normalize(${s});
          vec4 q = vec4(tmp.x, tmp.y, tmp.z, cos(a));
          p = p + 2.0 * cross(-q.xyz, cross(-q.xyz, p) + q.w * p);
          ${l.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:f,colourFuncName:d}}]])}}}const Og=W({radius:D(E),out:ee(E)}),$c=new X({typeName:"InfiniteCylinder",typeSchema:Og});class Fg{componentType=$c;ext={};create(r){return new zg(r)}}const Ec=new Fg;class zg{type=Ec;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"radius",source:()=>t.radius,setSource:i=>n("radius",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let l=a.value,u=i.allocVar();i.insertGlobalCode(te`
        float ${u}(vec3 p) {
          return length(p.xy) - ${l};
        }
      `);let s=i.allocVar();return i.insertGlobalCode(te`
        void ${s}(vec3 p, out vec4 c) {
          c = vec4(0.7, 0.7, 0.7, 1.0);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:s}}]])}}}const Dg=W({colour:W({red:Je(),green:Je(),blue:Je(),alpha:Je()}),out:ee(E)}),Ic=new X({typeName:"Colour",typeSchema:Dg});class gn{r;g;b;a;constructor(r,t,n,i){this.r=r,this.g=t,this.b=n,this.a=i}}var Lg=Z("<div><div><div><div></div><svg><circle r=5 stroke=black stroke-width=2 fill=none pointer-events=none></circle></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div></div><div><div></div><div><table><thead></thead><tbody><tr><td>Red:</td><td><input type=text size=4></td></tr><tr><td>Green:</td><td><input type=text size=4></td></tr><tr><td>Blue:</td><td><input type=text size=4></td></tr><tr><td>Alpha:</td><td><input type=text size=4></td></tr></tbody></table></div><div><div>");const Ug=e=>{let[r,t]=Me({cursorPos:G.zero,chartMousePos:void 0,chartMouseDown:!1,brightness:255,brightnessMousePos:void 0,brightnessMouseDown:!1,alpha:255,alphaMousePos:void 0,alphaMouseDown:!1,userColour:me(()=>e.colour),userRedText:void 0,userGreenText:void 0,userBlueText:void 0,userAlphaText:void 0}),[n,i]=K(),[o,a]=K();ge(()=>{let b=n();if(b==null)return;let w=new ResizeObserver(()=>{let v=b.getBoundingClientRect();o(),a(G.create(v.width,v.height))});w.observe(b),Te(()=>{w.unobserve(b),w.disconnect()})});let l=C(()=>{let b=o();if(b==null)return;let w=document.createElement("canvas");w.setAttribute("width",`${b.x}`),w.setAttribute("height",`${b.y}`),w.style.setProperty("flex-grow","1");let v=w.getContext("2d");if(v==null)return;let k=new ImageData(b.x,b.y),_=256*6;for(let N=0;N<b.x;++N){let R,O,L,B=Math.floor(N*_/b.x);if(B<256){let H=B;R=255,O=H,L=0}else if(B<256*2)R=255-(B-256),O=255,L=0;else if(B<256*3){let H=B-512;R=0,O=255,L=H}else if(B<256*4){let H=B-768;R=0,O=255-H,L=255}else if(B<256*5)R=B-1024,O=0,L=255;else{let H=B-1280;R=255,O=0,L=255-H}let U=N<<2;for(let H=0;H<b.y;++H){let ne=R+Math.floor((256-R)*H/b.y),ce=O+Math.floor((256-O)*H/b.y),fe=L+Math.floor((256-L)*H/b.y);k.data[U]=ne,k.data[U+1]=ce,k.data[U+2]=fe,k.data[U+3]=255,U+=b.x<<2}}let S=new ImageData(b.x,b.y);ge(se(()=>r.brightness,()=>{let N=r.brightness,R=b.x*b.y<<2;for(let O=0;O<R;O+=4){let L=k.data[O],B=k.data[O+1],U=k.data[O+2],H=k.data[O+3],ne=Math.floor(L*N/255),ce=Math.floor(B*N/255),fe=Math.floor(U*N/255);S.data[O]=ne,S.data[O+1]=ce,S.data[O+2]=fe,S.data[O+3]=H}v.putImageData(S,0,0)}));let P=document.createElement("canvas");P.setAttribute("width","1"),P.setAttribute("height",`${b.y}`),P.style.setProperty("flex-grow","1");let T=P.getContext("2d");if(T==null)return;let $=new ImageData(1,b.y);ge(()=>{let N=r.cursorPos;if(N==null)return;let R=k.width*N.y+N.x<<2,O=k.data[R],L=k.data[R+1],B=k.data[R+2];for(let U=0;U<b.y;++U){let H=U<<2,ne=Math.floor(O*(b.y-1-U)/(b.y-1)),ce=Math.floor(L*(b.y-1-U)/(b.y-1)),fe=Math.floor(B*(b.y-1-U)/(b.y-1));$.data[H]=ne,$.data[H+1]=ce,$.data[H+2]=fe,$.data[H+3]=255}T.putImageData($,0,0)});let x=document.createElement("canvas");x.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),x.style.setProperty("background-size","20px 20px"),x.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),x.setAttribute("width","1"),x.setAttribute("height",`${b.y}`),x.style.setProperty("flex-grow","1");let I=x.getContext("2d");if(I==null)return;let F=new ImageData(1,b.y);return ge(()=>{let N=r.cursorPos;if(N==null)return;let R=k.width*N.y+N.x<<2,O=k.data[R],L=k.data[R+1],B=k.data[R+2],U=k.data[R+3];for(let H=0;H<b.y;++H){let ne=H<<2,ce=Math.floor(U*(b.y-1-H)/(b.y-1));F.data[ne]=O,F.data[ne+1]=L,F.data[ne+2]=B,F.data[ne+3]=ce}I.putImageData(F,0,0)}),{canvas:w,sliderCanvas:P,alphaSliderCanvas:x,size:b,sliderImageData:$,alphaSliderImageData:F}});Ce(()=>{let b=l();if(b==null||!r.chartMouseDown)return;let w=r.chartMousePos;w!=null&&(t("userColour",void 0),t("userRedText",void 0),t("userGreenText",void 0),t("userBlueText",void 0),t("cursorPos",G.create(Math.max(0,Math.min(b.size.x-1,Math.floor(w.x))),Math.max(0,Math.min(b.size.y-1,Math.floor(w.y))))))}),Ce(()=>{if(!r.brightnessMouseDown)return;let b=r.brightnessMousePos;if(b==null)return;let w=l()?.size.y;w!=null&&(t("userColour",void 0),t("userRedText",void 0),t("userGreenText",void 0),t("userBlueText",void 0),t("brightness",Math.max(0,Math.min(255,Math.floor(256*(w-b.y)/w)))))}),Ce(()=>{if(!r.alphaMouseDown)return;let b=r.alphaMousePos;if(b==null)return;let w=l()?.size.y;w!=null&&(t("userColour",void 0),t("userRedText",void 0),t("userGreenText",void 0),t("userBlueText",void 0),t("userAlphaText",void 0),t("alpha",Math.max(0,Math.min(255,Math.floor(256*(w-b.y)/w)))))});let u=C(se([l,()=>r.cursorPos,()=>r.brightness,()=>r.alpha],()=>{let b=l();if(b==null)return;let v=Math.max(0,Math.min(b.size.y,Math.floor((255-r.brightness)*b.size.y/256)))<<2,k=b.sliderImageData.data[v],_=b.sliderImageData.data[v+1],S=b.sliderImageData.data[v+2],P=r.alpha;return new gn(k,_,S,P)})),s=C(()=>{if(r.userRedText==null)return;let b=Number.parseFloat(r.userRedText);if(Number.isFinite(b))return Math.max(0,Math.min(255,b))}),c=C(()=>{if(r.userGreenText==null)return;let b=Number.parseFloat(r.userGreenText);if(Number.isFinite(b))return Math.max(0,Math.min(255,b))}),p=C(()=>{if(r.userBlueText==null)return;let b=Number.parseFloat(r.userBlueText);if(Number.isFinite(b))return Math.max(0,Math.min(255,b))}),f=C(()=>{if(r.userAlphaText==null)return;let b=Number.parseFloat(r.userAlphaText);if(Number.isFinite(b))return Math.max(0,Math.min(255,b))}),d=C(()=>{let b;return r.userColour!=null?b=r.userColour:b=u(),new gn(s()??b?.r??0,c()??b?.g??0,p()??b?.b??0,f()??b?.a??255)});Ce(se([()=>e.colour],()=>{let b=d();if(b==null||e.colour==null)return;let w=e.colour;w.r==b.r&&w.g==b.g&&w.b==b.b&&w.a==b.a||t("userColour",w)},{defer:!0})),Ce(se([()=>r.userColour,d],()=>{if(r.userColour!=null)return;let b=d();b!=null&&e.onColour?.(b)})),Ce(()=>{let b=l();if(!b||r.userColour==null&&s()==null&&c()==null&&p()==null&&f()==null)return;let w=r.userColour,v=new gn(s()??w?.r??0,c()??w?.g??0,p()??w?.b??0,f()??w?.a??255),k=Math.max(v.r,v.g,v.b),_=Math.min(v.r,v.g,v.b),S=k,P=255/(k-_);if(!Number.isFinite(P))return;let T=Math.floor((v.r-_)*P),$=Math.floor((v.g-_)*P),x=Math.floor((v.b-_)*P),I=v.r==k,F=v.g==k,N=v.b==k,R;I&&!F&&x==0?R=$:!I&&F&&x==0?R=256+(255-T):T==0&&F&&!N?R=256*2+x:T==0&&!F&&N?R=256*3+(255-$):!I&&$==0&&N?R=256*4+T:R=256*5+(255-x);let O=Math.floor(b.size.x*R/(256*6)),L=_;Le(()=>{t("cursorPos",G.create(O,L)),t("brightness",S),t("alpha",v.a)})});let[h,m]=K(),[g,y]=K(50);return Ce(se(h,()=>{let b=h();if(b==null)return;let w=new ResizeObserver(()=>{let v=b.getBoundingClientRect();console.log(v),v.width!=v.height&&y(v.height)});w.observe(b),Te(()=>{w.unobserve(b),w.disconnect()})})),(()=>{var b=Lg(),w=b.firstChild,v=w.firstChild,k=v.firstChild,_=k.nextSibling,S=_.firstChild,P=v.nextSibling,T=P.firstChild,$=T.firstChild,x=P.nextSibling,I=x.firstChild,F=I.firstChild,N=w.nextSibling,R=N.firstChild,O=R.nextSibling,L=O.firstChild,B=L.firstChild,U=B.nextSibling,H=U.firstChild,ne=H.firstChild,ce=ne.nextSibling,fe=ce.firstChild,z=H.nextSibling,oe=z.firstChild,ye=oe.nextSibling,he=ye.firstChild,q=z.nextSibling,re=q.firstChild,pe=re.nextSibling,Oe=pe.firstChild,et=q.nextSibling,at=et.firstChild,Mt=at.nextSibling,tt=Mt.firstChild,le=O.nextSibling,rt=le.firstChild;b.style.setProperty("flex-grow","1"),b.style.setProperty("display","flex"),b.style.setProperty("flex-direction","column"),w.style.setProperty("flex-grow","1"),w.style.setProperty("display","flex"),w.style.setProperty("flex-direction","row"),v.$$pointerup=A=>{t("chartMouseDown",!1),A.currentTarget.releasePointerCapture(A.pointerId),A.preventDefault()},v.$$pointerdown=A=>{t("chartMouseDown",!0),A.currentTarget.setPointerCapture(A.pointerId),A.preventDefault()},v.$$pointerout=A=>{t("chartMousePos",void 0),A.preventDefault()},v.$$pointermove=A=>{let ie=A.currentTarget.getBoundingClientRect(),Pe=A.clientX-ie.left,Ve=A.clientY-ie.top;t("chartMousePos",G.create(Pe,Ve)),A.preventDefault()},v.style.setProperty("position","relative"),v.style.setProperty("flex-grow","1"),v.style.setProperty("display","flex"),v.style.setProperty("flex-direction","column"),v.style.setProperty("touch-action","none");var wt=i;typeof wt=="function"?ve(wt,k):i=k,k.style.setProperty("flex-grow","1"),k.style.setProperty("display","flex"),k.style.setProperty("flex-direction","column"),Y(k,()=>l()?.canvas),_.style.setProperty("position","absolute"),_.style.setProperty("left","0"),_.style.setProperty("top","0"),_.style.setProperty("right","0"),_.style.setProperty("bottom","0"),P.$$pointerup=A=>{t("brightnessMouseDown",!1),A.currentTarget.releasePointerCapture(A.pointerId),A.preventDefault()},P.$$pointerdown=A=>{t("brightnessMouseDown",!0),A.currentTarget.setPointerCapture(A.pointerId),A.preventDefault()},P.$$pointerout=A=>{t("brightnessMousePos",void 0),A.preventDefault()},P.$$pointermove=A=>{let ie=A.currentTarget.getBoundingClientRect(),Pe=A.clientX-ie.left,Ve=A.clientY-ie.top;t("brightnessMousePos",G.create(Pe,Ve)),A.preventDefault()},P.style.setProperty("position","relative"),P.style.setProperty("display","flex"),P.style.setProperty("flex-direction","row"),P.style.setProperty("width","25px"),P.style.setProperty("margin-left","15px"),P.style.setProperty("overflow","hidden"),P.style.setProperty("touch-action","none"),Y(P,()=>l()?.sliderCanvas,T),T.style.setProperty("position","absolute"),T.style.setProperty("left","0"),T.style.setProperty("top","0"),T.style.setProperty("right","0"),T.style.setProperty("bottom","0"),x.$$pointerup=A=>{t("alphaMouseDown",!1),A.currentTarget.releasePointerCapture(A.pointerId),A.preventDefault()},x.$$pointerdown=A=>{t("alphaMouseDown",!0),A.currentTarget.setPointerCapture(A.pointerId),A.preventDefault()},x.$$pointerout=A=>{t("alphaMousePos",void 0),A.preventDefault()},x.$$pointermove=A=>{let ie=A.currentTarget.getBoundingClientRect(),Pe=A.clientX-ie.left,Ve=A.clientY-ie.top;t("alphaMousePos",G.create(Pe,Ve)),A.preventDefault()},x.style.setProperty("position","relative"),x.style.setProperty("display","flex"),x.style.setProperty("flex-direction","row"),x.style.setProperty("width","25px"),x.style.setProperty("margin-left","15px"),x.style.setProperty("overflow","hidden"),x.style.setProperty("touch-action","none"),Y(x,()=>l()?.alphaSliderCanvas,I),I.style.setProperty("position","absolute"),I.style.setProperty("left","0"),I.style.setProperty("top","0"),I.style.setProperty("right","0"),I.style.setProperty("bottom","0"),N.style.setProperty("display","flex"),N.style.setProperty("flex-direction","row"),R.style.setProperty("flex-grow","1"),fe.$$input=A=>{Le(()=>{t("userRedText",A.currentTarget.value),t("userGreenText",d().g.toFixed(0)),t("userBlueText",d().b.toFixed(0)),t("userAlphaText",d().a.toFixed(0))})},he.$$input=A=>{Le(()=>{t("userRedText",d().r.toFixed(0)),t("userGreenText",A.currentTarget.value),t("userBlueText",d().b.toFixed(0)),t("userAlphaText",d().a.toFixed(0))})},Oe.$$input=A=>{Le(()=>{t("userRedText",d().r.toFixed(0)),t("userGreenText",d().g.toFixed(0)),t("userBlueText",A.currentTarget.value),t("userAlphaText",d().a.toFixed(0))})},tt.$$input=A=>{Le(()=>{t("userRedText",d().r.toFixed(0)),t("userGreenText",d().g.toFixed(0)),t("userBlueText",d().b.toFixed(0)),t("userAlphaText",A.currentTarget.value)})};var kt=m;return typeof kt=="function"?ve(kt,le):m=le,le.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),le.style.setProperty("background-size","20px 20px"),le.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),le.style.setProperty("margin-top","10px"),le.style.setProperty("margin-bottom","10px"),le.style.setProperty("margin-left","10px"),le.style.setProperty("display","flex"),le.style.setProperty("flex-direction","column"),rt.style.setProperty("flex-grow","1"),Q(A=>{var ie=l()?.size.x??300,Pe=l()?.size.y??300,Ve=r.cursorPos.x,Ye=r.cursorPos.y,xt=`${l()?.size.y??0}px`,Nt=l()?.size.y??0,pr=(l()?.size.y??0)-r.brightness*(l()?.size.y??0)/255-5,er=`${l()?.size.y??0}px`,Wr=l()?.size.y??0,uo=(l()?.size.y??0)-r.alpha*(l()?.size.y??0)/255-5,En=`${g()}px`,In=(()=>{let fr=d();if(fr!=null)return`rgb(${fr.r}, ${fr.g}, ${fr.b})`})(),Rn=d().a/255;return ie!==A.e&&J(_,"width",A.e=ie),Pe!==A.t&&J(_,"height",A.t=Pe),Ve!==A.a&&J(S,"cx",A.a=Ve),Ye!==A.o&&J(S,"cy",A.o=Ye),xt!==A.i&&((A.i=xt)!=null?P.style.setProperty("height",xt):P.style.removeProperty("height")),Nt!==A.n&&J(T,"height",A.n=Nt),pr!==A.s&&J($,"y",A.s=pr),er!==A.h&&((A.h=er)!=null?x.style.setProperty("height",er):x.style.removeProperty("height")),Wr!==A.r&&J(I,"height",A.r=Wr),uo!==A.d&&J(F,"y",A.d=uo),En!==A.l&&((A.l=En)!=null?le.style.setProperty("width",En):le.style.removeProperty("width")),In!==A.u&&((A.u=In)!=null?rt.style.setProperty("background-color",In):rt.style.removeProperty("background-color")),Rn!==A.c&&((A.c=Rn)!=null?rt.style.setProperty("opacity",Rn):rt.style.removeProperty("opacity")),A},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),Q(()=>fe.value=r.userRedText??r.userColour?.r??u()?.r),Q(()=>he.value=r.userGreenText??r.userColour?.g??u()?.g),Q(()=>Oe.value=r.userBlueText??r.userColour?.b??u()?.b),Q(()=>tt.value=r.userAlphaText??r.userColour?.a??u()?.a),b})()};$e(["pointermove","pointerout","pointerdown","pointerup","input"]);var jg=Z(`<svg version=1.1 viewBox="-16 -16 32 32"><defs><linearGradient x1=0 x2=0 y1=0 y2=1><stop offset=0% stop-color="rgb(80, 80, 81)"></stop><stop offset=100% stop-color="rgb(30, 30, 31)"></stop></linearGradient><path d="
        M14.876 -5.890A-16 -16 0 0 0 14.876 5.890A16 16 0 0 112.539 9.938A-16 -16 0 0 0 2.337 15.828
        A16 16 0 0 1-2.337 15.828A-16 -16 0 0 0 -12.539 9.938A16 16 0 0 1-14.876 5.890A-16 -16 0 0 0 -14.876 -5.890
        A16 16 0 0 1-12.539 -9.938A-16 -16 0 0 0 -2.337 -15.828A16 16 0 0 12.337 -15.828A-16 -16 0 0 0 12.539 -9.938
        A16 16 0 0 114.876 -5.890"></path><clipPath><use></use></clipPath><filter></filter><filter></filter></defs><circle cx=0 cy=0 r=15.0 fill="rgb(36, 36, 37)"stroke="rgb(28, 28, 29)"stroke-width=0.5></circle><g><g><g><rect x=-16 y=-16 width=32 height=32></rect><circle cx=-28 cy=-28 r=32 fill="rgba(250, 250, 255, .16)"></circle></g></g></g><g><circle cx=0 cy=-11 r=1.1 fill=black></circle><circle cx=0 cy=-11 r=0.8 fill=white></circle></g><circle cx=0 cy=0 r=9 stroke="rgb(50, 50, 51)"stroke-width=0.7 fill=none></circle><foreignObject x=-9 y=-9 width=18 height=18><div style=width:18px;height:18px;border-radius:50%;background-image:conic-gradient(#aaa,#666,#aaa,#666,#aaa,#666,#aaa);>`);const Bg=e=>{let[r,t]=Me({dragging:void 0}),[n,i]=K();Te(()=>{r.dragging&&e.setDisablePan(!1)});let o=-165,a=-o,l=C(()=>o+(e.value-e.minValue)*(a-o)/(e.maxValue-e.minValue)),u=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");u.setAttribute("dx","-0.3"),u.setAttribute("dy","-0.3"),u.setAttribute("stdDeviation","0.1"),u.setAttribute("flood-opacity","0.7"),u.setAttribute("flood-color","white");let s=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");s.setAttribute("dx","1.5"),s.setAttribute("dy","1.5"),s.setAttribute("stdDeviation","0.5"),s.setAttribute("flood-opacity","0.9"),s.setAttribute("flood-color","black");let c=b=>{let w=n(),v=w.getBoundingClientRect(),k=b.clientX-v.left,_=b.clientY-v.top,S=k-.5*v.width,P=_-.5*v.width;console.log("x",k.toFixed()),console.log("y",_.toFixed()),console.log("dx",S.toFixed()),console.log("dy",P.toFixed());let T=S*S+P*P;if(T>v.width*v.width)return;let $=Math.sqrt(T),I=360/(2*Math.PI*$),F=P>0?-I:I,N=S>0?I:-I;t("dragging",new qr({pointerId:b.pointerId,startX:k,startY:_,startValue:e.value,dadx:F,dady:N})),w.setPointerCapture(b.pointerId),e.setDisablePan(!0)},p=b=>{if(r.dragging==null||b.pointerId!=r.dragging.value.pointerId)return;let w=n(),v=r.dragging.value,k=w.getBoundingClientRect(),_=b.clientX-k.left,S=b.clientY-k.top,P=o+(v.startValue-e.minValue)*(a-o)/(e.maxValue-e.minValue)+(_-v.startX)*v.dadx+(S-v.startY)*v.dady,T=e.minValue+(P-o)*(e.maxValue-e.minValue)/(a-o);(e.unbounded??!1)||(T=Math.max(e.minValue,Math.min(e.maxValue,T))),e.setValue(T)},f=b=>{r.dragging!=null&&r.dragging.value.pointerId==b.pointerId&&(n().releasePointerCapture(r.dragging.value.pointerId),e.setDisablePan(!1),t("dragging",void 0))},d=Ut(),h=Ut(),m=Ut(),g=Ut(),y=Ut();return(()=>{var b=jg(),w=b.firstChild,v=w.firstChild,k=v.nextSibling,_=k.nextSibling,S=_.firstChild,P=_.nextSibling,T=P.nextSibling,$=w.nextSibling,x=$.nextSibling,I=x.firstChild,F=I.firstChild,N=F.firstChild,R=x.nextSibling;b.$$pointerup=f,b.$$pointermove=p,b.$$pointerdown=c;var O=i;return typeof O=="function"?ve(O,b):i=b,b.style.setProperty("user-select","none"),b.style.setProperty("outline","none"),J(v,"id",d),J(k,"id",h),J(_,"id",m),J(S,"href",`#${h}`),J(P,"id",g),Y(P,u),J(T,"id",y),Y(T,s),J(x,"filter",`url(#${y})`),J(I,"filter",`url(#${g})`),J(F,"clip-path",`url(#${m})`),J(N,"fill",`url(#${d})`),Q(L=>{var B=`${e.size}px`,U=`${e.size}px`,H=`transform: rotate(${l()}deg) scale(0.87)`,ne=`transform: rotate(${l()}deg)`;return B!==L.e&&((L.e=B)!=null?b.style.setProperty("width",B):b.style.removeProperty("width")),U!==L.t&&((L.t=U)!=null?b.style.setProperty("height",U):b.style.removeProperty("height")),L.a=po(_,H,L.a),L.o=po(R,ne,L.o),L},{e:void 0,t:void 0,a:void 0,o:void 0}),b})()};$e(["pointerdown","pointermove","pointerup"]);var qg=Z("<div style=width:300px;height:300px;display:flex;flex-direction:column;>");class Vg{componentType=Ic;ext={};create(r){return new Gg(r)}}const Rc=new Vg;class Gg{type=Rc;nodeParams;inputPins;outputPins;ui;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ui=C(()=>()=>(()=>{var i=qg();return Y(i,M(Ug,{get colour(){return new gn(t.colour.red,t.colour.green,t.colour.blue,t.colour.alpha)},onColour:o=>{n("colour",{red:o.r,green:o.g,blue:o.b,alpha:o.a})}})),i})()),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=`vec4(${t.colour.red/255}, ${t.colour.green/255}, ${t.colour.blue/255}, ${t.colour.alpha/255})`;return new Map([["out",{type:"Atom",value:a}]])}}}const Hg=W({colour:D(E),model:D(E),out:ee(E)}),Ac=new X({typeName:"ApplyColour",typeSchema:Hg});class Zg{componentType=Ac;ext={};create(r){return new Wg(r)}}const Mc=new Zg;class Wg{type=Mc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)},{name:"colour",source:()=>t.colour,setSource:i=>n("colour",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("colour");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();return i.insertGlobalCode(te`
        void ${c}(vec3 p, out vec4 c) {
          c = vec4(${s});
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:l.sdfFuncName,colourFuncName:c}}]])}}}const Yg=W({colour1:D(E),colour2:D(E),size:D(E),model:D(E),out:ee(E)}),Nc=new X({typeName:"ApplyCheckers",typeSchema:Yg});class Xg{componentType=Nc;ext={};create(r){return new Kg(r)}}const Oc=new Xg;class Kg{type=Oc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)},{name:"colour1",source:()=>t.colour1,setSource:i=>n("colour1",i)},{name:"colour2",source:()=>t.colour2,setSource:i=>n("colour2",i)},{name:"size",source:()=>t.size,setSource:i=>n("size",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("colour1");if(u?.type!="Atom")return;let s=u.value,c=o.get("colour2");if(c?.type!="Atom")return;let p=c.value,f=o.get("size");if(f?.type!="Atom")return;let d=f.value,h=i.allocVar();return i.insertGlobalCode(te`
        void ${h}(vec3 p, out vec4 c) {
          p = floor(p / ${d});
          float a = mod(p.x + p.y + p.z, 2.0);
          if (a < 0.5) {
            c = vec4(${s});
          } else {
            c = vec4(${p});
          }
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:l.sdfFuncName,colourFuncName:h}}]])}}}const Jg=W({value:Je(),sensitivity:cl(1,Je()),out:ee(E)}),Fc=new X({typeName:"UnboundKnob",typeSchema:Jg});var Qg=Z("<div><label class=label style=color:black;>Value</label><input class=input type=text size=5><label class=label style=color:black;>Sensitivity</label><input class=input type=text size=5>");class ey{componentType=Fc;ext={};create(r){return new ty(r)}}const zc=new ey;class ty{type=zc;nodeParams;outputPins;ui;disablePan;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r;let[i,o]=K(!1);this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:a=>n("out",a)}]),this.ui=C(()=>()=>{let[a,l]=K(t.value.toFixed(3)),[u,s]=K(t.sensitivity.toFixed(3)),c=!1,p=!1;return Ce(se(()=>t.value,f=>{c||l(f.toFixed(3))},{defer:!0})),Ce(se(()=>t.sensitivity,f=>{p||s(f.toFixed(3))})),(()=>{var f=Qg(),d=f.firstChild,h=d.nextSibling,m=h.nextSibling,g=m.nextSibling;return f.style.setProperty("display","flex"),f.style.setProperty("flex-direction","column"),h.$$input=y=>{let b=y.currentTarget.value;l(b);let w=Number.parseFloat(b.trim());if(!Number.isNaN(w))try{c=!0,n("value",w)}finally{c=!1}},g.$$input=y=>{let b=y.currentTarget.value;s(b);let w=Number.parseFloat(b.trim());if(!Number.isNaN(w))try{p=!0,n("sensitivity",w)}finally{p=!1}},Y(f,M(Bg,{size:100,indentSize:10,minValue:0,get maxValue(){return 100*t.sensitivity},unbounded:!0,get value(){return t.value},setValue:y=>n("value",y),setDisablePan:o}),null),Q(()=>h.value=a()),Q(()=>g.value=u()),f})()}),this.disablePan=i,this.ext.generateCode=({ctx:a,inputs:l,onInit:u})=>{let s=a.allocVar(),c=te`
        ${to.float(s)}
      `,p=it.toSchema(c);return a.insertGlobalCode(c),u(({gl:f,program:d,rerender:h})=>{let m=ro(f,d,p.uniforms);Ce(se(()=>t.value,g=>{m[s].set(g),h()}))}),new Map([["out",{type:"Atom",value:s}]])}}}$e(["input"]);const ry=W({radius:D(E),height:D(E),out:ee(E)}),Dc=new X({typeName:"Cylinder",typeSchema:ry});class ny{componentType=Dc;ext={};create(r){return new iy(r)}}const Lc=new ny;class iy{type=Lc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"radius",source:()=>t.radius,setSource:i=>n("radius",i)},{name:"height",source:()=>t.height,setSource:i=>n("height",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let l=a.value,u=o.get("height");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();return i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(${l},${s});
          return min(max(d.x,d.y),0.0) + length(max(d,0.0));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const oy=W({frequency:D(E),magnitude:D(E),out:ee(E)}),Uc=new X({typeName:"SinXYZField",typeSchema:oy});class ay{componentType=Uc;ext={};create(r){return new sy(r)}}const jc=new ay;class sy{type=jc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"frequency",source:()=>t.frequency,setSource:i=>n("frequency",i)},{name:"magnitude",source:()=>t.magnitude,setSource:i=>n("magnitude",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("frequency");if(a?.type!="Atom")return;let l=a.value,u=o.get("magnitude");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();return i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          return ${s} * sin(p.x*${l}) * sin(p.y*${l}) * sin(p.z*${l});
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const ly=W({model1:D(E),model2:D(E),out:ee(E)}),Bc=new X({typeName:"Displace",typeSchema:ly});class cy{componentType=Bc;ext={};create(r){return new uy(r)}}const qc=new cy;class uy{type=qc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model1",source:()=>t.model1,setSource:i=>n("model1",i)},{name:"model2",source:()=>t.model2,setSource:i=>n("model2",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=i.allocVar();i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          return d1 + d2;
        }
      `);let p=i.allocVar();return i.insertGlobalCode(te`
        void ${p}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:p}}]])}}}const dy=W({model:D(E),count:D(E),out:ee(E)}),Vc=new X({typeName:"RepeatRotational",typeSchema:dy});class py{componentType=Vc;ext={};create(r){return new fy(r)}}const Gc=new py;class fy{type=Gc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)},{name:"count",source:()=>t.count,setSource:i=>n("count",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("count");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          float sp = 6.283185/float(${s});
          float an = atan(p.y,p.x);
          float id = floor(an/sp);

          float a1 = sp*(id+0.0);
          float a2 = sp*(id+1.0);
          vec2 r1 = mat2(cos(a1),-sin(a1),sin(a1),cos(a1))*p.xy;
          vec2 r2 = mat2(cos(a2),-sin(a2),sin(a2),cos(a2))*p.xy;

          return min(${l.sdfFuncName}(vec3(r1.x, r1.y, p.z)), ${l.sdfFuncName}(vec3(r2.x,r2.y,p.z)));
        }
      `);let p=i.allocVar();return i.insertGlobalCode(te`
        void ${p}(vec3 p, out vec4 c) {
          float sp = 6.283185/float(${s});
          float an = atan(p.y,p.x);
          float id = floor(an/sp);
          float a1 = sp*(id+0.0);
          float a2 = sp*(id+1.0);
          vec2 r1 = mat2(cos(a1),-sin(a1),sin(a1),cos(a1))*p.xy;
          vec2 r2 = mat2(cos(a2),-sin(a2),sin(a2),cos(a2))*p.xy;
          vec3 p1 = vec3(r1.x, r1.y, p.z);
          vec3 p2 = vec3(r2.x, r2.y, p.z);
          float d1 = ${l.sdfFuncName}(p1);
          float d2 = ${l.sdfFuncName}(p2);
          if (d1 < d2) {
            p = p1;
          } else {
            p = p2;
          }
          ${l.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:p}}]])}}}const hy=W({model:D(E),k:D(E),out:ee(E)}),Hc=new X({typeName:"Bend",typeSchema:hy});class my{componentType=Hc;ext={};create(r){return new gy(r)}}const Zc=new my;class gy{type=Zc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)},{name:"k",source:()=>t.k,setSource:i=>n("k",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("k");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();return i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          float k = ${s};
          float c = cos(k*p.x);
          float s = sin(k*p.x);
          mat2  m = mat2(c,-s,s,c);
          vec3  q = vec3(m*p.xy,p.z);
          return ${l.sdfFuncName}(q);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const yy=W({mimeType:mt(),base64Data:mt(),out:ee(E)}),Wc=new X({typeName:"Texture",typeSchema:yy});var by=Z('<button class="btn btn-primary">Browse...'),vy=Z("<input type=file hidden>");class wy{componentType=Wc;ext={};create(r){return new ky(r)}}const Yc=new wy;class ky{type=Yc;nodeParams;outputPins;ui;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:a=>n("out",a)}]),this.ui=C(()=>()=>{let[a,l]=K(),u=async s=>{let c=s.type,p=await s.arrayBuffer(),f=new Uint8Array(p),d=fl(f);Le(()=>{n("mimeType",c),n("base64Data",d)})};return[(()=>{var s=by();return s.$$click=()=>a()?.click(),s})(),(()=>{var s=vy();s.addEventListener("change",p=>{let f=p.currentTarget.files;if(f==null||f.length!=1)return;let d=f[0];u(d),p.currentTarget.value=""});var c=l;return typeof c=="function"?ve(c,s):l=s,s})()]});let i=C(()=>{if(t.mimeType==""||t.base64Data=="")return;let a=hl(t.base64Data),l=new Blob([a],{type:t.mimeType}),u=URL.createObjectURL(l),[s,c]=K(),p=document.createElement("img");return p.src=u,p.onload=()=>{c(p)},Te(()=>{URL.revokeObjectURL(u)}),s}),o=C(()=>i()?.());this.ext.generateCode=({ctx:a,onInit:l})=>{let u=a.allocVar(),s=te`
        ${to.sampler2D(u)}
      `;a.insertGlobalCode(s);let c=it.toSchema(s);return l(({gl:p,program:f,rerender:d})=>{ro(p,f,c.uniforms)[u].set(0);let m=p.createTexture();p.activeTexture(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,m),Ce(se(o,g=>{g!=null&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,g),d())})),Te(()=>{p.deleteTexture(m)})}),new Map([["out",{type:"Atom",value:u}]])}}}$e(["click"]);const xy=W({model:D(E),texture:D(E),scaleX:D(E),scaleY:D(E),offsetX:D(E),offsetY:D(E),out:ee(E)}),Xc=new X({typeName:"ApplyTexture",typeSchema:xy});class _y{componentType=Xc;ext={};create(r){return new Sy(r)}}const Kc=new _y;class Sy{type=Kc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)},{name:"texture",source:()=>t.texture,setSource:i=>n("texture",i)},{name:"scaleX",source:()=>t.scaleX,setSource:i=>n("scaleX",i)},{name:"scaleY",source:()=>t.scaleY,setSource:i=>n("scaleY",i)},{name:"offsetX",source:()=>t.offsetX,setSource:i=>n("offsetX",i)},{name:"offsetY",source:()=>t.offsetY,setSource:i=>n("offsetY",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("texture");if(u?.type!="Atom")return;let s=u.value,c=o.get("scaleX"),p;c?.type=="Atom"?p=c.value:p="1.0";let f=o.get("scaleY"),d;f?.type=="Atom"?d=f.value:d="1.0";let h=o.get("offsetX"),m;h?.type=="Atom"?m=h.value:m="0.0";let g=o.get("offsetY"),y;g?.type=="Atom"?y=g.value:y="0.0";let b=i.allocVar();return i.insertGlobalCode(te`
        void ${b}(vec3 p, out vec4 c) {
          c = texture2D(${s}, (p.xy + vec2(${m}, ${y})) / vec2(${p}, ${d}));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:l.sdfFuncName,colourFuncName:b}}]])}}}const Cy=W({radius:D(E),height:D(E),out:ee(E)}),Jc=new X({typeName:"Cone",typeSchema:Cy});class Py{componentType=Jc;ext={};create(r){return new Ty(r)}}const Qc=new Py;class Ty{type=Qc;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"radius",source:()=>t.radius,setSource:i=>n("radius",i)},{name:"height",source:()=>t.height,setSource:i=>n("height",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let l=a.value,u=o.get("height");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();return i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          float h = ${s};
          float z = sqrt(${s} * ${s} + ${l} * ${l});
          vec2 c = vec2(${l} / z, ${s} / z);
          vec2 q = h*vec2(c.x/c.y,-1.0);
          vec2 w = vec2( length(p.xz), p.y );
          vec2 a = w - q*clamp( dot(w,q)/dot(q,q), 0.0, 1.0 );
          vec2 b = w - q*vec2( clamp( w.x/q.x, 0.0, 1.0 ), 1.0 );
          float k = sign( q.y );
          float d = min(dot( a, a ),dot(b, b));
          float s = max( k*(w.x*q.y-w.y*q.x),k*(w.y-q.y)  );
          return sqrt(d)*sign(s);        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const $y=W({radius1:D(E),radius2:D(E),out:ee(E)}),eu=new X({typeName:"Torus",typeSchema:$y});class Ey{componentType=eu;ext={};create(r){return new Iy(r)}}const tu=new Ey;class Iy{type=tu;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"radius1",source:()=>t.radius1,setSource:i=>n("radius1",i)},{name:"radius2",source:()=>t.radius2,setSource:i=>n("radius2",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("radius1");if(a?.type!="Atom")return;let l=a.value,u=o.get("radius2");if(u?.type!="Atom")return;let s=u.value,c=i.allocVar();return i.insertGlobalCode(te`
        float ${c}(vec3 p) {
          vec2 q = vec2(length(p.xz)-${l},p.y);
          return length(q)-${s};
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const Ry=W({model:D(E),out:ee(E)}),ru=new X({typeName:"Mirror",typeSchema:Ry});class Ay{componentType=ru;ext={};create(r){return new My(r)}}const nu=new Ay;class My{type=nu;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model",source:()=>t.model,setSource:i=>n("model",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=i.allocVar();i.insertGlobalCode(te`
        float ${u}(vec3 p) {
          return ${l.sdfFuncName}(
            vec3(-p.x, p.y, p.z)
          );
        }
      `);let s=i.allocVar();return i.insertGlobalCode(te`
        void ${s}(vec3 p, out vec4 c) {
          ${l.colourFuncName}(
            vec3(-p.x, p.y, p.z),
            c
          );
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:s}}]])}}}const Ny=W({model1:D(E),model2:D(E),k:D(E),out:ee(E)}),iu=new X({typeName:"Intersection",typeSchema:Ny});class Oy{componentType=iu;ext={};create(r){return new Fy(r)}}const ou=new Oy;class Fy{type=ou;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model1",source:()=>t.model1,setSource:i=>n("model1",i)},{name:"model2",source:()=>t.model2,setSource:i=>n("model2",i)},{name:"k",source:()=>t.k,setSource:i=>n("k",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let p=i.allocVar();if(c?.type=="Atom"){let d=c.value;i.insertGlobalCode(te`
          float ${p}(vec3 p) {
            float k = ${d} * 4.0;
            float d1 = -${l.sdfFuncName}(p);
            float d2 = -${s.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return -(min(d1, d2) - h*h*0.25/k);
          }
        `)}else i.insertGlobalCode(te`
          float ${p}(vec3 p) {
            return max(${l.sdfFuncName}(p), ${s.sdfFuncName}(p));
          }
        `);let f=i.allocVar();return i.insertGlobalCode(te`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:p,colourFuncName:f}}]])}}}const zy=W({model1:D(E),model2:D(E),k:D(E),out:ee(E)}),au=new X({typeName:"Xor",typeSchema:zy});class Dy{componentType=au;ext={};create(r){return new Ly(r)}}const su=new Dy;class Ly{type=su;nodeParams;inputPins;outputPins;ext={};constructor(r){let t=r.state,n=r.setState;this.nodeParams=r,this.inputPins=C(()=>[{name:"model1",source:()=>t.model1,setSource:i=>n("model1",i)},{name:"model2",source:()=>t.model2,setSource:i=>n("model2",i)},{name:"k",source:()=>t.k,setSource:i=>n("k",i)}]),this.outputPins=C(()=>[{name:"out",sinks:()=>t.out,setSinks:i=>n("out",i)}]),this.ext.generateCode=({ctx:i,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let p=i.allocVar();if(c?.type=="Atom"){let d=c.value;i.insertGlobalCode(te`
          float ${p}(vec3 p) {
            float k = ${d} * 4.0;
            float d1 = ${l.sdfFuncName}(p);
            float d2 = ${s.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return max(min(d1,d2),-max(d1,d2)) - h*h*0.25/k;
          }
        `)}else i.insertGlobalCode(te`
          float ${p}(vec3 p) {
            float d1 = ${l.sdfFuncName}(p);
            float d2 = ${s.sdfFuncName}(p);
            return max(min(d1,d2),-max(d1,d2));
          }
        `);let f=i.allocVar();return i.insertGlobalCode(te`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:p,colourFuncName:f}}]])}}}const lu=new ml;lu.registerNodeTypes([Oc,Mc,Kc,Zc,yc,Rc,Qc,Lc,kc,qc,dc,Ec,ou,nu,zc,sc,_c,Gc,Tc,Cc,jc,oc,Yc,tu,mc,vc,fc,su]);class Uy{nextId=0;globalCode=[];mainBody=[];colourBody=[];allocVar(){return`x${this.nextId++}`}insertGlobalCode(r){this.globalCode.push(r)}insertCode(r){this.mainBody.push(r)}insertColourCode(r){this.colourBody.push(r)}genCode(r){let t=r.maxIterations??100;return te`precision highp float;
uniform vec2 resolution;
uniform float uTollerance;
uniform float uMaxStep;
uniform float uFocalLength;
uniform mat4 uInverseViewMatrix;
uniform bool uUseOrthogonalProjection;
uniform float uOrthogonalScale;

void defaultColour(vec3 p, out vec4 c) {
  c = vec4(1.0, 1.0, 1.0, 1.0);
}

${this.globalCode}

float map(vec3 p) {
  float d = 10000.0;
  ${this.mainBody}
  return d;
}

void colourMap(vec3 p, out vec4 c) {
  float d = 10000.0;
  ${this.colourBody}
}

bool march(vec3 ro, vec3 rd, out float t) {
  vec3 p = ro;
  t = 0.0;
  for (int i = 0; i < ${t}; ++i) {
    vec3 p = ro + rd*t;
    float d = map(p);
    if (abs(d) <= uTollerance) {
      return true;
    }
    if (d > uMaxStep) {
      return false;
    }
    t += d;
  }
  return false;
}

vec3 normal(vec3 p) {
  float d = 0.01;
  float mp = map(p);
  float dx = map(p + vec3(d,0,0)) - mp;
  float dy = map(p + vec3(0,d,0)) - mp;
  float dz = map(p + vec3(0,0,d)) - mp;
  return normalize(vec3(dx,dy,dz));
}

void main(void) {
  float fl = uFocalLength;
  float d = 10000.0;
  float mx = max(resolution.x, resolution.y);
  vec2 uv = gl_FragCoord.xy / mx;
  vec3 w = normalize(vec3(0.0, 0.0, 1.0));
  vec3 u = normalize(cross(vec3(0,1,0),w));
  vec3 v = cross(w,u);
  vec3 ro;
  vec3 rd;
  if (uUseOrthogonalProjection) {
    ro = (gl_FragCoord.x - 0.5 * resolution.x) * u / uOrthogonalScale
       + (gl_FragCoord.y - 0.5 * resolution.y) * v / uOrthogonalScale;
    rd = vec3(0.0, 0.0, -1.0);
  } else {
    ro = vec3(0.0);
    rd = normalize(
      (gl_FragCoord.x - 0.5 * resolution.x) * u +
      (gl_FragCoord.y - 0.5 * resolution.y) * v +
      -fl * w
    );
  }
  vec3 rp = ro + rd;
  ro = (uInverseViewMatrix * vec4(ro, 1.0)).xyz;
  rp = (uInverseViewMatrix * vec4(rp, 1.0)).xyz;
  rd = rp - ro;
  float t = 0.0;
  bool hit = march(ro, rd, t);
  if (!hit) {
    gl_FragColor = vec4(0.2, 0.2, 0.2, 1.0);
    return;
  }
  vec3 p = ro + rd*t;
  vec3 n = normal(p);
  float s = dot(n,normalize(vec3(1,1,1))) + 0.2;
  vec4 c = vec4(1.0, 1.0, 1.0, 1.0);
  colourMap(p, c);
  gl_FragColor = vec4(c.r * s, c.g * s, c.b * s, c.a);
}`}}function jy(e){let r=e.nodesSystem,t=[];{let u=new Map;for(let s of r.nodes()){let c={id:0,inputs:{},outputs:{},height:0,node:s};u.set(s.node.nodeParams.entity,c),t.push(c)}for(let s of u.values())for(let c of s.node.node.inputPins?.()??[]){let p=c.source();if(p==null)continue;let f=u.get(p.target);f!=null&&(s.inputs[c.name]={node:f,pin:p.pin})}}for(let u of t)for(let[s,{node:c,pin:p}]of Object.entries(u.inputs)){let f=c.outputs[p],d={node:u,pin:s};f==null?(f=[d],c.outputs[p]=f):f.push(d)}let n=[];By(t);{let u=0;for(let s of t)s.id=u++}let i=new Uy;n.splice(0,n.length);for(let u of t){let s=n[u.height];s==null?(s=[u],n[u.height]=s):s.push(u)}let o=new Map,a=[];for(let u=0;u<n.length;++u){let s=n[u]??[];for(let c of s){let p=c.node.node,f=new Map;for(let d of Object.entries(c.inputs)){let h=o.get(d[1].node)?.get(d[1].pin);h!=null&&f.set(d[0],h)}if(p.ext.generateCode!=null){let d=p.ext.generateCode({ctx:i,inputs:f,onInit:h=>a.push(h)});d!=null&&o.set(c,d)}}}let l=u=>{for(let s of a)s(u)};return{code:i.genCode({maxIterations:e.maxIterations}),onInit:l}}function By(e){let r=new Set,t=[...e],n=[];for(;;){let i=t.pop();if(i==null){let l=t;if(t=n,n=l,i=t.pop(),i==null)break}if(r.has(i))continue;let o=!0;for(let[l,{node:u}]of Object.entries(i.inputs))if(!(i.node.node.inputPins?.().find(s=>s.name==l)?.isEffectPin??!1)&&!r.has(u)){o=!1;break}if(!o){n.push(i);continue}let a=0;for(let[,{node:l,pin:u}]of Object.entries(i.inputs))(l.node.node.outputPins?.().find(({name:s})=>s==u)?.isEffectPin??!1)||l.height>=a&&(a=l.height+1);i.height=a,r.add(i)}}const ya=new Gi([...dl.componentTypes,Nc,Ac,Xc,Hc,gc,Ic,Jc,Dc,wc,Bc,lc,$c,iu,ru,Qi,ac,xc,Vc,Pc,Sc,Uc,ec,Wc,eu,Ie,hc,Fc,bc,pc,au]);class qy{space;pointerDown;pointerUp;pointerMove;constructor(r){let[t,n]=Me({space:r.initSpace,orbitTarget:r.initOrbitTarget,orbiting:void 0});this.space=()=>t.space,this.pointerDown=i=>{t.orbiting||n("orbiting",new qr({pointerId:i.pointerId,startPoint:ci.create(i.clientX,i.clientY),startOrigin:t.space.origin}))},this.pointerUp=i=>{t.orbiting!=null&&i.pointerId==i.pointerId&&n("orbiting",void 0)},this.pointerMove=i=>{if(t.orbiting){let o=t.orbiting.value,a=i.clientX-o.startPoint.x,l=i.clientY-o.startPoint.y,s=be.fromAxisAngle(j.unitY,-a).rotate$Vec3(o.startOrigin.sub(t.orbitTarget)),c=j.create(s.z,0,-s.x).normalize();s=be.fromAxisAngle(c,-l).rotate$Vec3(s);let f=s.add(t.orbitTarget),d=s.normalize();c=j.unitY.cross(d).normalize();let h=Fe.create(f,be.fromWU(d,c));n("space",h)}}}writeGLInverseViewMatrix(r){let t=this.space(),n=t.u,i=t.v,o=t.w,a=t.o;r[0]=n.x,r[4]=i.x,r[8]=o.x,r[12]=a.x,r[1]=n.y,r[5]=i.y,r[9]=o.y,r[13]=a.y,r[2]=n.z,r[6]=i.z,r[10]=o.z,r[14]=a.z,r[3]=0,r[7]=0,r[11]=0,r[15]=1}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Vy=4,ba=0,va=1,Gy=2;function lr(e){let r=e.length;for(;--r>=0;)e[r]=0}const Hy=0,cu=1,Zy=2,Wy=3,Yy=258,no=29,Vr=256,Or=Vr+1+no,ir=30,io=19,uu=2*Or+1,Bt=15,Yn=16,Xy=7,oo=256,du=16,pu=17,fu=18,xi=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),yn=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ky=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),hu=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Jy=512,bt=new Array((Or+2)*2);lr(bt);const Er=new Array(ir*2);lr(Er);const Fr=new Array(Jy);lr(Fr);const zr=new Array(Yy-Wy+1);lr(zr);const ao=new Array(no);lr(ao);const xn=new Array(ir);lr(xn);function Xn(e,r,t,n,i){this.static_tree=e,this.extra_bits=r,this.extra_base=t,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let mu,gu,yu;function Kn(e,r){this.dyn_tree=e,this.max_code=0,this.stat_desc=r}const bu=e=>e<256?Fr[e]:Fr[256+(e>>>7)],Dr=(e,r)=>{e.pending_buf[e.pending++]=r&255,e.pending_buf[e.pending++]=r>>>8&255},We=(e,r,t)=>{e.bi_valid>Yn-t?(e.bi_buf|=r<<e.bi_valid&65535,Dr(e,e.bi_buf),e.bi_buf=r>>Yn-e.bi_valid,e.bi_valid+=t-Yn):(e.bi_buf|=r<<e.bi_valid&65535,e.bi_valid+=t)},ct=(e,r,t)=>{We(e,t[r*2],t[r*2+1])},vu=(e,r)=>{let t=0;do t|=e&1,e>>>=1,t<<=1;while(--r>0);return t>>>1},Qy=e=>{e.bi_valid===16?(Dr(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},eb=(e,r)=>{const t=r.dyn_tree,n=r.max_code,i=r.stat_desc.static_tree,o=r.stat_desc.has_stree,a=r.stat_desc.extra_bits,l=r.stat_desc.extra_base,u=r.stat_desc.max_length;let s,c,p,f,d,h,m=0;for(f=0;f<=Bt;f++)e.bl_count[f]=0;for(t[e.heap[e.heap_max]*2+1]=0,s=e.heap_max+1;s<uu;s++)c=e.heap[s],f=t[t[c*2+1]*2+1]+1,f>u&&(f=u,m++),t[c*2+1]=f,!(c>n)&&(e.bl_count[f]++,d=0,c>=l&&(d=a[c-l]),h=t[c*2],e.opt_len+=h*(f+d),o&&(e.static_len+=h*(i[c*2+1]+d)));if(m!==0){do{for(f=u-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[u]--,m-=2}while(m>0);for(f=u;f!==0;f--)for(c=e.bl_count[f];c!==0;)p=e.heap[--s],!(p>n)&&(t[p*2+1]!==f&&(e.opt_len+=(f-t[p*2+1])*t[p*2],t[p*2+1]=f),c--)}},wu=(e,r,t)=>{const n=new Array(Bt+1);let i=0,o,a;for(o=1;o<=Bt;o++)i=i+t[o-1]<<1,n[o]=i;for(a=0;a<=r;a++){let l=e[a*2+1];l!==0&&(e[a*2]=vu(n[l]++,l))}},tb=()=>{let e,r,t,n,i;const o=new Array(Bt+1);for(t=0,n=0;n<no-1;n++)for(ao[n]=t,e=0;e<1<<xi[n];e++)zr[t++]=n;for(zr[t-1]=n,i=0,n=0;n<16;n++)for(xn[n]=i,e=0;e<1<<yn[n];e++)Fr[i++]=n;for(i>>=7;n<ir;n++)for(xn[n]=i<<7,e=0;e<1<<yn[n]-7;e++)Fr[256+i++]=n;for(r=0;r<=Bt;r++)o[r]=0;for(e=0;e<=143;)bt[e*2+1]=8,e++,o[8]++;for(;e<=255;)bt[e*2+1]=9,e++,o[9]++;for(;e<=279;)bt[e*2+1]=7,e++,o[7]++;for(;e<=287;)bt[e*2+1]=8,e++,o[8]++;for(wu(bt,Or+1,o),e=0;e<ir;e++)Er[e*2+1]=5,Er[e*2]=vu(e,5);mu=new Xn(bt,xi,Vr+1,Or,Bt),gu=new Xn(Er,yn,0,ir,Bt),yu=new Xn(new Array(0),Ky,0,io,Xy)},ku=e=>{let r;for(r=0;r<Or;r++)e.dyn_ltree[r*2]=0;for(r=0;r<ir;r++)e.dyn_dtree[r*2]=0;for(r=0;r<io;r++)e.bl_tree[r*2]=0;e.dyn_ltree[oo*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},xu=e=>{e.bi_valid>8?Dr(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},wa=(e,r,t,n)=>{const i=r*2,o=t*2;return e[i]<e[o]||e[i]===e[o]&&n[r]<=n[t]},Jn=(e,r,t)=>{const n=e.heap[t];let i=t<<1;for(;i<=e.heap_len&&(i<e.heap_len&&wa(r,e.heap[i+1],e.heap[i],e.depth)&&i++,!wa(r,n,e.heap[i],e.depth));)e.heap[t]=e.heap[i],t=i,i<<=1;e.heap[t]=n},ka=(e,r,t)=>{let n,i,o=0,a,l;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+o++]&255,n+=(e.pending_buf[e.sym_buf+o++]&255)<<8,i=e.pending_buf[e.sym_buf+o++],n===0?ct(e,i,r):(a=zr[i],ct(e,a+Vr+1,r),l=xi[a],l!==0&&(i-=ao[a],We(e,i,l)),n--,a=bu(n),ct(e,a,t),l=yn[a],l!==0&&(n-=xn[a],We(e,n,l)));while(o<e.sym_next);ct(e,oo,r)},_i=(e,r)=>{const t=r.dyn_tree,n=r.stat_desc.static_tree,i=r.stat_desc.has_stree,o=r.stat_desc.elems;let a,l,u=-1,s;for(e.heap_len=0,e.heap_max=uu,a=0;a<o;a++)t[a*2]!==0?(e.heap[++e.heap_len]=u=a,e.depth[a]=0):t[a*2+1]=0;for(;e.heap_len<2;)s=e.heap[++e.heap_len]=u<2?++u:0,t[s*2]=1,e.depth[s]=0,e.opt_len--,i&&(e.static_len-=n[s*2+1]);for(r.max_code=u,a=e.heap_len>>1;a>=1;a--)Jn(e,t,a);s=o;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Jn(e,t,1),l=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=l,t[s*2]=t[a*2]+t[l*2],e.depth[s]=(e.depth[a]>=e.depth[l]?e.depth[a]:e.depth[l])+1,t[a*2+1]=t[l*2+1]=s,e.heap[1]=s++,Jn(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],eb(e,r),wu(t,u,e.bl_count)},xa=(e,r,t)=>{let n,i=-1,o,a=r[0*2+1],l=0,u=7,s=4;for(a===0&&(u=138,s=3),r[(t+1)*2+1]=65535,n=0;n<=t;n++)o=a,a=r[(n+1)*2+1],!(++l<u&&o===a)&&(l<s?e.bl_tree[o*2]+=l:o!==0?(o!==i&&e.bl_tree[o*2]++,e.bl_tree[du*2]++):l<=10?e.bl_tree[pu*2]++:e.bl_tree[fu*2]++,l=0,i=o,a===0?(u=138,s=3):o===a?(u=6,s=3):(u=7,s=4))},_a=(e,r,t)=>{let n,i=-1,o,a=r[0*2+1],l=0,u=7,s=4;for(a===0&&(u=138,s=3),n=0;n<=t;n++)if(o=a,a=r[(n+1)*2+1],!(++l<u&&o===a)){if(l<s)do ct(e,o,e.bl_tree);while(--l!==0);else o!==0?(o!==i&&(ct(e,o,e.bl_tree),l--),ct(e,du,e.bl_tree),We(e,l-3,2)):l<=10?(ct(e,pu,e.bl_tree),We(e,l-3,3)):(ct(e,fu,e.bl_tree),We(e,l-11,7));l=0,i=o,a===0?(u=138,s=3):o===a?(u=6,s=3):(u=7,s=4)}},rb=e=>{let r;for(xa(e,e.dyn_ltree,e.l_desc.max_code),xa(e,e.dyn_dtree,e.d_desc.max_code),_i(e,e.bl_desc),r=io-1;r>=3&&e.bl_tree[hu[r]*2+1]===0;r--);return e.opt_len+=3*(r+1)+5+5+4,r},nb=(e,r,t,n)=>{let i;for(We(e,r-257,5),We(e,t-1,5),We(e,n-4,4),i=0;i<n;i++)We(e,e.bl_tree[hu[i]*2+1],3);_a(e,e.dyn_ltree,r-1),_a(e,e.dyn_dtree,t-1)},ib=e=>{let r=4093624447,t;for(t=0;t<=31;t++,r>>>=1)if(r&1&&e.dyn_ltree[t*2]!==0)return ba;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return va;for(t=32;t<Vr;t++)if(e.dyn_ltree[t*2]!==0)return va;return ba};let Sa=!1;const ob=e=>{Sa||(tb(),Sa=!0),e.l_desc=new Kn(e.dyn_ltree,mu),e.d_desc=new Kn(e.dyn_dtree,gu),e.bl_desc=new Kn(e.bl_tree,yu),e.bi_buf=0,e.bi_valid=0,ku(e)},_u=(e,r,t,n)=>{We(e,(Hy<<1)+(n?1:0),3),xu(e),Dr(e,t),Dr(e,~t),t&&e.pending_buf.set(e.window.subarray(r,r+t),e.pending),e.pending+=t},ab=e=>{We(e,cu<<1,3),ct(e,oo,bt),Qy(e)},sb=(e,r,t,n)=>{let i,o,a=0;e.level>0?(e.strm.data_type===Gy&&(e.strm.data_type=ib(e)),_i(e,e.l_desc),_i(e,e.d_desc),a=rb(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=t+5,t+4<=i&&r!==-1?_u(e,r,t,n):e.strategy===Vy||o===i?(We(e,(cu<<1)+(n?1:0),3),ka(e,bt,Er)):(We(e,(Zy<<1)+(n?1:0),3),nb(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),ka(e,e.dyn_ltree,e.dyn_dtree)),ku(e),n&&xu(e)},lb=(e,r,t)=>(e.pending_buf[e.sym_buf+e.sym_next++]=r,e.pending_buf[e.sym_buf+e.sym_next++]=r>>8,e.pending_buf[e.sym_buf+e.sym_next++]=t,r===0?e.dyn_ltree[t*2]++:(e.matches++,r--,e.dyn_ltree[(zr[t]+Vr+1)*2]++,e.dyn_dtree[bu(r)*2]++),e.sym_next===e.sym_end);var cb=ob,ub=_u,db=sb,pb=lb,fb=ab,hb={_tr_init:cb,_tr_stored_block:ub,_tr_flush_block:db,_tr_tally:pb,_tr_align:fb};const mb=(e,r,t,n)=>{let i=e&65535|0,o=e>>>16&65535|0,a=0;for(;t!==0;){a=t>2e3?2e3:t,t-=a;do i=i+r[n++]|0,o=o+i|0;while(--a);i%=65521,o%=65521}return i|o<<16|0};var Lr=mb;const gb=()=>{let e,r=[];for(var t=0;t<256;t++){e=t;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r},yb=new Uint32Array(gb()),bb=(e,r,t,n)=>{const i=yb,o=n+t;e^=-1;for(let a=n;a<o;a++)e=e>>>8^i[(e^r[a])&255];return e^-1};var Re=bb,Zt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},cr={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:vb,_tr_stored_block:Si,_tr_flush_block:wb,_tr_tally:Tt,_tr_align:kb}=hb,{Z_NO_FLUSH:$t,Z_PARTIAL_FLUSH:xb,Z_FULL_FLUSH:_b,Z_FINISH:nt,Z_BLOCK:Ca,Z_OK:Ne,Z_STREAM_END:Pa,Z_STREAM_ERROR:ft,Z_DATA_ERROR:Sb,Z_BUF_ERROR:Qn,Z_DEFAULT_COMPRESSION:Cb,Z_FILTERED:Pb,Z_HUFFMAN_ONLY:tn,Z_RLE:Tb,Z_FIXED:$b,Z_DEFAULT_STRATEGY:Eb,Z_UNKNOWN:Ib,Z_DEFLATED:Pn}=cr,Rb=9,Ab=15,Mb=8,Nb=29,Ob=256,Ci=Ob+1+Nb,Fb=30,zb=19,Db=2*Ci+1,Lb=15,ae=3,Ct=258,ht=Ct+ae+1,Ub=32,ar=42,so=57,Pi=69,Ti=73,$i=91,Ei=103,qt=113,Cr=666,Ue=1,ur=2,Wt=3,dr=4,jb=3,Vt=(e,r)=>(e.msg=Zt[r],r),Ta=e=>e*2-(e>4?9:0),St=e=>{let r=e.length;for(;--r>=0;)e[r]=0},Bb=e=>{let r,t,n,i=e.w_size;r=e.hash_size,n=r;do t=e.head[--n],e.head[n]=t>=i?t-i:0;while(--r);r=i,n=r;do t=e.prev[--n],e.prev[n]=t>=i?t-i:0;while(--r)};let qb=(e,r,t)=>(r<<e.hash_shift^t)&e.hash_mask,Et=qb;const Xe=e=>{const r=e.state;let t=r.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(e.output.set(r.pending_buf.subarray(r.pending_out,r.pending_out+t),e.next_out),e.next_out+=t,r.pending_out+=t,e.total_out+=t,e.avail_out-=t,r.pending-=t,r.pending===0&&(r.pending_out=0))},Qe=(e,r)=>{wb(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,r),e.block_start=e.strstart,Xe(e.strm)},ue=(e,r)=>{e.pending_buf[e.pending++]=r},wr=(e,r)=>{e.pending_buf[e.pending++]=r>>>8&255,e.pending_buf[e.pending++]=r&255},Ii=(e,r,t,n)=>{let i=e.avail_in;return i>n&&(i=n),i===0?0:(e.avail_in-=i,r.set(e.input.subarray(e.next_in,e.next_in+i),t),e.state.wrap===1?e.adler=Lr(e.adler,r,i,t):e.state.wrap===2&&(e.adler=Re(e.adler,r,i,t)),e.next_in+=i,e.total_in+=i,i)},Su=(e,r)=>{let t=e.max_chain_length,n=e.strstart,i,o,a=e.prev_length,l=e.nice_match;const u=e.strstart>e.w_size-ht?e.strstart-(e.w_size-ht):0,s=e.window,c=e.w_mask,p=e.prev,f=e.strstart+Ct;let d=s[n+a-1],h=s[n+a];e.prev_length>=e.good_match&&(t>>=2),l>e.lookahead&&(l=e.lookahead);do if(i=r,!(s[i+a]!==h||s[i+a-1]!==d||s[i]!==s[n]||s[++i]!==s[n+1])){n+=2,i++;do;while(s[++n]===s[++i]&&s[++n]===s[++i]&&s[++n]===s[++i]&&s[++n]===s[++i]&&s[++n]===s[++i]&&s[++n]===s[++i]&&s[++n]===s[++i]&&s[++n]===s[++i]&&n<f);if(o=Ct-(f-n),n=f-Ct,o>a){if(e.match_start=r,a=o,o>=l)break;d=s[n+a-1],h=s[n+a]}}while((r=p[r&c])>u&&--t!==0);return a<=e.lookahead?a:e.lookahead},sr=e=>{const r=e.w_size;let t,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-ht)&&(e.window.set(e.window.subarray(r,r+r-n),0),e.match_start-=r,e.strstart-=r,e.block_start-=r,e.insert>e.strstart&&(e.insert=e.strstart),Bb(e),n+=r),e.strm.avail_in===0)break;if(t=Ii(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=t,e.lookahead+e.insert>=ae)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Et(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Et(e,e.ins_h,e.window[i+ae-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<ae)););}while(e.lookahead<ht&&e.strm.avail_in!==0)},Cu=(e,r)=>{let t=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,i,o,a=0,l=e.strm.avail_in;do{if(n=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o||(o=e.strm.avail_out-o,i=e.strstart-e.block_start,n>i+e.strm.avail_in&&(n=i+e.strm.avail_in),n>o&&(n=o),n<t&&(n===0&&r!==nt||r===$t||n!==i+e.strm.avail_in)))break;a=r===nt&&n===i+e.strm.avail_in?1:0,Si(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Xe(e.strm),i&&(i>n&&(i=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,n-=i),n&&(Ii(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(a===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?dr:r!==$t&&r!==nt&&e.strm.avail_in===0&&e.strstart===e.block_start?ur:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(Ii(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,t=o>e.w_size?e.w_size:o,i=e.strstart-e.block_start,(i>=t||(i||r===nt)&&r!==$t&&e.strm.avail_in===0&&i<=o)&&(n=i>o?o:i,a=r===nt&&e.strm.avail_in===0&&n===i?1:0,Si(e,e.block_start,n,a),e.block_start+=n,Xe(e.strm)),a?Wt:Ue)},ei=(e,r)=>{let t,n;for(;;){if(e.lookahead<ht){if(sr(e),e.lookahead<ht&&r===$t)return Ue;if(e.lookahead===0)break}if(t=0,e.lookahead>=ae&&(e.ins_h=Et(e,e.ins_h,e.window[e.strstart+ae-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-ht&&(e.match_length=Su(e,t)),e.match_length>=ae)if(n=Tt(e,e.strstart-e.match_start,e.match_length-ae),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ae){e.match_length--;do e.strstart++,e.ins_h=Et(e,e.ins_h,e.window[e.strstart+ae-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Et(e,e.ins_h,e.window[e.strstart+1]);else n=Tt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Qe(e,!1),e.strm.avail_out===0))return Ue}return e.insert=e.strstart<ae-1?e.strstart:ae-1,r===nt?(Qe(e,!0),e.strm.avail_out===0?Wt:dr):e.sym_next&&(Qe(e,!1),e.strm.avail_out===0)?Ue:ur},tr=(e,r)=>{let t,n,i;for(;;){if(e.lookahead<ht){if(sr(e),e.lookahead<ht&&r===$t)return Ue;if(e.lookahead===0)break}if(t=0,e.lookahead>=ae&&(e.ins_h=Et(e,e.ins_h,e.window[e.strstart+ae-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ae-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-ht&&(e.match_length=Su(e,t),e.match_length<=5&&(e.strategy===Pb||e.match_length===ae&&e.strstart-e.match_start>4096)&&(e.match_length=ae-1)),e.prev_length>=ae&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-ae,n=Tt(e,e.strstart-1-e.prev_match,e.prev_length-ae),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=Et(e,e.ins_h,e.window[e.strstart+ae-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=ae-1,e.strstart++,n&&(Qe(e,!1),e.strm.avail_out===0))return Ue}else if(e.match_available){if(n=Tt(e,0,e.window[e.strstart-1]),n&&Qe(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Ue}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Tt(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ae-1?e.strstart:ae-1,r===nt?(Qe(e,!0),e.strm.avail_out===0?Wt:dr):e.sym_next&&(Qe(e,!1),e.strm.avail_out===0)?Ue:ur},Vb=(e,r)=>{let t,n,i,o;const a=e.window;for(;;){if(e.lookahead<=Ct){if(sr(e),e.lookahead<=Ct&&r===$t)return Ue;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=ae&&e.strstart>0&&(i=e.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=e.strstart+Ct;do;while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=Ct-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ae?(t=Tt(e,1,e.match_length-ae),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=Tt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(Qe(e,!1),e.strm.avail_out===0))return Ue}return e.insert=0,r===nt?(Qe(e,!0),e.strm.avail_out===0?Wt:dr):e.sym_next&&(Qe(e,!1),e.strm.avail_out===0)?Ue:ur},Gb=(e,r)=>{let t;for(;;){if(e.lookahead===0&&(sr(e),e.lookahead===0)){if(r===$t)return Ue;break}if(e.match_length=0,t=Tt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(Qe(e,!1),e.strm.avail_out===0))return Ue}return e.insert=0,r===nt?(Qe(e,!0),e.strm.avail_out===0?Wt:dr):e.sym_next&&(Qe(e,!1),e.strm.avail_out===0)?Ue:ur};function lt(e,r,t,n,i){this.good_length=e,this.max_lazy=r,this.nice_length=t,this.max_chain=n,this.func=i}const Pr=[new lt(0,0,0,0,Cu),new lt(4,4,8,4,ei),new lt(4,5,16,8,ei),new lt(4,6,32,32,ei),new lt(4,4,16,16,tr),new lt(8,16,32,32,tr),new lt(8,16,128,128,tr),new lt(8,32,128,256,tr),new lt(32,128,258,1024,tr),new lt(32,258,258,4096,tr)],Hb=e=>{e.window_size=2*e.w_size,St(e.head),e.max_lazy_match=Pr[e.level].max_lazy,e.good_match=Pr[e.level].good_length,e.nice_match=Pr[e.level].nice_length,e.max_chain_length=Pr[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ae-1,e.match_available=0,e.ins_h=0};function Zb(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Pn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Db*2),this.dyn_dtree=new Uint16Array((2*Fb+1)*2),this.bl_tree=new Uint16Array((2*zb+1)*2),St(this.dyn_ltree),St(this.dyn_dtree),St(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Lb+1),this.heap=new Uint16Array(2*Ci+1),St(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Ci+1),St(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Gr=e=>{if(!e)return 1;const r=e.state;return!r||r.strm!==e||r.status!==ar&&r.status!==so&&r.status!==Pi&&r.status!==Ti&&r.status!==$i&&r.status!==Ei&&r.status!==qt&&r.status!==Cr?1:0},Pu=e=>{if(Gr(e))return Vt(e,ft);e.total_in=e.total_out=0,e.data_type=Ib;const r=e.state;return r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap===2?so:r.wrap?ar:qt,e.adler=r.wrap===2?0:1,r.last_flush=-2,vb(r),Ne},Tu=e=>{const r=Pu(e);return r===Ne&&Hb(e.state),r},Wb=(e,r)=>Gr(e)||e.state.wrap!==2?ft:(e.state.gzhead=r,Ne),$u=(e,r,t,n,i,o)=>{if(!e)return ft;let a=1;if(r===Cb&&(r=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>Rb||t!==Pn||n<8||n>15||r<0||r>9||o<0||o>$b||n===8&&a!==1)return Vt(e,ft);n===8&&(n=9);const l=new Zb;return e.state=l,l.strm=e,l.status=ar,l.wrap=a,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+ae-1)/ae),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=r,l.strategy=o,l.method=t,Tu(e)},Yb=(e,r)=>$u(e,r,Pn,Ab,Mb,Eb),Xb=(e,r)=>{if(Gr(e)||r>Ca||r<0)return e?Vt(e,ft):ft;const t=e.state;if(!e.output||e.avail_in!==0&&!e.input||t.status===Cr&&r!==nt)return Vt(e,e.avail_out===0?Qn:ft);const n=t.last_flush;if(t.last_flush=r,t.pending!==0){if(Xe(e),e.avail_out===0)return t.last_flush=-1,Ne}else if(e.avail_in===0&&Ta(r)<=Ta(n)&&r!==nt)return Vt(e,Qn);if(t.status===Cr&&e.avail_in!==0)return Vt(e,Qn);if(t.status===ar&&t.wrap===0&&(t.status=qt),t.status===ar){let i=Pn+(t.w_bits-8<<4)<<8,o=-1;if(t.strategy>=tn||t.level<2?o=0:t.level<6?o=1:t.level===6?o=2:o=3,i|=o<<6,t.strstart!==0&&(i|=Ub),i+=31-i%31,wr(t,i),t.strstart!==0&&(wr(t,e.adler>>>16),wr(t,e.adler&65535)),e.adler=1,t.status=qt,Xe(e),t.pending!==0)return t.last_flush=-1,Ne}if(t.status===so){if(e.adler=0,ue(t,31),ue(t,139),ue(t,8),t.gzhead)ue(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),ue(t,t.gzhead.time&255),ue(t,t.gzhead.time>>8&255),ue(t,t.gzhead.time>>16&255),ue(t,t.gzhead.time>>24&255),ue(t,t.level===9?2:t.strategy>=tn||t.level<2?4:0),ue(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(ue(t,t.gzhead.extra.length&255),ue(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(e.adler=Re(e.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=Pi;else if(ue(t,0),ue(t,0),ue(t,0),ue(t,0),ue(t,0),ue(t,t.level===9?2:t.strategy>=tn||t.level<2?4:0),ue(t,jb),t.status=qt,Xe(e),t.pending!==0)return t.last_flush=-1,Ne}if(t.status===Pi){if(t.gzhead.extra){let i=t.pending,o=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+o>t.pending_buf_size;){let l=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+l),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>i&&(e.adler=Re(e.adler,t.pending_buf,t.pending-i,i)),t.gzindex+=l,Xe(e),t.pending!==0)return t.last_flush=-1,Ne;i=0,o-=l}let a=new Uint8Array(t.gzhead.extra);t.pending_buf.set(a.subarray(t.gzindex,t.gzindex+o),t.pending),t.pending+=o,t.gzhead.hcrc&&t.pending>i&&(e.adler=Re(e.adler,t.pending_buf,t.pending-i,i)),t.gzindex=0}t.status=Ti}if(t.status===Ti){if(t.gzhead.name){let i=t.pending,o;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>i&&(e.adler=Re(e.adler,t.pending_buf,t.pending-i,i)),Xe(e),t.pending!==0)return t.last_flush=-1,Ne;i=0}t.gzindex<t.gzhead.name.length?o=t.gzhead.name.charCodeAt(t.gzindex++)&255:o=0,ue(t,o)}while(o!==0);t.gzhead.hcrc&&t.pending>i&&(e.adler=Re(e.adler,t.pending_buf,t.pending-i,i)),t.gzindex=0}t.status=$i}if(t.status===$i){if(t.gzhead.comment){let i=t.pending,o;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>i&&(e.adler=Re(e.adler,t.pending_buf,t.pending-i,i)),Xe(e),t.pending!==0)return t.last_flush=-1,Ne;i=0}t.gzindex<t.gzhead.comment.length?o=t.gzhead.comment.charCodeAt(t.gzindex++)&255:o=0,ue(t,o)}while(o!==0);t.gzhead.hcrc&&t.pending>i&&(e.adler=Re(e.adler,t.pending_buf,t.pending-i,i))}t.status=Ei}if(t.status===Ei){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(Xe(e),t.pending!==0))return t.last_flush=-1,Ne;ue(t,e.adler&255),ue(t,e.adler>>8&255),e.adler=0}if(t.status=qt,Xe(e),t.pending!==0)return t.last_flush=-1,Ne}if(e.avail_in!==0||t.lookahead!==0||r!==$t&&t.status!==Cr){let i=t.level===0?Cu(t,r):t.strategy===tn?Gb(t,r):t.strategy===Tb?Vb(t,r):Pr[t.level].func(t,r);if((i===Wt||i===dr)&&(t.status=Cr),i===Ue||i===Wt)return e.avail_out===0&&(t.last_flush=-1),Ne;if(i===ur&&(r===xb?kb(t):r!==Ca&&(Si(t,0,0,!1),r===_b&&(St(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),Xe(e),e.avail_out===0))return t.last_flush=-1,Ne}return r!==nt?Ne:t.wrap<=0?Pa:(t.wrap===2?(ue(t,e.adler&255),ue(t,e.adler>>8&255),ue(t,e.adler>>16&255),ue(t,e.adler>>24&255),ue(t,e.total_in&255),ue(t,e.total_in>>8&255),ue(t,e.total_in>>16&255),ue(t,e.total_in>>24&255)):(wr(t,e.adler>>>16),wr(t,e.adler&65535)),Xe(e),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?Ne:Pa)},Kb=e=>{if(Gr(e))return ft;const r=e.state.status;return e.state=null,r===qt?Vt(e,Sb):Ne},Jb=(e,r)=>{let t=r.length;if(Gr(e))return ft;const n=e.state,i=n.wrap;if(i===2||i===1&&n.status!==ar||n.lookahead)return ft;if(i===1&&(e.adler=Lr(e.adler,r,t,0)),n.wrap=0,t>=n.w_size){i===0&&(St(n.head),n.strstart=0,n.block_start=0,n.insert=0);let u=new Uint8Array(n.w_size);u.set(r.subarray(t-n.w_size,t),0),r=u,t=n.w_size}const o=e.avail_in,a=e.next_in,l=e.input;for(e.avail_in=t,e.next_in=0,e.input=r,sr(n);n.lookahead>=ae;){let u=n.strstart,s=n.lookahead-(ae-1);do n.ins_h=Et(n,n.ins_h,n.window[u+ae-1]),n.prev[u&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=u,u++;while(--s);n.strstart=u,n.lookahead=ae-1,sr(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=ae-1,n.match_available=0,e.next_in=a,e.input=l,e.avail_in=o,n.wrap=i,Ne};var Qb=Yb,ev=$u,tv=Tu,rv=Pu,nv=Wb,iv=Xb,ov=Kb,av=Jb,sv="pako deflate (from Nodeca project)",Ir={deflateInit:Qb,deflateInit2:ev,deflateReset:tv,deflateResetKeep:rv,deflateSetHeader:nv,deflate:iv,deflateEnd:ov,deflateSetDictionary:av,deflateInfo:sv};const lv=(e,r)=>Object.prototype.hasOwnProperty.call(e,r);var cv=function(e){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const t=r.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)lv(t,n)&&(e[n]=t[n])}}return e},uv=e=>{let r=0;for(let n=0,i=e.length;n<i;n++)r+=e[n].length;const t=new Uint8Array(r);for(let n=0,i=0,o=e.length;n<o;n++){let a=e[n];t.set(a,i),i+=a.length}return t},Tn={assign:cv,flattenChunks:uv};let Eu=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Eu=!1}const Ur=new Uint8Array(256);for(let e=0;e<256;e++)Ur[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Ur[254]=Ur[254]=1;var dv=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let r,t,n,i,o,a=e.length,l=0;for(i=0;i<a;i++)t=e.charCodeAt(i),(t&64512)===55296&&i+1<a&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),i++)),l+=t<128?1:t<2048?2:t<65536?3:4;for(r=new Uint8Array(l),o=0,i=0;o<l;i++)t=e.charCodeAt(i),(t&64512)===55296&&i+1<a&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),i++)),t<128?r[o++]=t:t<2048?(r[o++]=192|t>>>6,r[o++]=128|t&63):t<65536?(r[o++]=224|t>>>12,r[o++]=128|t>>>6&63,r[o++]=128|t&63):(r[o++]=240|t>>>18,r[o++]=128|t>>>12&63,r[o++]=128|t>>>6&63,r[o++]=128|t&63);return r};const pv=(e,r)=>{if(r<65534&&e.subarray&&Eu)return String.fromCharCode.apply(null,e.length===r?e:e.subarray(0,r));let t="";for(let n=0;n<r;n++)t+=String.fromCharCode(e[n]);return t};var fv=(e,r)=>{const t=r||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,r));let n,i;const o=new Array(t*2);for(i=0,n=0;n<t;){let a=e[n++];if(a<128){o[i++]=a;continue}let l=Ur[a];if(l>4){o[i++]=65533,n+=l-1;continue}for(a&=l===2?31:l===3?15:7;l>1&&n<t;)a=a<<6|e[n++]&63,l--;if(l>1){o[i++]=65533;continue}a<65536?o[i++]=a:(a-=65536,o[i++]=55296|a>>10&1023,o[i++]=56320|a&1023)}return pv(o,i)},hv=(e,r)=>{r=r||e.length,r>e.length&&(r=e.length);let t=r-1;for(;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?r:t+Ur[e[t]]>r?t:r},jr={string2buf:dv,buf2string:fv,utf8border:hv};function mv(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Iu=mv;const Ru=Object.prototype.toString,{Z_NO_FLUSH:gv,Z_SYNC_FLUSH:yv,Z_FULL_FLUSH:bv,Z_FINISH:vv,Z_OK:_n,Z_STREAM_END:wv,Z_DEFAULT_COMPRESSION:kv,Z_DEFAULT_STRATEGY:xv,Z_DEFLATED:_v}=cr;function Hr(e){this.options=Tn.assign({level:kv,method:_v,chunkSize:16384,windowBits:15,memLevel:8,strategy:xv},e||{});let r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Iu,this.strm.avail_out=0;let t=Ir.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(t!==_n)throw new Error(Zt[t]);if(r.header&&Ir.deflateSetHeader(this.strm,r.header),r.dictionary){let n;if(typeof r.dictionary=="string"?n=jr.string2buf(r.dictionary):Ru.call(r.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(r.dictionary):n=r.dictionary,t=Ir.deflateSetDictionary(this.strm,n),t!==_n)throw new Error(Zt[t]);this._dict_set=!0}}Hr.prototype.push=function(e,r){const t=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(r===~~r?o=r:o=r===!0?vv:gv,typeof e=="string"?t.input=jr.string2buf(e):Ru.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),(o===yv||o===bv)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(i=Ir.deflate(t,o),i===wv)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),i=Ir.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===_n;if(t.avail_out===0){this.onData(t.output);continue}if(o>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};Hr.prototype.onData=function(e){this.chunks.push(e)};Hr.prototype.onEnd=function(e){e===_n&&(this.result=Tn.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function lo(e,r){const t=new Hr(r);if(t.push(e,!0),t.err)throw t.msg||Zt[t.err];return t.result}function Sv(e,r){return r=r||{},r.raw=!0,lo(e,r)}function Cv(e,r){return r=r||{},r.gzip=!0,lo(e,r)}var Pv=Hr,Tv=lo,$v=Sv,Ev=Cv,Iv=cr,Rv={Deflate:Pv,deflate:Tv,deflateRaw:$v,gzip:Ev,constants:Iv};const rn=16209,Av=16191;var Mv=function(r,t){let n,i,o,a,l,u,s,c,p,f,d,h,m,g,y,b,w,v,k,_,S,P,T,$;const x=r.state;n=r.next_in,T=r.input,i=n+(r.avail_in-5),o=r.next_out,$=r.output,a=o-(t-r.avail_out),l=o+(r.avail_out-257),u=x.dmax,s=x.wsize,c=x.whave,p=x.wnext,f=x.window,d=x.hold,h=x.bits,m=x.lencode,g=x.distcode,y=(1<<x.lenbits)-1,b=(1<<x.distbits)-1;e:do{h<15&&(d+=T[n++]<<h,h+=8,d+=T[n++]<<h,h+=8),w=m[d&y];t:for(;;){if(v=w>>>24,d>>>=v,h-=v,v=w>>>16&255,v===0)$[o++]=w&65535;else if(v&16){k=w&65535,v&=15,v&&(h<v&&(d+=T[n++]<<h,h+=8),k+=d&(1<<v)-1,d>>>=v,h-=v),h<15&&(d+=T[n++]<<h,h+=8,d+=T[n++]<<h,h+=8),w=g[d&b];r:for(;;){if(v=w>>>24,d>>>=v,h-=v,v=w>>>16&255,v&16){if(_=w&65535,v&=15,h<v&&(d+=T[n++]<<h,h+=8,h<v&&(d+=T[n++]<<h,h+=8)),_+=d&(1<<v)-1,_>u){r.msg="invalid distance too far back",x.mode=rn;break e}if(d>>>=v,h-=v,v=o-a,_>v){if(v=_-v,v>c&&x.sane){r.msg="invalid distance too far back",x.mode=rn;break e}if(S=0,P=f,p===0){if(S+=s-v,v<k){k-=v;do $[o++]=f[S++];while(--v);S=o-_,P=$}}else if(p<v){if(S+=s+p-v,v-=p,v<k){k-=v;do $[o++]=f[S++];while(--v);if(S=0,p<k){v=p,k-=v;do $[o++]=f[S++];while(--v);S=o-_,P=$}}}else if(S+=p-v,v<k){k-=v;do $[o++]=f[S++];while(--v);S=o-_,P=$}for(;k>2;)$[o++]=P[S++],$[o++]=P[S++],$[o++]=P[S++],k-=3;k&&($[o++]=P[S++],k>1&&($[o++]=P[S++]))}else{S=o-_;do $[o++]=$[S++],$[o++]=$[S++],$[o++]=$[S++],k-=3;while(k>2);k&&($[o++]=$[S++],k>1&&($[o++]=$[S++]))}}else if(v&64){r.msg="invalid distance code",x.mode=rn;break e}else{w=g[(w&65535)+(d&(1<<v)-1)];continue r}break}}else if(v&64)if(v&32){x.mode=Av;break e}else{r.msg="invalid literal/length code",x.mode=rn;break e}else{w=m[(w&65535)+(d&(1<<v)-1)];continue t}break}}while(n<i&&o<l);k=h>>3,n-=k,h-=k<<3,d&=(1<<h)-1,r.next_in=n,r.next_out=o,r.avail_in=n<i?5+(i-n):5-(n-i),r.avail_out=o<l?257+(l-o):257-(o-l),x.hold=d,x.bits=h};const rr=15,$a=852,Ea=592,Ia=0,ti=1,Ra=2,Nv=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ov=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Fv=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),zv=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Dv=(e,r,t,n,i,o,a,l)=>{const u=l.bits;let s=0,c=0,p=0,f=0,d=0,h=0,m=0,g=0,y=0,b=0,w,v,k,_,S,P=null,T;const $=new Uint16Array(rr+1),x=new Uint16Array(rr+1);let I=null,F,N,R;for(s=0;s<=rr;s++)$[s]=0;for(c=0;c<n;c++)$[r[t+c]]++;for(d=u,f=rr;f>=1&&$[f]===0;f--);if(d>f&&(d=f),f===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,l.bits=1,0;for(p=1;p<f&&$[p]===0;p++);for(d<p&&(d=p),g=1,s=1;s<=rr;s++)if(g<<=1,g-=$[s],g<0)return-1;if(g>0&&(e===Ia||f!==1))return-1;for(x[1]=0,s=1;s<rr;s++)x[s+1]=x[s]+$[s];for(c=0;c<n;c++)r[t+c]!==0&&(a[x[r[t+c]]++]=c);if(e===Ia?(P=I=a,T=20):e===ti?(P=Nv,I=Ov,T=257):(P=Fv,I=zv,T=0),b=0,c=0,s=p,S=o,h=d,m=0,k=-1,y=1<<d,_=y-1,e===ti&&y>$a||e===Ra&&y>Ea)return 1;for(;;){F=s-m,a[c]+1<T?(N=0,R=a[c]):a[c]>=T?(N=I[a[c]-T],R=P[a[c]-T]):(N=96,R=0),w=1<<s-m,v=1<<h,p=v;do v-=w,i[S+(b>>m)+v]=F<<24|N<<16|R|0;while(v!==0);for(w=1<<s-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,c++,--$[s]===0){if(s===f)break;s=r[t+a[c]]}if(s>d&&(b&_)!==k){for(m===0&&(m=d),S+=p,h=s-m,g=1<<h;h+m<f&&(g-=$[h+m],!(g<=0));)h++,g<<=1;if(y+=1<<h,e===ti&&y>$a||e===Ra&&y>Ea)return 1;k=b&_,i[k]=d<<24|h<<16|S-o|0}}return b!==0&&(i[S+b]=s-m<<24|64<<16|0),l.bits=d,0};var Rr=Dv;const Lv=0,Au=1,Mu=2,{Z_FINISH:Aa,Z_BLOCK:Uv,Z_TREES:nn,Z_OK:Yt,Z_STREAM_END:jv,Z_NEED_DICT:Bv,Z_STREAM_ERROR:ot,Z_DATA_ERROR:Nu,Z_MEM_ERROR:Ou,Z_BUF_ERROR:qv,Z_DEFLATED:Ma}=cr,$n=16180,Na=16181,Oa=16182,Fa=16183,za=16184,Da=16185,La=16186,Ua=16187,ja=16188,Ba=16189,Sn=16190,yt=16191,ri=16192,qa=16193,ni=16194,Va=16195,Ga=16196,Ha=16197,Za=16198,on=16199,an=16200,Wa=16201,Ya=16202,Xa=16203,Ka=16204,Ja=16205,ii=16206,Qa=16207,es=16208,we=16209,Fu=16210,zu=16211,Vv=852,Gv=592,Hv=15,Zv=Hv,ts=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function Wv(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Qt=e=>{if(!e)return 1;const r=e.state;return!r||r.strm!==e||r.mode<$n||r.mode>zu?1:0},Du=e=>{if(Qt(e))return ot;const r=e.state;return e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=r.wrap&1),r.mode=$n,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(Vv),r.distcode=r.distdyn=new Int32Array(Gv),r.sane=1,r.back=-1,Yt},Lu=e=>{if(Qt(e))return ot;const r=e.state;return r.wsize=0,r.whave=0,r.wnext=0,Du(e)},Uu=(e,r)=>{let t;if(Qt(e))return ot;const n=e.state;return r<0?(t=0,r=-r):(t=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?ot:(n.window!==null&&n.wbits!==r&&(n.window=null),n.wrap=t,n.wbits=r,Lu(e))},ju=(e,r)=>{if(!e)return ot;const t=new Wv;e.state=t,t.strm=e,t.window=null,t.mode=$n;const n=Uu(e,r);return n!==Yt&&(e.state=null),n},Yv=e=>ju(e,Zv);let rs=!0,oi,ai;const Xv=e=>{if(rs){oi=new Int32Array(512),ai=new Int32Array(32);let r=0;for(;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(Rr(Au,e.lens,0,288,oi,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;Rr(Mu,e.lens,0,32,ai,0,e.work,{bits:5}),rs=!1}e.lencode=oi,e.lenbits=9,e.distcode=ai,e.distbits=5},Bu=(e,r,t,n)=>{let i;const o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(r.subarray(t-o.wsize,t),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(r.subarray(t-n,t-n+i),o.wnext),n-=i,n?(o.window.set(r.subarray(t-n,t),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},Kv=(e,r)=>{let t,n,i,o,a,l,u,s,c,p,f,d,h,m,g=0,y,b,w,v,k,_,S,P;const T=new Uint8Array(4);let $,x;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Qt(e)||!e.output||!e.input&&e.avail_in!==0)return ot;t=e.state,t.mode===yt&&(t.mode=ri),a=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,l=e.avail_in,s=t.hold,c=t.bits,p=l,f=u,P=Yt;e:for(;;)switch(t.mode){case $n:if(t.wrap===0){t.mode=ri;break}for(;c<16;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if(t.wrap&2&&s===35615){t.wbits===0&&(t.wbits=15),t.check=0,T[0]=s&255,T[1]=s>>>8&255,t.check=Re(t.check,T,2,0),s=0,c=0,t.mode=Na;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((s&255)<<8)+(s>>8))%31){e.msg="incorrect header check",t.mode=we;break}if((s&15)!==Ma){e.msg="unknown compression method",t.mode=we;break}if(s>>>=4,c-=4,S=(s&15)+8,t.wbits===0&&(t.wbits=S),S>15||S>t.wbits){e.msg="invalid window size",t.mode=we;break}t.dmax=1<<t.wbits,t.flags=0,e.adler=t.check=1,t.mode=s&512?Ba:yt,s=0,c=0;break;case Na:for(;c<16;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if(t.flags=s,(t.flags&255)!==Ma){e.msg="unknown compression method",t.mode=we;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=we;break}t.head&&(t.head.text=s>>8&1),t.flags&512&&t.wrap&4&&(T[0]=s&255,T[1]=s>>>8&255,t.check=Re(t.check,T,2,0)),s=0,c=0,t.mode=Oa;case Oa:for(;c<32;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}t.head&&(t.head.time=s),t.flags&512&&t.wrap&4&&(T[0]=s&255,T[1]=s>>>8&255,T[2]=s>>>16&255,T[3]=s>>>24&255,t.check=Re(t.check,T,4,0)),s=0,c=0,t.mode=Fa;case Fa:for(;c<16;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}t.head&&(t.head.xflags=s&255,t.head.os=s>>8),t.flags&512&&t.wrap&4&&(T[0]=s&255,T[1]=s>>>8&255,t.check=Re(t.check,T,2,0)),s=0,c=0,t.mode=za;case za:if(t.flags&1024){for(;c<16;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}t.length=s,t.head&&(t.head.extra_len=s),t.flags&512&&t.wrap&4&&(T[0]=s&255,T[1]=s>>>8&255,t.check=Re(t.check,T,2,0)),s=0,c=0}else t.head&&(t.head.extra=null);t.mode=Da;case Da:if(t.flags&1024&&(d=t.length,d>l&&(d=l),d&&(t.head&&(S=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(o,o+d),S)),t.flags&512&&t.wrap&4&&(t.check=Re(t.check,n,d,o)),l-=d,o+=d,t.length-=d),t.length))break e;t.length=0,t.mode=La;case La:if(t.flags&2048){if(l===0)break e;d=0;do S=n[o+d++],t.head&&S&&t.length<65536&&(t.head.name+=String.fromCharCode(S));while(S&&d<l);if(t.flags&512&&t.wrap&4&&(t.check=Re(t.check,n,d,o)),l-=d,o+=d,S)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Ua;case Ua:if(t.flags&4096){if(l===0)break e;d=0;do S=n[o+d++],t.head&&S&&t.length<65536&&(t.head.comment+=String.fromCharCode(S));while(S&&d<l);if(t.flags&512&&t.wrap&4&&(t.check=Re(t.check,n,d,o)),l-=d,o+=d,S)break e}else t.head&&(t.head.comment=null);t.mode=ja;case ja:if(t.flags&512){for(;c<16;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if(t.wrap&4&&s!==(t.check&65535)){e.msg="header crc mismatch",t.mode=we;break}s=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=yt;break;case Ba:for(;c<32;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}e.adler=t.check=ts(s),s=0,c=0,t.mode=Sn;case Sn:if(t.havedict===0)return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=l,t.hold=s,t.bits=c,Bv;e.adler=t.check=1,t.mode=yt;case yt:if(r===Uv||r===nn)break e;case ri:if(t.last){s>>>=c&7,c-=c&7,t.mode=ii;break}for(;c<3;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}switch(t.last=s&1,s>>>=1,c-=1,s&3){case 0:t.mode=qa;break;case 1:if(Xv(t),t.mode=on,r===nn){s>>>=2,c-=2;break e}break;case 2:t.mode=Ga;break;case 3:e.msg="invalid block type",t.mode=we}s>>>=2,c-=2;break;case qa:for(s>>>=c&7,c-=c&7;c<32;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if((s&65535)!==(s>>>16^65535)){e.msg="invalid stored block lengths",t.mode=we;break}if(t.length=s&65535,s=0,c=0,t.mode=ni,r===nn)break e;case ni:t.mode=Va;case Va:if(d=t.length,d){if(d>l&&(d=l),d>u&&(d=u),d===0)break e;i.set(n.subarray(o,o+d),a),l-=d,o+=d,u-=d,a+=d,t.length-=d;break}t.mode=yt;break;case Ga:for(;c<14;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if(t.nlen=(s&31)+257,s>>>=5,c-=5,t.ndist=(s&31)+1,s>>>=5,c-=5,t.ncode=(s&15)+4,s>>>=4,c-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=we;break}t.have=0,t.mode=Ha;case Ha:for(;t.have<t.ncode;){for(;c<3;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}t.lens[I[t.have++]]=s&7,s>>>=3,c-=3}for(;t.have<19;)t.lens[I[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,$={bits:t.lenbits},P=Rr(Lv,t.lens,0,19,t.lencode,0,t.work,$),t.lenbits=$.bits,P){e.msg="invalid code lengths set",t.mode=we;break}t.have=0,t.mode=Za;case Za:for(;t.have<t.nlen+t.ndist;){for(;g=t.lencode[s&(1<<t.lenbits)-1],y=g>>>24,b=g>>>16&255,w=g&65535,!(y<=c);){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if(w<16)s>>>=y,c-=y,t.lens[t.have++]=w;else{if(w===16){for(x=y+2;c<x;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if(s>>>=y,c-=y,t.have===0){e.msg="invalid bit length repeat",t.mode=we;break}S=t.lens[t.have-1],d=3+(s&3),s>>>=2,c-=2}else if(w===17){for(x=y+3;c<x;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}s>>>=y,c-=y,S=0,d=3+(s&7),s>>>=3,c-=3}else{for(x=y+7;c<x;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}s>>>=y,c-=y,S=0,d=11+(s&127),s>>>=7,c-=7}if(t.have+d>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=we;break}for(;d--;)t.lens[t.have++]=S}}if(t.mode===we)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=we;break}if(t.lenbits=9,$={bits:t.lenbits},P=Rr(Au,t.lens,0,t.nlen,t.lencode,0,t.work,$),t.lenbits=$.bits,P){e.msg="invalid literal/lengths set",t.mode=we;break}if(t.distbits=6,t.distcode=t.distdyn,$={bits:t.distbits},P=Rr(Mu,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,$),t.distbits=$.bits,P){e.msg="invalid distances set",t.mode=we;break}if(t.mode=on,r===nn)break e;case on:t.mode=an;case an:if(l>=6&&u>=258){e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=l,t.hold=s,t.bits=c,Mv(e,f),a=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,l=e.avail_in,s=t.hold,c=t.bits,t.mode===yt&&(t.back=-1);break}for(t.back=0;g=t.lencode[s&(1<<t.lenbits)-1],y=g>>>24,b=g>>>16&255,w=g&65535,!(y<=c);){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if(b&&!(b&240)){for(v=y,k=b,_=w;g=t.lencode[_+((s&(1<<v+k)-1)>>v)],y=g>>>24,b=g>>>16&255,w=g&65535,!(v+y<=c);){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}s>>>=v,c-=v,t.back+=v}if(s>>>=y,c-=y,t.back+=y,t.length=w,b===0){t.mode=Ja;break}if(b&32){t.back=-1,t.mode=yt;break}if(b&64){e.msg="invalid literal/length code",t.mode=we;break}t.extra=b&15,t.mode=Wa;case Wa:if(t.extra){for(x=t.extra;c<x;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}t.length+=s&(1<<t.extra)-1,s>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Ya;case Ya:for(;g=t.distcode[s&(1<<t.distbits)-1],y=g>>>24,b=g>>>16&255,w=g&65535,!(y<=c);){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if(!(b&240)){for(v=y,k=b,_=w;g=t.distcode[_+((s&(1<<v+k)-1)>>v)],y=g>>>24,b=g>>>16&255,w=g&65535,!(v+y<=c);){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}s>>>=v,c-=v,t.back+=v}if(s>>>=y,c-=y,t.back+=y,b&64){e.msg="invalid distance code",t.mode=we;break}t.offset=w,t.extra=b&15,t.mode=Xa;case Xa:if(t.extra){for(x=t.extra;c<x;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}t.offset+=s&(1<<t.extra)-1,s>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=we;break}t.mode=Ka;case Ka:if(u===0)break e;if(d=f-u,t.offset>d){if(d=t.offset-d,d>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=we;break}d>t.wnext?(d-=t.wnext,h=t.wsize-d):h=t.wnext-d,d>t.length&&(d=t.length),m=t.window}else m=i,h=a-t.offset,d=t.length;d>u&&(d=u),u-=d,t.length-=d;do i[a++]=m[h++];while(--d);t.length===0&&(t.mode=an);break;case Ja:if(u===0)break e;i[a++]=t.length,u--,t.mode=an;break;case ii:if(t.wrap){for(;c<32;){if(l===0)break e;l--,s|=n[o++]<<c,c+=8}if(f-=u,e.total_out+=f,t.total+=f,t.wrap&4&&f&&(e.adler=t.check=t.flags?Re(t.check,i,f,a-f):Lr(t.check,i,f,a-f)),f=u,t.wrap&4&&(t.flags?s:ts(s))!==t.check){e.msg="incorrect data check",t.mode=we;break}s=0,c=0}t.mode=Qa;case Qa:if(t.wrap&&t.flags){for(;c<32;){if(l===0)break e;l--,s+=n[o++]<<c,c+=8}if(t.wrap&4&&s!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=we;break}s=0,c=0}t.mode=es;case es:P=jv;break e;case we:P=Nu;break e;case Fu:return Ou;case zu:default:return ot}return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=l,t.hold=s,t.bits=c,(t.wsize||f!==e.avail_out&&t.mode<we&&(t.mode<ii||r!==Aa))&&Bu(e,e.output,e.next_out,f-e.avail_out),p-=e.avail_in,f-=e.avail_out,e.total_in+=p,e.total_out+=f,t.total+=f,t.wrap&4&&f&&(e.adler=t.check=t.flags?Re(t.check,i,f,e.next_out-f):Lr(t.check,i,f,e.next_out-f)),e.data_type=t.bits+(t.last?64:0)+(t.mode===yt?128:0)+(t.mode===on||t.mode===ni?256:0),(p===0&&f===0||r===Aa)&&P===Yt&&(P=qv),P},Jv=e=>{if(Qt(e))return ot;let r=e.state;return r.window&&(r.window=null),e.state=null,Yt},Qv=(e,r)=>{if(Qt(e))return ot;const t=e.state;return t.wrap&2?(t.head=r,r.done=!1,Yt):ot},e0=(e,r)=>{const t=r.length;let n,i,o;return Qt(e)||(n=e.state,n.wrap!==0&&n.mode!==Sn)?ot:n.mode===Sn&&(i=1,i=Lr(i,r,t,0),i!==n.check)?Nu:(o=Bu(e,r,t,t),o?(n.mode=Fu,Ou):(n.havedict=1,Yt))};var t0=Lu,r0=Uu,n0=Du,i0=Yv,o0=ju,a0=Kv,s0=Jv,l0=Qv,c0=e0,u0="pako inflate (from Nodeca project)",vt={inflateReset:t0,inflateReset2:r0,inflateResetKeep:n0,inflateInit:i0,inflateInit2:o0,inflate:a0,inflateEnd:s0,inflateGetHeader:l0,inflateSetDictionary:c0,inflateInfo:u0};function d0(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var p0=d0;const qu=Object.prototype.toString,{Z_NO_FLUSH:f0,Z_FINISH:h0,Z_OK:Br,Z_STREAM_END:si,Z_NEED_DICT:li,Z_STREAM_ERROR:m0,Z_DATA_ERROR:ns,Z_MEM_ERROR:g0}=cr;function Zr(e){this.options=Tn.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15||(r.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Iu,this.strm.avail_out=0;let t=vt.inflateInit2(this.strm,r.windowBits);if(t!==Br)throw new Error(Zt[t]);if(this.header=new p0,vt.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=jr.string2buf(r.dictionary):qu.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(t=vt.inflateSetDictionary(this.strm,r.dictionary),t!==Br)))throw new Error(Zt[t])}Zr.prototype.push=function(e,r){const t=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,a,l;if(this.ended)return!1;for(r===~~r?a=r:a=r===!0?h0:f0,qu.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),o=vt.inflate(t,a),o===li&&i&&(o=vt.inflateSetDictionary(t,i),o===Br?o=vt.inflate(t,a):o===ns&&(o=li));t.avail_in>0&&o===si&&t.state.wrap>0&&e[t.next_in]!==0;)vt.inflateReset(t),o=vt.inflate(t,a);switch(o){case m0:case ns:case li:case g0:return this.onEnd(o),this.ended=!0,!1}if(l=t.avail_out,t.next_out&&(t.avail_out===0||o===si))if(this.options.to==="string"){let u=jr.utf8border(t.output,t.next_out),s=t.next_out-u,c=jr.buf2string(t.output,u);t.next_out=s,t.avail_out=n-s,s&&t.output.set(t.output.subarray(u,u+s),0),this.onData(c)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(o===Br&&l===0)){if(o===si)return o=vt.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Zr.prototype.onData=function(e){this.chunks.push(e)};Zr.prototype.onEnd=function(e){e===Br&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Tn.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function co(e,r){const t=new Zr(r);if(t.push(e),t.err)throw t.msg||Zt[t.err];return t.result}function y0(e,r){return r=r||{},r.raw=!0,co(e,r)}var b0=Zr,v0=co,w0=y0,k0=co,x0=cr,_0={Inflate:b0,inflate:v0,inflateRaw:w0,ungzip:k0,constants:x0};const{Deflate:uw,deflate:dw,deflateRaw:pw,gzip:S0}=Rv,{Inflate:fw,inflate:hw,inflateRaw:mw,ungzip:C0}=_0;var P0=S0,T0=C0,$0=Z('<label class="input input-sm">Scale:<input type=text>'),E0=Z('<div><div><div></div><div><canvas></canvas><div><label class="input input-sm">Max Iter:<input type=text></label><label class="input input-sm">Tol:<input type=text></label><label class="input input-sm">MxStp:<input type=text>'),I0=Z('<ul class="menu dropdown-content bg-base-100 rounded-box z-1 w-52 p-2 shadow-sm"><li><a>Export To Clipboard</a></li><li><a>Import From Clipboard'),R0=Z("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Show Code"),A0=Z('<select class="select select-sm"style=width:fit-content;>'),M0=Z("<option>"),N0=Z("<div><pre>");const Vu=50,O0=e=>{let[r,t]=Fi(e,["world"]);const n=["Orthogonal","Perspective"];let[i,o]=Me({windowWidth:window.innerWidth,windowHeight:window.innerHeight,showCode:!1,projection:"Perspective",orthoScaleText:"0.1",maxIterationsText:"20",tolleranceText:"10.0",maxStepText:"20000.0"}),a=new qy({initSpace:Fe.create(j.create(0,0,1e4),be.identity),initOrbitTarget:j.zero}),[l,u]=K(),s=C(()=>{let x=Number.parseFloat(i.orthoScaleText);return Number.isNaN(x)?.1:x}),c=C(()=>{let x=Number.parseInt(i.maxIterationsText);return Number.isNaN(x)?100:x}),p=C(()=>{let x=Number.parseFloat(i.tolleranceText);return Number.isNaN(x)?.01:x}),f=C(()=>{let x=Number.parseFloat(i.maxStepText);return Number.isNaN(x)?1e4:x});window.addEventListener("resize",()=>{Le(()=>{o("windowWidth",window.innerWidth),o("windowHeight",window.innerHeight)})});let d=C(()=>i.windowWidth>i.windowHeight),[h,m]=K(),g=C(()=>{let x=h();if(x!=null)return jy({nodesSystem:x,maxIterations:c()})}),[y,b]=K(),[w,v]=K(),[k,_]=K();Ce(se([y,w],([x,I])=>{if(x==null||I==null)return;let F=x.getBoundingClientRect();I.width=F.width*window.devicePixelRatio,I.height=F.height*window.devicePixelRatio,I.style.setProperty("background-color","darkblue");let N=I.getContext("webgl");N!=null&&_(N)}));let S,P;{let x=!1;P=()=>{let I=k();if(I==null||S==null)return;let F=S;x||(x=!0,requestAnimationFrame(()=>{x=!1,I.bindBuffer(I.ARRAY_BUFFER,F.verticesGLBuffer),I.enableVertexAttribArray(F.positionLocation),I.drawArrays(I.TRIANGLES,0,6),I.disableVertexAttribArray(F.positionLocation)}))}}Ce(se([k,w],([x,I])=>{if(x==null||I==null)return;let F=g();F!=null&&(S=z0(x,I,a,F))})),Ce(se([k,g],([x,I])=>{if(h()==null)return;let N=w();if(N==null)return;let R=N.width,O=N.height;const L=.5*O/Math.tan(.5*Vu*Math.PI/180);if(S==null||x==null||I==null)return;let B=Ri(x,x.FRAGMENT_SHADER,it.toString(I.code));if(B==null)return;if(x.detachShader(S.shaderProgram,S.fragmentShader),x.deleteShader(S.fragmentShader),S.fragmentShader=B,x.attachShader(S.shaderProgram,S.fragmentShader),x.linkProgram(S.shaderProgram),!x.getProgramParameter(S.shaderProgram,x.LINK_STATUS)){console.error("ERROR linking program:",x.getProgramInfoLog(S.shaderProgram));return}let U=S.shaderProgram;x.useProgram(U);const H=x.getAttribLocation(U,"aVertexPosition"),ne=x.getUniformLocation(U,"uTollerance"),ce=x.getUniformLocation(U,"uMaxStep"),fe=x.getUniformLocation(U,"uFocalLength"),z=x.getUniformLocation(U,"uModelViewMatrix"),oe=x.getUniformLocation(U,"resolution"),ye=x.getUniformLocation(U,"uUseOrthogonalProjection"),he=x.getUniformLocation(U,"uOrthogonalScale");S.tolleranceLocation=ne,S.maxStepLocation=ce,S.inverseViewMatrixLocation=x.getUniformLocation(U,"uInverseViewMatrix"),S.useOrthogonalProjectionLocation=ye,S.orthogonalProjectionScaleLocation=he,a.writeGLInverseViewMatrix(S.inverseViewMatrix),x.uniformMatrix4fv(S.inverseViewMatrixLocation,!1,S.inverseViewMatrix),x.uniform1i(ye,i.projection=="Orthogonal"?1:0),x.uniform1f(ne,p()),x.uniform1f(ce,f()),x.uniform1f(he,s()),x.uniform1f(fe,L),x.uniform2f(oe,R,O),I.onInit({gl:x,program:U,rerender:P});const q=S.vertices;q[0]=0,q[1]=0,q[2]=R,q[3]=0,q[4]=R,q[5]=O,q[6]=0,q[7]=0,q[8]=R,q[9]=O,q[10]=0,q[11]=O;let re=S.verticesGLBuffer;x.bindBuffer(x.ARRAY_BUFFER,re),x.bufferData(x.ARRAY_BUFFER,q,x.DYNAMIC_DRAW),x.vertexAttribPointer(H,2,x.FLOAT,!1,0,0);function pe(et,at,Mt,tt){var le=-1,rt=1,wt=at-et,kt=tt-Mt,A=rt-le;return[2/wt,0,0,0,0,2/kt,0,0,0,0,-2/A,0,-(at+et)/wt,-(tt+Mt)/kt,-(rt+le)/A,1]}const Oe=new Float32Array(pe(0,R,0,O));x.uniformMatrix4fv(z,!1,Oe),x.viewport(0,0,R,O),x.enableVertexAttribArray(H),x.drawArrays(x.TRIANGLES,0,6),x.disableVertexAttribArray(H)},{defer:!0})),Ce(se(()=>i.projection,x=>{let I=k();if(I!=null&&S!=null){switch(x){case"Orthogonal":I.uniform1i(S.useOrthogonalProjectionLocation,1);break;case"Perspective":I.uniform1i(S.useOrthogonalProjectionLocation,0);break}P()}},{defer:!0})),Ce(se(p,x=>{let I=k();I!=null&&S!=null&&(I.uniform1f(S.tolleranceLocation,x),P())},{defer:!0})),Ce(se(f,x=>{let I=k();I!=null&&S!=null&&(I.uniform1f(S.maxStepLocation,x),P())},{defer:!0})),Ce(se(s,x=>{let I=k();I!=null&&S!=null&&(I.uniform1f(S.orthogonalProjectionScaleLocation,x),P())},{defer:!0})),Ce(se(()=>a.space(),()=>{let x=k();x!=null&&S!=null&&(a.writeGLInverseViewMatrix(S.inverseViewMatrix),x.uniformMatrix4fv(S.inverseViewMatrixLocation,!1,S.inverseViewMatrix),P())},{defer:!0}));let T=async()=>{let x=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/,I=new Map,F=0;for(let L of r.world.entities())x.test(L)&&I.set(L,`${F++}`);let N=JSON.stringify(r.world.toJson());for(let[L,B]of I.entries())N=N.replaceAll(L,B);let R=P0(N),O=fl(R);await window.navigator.clipboard.writeText(O)},$=async()=>{try{let x=await window.navigator.clipboard.readText(),I=hl(x),F=T0(I),R=new TextDecoder("utf-8").decode(F),O=JSON.parse(R),L=Rt.fromJson(ya,O);if(L.type=="Err")throw new Error(L.message);let B=L.value;Le(()=>{let U=r.world;for(let H of[...U.entities()])U.destroyEntity(H);for(let H of B.entities()){let ne=B.getComponents(H);U.createEntityWithId(H,ne)}})}catch(x){console.log(x),alert("Failed to read clipboard.")}};return(()=>{var x=E0(),I=x.firstChild,F=I.firstChild,N=F.nextSibling,R=N.firstChild,O=R.nextSibling,L=O.firstChild,B=L.firstChild,U=B.nextSibling,H=L.nextSibling,ne=H.firstChild,ce=ne.nextSibling,fe=H.nextSibling,z=fe.firstChild,oe=z.nextSibling;Mi(x,t,!1,!0),I.style.setProperty("width","100%"),I.style.setProperty("height","100%"),I.style.setProperty("position","relative"),I.style.setProperty("display","flex"),F.style.setProperty("flex","1"),F.style.setProperty("display","flex"),F.style.setProperty("overflow","hidden"),Y(F,M(bl,{style:{"flex-grow":"1"},onInit:q=>{m(q.nodesSystem),u(q)},componentRegistry:ya,nodeRegistry:lu,get world(){return r.world},get menu(){return(()=>{var q=I0(),re=q.firstChild,pe=re.firstChild,Oe=re.nextSibling,et=Oe.firstChild;return pe.$$click=()=>{T(),l()?.closeMenu()},et.$$click=()=>{$(),l()?.closeMenu()},q})()},get toolbar(){return[(()=>{var q=R0(),re=q.firstChild;return re.addEventListener("change",pe=>o("showCode",pe.currentTarget.checked)),Q(()=>re.checked=i.showCode),q})(),(()=>{var q=A0();return q.addEventListener("change",re=>{if(re.currentTarget.selectedOptions.length!=1)return;let pe=re.currentTarget.selectedOptions[0].value;o("projection",pe)}),Y(q,M(st,{each:n,children:re=>(()=>{var pe=M0();return pe.value=re,Y(pe,re),Q(()=>pe.selected=i.projection==re),pe})()})),q})()]}}));var ye=b;typeof ye=="function"?ve(ye,N):b=N,N.style.setProperty("flex","1"),N.style.setProperty("display","flex"),N.style.setProperty("overflow","hidden"),N.style.setProperty("position","relative"),R.$$pointermove=q=>{a.pointerMove(q)},R.$$pointerup=q=>{a.pointerUp(q)},R.$$pointerdown=q=>{a.pointerDown(q)};var he=v;return typeof he=="function"?ve(he,R):v=R,R.style.setProperty("flex-grow","1"),R.style.setProperty("touch-action","none"),Y(N,M(de,{get when(){return C(()=>!!i.showCode)()?g():void 0},children:q=>(()=>{var re=N0(),pe=re.firstChild;return re.style.setProperty("position","absolute"),re.style.setProperty("right","0"),re.style.setProperty("top","0"),re.style.setProperty("bottom","0"),re.style.setProperty("overflow","auto"),re.style.setProperty("width","50%"),Q(()=>pe.innerText=it.toString(q().code)),re})()}),O),O.style.setProperty("position","absolute"),O.style.setProperty("left","0"),O.style.setProperty("top","0"),Y(O,M(de,{get when(){return i.projection=="Orthogonal"},get children(){var q=$0(),re=q.firstChild,pe=re.nextSibling;return q.style.setProperty("width","100px"),pe.$$input=Oe=>{o("orthoScaleText",Oe.currentTarget.value)},Q(()=>pe.value=i.orthoScaleText),q}}),L),L.style.setProperty("width","100px"),U.$$input=q=>{o("maxIterationsText",q.currentTarget.value)},H.style.setProperty("width","100px"),ce.$$input=q=>{o("tolleranceText",q.currentTarget.value)},fe.style.setProperty("width","120px"),oe.$$input=q=>{o("maxStepText",q.currentTarget.value)},Q(q=>(q=d()?"row":"column-reverse")!=null?I.style.setProperty("flex-direction",q):I.style.removeProperty("flex-direction")),Q(()=>U.value=i.maxIterationsText),Q(()=>ce.value=i.tolleranceText),Q(()=>oe.value=i.maxStepText),x})()};function Ri(e,r,t){const n=e.createShader(r);if(n!=null){if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(n)),e.deleteShader(n);return}return n}}function F0(e,r,t){const n=Ri(e,e.VERTEX_SHADER,r);if(n==null)return;const i=Ri(e,e.FRAGMENT_SHADER,t);if(i==null){e.deleteShader(n);return}const o=e.createProgram();if(e.attachShader(o,n),e.attachShader(o,i),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS)){console.error("Unable to initialize the shader program: "+e.getProgramInfoLog(o)),e.detachShader(o,n),e.detachShader(o,i),e.deleteShader(n),e.deleteShader(i),e.deleteProgram(o);return}return{vertexShader:n,fragmentShader:i,shaderProgram:o}}function z0(e,r,t,n){let i=r.width,o=r.height;const a=.5*o/Math.tan(.5*Vu*Math.PI/180);let l,u,s;{const T=F0(e,`attribute vec4 aVertexPosition;

  uniform mat4 uModelViewMatrix;

  void main(void) {
    gl_Position = uModelViewMatrix * aVertexPosition;
  }
  `,it.toString(n.code));if(T==null)return;l=T.vertexShader,u=T.fragmentShader,s=T.shaderProgram}e.useProgram(s);const c=e.getAttribLocation(s,"aVertexPosition"),p=e.getUniformLocation(s,"uTollerance"),f=e.getUniformLocation(s,"uMaxStep"),d=e.getUniformLocation(s,"uFocalLength"),h=e.getUniformLocation(s,"uModelViewMatrix"),m=e.getUniformLocation(s,"resolution"),g=e.getUniformLocation(s,"uInverseViewMatrix"),y=e.getUniformLocation(s,"uUseOrthogonalProjection"),b=e.getUniformLocation(s,"uOrthogonalScale");let w=new Float32Array(16);me(()=>t.writeGLInverseViewMatrix(w)),e.uniformMatrix4fv(g,!1,w),e.uniform1i(y,0),e.uniform1f(b,.1),e.uniform1f(d,a),e.uniform2f(m,i,o);const v=new Float32Array(12);v[0]=0,v[1]=0,v[2]=i,v[3]=0,v[4]=i,v[5]=o,v[6]=0,v[7]=0,v[8]=i,v[9]=o,v[10]=0,v[11]=o;let k=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,k),e.bufferData(e.ARRAY_BUFFER,v,e.DYNAMIC_DRAW),e.vertexAttribPointer(c,2,e.FLOAT,!1,0,0);function _(T,$,x,I){var F=-1,N=1,R=$-T,O=I-x,L=N-F;return[2/R,0,0,0,0,2/O,0,0,0,0,-2/L,0,-($+T)/R,-(I+x)/O,-(N+F)/L,1]}const S=new Float32Array(_(0,i,0,o));return e.uniformMatrix4fv(h,!1,S),e.viewport(0,0,i,o),e.enableVertexAttribArray(c),e.drawArrays(e.TRIANGLES,0,6),e.disableVertexAttribArray(c),{width:r.width,height:r.height,positionLocation:c,verticesGLBuffer:k,vertices:v,vertexShader:l,fragmentShader:u,shaderProgram:s,tolleranceLocation:p,maxStepLocation:f,inverseViewMatrix:w,inverseViewMatrixLocation:g,useOrthogonalProjectionLocation:y,orthogonalProjectionScaleLocation:b}}$e(["pointerdown","pointerup","pointermove","input","click"]);var D0=Z("<div>");const L0=qe(()=>Be(()=>import("./CodeMirror-Cp4M-tSB.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),U0=qe(()=>Be(()=>import("./AppV2-Czx9TzPz.js"),__vite__mapDeps([5,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,0,21]),import.meta.url)),j0=qe(()=>Be(()=>import("./KittyDemo-CDb76M4C.js"),__vite__mapDeps([22,1,2,3,4,12,13,17]),import.meta.url)),B0=qe(()=>Be(()=>import("./PixelEditor-DGvm_DMy.js"),__vite__mapDeps([6,1,2,3,4,7]),import.meta.url)),q0=qe(()=>Be(()=>import("./lib-B0KXb3kF.js").then(e=>e._),__vite__mapDeps([1,2,3,4]),import.meta.url)),V0=qe(()=>Be(()=>import("./ScriptEditor-CnveHCsF.js"),__vite__mapDeps([8,1,2,3,4]),import.meta.url)),G0=qe(()=>Be(()=>import("./ColourPicker-Dch4C5kZ.js").then(e=>e.b),__vite__mapDeps([7,1,2,3,4]),import.meta.url)),H0=qe(()=>Be(()=>import("./ReactiveSimulator-BJmldc9l.js"),__vite__mapDeps([23,1,2,3,4]),import.meta.url)),Z0=qe(()=>Be(()=>import("./VectorEditor-DIbet-a-.js"),__vite__mapDeps([24,1,2,3,4]),import.meta.url)),W0=qe(()=>Be(()=>import("./GravityTest-Dl3GkS9z.js"),__vite__mapDeps([25,1,2,3,4]),import.meta.url)),Y0=qe(()=>Be(()=>import("./ThreeBody-CHmZOjlU.js"),__vite__mapDeps([26,1,2,3,4]),import.meta.url)),X0=qe(()=>Be(()=>import("./VirtualFileSystemTest-D8wFMUEt.js"),__vite__mapDeps([27,1,2,3,4]),import.meta.url)),K0=qe(()=>Be(()=>import("./AutomergeWebRtcTest-BYCGml_W.js"),__vite__mapDeps([28,1,2,3,4]),import.meta.url)),J0=qe(()=>Be(()=>import("./DebugProjection-D1jchVOu.js"),__vite__mapDeps([29,1,2,3,4]),import.meta.url)),Q0=qe(()=>Be(()=>import("./AutoFormsTest-Tb85Oz9c.js"),__vite__mapDeps([30,1,2,3,4]),import.meta.url)),ew=document.getElementById("root");os(()=>{let e=new URLSearchParams(window.location.search),r=window.localStorage.getItem("lastDocUrl"),t=e.get("docUrl")??r,[n,i]=K(!1),o=new Wu({storage:new Yu,network:[]}),a;if(t==null||!fo(t)){let g=o.create(ho.makeEmptyState(o));window.localStorage.setItem("lastDocUrl",g.url),a=()=>g}else{let[g]=ed(()=>o.find(t));a=g}let l=C(()=>{let[g,y]=K(a());return{doc:g,setDoc:y}}),u=C(()=>l().doc()),s=g=>{me(()=>l().setDoc(g))},c=C(()=>a()?.url),p=Cp({documentUrl:c,setDocumentUrl:async g=>{if(!fo(g))return;let y=await o.find(g);s(y)}}),f=p.connections.bind(p),d=C(It(f,g=>new Pp({connection:g.conn})));ge(It(d,g=>{o.networkSubsystem.addNetworkAdapter(g),Te(()=>{})}));let h=C(()=>{let g=u();return new ho({repo:o,docHandle:()=>g})}),m=()=>M(Fd,{onShareVfs:()=>{let g=a();if(g==null)return;const y=new URL(window.location.href);y.searchParams.set("docUrl",g.url);let b=y.toString();window.history.pushState(null,"",b),navigator.clipboard.writeText(b)},onDeleteVfs:()=>{window.localStorage.removeItem("lastDocUrl"),indexedDB.deleteDatabase("automerge"),window.location.reload()},get vfs(){return h()}});return M(Ed,{get children(){return[M(Ee,{path:"/",component:m}),M(Ee,{path:"/kitty-demo",component:j0}),M(Ee,{path:"/pixel-editor",component:()=>M(B0,{})}),M(Ee,{path:"/level-builder",component:()=>M(q0,{get vfs(){return h()}})}),M(Ee,{path:"/script-editor",component:()=>M(V0,{})}),M(Ee,{path:"/music-editor",component:wm}),M(Ee,{path:"/model-editor",component:()=>M(O0,{style:"flex-grow: 1; overflow: hidden;",world:new Rt})}),M(Ee,{path:"/code-mirror",component:()=>M(L0,{})}),M(Ee,{path:"/colour-picker",component:()=>(()=>{var g=D0();return g.style.setProperty("width","300px"),g.style.setProperty("height","300px"),g.style.setProperty("display","flex"),g.style.setProperty("flex-direction","column"),g.style.setProperty("margin-left","20px"),g.style.setProperty("margin-top","20px"),Y(g,M(G0,{})),g})()}),M(Ee,{path:"/reactive-sim",component:H0}),M(Ee,{path:"/vector-editor",component:Z0}),M(Ee,{path:"/gravity-test",component:W0}),M(Ee,{path:"/three-body",component:Y0}),M(Ee,{path:"/vfs-test",component:X0}),M(Ee,{path:"/automerge-webrtc-test",component:K0}),M(Ee,{path:"/connection-management",get component(){return p.Render}}),M(Ee,{path:"/debug-projection",component:J0}),M(Ee,{path:"/app",component:()=>M(de,{get when(){return u()},children:g=>M(U0,{get vfsDocUrl(){return g().url},get vfs(){return h()},get ConnectionManagementUi(){return p.Render},get broadcastNetworkAdapterIsEnabled(){return n()},enableBroadcastNetworkAdapter:()=>{o.networkSubsystem.addNetworkAdapter(new Xu),i(!0)},flushRepo:()=>o.flush()})})}),M(Ee,{path:"/auto-forms-test",component:Q0})]}})},ew);const gw=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{Ao as $,vs as F,Ad as a,gw as b,aw as e,P0 as g,Md as i,T0 as u};
