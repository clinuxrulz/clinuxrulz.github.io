const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TypeScriptUI-CYrtd8I9.js","./lib-CvNVz1PI.js","./index-XNH-lkY3.js","./dev-B9-ass9r.js","./dev-CC7pdsS5.js","./index-DTYtQKXs.js","./index-BFsIGCf5.js","./CodeMirror-CA44buzz.js","./AppV2-6iBXJVSH.js","./PixelEditor-ocA06Brg.js","./ColourPicker-l30c-hik.js","./ScriptEditor-BZAKKYP-.js","./solid-js-C16mITwu.js","./pixi-js-CTVzrHHI.js","./FederatedEventTarget-DFQx8mKK.js","./Filter-BDK7ILDO.js","./State-3sV0XrC-.js","./CanvasTextSystem-BKHjFPHo.js","./colorToUniform-W8Zlj3HA.js","./SharedSystems-BwGi1NkL.js","./AnimatedSprite-CrPahPC5.js","./WebGLRenderer-DzfsPnmv.js","./WebGPURenderer-DziseXTR.js","./solid-js-store-D4PqY48D.js","./AppV2-DQoE4ujd.css","./KittyDemo-GDtrhFg8.js","./ReactiveSimulator-BW2q9A_Z.js","./VectorEditor-B6oQYpvV.js","./GravityTest-RbUe9lch.js","./ThreeBody-D8QpECIq.js","./VirtualFileSystemTest-BfLK2tIl.js","./AutomergeWebRtcTest-EIuBMbbm.js","./DebugProjection-BdCVffaU.js","./AutoFormsTest-BSZKGVDW.js"])))=>i.map(i=>d[i]);
import{dG as tn,i as Nn,d as cf,_ as Ge,dH as uf}from"./index-XNH-lkY3.js";import{M as df,d as Oe,J as Ql,x as it,y as Te,i as te,u as Ce,t as Y,N as rn,R as Jt,P as gt,Vec2 as lo,v as Ht,s as ae,Q as ec,n as Ao,j as pa,b as pf,W as ff,X as fa,Y as ha,Z as hf}from"./lib-CvNVz1PI.js";import{U as tc,q as E,C as Mo,n as rc,Z as nc,c as oe,s as le,N as he,X as mf,T as gf,b as Be,Y as ye,l as D,k as ic,K as yf,S as ge,u as Mt,O as Ne,V as zn,m as ve,F as pt,h as An,M as $t,J as zt,Q as Sn,p as Re,H as We,W as Oo,t as bf}from"./dev-B9-ass9r.js";import{a as je,p as Tr}from"./dev-CC7pdsS5.js";function vf(t,r){for(var e=0;e<r.length;e++){const i=r[e];if(typeof i!="string"&&!Array.isArray(i)){for(const n in i)if(n!=="default"&&!(n in t)){const o=Object.getOwnPropertyDescriptor(i,n);o&&Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:()=>i[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}function oc(){let t=new Set;function r(n){return t.add(n),()=>t.delete(n)}let e=!1;function i(n,o){if(e)return!(e=!1);const a={to:n,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const l of t)l.listener({...a,from:l.location,retry:u=>{u&&(e=!0),l.navigate(n,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:r,confirm:i}}let co;function Fo(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),co=window.history.state._depth}Fo();function wf(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function kf(t,r){let e=!1;return()=>{const i=co;Fo();const n=i==null?null:co-i;if(e){e=!1;return}n&&r(n)?(e=!0,window.history.go(-n)):t()}}const xf=/^(?:[a-z0-9]+:)?\/\//i,_f=/^\/+|(\/)\/+$/g,ac="http://sr";function Ar(t,r=!1){const e=t.replace(_f,"$1");return e?r||/^[?#]/.test(e)?e:"/"+e:""}function fn(t,r,e){if(xf.test(r))return;const i=Ar(t),n=e&&Ar(e);let o="";return!n||r.startsWith("/")?o=i:n.toLowerCase().indexOf(i.toLowerCase())!==0?o=i+n:o=n,(o||"/")+Ar(r,!o)}function Sf(t,r){if(t==null)throw new Error(r);return t}function Cf(t,r){return Ar(t).replace(/\/*(\*.*)?$/g,"")+Ar(r)}function sc(t){const r={};return t.searchParams.forEach((e,i)=>{i in r?Array.isArray(r[i])?r[i].push(e):r[i]=[r[i],e]:r[i]=e}),r}function Pf(t,r,e){const[i,n]=t.split("/*",2),o=i.split("/").filter(Boolean),a=o.length;return l=>{const u=l.split("/").filter(Boolean),s=u.length-a;if(s<0||s>0&&n===void 0&&!r)return null;const c={path:a?"":"/",params:{}},d=f=>e===void 0?void 0:e[f];for(let f=0;f<a;f++){const p=o[f],h=p[0]===":",g=h?u[f]:u[f].toLowerCase(),m=h?p.slice(1):p.toLowerCase();if(h&&Ln(g,d(m)))c.params[m]=g;else if(h||!Ln(g,m))return null;c.path+=`/${g}`}if(n){const f=s?u.slice(-s).join("/"):"";if(Ln(f,d(n)))c.params[n]=f;else return null}return c}}function Ln(t,r){const e=i=>i===t;return r===void 0?!0:typeof r=="string"?e(r):typeof r=="function"?r(t):Array.isArray(r)?r.some(e):r instanceof RegExp?r.test(t):!1}function Tf(t){const[r,e]=t.pattern.split("/*",2),i=r.split("/").filter(Boolean);return i.reduce((n,o)=>n+(o.startsWith(":")?2:3),i.length-(e===void 0?0:1))}function lc(t){const r=new Map,e=Mo();return new Proxy({},{get(i,n){return r.has(n)||tc(e,()=>r.set(n,E(()=>t()[n]))),r.get(n)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function cc(t){let r=/(\/?\:[^\/]+)\?/.exec(t);if(!r)return[t];let e=t.slice(0,r.index),i=t.slice(r.index+r[0].length);const n=[e,e+=r[1]];for(;r=/^(\/\:[^\/]+)\?/.exec(i);)n.push(e+=r[1]),i=i.slice(r[0].length);return cc(i).reduce((o,a)=>[...o,...n.map(l=>l+a)],[])}const Ef=100,uc=rc(),dc=rc(),$f=()=>Sf(nc(uc),"<A> and 'use' router primitives can be only used inside a Route."),If=()=>$f().navigatorFactory();function Rf(t,r=""){const{component:e,preload:i,load:n,children:o,info:a}=t,l=!o||Array.isArray(o)&&!o.length,u={key:t,component:e,preload:i||n,info:a};return pc(t.path).reduce((s,c)=>{for(const d of cc(c)){const f=Cf(r,d);let p=l?f:f.split("/*",1)[0];p=p.split("/").map(h=>h.startsWith(":")||h.startsWith("*")?h:encodeURIComponent(h)).join("/"),s.push({...u,originalPath:c,pattern:p,matcher:Pf(p,!l,t.matchFilters)})}return s},[])}function Nf(t,r=0){return{routes:t,score:Tf(t[t.length-1])*1e4-r,matcher(e){const i=[];for(let n=t.length-1;n>=0;n--){const o=t[n],a=o.matcher(e);if(!a)return null;i.unshift({...a,route:o})}return i}}}function pc(t){return Array.isArray(t)?t:[t]}function fc(t,r="",e=[],i=[]){const n=pc(t);for(let o=0,a=n.length;o<a;o++){const l=n[o];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const u=Rf(l,r);for(const s of u){e.push(s);const c=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!c)fc(l.children,s.pattern,e,i);else{const d=Nf([...e],i.length);i.push(d)}e.pop()}}}return e.length?i:i.sort((o,a)=>a.score-o.score)}function jn(t,r){for(let e=0,i=t.length;e<i;e++){const n=t[e].matcher(r);if(n)return n}return[]}function Af(t,r,e){const i=new URL(ac),n=E(c=>{const d=t();try{return new URL(d,i)}catch{return console.error(`Invalid path ${d}`),c}},i,{equals:(c,d)=>c.href===d.href}),o=E(()=>n().pathname),a=E(()=>n().search,!0),l=E(()=>n().hash),u=()=>"",s=he(a,()=>sc(n()));return{get pathname(){return o()},get search(){return a()},get hash(){return l()},get state(){return r()},get key(){return u()},query:e?e(s):lc(s)}}let Zt;function Mf(){return Zt}function Of(t,r,e,i={}){const{signal:[n,o],utils:a={}}=t,l=a.parsePath||(N=>N),u=a.renderPath||(N=>N),s=a.beforeLeave||oc(),c=fn("",i.base||"");if(c===void 0)throw new Error(`${c} is not a valid base path`);c&&!n().value&&o({value:c,replace:!0,scroll:!1});const[d,f]=oe(!1);let p;const h=(N,A)=>{A.value===g()&&A.state===b()||(p===void 0&&f(!0),Zt=N,p=A,mf(()=>{p===A&&(m(p.value),y(p.state),gf(),k[1](L=>L.filter(V=>V.pending)))}).finally(()=>{p===A&&Be(()=>{Zt=void 0,N==="navigate"&&$(p),f(!1),p=void 0})}))},[g,m]=oe(n().value),[b,y]=oe(n().state),w=Af(g,b,a.queryWrapper),v=[],k=oe([]),_=E(()=>typeof i.transformUrl=="function"?jn(r(),i.transformUrl(w.pathname)):jn(r(),w.pathname)),C=()=>{const N=_(),A={};for(let L=0;L<N.length;L++)Object.assign(A,N[L].params);return A},S=a.paramsWrapper?a.paramsWrapper(C,r):lc(C),P={pattern:c,path:()=>c,outlet:()=>null,resolvePath(N){return fn(c,N)}};return le(he(n,N=>h("native",N),{defer:!0})),{base:P,location:w,params:S,isRouting:d,renderPath:u,parsePath:l,navigatorFactory:x,matches:_,beforeLeave:s,preloadRoute:O,singleFlight:i.singleFlight===void 0?!0:i.singleFlight,submissions:k};function T(N,A,L){ye(()=>{if(typeof A=="number"){A&&(a.go?a.go(A):console.warn("Router integration does not support relative routing"));return}const V=!A||A[0]==="?",{replace:Z,resolve:G,scroll:J,state:ue}={replace:!1,resolve:!V,scroll:!0,...L},de=G?N.resolvePath(A):fn(V&&w.pathname||"",A);if(de===void 0)throw new Error(`Path '${A}' is not a routable path`);if(v.length>=Ef)throw new Error("Too many redirects");const R=g();(de!==R||ue!==b())&&(df||s.confirm(de,L)&&(v.push({value:R,replace:Z,scroll:J,state:b()}),h("navigate",{value:de,state:ue})))})}function x(N){return N=N||nc(dc)||P,(A,L)=>T(N,A,L)}function $(N){const A=v[0];A&&(o({...N,replace:A.replace,scroll:A.scroll}),v.length=0)}function O(N,A){const L=jn(r(),N.pathname),V=Zt;Zt="preload";for(let Z in L){const{route:G,params:J}=L[Z];G.component&&G.component.preload&&G.component.preload();const{preload:ue}=G;A&&ue&&tc(e(),()=>ue({params:J,location:{pathname:N.pathname,search:N.search,hash:N.hash,query:sc(N),state:null,key:""},intent:"preload"}))}Zt=V}}function Ff(t,r,e,i){const{base:n,location:o,params:a}=t,{pattern:l,component:u,preload:s}=i().route,c=E(()=>i().path);u&&u.preload&&u.preload();const d=s?s({params:a,location:o,intent:Zt||"initial"}):void 0;return{parent:r,pattern:l,path:c,outlet:()=>u?D(u,{params:a,location:o,data:d,get children(){return e()}}):e(),resolvePath(p){return fn(n.path(),p,c())}}}const Df=t=>r=>{const{base:e}=r,i=ic(()=>r.children),n=E(()=>fc(i(),r.base||""));let o;const a=Of(t,n,()=>o,{base:e,singleFlight:r.singleFlight,transformUrl:r.transformUrl});return t.create&&t.create(a),D(uc.Provider,{value:a,get children(){return D(zf,{routerState:a,get root(){return r.root},get preload(){return r.rootPreload||r.rootLoad},get children(){return[E(()=>(o=Mo())&&null),D(Lf,{routerState:a,get branches(){return n()}})]}})}})};function zf(t){const r=t.routerState.location,e=t.routerState.params,i=E(()=>t.preload&&ye(()=>{t.preload({params:e,location:r,intent:Mf()||"initial"})}));return D(ge,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:n=>D(n,{params:e,location:r,get data(){return i()},get children(){return t.children}})})}function Lf(t){const r=[];let e;const i=E(he(t.routerState.matches,(n,o,a)=>{let l=o&&n.length===o.length;const u=[];for(let s=0,c=n.length;s<c;s++){const d=o&&o[s],f=n[s];a&&d&&f.route.key===d.route.key?u[s]=a[s]:(l=!1,r[s]&&r[s](),Mt(p=>{r[s]=p,u[s]=Ff(t.routerState,u[s-1]||t.routerState.base,ma(()=>i()[s+1]),()=>t.routerState.matches()[s])}))}return r.splice(n.length).forEach(s=>s()),a&&l?a:(e=u[0],u)}));return ma(()=>i()&&e)()}const ma=t=>()=>D(ge,{get when(){return t()},keyed:!0,children:r=>D(dc.Provider,{value:r,get children(){return r.outlet()}})}),Fe=t=>{const r=ic(()=>t.children);return yf(t,{get children(){return r()}})};function jf([t,r],e,i){return[t,i?n=>r(i(n)):r]}function Uf(t){let r=!1;const e=n=>typeof n=="string"?{value:n}:n,i=jf(oe(e(t.get()),{equals:(n,o)=>n.value===o.value&&n.state===o.state}),void 0,n=>(!r&&t.set(n),zn.registry&&!zn.done&&(zn.done=!0),n));return t.init&&Ne(t.init((n=t.get())=>{r=!0,i[1](e(n)),r=!1})),Df({signal:i,create:t.create,utils:t.utils})}function Bf(t,r,e){return t.addEventListener(r,e),()=>t.removeEventListener(r,e)}function qf(t,r){const e=t&&document.getElementById(t);e?e.scrollIntoView():r&&window.scrollTo(0,0)}const Vf=new Map;function Gf(t=!0,r=!1,e="/_server",i){return n=>{const o=n.base.path(),a=n.navigatorFactory(n.base);let l,u;function s(g){return g.namespaceURI==="http://www.w3.org/2000/svg"}function c(g){if(g.defaultPrevented||g.button!==0||g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)return;const m=g.composedPath().find(_=>_ instanceof Node&&_.nodeName.toUpperCase()==="A");if(!m||r&&!m.hasAttribute("link"))return;const b=s(m),y=b?m.href.baseVal:m.href;if((b?m.target.baseVal:m.target)||!y&&!m.hasAttribute("state"))return;const v=(m.getAttribute("rel")||"").split(/\s+/);if(m.hasAttribute("download")||v&&v.includes("external"))return;const k=b?new URL(y,document.baseURI):new URL(y);if(!(k.origin!==window.location.origin||o&&k.pathname&&!k.pathname.toLowerCase().startsWith(o.toLowerCase())))return[m,k]}function d(g){const m=c(g);if(!m)return;const[b,y]=m,w=n.parsePath(y.pathname+y.search+y.hash),v=b.getAttribute("state");g.preventDefault(),a(w,{resolve:!1,replace:b.hasAttribute("replace"),scroll:!b.hasAttribute("noscroll"),state:v?JSON.parse(v):void 0})}function f(g){const m=c(g);if(!m)return;const[b,y]=m;n.preloadRoute(y,b.getAttribute("preload")!=="false")}function p(g){clearTimeout(l);const m=c(g);if(!m)return u=null;const[b,y]=m;u!==b&&(l=setTimeout(()=>{n.preloadRoute(y,b.getAttribute("preload")!=="false"),u=b},20))}function h(g){if(g.defaultPrevented)return;let m=g.submitter&&g.submitter.hasAttribute("formaction")?g.submitter.getAttribute("formaction"):g.target.getAttribute("action");if(!m)return;if(!m.startsWith("https://action/")){const y=new URL(m,ac);if(m=n.parsePath(y.pathname+y.search),!m.startsWith(e))return}if(g.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const b=Vf.get(m);if(b){g.preventDefault();const y=new FormData(g.target,g.submitter);b.call({r:n,f:g.target},g.target.enctype==="multipart/form-data"?y:new URLSearchParams(y))}}Oe(["click","submit"]),document.addEventListener("click",d),t&&(document.addEventListener("mousemove",p,{passive:!0}),document.addEventListener("focusin",f,{passive:!0}),document.addEventListener("touchstart",f,{passive:!0})),document.addEventListener("submit",h),Ne(()=>{document.removeEventListener("click",d),t&&(document.removeEventListener("mousemove",p),document.removeEventListener("focusin",f),document.removeEventListener("touchstart",f)),document.removeEventListener("submit",h)})}}function Wf(t){const r=t.replace(/^.*?#/,"");if(!r.startsWith("/")){const[,e="/"]=window.location.hash.split("#",2);return`${e}#${r}`}return r}function Hf(t){const r=()=>window.location.hash.slice(1),e=oc();return Uf({get:r,set({value:i,replace:n,scroll:o,state:a}){n?window.history.replaceState(wf(a),"","#"+i):window.history.pushState(a,"","#"+i);const l=i.indexOf("#"),u=l>=0?i.slice(l+1):"";qf(u,o),Fo()},init:i=>Bf(window,"hashchange",kf(i,n=>!e.confirm(n&&n<0?n:r()))),create:Gf(t.preload,t.explicitLinks,t.actionBase),utils:{go:i=>window.history.go(i),renderPath:i=>`#${i}`,parsePath:Wf,beforeLeave:e}})(t)}var hn={exports:{}},Zf=hn.exports,ga;function Yf(){return ga||(ga=1,function(t,r){(function(e,i){i()})(Zf,function(){function e(s,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function i(s,c,d){var f=new XMLHttpRequest;f.open("GET",s),f.responseType="blob",f.onload=function(){u(f.response,c,d)},f.onerror=function(){console.error("could not download file")},f.send()}function n(s){var c=new XMLHttpRequest;c.open("HEAD",s,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function o(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(c)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof tn=="object"&&tn.global===tn?tn:void 0,l=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(s,c,d){var f=a.URL||a.webkitURL,p=document.createElement("a");c=c||s.name||"download",p.download=c,p.rel="noopener",typeof s=="string"?(p.href=s,p.origin===location.origin?o(p):n(p.href)?i(s,c,d):o(p,p.target="_blank")):(p.href=f.createObjectURL(s),setTimeout(function(){f.revokeObjectURL(p.href)},4e4),setTimeout(function(){o(p)},0))}:"msSaveOrOpenBlob"in navigator?function(s,c,d){if(c=c||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(e(s,d),c);else if(n(s))i(s,c,d);else{var f=document.createElement("a");f.href=s,f.target="_blank",setTimeout(function(){o(f)})}}:function(s,c,d,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof s=="string")return i(s,c,d);var p=s.type==="application/octet-stream",h=/constructor/i.test(a.HTMLElement)||a.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||p&&h||l)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var w=m.result;w=g?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=w:location=w,f=null},m.readAsDataURL(s)}else{var b=a.URL||a.webkitURL,y=b.createObjectURL(s);f?f.location=y:location.href=y,f=null,setTimeout(function(){b.revokeObjectURL(y)},4e4)}});a.saveAs=u.saveAs=u,t.exports=u})}(hn)),hn.exports}var Xf=Yf();const hc=Nn(Xf);let O_=async t=>{let r=t.vfs,e=new Ql,i=async(n,o)=>{let a=o.contents;for(let l of a)switch(l.type){case"File":{let u=await new Promise(c=>{Mt(d=>{let f=o.openFileById(l.id);ve(()=>{let p=f();if(p.type=="Pending")return;if(d(),p.type=="Failed"){c(it(p.message));return}let h=p.value,g;if(h.name().toLowerCase().endsWith(".json"))g=new Blob([JSON.stringify(h.doc,void 0,2)],{type:"application/json"});else if(h.name().toLowerCase().endsWith(".ts"))g=new Blob([h.doc.source],{type:"application/typescript"});else{let m=h.doc.mimeType,b=h.doc.data;g=new Blob([b],{type:m})}c(Te(g))})})});if(u.type=="Err")continue;let s=u.value;n.file(l.name,s);break}case"Folder":{let u=n.folder(l.name);if(u==null)continue;await new Promise(s=>{Mt(c=>{let d=o.openFolderById(l.id);ve(()=>{let f=d();if(f.type=="Pending")return;if(f.type=="Failed"){console.log(f.message),c(),s();return}let p=f.value;(async()=>(await i(u,p),c(),s()))()})})});break}}};Mt(n=>{let o=r.rootFolder();ve(()=>{let a=o();if(a.type!="Pending"){if(a.type=="Failed"){console.log(a.message),n();return}(async()=>{let l=a.value;await i(e,l);let u=await e.generateAsync({type:"blob"});hc.saveAs(u,"kitty_export.zip"),n()})()}})})},Kf=async t=>{let r=t.vfs,e;{let i=await new Promise(n=>{Mt(o=>{let a=r.rootFolder();ve(()=>{let l=a();if(l.type=="Pending")return;if(l.type=="Failed"){o(),n(it(l.message));return}let u=l.value;ye(()=>{let s=u.contents;for(let c of s)u.removeFileOrFolderById(c.id)}),o(),n(Te(u))})})});if(i.type=="Err")return i;e=i.value}{let i=await Ql.loadAsync(t.file);async function n(o,a){let l;if(o=="")l=i;else{let c=i.folder(o);if(c==null)return;l=c}if(!l){console.warn(`Folder "${o}" not found in the zip.`);return}const u=[];l.forEach((c,d)=>{const f=o+(o&&!o.endsWith("/")?"/":"")+c;u.push({name:f,relativePath:c,isFolder:d.dir})});let s=[];for(let c of u)c.isFolder&&s.push(c.relativePath);for(const c of u)if(!s.some(d=>c.relativePath.startsWith(d))&&!c.isFolder){let d=i.file(c.name);if(d==null)continue;let f=await d.async("blob");if(c.relativePath.toLowerCase().endsWith(".json")){let p=await f.text(),h=JSON.parse(p);a.createFile(c.relativePath,h)}else if(c.relativePath.toLowerCase().endsWith(".ts")){let p=await f.text();a.createFile(c.relativePath,{source:p})}else{let p=new Uint8Array(await f.arrayBuffer());a.createFile(c.relativePath,{mimeType:f.type,data:p})}}for(const c of u)if(c.isFolder){let d=c.relativePath;d.endsWith("/")&&(d=d.slice(0,d.length-1));let f=a.createFolder(d);if(f.type=="Err")continue;let{id:p}=f.value;await new Promise(h=>{Mt(g=>{let m=a.openFolderById(p);ve(he(m,b=>{if(b.type=="Pending")return;if(b.type=="Failed"){console.log(b.message),g(),h();return}let y=b.value;(async()=>(await n(c.name,y),g(),h()))()}))})})}}await n("",e)}return Te({})};var Jf=Y('<div style=flex-grow:1;overflow:auto;><button class="btn btn-primary">Share Virtual File System</button><br><button class="btn btn-secondary">Delete Virtual File System</button><br><br><b>Links:</b><br><div><div><button class=btn>Kitty Demo</button><button class=btn>Pixel Editor</button><button class=btn>Level Builder</button><button class=btn>Music Editor</button><button class=btn>Model Editor</button><button class=btn>Script Editor</button><button class=btn>Colour Picker</button><button class=btn>Reactive Simulator</button><button class=btn>Vector Editor</button><button class=btn>Gravity Test</button><button class=btn>Three Body</button><button class=btn>Virtual File System Test</button><button class=btn>Automerge WebRTC Test</button><button class=btn>Connection Management</button><button class=btn>Debug Projection</button><button class=btn>App</button><button class=btn>Auto Forms Test'),Qf=Y('<button class="btn btn-primary">Import Virtual File System<input type=file hidden>');const eh=t=>{let r=If();return(()=>{var e=Jf(),i=e.firstChild,n=i.nextSibling,o=n.nextSibling,a=o.nextSibling,l=a.nextSibling,u=l.nextSibling,s=u.nextSibling,c=s.nextSibling,d=c.firstChild,f=d.firstChild,p=f.nextSibling,h=p.nextSibling,g=h.nextSibling,m=g.nextSibling,b=m.nextSibling,y=b.nextSibling,w=y.nextSibling,v=w.nextSibling,k=v.nextSibling,_=k.nextSibling,C=_.nextSibling,S=C.nextSibling,P=S.nextSibling,T=P.nextSibling,x=T.nextSibling,$=x.nextSibling;return i.$$click=()=>{t.onShareVfs()},o.$$click=()=>{window.confirm("Are you sure you wish to delete your virtual file system?")&&t.onDeleteVfs()},te(e,()=>ye(()=>{let O;return(()=>{var N=Qf(),A=N.firstChild,L=A.nextSibling;N.$$click=()=>{O.click()},L.addEventListener("change",()=>{let Z=O.files;Z!=null&&Z.length==1&&Kf({file:Z[0],vfs:t.vfs})});var V=O;return typeof V=="function"?Ce(V,L):O=L,N})()}),l),c.style.setProperty("margin-left","10px"),c.style.setProperty("margin-top","10px"),c.style.setProperty("display","inline-block"),d.style.setProperty("display","flex"),d.style.setProperty("flex-direction","column"),f.$$click=()=>r("/kitty-demo"),p.$$click=()=>r("/pixel-editor"),h.$$click=()=>r("/level-builder"),g.$$click=()=>r("/music-editor"),m.$$click=()=>r("/model-editor"),b.$$click=()=>r("/script-editor"),y.$$click=()=>r("/colour-picker"),w.$$click=()=>r("/reactive-sim"),v.$$click=()=>r("/vector-editor"),k.$$click=()=>r("/gravity-test"),_.$$click=()=>r("/three-body"),C.$$click=()=>r("/vfs-test"),S.$$click=()=>r("/automerge-webrtc-test"),P.$$click=()=>r("/connection-management"),T.$$click=()=>r("/debug-projection"),x.$$click=()=>r("/app"),$.$$click=()=>r("/auto-forms-test"),e})()};Oe(["click"]);class th extends cf{peerId;peerMetadata}var Un={},Bt={},nn={},ya;function rh(){return ya||(ya=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.default=["other","new","good","old","little","great","small","young","long","black","high","only","big","white","political","right","large","real","sure","different","important","public","possible","full","whole","certain","human","major","military","bad","social","dead","true","economic","open","early","free","national","strong","hard","special","clear","local","private","wrong","late","short","poor","recent","dark","fine","foreign","ready","red","cold","low","heavy","serious","single","personal","difficult","left","blue","federal","necessary","general","easy","likely","beautiful","happy","past","hot","close","common","afraid","simple","natural","main","various","available","nice","present","final","sorry","entire","current","similar","deep","huge","rich","nuclear","empty","strange","quiet","front","wide","modern","concerned","green","very","alone","particular","bright","supposed","basic","medical","aware","total","financial","legal","original","international","soft","alive","interested","tall","warm","popular","tiny","top","normal","powerful","silent","religious","impossible","quick","safe","thin","familiar","gray","fresh","physical","individual","willing","crazy","sick","angry","perfect","tired","wild","moral","brown","dangerous","famous","married","terrible","successful","fair","professional","official","obvious","glad","central","chief","effective","light","complete","interesting","thick","proper","involved","responsible","narrow","civil","industrial","dry","yellow","specific","sharp","sudden","direct","following","growing","significant","traditional","slow","previous","vast","surprised","busy","usual","clean","funny","regular","scientific","ordinary","ancient","senior","sweet","future","annual","secret","equal","independent","wonderful","tough","broad","additional","careful","domestic","brief","enormous","commercial","grand","average","sexual","nervous","pale","immediate","critical","proud","like","complex","separate","considerable","still","extra","expensive","guilty","active","mad","asleep","wooden","cool","presidential","apparent","weak","essential","living","pretty","cultural","useful","actual","unusual","daily","potential","wet","solid","lovely","comfortable","formal","outside","massive","sad","corporate","distant","loose","rare","stupid","visible","liberal","flat","pleased","pure","curious","practical","upper","technical","male","appropriate","fat","just","due","mere","handsome","mental","conservative","positive","leading","naked","false","drunk","dirty","friendly","constant","well","used","emotional","internal","odd","historical","female","ill","broken","capable","southern","pleasant","bare","minor","eager","lucky","urban","steady","fiscal","rough","primary","reasonable","typical","inner","favorite","attractive","slight","innocent","limited","straight","pink","excellent","double","dramatic","violent","honest","electric","fellow","substantial","opposite","awful","severe","joint","armed","hungry","remarkable","increased","gentle","illegal","middle","bitter","mass","permanent","increasing","damn","golden","correct","intense","round","northern","proposed","so-called","criminal","healthy","plain","vital","blind","native","intellectual","unknown","extreme","existing","raw","prime","brilliant","sensitive","extraordinary","sufficient","remaining","ultimate","unique","royal","initial","negative","fundamental","nearby","smart","strategic","educational","unlikely","smooth","modest","conventional","giant","scared","cheap","dear","delicate","anxious","valuable","standard","desperate","lonely","diplomatic","firm","wise","principal","congressional","occasional","ugly","vice","radical","faint","working","absolute","intelligent","racial","mutual","silly","fast","musical","tight","complicated","numerous","crucial","square","contemporary","bloody","western","endless","inevitable","environmental","constitutional","rapid","worried","lost","genuine","temporary","democratic","rural","regional","given","painful","literary","chemical","sophisticated","decent","academic","awake","conscious","revolutionary","surprising","elderly","agricultural","psychological","pregnant","live","adequate","superior","grateful","prominent","frightened","remote","overall","stiff","harsh","electronic","spiritual","okay","closed","excited","convinced","long-term","unexpected","dull","evident","civilian","mysterious","romantic","impressive","continuing","exciting","logical","peculiar","exact","widespread","foolish","extensive","evil","continued","confident","generous","legislative","stable","vulnerable","elegant","embarrassed","hostile","efficient","blond","dumb","advanced","defensive","outer","neat","estimated","wealthy","dying","loud","creative","acceptable","unhappy","sheer","competitive","concrete","reluctant","precious","tremendous","burning","precise","uncertain","holy","artificial","vague","ideal","universal","moderate","subtle","mild","peaceful","assistant","invisible","casual","crowded","crude","running","classic","controversial","ridiculous","frequent","grim","accurate","detailed","goddamn","fun","fierce","cruel","incredible","blank","dim","suitable","classical","elaborate","collective","eastern","legitimate","aggressive","rear","administrative","automatic","dependent","ashamed","distinct","fit","clever","brave","ethnic","maximum","relative","primitive","uncomfortable","profound","sacred","biological","identical","furious","loyal","rational","mechanical","mean","naval","noble","ambitious","purple","historic","dominant","suburban","developing","calm","frozen","subsequent","charming","damp","fixed","rigid","offensive","electrical","shy","continuous","urgent","weary","immense","splendid","downtown","uneasy","disappointed","helpless","voluntary","polite","junior","gross","striking","overwhelming","unconscious","steep","outstanding","tender","tragic","costly","miserable","near","useless","welcome","external","helpful","weekly","middle-aged","suspicious","old-fashioned","technological","damned","awkward","visual","organized","ideological","orange","horrible","strict","magnificent","deadly","dusty","mighty","puzzled","bold","global","passing","magic","fond","judicial","missing","definite","changing","rubber","theoretical","satisfied","promising","abstract","excessive","comparable","fatal","distinguished","inadequate","slender","artistic","known","sympathetic","favorable","cheerful","faithful","delighted","unnecessary","sole","cautious","productive","reliable","patient","sensible","desirable","depressed","atomic","able","instant","relevant","alien","spectacular","lesser","swift","comic","enthusiastic","marvelous","experimental","weird","retired","fascinating","content","medieval","inclined","bored","ruling","flying","consistent","organic","alleged","grave","smiling","realistic","amazing","exotic","symbolic","confused","underground","spare","philosophical","vigorous","troubled","shallow","amused","lively","genetic","impatient","brutal","solar","unfair","formidable","tense","unfortunate","minimum","sleeping","secondary","shiny","jealous","insane","gay","vivid","wounded","hurt","intimate","monthly","sour","socialist","worthy","preliminary","colonial","middle-class","alternative","influential","unpleasant","comprehensive","devoted","upset","secure","absurd","neutral","frightening","profitable","fragile","civilized","slim","partial","added","fearful","optimistic","isolated","eternal","vocal","beloved","alert","verbal","rising","skilled","antique","municipal","written","restless","outdoor","governmental","driving","sore","informal","loving","retail","hidden","determined","monetary","convenient","thoughtful","colored","progressive","bizarre","sweeping","fancy","expected","fantastic","editorial","intact","bottom","multiple","well-known","nasty","protective","acute","combined","related","fortunate","earnest","divine","passionate","icy","noisy","vicious","dreadful","apt","boring","unprecedented","decisive","sunny","marked","experienced","disturbing","satisfactory","sober","random","electoral","shocked","deliberate","coming","orderly","surrounding","unwilling","inherent","mixed","naive","dense","hopeless","aesthetic","supreme","encouraging","institutional","solemn","stubborn","required","relaxed","bald","frantic","exclusive","rotten","filthy","flexible","explicit","glorious","lean","ignorant","extended","embarrassing","architectural","mortal","corrupt","hopeful","regulatory","valid","characteristic","tribal","capitalist","diverse","functional","improved","ironic","graceful","unaware","respectable","eligible","lousy","established","postwar","objective","wary","elementary","moving","superb","cute","minimal","meaningful","notable","structural","developed","rolling","fashionable","persistent","distinctive","terrific","thorough","skeptical","secular","chronic","level","everyday","visiting","infinite","short-term","terrorist","youthful","unemployed","forced","liquid","explosive","rude","colorful","renewed","semantic","astonishing","passive","heroic","gleaming","indifferent","vertical","prior","anonymous","absent","customary","mobile","uniform","solitary","probable","amazed","petty","bleak","athletic","tentative","harmless","ample","right-wing","polished","obscure","sincere","dried","intensive","equivalent","convincing","idle","vacant","mature","amusing","competent","ominous","savage","motionless","tropical","blunt","drunken","delicious","lazy","ragged","longtime","nationwide","startling","civic","freezing","muscular","circular","imperial","irrelevant","countless","gloomy","startled","disastrous","skinny","hollow","upward","ethical","underlying","careless","wholesale","abandoned","unfamiliar","mandatory","imaginary","bewildered","annoyed","magnetic","dazzling","lengthy","stern","surgical","clinical","full-time","metropolitan","moist","unlike","doubtful","prosperous","keen","awesome","humble","interior","psychiatric","clumsy","outraged","theatrical","educated","gigantic","scattered","privileged","sleepy","battered","meaningless","predictable","gradual","miniature","radioactive","prospective","aging","destructive","authentic","portable","bearded","balanced","shining","spontaneous","bureaucratic","inferior","sturdy","cynical","exquisite","talented","immune","imaginative","ripe","shared","kind","parliamentary","glowing","frail","astonished","forward","inside","operational","faded","closing","pro","coastal","shrewd","preoccupied","celebrated","wicked","bourgeois","marginal","transparent","dynamic","psychic","plump","coarse","bleeding","striped","eventual","residential","hysterical","pathetic","planned","fake","imminent","sentimental","stunning","worldwide","militant","sizable","representative","incapable","provincial","poetic","injured","tactical","selfish","winning","foul","repeated","novel","dubious","part-time","abrupt","lone","overseas","grey","varied","cooperative","muddy","scheduled","legendary","arrogant","conspicuous","varying","devastating","vulgar","martial","amateur","mathematical","deaf","scarce","specialized","honorable","outrageous","confidential","fallen","goddamned","five-year","feminine","monstrous","brisk","systematic","exhausted","frank","lunar","daring","shadowy","respected","stark","accepted","successive","pending","prolonged","unseen","uniformed","wretched","sullen","arbitrary","drastic","crooked","resulting","intricate","unpredictable","printed","utter","satisfying","delightful","linguistic","shabby","statistical","accessible","prestigious","trivial","waiting","futile","prepared","aged","misleading","cognitive","shocking","childish","elected","magical","forthcoming","exceptional","gifted","stricken","fiery","cardboard","shaky","conflicting","commanding","starving","accustomed","rocky","long-range","floating","sinister","potent","phony","lasting","understandable","curved","barren","lethal","toxic","deserted","ambiguous","notorious","synthetic","worthwhile","imported","intent","reduced","painted","taut","sociological","questionable","crisp","pointed","harmful","horizontal","rival","somber","benign","prevailing","selected","organizational","excess","dedicated","veteran","implicit","prudent","plausible","confusing","smoking","large-scale","subdued","constructive","marital","scarlet","rugged","darkened","untouched","above","matching","covert","communal","sticky","affluent","energetic","stale","controlled","qualified","reminiscent","shut","blonde","handy","ritual","straightforward","terminal","dizzy","sane","twisted","occupied","finished","opposing","sly","depressing","irregular","marine","communist","obscene","wrinkled","unsuccessful","gracious","static","consecutive","reserve","exposed","scholarly","sleek","reckless","oral","comforting","pressing","swollen","viable","carved","obsessed","projected","hideous","unthinkable","mock","susceptible","respective","goddam","downward","memorable","worn","raised","glittering","beneficial","lingering","patriotic","stunned","hairy","worrying","lighted","sexy","abundant","tangled","perpetual","irresistible","terrified","compelling","unmistakable","feeble","uneven","trained","folded","relentless","killed","gorgeous","conservation","serene","eerie","premature","dismal","competing","risky","unacceptable","indirect","witty","muffled","feasible","interstate","heated","uncommon","accidental","queer","innovative","parallel","fried","unnatural","cracked","persuasive","integrated","ongoing","homosexual","sound","fertile","canned","preceding","worldly","onstage","declining","advisory","juvenile","slippery","numb","postal","olive","eccentric","lay","chilly","shrill","ceremonial","registered","boiling","contradictory","irresponsible","then","industrialized","obsolete","rusty","inflationary","split","discreet","intolerable","barefoot","territorial","outspoken","audible","adverse","associate","impending","decorative","luminous","two-year","expanding","unchanged","outstretched","momentary","good-looking","cunning","overnight","sprawling","unbelievable","bland","liable","terrifying","televised","appealing","breathless","alarming","supporting","greasy","affirmative","guiding","homeless","triumphant","rainy","stolen","empirical","timid","provocative","knowledgeable","pragmatic","touching","desired","amiable","attempted","humane","adjacent","superficial","greedy","assorted","elusive","ruthless","lush","soothing","imposing","preferred","lavish","pervasive","managing","sandy","inappropriate","desolate","nude","reassuring","shimmering","first-class","unfinished","insistent","comparative","conceivable","admirable","courageous","aristocratic","meager","subjective","vain","disgusted","dual","towering","responsive","ailing","compact","torn","sortal","entertaining","dreary","metallic","tedious","irrational","immoral","teen-age","interim","jagged","selective","volatile","cozy","unanimous","unlimited","hired","cosmic","indoor","retarded","gold","fabulous","dignified","long-distance","high-school","classified","luxurious","insufficient","pious","incomplete","oblivious","imperialist","stately","lifelong","subordinate","extravagant","intrinsic","unpopular","scant","surplus","radiant","ruined","grotesque","hazardous","disabled","intriguing","worthless","reported","hoarse","utmost","muted","bony","disgusting","monumental","pleasing","sterile","agreeable","three-year","tricky","lucrative","respectful","inexpensive","bulky","troublesome","affectionate","coherent","unreasonable","nineteenth-century","curly","indispensable","nursing","incompetent","governing","alternate","suspected","left-wing","refined","overt","chilling","virtual","devoid","perverse","enduring","outright","overhead","unnoticed","nonprofit","pointless","appalling","dental","chosen","enlightened","robust","commonplace","damaging","conscientious","eloquent","erratic","applied","merry","ardent","flowing","incoming","chaotic","noticeable","pitiful","locked","swelling","definitive","homemade","super","pronounced","kindly","prone","attentive","unstable","unrelated","charitable","armored","unclear","tangible","medium","winding","slick","credible","frustrating","shifting","spacious","day-to-day","surviving","expanded","arid","unwanted","unbearable","hesitant","recognizable","multinational","abdominal","murderous","glossy","mute","working-class","insignificant","ingenious","masculine","blessed","gaunt","miraculous","unconstitutional","parental","rigorous","bodily","impersonal","backward","computerized","four-year","unmarried","wry","resident","luxury","high-level","partisan","powerless","seasonal","self-conscious","triple","onetime","ecological","periodic","racist","exaggerated","facial","erotic","unreal","durable","manual","rounded","concentrated","literal","mystical","stimulating","staggering","tempting","last-minute","erect","feudal","head","emerging","hind","brooding","candid","paranoid","defective","linear","immortal","shattered","unsure","swinging","compatible","ghastly","investigative","rosy","convicted","sensational","committed","makeshift","tolerant","forceful","supernatural","joyous","limp","improper","hanging","sliding","renowned","tattered","nonexistent","supportive","frustrated","undercover","handicapped","apprehensive","plentiful","authoritative","sustained","disappointing","hereditary","photographic","impoverished","ornate","respiratory","substantive","acting","nutritional","unofficial","innumerable","prevalent","dire","menacing","outward","brittle","hasty","sparkling","sled","geographical","therapeutic","melancholy","adolescent","hearty","disturbed","sweaty","poisonous","paid","ineffective","humorous","burly","rebellious","reddish","stout","teenage","eminent","rhythmic","physiological","guaranteed","opaque","folding","fleeting","full-scale","low-income","infectious","stringent","stained","beige","stirring","soaring","glamorous","airborne","improbable","austere","anticipated","designated","oval","restrictive","yearly","precarious","relieved","said","feverish","occupational","holding","speculative","abnormal","challenging","healing","boyish","forbidding","divorced","famed","sluggish","struggling","united","undesirable","steaming","consulting","answering","recreational","accompanying","cramped","journalistic","neighboring","fictional","chopped","phenomenal","bankrupt","illicit","advancing","upcoming","racing","protected","padded","venerable","fuzzy","behavioral","roast","mocking","reactionary","inefficient","packed","sloppy","sparse","foster","revealing","reverse","gaping","blue-collar","thankful","down","unimportant","traveling","corresponding","maternal","autonomous","conceptual","smoky","baked","stuffed","murky","totalitarian","ghostly","seeming","flickering","sensual","clenched","offshore","stinging","oppressive","strained","messy","executive","evolutionary","theological","damaged","unrealistic","rectangular","off","mainstream","benevolent","thirsty","blinding","loaded","applicable","unused","crushed","tan","factual","involuntary","brand-new","akin","scary","modified","mindless","born","feminist","integral","uncanny","aloof","spreading","watery","playful","stocky","wasted","compulsory","indignant","pertinent","incredulous","simultaneous","turbulent","framed","aching","falling","cardiac","trim","silvery","accused","pastoral","barbed","adjoining","inspired","courteous","skillful","majestic","gilded","published","perennial","upright","seasoned","continual","papal","victorious","optical","ecstatic","agonizing","shameful","expressive","inconsistent","insulting","cloudy","defiant","restricted","approaching","aggregate","orthodox","unified","all-out","wooded","nationalist","favored","lofty","assured","smug","earthly","improving","instrumental","stray","clandestine","managerial","animated","intended","flawed","bent","clerical","outgoing","righteous","unspoken","poignant","faulty","defeated","authoritarian","treacherous","catastrophic","refreshing","unidentified","suicidal","sickly","disciplined","meticulous","preferable","trusted","hectic","husky","distraught","select","snowy","ferocious","crumpled","humiliating","divided","crippled","infamous","chic","broke","sovereign","continental","idealistic","first-rate","guarded","learned","nameless","runaway","metaphysical","senseless","boiled","needy","silver","recorded","polar","real-estate","stormy","incomprehensible","wiry","raging","composite","flamboyant","crimson","reproductive","intermediate","ubiquitous","repressive","hefty","listening","good-natured","parochial","stylish","high-tech","flaming","coronary","overweight","bathing","three-day","tidy","beleaguered","manifest","ludicrous","indigenous","adamant","placid","inept","exuberant","stony","salty","seductive","accomplished","impassive","grazing","congenial","misguided","wide-eyed","revised","bass","sonic","budgetary","halfway","ensuing","admiring","palpable","nightly","hooded","best-known","eighteenth-century","dissident","morbid","incumbent","demanding","inexperienced","hazy","revolving","rented","disadvantaged","innate","dietary","minute","cultivated","sealed","contemptuous","rhetorical","conciliatory","articulate","jobless","macho","forgotten","lifeless","proven","latent","secretive","perilous","token","graphic","alcoholic","overdue","permissible","shattering","preventive","illiterate","back","atmospheric","thermal","quaint","negotiated","preposterous","temporal","restrained","triangular","mayoral","spatial","heady","biblical","fitting","pessimistic","mammoth","allied","failed","intuitive","nagging","tidal","angular","speechless","finishing","protracted","watchful","businesslike","automated","versatile","booming","pouring","misty","deceptive","sunken","singular","suspended","unworthy","immigrant","expressionless","airy","mournful","neurotic","cubic","unauthorized","economical","fund-raising","captive","blatant","far-reaching","subversive","imperfect","jolly","inaccurate","resentful","strenuous","suffering","hardened","malicious","unjust","perceptive","newborn","promised","differing","virgin","alarmed","grassy","frivolous","apologetic","wasteful","endangered","unarmed","adept","unavoidable","approved","trembling","stuck","high-ranking","crushing","prescribed","dependable","fragrant","expansive","unfriendly","covered","bemused","digital","probing","sloping","man-made","festive","unilateral","unmarked","bipartisan","statewide","burgeoning","devout","sickening","mediocre","adventurous","elevated","suggestive","accountable","virtuous","lame","heavenly","bruised","unbroken","irritable","affected","inconceivable","sometime","vile","baggy","timely","glistening","imagined","unprepared","unresolved","windy","humanitarian","overriding","detached","annoying","narrative","interminable","appalled","penal","unsatisfactory","instinctive","variable","cumulative","obedient","deficient","colossal","unaffected","extinct","routine","microscopic","compassionate","nominal","forlorn","distorted","mistaken","enclosed","infected","fervent","analogous","frigid","instructive","appointed","one-way","gnarled","problematic","sardonic","two-hour","hypothetical","prompt","anguished","electromagnetic","sensuous","homely","beaten","malignant","rotting","concealed","peripheral","creaking","impeccable","khaki","grinning","irreversible","rampant","wondrous","inward","manufactured","grisly","cooked","discriminatory","cerebral","knowing","auxiliary","operative","losing","genial","phonetic","ecclesiastical","sarcastic","incorrect","ruddy","well-to-do","inexplicable","unreliable","developmental","woolen","agitated","lyrical","consequent","calculated","molecular","pompous","present-day","shaggy","even","inhuman","sublime","diagnostic","manly","raucous","balding","after","bilateral","mounted","blackened","assembled","separated","gaudy","evangelical","darling","juicy","impotent","receptive","irritating","pulmonary","dazed","cross-country","unavailable","parked","habitual","lexical","lowered","unwise","planetary","throbbing","enigmatic","superstitious","threatening","manned","childlike","sporting","right-hand","adult","reflective","white-haired","discernible","celestial","prodigious","translucent","equitable","epic","frayed","arduous","flimsy","penetrating","howling","disparate","alike","all-time","deformed","comical","inert","procedural","resistant","vibrant","geographic","wistful","specified","rightful","spirited","unborn","enjoyable","regal","cumbersome","burned","frenzied","gubernatorial","deteriorating","haunted","evasive","neglected","anthropological","inescapable","clear-cut","visionary","bloated","accumulated","agrarian","pained","dwindling","heightened","gray-haired","distressing","grinding","insecure","archaic","piercing","fluent","leisurely","giddy","slimy","oncoming","short-lived","spinal","wholesome","unanswered","illegitimate","staunch","two-day","rumpled","speedy","soaked","rocking","invaluable","gallant","tacit","finite","inviting","sporadic","powdered","cheery","volcanic","optional","mischievous","flowered","contagious","automotive","inflated","mythic","analytical","infrared","two-week","binding","ancestral","dissatisfied","upstate","veritable","unaccustomed","oily","monotonous","seated","feeding","fluorescent","undue","impassioned","picturesque","vocational","tranquil","tumultuous","rustic","patterned","two-story","pagan","flash","playing","exhilarating","maiden","three-dimensional","mythical","thriving","drab","black-and-white","honorary","dingy","founding","imperative","indistinguishable","lightweight","avid","dreamy","everlasting","obsessive","tional","homogeneous","inner-city","changed","tame","colorless","haggard","implacable","altered","unequal","focal","perceptual","literate","priceless","diminishing","harmonious","dark-haired","fatty","squat","undecided","banal","fruitful","pioneering","innocuous","cordial","rewarding","unsafe","maritime","overcrowded","timeless","fledgling","nostalgic","abreast","one-time","humid","astronomical","one-man","deepening","blazing","fleshy","dishonest","succeeding","qualitative","needless","rickety","joyful","stated","ambivalent","hybrid","six-month","limiting","workable","sleepless","unpaid","mundane","flashy","stagnant","bumper","recurring","sinful","immaculate","synonymous","measured","thrilling","long-standing","unruly","bewildering","unfit","edgy","numerical","sumptuous","fragmented","puffy","elastic","high-pitched","momentous","woven","unsteady","unnamed","cosmetic","snap","impenetrable","floral","waving","promotional","tenuous","lonesome","embroidered","strident","cherished","aghast","fundamentalist","white-collar","afloat","disruptive","law-enforcement","gathered","indefinite","intervening","publicized","geometric","disciplinary","descriptive","wavy","edible","disgruntled","obligatory","untrue","amber","snug","resolute","awed","simplistic","grandiose","crippling","high-speed","mounting","glaring","small-town","cavernous","hushed","wage-price","demographic","diseased","unpublished","causal","defenseless","sheltered","dormant","compulsive","loved","willful","truthful","punitive","disposable","ajar","drowsy","statutory","tanned","proprietary","informed","unheard","decision-making","transient","unlawful","dour","negligible","underwater","optimum","illusory","imaginable","borrowed","divergent","looking","exempt","contentious","forbidden","cowardly","masked","crazed","silken","parched","furry","wandering","insensitive","over-all","elated","waxed","veiled","envious","insidious","scrawny","unwarranted","lithe","abrasive","pretentious","far-off","murdered","deft","prickly","musty","shapeless","incongruous","gruesome","honored","perceived","grieving","unspecified","dizzying","privy","noteworthy","charred","median","fearless","twisting","unattractive","flawless","welcoming","flushed","hardy","glum","scenic","devious","recurrent","distasteful","jubilant","ballistic","hilarious","naughty","bustling","discarded","pristine","exemplary","fading","complacent","incessant","engaging","twentieth-century","protectionist","rudimentary","traumatic","steamy","emphatic","hard-line","teeming","generating","stuffy","connecting","stationary","genteel","populist","supple","hateful","retrospective","glazed","lawful","arched","tiresome","lucid","reserved","pivotal","grimy","surly","anti-Soviet","contrary","quarterly","old-time","residual","spiral","decaying","threatened","docile","appreciative","jovial","fascist","worrisome","red-haired","undisturbed","creamy","well-dressed","serial","existential","mountainous","pastel","self-sufficient","spoken","express","tasty","maroon","infrequent","deceased","full-fledged","transitional","leafy","gravitational","furtive","prophetic","nasal","unwelcome","troubling","immobile","merciful","uncontrollable","impartial","unfavorable","attendant","associated","high-rise","vascular","fateful","concerted","rash","stubby","paramount","impulsive","fraudulent","drooping","reciprocal","usable","fast-food","touchy","astute","oversized","mottled","slack","fruitless","unhealthy","decorated","shady","shaped","fanciful","quivering","charismatic","sordid","oppressed","inaccessible","fastidious","brazen","gloved","crumbling","underdeveloped","scarred","rambling","incipient","remedial","derelict","incompatible","fanatical","smoked","secondhand","hypnotic","failing","marching","flattened","paradoxical","unskilled","esthetic","tolerable","pungent","substitute","soggy","terse","tiring","fictitious","manageable","inventive","haughty","normative","premier","grudging","vested","exhausting","cross-legged","self-evident","away","horrified","prolific","incoherent","quantitative","full-length","year-round","unkind","provisional","exterior","brash","inconclusive","landed","breathtaking","acrid","noted","resultant","long-time","resounding","lovable","hypocritical","plush","foggy","acknowledged","idiotic","tracking","ceramic","taxable","enterprising","flashing","wee","barbaric","deafening","orbital","lurid","dated","hated","buoyant","mating","pictorial","overlapping","lax","archetypal","manic","limitless","puzzling","condescending","hapless","meek","faceless","uncommitted","horrid","greenish","unorthodox","unending","accelerated","day-care","undeniable","bushy","searing","fearsome","unharmed","divisive","overpowering","diving","telling","determining","uptight","cast","enlarged","ebullient","disagreeable","insatiable","grown-up","demented","puffing","inconvenient","uncontrolled","inland","repulsive","unintelligible","blue-eyed","pallid","nonviolent","dilapidated","unyielding","astounded","marvellous","low-cost","purposeful","courtly","predominant","conversational","erroneous","resourceful","converted","disconcerting","oblique","dreaded","indicative","silky","six-year","front-page","biting","flowering","sunlit","licensed","unspeakable","adrift","awash","identifiable","girlish","zealous","spooky","uncompromising","deserving","driven","certified","unlucky","temperate","budding","impractical","public-relations","inflexible","sensory","pornographic","outlandish","resonant","belligerent","wan","leftover","spotted","soybean","easygoing","vengeful","proportional","inaugural","dank","screaming","heterosexual","sliced","year-old","considerate","thunderous","distressed","warring","assertive","foreseeable","psychotic","intermittent","anti-Communist","generalized","unable","molten","excruciating","illustrious","voluminous","offending","trustworthy","grating","laughing","one-year","industrious","uninterrupted","dashing","speaking","metabolic","flattering","one-sided","ineffectual","primal","digestive","taped","floppy","jaunty","practiced","walled","hospitable","dutiful","melodramatic","intestinal","cluttered","conclusive","complementary","unprotected","buzzing","attributable","tasteless","forthright","wily","hourly","delayed","sweating","affable","studied","chubby","thyroid","chilled","conducive","childless","faltering","authorized","buried","land-based","observable","hurried","curving","dismayed","pernicious","upturned","believable","questioning","syndicated","pharmaceutical","high-risk","resigned","discrete","likable","imprisoned","cocky","outdated","autocratic","ablaze","askew","grammatical","wintry","incidental","matter-of-fact","disputed","exorbitant","low-level","sodden","skeletal","disproportionate","soiled","cellular","ephemeral","perfunctory","inconsequential","flourishing","intentional","two-way","elemental","whispered","four-day","stinking","informative","tenacious","outlying","virulent","horrendous","horrifying","burnt","longstanding","senile","unmoving","deprived","interpersonal","intimidating","posh","dainty","portly","nondescript","inquisitive","exiled","capricious","scandalous","severed","debilitating","widowed","horny","sallow","up-to-date","self-contained","carefree","boisterous","coordinated","anti-Semitic","superfluous","metric","expressed","enchanting","disorderly","paternal","wanton","frightful","free-lance","extremist","lined","scornful","inseparable","obese","ponderous","imperious","indistinct","adrenal","belated","rippling","valiant","livid","mystic","cracking","subterranean","invading","rusted","esoteric","red-faced","segregated","lanky","departmental","allergic","predatory","enforced","anti-inflation","implied","flagrant","best-selling","haphazard","trailing","seedy","real-life","unannounced","utilitarian","roving","despairing","immature","simulated","embattled","poisoned","patronizing","baffled","centralized","weathered","weeping","mutilated","painstaking","tax-exempt","socioeconomic","tearful","stringy","projecting","low-key","single-minded","shadowed","vehement","darn","fluffy","apocalyptic","completed","intelligible","furnished","elongated","worsening","eclectic","bacterial","earthy","sagging","wide-ranging","face-to-face","settled","dogmatic","anti","secluded","baffling","coy","pathological","echoing","bridal","autobiographical","instantaneous","ornamental","satirical","voluptuous","movable","kinetic","merciless","tireless","three-month","unconcerned","impromptu","turning","follow-up","retaliatory","arcane","waterproof","justifiable","glassy","unearthly","shuttered","inverted","bogus","petrified","simmering","guided","gritty","widening","generic","pretrial","returning","boundless","swirling","northeastern","swell","tive","minuscule","estranged","upbeat","explanatory","repetitive","repressed","vindictive","shrinking","canny","little-known","hydraulic","unrelenting","looming","supersonic","justified","lukewarm","unmoved","blurred","double-breasted","sanitary","unforgettable","diligent","unconventional","ashen","wordless","stainless","inlaid","irritated","spotless","pudgy","yellowish","lateral","adopted","lowly","obnoxious","utopian","called","unimaginable","hairless","foregoing","opulent","garish","nocturnal","rousing","unexplained","cosmopolitan","milky","medium-sized","all-night","bloodshot","rueful","hard-working","crafty","familial","iced","violet","arctic","ceaseless","exasperated","warped","aquatic","gruff","terrestrial","contrasting","egalitarian","needful","spent","untrained","escalating","liberated","long-haired","abortive","syntactic","consummate","lumpy","spoiled","ten-year-old","talkative","whimsical","weighty","audio","inflammatory","deplorable","spicy","corrugated","morose","sobering","southwestern","three-year-old","methodical","prehistoric","carpeted","smelly","processed","overheated","interstellar","agile","approximate","sadistic","living-room","irate","smashed","frontal","venereal","indiscriminate","suggested","cultured","creeping","recognized","toothless","handmade","mellow","fetal","disinterested","gratifying","trusting","small-scale","intravenous","crashing","exhaustive","afire","clammy","sleazy","florid","heartless","transcendent","restored","demonic","abusive","avowed","shrunken","objectionable","tailored","arms-control","listless","polluted","palatable","funded","elective","entrenched","classy","operatic","daunting","roaring","preferential","languid","three-hour","virile","inspiring","enhanced","scrupulous","bottomless","ginger","wispy","advantageous","rapt","umbilical","uphill","ordered","enraged","detrimental","curt","exalted","hard-pressed","intangible","fussy","forgiving","facile","populous","condemned","mashed","hard-boiled","introductory","rowdy","switching","perplexing","spilled","southeastern","undulating","fractured","inherited","inscrutable","measurable","stunted","hormonal","stylized","hierarchical","air-conditioned","aimless","subsidized","paying","symmetrical","nomadic","cloudless","reigning","thatched","perceptible","anesthetic","anti-American","miscellaneous","homesick","preparatory","seven-year","big-city","decadent","searching","all-important","inanimate","senatorial","diminutive","soft-spoken","contingent","dusky","smashing","precipitous","bulging","standardized","biographical","restive","indecent","upper-class","ecumenical","interchangeable","lumbering","fascinated","untidy","indulgent","leaden","wanted","endemic","doomed","wanting","receiving","engaged","unparalleled","abbreviated","malevolent","wishful","carnival","world-wide","protruding","resplendent","stranded","structured","biased","frosty","northwestern","viral","mindful","paved","indeterminate","painless","second-floor","geological","permissive","downhill","unsuspecting","expectant","fabled","jittery","windowless","evocative","unsolved","disoriented","monastic","soluble","misshapen","antiquated","repugnant","non-Communist","retiring","shaded","combative","high-powered","resilient","antagonistic","starched","vice-presidential","speckled","lopsided","bluish","late-night","prim","unrestrained","almighty","tyrannical","unkempt","menstrual","bleached","overgrown","idiosyncratic","shoddy","hallowed","trying","halting","princely","drugged","gratuitous","descending","fatherly","avant-garde","laborious","pinched","disguised","caustic","bespectacled","handwritten","goodly","itinerant","cryptic","undisclosed","affordable","outmoded","expedient","moody","tepid","firsthand","digging","elitist","observed","chartered","slain","five-day","unimpressed","tactful","idyllic","prostrate","ramshackle","expert","deferred","undistinguished","prized","transatlantic","crystalline","tacky","haunting","nutritious","bereft","turquoise","time-consuming","sanguine","culinary","fraught","precocious","assigned","scrambled","advisable","nationalistic","long-awaited","unwrapped","unchallenged","circumstantial","pleasurable","compressed","humanistic","unforeseen","diversified","frenetic","disapproving","proletarian","conspiratorial","featureless","going","commendable","no-nonsense","chipped","surreal","salient","pissed","insurmountable","backstage","contented","indebted","adoring","one-room","prewar","potted","accelerating","thorny","possessive","abiding","ever-increasing","bloodless","high-technology","counterproductive","attracting","entrepreneurial","cooling","unoccupied","craggy","leathery","degenerate","additive","weakened","quilted","untold","incandescent","intractable","middle-income","abject","self-made","gaseous","anal","displaced","unabashed","immutable","fluttering","ten-year","bearable","stamped","darkening","beefy","petite","charging","high-quality","left-hand","age-old","checkered","stupendous","priestly","loath","endearing","exacting","correctional","freak","sneaky","disgraceful","unholy","oriental","wayward","societal","hard-core","bilingual","flipping","staid","paramilitary","heartfelt","shapely","kosher","heedless","incurable","controlling","in-house","choral","manicured","cardinal","inconspicuous","steely","vanishing","misplaced","centre-fire","enchanted","unfounded","wrecked","womanly","delirious","deposed","panicky","differential","tawny","articulated","coded","wide-open","unregulated","lenient","feathered","simplified","beguiling","sectarian","producing","tiled","inorganic","frosted","lusty","scented","rotating","grievous","dissimilar","salaried","unequivocal","strangled","grubby","alluring","downcast","restraining","unjustified","contaminated","lacy","cinematic","second-class","splintered","adorable","derisive","state-owned","requisite","fleeing","uncomplicated","motherly","inter","high-heeled","climatic","republican","unqualified","leveraged","intercontinental","uncharacteristic","compositional","unwritten","patriarchal","brusque","unresponsive","replete","corrective","reflected","scraping","doctoral","premium","deductible","alternating","amorous","overjoyed","recalcitrant","presumptuous","vaulted","declared","inexorable","groggy","diminished","restful","retroactive","presumed","monolithic","curtained","tortured","ground","trendy","brassy","prosaic","inactive","chaste","bumpy","aggrieved","corny","centrist","trapped","noxious","jerky","concomitant","withholding","poorly","stolid","unguarded","methodological","primordial","retreating","telescopic","sidelong","off-duty","pleated","dissenting","agreed","double-action","optimal","plaintive","banned","kindred","quintessential","impervious","jumping","disenchanted","observant","congested","second-rate","reasoned","extrinsic","infantile","transitory","coveted","small-time","doctrinal","incomparable","jaded","special-interest","sociable","shameless","coloured","ascending","fraternal","queasy","wont","exhilarated","salted","disquieting","listed","unchanging","nine-year-old","unrestricted","uppermost","reputable","dummy","skimpy","crusty","corrosive","bubbling","decrepit","unsuitable","snarling","destitute","illuminating","systemic","material","unwashed","rushing","dialectical","jeweled","attached","liberating","judicious","errant","vanished","worn-out","erstwhile","uninformed","twelve-year-old","longterm","petulant","twin","self-righteous","afflicted","snappy","tantamount","sworn","unethical","drained","hydroelectric","perplexed","logistical","concentric","unifying","lunatic","invincible","diffident","inexhaustible","discouraging","dreamlike","artful","rolled","suppressed","secretarial","smoldering","redundant","forensic","million-dollar","self-styled","earned","weightless","signed","compensatory","glacial","unmanned","stalwart","funky","intensified","uninterested","submerged","urbane","glib","ascetic","contractual","warlike","high-priced","diagonal","cylindrical","gargantuan","illuminated","unconditional","hulking","supplementary","dictatorial","puny","sedate","moonlit","eight-year-old","gullible","counterfeit","alienated","spinning","analytic","nimble","adaptive","individualistic","numbered","blissful","insolent","supplemental","delectable","inordinate","unbalanced","tormented","unchecked","aspiring","punishing","self-serving","crossed","discretionary","box-office","snow-covered","improvised","squalid","orphaned","grizzled","unsmiling","disappearing","affiliated","readable","blocking","bullish","contending","burned-out","bloodied","subsidiary","complimentary","unclean","scanty","uprooted","farfetched","solicitous","regulated","threadbare","choppy","ever-present","negligent","nonstop","one-day","wild-eyed","infuriating","vivacious","abominable","wrought","inaudible","braided","transcendental","desultory","climactic","appellate","interlocking","submissive","unmatched","dapper","demeaning","adaptable","well-meaning","lustrous","tax-free","ungrateful","gentlemanly","missed","loathsome","incalculable","blistering","amenable","tremulous","massed","nonpartisan","unsettled","three-story","succulent","trite","masterful","reticent","unsettling","proverbial","strapping","spurious","invulnerable","paltry","embryonic","repeating","neural","sultry","metaphorical","foreign-policy","linked","pubic","beaming","ministerial","phantom","quizzical","hilly","cold-blooded","gregarious","three-piece","untroubled","bisexual","pensive","unpretentious","exploratory","unscathed","irrepressible","pelvic","newfound","starry","corned","overworked","illogical","unfaithful","interrelated","saintly","overcast","connected","ungainly","organizing","carnal","philosophic","nationalized","fickle","ultraviolet","crass","undeveloped","unprofitable","sheepish","archaeological","out-of-town","balmy","spongy","infallible","callous","scathing","rheumatic","audacious","participating","swarthy","hand-held","comatose","modernist","stellar","antinuclear","delinquent","time-honored","presiding","relaxing","high-pressure","impetuous","hypodermic","fringed","favourite","unscrupulous","inspirational","mystified","wobbly","intrepid","deferential","burdensome","stored","supervisory","seventeenth-century","six-day","interdependent","updated","all-powerful","unitary","stand-up","laconic","penniless","steadfast","dogged","scholastic","convertible","mingled","sorrowful","symptomatic","stylistic","well-intentioned","consuming","sketchy","weakening","generative","atrocious","first-quarter","irrevocable","charged","stoned","dividing","apathetic","debatable","uncomprehending","overhanging","galloping","kinky","uncritical","suave","undisputed","spiky","inarticulate","extracurricular","guttural","impressed","departing","yellowed","discontented","adroit","high-fiber","second-hand","blinking","formless","unsavory","new-found","withered","collected","menial","unobserved","flabby","afterward","vanquished","stained-glass","hour-long","bittersweet","invalid","incriminating","commensurate","all-American","assumed","tried","cursory","absorbing","clearing","confirmed","stressful","depleted","eight-year","participatory","stripped","concave","regrettable","fortified","effortless","regressive","irreverent","collegiate","defunct","grainy","inhospitable","gripping","grizzly","restoring","arterial","busted","indomitable","demure","rabid","headlong","blue-green","bound","breezy","materialistic","uneducated","scruffy","cohesive","full-blown","cranky","motivated","mauve","hardworking","melodic","genital","decorous","comely","rife","purported","hurtful","six-foot","macabre","odious","convulsive","well-trained","heterogeneous","curled","pearly","spindly","latter-day","innermost","clipped","checked","masterly","laughable","naturalistic","tinkling","impudent","fitful","illustrated","speeding","roasted","in-depth","helluva","vigilant","empty-handed","forged","wrought-iron","disgraced","agonized","infirm","preserving","tasteful","onerous","shredded","impregnable","slanted","tainted","opened","first-time","machine-gun","bottled","seismic","fetid","saturated","insubstantial","full-page","aromatic","stingy","promiscuous","unlit","regimental","spellbound","streamlined","bereaved","ruffled","creepy","treasured","ensconced","one-party","well-educated","pert","mercantile","all-purpose","voracious","tortuous","despised","unadorned","offhand","qualifying","manipulative","indelible","well-established","revolting","ethereal","roasting","prohibitive","domed","whipped","overstuffed","garrulous","skittish","revived","heartening","jumpy","grilled","melted","unfocused","spectral","unproductive","top-level","life-size","three-way","negotiable","disloyal","turn-of-the-century","four-hour","unopened","devilish","amorphous","antiseptic","sharpened","primeval","unrecognizable","ineligible","expendable","deathly","auspicious","insoluble","inimical","unquestioned","far-flung","medicinal","deep-seated","formative","iridescent","fragmentary","distinguishable","auburn","closed-circuit","emeritus","third-floor","hazel","tumbling","departed","obstinate","portentous","quixotic","scorched","adjustable","winged","intrusive","taxing","high-ceilinged","barbarous","decreasing","sleeveless","unattended","tight-lipped","concluding","unobtrusive","starved","quirky","big-time","sooty","copious","stalled","scriptural","unconvincing","earthen","throaty","august","extant","sexist","exultant","cancerous","psychedelic","yielding","matched","chunky","unfathomable","concise","admitting","knitted","projective","euphoric","garbled","divisional","despondent","recommended","passable","vegetarian","indefatigable","irreparable","feisty","untenable","contrite","angelic","reputed","untimely","dejected","appreciable","remembered","hellish","rear-view","open-air","ill-fated","nonpolitical","factional","separatist","contributing","post-war","uneventful","metaphoric","unsound","unwitting","venomous","harried","engraved","collapsing","reformist","thematic","inclusive","cheering","springy","obliging","contemplative","unbridled","state-run","reflex","allegorical","geopolitical","disembodied","issuing","bountiful","alright","overbearing","muddled","congenital","distinguishing","absorbed","tart","french","autumnal","verifiable","grueling","crackling","aft","punishable","freckled","indestructible","imprecise","hard-nosed","thoughtless","through","proficient","pent-up","never-ending","hunted","defensible","arresting","across-the-board","spotty","orchestral","undefined","stacked","implausible","antitank","unwary","inflamed","sacrificial","oil-producing","leaky","mint","chronological","conquering","jumbo","three-week","addictive","uninhibited","substandard","contracting","degenerative","triumphal","flowery","cardiovascular","shaken","undefeated","unassuming","luscious","unperturbed","gleeful","sentencing","brawny","perfumed","mild-mannered","healthful","left-handed","rancid","well-defined","unmanageable","drowning","clinging","anachronistic","revered","enriched","capitalistic","good-by","invigorating","practicing","unsold","long-legged","unruffled","aboriginal","inane","bedraggled","early-morning","run-down","straight-backed","reverent","acquired","bestselling","top-secret","woolly","foolhardy","sticking","blue-black","impassable","overcome","coiled","front-line","tinted","acquisitive","slatted","octagonal","receding","investing","doctrinaire","all-white","caring","prejudiced","slow-moving","circulating","science-fiction","shortsighted","disaffected","lawless","chastened","lewd","rubbery","foaming","unsympathetic","ladylike","betrayed","neurological","shouting","good-sized","electrostatic","untoward","flabbergasted","citywide","unanticipated","knotted","whitewashed","year-end","enticing","migratory","multicolored","hashish","ascorbic","topless","heathen","spherical","filmy","deviant","centennial","proportionate","instructional","contrived","savvy","over-the-counter","fast-moving","measuring","uptown","compliant","favourable","unforgivable","undamaged","psychoanalytic","gebling","bubbly","ready-made","caged","ostentatious","superhuman","busing","cream-colored","self-destructive","ostensible","cobbled","whirling","released","showy","baleful","red-hot","named","monogamous","fallow","disdainful","cyclical","long-running","pitiless","diffuse","omnipresent","mossy","cutting","astounding","lyric","dark-blue","unsophisticated","indigent","coincidental","imperceptible","veterinary","coercive","multilateral","ageless","law-abiding","functioning","beneficent","crawling","overturned","steamed","comprehensible","oil-rich","undetected","ribbed","nautical","textured","fast-growing","nauseous","vaunted","paralyzed","maimed","short-range","impure","unintended","practicable","intermediate-range","unfulfilled","behind-the-scenes","backhand","voluble","goofy","apolitical","contraceptive","waning","blasted","sundry","profane","binary","rock-and-roll","ruinous","open-ended","next-door","withering","conical","flustered","decided","able-bodied","round-trip","decreased","half-empty","sponsored","riotous","stereotyped","five-minute","irreplaceable","harrowing","uninteresting","salutary","frugal","disjointed","cupped","freshwater","shaven","ravenous","bulbous","stepped-up","swaying","two-room","valued","planted","bright-eyed","unreadable","trucking","infatuated","dysfunctional","pinkish","futuristic","airtight","unseemly","sizzling","mercurial","conic","unfettered","undisciplined","unrecognized","well-publicized","income-tax","self-appointed","ice-cold","biochemical","contemptible","barefooted","droll","mythological","tree-lined","rearing","luxuriant","heartbreaking","tufted","well-organized","selfless","world-class","unwieldy","contested","rasping","downright","ingratiating","self-proclaimed","parasitic","graying","reformed","cautionary","untested","beaded","maniacal","eucalyptus","pliable","air-conditioning","moot","traceable","anti-abortion","antisocial","reprehensible","self-imposed","yellowing","teasing","porous","ersatz","unwavering","untouchable","underprivileged","auditory","escaping","subservient","unspoiled","anterior","fatuous","lordly","infernal","bouncing","taboo","orthopedic","spiteful","surging","nuts","esteemed","outlawed","pushy","displeased","self-confident","attainable","bowed","cast-iron","despicable","unconvinced","famished","coed","bygone","nonaligned","sectional","typed","squeaky","disparaging","cut-rate","heart-shaped","offbeat","velvety","well-worn","upsetting","leery","long-lost","horse-drawn","puritanical","payable","fertilized","predicted","allowable","peaceable","soundless","marshy","discordant","intoxicating","concurrent","uncut","tantalizing","pedagogical","accursed","two-man","connective","hawkish","ripped","cleared","double-digit","unencumbered","yawning","manifold","stopped","untreated","subliminal","grayish","gory","upper-middle-class","avenging","self-fulfilling","equatorial","saucy","barred","arch","midwestern","blue-gray","tarnished","leafless","incisive","unearned","botanical","feline","extraneous","prep","intransigent","change-minimizing","insurgent","acrimonious","thermonuclear","blue-chip","crummy","acoustic","oversize","fated","galactic","cantankerous","ill-advised","detectable","lower-class","sacrosanct","palatial","conditional","insulated","step-by-step","nebulous","two-dimensional","well-heeled","bronchial","subatomic","semifinal","first-year","dark-eyed","tinny","attacking","indecisive","anatomical","brotherly","blooming","sinuous","meditative","socalled","rheumatoid","received","bleary","half-naked","leaded","woody","averse","shuddering","door-to-door","heretical","suspect","untapped","ravaged","decentralized","rutted","ineffable","intolerant","mechanized","fortuitous","equestrian","seven-year-old","darting","consoling","modern-day","ground-floor","emblematic","lurking","two-year-old","purplish","disorganized","vaudeville","circulatory","eight-hour","presentable","anarchic","unsatisfied","labored","maudlin","trampled","gibberish","unaccountable","sedentary","heavy-duty","thrilled","tutoring","self-centered","do-it-yourself","inquiring","uncaring","disillusioned","bloodstained","surface-to-air","consular","subconscious","four-year-old","collaborative","terraced","figurative","sinewy","horn-rimmed","impertinent","hit-and-run","standby","medium-size","peremptory","incremental","first-aid","dyed","centrifugal","omnipotent","lascivious","two-month","unionized","discredited","mass-produced","feathery","self-indulgent","liturgical","enviable","fifteen-year-old","buxom","abashed","urinary","newsworthy","flailing","beastly","undiscovered","strong-willed","prenatal","brownish","announced","flaky","washed","nightmarish","broad-shouldered","short-sleeved","two-bit","self-assured","whitish","suffocating","black-haired","full-size","self-help","created","uninhabited","smokeless","no-fault","unfashionable","mushy","forested","adhesive","creased","insufferable","down-to-earth","trifling","landless","disreputable","self-effacing","sporty","confined","adoptive","monogrammed","motley","duplicate","silver-haired","rejected","undifferentiated","blasphemous","institutionalized","blue-and-white","hip","winsome","button-down","discerning","abused","clean-cut","bracing","self-supporting","unsupported","premarital","flattered","studious","repetitious","marketable","anemic","meaty","airless","unhurried","galvanized","feal","peace-keeping","rapacious","bulletproof","well-placed","helmeted","packaged","court-ordered","aggravated","gastrointestinal","hand-to-hand","sixteen-year-old","fretful","fourth-quarter","conquered","satiric","nutty","befuddled","humorless","pitched","burnished","mirrored","fishy","fluted","conditioned","military-industrial","one-story","barbarian","branching","dynastic","unthinking","unconscionable","hunched","post-World","capital","putative","incendiary","shaving","topical","self-satisfied","farcical","narcissistic","kneeling","born-again","old-line","amateurish","ill-fitting","scaly","unpainted","eroding"]),nn}var on={},ba;function nh(){return ba||(ba=1,Object.defineProperty(on,"__esModule",{value:!0}),on.default=["man","world","hand","room","face","thing","place","door","woman","house","money","father","government","country","mother","water","state","family","voice","fact","moment","power","city","business","war","school","system","car","number","office","point","body","wife","air","mind","girl","home","company","table","group","boy","problem","bed","death","hair","child","sense","job","light","question","idea","law","word","party","food","floor","book","reason","story","son","heart","friend","interest","right","town","history","land","program","game","control","matter","policy","oil","window","nation","position","ground","blood","action","wall","street","husband","fire","mouth","arm","sound","service","chance","information","price","building","road","paper","court","attention","space","trouble","form","society","art","market","force","effect","nature","chair","period","order","television","president","tax","field","glass","thought","industry","process","phone","plan","center","truth","couple","decision","change","eye","campaign","issue","situation","effort","report","sun","experience","peace","letter","level","energy","role","development","result","evidence","meeting","smile","support","baby","team","show","community","brother","picture","kitchen","production","press","study","daughter","director","dinner","class","defense","piece","record","desk","stage","earth","movement","future","board","security","sea","horse","language","public","church","course","bill","river","coffee","wind","bank","corner","committee","pain","help","answer","subject","hospital","film","economy","trade","feeling","member","apartment","ship","silence","seat","gold","education","leader","pressure","doctor","shoulder","sight","scene","figure","crowd","fear","telephone","labor","success","population","style","station","value","sky","growth","foot","radio","sign","strength","capital","neck","college","budget","breath","choice","direction","guy","agreement","speech","skin","will","amount","plane","practice","marriage","audience","movie","gun","living","hall","concern","income","quality","dog","cause","hotel","race","difference","stone","box","army","trip","distance","attack","chairman","election","presence","computer","science","color","theory","spring","machine","purpose","organization","material","image","tree","surface","officer","administration","act","statement","battle","page","suit","lady","play","stock","list","freedom","bar","relationship","farm","authority","student","conference","ball","structure","nose","plant","career","wood","basis","deal","source","chest","message","stuff","middle","sister","drink","majority","sex","store","trial","character","boat","union","animal","ice","front","firm","heat","hope","rock","weight","disease","spirit","memory","king","response","manner","opinion","operation","increase","lawyer","expression","kid","bag","department","crime","train","executive","aid","dream","beginning","rain","prison","conversation","shirt","lunch","possibility","pleasure","management","danger","rule","throat","wine","behavior","return","hat","surprise","snow","property","flight","training","ability","project","camp","range","approach","agency","treatment","reality","village","bottle","attempt","crisis","drug","violence","inflation","enemy","responsibility","opposition","newspaper","victory","dress","condition","darkness","opportunity","account","degree","pocket","performance","manager","visit","threat","failure","brain","driver","charge","beer","coat","shot","metal","activity","influence","intelligence","bit","official","existence","example","truck","note","construction","shape","event","screen","faith","safety","path","culture","chief","relief","grass","contract","product","investment","weather","soul","murder","bedroom","magazine","model","cup","leg","traffic","writer","beauty","song","share","cancer","patient","credit","club","argument","speed","quarter","design","desire","vision","candidate","bottom","pattern","date","finger","teacher","tea","section","article","flesh","island","balance","spot","meaning","technology","crew","proposal","leadership","concept","object","impact","guard","analysis","birth","shop","knife","advantage","generation","appearance","variety","anger","religion","reaction","fight","star","exchange","agent","investigation","milk","judge","silver","region","steel","ear","sugar","strike","youth","hole","thinking","attitude","supply","start","jacket","jury","taste","secretary","mountain","confidence","master","artist","spokesman","demand","cigarette","track","captain","network","whole","university","conflict","noise","smoke","commission","mirror","accident","plastic","garden","debate","interview","command","tradition","protection","dust","watch","lead","solution","measure","motion","discussion","mission","opening","respect","extent","struggle","goal","tongue","moon","author","iron","breakfast","competition","cover","legislation","environment","sake","justice","fuel","hill","key","length","shock","band","version","contact","engine","settlement","mistake","restaurant","revolution","estate","camera","beach","post","pool","fashion","football","border","touch","laughter","title","background","principle","strategy","roof","forest","philosophy","entrance","pause","doubt","bird","tape","belief","card","ring","occasion","wheel","capacity","cat","collection","passage","writing","bridge","owner","novel","pride","damage","contrast","judgment","gift","division","professor","bathroom","plate","explanation","smell","district","park","wave","player","present","theater","atmosphere","emergency","leather","impression","painting","neighborhood","block","function","circle","sentence","priest","method","warning","editor","ceiling","target","tour","gate","site","baseball","airport","shadow","walk","approval","gesture","individual","difficulty","attorney","criticism","affair","request","doorway","reputation","minority","consumer","notion","general","convention","being","honor","partner","chain","commitment","weapon","joke","coal","meal","reading","detail","library","debt","other","mail","drive","fellow","profit","soldier","forehead","housing","excitement","soil","literature","pilot","dance","reform","volume","scale","imagination","challenge","desert","secret","poet","cabin","average","factor","corn","check","wonder","absence","search","wedding","yard","hero","address","confusion","fool","package","victim","fault","platform","democracy","regime","terror","nurse","stream","offer","medicine","flow","grain","row","county","self","glance","humor","promise","employment","advance","planet","recreation","trail","chicken","storm","creature","mass","stand","gaze","poetry","coast","lake","council","breast","corridor","conclusion","talent","tension","reporter","cut","appeal","total","belt","jail","passion","mayor","claim","combination","highway","wire","rifle","cheek","frame","exercise","incident","testimony","ticket","coach","connection","expert","disaster","valley","minister","deck","territory","chin","universe","independence","counter","resistance","cell","governor","salt","elevator","loan","release","schedule","porch","sheet","cloth","personality","actor","bomb","temperature","bench","break","code","journey","childhood","emphasis","aspect","pot","branch","identity","guest","arrival","recognition","hearing","lap","diet","factory","horror","fence","survey","fate","habit","lobby","bone","routine","discovery","comment","burden","treaty","knee","route","cry","ocean","fund","map","signal","ride","bear","deficit","height","element","sword","birthday","standing","cream","panel","fighting","travel","grandfather","creation","appointment","chapter","funeral","phrase","shore","planning","couch","survival","engineer","wagon","suggestion","waste","guilt","chamber","commander","clock","establishment","flag","content","supper","consciousness","proof","pack","beard","portion","comfort","resolution","sunlight","substance","benefit","honey","protest","prayer","stick","description","device","cloud","display","uniform","gasoline","tail","satisfaction","blanket","mess","consumption","drop","invasion","theme","mystery","belly","association","prospect","port","pipe","reference","skill","rear","heaven","destruction","worker","concentration","file","flat","cab","consideration","uncle","customer","laugh","radiation","favor","studio","boss","transportation","wage","fortune","tent","poem","procedure","clerk","surgery","percentage","expense","cap","household","match","bunch","column","intention","cousin","involvement","host","definition","wheat","permission","can","warmth","draft","silk","aide","lip","conviction","rope","illness","instrument","gap","string","adult","sweat","lover","evil","faculty","enthusiasm","farmer","missile","grin","tank","expansion","emotion","waist","discipline","distinction","technique","profession","wisdom","square","laboratory","tie","review","stranger","communication","pile","arrangement","palm","ceremony","tower","sympathy","deputy","script","nomination","friendship","institution","pass","civilization","magic","client","standard","significance","sport","defeat","announcement","reduction","grandmother","bowl","closet","genius","league","citizen","delivery","button","necessity","reader","lesson","trust","green","experiment","escape","craft","pistol","limit","witness","error","assistant","grace","salary","alarm","fist","potential","withdrawal","phase","bell","perspective","rose","score","amendment","fever","tip","god","crop","vehicle","barn","symbol","tale","exception","shift","scheme","tendency","logic","license","pollution","trend","bath","focus","producer","distribution","cotton","alternative","vacation","muscle","cycle","steam","palace","harm","location","beef","shame","policeman","compromise","tube","participation","fat","item","curiosity","blade","membership","lord","departure","shade","acid","enterprise","jet","selection","jungle","bond","retirement","alliance","bow","railroad","soup","airline","divorce","sofa","gear","gentleman","robe","plot","speaker","examination","egg","handful","recovery","embassy","entry","bastard","improvement","grip","invitation","barrel","context","controversy","fiction","revenue","reply","garage","crash","collar","landscape","grief","pen","teaching","angle","trunk","acceptance","recession","abortion","explosion","application","counsel","dignity","paint","landing","mixture","triumph","stove","winner","summit","thumb","depth","feature","setting","payment","grave","notice","museum","cop","graduate","sidewalk","taxi","trick","lamp","photograph","index","tray","essence","empire","tragedy","alcohol","flower","phenomenon","contribution","shower","castle","cross","booth","lawn","intensity","abuse","determination","passenger","opera","publication","wrist","hint","learning","punishment","ad","skirt","servant","prisoner","physician","midst","purse","rank","neighbor","elbow","contempt","round","cave","coverage","weakness","panic","basketball","juice","shooting","exposure","brick","miracle","unity","accent","coalition","fur","envelope","horizon","glory","stress","delight","politician","conscience","despair","rail","virtue","parent","dispute","killing","corruption","pound","core","stake","proportion","assault","curtain","efficiency","infant","count","suspicion","complex","formation","lock","entertainment","conduct","wit","outcome","shuttle","companion","discrimination","aunt","anxiety","shelter","confrontation","tool","climate","peak","cage","darling","assumption","stability","well","flame","marketing","currency","electricity","text","regulation","comedy","automobile","scientist","cake","scandal","contest","glow","cigar","arrest","brush","boom","basement","document","assembly","output","hut","slave","marble","breathing","pitch","loyalty","affection","resignation","guide","frustration","bureau","adviser","fleet","sector","privacy","awareness","fantasy","speculation","queen","tide","brass","formula","curve","zone","skull","sin","cable","corporation","foundation","achievement","countryside","monster","killer","strain","mask","breeze","whiskey","gang","rhythm","interpretation","basket","extension","tissue","satellite","doctrine","motor","hunger","intervention","kiss","fee","portrait","drawer","analyst","economist","reflection","visitor","transit","reception","provision","slope","sheriff","tunnel","complaint","devil","liquor","throne","hook","temple","tribe","preparation","handle","shoe","origin","helicopter","ruling","injury","crack","flash","gown","jaw","hallway","consequence","depression","subway","leave","drawing","cabinet","initiative","embarrassment","holiday","wilderness","towel","purchase","indication","sink","morality","impulse","rent","enforcement","utility","detective","comparison","critic","dish","hack","photo","crown","operator","conspiracy","rhetoric","bull","inquiry","humanity","demonstration","grade","alley","male","plain","pillow","remark","beast","seed","observation","guerrilla","straw","occupation","champion","excuse","possession","kingdom","snake","nerve","roll","horn","objective","cargo","mate","offense","resort","sequence","apple","bullet","presidency","strip","stroke","pig","print","champagne","saddle","dialogue","suitcase","protein","cook","quantity","toilet","chill","ranch","squad","priority","concert","van","adventure","representative","custom","shell","pension","prince","wound","video","courtroom","suffering","clay","actress","pencil","assignment","shelf","primary","waiter","charm","wool","sweater","soap","psychology","widow","delay","obligation","therapy","sergeant","shortage","myth","collapse","delegation","wish","perception","receiver","sauce","painter","reach","dear","fabric","carrier","ladder","hatred","dancing","cottage","opponent","dealer","prosecution","whisper","spread","poll","beam","exhibition","sigh","fog","harbor","successor","relation","gallery","prize","fireplace","fighter","pit","representation","prosecutor","liberty","bargaining","ownership","root","tin","celebration","stretch","nightmare","transport","link","diplomat","flood","architect","peasant","female","lab","category","inside","tune","carpet","mercy","fraud","introduction","facility","net","temper","rug","conception","eating","legend","tourist","refusal","disappointment","sensation","innocence","transfer","powder","parade","pursuit","parlor","pine","orbit","promotion","senator","colony","cart","interior","productivity","trap","identification","ambition","hip","admiration","corpse","emperor","patch","realm","barrier","ambassador","carriage","residence","maid","gathering","switch","lieutenant","sorrow","contrary","legislature","cliff","lightning","ritual","mist","salad","separation","flour","continent","poison","elite","radar","assessment","outfit","ideology","pad","exile","praise","employee","succession","gain","illusion","option","gravity","journalist","businessman","constitution","singer","sentiment","scope","transition","warrior","cast","march","herd","intent","inspection","episode","uncertainty","spell","isolation","observer","glimpse","privilege","spy","toy","thread","margin","anniversary","irony","organ","lecture","misery","needle","revolver","composition","admission","odor","candy","bid","classroom","bride","vitamin","refrigerator","sandwich","subcommittee","rescue","lad","defendant","blast","angel","compartment","vegetable","minimum","violation","agony","edition","compensation","evolution","treasure","salesman","log","clinic","layer","pitcher","publisher","suite","estimate","airplane","tournament","trace","hammer","reward","broadcasting","running","raid","specialist","mortgage","oak","pole","rocket","aisle","brandy","bureaucracy","mustache","vessel","penalty","export","orange","ignorance","hostility","integration","motive","ban","consultant","timing","equivalent","patrol","liver","assassination","instruction","leaf","railway","freeze","mention","designer","daylight","velvet","amusement","bush","fly","cloak","copper","orchestra","mechanism","chocolate","instinct","circuit","feed","courtyard","mob","profile","bombing","retreat","favorite","revenge","infection","historian","theatre","consent","bucket","mill","insult","pregnancy","psychiatrist","employer","presentation","swing","removal","financing","destiny","label","finish","ghost","channel","equality","requirement","dock","statue","doll","fan","mistress","oven","rim","scent","restraint","frontier","twin","framework","surveillance","diamond","pie","lion","cord","posture","wallet","stool","rally","realization","banker","invention","province","colonel","ally","inspiration","encounter","makeup","certainty","venture","takeover","daddy","ratio","fatigue","verdict","pardon","caution","scream","sleeve","coin","album","acquisition","laundry","transformation","handkerchief","candle","terminal","elephant","madness","appetite","rod","manufacturer","voyage","locker","pulse","indictment","riot","giant","sample","heritage","instance","hay","cure","clan","navy","monopoly","photographer","cowboy","bishop","linen","sacrifice","mortality","dilemma","frequency","harmony","junk","component","bargain","dragon","ruler","replacement","maker","blessing","resentment","surge","costume","editorial","mansion","hood","cellar","bout","driveway","championship","ambulance","sickness","guitar","rejection","compound","launch","journal","sculpture","preference","balcony","lid","toast","chart","motel","agenda","sadness","dimension","verse","scholar","submarine","confession","carbon","thunder","canal","socialism","merchant","bolt","insight","tub","topic","wolf","ridge","shed","gambling","arrow","con","lodge","bicycle","complexity","liberation","disorder","urge","circulation","pickup","distress","spine","romance","anticipation","military","lamb","gloom","pond","republic","ballet","bankruptcy","appreciation","rebellion","custody","feast","fluid","expedition","altar","recipe","array","anguish","harvest","sack","fraction","loneliness","trailer","notebook","surgeon","slip","festival","inability","pan","clearing","making","revival","rack","flashlight","sociology","heir","segment","moonlight","reign","exploration","burst","pet","charity","bundle","assurance","murderer","thrust","conservation","confirmation","outrage","quest","grant","perfection","liquid","stance","jar","essay","addition","diplomacy","rat","outlook","capability","broadcast","cocktail","breeding","immigration","optimism","urgency","helmet","correspondent","breakdown","domain","dressing","dancer","pork","colleague","crystal","insistence","guarantee","lane","dependence","chapel","transmission","hunt","turkey","veto","canoe","interference","sailor","arena","refuge","attraction","thesis","waitress","trigger","founder","briefcase","scholarship","commissioner","stack","lift","greeting","mining","partnership","cane","devotion","thief","troop","menu","finance","coincidence","sleeping","picnic","lounge","dose","jeep","brand","reasoning","proposition","administrator","cylinder","execution","commodity","drum","bronze","staircase","pin","whistle","robbery","catch","thigh","descent","canyon","ballot","shotgun","curb","nod","continuity","shaft","guess","gossip","jurisdiction","revolt","worry","recording","repair","saw","suspect","dome","globe","runway","resident","cemetery","conversion","black","passport","cease-fire","imitation","salvation","cement","creek","nephew","buddy","lung","embrace","ink","simplicity","sunset","astonishment","butt","oath","typewriter","outline","tribute","deadline","hostage","underwear","revelation","reluctance","dread","nest","nut","disposal","disclosure","destination","terrain","procession","recommendation","recorder","potato","ramp","accounting","bat","precision","heap","justification","fork","idiot","biography","prey","ivory","rumor","toll","robot","mix","glare","seal","sweep","haven","bike","courtesy","interaction","secrecy","ham","superiority","synagogue","calendar","ledge","engagement","lace","timber","turmoil","tooth","perfume","magnitude","veteran","lemon","cutting","tomb","accord","ammunition","spear","hunter","acquaintance","grocery","coming","pump","reservation","slide","award","institute","fringe","freight","accuracy","spectrum","ski","diameter","battery","desperation","pounding","variation","ankle","pepper","encouragement","cathedral","expectation","calf","monkey","suburb","rabbit","objection","dismay","boot","pipeline","lust","firing","aggression","ghetto","armor","merger","sphere","texture","moisture","kidney","broker","auction","hose","patent","hesitation","mound","cruise","goat","declaration","regret","conductor","terrace","contention","crap","manuscript","incentive","buyer","gin","principal","steak","novelist","criminal","heel","intellectual","conservative","quarterback","collector","motorcycle","refugee","punch","cluster","clown","preacher","torture","headache","pact","lump","buying","flavor","toe","spectacle","apron","banner","convenience","import","attendant","kindness","verge","dairy","umbrella","dam","inventory","turning","homeland","remainder","gum","plight","container","diversity","drought","reporting","biology","chemistry","curse","scar","merit","spray","reactor","shield","clarity","bamboo","metaphor","vocabulary","runner","luxury","diagnosis","bunk","white","statute","knock","garment","breed","railing","zoo","rival","supermarket","streak","pavement","discomfort","congregation","twilight","bacon","slot","scarf","dime","charter","grammar","theft","sensitivity","mainland","classification","coffin","rider","competence","adoption","reserve","fascination","specialty","mike","temptation","yield","evaluation","passing","intimacy","translation","philosopher","cafe","sitting","superintendent","pill","housewife","signature","correspondence","siege","inn","leftist","injustice","assertion","restoration","registration","farmhouse","denial","endorsement","predecessor","final","demon","greed","transaction","repression","mattress","nobility","embargo","bosom","gym","tenure","addiction","apology","double","litter","nail","incidence","merchandise","volunteer","labour","basin","fiber","whip","payroll","microphone","ax","supervisor","resource","maturity","resemblance","cult","stadium","limousine","welcome","knot","probability","menace","nominee","characteristic","stare","vodka","obsession","nursery","paragraph","discourse","candidacy","battlefield","saint","hierarchy","precedent","imperialism","pope","intake","burial","freshman","rebel","mandate","clause","tile","electorate","torch","adjustment","implication","farewell","curriculum","fountain","satin","subsidiary","humiliation","slaughter","discount","crest","princess","asset","greenhouse","reorganization","irritation","ending","messenger","jealousy","breakthrough","mineral","baggage","mouse","tiger","memorandum","kit","substitute","paradise","stride","deed","accumulation","pledge","hull","projection","apprehension","glue","excellence","composer","decay","ditch","slice","beating","syndrome","parole","pony","saying","vulnerability","rental","wax","renewal","disk","athlete","warehouse","organism","disagreement","suspension","documentary","soda","availability","dedication","delegate","reminder","domination","leap","span","obstacle","counselor","taxation","grandson","banana","rehabilitation","stamp","anchor","diary","tunic","boycott","meadow","backyard","dismissal","rating","disc","glove","pasture","catalogue","inspector","exploitation","missionary","density","sail","excess","chemical","disposition","headline","wartime","atom","bartender","blue","wash","shark","negotiation","monument","mom","faction","echo","tomato","scrap","expenditure","plague","fortress","web","briefing","luncheon","vanity","ribbon","nostalgia","drill","frown","dioxide","sovereignty","sweetheart","cot","tag","laser","purity","melody","sanctuary","citizenship","poster","pal","marketplace","girlfriend","programme","retaliation","researcher","allowance","bedside","yacht","scenario","concession","offering","instructor","motivation","litigation","tolerance","puzzle","compliance","duration","quarrel","aura","crusade","salute","intellect","debut","eternity","monastery","immunity","flock","choir","stern","medal","meter","auditorium","equity","fairy","windshield","mare","conquest","razor","push","kick","battalion","generosity","whale","den","mama","emptiness","hysteria","hillside","ideal","landlord","stem","drain","temperament","orientation","spoon","associate","ash","wig","elimination","bark","boost","activist","stature","liar","vein","tract","telegram","completion","pizza","urine","hollow","ordeal","admiral","psychologist","rehearsal","questioning","musician","installation","ministry","puppet","axe","nitrogen","contractor","poker","arch","tractor","reverse","relative","buffalo","deployment","outbreak","pier","veil","summary","courthouse","academy","confinement","catastrophe","technician","specimen","bachelor","lobster","tyranny","discharge","graduation","shout","monitor","traveler","dope","user","vegetation","deposit","investigator","attic","rabbi","reversal","knight","innovation","probe","altitude","legacy","raft","boyfriend","twist","plaza","paradox","witch","folly","physicist","prophet","threshold","plaster","dentist","telescope","vault","climax","parish","balloon","probation","prescription","liability","wheelchair","blackness","colour","booze","exhibit","vest","abundance","hatch","sketch","cartoon","horseback","investor","violin","hazard","trader","stall","healing","prejudice","scorn","rum","accomplishment","limb","produce","epidemic","tumor","camel","starvation","insect","tenderness","cockpit","maximum","patriotism","chauffeur","parliament","capsule","deficiency","massacre","dessert","bail","meditation","petition","hypothesis","ruin","voter","wait","saving","imprisonment","nationalism","lawsuit","surrender","celebrity","contradiction","disgrace","betrayal","slogan","thrill","enjoyment","narrative","canopy","might","vaccine","fort","stereo","hearth","relaxation","avenue","fright","drift","width","guardian","portfolio","longing","brutality","frenzy","chaplain","chop","tactic","viewpoint","chip","banquet","closing","re-election","impeachment","wardrobe","cradle","facade","finding","tangle","adaptation","hamburger","analogy","fancy","counterpart","dissent","skepticism","gut","advocate","granite","equation","slump","vice-president","nap","foam","buildup","geography","scratch","major","preservation","folder","entity","defiance","nickel","monarchy","shack","teaspoon","chase","remedy","disappearance","foreman","seller","rag","youngster","allegiance","earthquake","columnist","goose","feather","bulb","imagery","bomber","overcoat","harassment","outsider","maze","reproduction","printing","reconciliation","kinship","grease","harp","parallel","stew","particle","accusation","criterion","garlic","boundary","scalp","recess","bearing","warrant","dictatorship","breach","bladder","elegance","fervor","disapproval","monk","tweed","loser","hen","shrug","junta","disguise","gulf","landmark","bourbon","reconstruction","decency","register","feat","hostess","workshop","accommodation","wreck","referendum","viewer","niece","flank","autopsy","boarding","grove","decoration","stain","cape","prophecy","bubble","asylum","commentary","grandeur","subsidy","seizure","badge","limitation","armchair","pro","spark","blaze","centre","split","peril","fusion","goodbye","ringing","solitude","handwriting","crossing","onion","rubber","forefinger","bait","solidarity","measurement","multitude","dump","novelty","truce","perimeter","alien","decree","opposite","constituency","maneuver","ransom","supplier","performer","murmur","coordination","hobby","dough","lantern","cherry","fox","quota","deterioration","flaw","millionaire","raincoat","skeleton","bum","washing","plantation","spotlight","arsenal","villa","sermon","compliment","podium","collision","ratification","jam","loft","theology","escort","tyrant","ore","caste","brokerage","lighter","screw","inheritance","eagle","annoyance","napkin","rationale","flurry","mall","dresser","autobiography","slate","cheer","sulfur","assortment","memorial","electron","detachment","addict","shrine","mold","rookie","astronaut","diesel","neon","heroine","clash","recollection","sweetness","complexion","stewardess","adversary","trance","virgin","screening","classic","nuisance","uprising","shipment","mug","stairway","supporter","famine","stench","click","stupidity","bug","throw","lumber","current","mentality","regiment","galaxy","patron","tap","mischief","contingent","gospel","racket","liaison","honeymoon","foliage","leak","doom","irrigation","mechanic","chef","viewing","swamp","void","mule","lottery","pastor","steward","ranking","survivor","tuition","medication","misunderstanding","prediction","forum","oppression","ale","expanse","consultation","pawn","attachment","franchise","intercom","chunk","mat","pioneer","prairie","familiarity","undergraduate","tenant","chimney","cereal","pub","packet","aftermath","outburst","habitat","federation","deduction","pageant","circumstance","discontent","microscope","sausage","coma","want","intersection","detention","shrimp","deception","illustration","manipulation","ecstasy","dash","eyebrow","ray","persuasion","builder","injunction","foe","inclination","precinct","slab","anthropologist","amnesty","loaf","radical","intrusion","dwelling","calculation","paperback","usage","paste","ashtray","shovel","capture","ferry","preoccupation","joint","filing","spit","womb","puff","quilt","squadron","playwright","rotation","lease","brilliance","burn","cough","spouse","assassin","flu","cabbage","reliance","console","carpenter","dependency","advertisement","lipstick","mahogany","disadvantage","holder","furnace","certificate","alienation","collaboration","extinction","austerity","pupil","tenor","foyer","bluff","whisky","similarity","pouch","chant","nun","hike","babe","com","input","pianist","treason","brake","shake","dividend","repetition","fisherman","pinch","persecution","brightness","disdain","sunrise","gleam","premise","shawl","kettle","forecast","recipient","strap","outlet","chalk","plywood","nickname","fulfillment","doorbell","keyboard","peanut","compass","interval","intuition","clearance","format","shuffling","dent","ambush","chatter","lettuce","harness","hiring","ache","continuation","fit","friction","pretense","velocity","tavern","abdomen","scout","splendor","barber","flap","plateau","hedge","raising","visa","dictator","housekeeper","cafeteria","enrollment","sailing","ingenuity","limp","bard","consistency","ordinance","bathrobe","gauge","strand","taxpayer","spider","coward","reservoir","brigade","self-interest","crackdown","crib","hum","roommate","traitor","blend","kitten","setup","dagger","sophistication","clout","goddess","disability","touchdown","fertilizer","punk","agitation","seminar","hitter","crust","comprehension","nightgown","gamble","freak","stump","microwave","lever","libel","playground","exhaust","abstraction","picket","diversion","advancement","bourgeoisie","coordinator","myriad","dial","diagram","sensibility","donor","endurance","prominence","playgroup","transmitter","revision","consolation","storyteller","jewel","mourning","burglary","competitor","narrator","verb","butterfly","rationality","ant","mister","satire","placement","reunion","plunge","comb","commuter","carving","hormone","creator","swim","clip","necklace","frost","fix","allocation","thickness","happening","disruption","caravan","rodeo","axis","submission","insanity","protocol","caller","porcelain","aristocracy","interrogation","boyhood","muzzle","delicacy","teenager","undertaking","textile","tailor","defence","comeback","zero","wizard","cupboard","cynicism","behaviour","holster","bulletin","broom","receptionist","listener","exemption","flicker","exam","treasury","hug","interruption","no","drugstore","roast","trifle","jerk","exclusion","inmate","contra","permit","gene","melancholy","alcoholic","trainer","perspiration","instability","doorman","deterrent","occurrence","hem","pricing","wear","hog","cushion","commune","courtship","paradigm","down","participant","triangle","apprentice","prevention","forearm","symptom","flush","newcomer","announcer","gorge","frog","platoon","hawk","rivalry","trench","geometry","clubhouse","feller","hymn","dictionary","showing","homicide","crow","pneumonia","gourmet","flannel","congress","dislike","illumination","jockey","superpower","papa","absorption","fragment","catalog","genre","hypocrisy","duel","cone","organizer","fraternity","cubicle","hardship","restriction","gasp","authorization","partition","barrage","groan","waterfront","aerial","cinema","proximity","mockery","compulsion","slum","default","evacuation","fugitive","carton","chariot","masterpiece","nylon","dialect","tee","bathtub","congressman","vapor","disturbance","mailbox","take","groin","moss","shepherd","formulation","foreigner","solo","elder","textbook","predicament","trait","reef","intruder","captivity","commotion","farce","royalty","exasperation","developer","expulsion","plaid","believer","migration","gal","fitness","idealism","galley","offensive","hometown","sophomore","clump","launching","mast","slowdown","generator","make-up","mount","worm","chuckle","prototype","catcher","crotch","interpreter","graveyard","mane","premium","cuisine","jeopardy","reassurance","vantage","condemnation","vase","blackout","token","abandonment","maple","magician","bust","syrup","cassette","pick","madman","cleaner","throng","hanging","riding","villain","squeeze","wallpaper","lime","blur","modification","clatter","anonymity","lineup","polish","accountant","setback","neutrality","modernization","borrowing","kill","dwarf","amateur","expectancy","donkey","fella","contamination","ballroom","kidnapping","popcorn","entourage","crook","ambiguity","coral","roadside","fragrance","slack","spectator","stimulation","groom","rattle","synthesis","tan","skipper","distrust","siren","spin","revulsion","signing","booster","savage","glamour","flute","civilian","flask","tug","misfortune","therapist","plug","standpoint","weed","ecology","footing","patio","decor","malpractice","residue","passageway","chopper","batch","acceleration","depot","quarry","hound","pilgrimage","deference","splash","heartbeat","rap","wedge","indicator","pretext","make","saloon","clientele","poisoning","hemisphere","grotto","ignition","cover-up","ape","transcript","blizzard","crab","ration","puck","propriety","hunch","madam","imbalance","jug","manual","raise","silhouette","sponsor","bore","volcano","crate","humility","devaluation","rocker","rainbow","chap","informant","freezer","limestone","guise","valve","appraisal","handicap","correction","bra","sinking","turnout","manure","pail","cardinal","grape","bee","rumble","miner","dissatisfaction","pamphlet","plaque","chat","injection","pulpit","platter","symphony","molecule","rib","pyramid","shudder","dissolution","vinegar","calling","acreage","chick","cuff","scrub","orphan","porter","saucer","antenna","trophy","rig","convent","good-bye","troupe","ploy","niche","veal","semester","contender","grenade","hilt","spiral","stink","marathon","boulder","treasurer","cookie","peninsula","freeway","rainfall","showdown","parody","telling","statesman","decrease","symbolism","pillar","tremor","penetration","carcass","breadth","psyche","hiss","suppression","pottery","dormitory","scare","overtime","bean","schoolteacher","timetable","buzzer","mesh","jack","marshal","windfall","lance","uterus","inconvenience","chrome","brute","gardener","whim","pearl","fold","trim","ravine","critique","adultery","stretcher","trolley","elevation","worthy","vibration","bracelet","plank","jelly","foil","wrestling","colon","layout","quotation","sting","son-in-law","jargon","likeness","knack","defect","sedan","tilt","chore","moratorium","convoy","piety","acknowledgment","formality","thud","blockade","chord","hush","takeoff","lining","marsh","manifestation","humidity","ingredient","crater","liking","pigeon","abolition","granddaughter","vintage","flourish","playoff","prostitute","prick","oblivion","sociologist","helping","locomotive","contraction","bookstore","surrogate","hippie","sherry","scotch","packing","wink","spasm","conglomerate","ensemble","dugout","insider","sect","inclusion","feedback","trumpet","massage","constituent","brotherhood","directory","newsletter","comrade","grid","turtle","restructuring","reel","spur","comet","dummy","combustion","moustache","oversight","motto","mantle","handshake","mouthful","monologue","buffet","miss","crunch","waking","gray","exaggeration","gait","clutch","courier","hangar","dive","curator","ridicule","diaphragm","tow","projector","eclipse","parcel","lure","transplant","township","squash","commentator","mentor","gutter","stint","treat","germ","infinity","impasse","burglar","proprietor","tariff","dispatch","torment","dove","superstition","going","tempo","warden","sponge","rooster","barge","gorilla","draw","wharf","stallion","countenance","orchard","navigation","tar","biographer","wheelbarrow","imposition","hurricane","stronghold","distortion","starter","rash","feud","parting","interviewer","wrongdoing","lavender","low","leash","envoy","stairwell","backup","doorstep","negotiator","heading","excursion","sewer","endeavor","backbone","rite","vine","gypsy","directive","defender","scoring","esteem","torrent","gland","consortium","nightclub","swell","employe","obscenity","cavity","pulp","lifestyle","butler","peach","tack","fossil","glitter","liner","destroyer","flyer","individuality","roller","outcry","felony","artery","cruiser","bedding","dude","bounty","blindness","bodyguard","corral","coroner","spice","martini","contingency","gag","serving","wail","wrench","sock","safe","spite","broth","trustee","moth","vice","gender","cartel","casting","puppy","prohibition","ox","sculptor","treachery","stir","printer","audit","brim","handbag","lobbyist","jolt","comedian","distraction","challenger","telegraph","homage","evasion","detector","filling","overhead","cartridge","walnut","sonar","puddle","quake","flooding","crescent","thrift","following","tanker","stoop","clergyman","opener","latitude","anatomy","convertible","arbitration","leukemia","absurdity","stab","biologist","baseman","fuse","specialization","carnival","gangster","stalemate","trickle","mallet","working","receipt","charcoal","mortar","drainage","mother-in-law","regularity","emigration","plasma","condominium","muck","workplace","roster","stroll","softness","serpent","owl","infield","sill","swallow","backdrop","fidelity","historiography","thicket","baking","omen","yell","functioning","bribe","dynasty","trough","pudding","alcove","ancestor","ripple","flint","bracket","cube","pasta","proxy","groove","commercial","holocaust","countess","scroll","bang","planting","premiere","norm","bloom","gunman","vow","arithmetic","accelerator","postcard","relish","semblance","whine","inventor","sarcasm","designation","pat","symmetry","quiet","chisel","experimentation","cutter","differentiation","stud","apathy","relay","seminary","escalation","life-style","coil","mythology","futility","intimidation","childbirth","flare","glint","rue","mural","whiff","deposition","vogue","animation","migrant","caretaker","dot","mediator","lookout","captive","blackboard","pocketbook","recourse","negation","plaintiff","shriek","obstruction","latch","manor","casualty","grunt","gambler","erection","nationality","epic","starch","delusion","linkage","provocation","avalanche","offender","melodrama","contentment","appropriation","tonic","salon","accompaniment","paranoia","grimace","communion","cancellation","pendulum","shoreline","hail","refinery","subtlety","videotape","commando","repertoire","refinement","dryer","rust","lapse","haircut","errand","ailment","reanimation","ther","tab","prom","contemplation","bin","gilt","bunker","protector","sage","hilltop","hue","blueprint","correlation","brochure","roadway","arson","remnant","breaking","bouquet","exertion","garrison","beneficiary","colt","turbulence","refuse","bravery","indulgence","assimilation","coastline","livelihood","swarm","configuration","lecturer","paw","upheaval","switchboard","sub","claw","downfall","dye","immigrant","specter","deprivation","shrink","marker","sampling","fellowship","beak","pantry","mouthpiece","gratification","qualification","finality","debacle","extortion","chieftain","speaking","totalitarianism","mole","incumbent","jumper","crush","stubble","terrorist","comic","farmland","contributor","gravy","blossom","keeper","craftsman","pavilion","obscurity","loading","affiliation","vacancy","proclamation","gaiety","yarn","enclosure","clamor","sucker","recruitment","subversion","boiler","emblem","spade","stocking","staple","vocation","sling","maniac","musket","primitive","periphery","idol","snack","antique","redemption","listing","airliner","bandage","bulge","glimmer","priesthood","diner","astronomer","ovation","kindergarten","module","lifting","radiator","booklet","resurrection","precaution","affinity","thinker","quote","turbine","tally","vise","landslide","bakery","portal","majesty","abyss","admirer","turnaround","airfield","wastebasket","lapel","pennant","complication","slick","initiation","rustle","hearse","schooner","carrot","inscription","wench","embryo","vet","poise","disintegration","procurement","speck","kite","vent","plow","homosexual","membrane","waterfall","teevee","matron","utterance","buffer","memoir","cork","recital","loathing","cameraman","throttle","insecurity","trooper","hinge","hoard","umpire","slug","mountainside","affliction","pastime","felt","sentry","denomination","mushroom","linebacker","parachute","teller","fender","trademark","specification","harem","plum","metabolism","certification","neutron","organisation","heresy","relocation","payoff","lizard","termination","dropout","torpedo","stepmother","helm","resonance","heed","progression","braid","cardboard","walkout","shiver","gust","foreground","replica","repertory","sparkle","seam","bump","substitution","rapport","casket","dew","squirrel","palate","hitch","rebirth","reverie","boon","pirate","foresight","vinyl","delta","moat","presumption","tablespoon","aroma","digging","heartland","healer","malaise","creed","archway","exterior","screenplay","examiner","parity","copyright","strawberry","outpost","bookcase","cashmere","bikini","sheaf","pastry","respite","divinity","impossibility","legislator","saga","thump","inauguration","seaman","degradation","strategist","emerald","anthem","affront","burner","entrepreneur","thorn","marvel","stair","cavern","swivel","outlaw","underside","cleanup","fin","catalyst","forage","tapestry","dosage","covering","proletariat","turnover","notch","misconduct","onslaught","upbringing","coyote","bumper","champ","creep","boxer","mileage","vigil","fodder","occupant","dashboard","rarity","centerpiece","consul","ascent","paddle","martyr","doctorate","runoff","grudge","tattoo","robber","carbine","holding","oratory","distributor","heavyweight","footnote","terminology","infrastructure","drummer","chili","tableau","dung","magnet","deceit","caricature","itch","refund","cripple","rectangle","mortal","ancestry","inequality","generalization","furor","relativity","jukebox","dune","endowment","pathology","calibre","subpoena","attrition","hump","congestion","reflex","hoax","honour","herb","mantel","articulation","washer","judgement","brace","printout","helper","wording","crisp","shortstop","boulevard","characterization","cashier","matrix","documentation","deadlock","oyster","chasm","outing","expiration","heater","nutrient","beacon","bile","grievance","janitor","skyline","patrolman","juncture","antagonism","rump","hardwood","solace","warhead","assent","litany","enactment","chimpanzee","rye","feeding","suede","coke","inference","ivy","mosquito","eruption","symposium","variable","cooler","filter","storeroom","mailing","chancellor","beggar","antiquity","inertia","motif","absentee","float","blush","embankment","riverbank","demeanor","vampire","disciple","inadequacy","reinforcement","pedestrian","persona","berserker","tumult","incline","beaver","grill","morgue","denim","wreath","grouping","relic","syndicate","rancher","idiom","hegemony","seating","affirmation","physiology","repose","blight","jest","turret","slit","goalie","clarification","avoidance","volley","redhead","inefficiency","folklore","embodiment","afterthought","steer","cyanide","digestion","continuum","mania","giggle","buggy","willow","pantomime","fireman","growl","devastation","navel","halo","yearning","laborer","alligator","prelude","verification","brown","bead","midget","sleeper","riddle","portrayal","counterattack","lectern","tutor","chestnut","remembrance","aversion","taking","billing","regimen","translator","headmaster","duke","ace","snort","fanfare","imprint","calamity","exposition","cedar","intrigue","transistor","bowel","boardwalk","tramp","ornament","sticker","processor","voltage","sovereign","whistling","caliber","exuberance","snout","enclave","kilt","bombardment","corporal","overhaul","syllable","curfew","layman","consolidation","insignia","mediocrity","coherence","hospitalization","flick","pew","coloring","sanction","baritone","radicalism","savagery","pallet","stead","cadet","shutdown","supplement","unicorn","stepfather","excise","spelling","rebound","puzzlement","tenement","souvenir","veneer","safari","quartet","whirlwind","hamlet","practitioner","parasite","installment","emission","kissing","chronology","mosque","chairmanship","blonde","steamer","caption","shave","standstill","maiden","polling","condor","twinge","campfire","drinker","exhilaration","seafood","gala","crane","hickory","cathode","graph","deliberation","planner","marrow","bud","mediation","cutoff","tit","tic","parchment","noun","culprit","lair","showcase","hangover","chemist","aggregate","thriller","smack","efficacy","smear","heiress","crank","fig","finale","pea","staging","die","rebuke","curry","scum","potency","acclaim","collateral","schoolboy","canteen","radius","deportation","grate","madame","mop","pronunciation","sheen","respiration","breakup","professional","omission","gunshot","ugliness","fanatic","barbecue","dorm","trot","flattery","stereotype","hatchet","capitalist","purge","brew","totality","fern","enzyme","plumber","subscription","cholera","bruise","forge","nipple","commencement","superstar","ether","gem","sash","extraction","spaceship","golfer","realist","encampment","necktie","repayment","skillet","darky","disparity","bedspread","haul","questionnaire","promoter","wand","windowsill","victor","rector","enamel","hoop","coronation","patriot","chandelier","watchdog","glade","renovation","goblet","zipper","communique","crevice","motorcade","sequel","scourge","serum","single","icebox","junction","cache","berth","streetcar","syringe","antithesis","bureaucrat","blacksmith","oval","bun","loot","fiasco","tomahawk","ulcer","pinball","jersey","asthma","brook","pedestal","feeder","soot","inevitability","alteration","carrying","showroom","gimmick","lunatic","gall","fir","borough","hash","woe","controller","sponsorship","applicant","twig","screaming","librarian","intermission","sister-in-law","bushel","inflammation","pomp","vial","extravagance","pate","prostate","dolphin","tuxedo","mathematician","guinea","veranda","aperture","disillusionment","gavel","dating","knocking","oasis","nebula","woodland","yellow","ambivalence","hardness","oxide","socket","wasteland","leopard","blazer","follower","asking","urn","weaving","swimmer","closure","dart","loudspeaker","bazaar","bog","transfusion","reproach","sham","parka","affiliate","scowl","primate","attacker","rink","funnel","spate","elaboration","legality","tablet","heyday","tripod","bully","sharpness","demolition","flip","dandy","appliance","slant","sentimentality","knoll","gloss","defection","explorer","ram","stupor","clone","baton","cohesion","bearer","penance","bandit","aberration","gallop","swirl","coconut","spree","pedal","detergent","canon","teen","brood","phonograph","tabletop","enlargement","sniper","cohort","fable","rising","spill","affidavit","imperative","snapshot","apparition","stunt","wristwatch","chute","teammate","carelessness","over","stripe","postponement","rapture","savior","pacifist","admonition","pear","junkie","surcharge","wavelength","horseman","hag","confessional","comptroller","orthodoxy","financier","snarl","cliche","refreshment","adolescent","teapot","seaweed","drilling","roadblock","antibody","sheath","pallor","constable","misuse","arcade","lee","keep","anarchist","watering","rhyme","exclamation","backseat","great-grandfather","han","pod","daughter-in-law","mailman","alphabet","sloop","reckoning","grower","simulation","homer","birthplace","ence","actuality","depletion","novice","diffusion","concealment","cadre","pathway","fungus","ouster","loner","autograph","descendant","aspiration","better","sick","variant","fragmentation","pesticide","frigate","bestseller","propensity","foul","senate","trouser","airstrip","insurrection","chronicle","coating","stigma","toothbrush","pumpkin","apprenticeship","widower","paycheck","query","teen-ager","shifting","informer","doorknob","ardor","pebble","finesse","scrapbook","fiddle","dowager","sod","wrap","turtleneck","clipboard","rogue","mutiny","suitor","bulkhead","babble","fad","billboard","beverage","hairline","grille","exporter","pathologist","mesa","goblin","scapegoat","crucifix","backpack","observance","forgery","dungeon","methodology","gauze","bonanza","inkling","beret","shouting","ex-wife","wickedness","toil","preview","porridge","cornerstone","scanner","smoker","rebate","mite","brawl","axle","easel","allegation","grab","parrot","antidote","drawl","hijacker","telltale","venom","el","baron","intermediary","seduction","birch","contour","redistribution","cam","protagonist","enmity","hulk","stockbroker","decorator","cookbook","protege","mage","cricket","smock","apex","cortex","modem","shareholder","lament","determinism","rift","tablecloth","trajectory","preface","sneer","gamma","rendition","insemination","aristocrat","hare","labyrinth","thaw","invalid","staffer","alpha","fingernail","medic","crutch","entertainer","jade","eminence","discrepancy","yawn","flea","ledger","orphanage","getaway","manifesto","hijacking","incarnation","elm","adobe","spruce","gist","grit","boar","oracle","mobilization","cantor","crypt","cutback","musical","fallacy","corduroy","fray","racetrack","buckle","foreboding","pest","clap","ber","notation","peek","sow","ballad","brat","constellation","lard","industrialist","hunk","assailant","splinter","bridegroom","dip","fixture","cadence","watchman","windmill","prerogative","drawback","bungalow","heaving","nationalization","mating","writ","rationalization","milking","modernism","landlady","calculator","animosity","workout","skirmish","glycogen","discord","portico","vestibule","renegade","overdose","iceberg","lineage","mosaic","liturgy","watershed","playing","lobe","dowel","ranger","dossier","anvil","co-operation","satchel","fa","corollary","bridle","gateway","brothel","monotony","vendor","mysticism","saucepan","accomplice","hernia","guild","pup","hoof","sparrow","dreamer","craving","outpouring","blink","overlap","duct","brownstone","maneuvering","stagger","foothold","craze","monsoon","induction","handgun","scan","constraint","citadel","rigidity","anecdote","halter","occupancy","rightist","convict","tribunal","stalk","waterway","debtor","yoke","audition","inconsistency","peg","sliver","midwife","premonition","ruby","conduit","excavation","fart","condenser","hop","poodle","upsurge","attainment","stitch","crimson","anomaly","backlog","yeast","chimp","awning","gig","parable","drumming","tiptoe","prow","bypass","crease","reformer","intestine","counterpoint","enormity","anthology","rudder","shroud","magistrate","twitch","commonwealth","circumference","stuffing","sweating","scattering","lender","dripping","legion","refrain","mummy","covenant","morbidity","prop","initial","alignment","licence","infusion","unification","rebuttal","adjective","humour","larceny","mistrust","horde","assemblage","delinquency","testament","convert","patrician","dissension","cider","infidelity","bonnet","displacement","crackle","edifice","conciliation","bondage","schizophrenia","embroidery","standoff","monotone","oddity","mobile","tornado","semicircle","panorama","ex","ping","yogurt","screech","underdog","quay","tai-pan","extract","podesta","ticking","shrubbery","backside","communicator","sorcerer","interlude","dominion","battleground","taboo","blunder","conjecture","drone","cove","maverick","secondary","companionway","rook","gauntlet","ordering","violinist","rooftop","slash","thermometer","vomit","anteroom","deity","nave","acquittal","talker","reed","concussion","malfunction","tundra","cub","anemia","constructivist","cocoon","divide","keeping","percussion","freighter","noose","narcotic","expediency","grandchild","gully","innkeeper","pigment","bloodstream","quiver","alderman","halftime","stable","fission","aggressor","denunciation","abduction","expressway","uniformity","faucet","buff","broiler","allusion","jock","spike","herald","polyester","genocide","fer","parapet","classmate","tinge","sandstone","lurch","skunk","huddle","mum","tranquilizer","pharmacy","susceptibility","penicillin","lark","hoe","lily","hanger","headset","john","appointee","advisor","twine","slumber","magnetism","schoolgirl","smash","screwdriver","newsman","sleet","cleavage","lacquer","milestone","commandant","crick","splitting","rosary","edict","hurdle","fixation","appendix","lock-mechanism","eyelid","swath","fingerprint","carbohydrate","tick","magnate","heck","sailboat","donation","malady","polishing","clipping","collective","sensuality","loom","swagger","facet","variance","mean","walkway","aptitude","prodigy","solemnity","understatement","ebb","scoop","wrapper","narration","icon","prerequisite","planter","gash","interplay","evangelist","drip","vulgarity","subdivision","backwater","euphemism","lotion","corpus","broadcaster","toothpaste","curmudgeon","fo","thong","thatch","baptism","peacock","workman","downturn","scoundrel","machete","creak","five-year-old","dissertation","dishwasher","pimp","electrician","tycoon","otter","shove","snail","rendering","nobleman","booking","pronghorn","deadpan","shutter","escalator","girdle","fling","hire","alibi","flop","stampede","prognosis","itinerary","cologne","spoonful","detour","violet","watcher","falsehood","hype","locale","estimation","propeller","squaw","pickle","lass","pun","racist","scratching","rout","downpour","casing","complacency","camper","equator","reticence","learner","outcast","brunette","improvisation","stag","maxim","loophole","livery","blasphemy","shoot","solvent","misdemeanor","buyout","tiller","jetliner","checkbook","awakening","sideboard","romanticism","squire","newsstand","nuance","consulate","excrement","reprisal","bastion","beginner","obituary","softball","conjunction","scripture","phalanx","vindication","grub","swig","inaction","redwood","scabbard","bonfire","casserole","ovulation","unreality","totem","palette","choreographer","peasantry","skyscraper","penitentiary","outfield","melon","bounce","yolk","diver","archbishop","plurality","amber","recurrence","adulation","piston","insurgency","stoan","coop","tart","eyeball","toss","giveaway","cross-examination","dissident","hermit","ruse","ture","pore","leaving","dowry","gunner","epitome","snowstorm","summation","switchblade","crock","ity","frock","luster","piazza","rotor","impropriety","pivot","blender","immediacy","borrower","slaying","feminist","preserve","bidder","depiction","parasol","clover","intern","asteroid","stub","barricade","medley","multiplier","smirk","knapsack","hank","cognac","headway","treatise","homestead","troublemaker","giraffe","mover","allotment","drowning","naturalist","orderly","attribute","scalpel","shipyard","estrogen","educator","enrichment","grandstand","sire","sideline","landowner","confidant","gel","deviation","clemency","liberal","bigotry","filly","six-year-old","lifeguard","shred","adversity","shelling","pineapple","referee","knockout","jigsaw","retailer","extremity","outgrowth","amplifier","sinner","campground","teasing","steamboat","turban","mutton","cobra","contraption","chopping","schoolhouse","varnish","pane","observatory","ballerina","czar","immensity","lethargy","reimbursement","undershirt","concierge","fracture","variability","accordion","slime","meanness","gelding","practicality","advertiser","graft","gull","stockholder","pilgrim","hooker","puritan","benediction","barbershop","stanza","hallmark","mishap","harpy","silage","enchantment","whirlpool","conditioner","gadget","divestiture","lathe","incarceration","amalgam","antibiotic","annexation","martyrdom","pyre","shank","alert","shale","artifact","interchange","mystic","meet","grinding","triple","boutique","antagonist","fermentation","twinkle","sweetie","shin","creditor","amulet","pall","posse","homeowner","skier","vastness","smith","allegory","oxidation","cracker","levy","ark","sporophyte","enthusiast","snob","spinster","searchlight","waistband","lorry","repeat","reprieve","slalom","respirator","visor","reviewer","putt","miscalculation","shortfall","concourse","dialectic","native","hairdresser","normality","immorality","sprinkling","allure","lick","drudgery","habitation","gondola","vista","ice-cream","cheerleader","predator","countdown","juxtaposition","stumbling","muffler","derby","timer","salvage","boast","cabbie","clam","windbreaker","retardation","antelope","shampoo","raccoon","bible","glider","momma","valise","coffeepot","emissary","compression","grail","guideline","lavatory","glaze","outpatient","thunderstorm","foray","co-op","valet","baker","sycamore","thumbnail","nozzle","timidity","orator","liquidation","spokeswoman","militant","jig","naivete","motorist","dumping","armpit","margarine","exultation","headboard","plume","amplitude","flutter","pronouncement","finery","trepidation","airing","coupon","knuckle","gametophyte","deathbed","extermination","alleyway","hybrid","gambit","nova","binge","original","froth","lighthouse","coolant","continuance","collaborator","fuselage","profanity","whirl","saber","filmmaker","checkup","shaman","rancor","retort","earring","sieve","post-mortem","implantation","conceit","simplification","vat","proficiency","deluge","kiosk","outlay","tantrum","flooring","veterinarian","fireball","carousel","bandanna","glacier","censure","citation","oar","fridge","metamorphosis","superior","approximation","girth","tirade","grocer","holdup","forward","snobbery","cleansing","replay","recitation","facsimile","patter","jubilation","snare","frailty","rampage","pick-up","overture","tumble","residency","prevalence","repository","reentry","battleship","mutation","hammock","importation","thug","semiconductor","ballast","spurt","extreme","artichoke","convergence","circular","rigor","realignment","physique","handbook","bugle","precipice","sauna","skater","furcot","volatility","valuation","barbarian","peddler","layoff","overall","deliverance","chromosome","innuendo","lexicon","empress","polarization","dictum","fitting","impediment","piracy","crocodile","cucumber","keel","sitcom","hypocrite","roaring","encroachment","steamship","resin","fairway","eyewitness","broadside","washroom","sighting","mantra","swan","supposition","governess","upswing","rep","solicitude","rustling","invocation","heather","rectory","orchid","brocade","raiser","invective","fragility","acronym","ostrich","col","absolutism","vicar","psychotherapy","navigator","cartoonist","doe","landfill","invader","werowance","ble","flatness","locality","druid","visitation","headlight","rapist","benefactor","colonization","excerpt","nick","kangaroo","pink","buy","cascade","campsite","slander","headdress","topcoat","causality","karma","trestle","atheist","checkpoint","renunciation","eater","payload","pointer","theologian","beet","undertaker","lineman","hart","gourd","doubling","shuffle","cabaret","periscope","bodice","shootout","grandma","wildcat","proton","dioxin","sorcery","torchlight","stopover","executioner","collage","mesquite","reincarnation","kidnaping","programmer","disloyalty","muslin","throb","mint","aquarium","tel","eccentricity","purification","kerchief","warranty","rigging","breeder","nite","conservatory","fastball","magnification","spa","favour","regeneration","incision","saxophone","detriment","scam","android","coloration","bunny","restitution","rake","serf","despotism","pollen","sidewinder","upstart","revisionist","birthright","multiple","lifeline","queue","follow-up","swipe","boardinghouse","armament","travesty","stirrup","caper","chloride","crepe","primer","clich","inflection","skid","repudiation","serve","spire","peep","inducement","clothesline","fabrication","morsel","spleen","coon","bustle","crossword","back-up","assessor","biopsy","sidecar","hassle","shingle","tint","fixing","collarbone","taint","pusher","gestation","mantelpiece","vaulting","ra","peat","indignity","adequacy","genus","scrape","scaffolding","serial","neurologist","duffel","cipher","rote","horseshoe","bulldog","electrode","joker","juror","fibre","misconception","rut","connoisseur","flowering","op","flirtation","highlander","wisp","sounding","bugger","pharmacist","doughnut","toaster","pinnacle","slob","promenade","amphitheater","singsong","beau","whimper","importer","locket","watermelon","marking","beta","co-author","crossbow","atrocity","desktop","inhibition","draught","rowboat","volleyball","snowfall","extravaganza","teddy","miscarriage","storefront","toxicity","abode","hearty","handyman","centurion","phrasing","anachronism","newspaperman","annex","walker","till","volition","tributary","close-up","nook","cleric","ferment","proverb","inlet","heretic","waistcoat","duet","sniff","crewman","campaigner","wearing","grizzly","p","optimist","placard","overflow","pedigree","clang","brig","cinder","bunting","wag","dishonor","denominator","gong","siding","trilogy","deli","fluoride","questioner","squat","competency","partisan","putter","entree","cynic","tombstone","scoreboard","biscuit","souffle","homecoming","overseer","hideout","brewery","emancipation","interface","premier","auditor","troll","conscription","stout","trucker","beetle","dealing","bookkeeper","build-up","yardstick","da","polity","wick","wrinkle","private","outflow","borderline","outfielder","visage","leper","chiffon","arbor","weave","barnyard","checklist","granny","insensitivity","ex-husband","barometer","rupture","infirmary","desertion","wonderment","encyclopedia","slaughterhouse","nostril","ineptitude","implant","infatuation","laundromat","warship","rub","benchmark","polygraph","dinghy","behind","tween","filibuster","wearer","crayon","sensor","hustler","sinew","progeny","dig","pediatrician","foursome","buckskin","cornfield","safeguard","divergence","ting","coupling","dislocation","the","immersion","purchaser","cleft","overhang","booty","scuffle","rattlesnake","teacup","retinue","hallucination","potion","yeshiva","tapping","rip","multiplication","canister","gallantry","morn","thermostat","grind","aviator","ecosystem","pariah","recruit","vestige","ro","phosphate","abomination","laurel","sweatshirt","vaccination","psychoanalyst","blind","psychosis","sidekick","shopkeeper","theorist","delicatessen","sheepskin","billionaire","receptacle","salami","paddock","glen","beech","leer","mime","ty","perfectionist","seedling","wil","bind","intolerance","dint","plural","rouge","skylight","mammy","drab","microcosm","sole","organist","court-martial","matinee","bulwark","must","expatriate","stethoscope","daydream","backer","godfather","breech","artifice","auxiliary","adventurer","atrium","counterman","idiocy","grotesque","dishonesty","runaway","digit","baseline","reflector","preamble","sellout","falcon","scribe","retainer","louse","grapevine","sojourn","lash","marquee","schoolmaster","squeak","squeal","shooter","townhouse","nationalist","billiard","backfield","auctioneer","aria","avant-garde","hostler","smattering","giving","coaster","arraignment","duo","malignancy","throwback","doc","turnabout","seeker","deletion","vernacular","bulldozer","tedium","hustle","raspberry","estrangement","mutilation","styling","incinerator","wrong","shortcut","mastectomy","infringement","bonding","timbre","cameo","workroom","grassland","spraying","cooperative","tarpaulin","determinant","thyme","innocent","clique","racer","leakage","conflagration","jingle","duplicity","diaper","conqueror","committeeman","robin","reprimand","marina","cross-section","flagship","denouement","recluse","homemaker","moron","rind","gent","magnificence","dispatcher","detonation","harbour","toddler","rotunda","sedition","fell","dolly","laureate","woodsman","syndication","clot","guitarist","blemish","password","overview","eggplant","incantation","drapery","incapacity","florist","hive","civility","mod","screenwriter","intoxication","barman","ern","furrow","cant","clapboard","tumbler","walkie-talkie","pajama","vortex","defenseman","hostel","subjugation","interception","armory","fanaticism","sibling","inhalation","undercurrent","husk","mead","maw","padlock","abnormality","penguin","undersecretary","damnation","independent","airlift","peel","schoolroom","rascal","fingertip","cartilage","dichotomy","blank","lingo","clasp","racquet","acknowledgement","rebuff","bier","aerosol","taping","checkout","arse","thoroughfare","pelt","copse","keg","fissure","tern","mirage","blockbuster","balm","arbiter","shutout","schism","fluff","circumcision","insertion","pseudonym","heathen","eulogy","snowball","penthouse","kinsman","gebling","regulator","proponent","yearbook","barbarism","mutt","reopening","paunch","governorship","differential","airship","subscriber","alloy","adjunct","impairment","incongruity","pheasant","grownup","predicate","loo","sleigh","seer","flitter","sunburn","plebiscite","stockade","pout","sledge","stipulation","lordship","bayonet","wretch","vulture","postman","breaker","newsroom","consort","grinder","ballpoint","tequila","unpleasantness","wrapping","squall","adage","monograph","privation","streetlight","hilarity","sacrament","diminution","mannequin","duplication","banishment","rasp","biochemist","goatee","cranberry","sultan","blip","disservice","idealist","middleman","shaping","apocalypse","strut","oligarchy","moor","zombie","certitude","javelin","azure","turnpike","forger","commode","bleach","sideshow","banister","closeup","dysentery","steeple","offence","commandment","furlough","best-seller","filament","mountaintop","censor","snowmobile","kaleidoscope","elf","imp","slipper","lunacy","telecast","nanny","kernel","eventuality","subordination","sonnet","nitrate","foal","prank","expropriation","fedora","zigzag","resale","namesake","highlight","supplication","concurrence","medallion","jailer","loin","tread","quill","cardigan","prune","slur","surtax","internist","strait","smuggler","panacea","turd","wanderer","crude","darlin","epitaph","docking","seashore","cheeseburger","netting","provider","dispenser","intonation","marching","caress","hootch","morass","chum","sanctum","headband","powerhouse","axiom","terrier","springboard","tot","latrine","toad","clink","herbicide","figger","hick","manger","poppy","chaise","archetype","undoing","beehive","illustrator","withholding","sterility","paddy","coven","custodian","half-life","embezzlement","armoire","kickoff","possessor","rectum","sit","daisy","housecoat","pollster","policewoman","ointment","expressionist","stockpile","bombshell","impresario","co-pilot","chessboard","dazzle","scepter","archdiocese","linguist","odyssey","capitol","accession","lute","liter","multimillionaire","decoy","warp","conveyor","grandpa","ance","mumble","betterment","bullfighter","chador","ampule","indiscretion","shake-up","clarinet","catapult","normalcy","shanty","dinosaur","epithet","tang","scaffold","immunization","repairman","suntan","mu","environmentalist","nightcap","tempest","artisan","orbiter","spiel","needlepoint","geologist","humanist","stutter","perplexity","roundup","concoction","treadmill","cacophony","antipathy","blackberry","bloodbath","brassiere","allergy","hitchhiker","grunting","choke","sitter","elixir","ba","repatriation","whack","decanter","crusader","burlap","incursion","lyric","compilation","seaport","coachman","philanthropy","secretion","collie","inquest","taper","moral","quartermaster","jeweler","salutation","confluence","gullet","tram","hideaway","by-product","drybone","copulation","divorcee","mausoleum","peeling","annuity","set-up","skiff","neurosis","windpipe","buoy","glide","archaeologist","pendant","junkyard","bullhorn","porthole","quandary","irrationality","acidity","pragmatist","derivation","stylist","duplicate","panther","brigadier","introspection","depravity","keynote","vexation","psi","weighing","deserter","speculator","teak","armful","remission","precursor","sorghum","harmonica","olive","gangway","contraband","defector","purgatory","genie","expedient","crowbar","desecration","bathhouse","enhancement","tenet","seasoning","wrangling","downhill","venue","tracery","dictation","bailout","undertone","pecker","prep","forerunner","bandstand","letdown","luminosity","tonnage","catwalk","brunch","sapphire","ballplayer","wineglass","readout","genealogy","horsepower","messiah","blackjack","hemorrhage","damask","registry","gunwale","jerkin","humorist","bowler","tingle","engraving","chauvinist","spirituality","eyepiece","twang","constancy","blot","blob","chard","highschool","sportswriter","tiara","domino","contestant","migraine","newscast","mainstay","hammering","tracker","wager","offshoot","buster","informality","python","felon","imperfection","slag","convulsion","sedative","cellblock","punt","headwaiter","outhouse","monstrosity","nonwhite","override","raisin","inversion","pancake","flavour","cataract","reclamation","churchyard","pidgin","suction","chanting","aggravation","dynamo","pee","fistful","hogan","byproduct","brooch","lullaby","workday","slop","silencer","dealership","earner","anchorman","pittance","crumb","custard","rainstorm","tote","mulch","mason","earl","barroom","levee","discouragement","falsity","compressor","lodging","gynecologist","divination","calico","bibliography","cyclone","senor","gatehouse","lagoon","squirt","artwork","songwriter","derivative","supernova","divan","photon","surety","cobbler","fatality","gout","eleven-year-old","ent","cropping","mainspring","prism","confederation","weaver","neighbour","yuppie","muffin","juniper","ovum","lesbian","pi","shimmer","fax","increment","co-ordination","splashing","thanksgiving","exaltation","confiscation","fairy-tale","fudge","brief","priestess","re-creation","hydrocarbon","ford","usurper","maelstrom","spaceport","swordsman","vegetarian","newness","grad","potter","manservant","fullback","fiend","giver","subculture","debutante","striving","scorer","catechism","charger","armada","blond","paign","handball","wince","appetizer","guidebook","jog","millet","hoot","inferno","pardner","mash","mousse","mammography","launcher","battering","predilection","portent","beep","exhortation","notification","warm-up","diatribe","panda","menstruation","telex","revitalization","workingman","cordon","charmer","fumble","hamper","moralist","settler","chowder","ley","mannerism","drunkard","posting","turquoise","elasticity","abbot","bookie","tusk","paragon","precondition","rollback","lunge","conundrum","eviction","sealer","cellist","cosmology","turntable","outside","fortification","nightstand","spook","shoemaker","sac","sulfate","isle","antigen","steed","bacterium","utopia","stunner","hillock","clove","irritant","tat","memento","rung","gaffe","portraiture","solicitor","rodent","barter","intensification","gallbladder","condom","antiquarian","peck","cheering","meteor","inflow","stenographer","blinking","icing","jackass","dweller","fiesta","irrelevance","harpoon","appendage","stipend","mommy","cassock","microfilm","dead-end","vermouth","scarecrow","fielder","referral","mart","burger","ticker","hindrance","coverlet","speedboat","wafer","sluice","bellboy","hangout","figurehead","midterm","petticoat","matador","skein","beholder","flier","waiver","flotilla","smudge","inequity","mixer","sulfide","banality","roach","billy","tailgate","gaggle","softening","loincloth","gore","bib","chrissake","changer","muse","longitude","tourney","mil","aorta","poop","regression","soviet","placing","winch","apostle","constant","squabble","blimp","abdication","porpoise","puncture","workbench","parameter","conventionalist","flagpole","unfairness","reptile","typist","bookshop","hesitancy","strongman","headland","sprint","manhole","blowing","archipelago","ideologue","slouch","poke","gush","stratum","mulatto","echelon","postmaster","sheik","emigre","alto","affectation","rad","climber","deerskin","bower","idolatry","reciprocity","sweet","wasp","dissection","baby-sitter","purple","toothpick","lyre","archer","sprawl","councilor","contrivance","flake","kynd","suffocation","damp","ware","travail","candelabra","wrestler","patina","moaning","paisley","recruiter","moderator","respondent","marmalade","bellow","harpsichord","atrophy","ejector","jetty","stripper","monorail","dramatist","hysterectomy","riverbed","revaluation","stoppage","conspirator","fetish","sunflower","cognition","scrim","rec","retriever","aphrodisiac","redneck","palsy","pullover","flywheel","roundness","peculiarity","ernment","nectar","ruck","swimsuit","curd","underclass","polka","conservationist","mire","drumbeat","cinch","cordiality","deacon","speechwriter","purr","gelatin","muddle","booby","solid","cloakroom","stopwatch","sportsman","burlesque","overload","mademoiselle","divider","bailiff","handout","ordination","stiff","languor","paperweight","opiate","snap","causation","mower","snatch","touchstone","self-indulgence","shrub","interceptor","mammoth","proceeding","cheekbone","spoke","repellent","cardiologist","reminiscence","sprinter","evocation","postscript","enlistment","blotter","troika","dacha","cabdriver","fund-raiser","switching","para","tendon","fireside","effigy","leech","veneration","reek","schoolyard","pellet","shellac","weasel","jab","carcinogen","restroom","cauliflower","levity","caftan","topside","fruitcake","bickering","drawing-room","dovetail","culvert","chateau","bugging","tinker","hobo","corset","automaker","actualization","oration","handhold","nutmeg","tentacle","quicksand","handler","panoply","bowhead","testimonial","mammal","bellhop","devotee","technicality","trainee","mongrel","newscaster","aggregation","footpath","fawn","accreditation","heave","jib","rationalist","vendetta","midpoint","buckboard","screwball","hatchway","disinfectant","cramp","causeway","tease","corkscrew","sledgehammer","sloth","materialist","mogul","stopper","bevel","carbonate","berry","snore","throwaway","agribusiness","rerun","guillotine","nip","computation","keyhole","storybook","watercolor","cer","porcupine","urging","cockroach","esse","headman","settee","usher","short","obstetrician","faggot","ballpark","palisade","whimsy","co-owner","spout","nub","pectin","dun","cypress","trombone","scat","lite","dame","quip","invisibility","baboon","sneeze","swish","originator","biennial","newsreel","chameleon","dressmaker","storehouse","trapping","statistician","bloke","helmsman","ewe","drape","trump","great-grandmother","cloister","caterer","grounding","hotbed","life-span","urinal","funk","bedchamber","boudoir","theoretician","oddball","nameplate","raven","ditty","canary","anticommunist","reconsideration","playboy","skate","transparency","uplift","six-pack","rambling","commendation","wimp","pestilence","sufferer","kelp","counterforce","self-doubt","deformity","croak","marine","marksman","directorate","reversion","stimulant","dence","beloved","eraser","slurry","tracing","bigot","compendium","entitlement","monolith","misrepresentation","darkroom","nutshell","torque","concubine","peephole","lesion","bogey","spindle","birdie","nugget","tenon","supercomputer","weakling","provenance","vowel","empiricist","filet","co-founder","prelate","onlooker","tricycle","sax","catheter","accessory","fresco","prod","oscillator","self-image","refraction","excretion","prance","insurer","cask","impersonation","rangeland","toothache","magnum","accuser","rubbing","carver","carnation","masquerade","trapdoor","shaker","mittee","tux","poignancy","payday","captor","couplet","mutant","jogger","raider","dilution","sickle","prowl","blister","reassessment","infirmity","matchmaker","workload","restaurateur","tuning","wiretap","perpetrator","davenport","lamppost","inductivist","affect","sterilization","booming","rucksack","repurchase","starship","bystander","taker","spaniel","teletype","cuckoo","sneaker","aspen","soundtrack","sacrilege","surname","succor","co-chairman","anticlimax","hopper","jumpsuit","rinse","rummy","cigaret","washcloth","butchery","almond","cooker","implement","effluent","cheat","threshing","silicone","draining","vector","shopper","dandelion","pecking","brazier","cobblestone","slugger","sacrificer","airlock","lunchroom","zebra","ejection","cutthroat","wizardry","crony","kennel","internship","cohabitation","omelet","wheelhouse","redundancy","schema","psychopath","buttock","grasshopper","playmate","lamentation","socialite","cornucopia","lichen","coterie","warlord","discomfiture","frieze","montage","traveller","curvature","condensation","vineyard","scraper","generality","archive","half-sister","gangplank","intimation","doublet","pleading","tome","quadrangle","connotation","lifeboat","blueberry","coinage","prospector","bash","disciplinarian","dualism","bookshelf","adjutant","clod","apportionment","footbridge","tourniquet","spore","slicker","jetport","magenta","schizophrenic","oilman","harbinger","trespass","merry-go-round","sabra","old-timer","vigilante","melanoma","torpor","gliding","refutation","dab","jurist","plumage","kitty","cauldron","abbey","jasmine","lefty","cabal","detonator","retiree","abatement","clamp","roost","councilman","halfback","centimeter","shirttail","whispering","stratagem","exponent","cheesecake","truism","jaunt","node","ironclad","undertow","self-portrait","urchin","idealization","splendour","antechamber","living-room","sampler","friar","irregularity","lateness","playback","binder","washbasin","tummy","capitulation","felicity","canter","birthrate","earthenware","kitchenette","foundry","ladle","babushka","chlorophyll","adjournment","villager","recrimination","hotshot","blaster","pruning","soloist","hummingbird","recuperation","bequest","hemlock","cottonwood","drawbridge","alternation","malt","interconnection","mugger","tuft","keystone","riverboat","thrall","ayatollah","highland","mistrial","bunkhouse","anesthesiologist","dredging","anode","salsa","prizefighter","neckline","chile","foreclosure","cola","digression","scythe","lout","chamberlain","minefield","sabbatical","appraiser","isotope","demarcation","garnet","buzzard","repulsion","lowland","snifter","bending","weekly","dispensation","botanist","sari","stabbing","ovary","skullcap","journeyman","thievery","look-alike","parson","heartbreak","distillate","neophyte","blower","storekeeper","firmament","taxicab","corona","fusillade","publicist","resume","breather","casement","smokestack","interrogator","outcropping","mecca","dilettante","shoestring","belch","behemoth","negligee","heath","smut","negative","fistfight","regent","incumbency","curragh","toga","ministration","turnip","beamer","stepladder","loon","businesswoman","jumbo","whining","spoor","posturing","parlour","concertina","alkali","rampart","chime","warmup","taffeta","hyena","firehouse","sweetener","guessing","pronoun","madhouse","lioness","breadwinner","diocese","escarpment","mimic","retina","larder","gnat","hothouse","ponytail","markup","bevy","revocation","depressive","garner","redefinition","lifter","stateroom","nutritionist","isolationist","surveyor","polemic","ornamentation","gouge","counterweight","thrower","illegality","joining","lumberyard","wholesaler","obeisance","stagecoach","substage","lockup","nudge","rejoinder","compost","carburetor","peacemaker","prologue","swinger","right-of-way","precipitate","sprinkler","crone","valentine","vassal","tabloid","minstrel","nursemaid","attribution","courtier","docket","spool","convocation","serviceman","letterhead","zealot","negro","cackle","masthead","dispersion","underwriting","armload","noodle","squawk","periodical","reformation","boa","starlet","about-face","ejaculation","encore","harangue","woodpile","earlobe","reaffirmation","handlebar","compunction","contemporary","midriff","nimbus","householder","postgraduate","quirk","innovator","sneak","straitjacket","pussycat","belle","kidnapper","spacing","laying","standout","estuary","duster","jackpot","motorboat","welterweight","kicker","expectant","revue","senior","epistemology","yeoman","firearm","granddaddy","projectile","stammer","crossfire","toxin","hookup","phantom","transgression","flagstone","acuity","twick","acolyte","directorship","corpsman","worktable","mammogram","wart","liqueur","unbutton","receivership","duchess","delinquent","picker","earphone","blare","promontory","formalism","infamy","operative","hock","crusher","megaphone","retrenchment","chaser","dementia","wane","triviality","quadrant","curate","pairing","forging","dermatologist","mango","bon","moccasin","hayloft","marionette","seedship","ooze","interloper","twill","solicitation","trowel","professorship","scrimmage","scrawl","blockage","parkway","motorman","snapper","transcription","vasectomy","binary","flagon","choirboy","butte","throbbing","bound","thunderbolt","dike","cowbell","elect","prodding","lynching","rant","drifter","snot","preservative","brogue","tary","tortoise","lattice","strudel","composite","churn","median","neurosurgeon","mariner","kiln","boarder","ama","petal","friendly","clearinghouse","swastika","filler","enquiry","dispensary","chump","archeologist","rescuer","dy","draftsman","snicker","shakedown","romp","construct","conclave","winery","polarity","breakin","wailing","gurgle","bedroll","commissar","albatross","shading","peal","taverna","chicanery","has-been","waistline","oaf","satirist","faint","myosin","dimple","landfall","smithy","tough","gunboat","busboy","cassava","poplar","discontinuity","obelisk","blubber","demonstrator","meltdown","abolitionist","thorax","holler","pimple","sending","druggist","indirection","leotard","ken","showman","despot","ombudsman","lyricist","dearie","lumberjack","gaff","pagan","cremation","infarction","sturgeon","publican","bottleneck","chambermaid","pectoral","purser","godsend","whisk","canard","concentrate","copter","shipwreck","laundering","clipper","notepad","jackal","indentation","basilica","adhesive","mermaid","knighthood","personage","omelette","whoosh","embellishment","misgiving","tracer","brawling","crucifixion","steal","transference","sleight","threesome","windowpane","bereavement","viceroy","betrothal","refresher","seagull","jay","needler","discoverer","goiter","caterpillar","impostor","diminutive","cation","playpen","amputation","confidante","dockside","inquisition","chronicler","seamstress","lath","absolutist","cadaver","perusal","subterfuge","self-satisfaction","sawmill","agitator","shortcoming","breakwater","microcomputer","lima","greatcoat","mahout","prima","undress","superstructure","stopgap","moo","bio","fret","pomposity","bough","autocracy","anchorage","samovar","gen","burrow","rosebud","segregationist","mortise","hydrant","postmortem","oversimplification","entryway","paintbrush","rea","balustrade","chuck","trumpeter","ferret","opportunist","pinnace","salamander","transom","mace","individualist","synthesizer","thoroughbred","cupola","tomboy","ensign","bottling","whir","poultice","entranceway","saver","gurdwara","renegotiation","tossing","ruffle","footprint","skeptic","birthmark","tailspin","kickback","chalice","plagiarism","passer","inhumanity","ceremonial","sapling","babysitter","creeper","galleon","bellman","holly","hacienda","cur","transplantation","scab","ballgame","demotion","flimsy","hovel","lug","layup","firefighter","gravestone","nymph","cajole","tickle","boxcar","secession","refractor","somersault","personification","treacle","tutorial","voucher","thimble","stickler","front-runner","paroxysm","exorcism","psalm","infestation","scrubbing","castor","peppermint","orchestration","extremist","oppressor","lode","prompting","watchword","swindle","statehouse","floater","nightdress","bloak","elegy","woodshed","trembling","banning","adornment","redoubt","lightweight","postulate","anti-Semite","tasting","viewscreen","sentinel","nation-state","heft","nurture","villainy","manhunt","invoice","sprig","self-denial","selector","piglet","commemoration","crucible","piper","curtsy","lackey","breastplate","gadfly","octave","epilogue","self-examination","thyroid","apologist","chemise","super","figment","waif","essayist","brewer","miniature","sediment","cannibal","tulip","caramel","caseload","synonym","analogue","ver","shirtwaist","cornerback","insecticide","debauchery","lien","strangulation","intricacy","guesthouse","crumbling","glassware","cachet","thumping","damper","colonist","frolic","ogre","heist","sorting","pawl","muttering","refill","cowl","imbecile","painkiller","garter","creole","overpass","simile","potpourri","piling","predisposition","corsage","mobster","sandal","aphorism","vice-chairman","heartache","converter","pecan","ecologist","substrate","quagmire","trenchcoat","voyce","overstatement","soapbox","rediscovery","effusion","agronomist","firecracker","haunt","murmuring","henhouse","fluctuation","signora","mulberry","hoist","bullfight","discotheque","finder","tureen","hairstyle","dignitary","consummation","spar","pogrom","beeper","read","outboard","sho","skit","impurity","sadist","parafoil","bouncer","spender","locust","boardroom","burnout","inoculation","surfeit","welder","propagandist","mortuary","pessimist","equivalence","juke","spatter","incubator","reproof","gulch","notary","speedometer","lodger","mitt","southpaw","footman","amity","bloodline","cleaver","coffeehouse","confederate","assist","ation","lecher","abrasion","daybed","knit","laddie","forfeit","kebele","filigree","frisbee","cantina","oscillation","countryman","juggler","scion","acrobat","hourglass","realtor","onyx","pettiness","chancellery","footfall","slippage","mandarin","eral","lob","impertinence","providence","dom","idyll","democrat","deferral","sorority","slamming","badger","mutter","ling","strobe","explosive","municipality","crossover","bedstead","spatula","tug-of-war","goon","pauper","lation","sacking","alder","nightstick","salve","infraction","prowler","falsification","pant","drunk","rumbling","ce","minuet","plaything","yelling","kiddie","duction","buttress","carapace","sobbing","insufficiency","prig","bidet","bloodhound","madwoman","buffoon","vignette","doorjamb","caprice","gable","converse","cad","creche","mullah","spectre","spotter","ingenue","chalet","automatic","stash","truckload","tailback","static","productivist","dissipation","haunch","nag","awl","self-delusion","rattler","blacklist","beagle","trapeze","obstinacy","fiddler","theorem","rearrangement","changeover","reassignment","courtesan","fillet","nay","cutout","luncheonette","purveyor","incitement","remarriage","amelioration","executor","buttonhole","duality","churchman","sickroom","farmstead","jester","perfidy","cuticle","weal","snub","pretension","roadbed","furnishing","quickie","workweek","conveyance","pseudopatient","turbocharger","fleece","abbreviation","spigot","leaflet","great-aunt","ninny","beaker","experimenter","validation","inhabitant","grading","cantaloupe","potentiality","flue","commoner","playroom","readjustment","boathouse","vivacity","brakeman","petitioner","singularity","gage","delineation","fester","paratrooper","font","pitchfork","signifier","crossbar","playhouse","tripe","stylus","pacemaker","clustering","hone","runt","emporium","ragtag","aneurysm","trapper","pulley","thrashing","candlestick","checkerboard","swoop","surcoat","dystrophy","bristle","beck","toolbox","hunchback","subcompact","doze","seaway","disclaimer","arbitrator","miller","crackpot","loafer","instigation","sen","bale","skim","skip","dollop","tender","oeuvre","goner","sor","tort","cropland","profundity","caf","zoom","gabardine","quack","cataclysm","condolence","foxhole","circlet","brave","misfit","bivouac","artificiality","dachshund","puke","bagel","sortie","nomad","opal","ethnicity","firebox","ratchet","cud","worsted","squabbling","cheque","jean","avatar","dirge","footstool","velour","barrister","pression","microchip","coda","reappraisal","cess","hangman","centenary","plough","broomstick","headstone","tormentor","sore","rathorn","voyeur","world-view","co-star","warren","fail","deflation","noble","fleck","saleswoman","hap","machinist","waffle","tom","ell","prefab","suckling","guardhouse","sabre","entanglement","integrator","quarterly","paraffin","heifer","frivolity","good","bougainvillea","excommunication","distillation","cyclist","meteorologist","rubric","cul-de-sac","misnomer","phobia","demagogue","bloodletting","raconteur","ger","astrologer","zygote","counterrevolution","reinstatement","anchovy","getup","tryout","scullery","turnstile","cyst","mustang","gaslight","self-deception","emanation","grown-up","escapade","versity","fishery","paprika","grailstone","gurney","fount","holdout","licensee","jackknife","asterisk","still","fundamentalist","humbug","repast","christening","butternut","miniskirt","fortune-teller","spillway","ference","salver","payout","nodule","high","tugboat","gizzard","sympathizer","fibrillation","incompatibility","dodge","trove","mercenary","pigtail","matchbook","masterwork","barb","endeavour","confection","ephor","yarmulke","char","mimeograph","holdover","subtitle","saddlebag","metronome","tine","testicle","caveat","etching","auntie","guarantor","ringer","airman","boatman","carnivore","armband","polder","tryst","lem","sitting-room","barrow","reappearance","pastiche","bankroll","stroller","saxophonist","blanc","redesign","plotting","gruel","juicer","slat","scooter","socialist","gradient","ember","scorecard","remembering","bo","forecaster","flirt","backache","parakeet","pixie","guffaw","anesthetist","logjam","pursuer","physiologist","follicle","coverall","patsy","bunt","lubricant","jawbone","numeral","mourner","rune","bettor","solder","nitrite","rime","pinstripe","pistachio","monocle","equivocation","crystallization","twit","two-year-old","toupee","eyelash","recognizance","cy","sophistry","seesaw","loony","do-gooder","dusting","commonality","yearling","disbarment","self-congratulation","tsar","vagabond","rhinestone","viper","planetoid","crochet","laird","flatland","prompt","catamaran","wigwam","mainframe","shivering","stringer","vane","iniquity","hoodlum","tableware","smelter","overlay","umber","placenta","yew","right-hander","laggard","cornice","philanthropist","scouring","dissenter","mainsail","showplace","conch","sentimentalist","protectorate","sanitarium","truancy","angler","showpiece","carotene","pollutant","diabetic","hairbrush","videodisc","intellectualist","pothole","setter","tense","grader","kneecap","birdbath","dell","typhoid","tuba","torturer","commie","houseboat","revelry","medalist","hinterland","jowl","splotch","sable","mouf","ripoff","coolie","streetlamp","damn","sharecropper","oral","schoolmate","commander-in-chief","capitalization","flex","shtetl","chenille","pullback","pharaoh","claret","fulfilment","glower","remuneration","internationalist","pap","pediment","sonata","toke","co-director","dollhouse","salesgirl","greenback","analog","ofa","freelancer","hairpin","aphasia","kicking","bummer","lawmaker","thickening","juggernaut","comma","sander","claimant","triad","rhizome","prolongation","placer","transvestite","faceplate","shortening","coffle","surfer","greengrocer","roughage","dumbbell","coiffure","pinky","ex-President","start-up","bobby","sidearm","paean","raiment","conceptualization","surmise","agnostic","cranny","tassel","infarct","pitchman","minor","stationmaster","sublet","puter","dramatization","mounting","washstand","counsellor","penknife","curtailment","remake","millimeter","sextant","vocalist","blowup","walleye","pickax","fanny","ascendant","brushing","highball","bandleader","winning","godmother","horoscope","disequilibrium","run-up","grazer","sandbar","motorbike","hassock","piggy","teat","reprise","wheeling","psychotherapist","calabash","cob","relativist","packer","slayer","digger","banshee","autocrat","knave","muskrat","extinguisher","foreleg","sobriquet","hospice","accretion","mastermind","figurine","newsmagazine","epidemiologist","pic","minaret","dereliction","city-state","jawline","escapist","legation","weatherman","sinker","cabby","guardrail","objector","timepiece","cistern","werewolf","decadent","harlot","epiphany","bricklayer","doorkeeper","obsidian","bedpost","constriction","refectory","blackbird","enforcer","riposte","schmuck","squab","pop-up","handrail","sandbag","superman","underbelly","alarmist","sesame","paratroop","droplet","proclivity","theorizing","quark","tactician","sundae","poolhall","behaviorist","dipper","postmark","co-conspirator","carload","electrocution","mould","goodnight","appendectomy","statuette","coefficient","cornet","scolding","prude","platitude","carport","lilac","geisha","foist","mitigation","percussionist","lechery","wyrm","charlatan","tussle","slough","jamb","twister","lakeshore","scavenger","pinkie","changeling","pinhead","muster","exploring","fief","critter","haystack","skimmer","geyser","stumble","update","tabernacle","gargoyle","projectionist","requisite","suffix","ramrod","betrayer","perience","tance","fluting","flare-up","fatherland","guardianship","douche","good-night","trawler","headsman","stoplight","operetta","spend","hater","teakettle","geneticist","particular","wardroom","slider","deuce","gingham","telethon","acclamation","centrifuge","workstation","pretender","prong","lampshade","ureter","hiccup","acetate","molding","wallop","vagrant","three-star","carafe","blowout","equinox","rave","junior","spoof","confessor","troubleshooter","braggart","judgeship","rapier","landmass","stoic","cuckold","inheritor","forester","jangle","gymnast","wingman","stein","gnome","drumstick","whatnot","yachtsman","realty","glob","by-election","academic","deflection","knocker","wondering","mugging","petit","frosting","pillowcase","panelling","grendel","tribune","tabulation","simulator","whaler","stork","gill","cavalcade","workhorse","locksmith","preppie","henchman","countertop","groundcar","puree","wellspring","debasement","prankster","tration","insert","put-down","typer","chartreuse","crematorium","headpiece","noncom","wipe","drove","sportscaster","impersonator","shrew","twitching","loader","magnolia","dropping","functionary","dissonance","cudgel","forfeiture","glutton","reject","doubleheader","tarp","suburbanite","afghan","chaperone","bas-relief","oscilloscope","imposter","newel","trusteeship","shocker","cannonball","half-breed","woodpecker","tumbleweed","snip","consignment","left-hander","spoil","also-ran","exhalation","signification","tester","ashram","gardenia","deductible","frontline","subtraction","bowstring","upland","bearskin","gramophone","mock-up","serenade","mix-up","extrapolation","tidbit","semaphore","banging","dogwood","carol","mapping","exchanger","ignominy","retraction","videocassette","precept","sirloin","mortification","pagoda","belfry","cubbyhole","mindstone","greyhound","clank","snowbank","instep","sanatorium","savanna","longshoreman","copier","nightshirt","boatyard","brigand","usurpation","understudy","interrelationship","undercarriage","sulphate","quasar","marshmallow","thrush","sweeper","alleviation","feint","chimera","infidel","modifier","perennial","simpleton","gridiron","overlord","airway","binding","abstention","algorithm","amalgamation","ascension","herdsman","lollipop","pastel","laminate","tendril","synopsis","drawstring","intermarriage","restorer","swoon","firefight","civilisation","self-criticism","hanky","ventricle","jot","interferon","circel","avenger","stepson","amethyst","beachhead","loggia","sizzle","burp","watchtower","endearment","dryad","prefect","tong","croissant","blocker","brioche","thistle","sunburst","savor","dumpling","checker","soliloquy","marketer","wheeze","molar","oboe","inbound","masochist","superficiality","tabby","outcrop","deputation","bassist","particularity","strop","thang","doggy","zation","ghoul","domestic","frostbite","relapse","floorboard","clicking","paraphrase","sinkhole","pushcart","overdraft","spinnaker","sourdough","sweatshop","meteorite","lander","caboose","junket","planer","iguana","brouhaha","reaper","sharpshooter","eggshell","self-sacrifice","minnow","skyrocket","connexion","effrontery","oblong","biker","flinch","cog","bullock","retrial","underwriter","gentlewoman","noggin","sissy","collect","dogmatism","sweatsuit","biplane","polariser","server","hiker","electrolyte","thunderclap","bronc","snooze","mascot","sherbet","carillon","decal","womanizer","underground","tailcoat","worshipper","automaton","proscription","sleuth","honeybee","abutment","foller","palladium","partake","jailing","counterfeit","pompadour","moneymaker","acacia","monthly","geographer","doghouse","bludgeon","fitter","conservator","indecency","atoll","fife","acquit","barracuda","mortician","striker","plait","untruth","hoarding","eighteen-wheeler","shakeup","grounder","abuser","hamstring","parishioner","cherub","cubist","antler","kisser","shunt","cravat","admixture","whinny","scorpion","amenity","matchup","spacer","settling","insinuation","possum","tenancy","girder","adapter","mousetrap","cubble","steppe","hypochondriac","covey","whipping","taunt","pocketful","pug","panhandle","conga","citron","foul-up","plaint","nouveau","oilskin","meridian","lifer","bolster","wren","gripe","mountaineer","transceiver","treetop","hex","harrow","tampering","photocopy","redskin","cesspool","barrette","cleanser","missive","breakfront","mini","ridgeline","semi","pasha","byword","phoneme","seducer","miser","cookstove","limerick","cummerbund","labourer","ascot","wraith","tarantula","toffee","pituitary","liana","cleat","line-up","helix","highboy","bicep","partment","coed","expletive","dumpster","deferment","progenitor","sandbox","mignon","typhoon","sublimation","backdoor","alchemist","pacifier","insomniac","hairpiece","lintel","indemnity","blurb","republican","electrocardiogram","futurist","recliner","mote","sketchbook","fulcrum","gratuity","aqueduct","adherent","masque","sundial","template","handmaiden","hedgehog","coding","corsair","solstice","orifice","sonobuoy","prizewinner","spinner","townsman","rosette","mind-set","unkindness","pushover","bility","infielder","hutch","erasure","parallelism","avowal","fastness","broadcloth","hellhole","grandparent","toehold","ident","sleepwalker","watching","aerie","database","mismatch","hombre","scrambler","spoiler","putdown","rookery","spinoff","ringleader","duchy","sealskin","transformer","doggie","bedsheet","cowhide","ceramic","prostration","cheroot","houseboy","giantess","tomcat","speedster","basalt","minicomputer","rapacity","spaceman","in-law","equerry","humpback","academician","harvester","fairground","ream","carat","entreaty","groundswell","obfuscation","provocateur","fugue","denigration","rifleman","manipulator","panting","synod","glitch","nightie","goaltender","kingpin","comforter","anesthetic","klaxon","hijack","orb","hostelry","gladiator","misadventure","bombard","fixity","tanner","stringency","wonderland","x-ray","plainclothesman","roadhouse","travelogue","gasket","nibble","hacking","nude","tincture","receptor","fink","schoolmarm","washtub","homesteader","hacker","portiere","hatbox","tamer","howitzer","grouper","frontage","amoeba","clime","flashback","teamster","accolade","polluter","officeholder","inpatient","altercation","reverberation","coproduction","phosphor","substation","bandana","sapper","preserver","pigeonhole","prefecture","milkman","avocation","argyle","amphetamine","linker","leviathan","hamster","bondsman","comer","bumpkin","sheikh","beefsteak","tyke","discoloration","kingmaker","quotient","excision","whitey","asymmetry","trill","discourtesy","bleat","hatching","crier","creel","seabed","witticism","riser","lurcher","moviemaker","pantsuit","linchpin","deformation","deodorant","soybean","washboard","egotist","underpass","dysfunction","tingling","barstool","paramour","udder","microbe","radiologist","qualm","welt","salesperson","signpost","sepulcher","lumpectomy","slaver","shopgirl","peregrine","siesta","reiteration","profligacy","iodide","iconoclast","rollcall","fillip","oratorio","splat","incoherence","accompanist","motorcar","nunnery","busybody","carryall","nettle","jaguar","pretence","odometer","potentate","mussel","prophetess","monetarist","proach","typescript","hacksaw","broadsword","miter","fatty","terrarium","archangel","powerboat","stooge","cannery","pylon","pulsation","misstep","yucca","hearthstone","rumour","lockout","toboggan","trampoline","concatenation","debility","acorn","forklift","psion","dragonet","ligament","folio","tie-up","picking","swatch","arrowhead","martinet","fisher","quintet","ellipse","legitimation","nightwatch","hardback","schemer","conversationalist","collectivist","reallocation","diorama","cutaway","point-of-view","cattleman","abscess","talc","incubus","dribble","sis","rhododendron","rolling","spiderweb","nonsmoker","crissake","refusenik","save","obstructionist","suture","parenthesis","reefer","great-grandson","steelworker","bumblebee","bullfrog","festivity","embolism","defeatist","tankard","ferryman","garret","co-worker","consonant","copywriter","bookseller","compress","dogfight","embezzler","quiche","liege","dissector","taskmaster","prosthesis","emulsion","spitball","modulation","squint","retelling","baiting","whirr","air-conditioner","individuation","geezer","aspirant","pensioner","re-enactment","flapper","looker","marshland","sexton","adverb","coenzyme","misapprehension","inaccuracy","barmaid","beautician","daredevil","racehorse","oxford","spume","busload","tradesman","manicure","propellant","apothecary","ruffian","titillation","instigator","siting","ringmaster","enumeration","twirl","bookmaker","technocrat","mouth-harp","quaver","icehouse","ventilator","roadster","subpena","carter","comedienne","savannah","milkmaid","pumper","signer","deadbeat","cofounder","bootlegger","tribesman","wildfire","shard","hailstorm","struction","routing","dolmen","idiosyncrasy","poniard","honky-tonk","spendthrift","draftee","hermaphrodite","pinafore","roundabout","frill","redeployment","ophthalmologist","caldron","reinvestment","troubadour","fjord","leave-taking","elongation","clinch","trinket","suasion","neutralist","finalist","whiplash","ventriloquist","violator","monarchist","spanking","grindstone","initiator","standard-bearer","sender","atelier","distemper","ingot","frontiersman","altarpiece","endgame","homily","synapse","pillbox","ochre","scimitar","jubilee","presentiment","tation","aggrandizement","truncheon","damsel","fallibility","papaya","piggyback","puppeteer","workhouse","nightingale","entomologist","wicket","debriefing","logician","moorland","minimalist","matte","skirmishing","tonality","maidservant","yam","gatekeeper","whammy","drudge","angora","garland","manoeuvre","moviegoer","slingshot","titan","re-evaluation","ironwork","ambassadorship","lanch","pollination","riage","vocalization","brawler","shaving","particulate","inhaler","impoundment","surfboard","waterman","almanac","pepperoni","kook","colonnade","infantryman","scruple","functionalist","wisecrack","conscript","boor","bannister","pretzel","analgesic","firebrand","microprocessor","frame-up","guardsman","teetotaler","broad","pallbearer","airframe","wrangle","backboard","knockdown","reparation","poorhouse","milkshake","battlement","dragonfly","paymaster","snuffler","crudeness","nerd","blockhouse","donut","backhoe","principality","dimmer","wounding","collier","beater","footlocker","barkeep","absurdist","brickwork","great-uncle","rumination","appellation","joiner","hydrolysis","interlocutor","raindrop","hardtop","groping","cymbal","miscellany","pomegranate","hearer","abortionist","corncob","shoal","dunce","bellowing","bridgehead","mangrove","blotch","boxwood","briar","which","trickster","epileptic","dependent","encumbrance","claque","pickpocket","half-truth","bilge","overrun","caveman","posterior","derriere","sty","maggot","vibrator","imbecility","hang-up","syllogism","blindfold","sunbeam","chrysanthemum","amour","ne'er-do-well","odour","flowerpot","satrap","reconnoiter","tonsillectomy","clampdown","coliseum","warbler","hubcap","crudity","baseboard","lithograph","homeroom","stanchion","amphitheatre","disquisition","commonplace","feedlot","reprint","shire","kraken","careerist","goatskin","worldview","waddle","washout","doormat","diadem","sniffer","spat","superhighway","snooper","libation","zoologist","subtext","bailiwick","exterminator","popsicle","actuary","cabinetmaker","swami","contraceptive","softener","margarita","hatter","tention","earpiece","dormer","timberland","katun","crooner","one-liner","adjudication","snitch","referent","subset","disavowal","starburst","merchantman","dalliance","polymer","hypnotist","monogram","peerage","claymore","satyr","twerp","matchstick","rubber-stamp","clapper","exhibitionist","warhorse","eatery","seashell","radish","router","dinette","trombonist","rivet","requiem","breakaway","hard-liner","locator","shindig","corrective","truffle","whelp","expediter","savant","mitten","canton","wobble","misinterpretation","fense","headwrap","conciliator","chine","topping","assemblyman","divine","scuffling","boomlet","dervish","yellow-green","stockyard","hummock","trimming","royalist","calumny","vandal","prickle","strikeout","apologia","afterburner","hunker","flippancy","fop","embrasure","hornet","tithe","oilfield","lawman","turnkey","fledgling","coauthor","blowpipe","subjectivist","backstop","fishbowl","bedpan","sedge","protrusion","crybaby","freedman","seminarian","spacesuit","tautology","footstep","fiveyear","stoneware","mance","generalist","quitter","domicile","requisition","seance","cabana","wastrel","underling","looter","glassful","wallow","boater","disharmony","shiksa","herringbone","flyleaf","eyesore","lawnmower","walk-up","hemline","wiggle","posing","whirring","cropper","reappointment","psychodrama","shaver","orthodontist","granary","extrovert","calfskin","thinning","foghorn","trainload","carbide","metier","harpist","minim","ballcarrier","rayon","bursting","flipper","fastening","mullet","exploit","squatter","nullity","commodore","newlywed","eavesdropper","chiropractor","miler","arsonist","wrecker","transmutation","incompetency","subcontractor","tress","meatball","bobcat","distributorship","camcorder","pasty","glimmering","groaning","classicist","stakeout","supplicant","repeater","crackling","cryptographer","croupier","honeycomb","insincerity","inhibitor","mystification","greaser","barker","anthill","barbarity","strangle","myrtle","segmentation","marlin","capon","toenail","flip-flop","auger","blasphemer","dipping","pawnshop","penumbra","mohole","bauble","rube","flophouse","triplicate","sardine","master-mason","fang","brainstorm","derangement","hanker","molestation","smokescreen","cavalryman","edging","layover","signalman","clavicle","crewcut","tricolor","cochairman","liberationist","foreskin","bleacher","semi-circle","quince","flatcar","abattoir","farmboy","tibia","thrum","conformist","southerner","docudrama","whorl","break-up","conglomeration","exhibitor","bramble","cutie","woodchuck","compatriot","stole","tuner","housemother","dharma","femme","teahouse","banquette","bottomland","arranger","philistine","vacillation","chiton","retch","caddie","reissue","teaser","swampland","deejay","libertarian","pegboard","greenhorn","dork","cellmate","jobber","wishbone","millstone","haunting","blow-up","snorkel","snowplow","trespasser","punter","snowflake","snowdrift","gunnysack","surround","evergreen","clog","radioisotope","cougar","pundit","wattle","subgroup","oviduct","mixup","misstatement","sulfite","pansy","splint","counterproposal","pulsar","remove","landau","four-year-old","rebbe","disconnection","neomort","exegesis","meteoroid","meringue","sheepherder","radioman","strumpet","opment","millionth","speakeasy","conformation","cultivator","goof","annual","gazelle","demitasse","fishhook","preferment","homebody","skewer","chancre","sorbet","hologram","rivulet","oldster","prisoner-of-war","tulle","riff","restatement","debit","emplacement","repre","invariance","half-circle","objectivist","passer-by","scarlet","flail","impala","persimmon","purist","gation","burgher","snowman","starling","barony","annulment","lifespan","herder","embolden","swathe","ex-convict","trouper","half-wit","fuchsia","grange","ricochet","stinker","opacity","colander","absorber","armadillo","pleasantry","noncommunist","taxiway","overtone","debater","taillight","advisement","birdcage","baroness","aureole","breakout","colouring","astrophysicist","flatboat","stilt","eyeshade","barbell","deliverer","fishnet","prise","jackrabbit","manifold","chattel","jimmy","workshirt","thornbush","chatty","frisson","recount","patentee","oceanographer","forepaw","murderess","whalebone","frontrunner","cerebrum","jector","militiaman","lobsterman","earthling","clean","swindler","scree","begat","doorsill","housedress","strangler","shantytown","roughhouse","scenarist","foothill","contaminant","hamadryad","phony","fairyland","seascape","treble","prodigality","hobble","gantry","backroom","enticement","sawhorse","interviewee","cliffside","dustpan","scrubber","imbroglio","acquaintanceship","woodworker","aesthete","octogenarian","mauling","archivist","pungency","interweaving","jabber","bassinet","doubler","torte","linkup","outdoorsman","fixer","caddy","fumbling","defile","meristem","microbiologist","urologist","stovepipe","tambourine","constructionist","egomaniac","adjuster","liniment","impiety","timeline","cowgirl","sinecure","chillun","foreword","frat","retary","bagpipe","coif","visualization","colleen","shirtmaker","flounce","adder","riffle","underboss","reinterpretation","bender","seeding","fiver","sicken","decoder","holothete","figuring","stave","earplug","acrylic","epigraph","fairytale","flasher","sally","inkwell","nitwit","hussy","constrictor","stabilizer","stickup","seaplane","shimmy","dredge","updraft","speciality","insulator","frond","storyboard","shill","rafter","blowgun","dukedom","favourite","populist","striper","blowtorch","mallard","licking","poetess","tetracycline","ad-lib","toxicologist","fencer","gnawing","eration","photocell","golem","heirloom","penitence","gence","latecomer","broil","outdistance","howler","canine","replenishment","traditionalist","emcee","eyeglass","billow","eyelet","khaki","assignation","tepee","buccaneer","bellyache","parkland","musicologist","phaeton","spirochete","lanyard","mischance","tobacconist","blusher","castaway","meson","bouillabaisse","scrivener","stinger","life-cycle","harridan","motivator","mooring","crimp","inlay","purveyance","vertical","jackhammer","strongbox","dishpan","cobweb","couturier","chalkboard","basilisk","duckling","penitent","footrest","tangent","facing","peroration","floodlight","nouvelle","truss","sprite","drier","esplanade","banding","insulter","dialog","pincer","battlefront","missal","hayseed","parvenu","baronet","shipwright","whisker","no-hitter","double-dealing","moire","conjurer","rickshaw","crevasse","switchback","nicety","provincialism","novella","liberator","biggie","tune-up","ferryboat","remover","twosome","loveseat","tektite","sharpener","cartwheel","diva","flirting","disproportion","tortilla","rover","whodunit","birder","parley","birdsong","fiefdom","augury","harrier","tamale","judging","snakebite","diagnostician","tannin","qualifier","cheetah","distillery","protester","stockroom","factotum","newswoman","cosmopolitan","iridescence","aeroplane","toddy","co-defendant","parry","duocorn","boasting","elector","clarinetist","undergarment","psych","supergiant","armature","environ","collectivity","keepsake","gunfighter","wingspan","perforation","worshiper","groupie","cityscape","worrier","shipload","scallop","hatchery","portraitist","screamer","blaspheme","pacer","presenter","malcontent","seine","equivalency","scriptwriter","lieve","discard","bantam","centaur","typology","loiter","drubbing","airfoil","curio","grandmaster","finisher","luminary","alliteration","phantasy","blooper","fasting","samba","gearbox","islet","apricot","smidgen","inset","firestorm","madcap","seedbed","gunsight","forelock","disjunction","writhing","huckleberry","abstract","squirm","ironist","monosaccharide","pushbutton","terracotta","artiste","showgirl","cornea","temptress","popularization","free-fall","scribbling","conviviality","flange","thwack","droop","rower","sweatband","gopher","mandolin","slobber","stricture","calyx","dietician","rehash","padre","ancient","dotage","jacaranda","pensione","contravention","undulation","ironworker","currant","hankie","face-lift","anthropoid","depressant","war-horse","tithing","greeter","matchbox","woodcutter","magpie","wayfarer","handcuff","lawgiver","traverse","minion","cavalier","sonarman","defoliant","scamp","snowshoe","polyp","gainer","honkie","bottler","halloo","amputee","ontology","bromide","brisket","goodie","tavern-keeper","choker","preaching","molester","tonsure","recapitulation","aviary","stevedore","raffle","bootstrap","angiogram","plantain","tipper","hooting","seismometer","persecutor","lobotomy","pigsty","virologist","gamete","presbytery","stepping-stone","dressing-room","cyclamate","chipmunk","platelet","flogging","tuber","reservist","blinker","demographer","turncoat","demesne","fancier","ideologist","self-justification","bucketful","m'lord","rapping","bestiality","irrelevancy","oiler","mackinaw","flutist","trafficker","categorization","pram","world-system","cathouse","deceiver","idjit","double-take","reformulation","brushfire","separator","neigh","whimpering","crisscross","regurgitation","auteur","backwash","refiner","broadsheet","hedonist","recitative","nonentity","codger","tinting","policymaker","tutu","boondoggle","entrant","wok","small","boatload","searcher","taMing","sycophant","substructure","megalomaniac","rusher","saleslady","registrar","blackguard","neckerchief","oldie","clinician","flushing","pinwheel","dition","charioteer","beastie","stridency","verity","eyedropper","canvass","desperado","teardrop","farmyard","mannerist","macaw","valedictorian","whopper","pertinence","assay","puncher","manse","anatomist","dishtowel","nuke","egalitarian","tribulation","cinematographer","sailer","icicle","legume","spiritualist","nativist","these","progressive","blastocyst","harpooner","pedant","instrumentality","connector","masseur","vertebra","moonshiner","bowsprit","grabber","stele","clanking","renter","antihero","bankbook","jailbird","handicraft","fighter-bomber","streamer","retardant","wallflower","flamethrower","agate","cairn","bantamweight","agglomeration","roustabout","linden","roughneck","formance","moray","cession","rashness","capstone","derailment","declivity","snowfield","talon","haymaker","abductor","diffuser","geosector","camisole"]),on}var va;function wa(){if(va)return Bt;va=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.nouns=Bt.adjectives=void 0;const t=rh();Bt.adjectives=t.default;const r=nh();return Bt.nouns=r.default,Bt}var ka;function ih(){return ka||(ka=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.nouns=t.adjectives=t.uniqueUsernameGenerator=t.generateUsername=t.generateFromEmail=void 0;const r=wa(),e=(u=0,s=4294967295)=>Math.random()*((s|0)-(u|0)+1)+(u|0)|0,i=u=>{let s;switch(u){case 1:s=Math.floor(e(1,9)).toString();break;case 2:s=Math.floor(e(10,90)).toString();break;case 3:s=Math.floor(e(100,900)).toString();break;case 4:s=Math.floor(e(1e3,9e3)).toString();break;case 5:s=Math.floor(e(1e4,9e4)).toString();break;case 6:s=Math.floor(e(1e5,9e5)).toString();break;default:s="";break}return s};function n(u,s){return u.replace(/@.+/,"").replace(/[&/\\#,+()$~%._@'":*?<>{}]/g,"")+i(s)}t.generateFromEmail=n;function o(u,s,c,d){const f=r.nouns[Math.floor(Math.random()*r.nouns.length)],p=d?d.replace(/\s{2,}/g," ").replace(/\s/g,u??"").toLocaleLowerCase():r.adjectives[Math.floor(Math.random()*r.adjectives.length)];let h;return u?h=p+u+f+i(s):h=p+f+i(s),c?h.substring(0,c):h}t.generateUsername=o;function a(u){if(u.dictionaries){const s=h=>u.dictionaries[h][e(0,u.dictionaries[h].length-1)],c=u.dictionaries.length,d=u.separator||"";let f="";for(let h=0;h<c;h++){const g=s(h);f?f+=d+g:f=g}let p=f+i(u.randomDigits);if(p=p.toLowerCase(),u.style==="lowerCase")p=p.toLowerCase();else if(u.style==="capital"){const[h,...g]=p.split("");p=h.toUpperCase()+g.join("")}else u.style==="upperCase"&&(p=p.toUpperCase());return u.length?p.substring(0,u.length):p.substring(0,15)}else throw new Error("Cannot find any dictionary. Please provide at least one, or leave the 'dictionary' field empty in the config object")}t.uniqueUsernameGenerator=a;var l=wa();Object.defineProperty(t,"adjectives",{enumerable:!0,get:function(){return l.adjectives}}),Object.defineProperty(t,"nouns",{enumerable:!0,get:function(){return l.nouns}})}(Un)),Un}var oh=ih();class ah{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(r){this.flush(),this._parts.push(r)}append(r){this._pieces.push(r)}flush(){if(this._pieces.length>0){const r=new Uint8Array(this._pieces);this._parts.push(r),this._pieces=[]}}toArrayBuffer(){const r=[];for(const e of this._parts)r.push(e);return sh(r).buffer}}function sh(t){let r=0;for(const n of t)r+=n.byteLength;const e=new Uint8Array(r);let i=0;for(const n of t){const o=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);e.set(o,i),i+=n.byteLength}return e}function mc(t){return new lh(t).unpack()}function gc(t){const r=new ch,e=r.pack(t);return e instanceof Promise?e.then(()=>r.getBuffer()):r.getBuffer()}class lh{constructor(r){this.index=0,this.dataBuffer=r,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const r=this.unpack_uint8();if(r<128)return r;if((r^224)<32)return(r^224)-32;let e;if((e=r^160)<=15)return this.unpack_raw(e);if((e=r^176)<=15)return this.unpack_string(e);if((e=r^144)<=15)return this.unpack_array(e);if((e=r^128)<=15)return this.unpack_map(e);switch(r){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}}unpack_uint8(){const r=this.dataView[this.index]&255;return this.index++,r}unpack_uint16(){const r=this.read(2),e=(r[0]&255)*256+(r[1]&255);return this.index+=2,e}unpack_uint32(){const r=this.read(4),e=((r[0]*256+r[1])*256+r[2])*256+r[3];return this.index+=4,e}unpack_uint64(){const r=this.read(8),e=((((((r[0]*256+r[1])*256+r[2])*256+r[3])*256+r[4])*256+r[5])*256+r[6])*256+r[7];return this.index+=8,e}unpack_int8(){const r=this.unpack_uint8();return r<128?r:r-256}unpack_int16(){const r=this.unpack_uint16();return r<32768?r:r-65536}unpack_int32(){const r=this.unpack_uint32();return r<2**31?r:r-2**32}unpack_int64(){const r=this.unpack_uint64();return r<2**63?r:r-2**64}unpack_raw(r){if(this.length<this.index+r)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${r} ${this.length}`);const e=this.dataBuffer.slice(this.index,this.index+r);return this.index+=r,e}unpack_string(r){const e=this.read(r);let i=0,n="",o,a;for(;i<r;)o=e[i],o<160?(a=o,i++):(o^192)<32?(a=(o&31)<<6|e[i+1]&63,i+=2):(o^224)<16?(a=(o&15)<<12|(e[i+1]&63)<<6|e[i+2]&63,i+=3):(a=(o&7)<<18|(e[i+1]&63)<<12|(e[i+2]&63)<<6|e[i+3]&63,i+=4),n+=String.fromCodePoint(a);return this.index+=r,n}unpack_array(r){const e=new Array(r);for(let i=0;i<r;i++)e[i]=this.unpack();return e}unpack_map(r){const e={};for(let i=0;i<r;i++){const n=this.unpack();e[n]=this.unpack()}return e}unpack_float(){const r=this.unpack_uint32(),e=r>>31,i=(r>>23&255)-127,n=r&8388607|8388608;return(e===0?1:-1)*n*2**(i-23)}unpack_double(){const r=this.unpack_uint32(),e=this.unpack_uint32(),i=r>>31,n=(r>>20&2047)-1023,a=(r&1048575|1048576)*2**(n-20)+e*2**(n-52);return(i===0?1:-1)*a}read(r){const e=this.index;if(e+r<=this.length)return this.dataView.subarray(e,e+r);throw new Error("BinaryPackFailure: read index out of range")}}class ch{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(r){if(typeof r=="string")this.pack_string(r);else if(typeof r=="number")Math.floor(r)===r?this.pack_integer(r):this.pack_double(r);else if(typeof r=="boolean")r===!0?this._bufferBuilder.append(195):r===!1&&this._bufferBuilder.append(194);else if(r===void 0)this._bufferBuilder.append(192);else if(typeof r=="object")if(r===null)this._bufferBuilder.append(192);else{const e=r.constructor;if(r instanceof Array){const i=this.pack_array(r);if(i instanceof Promise)return i.then(()=>this._bufferBuilder.flush())}else if(r instanceof ArrayBuffer)this.pack_bin(new Uint8Array(r));else if("BYTES_PER_ELEMENT"in r){const i=r;this.pack_bin(new Uint8Array(i.buffer,i.byteOffset,i.byteLength))}else if(r instanceof Date)this.pack_string(r.toString());else{if(r instanceof Blob)return r.arrayBuffer().then(i=>{this.pack_bin(new Uint8Array(i)),this._bufferBuilder.flush()});if(e==Object||e.toString().startsWith("class")){const i=this.pack_object(r);if(i instanceof Promise)return i.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${e.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof r}" not yet supported`);this._bufferBuilder.flush()}pack_bin(r){const e=r.length;if(e<=15)this.pack_uint8(160+e);else if(e<=65535)this._bufferBuilder.append(218),this.pack_uint16(e);else if(e<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(e);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(r)}pack_string(r){const e=this._textEncoder.encode(r),i=e.length;if(i<=15)this.pack_uint8(176+i);else if(i<=65535)this._bufferBuilder.append(216),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(i);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_array(r){const e=r.length;if(e<=15)this.pack_uint8(144+e);else if(e<=65535)this._bufferBuilder.append(220),this.pack_uint16(e);else if(e<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(e);else throw new Error("Invalid length");const i=n=>{if(n<e){const o=this.pack(r[n]);return o instanceof Promise?o.then(()=>i(n+1)):i(n+1)}};return i(0)}pack_integer(r){if(r>=-32&&r<=127)this._bufferBuilder.append(r&255);else if(r>=0&&r<=255)this._bufferBuilder.append(204),this.pack_uint8(r);else if(r>=-128&&r<=127)this._bufferBuilder.append(208),this.pack_int8(r);else if(r>=0&&r<=65535)this._bufferBuilder.append(205),this.pack_uint16(r);else if(r>=-32768&&r<=32767)this._bufferBuilder.append(209),this.pack_int16(r);else if(r>=0&&r<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(r);else if(r>=-2147483648&&r<=2147483647)this._bufferBuilder.append(210),this.pack_int32(r);else if(r>=-9223372036854776e3&&r<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(r);else if(r>=0&&r<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(r);else throw new Error("Invalid integer")}pack_double(r){let e=0;r<0&&(e=1,r=-r);const i=Math.floor(Math.log(r)/Math.LN2),n=r/2**i-1,o=Math.floor(n*2**52),a=2**32,l=e<<31|i+1023<<20|o/a&1048575,u=o%a;this._bufferBuilder.append(203),this.pack_int32(l),this.pack_int32(u)}pack_object(r){const e=Object.keys(r),i=e.length;if(i<=15)this.pack_uint8(128+i);else if(i<=65535)this._bufferBuilder.append(222),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(i);else throw new Error("Invalid length");const n=o=>{if(o<e.length){const a=e[o];if(r.hasOwnProperty(a)){this.pack(a);const l=this.pack(r[a]);if(l instanceof Promise)return l.then(()=>n(o+1))}return n(o+1)}};return n(0)}pack_uint8(r){this._bufferBuilder.append(r)}pack_uint16(r){this._bufferBuilder.append(r>>8),this._bufferBuilder.append(r&255)}pack_uint32(r){const e=r&4294967295;this._bufferBuilder.append((e&4278190080)>>>24),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_uint64(r){const e=r/4294967296,i=r%2**32;this._bufferBuilder.append((e&4278190080)>>>24),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255),this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}pack_int8(r){this._bufferBuilder.append(r&255)}pack_int16(r){this._bufferBuilder.append((r&65280)>>8),this._bufferBuilder.append(r&255)}pack_int32(r){this._bufferBuilder.append(r>>>24&255),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int64(r){const e=Math.floor(r/4294967296),i=r%2**32;this._bufferBuilder.append((e&4278190080)>>>24),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255),this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}constructor(){this._bufferBuilder=new ah,this._textEncoder=new TextEncoder}}let yc=!0,bc=!0;function Er(t,r,e){const i=t.match(r);return i&&i.length>=e&&parseFloat(i[e],10)}function rr(t,r,e){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,n=i.addEventListener;i.addEventListener=function(a,l){if(a!==r)return n.apply(this,arguments);const u=s=>{const c=e(s);c&&(l.handleEvent?l.handleEvent(c):l(c))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(l,u),n.apply(this,[a,u])};const o=i.removeEventListener;i.removeEventListener=function(a,l){if(a!==r||!this._eventMap||!this._eventMap[r])return o.apply(this,arguments);if(!this._eventMap[r].has(l))return o.apply(this,arguments);const u=this._eventMap[r].get(l);return this._eventMap[r].delete(l),this._eventMap[r].size===0&&delete this._eventMap[r],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[a,u])},Object.defineProperty(i,"on"+r,{get(){return this["_on"+r]},set(a){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),a&&this.addEventListener(r,this["_on"+r]=a)},enumerable:!0,configurable:!0})}function uh(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(yc=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function dh(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(bc=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function vc(){if(typeof window=="object"){if(yc)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Do(t,r){bc&&console.warn(t+" is deprecated, please use "+r+" instead.")}function ph(t){const r={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return r.browser="Not a browser.",r;const{navigator:e}=t;if(e.userAgentData&&e.userAgentData.brands){const i=e.userAgentData.brands.find(n=>n.brand==="Chromium");if(i)return{browser:"chrome",version:parseInt(i.version,10)}}if(e.mozGetUserMedia)r.browser="firefox",r.version=parseInt(Er(e.userAgent,/Firefox\/(\d+)\./,1));else if(e.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)r.browser="chrome",r.version=parseInt(Er(e.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(t.RTCPeerConnection&&e.userAgent.match(/AppleWebKit\/(\d+)\./))r.browser="safari",r.version=parseInt(Er(e.userAgent,/AppleWebKit\/(\d+)\./,1)),r.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype,r._safariVersion=Er(e.userAgent,/Version\/(\d+(\.?\d+))/,1);else return r.browser="Not a supported browser.",r;return r}function xa(t){return Object.prototype.toString.call(t)==="[object Object]"}function wc(t){return xa(t)?Object.keys(t).reduce(function(r,e){const i=xa(t[e]),n=i?wc(t[e]):t[e],o=i&&!Object.keys(n).length;return n===void 0||o?r:Object.assign(r,{[e]:n})},{}):t}function uo(t,r,e){!r||e.has(r.id)||(e.set(r.id,r),Object.keys(r).forEach(i=>{i.endsWith("Id")?uo(t,t.get(r[i]),e):i.endsWith("Ids")&&r[i].forEach(n=>{uo(t,t.get(n),e)})}))}function _a(t,r,e){const i=e?"outbound-rtp":"inbound-rtp",n=new Map;if(r===null)return n;const o=[];return t.forEach(a=>{a.type==="track"&&a.trackIdentifier===r.id&&o.push(a)}),o.forEach(a=>{t.forEach(l=>{l.type===i&&l.trackId===a.id&&uo(t,l,n)})}),n}const Sa=vc;function kc(t,r){const e=t&&t.navigator;if(!e.mediaDevices)return;const i=function(l){if(typeof l!="object"||l.mandatory||l.optional)return l;const u={};return Object.keys(l).forEach(s=>{if(s==="require"||s==="advanced"||s==="mediaSource")return;const c=typeof l[s]=="object"?l[s]:{ideal:l[s]};c.exact!==void 0&&typeof c.exact=="number"&&(c.min=c.max=c.exact);const d=function(f,p){return f?f+p.charAt(0).toUpperCase()+p.slice(1):p==="deviceId"?"sourceId":p};if(c.ideal!==void 0){u.optional=u.optional||[];let f={};typeof c.ideal=="number"?(f[d("min",s)]=c.ideal,u.optional.push(f),f={},f[d("max",s)]=c.ideal,u.optional.push(f)):(f[d("",s)]=c.ideal,u.optional.push(f))}c.exact!==void 0&&typeof c.exact!="number"?(u.mandatory=u.mandatory||{},u.mandatory[d("",s)]=c.exact):["min","max"].forEach(f=>{c[f]!==void 0&&(u.mandatory=u.mandatory||{},u.mandatory[d(f,s)]=c[f])})}),l.advanced&&(u.optional=(u.optional||[]).concat(l.advanced)),u},n=function(l,u){if(r.version>=61)return u(l);if(l=JSON.parse(JSON.stringify(l)),l&&typeof l.audio=="object"){const s=function(c,d,f){d in c&&!(f in c)&&(c[f]=c[d],delete c[d])};l=JSON.parse(JSON.stringify(l)),s(l.audio,"autoGainControl","googAutoGainControl"),s(l.audio,"noiseSuppression","googNoiseSuppression"),l.audio=i(l.audio)}if(l&&typeof l.video=="object"){let s=l.video.facingMode;s=s&&(typeof s=="object"?s:{ideal:s});const c=r.version<66;if(s&&(s.exact==="user"||s.exact==="environment"||s.ideal==="user"||s.ideal==="environment")&&!(e.mediaDevices.getSupportedConstraints&&e.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete l.video.facingMode;let d;if(s.exact==="environment"||s.ideal==="environment"?d=["back","rear"]:(s.exact==="user"||s.ideal==="user")&&(d=["front"]),d)return e.mediaDevices.enumerateDevices().then(f=>{f=f.filter(h=>h.kind==="videoinput");let p=f.find(h=>d.some(g=>h.label.toLowerCase().includes(g)));return!p&&f.length&&d.includes("back")&&(p=f[f.length-1]),p&&(l.video.deviceId=s.exact?{exact:p.deviceId}:{ideal:p.deviceId}),l.video=i(l.video),Sa("chrome: "+JSON.stringify(l)),u(l)})}l.video=i(l.video)}return Sa("chrome: "+JSON.stringify(l)),u(l)},o=function(l){return r.version>=64?l:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[l.name]||l.name,message:l.message,constraint:l.constraint||l.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(l,u,s){n(l,c=>{e.webkitGetUserMedia(c,u,d=>{s&&s(o(d))})})};if(e.getUserMedia=a.bind(e),e.mediaDevices.getUserMedia){const l=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(u){return n(u,s=>l(s).then(c=>{if(s.audio&&!c.getAudioTracks().length||s.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return c},c=>Promise.reject(o(c))))}}}function xc(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function _c(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",n=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(l=>l.track&&l.track.id===n.track.id):o={track:n.track};const a=new Event("track");a.track=n.track,a.receiver=o,a.transceiver={receiver:o},a.streams=[i.stream],this.dispatchEvent(a)}),i.stream.getTracks().forEach(n=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(l=>l.track&&l.track.id===n.id):o={track:n};const a=new Event("track");a.track=n,a.receiver=o,a.transceiver={receiver:o},a.streams=[i.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else rr(t,"track",r=>(r.transceiver||Object.defineProperty(r,"transceiver",{value:{receiver:r.receiver}}),r))}function Sc(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const r=function(n,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=n.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:n}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(l,u){let s=n.apply(this,arguments);return s||(s=r(this,l),this._senders.push(s)),s};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(l){o.apply(this,arguments);const u=this._senders.indexOf(l);u!==-1&&this._senders.splice(u,1)}}const e=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],e.apply(this,[o]),o.getTracks().forEach(a=>{this._senders.push(r(this,a))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],i.apply(this,[o]),o.getTracks().forEach(a=>{const l=this._senders.find(u=>u.track===a);l&&this._senders.splice(this._senders.indexOf(l),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const r=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=r.apply(this,[]);return i.forEach(n=>n._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Cc(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=e.apply(this,[]);return o.forEach(a=>a._pc=this),o});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=i.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(a=>_a(a,o.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach(o=>o._pc=this),n}),rr(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const n=this;return this._pc.getStats().then(o=>_a(o,n.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let n,o,a;return this.getSenders().forEach(l=>{l.track===i&&(n?a=!0:n=l)}),this.getReceivers().forEach(l=>(l.track===i&&(o?a=!0:o=l),l.track===i)),a||n&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function Pc(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,l){if(!l)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const u=r.apply(this,arguments);return this._shimmedLocalStreams[l.id]?this._shimmedLocalStreams[l.id].indexOf(u)===-1&&this._shimmedLocalStreams[l.id].push(u):this._shimmedLocalStreams[l.id]=[l,u],u};const e=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(s=>{if(this.getSenders().find(d=>d.track===s))throw new DOMException("Track already exists.","InvalidAccessError")});const l=this.getSenders();e.apply(this,arguments);const u=this.getSenders().filter(s=>l.indexOf(s)===-1);this._shimmedLocalStreams[a.id]=[a].concat(u)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],i.apply(this,arguments)};const n=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(l=>{const u=this._shimmedLocalStreams[l].indexOf(a);u!==-1&&this._shimmedLocalStreams[l].splice(u,1),this._shimmedLocalStreams[l].length===1&&delete this._shimmedLocalStreams[l]}),n.apply(this,arguments)}}function Tc(t,r){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&r.version>=65)return Pc(t);const e=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const c=e.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(d=>this._reverseStreams[d.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(d=>{if(this.getSenders().find(p=>p.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const d=new t.MediaStream(c.getTracks());this._streams[c.id]=d,this._reverseStreams[d.id]=c,c=d}i.apply(this,[c])};const n=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},t.RTCPeerConnection.prototype.addTrack=function(c,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(g=>g===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const h=this._streams[d.id];if(h)h.addTrack(c),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new t.MediaStream([c]);this._streams[d.id]=g,this._reverseStreams[g.id]=d,this.addStream(g)}return this.getSenders().find(g=>g.track===c)};function o(s,c){let d=c.sdp;return Object.keys(s._reverseStreams||[]).forEach(f=>{const p=s._reverseStreams[f],h=s._streams[p.id];d=d.replace(new RegExp(h.id,"g"),p.id)}),new RTCSessionDescription({type:c.type,sdp:d})}function a(s,c){let d=c.sdp;return Object.keys(s._reverseStreams||[]).forEach(f=>{const p=s._reverseStreams[f],h=s._streams[p.id];d=d.replace(new RegExp(p.id,"g"),h.id)}),new RTCSessionDescription({type:c.type,sdp:d})}["createOffer","createAnswer"].forEach(function(s){const c=t.RTCPeerConnection.prototype[s],d={[s](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?c.apply(this,[h=>{const g=o(this,h);f[0].apply(null,[g])},h=>{f[1]&&f[1].apply(null,h)},arguments[2]]):c.apply(this,arguments).then(h=>o(this,h))}};t.RTCPeerConnection.prototype[s]=d[s]});const l=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?l.apply(this,arguments):(arguments[0]=a(this,arguments[0]),l.apply(this,arguments))};const u=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const s=u.get.apply(this);return s.type===""?s:o(this,s)}}),t.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(c._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(p=>{this._streams[p].getTracks().find(g=>c.track===g)&&(f=this._streams[p])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function po(t,r){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){const i=t.RTCPeerConnection.prototype[e],n={[e](){return arguments[0]=new(e==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[e]=n[e]})}function Ec(t,r){rr(t,"negotiationneeded",e=>{const i=e.target;if(!((r.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return e})}const Ca=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Ec,shimAddTrackRemoveTrack:Tc,shimAddTrackRemoveTrackWithNative:Pc,shimGetSendersWithDtmf:Sc,shimGetUserMedia:kc,shimMediaStream:xc,shimOnTrack:_c,shimPeerConnection:po,shimSenderReceiverGetStats:Cc},Symbol.toStringTag,{value:"Module"}));function $c(t,r){const e=t&&t.navigator,i=t&&t.MediaStreamTrack;if(e.getUserMedia=function(n,o,a){Do("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),e.mediaDevices.getUserMedia(n).then(o,a)},!(r.version>55&&"autoGainControl"in e.mediaDevices.getSupportedConstraints())){const n=function(a,l,u){l in a&&!(u in a)&&(a[u]=a[l],delete a[l])},o=e.mediaDevices.getUserMedia.bind(e.mediaDevices);if(e.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),n(a.audio,"autoGainControl","mozAutoGainControl"),n(a.audio,"noiseSuppression","mozNoiseSuppression")),o(a)},i&&i.prototype.getSettings){const a=i.prototype.getSettings;i.prototype.getSettings=function(){const l=a.apply(this,arguments);return n(l,"mozAutoGainControl","autoGainControl"),n(l,"mozNoiseSuppression","noiseSuppression"),l}}if(i&&i.prototype.applyConstraints){const a=i.prototype.applyConstraints;i.prototype.applyConstraints=function(l){return this.kind==="audio"&&typeof l=="object"&&(l=JSON.parse(JSON.stringify(l)),n(l,"autoGainControl","mozAutoGainControl"),n(l,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[l])}}}}function fh(t,r){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return i.video===!0?i.video={mediaSource:r}:i.video.mediaSource=r,t.navigator.mediaDevices.getUserMedia(i)})}function Ic(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fo(t,r){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const o=t.RTCPeerConnection.prototype[n],a={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=a[n]});const e={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,a,l]=arguments;return i.apply(this,[o||null]).then(u=>{if(r.version<53&&!a)try{u.forEach(s=>{s.type=e[s.type]||s.type})}catch(s){if(s.name!=="TypeError")throw s;u.forEach((c,d)=>{u.set(d,Object.assign({},c,{type:e[c.type]||c.type}))})}return u}).then(a,l)}}function Rc(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function(){const n=r.apply(this,[]);return n.forEach(o=>o._pc=this),n});const e=t.RTCPeerConnection.prototype.addTrack;e&&(t.RTCPeerConnection.prototype.addTrack=function(){const n=e.apply(this,arguments);return n._pc=this,n}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Nc(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=r.apply(this,[]);return i.forEach(n=>n._pc=this),i}),rr(t,"track",e=>(e.receiver._pc=e.srcElement,e)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Ac(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(e){Do("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&e.getTracks().includes(i.track)&&this.removeTrack(i)})})}function Mc(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function Oc(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const r=t.RTCPeerConnection.prototype.addTransceiver;r&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const n=i.length>0;n&&i.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=r.apply(this,arguments);if(n){const{sender:a}=o,l=a.getParameters();(!("encodings"in l)||l.encodings.length===1&&Object.keys(l.encodings[0]).length===0)&&(l.encodings=i,a.sendEncodings=i,this.setParametersPromises.push(a.setParameters(l).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return o})}function Fc(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const r=t.RTCRtpSender.prototype.getParameters;r&&(t.RTCRtpSender.prototype.getParameters=function(){const i=r.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function Dc(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}function zc(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const r=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}const Pa=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:Oc,shimCreateAnswer:zc,shimCreateOffer:Dc,shimGetDisplayMedia:fh,shimGetParameters:Fc,shimGetUserMedia:$c,shimOnTrack:Ic,shimPeerConnection:fo,shimRTCDataChannel:Mc,shimReceiverGetStats:Nc,shimRemoveStream:Ac,shimSenderGetStats:Rc},Symbol.toStringTag,{value:"Module"}));function Lc(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(n=>r.call(this,n,i)),i.getVideoTracks().forEach(n=>r.call(this,n,i))},t.RTCPeerConnection.prototype.addTrack=function(i,...n){return n&&n.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),r.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(e);if(i===-1)return;this._localStreams.splice(i,1);const n=e.getTracks();this.getSenders().forEach(o=>{n.includes(o.track)&&this.removeTrack(o)})})}}function jc(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(n=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(n))return;this._remoteStreams.push(n);const o=new Event("addstream");o.stream=n,this.dispatchEvent(o)})})}});const r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(n){n.streams.forEach(o=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(o)>=0)return;i._remoteStreams.push(o);const a=new Event("addstream");a.stream=o,i.dispatchEvent(a)})}),r.apply(i,arguments)}}}function Uc(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,e=r.createOffer,i=r.createAnswer,n=r.setLocalDescription,o=r.setRemoteDescription,a=r.addIceCandidate;r.createOffer=function(s,c){const d=arguments.length>=2?arguments[2]:arguments[0],f=e.apply(this,[d]);return c?(f.then(s,c),Promise.resolve()):f},r.createAnswer=function(s,c){const d=arguments.length>=2?arguments[2]:arguments[0],f=i.apply(this,[d]);return c?(f.then(s,c),Promise.resolve()):f};let l=function(u,s,c){const d=n.apply(this,[u]);return c?(d.then(s,c),Promise.resolve()):d};r.setLocalDescription=l,l=function(u,s,c){const d=o.apply(this,[u]);return c?(d.then(s,c),Promise.resolve()):d},r.setRemoteDescription=l,l=function(u,s,c){const d=a.apply(this,[u]);return c?(d.then(s,c),Promise.resolve()):d},r.addIceCandidate=l}function Bc(t){const r=t&&t.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const e=r.mediaDevices,i=e.getUserMedia.bind(e);r.mediaDevices.getUserMedia=n=>i(qc(n))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=function(i,n,o){r.mediaDevices.getUserMedia(i).then(n,o)}.bind(r))}function qc(t){return t&&t.video!==void 0?Object.assign({},t,{video:wc(t.video)}):t}function Vc(t){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection;t.RTCPeerConnection=function(i,n){if(i&&i.iceServers){const o=[];for(let a=0;a<i.iceServers.length;a++){let l=i.iceServers[a];l.urls===void 0&&l.url?(Do("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),l.urls=l.url,delete l.url,o.push(l)):o.push(i.iceServers[a])}i.iceServers=o}return new r(i,n)},t.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return r.generateCertificate}})}function Gc(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Wc(t){const r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const n=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&n?n.direction==="sendrecv"?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":n.direction==="recvonly"&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):i.offerToReceiveAudio===!0&&!n&&this.addTransceiver("audio",{direction:"recvonly"}),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const o=this.getTransceivers().find(a=>a.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):i.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}}function Hc(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const Ta=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:Hc,shimCallbacksAPI:Uc,shimConstraints:qc,shimCreateOfferLegacy:Wc,shimGetUserMedia:Bc,shimLocalStreamsAPI:Lc,shimRTCIceServerUrls:Vc,shimRemoteStreamsAPI:jc,shimTrackEventTransceiver:Gc},Symbol.toStringTag,{value:"Module"}));var Bn={exports:{}},Ea;function hh(){return Ea||(Ea=1,function(t){const r={};r.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split(`
`).map(i=>i.trim())},r.splitSections=function(e){return e.split(`
m=`).map((n,o)=>(o>0?"m="+n:n).trim()+`\r
`)},r.getDescription=function(e){const i=r.splitSections(e);return i&&i[0]},r.getMediaSections=function(e){const i=r.splitSections(e);return i.shift(),i},r.matchPrefix=function(e,i){return r.splitLines(e).filter(n=>n.indexOf(i)===0)},r.parseCandidate=function(e){let i;e.indexOf("a=candidate:")===0?i=e.substring(12).split(" "):i=e.substring(10).split(" ");const n={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let o=8;o<i.length;o+=2)switch(i[o]){case"raddr":n.relatedAddress=i[o+1];break;case"rport":n.relatedPort=parseInt(i[o+1],10);break;case"tcptype":n.tcpType=i[o+1];break;case"ufrag":n.ufrag=i[o+1],n.usernameFragment=i[o+1];break;default:n[i[o]]===void 0&&(n[i[o]]=i[o+1]);break}return n},r.writeCandidate=function(e){const i=[];i.push(e.foundation);const n=e.component;n==="rtp"?i.push(1):n==="rtcp"?i.push(2):i.push(n),i.push(e.protocol.toUpperCase()),i.push(e.priority),i.push(e.address||e.ip),i.push(e.port);const o=e.type;return i.push("typ"),i.push(o),o!=="host"&&e.relatedAddress&&e.relatedPort&&(i.push("raddr"),i.push(e.relatedAddress),i.push("rport"),i.push(e.relatedPort)),e.tcpType&&e.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(i.push("ufrag"),i.push(e.usernameFragment||e.ufrag)),"candidate:"+i.join(" ")},r.parseIceOptions=function(e){return e.substring(14).split(" ")},r.parseRtpMap=function(e){let i=e.substring(9).split(" ");const n={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),n.name=i[0],n.clockRate=parseInt(i[1],10),n.channels=i.length===3?parseInt(i[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){let i=e.payloadType;e.preferredPayloadType!==void 0&&(i=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+i+" "+e.name+"/"+e.clockRate+(n!==1?"/"+n:"")+`\r
`},r.parseExtmap=function(e){const i=e.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&e.direction!=="sendrecv"?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+`\r
`},r.parseFmtp=function(e){const i={};let n;const o=e.substring(e.indexOf(" ")+1).split(";");for(let a=0;a<o.length;a++)n=o[a].trim().split("="),i[n[0].trim()]=n[1];return i},r.writeFmtp=function(e){let i="",n=e.payloadType;if(e.preferredPayloadType!==void 0&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const o=[];Object.keys(e.parameters).forEach(a=>{e.parameters[a]!==void 0?o.push(a+"="+e.parameters[a]):o.push(a)}),i+="a=fmtp:"+n+" "+o.join(";")+`\r
`}return i},r.parseRtcpFb=function(e){const i=e.substring(e.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},r.writeRtcpFb=function(e){let i="",n=e.payloadType;return e.preferredPayloadType!==void 0&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(o=>{i+="a=rtcp-fb:"+n+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),i},r.parseSsrcMedia=function(e){const i=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,i),10)},o=e.indexOf(":",i);return o>-1?(n.attribute=e.substring(i+1,o),n.value=e.substring(o+1)):n.attribute=e.substring(i+1),n},r.parseSsrcGroup=function(e){const i=e.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(n=>parseInt(n,10))}},r.getMid=function(e){const i=r.matchPrefix(e,"a=mid:")[0];if(i)return i.substring(6)},r.parseFingerprint=function(e){const i=e.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},r.getDtlsParameters=function(e,i){return{role:"auto",fingerprints:r.matchPrefix(e+i,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,i){let n="a=setup:"+i+`\r
`;return e.fingerprints.forEach(o=>{n+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),n},r.parseCryptoLine=function(e){const i=e.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},r.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+(typeof e.keyParams=="object"?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+`\r
`},r.parseCryptoKeyParams=function(e){if(e.indexOf("inline:")!==0)return null;const i=e.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},r.getCryptoParameters=function(e,i){return r.matchPrefix(e+i,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(e,i){const n=r.matchPrefix(e+i,"a=ice-ufrag:")[0],o=r.matchPrefix(e+i,"a=ice-pwd:")[0];return n&&o?{usernameFragment:n.substring(12),password:o.substring(10)}:null},r.writeIceParameters=function(e){let i="a=ice-ufrag:"+e.usernameFragment+`\r
a=ice-pwd:`+e.password+`\r
`;return e.iceLite&&(i+=`a=ice-lite\r
`),i},r.parseRtpParameters=function(e){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=r.splitLines(e)[0].split(" ");i.profile=o[2];for(let l=3;l<o.length;l++){const u=o[l],s=r.matchPrefix(e,"a=rtpmap:"+u+" ")[0];if(s){const c=r.parseRtpMap(s),d=r.matchPrefix(e,"a=fmtp:"+u+" ");switch(c.parameters=d.length?r.parseFmtp(d[0]):{},c.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+u+" ").map(r.parseRtcpFb),i.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(c.name.toUpperCase());break}}}r.matchPrefix(e,"a=extmap:").forEach(l=>{i.headerExtensions.push(r.parseExtmap(l))});const a=r.matchPrefix(e,"a=rtcp-fb:* ").map(r.parseRtcpFb);return i.codecs.forEach(l=>{a.forEach(u=>{l.rtcpFeedback.find(c=>c.type===u.type&&c.parameter===u.parameter)||l.rtcpFeedback.push(u)})}),i},r.writeRtpDescription=function(e,i){let n="";n+="m="+e+" ",n+=i.codecs.length>0?"9":"0",n+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",n+=i.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,n+=`c=IN IP4 0.0.0.0\r
`,n+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(a=>{n+=r.writeRtpMap(a),n+=r.writeFmtp(a),n+=r.writeRtcpFb(a)});let o=0;return i.codecs.forEach(a=>{a.maxptime>o&&(o=a.maxptime)}),o>0&&(n+="a=maxptime:"+o+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(a=>{n+=r.writeExtmap(a)}),n},r.parseRtpEncodingParameters=function(e){const i=[],n=r.parseRtpParameters(e),o=n.fecMechanisms.indexOf("RED")!==-1,a=n.fecMechanisms.indexOf("ULPFEC")!==-1,l=r.matchPrefix(e,"a=ssrc:").map(f=>r.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),u=l.length>0&&l[0].ssrc;let s;const c=r.matchPrefix(e,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(h=>parseInt(h,10)));c.length>0&&c[0].length>1&&c[0][0]===u&&(s=c[0][1]),n.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let p={ssrc:u,codecPayloadType:parseInt(f.parameters.apt,10)};u&&s&&(p.rtx={ssrc:s}),i.push(p),o&&(p=JSON.parse(JSON.stringify(p)),p.fec={ssrc:u,mechanism:a?"red+ulpfec":"red"},i.push(p))}}),i.length===0&&u&&i.push({ssrc:u});let d=r.matchPrefix(e,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,i.forEach(f=>{f.maxBitrate=d})),i},r.parseRtcpParameters=function(e){const i={},n=r.matchPrefix(e,"a=ssrc:").map(l=>r.parseSsrcMedia(l)).filter(l=>l.attribute==="cname")[0];n&&(i.cname=n.value,i.ssrc=n.ssrc);const o=r.matchPrefix(e,"a=rtcp-rsize");i.reducedSize=o.length>0,i.compound=o.length===0;const a=r.matchPrefix(e,"a=rtcp-mux");return i.mux=a.length>0,i},r.writeRtcpParameters=function(e){let i="";return e.reducedSize&&(i+=`a=rtcp-rsize\r
`),e.mux&&(i+=`a=rtcp-mux\r
`),e.ssrc!==void 0&&e.cname&&(i+="a=ssrc:"+e.ssrc+" cname:"+e.cname+`\r
`),i},r.parseMsid=function(e){let i;const n=r.matchPrefix(e,"a=msid:");if(n.length===1)return i=n[0].substring(7).split(" "),{stream:i[0],track:i[1]};const o=r.matchPrefix(e,"a=ssrc:").map(a=>r.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(o.length>0)return i=o[0].value.split(" "),{stream:i[0],track:i[1]}},r.parseSctpDescription=function(e){const i=r.parseMLine(e),n=r.matchPrefix(e,"a=max-message-size:");let o;n.length>0&&(o=parseInt(n[0].substring(19),10)),isNaN(o)&&(o=65536);const a=r.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:i.fmt,maxMessageSize:o};const l=r.matchPrefix(e,"a=sctpmap:");if(l.length>0){const u=l[0].substring(10).split(" ");return{port:parseInt(u[0],10),protocol:u[1],maxMessageSize:o}}},r.writeSctpDescription=function(e,i){let n=[];return e.protocol!=="DTLS/SCTP"?n=["m="+e.kind+" 9 "+e.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:n=["m="+e.kind+" 9 "+e.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&n.push("a=max-message-size:"+i.maxMessageSize+`\r
`),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,22)},r.writeSessionBoilerplate=function(e,i,n){let o;const a=i!==void 0?i:2;return e?o=e:o=r.generateSessionId(),`v=0\r
o=`+(n||"thisisadapterortc")+" "+o+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},r.getDirection=function(e,i){const n=r.splitLines(e);for(let o=0;o<n.length;o++)switch(n[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[o].substring(2)}return i?r.getDirection(i):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substring(2)},r.isRejected=function(e){return e.split(" ",2)[1]==="0"},r.parseMLine=function(e){const n=r.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},r.parseOLine=function(e){const n=r.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},r.isValidSDP=function(e){if(typeof e!="string"||e.length===0)return!1;const i=r.splitLines(e);for(let n=0;n<i.length;n++)if(i[n].length<2||i[n].charAt(1)!=="=")return!1;return!0},t.exports=r}(Bn)),Bn.exports}var Zc=hh();const lr=Nn(Zc),mh=vf({__proto__:null,default:lr},[Zc]);function mn(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const r=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substring(2)),i.candidate&&i.candidate.length){const n=new r(i),o=lr.parseCandidate(i.candidate);for(const a in o)a in n||Object.defineProperty(n,a,{value:o[a]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new r(i)},t.RTCIceCandidate.prototype=r.prototype,rr(t,"icecandidate",e=>(e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e))}function ho(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||rr(t,"icecandidate",r=>{if(r.candidate){const e=lr.parseCandidate(r.candidate.candidate);e.type==="relay"&&(r.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[e.priority>>24])}return r})}function gn(t,r){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const e=function(l){if(!l||!l.sdp)return!1;const u=lr.splitSections(l.sdp);return u.shift(),u.some(s=>{const c=lr.parseMLine(s);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})},i=function(l){const u=l.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(u===null||u.length<2)return-1;const s=parseInt(u[1],10);return s!==s?-1:s},n=function(l){let u=65536;return r.browser==="firefox"&&(r.version<57?l===-1?u=16384:u=2147483637:r.version<60?u=r.version===57?65535:65536:u=2147483637),u},o=function(l,u){let s=65536;r.browser==="firefox"&&r.version===57&&(s=65535);const c=lr.matchPrefix(l.sdp,"a=max-message-size:");return c.length>0?s=parseInt(c[0].substring(19),10):r.browser==="firefox"&&u!==-1&&(s=2147483637),s},a=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r.browser==="chrome"&&r.version>=76){const{sdpSemantics:u}=this.getConfiguration();u==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(e(arguments[0])){const u=i(arguments[0]),s=n(u),c=o(arguments[0],u);let d;s===0&&c===0?d=Number.POSITIVE_INFINITY:s===0||c===0?d=Math.max(s,c):d=Math.min(s,c);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return a.apply(this,arguments)}}function yn(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function r(i,n){const o=i.send;i.send=function(){const l=arguments[0],u=l.length||l.size||l.byteLength;if(i.readyState==="open"&&n.sctp&&u>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return o.apply(i,arguments)}}const e=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const n=e.apply(this,arguments);return r(n,this),n},rr(t,"datachannel",i=>(r(i.channel,i.target),i))}function mo(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const r=t.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const i=r[e];r[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=n=>{const o=n.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const a=new Event("connectionstatechange",n);o.dispatchEvent(a)}return n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function go(t,r){if(!t.RTCPeerConnection||r.browser==="chrome"&&r.version>=71||r.browser==="safari"&&r._safariVersion>=13.1)return;const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(n){if(n&&n.sdp&&n.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=n.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&n instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:n.type,sdp:o}):n.sdp=o}return e.apply(this,arguments)}}function bn(t,r){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const e=t.RTCPeerConnection.prototype.addIceCandidate;!e||e.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(r.browser==="chrome"&&r.version<78||r.browser==="firefox"&&r.version<68||r.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function vn(t,r){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const e=t.RTCPeerConnection.prototype.setLocalDescription;!e||e.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let n=arguments[0]||{};if(typeof n!="object"||n.type&&n.sdp)return e.apply(this,arguments);if(n={type:n.type,sdp:n.sdp},!n.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":n.type="offer";break;default:n.type="answer";break}return n.sdp||n.type!=="offer"&&n.type!=="answer"?e.apply(this,[n]):(n.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>e.apply(this,[a]))})}const gh=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:go,shimAddIceCandidateNullOrEmpty:bn,shimConnectionState:mo,shimMaxMessageSize:gn,shimParameterlessSetLocalDescription:vn,shimRTCIceCandidate:mn,shimRTCIceCandidateRelayProtocol:ho,shimSendThrowTypeError:yn},Symbol.toStringTag,{value:"Module"}));function yh({window:t}={},r={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const e=vc,i=ph(t),n={browserDetails:i,commonShim:gh,extractVersion:Er,disableLog:uh,disableWarnings:dh,sdp:mh};switch(i.browser){case"chrome":if(!Ca||!po||!r.shimChrome)return e("Chrome shim is not included in this adapter release."),n;if(i.version===null)return e("Chrome shim can not determine version, not shimming."),n;e("adapter.js shimming chrome."),n.browserShim=Ca,bn(t,i),vn(t),kc(t,i),xc(t),po(t,i),_c(t),Tc(t,i),Sc(t),Cc(t),Ec(t,i),mn(t),ho(t),mo(t),gn(t,i),yn(t),go(t,i);break;case"firefox":if(!Pa||!fo||!r.shimFirefox)return e("Firefox shim is not included in this adapter release."),n;e("adapter.js shimming firefox."),n.browserShim=Pa,bn(t,i),vn(t),$c(t,i),fo(t,i),Ic(t),Ac(t),Rc(t),Nc(t),Mc(t),Oc(t),Fc(t),Dc(t),zc(t),mn(t),mo(t),gn(t,i),yn(t);break;case"safari":if(!Ta||!r.shimSafari)return e("Safari shim is not included in this adapter release."),n;e("adapter.js shimming safari."),n.browserShim=Ta,bn(t,i),vn(t),Vc(t),Wc(t),Uc(t),Lc(t),jc(t),Gc(t),Bc(t),Hc(t),mn(t),ho(t),gn(t,i),yn(t),go(t,i);break;default:e("Unsupported browser!");break}return n}const $a=yh({window:typeof window>"u"?void 0:window});function nr(t,r,e,i){Object.defineProperty(t,r,{get:e,set:i,enumerable:!0,configurable:!0})}class Yc{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=r=>{const e=[],i=r.byteLength,n=Math.ceil(i/this.chunkedMTU);let o=0,a=0;for(;a<i;){const l=Math.min(i,a+this.chunkedMTU),u=r.slice(a,l),s={__peerData:this._dataCount,n:o,data:u,total:n};e.push(s),a=l,o++}return this._dataCount++,e}}}function bh(t){let r=0;for(const n of t)r+=n.byteLength;const e=new Uint8Array(r);let i=0;for(const n of t)e.set(n,i),i+=n.byteLength;return e}const qn=$a.default||$a,wr=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const t=this.getBrowser(),r=this.getVersion();return this.supportedBrowsers.includes(t)?t==="chrome"?r>=this.minChromeVersion:t==="firefox"?r>=this.minFirefoxVersion:t==="safari"?!this.isIOS&&r>=this.minSafariVersion:!1:!1}getBrowser(){return qn.browserDetails.browser}getVersion(){return qn.browserDetails.version||0}isUnifiedPlanSupported(){const t=this.getBrowser(),r=qn.browserDetails.version||0;if(t==="chrome"&&r<this.minChromeVersion)return!1;if(t==="firefox"&&r>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let e,i=!1;try{e=new RTCPeerConnection,e.addTransceiver("audio"),i=!0}catch{}finally{e&&e.close()}return i}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},vh=t=>!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t),Xc=()=>Math.random().toString(36).slice(2),Ia={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class wh extends Yc{noop(){}blobToArrayBuffer(r,e){const i=new FileReader;return i.onload=function(n){n.target&&e(n.target.result)},i.readAsArrayBuffer(r),i}binaryStringToArrayBuffer(r){const e=new Uint8Array(r.length);for(let i=0;i<r.length;i++)e[i]=r.charCodeAt(i)&255;return e.buffer}isSecure(){return location.protocol==="https:"}constructor(...r){super(...r),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=Ia,this.browser=wr.getBrowser(),this.browserVersion=wr.getVersion(),this.pack=gc,this.unpack=mc,this.supports=function(){const e={browser:wr.isBrowserSupported(),webRTC:wr.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!e.webRTC)return e;let i;try{i=new RTCPeerConnection(Ia),e.audioVideo=!0;let n;try{n=i.createDataChannel("_PEERJSTEST",{ordered:!0}),e.data=!0,e.reliable=!!n.ordered;try{n.binaryType="blob",e.binaryBlob=!wr.isIOS}catch{}}catch{}finally{n&&n.close()}}catch{}finally{i&&i.close()}return e}(),this.validateId=vh,this.randomToken=Xc}}const Je=new wh,kh="PeerJS: ";var Ra;(function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"})(Ra||(Ra={}));class xh{get logLevel(){return this._logLevel}set logLevel(r){this._logLevel=r}log(...r){this._logLevel>=3&&this._print(3,...r)}warn(...r){this._logLevel>=2&&this._print(2,...r)}error(...r){this._logLevel>=1&&this._print(1,...r)}setLogFunction(r){this._print=r}_print(r,...e){const i=[kh,...e];for(const n in i)i[n]instanceof Error&&(i[n]="("+i[n].name+") "+i[n].message);r>=3?console.log(...i):r>=2?console.warn("WARNING",...i):r>=1&&console.error("ERROR",...i)}constructor(){this._logLevel=0}}var Q=new xh,zo={},_h=Object.prototype.hasOwnProperty,Xe="~";function zr(){}Object.create&&(zr.prototype=Object.create(null),new zr().__proto__||(Xe=!1));function Sh(t,r,e){this.fn=t,this.context=r,this.once=e||!1}function Kc(t,r,e,i,n){if(typeof e!="function")throw new TypeError("The listener must be a function");var o=new Sh(e,i||t,n),a=Xe?Xe+r:r;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],o]:t._events[a].push(o):(t._events[a]=o,t._eventsCount++),t}function wn(t,r){--t._eventsCount===0?t._events=new zr:delete t._events[r]}function Ve(){this._events=new zr,this._eventsCount=0}Ve.prototype.eventNames=function(){var r=[],e,i;if(this._eventsCount===0)return r;for(i in e=this._events)_h.call(e,i)&&r.push(Xe?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r};Ve.prototype.listeners=function(r){var e=Xe?Xe+r:r,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,o=i.length,a=new Array(o);n<o;n++)a[n]=i[n].fn;return a};Ve.prototype.listenerCount=function(r){var e=Xe?Xe+r:r,i=this._events[e];return i?i.fn?1:i.length:0};Ve.prototype.emit=function(r,e,i,n,o,a){var l=Xe?Xe+r:r;if(!this._events[l])return!1;var u=this._events[l],s=arguments.length,c,d;if(u.fn){switch(u.once&&this.removeListener(r,u.fn,void 0,!0),s){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,n),!0;case 5:return u.fn.call(u.context,e,i,n,o),!0;case 6:return u.fn.call(u.context,e,i,n,o,a),!0}for(d=1,c=new Array(s-1);d<s;d++)c[d-1]=arguments[d];u.fn.apply(u.context,c)}else{var f=u.length,p;for(d=0;d<f;d++)switch(u[d].once&&this.removeListener(r,u[d].fn,void 0,!0),s){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,e);break;case 3:u[d].fn.call(u[d].context,e,i);break;case 4:u[d].fn.call(u[d].context,e,i,n);break;default:if(!c)for(p=1,c=new Array(s-1);p<s;p++)c[p-1]=arguments[p];u[d].fn.apply(u[d].context,c)}}return!0};Ve.prototype.on=function(r,e,i){return Kc(this,r,e,i,!1)};Ve.prototype.once=function(r,e,i){return Kc(this,r,e,i,!0)};Ve.prototype.removeListener=function(r,e,i,n){var o=Xe?Xe+r:r;if(!this._events[o])return this;if(!e)return wn(this,o),this;var a=this._events[o];if(a.fn)a.fn===e&&(!n||a.once)&&(!i||a.context===i)&&wn(this,o);else{for(var l=0,u=[],s=a.length;l<s;l++)(a[l].fn!==e||n&&!a[l].once||i&&a[l].context!==i)&&u.push(a[l]);u.length?this._events[o]=u.length===1?u[0]:u:wn(this,o)}return this};Ve.prototype.removeAllListeners=function(r){var e;return r?(e=Xe?Xe+r:r,this._events[e]&&wn(this,e)):(this._events=new zr,this._eventsCount=0),this};Ve.prototype.off=Ve.prototype.removeListener;Ve.prototype.addListener=Ve.prototype.on;Ve.prefixed=Xe;Ve.EventEmitter=Ve;zo=Ve;var ir={};nr(ir,"ConnectionType",()=>bt);nr(ir,"PeerErrorType",()=>Ie);nr(ir,"BaseConnectionErrorType",()=>Lr);nr(ir,"DataConnectionErrorType",()=>jr);nr(ir,"SerializationType",()=>ur);nr(ir,"SocketEventType",()=>yt);nr(ir,"ServerMessageType",()=>Le);var bt;(function(t){t.Data="data",t.Media="media"})(bt||(bt={}));var Ie;(function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"})(Ie||(Ie={}));var Lr;(function(t){t.NegotiationFailed="negotiation-failed",t.ConnectionClosed="connection-closed"})(Lr||(Lr={}));var jr;(function(t){t.NotOpenYet="not-open-yet",t.MessageToBig="message-too-big"})(jr||(jr={}));var ur;(function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json",t.None="raw"})(ur||(ur={}));var yt;(function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"})(yt||(yt={}));var Le;(function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"})(Le||(Le={}));var Lo={};Lo=JSON.parse('{"name":"peerjs","version":"1.5.4","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Soren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.1.0","webrtc-adapter":"^9.0.0"},"alias":{"process":false,"buffer":false}}');class Ch extends zo.EventEmitter{constructor(r,e,i,n,o,a=5e3){super(),this.pingInterval=a,this._disconnected=!0,this._messagesQueue=[];const l=r?"wss://":"ws://";this._baseUrl=l+e+":"+i+n+"peerjs?key="+o}start(r,e){this._id=r;const i=`${this._baseUrl}&id=${r}&token=${e}`;this._socket||!this._disconnected||(this._socket=new WebSocket(i+"&version="+Lo.version),this._disconnected=!1,this._socket.onmessage=n=>{let o;try{o=JSON.parse(n.data),Q.log("Server message received:",o)}catch{Q.log("Invalid server message",n.data);return}this.emit(yt.Message,o)},this._socket.onclose=n=>{this._disconnected||(Q.log("Socket closed.",n),this._cleanup(),this._disconnected=!0,this.emit(yt.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),Q.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){Q.log("Cannot send heartbeat, because socket closed");return}const r=JSON.stringify({type:Le.Heartbeat});this._socket.send(r),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const r=[...this._messagesQueue];this._messagesQueue=[];for(const e of r)this.send(e)}send(r){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(r);return}if(!r.type){this.emit(yt.Error,"Invalid message");return}if(!this._wsOpen())return;const e=JSON.stringify(r);this._socket.send(e)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class Jc{constructor(r){this.connection=r}startConnection(r){const e=this._startPeerConnection();if(this.connection.peerConnection=e,this.connection.type===bt.Media&&r._stream&&this._addTracksToConnection(r._stream,e),r.originator){const i=this.connection,n={ordered:!!r.reliable},o=e.createDataChannel(i.label,n);i._initializeDataChannel(o),this._makeOffer()}else this.handleSDP("OFFER",r.sdp)}_startPeerConnection(){Q.log("Creating RTCPeerConnection.");const r=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(r),r}_setupListeners(r){const e=this.connection.peer,i=this.connection.connectionId,n=this.connection.type,o=this.connection.provider;Q.log("Listening for ICE candidates."),r.onicecandidate=a=>{!a.candidate||!a.candidate.candidate||(Q.log(`Received ICE candidates for ${e}:`,a.candidate),o.socket.send({type:Le.Candidate,payload:{candidate:a.candidate,type:n,connectionId:i},dst:e}))},r.oniceconnectionstatechange=()=>{switch(r.iceConnectionState){case"failed":Q.log("iceConnectionState is failed, closing connections to "+e),this.connection.emitError(Lr.NegotiationFailed,"Negotiation of connection to "+e+" failed."),this.connection.close();break;case"closed":Q.log("iceConnectionState is closed, closing connections to "+e),this.connection.emitError(Lr.ConnectionClosed,"Connection to "+e+" closed."),this.connection.close();break;case"disconnected":Q.log("iceConnectionState changed to disconnected on the connection with "+e);break;case"completed":r.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",r.iceConnectionState)},Q.log("Listening for data channel"),r.ondatachannel=a=>{Q.log("Received data channel");const l=a.channel;o.getConnection(e,i)._initializeDataChannel(l)},Q.log("Listening for remote stream"),r.ontrack=a=>{Q.log("Received remote stream");const l=a.streams[0],u=o.getConnection(e,i);if(u.type===bt.Media){const s=u;this._addStreamToMediaConnection(l,s)}}}cleanup(){Q.log("Cleaning up PeerConnection to "+this.connection.peer);const r=this.connection.peerConnection;if(!r)return;this.connection.peerConnection=null,r.onicecandidate=r.oniceconnectionstatechange=r.ondatachannel=r.ontrack=()=>{};const e=r.signalingState!=="closed";let i=!1;const n=this.connection.dataChannel;n&&(i=!!n.readyState&&n.readyState!=="closed"),(e||i)&&r.close()}async _makeOffer(){const r=this.connection.peerConnection,e=this.connection.provider;try{const i=await r.createOffer(this.connection.options.constraints);Q.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp);try{await r.setLocalDescription(i),Q.log("Set localDescription:",i,`for:${this.connection.peer}`);let n={sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===bt.Data){const o=this.connection;n={...n,label:o.label,reliable:o.reliable,serialization:o.serialization}}e.socket.send({type:Le.Offer,payload:n,dst:this.connection.peer})}catch(n){n!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(e.emitError(Ie.WebRTC,n),Q.log("Failed to setLocalDescription, ",n))}}catch(i){e.emitError(Ie.WebRTC,i),Q.log("Failed to createOffer, ",i)}}async _makeAnswer(){const r=this.connection.peerConnection,e=this.connection.provider;try{const i=await r.createAnswer();Q.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp);try{await r.setLocalDescription(i),Q.log("Set localDescription:",i,`for:${this.connection.peer}`),e.socket.send({type:Le.Answer,payload:{sdp:i,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(n){e.emitError(Ie.WebRTC,n),Q.log("Failed to setLocalDescription, ",n)}}catch(i){e.emitError(Ie.WebRTC,i),Q.log("Failed to create answer, ",i)}}async handleSDP(r,e){e=new RTCSessionDescription(e);const i=this.connection.peerConnection,n=this.connection.provider;Q.log("Setting remote description",e);const o=this;try{await i.setRemoteDescription(e),Q.log(`Set remoteDescription:${r} for:${this.connection.peer}`),r==="OFFER"&&await o._makeAnswer()}catch(a){n.emitError(Ie.WebRTC,a),Q.log("Failed to setRemoteDescription, ",a)}}async handleCandidate(r){Q.log("handleCandidate:",r);try{await this.connection.peerConnection.addIceCandidate(r),Q.log(`Added ICE candidate for:${this.connection.peer}`)}catch(e){this.connection.provider.emitError(Ie.WebRTC,e),Q.log("Failed to handleCandidate, ",e)}}_addTracksToConnection(r,e){if(Q.log(`add tracks from stream ${r.id} to peer connection`),!e.addTrack)return Q.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");r.getTracks().forEach(i=>{e.addTrack(i,r)})}_addStreamToMediaConnection(r,e){Q.log(`add stream ${r.id} to media connection ${e.connectionId}`),e.addStream(r)}}class Qc extends zo.EventEmitter{emitError(r,e){Q.error("Error:",e),this.emit("error",new Ph(`${r}`,e))}}class Ph extends Error{constructor(r,e){typeof e=="string"?super(e):(super(),Object.assign(this,e)),this.type=r}}class eu extends Qc{get open(){return this._open}constructor(r,e,i){super(),this.peer=r,this.provider=e,this.options=i,this._open=!1,this.metadata=i.metadata}}class Cn extends eu{static#e=this.ID_PREFIX="mc_";get type(){return bt.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(r,e,i){super(r,e,i),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||Cn.ID_PREFIX+Je.randomToken(),this._negotiator=new Jc(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(r){this.dataChannel=r,this.dataChannel.onopen=()=>{Q.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{Q.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(r){Q.log("Receiving stream",r),this._remoteStream=r,super.emit("stream",r)}handleMessage(r){const e=r.type,i=r.payload;switch(r.type){case Le.Answer:this._negotiator.handleSDP(e,i.sdp),this._open=!0;break;case Le.Candidate:this._negotiator.handleCandidate(i.candidate);break;default:Q.warn(`Unrecognized message type:${e} from peer:${this.peer}`);break}}answer(r,e={}){if(this._localStream){Q.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=r,e&&e.sdpTransform&&(this.options.sdpTransform=e.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:r});const i=this.provider._getMessages(this.connectionId);for(const n of i)this.handleMessage(n);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class Th{constructor(r){this._options=r}_buildRequest(r){const e=this._options.secure?"https":"http",{host:i,port:n,path:o,key:a}=this._options,l=new URL(`${e}://${i}:${n}${o}${a}/${r}`);return l.searchParams.set("ts",`${Date.now()}${Math.random()}`),l.searchParams.set("version",Lo.version),fetch(l.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const r=await this._buildRequest("id");if(r.status!==200)throw new Error(`Error. Status:${r.status}`);return r.text()}catch(r){Q.error("Error retrieving ID",r);let e="";throw this._options.path==="/"&&this._options.host!==Je.CLOUD_HOST&&(e=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+e)}}async listAllPeers(){try{const r=await this._buildRequest("peers");if(r.status!==200){if(r.status===401){let e="";throw this._options.host===Je.CLOUD_HOST?e="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":e="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+e)}throw new Error(`Error. Status:${r.status}`)}return r.json()}catch(r){throw Q.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r)}}}class Pn extends eu{static#e=this.ID_PREFIX="dc_";static#n=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return bt.Data}constructor(r,e,i){super(r,e,i),this.connectionId=this.options.connectionId||Pn.ID_PREFIX+Xc(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new Jc(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(r){this.dataChannel=r,this.dataChannel.onopen=()=>{Q.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=e=>{Q.log(`DC#${this.connectionId} dc onmessage:`,e.data)},this.dataChannel.onclose=()=>{Q.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(r){if(r?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(r,e=!1){if(!this.open){this.emitError(jr.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(r,e)}async handleMessage(r){const e=r.payload;switch(r.type){case Le.Answer:await this._negotiator.handleSDP(r.type,e.sdp);break;case Le.Candidate:await this._negotiator.handleCandidate(e.candidate);break;default:Q.warn("Unrecognized message type:",r.type,"from peer:",this.peer);break}}}class jo extends Pn{get bufferSize(){return this._bufferSize}_initializeDataChannel(r){super._initializeDataChannel(r),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",e=>this._handleDataMessage(e))}_bufferedSend(r){(this._buffering||!this._trySend(r))&&(this._buffer.push(r),this._bufferSize=this._buffer.length)}_trySend(r){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>Pn.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(r)}catch(e){return Q.error(`DC#:${this.connectionId} Error when sending:`,e),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const r=this._buffer[0];this._trySend(r)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(r){if(r?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...r){super(...r),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class Vn extends jo{close(r){super.close(r),this._chunkedData={}}constructor(r,e,i){super(r,e,i),this.chunker=new Yc,this.serialization=ur.Binary,this._chunkedData={}}_handleDataMessage({data:r}){const e=mc(r),i=e.__peerData;if(i){if(i.type==="close"){this.close();return}this._handleChunk(e);return}this.emit("data",e)}_handleChunk(r){const e=r.__peerData,i=this._chunkedData[e]||{data:[],count:0,total:r.total};if(i.data[r.n]=new Uint8Array(r.data),i.count++,this._chunkedData[e]=i,i.total===i.count){delete this._chunkedData[e];const n=bh(i.data);this._handleDataMessage({data:n})}}_send(r,e){const i=gc(r);if(i instanceof Promise)return this._send_blob(i);if(!e&&i.byteLength>this.chunker.chunkedMTU){this._sendChunks(i);return}this._bufferedSend(i)}async _send_blob(r){const e=await r;if(e.byteLength>this.chunker.chunkedMTU){this._sendChunks(e);return}this._bufferedSend(e)}_sendChunks(r){const e=this.chunker.chunk(r);Q.log(`DC#${this.connectionId} Try to send ${e.length} chunks...`);for(const i of e)this.send(i,!0)}}class Eh extends jo{_handleDataMessage({data:r}){super.emit("data",r)}_send(r,e){this._bufferedSend(r)}constructor(...r){super(...r),this.serialization=ur.None}}class $h extends jo{_handleDataMessage({data:r}){const e=this.parse(this.decoder.decode(r)),i=e.__peerData;if(i&&i.type==="close"){this.close();return}this.emit("data",e)}_send(r,e){const i=this.encoder.encode(this.stringify(r));if(i.byteLength>=Je.chunkedMTU){this.emitError(jr.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(i)}constructor(...r){super(...r),this.serialization=ur.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class Uo extends Qc{static#e=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const r=Object.create(null);for(const[e,i]of this._connections)r[e]=i;return r}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(r,e){super(),this._serializers={raw:Eh,json:$h,binary:Vn,"binary-utf8":Vn,default:Vn},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let i;if(r&&r.constructor==Object?e=r:r&&(i=r.toString()),e={debug:0,host:Je.CLOUD_HOST,port:Je.CLOUD_PORT,path:"/",key:Uo.DEFAULT_KEY,token:Je.randomToken(),config:Je.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...e},this._options=e,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Je.CLOUD_HOST?this._options.secure=Je.isSecure():this._options.host==Je.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&Q.setLogFunction(this._options.logFunction),Q.logLevel=this._options.debug||0,this._api=new Th(e),this._socket=this._createServerConnection(),!Je.supports.audioVideo&&!Je.supports.data){this._delayedAbort(Ie.BrowserIncompatible,"The current browser does not support WebRTC");return}if(i&&!Je.validateId(i)){this._delayedAbort(Ie.InvalidID,`ID "${i}" is invalid`);return}i?this._initialize(i):this._api.retrieveId().then(n=>this._initialize(n)).catch(n=>this._abort(Ie.ServerError,n))}_createServerConnection(){const r=new Ch(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return r.on(yt.Message,e=>{this._handleMessage(e)}),r.on(yt.Error,e=>{this._abort(Ie.SocketError,e)}),r.on(yt.Disconnected,()=>{this.disconnected||(this.emitError(Ie.Network,"Lost connection to server."),this.disconnect())}),r.on(yt.Close,()=>{this.disconnected||this._abort(Ie.SocketClosed,"Underlying socket is already closed.")}),r}_initialize(r){this._id=r,this.socket.start(r,this._options.token)}_handleMessage(r){const e=r.type,i=r.payload,n=r.src;switch(e){case Le.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case Le.Error:this._abort(Ie.ServerError,i.msg);break;case Le.IdTaken:this._abort(Ie.UnavailableID,`ID "${this.id}" is taken`);break;case Le.InvalidKey:this._abort(Ie.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case Le.Leave:Q.log(`Received leave message from ${n}`),this._cleanupPeer(n),this._connections.delete(n);break;case Le.Expire:this.emitError(Ie.PeerUnavailable,`Could not connect to peer ${n}`);break;case Le.Offer:{const o=i.connectionId;let a=this.getConnection(n,o);if(a&&(a.close(),Q.warn(`Offer received for existing Connection ID:${o}`)),i.type===bt.Media){const u=new Cn(n,this,{connectionId:o,_payload:i,metadata:i.metadata});a=u,this._addConnection(n,a),this.emit("call",u)}else if(i.type===bt.Data){const u=new this._serializers[i.serialization](n,this,{connectionId:o,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable});a=u,this._addConnection(n,a),this.emit("connection",u)}else{Q.warn(`Received malformed connection type:${i.type}`);return}const l=this._getMessages(o);for(const u of l)a.handleMessage(u);break}default:{if(!i){Q.warn(`You received a malformed message from ${n} of type ${e}`);return}const o=i.connectionId,a=this.getConnection(n,o);a&&a.peerConnection?a.handleMessage(r):o?this._storeMessage(o,r):Q.warn("You received an unrecognized message:",r);break}}}_storeMessage(r,e){this._lostMessages.has(r)||this._lostMessages.set(r,[]),this._lostMessages.get(r).push(e)}_getMessages(r){const e=this._lostMessages.get(r);return e?(this._lostMessages.delete(r),e):[]}connect(r,e={}){if(e={serialization:"default",...e},this.disconnected){Q.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(Ie.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const i=new this._serializers[e.serialization](r,this,e);return this._addConnection(r,i),i}call(r,e,i={}){if(this.disconnected){Q.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(Ie.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!e){Q.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const n=new Cn(r,this,{...i,_stream:e});return this._addConnection(r,n),n}_addConnection(r,e){Q.log(`add connection ${e.type}:${e.connectionId} to peerId:${r}`),this._connections.has(r)||this._connections.set(r,[]),this._connections.get(r).push(e)}_removeConnection(r){const e=this._connections.get(r.peer);if(e){const i=e.indexOf(r);i!==-1&&e.splice(i,1)}this._lostMessages.delete(r.connectionId)}getConnection(r,e){const i=this._connections.get(r);if(!i)return null;for(const n of i)if(n.connectionId===e)return n;return null}_delayedAbort(r,e){setTimeout(()=>{this._abort(r,e)},0)}_abort(r,e){Q.error("Aborting!"),this.emitError(r,e),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(Q.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const r of this._connections.keys())this._cleanupPeer(r),this._connections.delete(r);this.socket.removeAllListeners()}_cleanupPeer(r){const e=this._connections.get(r);if(e)for(const i of e)i.close()}disconnect(){if(this.disconnected)return;const r=this.id;Q.log(`Disconnect peer with ID:${r}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=r,this._id=null,this.emit("disconnected",r)}reconnect(){if(this.disconnected&&!this.destroyed)Q.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Q.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(r=e=>{}){this._api.listAllPeers().then(e=>r(e)).catch(e=>this._abort(Ie.ServerError,e))}}var Na=Uo,Gn={exports:{}},Wn={exports:{}},Aa;function Ih(){return Aa||(Aa=1,function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,i){return e<<i|e>>>32-i},rotr:function(e,i){return e<<32-i|e>>>i},endian:function(e){if(e.constructor==Number)return r.rotl(e,8)&16711935|r.rotl(e,24)&4278255360;for(var i=0;i<e.length;i++)e[i]=r.endian(e[i]);return e},randomBytes:function(e){for(var i=[];e>0;e--)i.push(Math.floor(Math.random()*256));return i},bytesToWords:function(e){for(var i=[],n=0,o=0;n<e.length;n++,o+=8)i[o>>>5]|=e[n]<<24-o%32;return i},wordsToBytes:function(e){for(var i=[],n=0;n<e.length*32;n+=8)i.push(e[n>>>5]>>>24-n%32&255);return i},bytesToHex:function(e){for(var i=[],n=0;n<e.length;n++)i.push((e[n]>>>4).toString(16)),i.push((e[n]&15).toString(16));return i.join("")},hexToBytes:function(e){for(var i=[],n=0;n<e.length;n+=2)i.push(parseInt(e.substr(n,2),16));return i},bytesToBase64:function(e){for(var i=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],a=0;a<4;a++)n*8+a*6<=e.length*8?i.push(t.charAt(o>>>6*(3-a)&63)):i.push("=");return i.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var i=[],n=0,o=0;n<e.length;o=++n%4)o!=0&&i.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<o*2|t.indexOf(e.charAt(n))>>>6-o*2);return i}};Wn.exports=r}()),Wn.exports}var Hn,Ma;function Oa(){if(Ma)return Hn;Ma=1;var t={utf8:{stringToBytes:function(r){return t.bin.stringToBytes(unescape(encodeURIComponent(r)))},bytesToString:function(r){return decodeURIComponent(escape(t.bin.bytesToString(r)))}},bin:{stringToBytes:function(r){for(var e=[],i=0;i<r.length;i++)e.push(r.charCodeAt(i)&255);return e},bytesToString:function(r){for(var e=[],i=0;i<r.length;i++)e.push(String.fromCharCode(r[i]));return e.join("")}}};return Hn=t,Hn}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Zn,Fa;function Rh(){if(Fa)return Zn;Fa=1,Zn=function(e){return e!=null&&(t(e)||r(e)||!!e._isBuffer)};function t(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function r(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&t(e.slice(0,0))}return Zn}var Da;function Nh(){return Da||(Da=1,function(){var t=Ih(),r=Oa().utf8,e=Rh(),i=Oa().bin,n=function(o,a){o.constructor==String?a&&a.encoding==="binary"?o=i.stringToBytes(o):o=r.stringToBytes(o):e(o)?o=Array.prototype.slice.call(o,0):!Array.isArray(o)&&o.constructor!==Uint8Array&&(o=o.toString());for(var l=t.bytesToWords(o),u=o.length*8,s=1732584193,c=-271733879,d=-1732584194,f=271733878,p=0;p<l.length;p++)l[p]=(l[p]<<8|l[p]>>>24)&16711935|(l[p]<<24|l[p]>>>8)&4278255360;l[u>>>5]|=128<<u%32,l[(u+64>>>9<<4)+14]=u;for(var h=n._ff,g=n._gg,m=n._hh,b=n._ii,p=0;p<l.length;p+=16){var y=s,w=c,v=d,k=f;s=h(s,c,d,f,l[p+0],7,-680876936),f=h(f,s,c,d,l[p+1],12,-389564586),d=h(d,f,s,c,l[p+2],17,606105819),c=h(c,d,f,s,l[p+3],22,-1044525330),s=h(s,c,d,f,l[p+4],7,-176418897),f=h(f,s,c,d,l[p+5],12,1200080426),d=h(d,f,s,c,l[p+6],17,-1473231341),c=h(c,d,f,s,l[p+7],22,-45705983),s=h(s,c,d,f,l[p+8],7,1770035416),f=h(f,s,c,d,l[p+9],12,-1958414417),d=h(d,f,s,c,l[p+10],17,-42063),c=h(c,d,f,s,l[p+11],22,-1990404162),s=h(s,c,d,f,l[p+12],7,1804603682),f=h(f,s,c,d,l[p+13],12,-40341101),d=h(d,f,s,c,l[p+14],17,-1502002290),c=h(c,d,f,s,l[p+15],22,1236535329),s=g(s,c,d,f,l[p+1],5,-165796510),f=g(f,s,c,d,l[p+6],9,-1069501632),d=g(d,f,s,c,l[p+11],14,643717713),c=g(c,d,f,s,l[p+0],20,-373897302),s=g(s,c,d,f,l[p+5],5,-701558691),f=g(f,s,c,d,l[p+10],9,38016083),d=g(d,f,s,c,l[p+15],14,-660478335),c=g(c,d,f,s,l[p+4],20,-405537848),s=g(s,c,d,f,l[p+9],5,568446438),f=g(f,s,c,d,l[p+14],9,-1019803690),d=g(d,f,s,c,l[p+3],14,-187363961),c=g(c,d,f,s,l[p+8],20,1163531501),s=g(s,c,d,f,l[p+13],5,-1444681467),f=g(f,s,c,d,l[p+2],9,-51403784),d=g(d,f,s,c,l[p+7],14,1735328473),c=g(c,d,f,s,l[p+12],20,-1926607734),s=m(s,c,d,f,l[p+5],4,-378558),f=m(f,s,c,d,l[p+8],11,-2022574463),d=m(d,f,s,c,l[p+11],16,1839030562),c=m(c,d,f,s,l[p+14],23,-35309556),s=m(s,c,d,f,l[p+1],4,-1530992060),f=m(f,s,c,d,l[p+4],11,1272893353),d=m(d,f,s,c,l[p+7],16,-155497632),c=m(c,d,f,s,l[p+10],23,-1094730640),s=m(s,c,d,f,l[p+13],4,681279174),f=m(f,s,c,d,l[p+0],11,-358537222),d=m(d,f,s,c,l[p+3],16,-722521979),c=m(c,d,f,s,l[p+6],23,76029189),s=m(s,c,d,f,l[p+9],4,-640364487),f=m(f,s,c,d,l[p+12],11,-421815835),d=m(d,f,s,c,l[p+15],16,530742520),c=m(c,d,f,s,l[p+2],23,-995338651),s=b(s,c,d,f,l[p+0],6,-198630844),f=b(f,s,c,d,l[p+7],10,1126891415),d=b(d,f,s,c,l[p+14],15,-1416354905),c=b(c,d,f,s,l[p+5],21,-57434055),s=b(s,c,d,f,l[p+12],6,1700485571),f=b(f,s,c,d,l[p+3],10,-1894986606),d=b(d,f,s,c,l[p+10],15,-1051523),c=b(c,d,f,s,l[p+1],21,-2054922799),s=b(s,c,d,f,l[p+8],6,1873313359),f=b(f,s,c,d,l[p+15],10,-30611744),d=b(d,f,s,c,l[p+6],15,-1560198380),c=b(c,d,f,s,l[p+13],21,1309151649),s=b(s,c,d,f,l[p+4],6,-145523070),f=b(f,s,c,d,l[p+11],10,-1120210379),d=b(d,f,s,c,l[p+2],15,718787259),c=b(c,d,f,s,l[p+9],21,-343485551),s=s+y>>>0,c=c+w>>>0,d=d+v>>>0,f=f+k>>>0}return t.endian([s,c,d,f])};n._ff=function(o,a,l,u,s,c,d){var f=o+(a&l|~a&u)+(s>>>0)+d;return(f<<c|f>>>32-c)+a},n._gg=function(o,a,l,u,s,c,d){var f=o+(a&u|l&~u)+(s>>>0)+d;return(f<<c|f>>>32-c)+a},n._hh=function(o,a,l,u,s,c,d){var f=o+(a^l^u)+(s>>>0)+d;return(f<<c|f>>>32-c)+a},n._ii=function(o,a,l,u,s,c,d){var f=o+(l^(a|~u))+(s>>>0)+d;return(f<<c|f>>>32-c)+a},n._blocksize=16,n._digestsize=16,Gn.exports=function(o,a){if(o==null)throw new Error("Illegal argument "+o);var l=t.wordsToBytes(n(o,a));return a&&a.asBytes?l:a&&a.asString?i.bytesToString(l):t.bytesToHex(l)}}()),Gn.exports}var Ah=Nh();const Mh=Nn(Ah),Oh="7ae48d46-10f2-kitty-";function Fh(){let t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="";for(let e=0;e<6;++e){let i=Math.floor(Math.random()*t.length);r+=t.substring(i,i+1)}return r}function za(t){return Mh(Oh+t)}var Dh=Y("<button class=btn>Copy"),zh=Y('<div class="toast toast-center toast-middle">'),Lh=Y('<div><div><div class=pb-2><label><div style=display:inline-block;padding-right:5px;>Nickname:</div><input type=text class=input></label></div></div><div><button class="btn btn-outline btn-primary ml-1">Invite</button><button class="btn btn-outline btn-primary ml-1">Join</button></div><div><div>Connections:<table class="table table-zebra"><thead><tr><th></th><th>Nickname</th><th></th></tr></thead><tbody></tbody></table></div><div>Pending Invites:<table class="table table-zebra"><thead><tr><th></th><th>Invite Code</th><th></th></tr></thead><tbody></tbody></table></div></div><dialog class=modal><div class=modal-box>Invite Code:<input type=text class="input ml-2"><button class="btn btn-primary">Paste</button><div class=modal-action><button class="btn btn-primary">OK</button><form method=dialog><button class=btn>Close'),jh=Y('<tr><td></td><td></td><td><button class="btn btn-primary">Kick'),Uh=Y('<tr><td></td><td></td><td><button class="btn btn-primary">Copy</button><button class="btn btn-primary ml-1">Delete'),Bh=Y('<div class="alert alert-info">');function qh(t){let[r,e]=je({nickname:oh.generateUsername("_"),connections:[],pendingInvites:[],toastStack:[],joinDialogInviteCode:""}),[i,n]=oe(),o=E(()=>r.connections.map(f=>f.value)),a=f=>{let p={};e("toastStack",Tr(g=>g.push(new rn({id:p,Render:f}))));let h=setTimeout(()=>{e("toastStack",r.toastStack.filter(g=>g.value.id!==p)),clearTimeout(h)},5e3)},l=()=>{let[f,p]=oe(!1),h=Fh(),g=za(h),m=new Na(g),b={inviteCode:h,peer:m};m.on("open",()=>{m.on("connection",y=>{y.once("data",w=>{typeof w=="string"&&(e("connections",Tr(v=>v.push(new rn({nickname:w,peer:m,conn:y})))),y.send({nickname:r.nickname,documentUrl:t.documentUrl()??null}),e("pendingInvites",r.pendingInvites.filter(v=>v.value!=b)))}),y.once("close",()=>{e("connections",r.connections.filter(w=>w.value.peer!==m))})}),e("pendingInvites",Tr(y=>y.push(new rn(b)))),a(()=>["Invite Code: ",h,(()=>{var y=Dh();return y.$$click=async()=>{await navigator.clipboard.writeText(h),p(!0);let w=setTimeout(()=>{clearTimeout(w),p(!1)},1e3)},y})(),D(ge,{get when(){return f()},children:"Copied"})])})},u=()=>{e("joinDialogInviteCode",""),i()?.showModal()},s=()=>{i()?.close();let f=r.joinDialogInviteCode;e("joinDialogInviteCode","");let p=za(f),h=new Na;h.on("open",()=>{let g=h.connect(p);g.on("open",()=>{g.once("data",m=>{let b=m.nickname,y=m.documentUrl;typeof b=="string"&&typeof y=="string"&&(t.setDocumentUrl(y),e("connections",Tr(w=>w.push(new rn({nickname:b,peer:h,conn:g})))))}),g.send(r.nickname),g.once("close",()=>{e("connections",r.connections.filter(m=>m.value.peer!==h))})})})},c=f=>{f.peer.destroy()};return{connections:o,Render:()=>(()=>{var f=Lh(),p=f.firstChild,h=p.firstChild,g=h.firstChild,m=g.firstChild,b=m.nextSibling,y=p.nextSibling,w=y.firstChild,v=w.nextSibling,k=y.nextSibling,_=k.firstChild,C=_.firstChild,S=C.nextSibling,P=S.firstChild,T=P.nextSibling,x=_.nextSibling,$=x.firstChild,O=$.nextSibling,N=O.firstChild,A=N.nextSibling,L=k.nextSibling,V=L.firstChild,Z=V.firstChild,G=Z.nextSibling,J=G.nextSibling,ue=J.nextSibling,de=ue.firstChild;f.style.setProperty("width","100%"),f.style.setProperty("height","100%"),f.style.setProperty("display","flex"),f.style.setProperty("flex-direction","column"),f.style.setProperty("padding","10px"),f.style.setProperty("position","relative"),b.$$input=F=>{e("nickname",F.currentTarget.validationMessage)},w.$$click=()=>l(),v.$$click=()=>u(),k.style.setProperty("flex-grow","1"),k.style.setProperty("display","flex"),k.style.setProperty("flex-direction","column"),k.style.setProperty("margin-top","10px"),_.style.setProperty("flex-grow","1"),_.style.setProperty("overflow-y","auto"),te(T,D(pt,{get each(){return r.connections},children:F=>(()=>{var z=jh(),q=z.firstChild,ee=q.nextSibling,I=ee.nextSibling,j=I.firstChild;return te(ee,()=>F.value.nickname),j.$$click=()=>{c(F.value)},z})()})),x.style.setProperty("flex-grow","1"),x.style.setProperty("overflow-y","auto"),te(A,D(pt,{get each(){return r.pendingInvites},children:F=>{let[z,q]=oe(!1);return(()=>{var ee=Uh(),I=ee.firstChild,j=I.nextSibling,se=j.nextSibling,ke=se.firstChild,be=ke.nextSibling;return te(j,()=>F.value.inviteCode),ke.$$click=async()=>{await navigator.clipboard.writeText(F.value.inviteCode),q(!0);let fe=setTimeout(()=>{clearTimeout(fe),q(!1)},1e3)},be.$$click=()=>{F.value.peer.destroy(),e("pendingInvites",r.pendingInvites.filter(fe=>fe.value!==F.value))},te(se,D(ge,{get when(){return z()},children:"Copied"}),null),ee})()}})),te(f,D(ge,{get when(){return r.toastStack.length!=0},get children(){var F=zh();return te(F,D(pt,{get each(){return r.toastStack},children:z=>(()=>{var q=Bh();return te(q,D(z.value.Render,{})),q})()})),F}}),L);var R=n;return typeof R=="function"?Ce(R,L):n=L,G.addEventListener("change",()=>{s()}),G.$$input=F=>{e("joinDialogInviteCode",F.currentTarget.value)},J.$$click=async()=>{let F=await navigator.clipboard.readText();e("joinDialogInviteCode",F)},de.$$click=()=>s(),le(()=>b.value=r.nickname),le(()=>G.value=r.joinDialogInviteCode),f})()}}Oe(["click","input"]);class Vh extends th{#e=!1;#n;connection;#r=!1;#i;#a=new Promise(r=>{this.#i=r});#t=[];isReady(){return this.#r}whenReady(){return this.#a}#s(){this.#r||(this.#r=!0,this.#i?.())}constructor(r){super(),this.#n=r,this.connection=r.connection}connect(r,e){this.peerId=r,this.peerMetadata=e,this.#e=!1,this.connection.on("data",i=>{if(typeof i!="string")return;const n=JSON.parse(i);if(console.log("message in, ",n),"targetId"in n&&n.targetId!==this.peerId||this.#e)return;const{senderId:o,type:a}=n;switch(a){case"arrive":{const{peerMetadata:l}=n;this.connection.send(JSON.stringify({senderId:this.peerId,targetId:o,type:"welcome",peerMetadata:this.peerMetadata})),this.#o(o,l)}break;case"welcome":{const{peerMetadata:l}=n;this.#o(o,l)}break;case"leave":this.#t=this.#t.filter(l=>l!==o),this.emit("peer-disconnected",{peerId:o});break;default:if(!("data"in n))this.emit("message",n);else{if(!n.data)throw new Error("We got a message without data, we can't send this.");const l=n.data;this.emit("message",{...n,data:new Uint8Array(l)})}break}}),this.connection.send(JSON.stringify({senderId:this.peerId,type:"arrive",peerMetadata:e}))}#o(r,e){this.#s(),this.#t.push(r),this.emit("peer-candidate",{peerId:r,peerMetadata:e})}send(r){if(this.#e)return!1;if("data"in r){let e=r.data?r.data.buffer.slice(r.data.byteOffset,r.data.byteOffset+r.data.byteLength):void 0,i=e==null?void 0:Array.from(new Uint8Array(e));this.connection.send(JSON.stringify({...r,data:i}))}else this.connection.send(JSON.stringify(r))}disconnect(){this.connection.send(JSON.stringify({senderId:this.peerId,type:"leave"}));for(const r of this.#t)this.emit("peer-disconnected",{peerId:r});this.#e=!0}}const Gh=261.63,La=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}];class Wh{audioContext=void 0;pianoNodes=[];constructor(){}async init(){if(this.audioContext){this.audioContext.state==="suspended"?await this.audioContext.resume():this.audioContext.state==="running"&&await this.audioContext.suspend();return}this.audioContext=new AudioContext,await this.audioContext.audioWorklet.addModule(yo),await this.audioContext.audioWorklet.addModule(tu),await this.audioContext.audioWorklet.addModule(ru),await this.audioContext.audioWorklet.addModule(nu);let r=this.audioContext.createGain();r.gain.value=.1,r.connect(this.audioContext.destination),this.pianoNodes=[];for(let e=0;e<12;++e){let i=new AudioWorkletNode(this.audioContext,"piano-processor");i.connect(r),this.pianoNodes.push(i)}}async noteOn(r){if(this.audioContext==null){await this.init();return}this.audioContext.state==="suspended"&&await this.audioContext.resume();let e=La.findIndex(n=>n.name==r);if(e==-1)return;let i=Gh*Math.pow(2,e/12);this.pianoNodes[e].port.postMessage({type:"noteOn",frequency:i})}async noteOff(r){this.audioContext==null&&await this.init();let e=La.findIndex(i=>i.name==r);e!=-1&&this.pianoNodes[e].port.postMessage({type:"noteOff"})}play(){this.init()}}const Hh=`
class SineProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = Math.sin(this.phase); // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('sine-processor', SineProcessor);
`,Zh=new Blob([Hh],{type:"application/javascript"}),yo=URL.createObjectURL(Zh),Yh=`
class SawProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = this.phase; // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('saw-processor', SawProcessor);
`,Xh=new Blob([Yh],{type:"application/javascript"}),tu=URL.createObjectURL(Xh),Kh=`
class SquareProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = (this.phase < Math.PI ? 0 : 1); // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('square-processor', SquareProcessor);
`,Jh=new Blob([Kh],{type:"application/javascript"}),ru=URL.createObjectURL(Jh),Qh=`
class PianoProcessor extends AudioWorkletProcessor {
    constructor() {
        super();
        this.phase = 0;
        this.sampleRate = sampleRate; // Global sampleRate from AudioWorkletGlobalScope

        // Define harmonics (fundamental + a few overtones) and their relative gains
        // These values are simplified and can be tweaked for different piano sounds
        this.harmonics = [
            { freqMultiplier: 1, gain: 1.0 },   // Fundamental
            { freqMultiplier: 2, gain: 0.6 },   // 1st overtone (octave)
            { freqMultiplier: 3, gain: 0.4 },   // 2nd overtone (fifth above octave)
            { freqMultiplier: 4, gain: 0.3 },   // 3rd overtone (two octaves)
            { freqMultiplier: 5, gain: 0.2 },   // 4th overtone (major third)
        ];

        // ADSR envelope parameters (simplified)
        this.attackTime = 0.01; // Very fast attack
        this.decayTime = 0.1;
        this.sustainLevel = 0.6;
        this.releaseTime = 0.8;

        this.envelopePhase = 0; // 0: idle, 1: attack, 2: decay, 3: sustain, 4: release
        this.currentGain = 0;
        this.noteOnTime = 0;
        this.noteOffTime = 0;
        this.frequency = 0; // Will be set via port.onmessage

        this.port.onmessage = (event) => {
            if (event.data.type === 'noteOn') {
                this.frequency = event.data.frequency;
                this.noteOnTime = currentTime; // Global currentTime from AudioWorkletGlobalScope
                this.envelopePhase = 1; // Start attack
                this.phase = 0; // Reset phase for new note
            } else if (event.data.type === 'noteOff') {
                this.noteOffTime = currentTime;
                this.envelopePhase = 4; // Start release
            }
        };
    }

    process(inputs, outputs, parameters) {
        const output = outputs[0]; // Assuming mono output for simplicity
        const channel = output[0]; // Get the first channel

        for (let i = 0; i < channel.length; ++i) {
            let sample = 0;

            // Update envelope
            if (this.envelopePhase === 1) { // Attack
                const timeElapsed = currentTime - this.noteOnTime;
                if (timeElapsed < this.attackTime) {
                    this.currentGain = timeElapsed / this.attackTime;
                } else {
                    this.currentGain = 1.0;
                    this.envelopePhase = 2; // Move to decay
                    this.decayStartTime = currentTime;
                }
            } else if (this.envelopePhase === 2) { // Decay
                const timeElapsed = currentTime - this.decayStartTime;
                if (timeElapsed < this.decayTime) {
                    this.currentGain = 1.0 - (1.0 - this.sustainLevel) * (timeElapsed / this.decayTime);
                } else {
                    this.currentGain = this.sustainLevel;
                    this.envelopePhase = 3; // Move to sustain
                }
            } else if (this.envelopePhase === 3) { // Sustain (maintain currentGain)
                // Nothing to do, just hold the sustain level
            } else if (this.envelopePhase === 4) { // Release
                const timeElapsed = currentTime - this.noteOffTime;
                if (timeElapsed < this.releaseTime) {
                    this.currentGain = this.sustainLevel * (1.0 - (timeElapsed / this.releaseTime));
                } else {
                    this.currentGain = 0;
                    this.envelopePhase = 0; // Go to idle
                    this.frequency = 0; // Stop generating sound
                }
            }

            // Generate sound if frequency and gain are active
            if (this.frequency > 0 && this.currentGain > 0.001) { // Threshold to prevent silence from generating
                for (const harmonic of this.harmonics) {
                    const freq = this.frequency * harmonic.freqMultiplier;
                    sample += Math.sin(this.phase * freq * 2 * Math.PI) * harmonic.gain;
                }
                sample *= this.currentGain; // Apply envelope gain
            } else {
                sample = 0; // No sound
            }

            channel[i] = sample;

            // Advance phase for the next sample
            this.phase += 1 / this.sampleRate;
            if (this.phase >= 1) {
                this.phase -= 1; // Keep phase within [0, 1)
            }
        }

        // Return false when the sound is completely silent to allow garbage collection
        //return this.envelopePhase !== 0 || this.currentGain > 0.001;
        return true;
    }
}

registerProcessor('piano-processor', PianoProcessor);`,em=new Blob([Qh],{type:"application/javascript"}),nu=URL.createObjectURL(em);window.addEventListener("beforeunload",()=>{yo&&(URL.revokeObjectURL(yo),URL.revokeObjectURL(tu),URL.revokeObjectURL(ru),URL.revokeObjectURL(nu))});var tm=Y("<div class=piano>"),rm=Y("<div class=white-key>"),nm=Y("<div class=black-key>");const im=t=>{const r=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}],e=150,i=80;let n,o=new Jt,a=new gt;return(()=>{var l=tm();l.$$pointermove=s=>{if(!o.get(s.pointerId))return;let c=n.getBoundingClientRect();o.set(s.pointerId,lo.create(s.clientX-c.left,s.clientY-c.top))},l.addEventListener("pointercancel",s=>{o.delete(s.pointerId),n.releasePointerCapture(s.pointerId)}),l.$$pointerup=s=>{o.delete(s.pointerId),n.releasePointerCapture(s.pointerId)},l.$$pointerdown=s=>{let c=n.getBoundingClientRect();o.set(s.pointerId,lo.create(s.clientX-c.left,s.clientY-c.top)),n.setPointerCapture(s.pointerId)};var u=n;return typeof u=="function"?Ce(u,l):n=l,l.style.setProperty("display","flex"),l.style.setProperty("flex-direction","row"),l.style.setProperty("overflow-x","auto"),l.style.setProperty("user-select","none"),l.style.setProperty("touch-action","none"),te(l,D(pt,{each:r,children:s=>{let[c,d]=oe();s.type=="black"&&ve(()=>{let p=c();p!=null&&(a.add(p),Ne(()=>a.delete(p)))});let f=E(()=>{let p=c();if(p==null)return!1;let h=n.getBoundingClientRect(),g=p.getBoundingClientRect();for(let m of o.values()){let b=h.left+m.x-g.left,y=h.top+m.y-g.top;if(0<b&&b<g.width&&0<y&&y<g.height){if(s.type=="white")for(let w of a){let v=w.getBoundingClientRect(),k=h.left+m.x-v.left,_=h.top+m.y-v.top;if(0<k&&k<v.width&&0<_&&_<v.height)return!1}return!0}}return!1});return ve(he(f,p=>{p?t.onNoteOn(s.name):t.onNoteOff(s.name)},{defer:!0})),D(An,{get children(){return[D($t,{get when(){return s.type=="white"},get children(){var p=rm(),h=d;return typeof h=="function"?Ce(h,p):d=p,p.style.setProperty("width","50px"),p.style.setProperty("pointer-events","none"),le(g=>{var m=!!f(),b=`${e+(f()?2:0)}px`;return m!==g.e&&p.classList.toggle("pressed",g.e=m),b!==g.t&&((g.t=b)!=null?p.style.setProperty("height",b):p.style.removeProperty("height")),g},{e:void 0,t:void 0}),p}}),D($t,{get when(){return s.type=="black"},get children(){var p=nm(),h=d;return typeof h=="function"?Ce(h,p):d=p,p.style.setProperty("margin-left","-16px"),p.style.setProperty("margin-right","-14px"),p.style.setProperty("width","30px"),p.style.setProperty("pointer-events","none"),le(g=>{var m=!!f(),b=`${i+(f()?2:0)}px`;return m!==g.e&&p.classList.toggle("pressed",g.e=m),b!==g.t&&((g.t=b)!=null?p.style.setProperty("height",b):p.style.removeProperty("height")),g},{e:void 0,t:void 0}),p}})]}})}})),l})()};Oe(["pointerdown","pointerup","pointermove"]);function U(t){return{type:"MaybeUndefined",element:t}}function om(){return{type:"Boolean"}}function ot(){return{type:"Number"}}function kt(){return{type:"String"}}function H(t){return{type:"Object",properties:t}}function ne(t){return{type:"Array",element:t}}function Bo(t,r,e){return{type:"Invarant",fromFn:t,toFn:r,inner:e}}function iu(t,r){return{type:"Default",value:t,inner:r}}function He(t,r){switch(t.type){case"Boolean":return typeof r!="boolean"?it("Expected a boolean."):Te(r);case"Number":return typeof r!="number"?it("Expected a number."):Te(r);case"String":return typeof r!="string"?it("Expected a string."):Te(r);case"MaybeUndefined":return r==null?Te(void 0):He(t.element,r);case"MaybeNull":return r==null?Te(null):He(t.element,r);case"Union":{let e=r[t.selector];if(typeof e!="string")return it("Missing type param for union.");let i={...r};delete i[t.selector];let n=H(t.parts[e]),o=He(n,i);if(o.type=="Err")return it(`Problem parsing union part ${e}: ${o.message}`);let l={...o.value};return l[t.selector]=e,Te(l)}case"Array":{let e=[];for(let i of r){let n=He(t.element,i);if(n.type=="Err")return n;e.push(n.value)}return Te(e)}case"Object":{let e={};for(let i of Object.keys(t.properties)){let n=t.properties[i];Object.hasOwn(r,i)||(e[i]=Qe(n));let o=He(t.properties[i],r[i]);if(o.type=="Err")return it(`Problem parsing field ${i}: ${o.message}`);e[i]=o.value}return Te(e)}case"Recursive":{let e=t.inner();return He(e,r)}case"Invarant":{let e=t.fromFn,i=He(t.inner,r);return i.type=="Err"?i:Te(e(i.value))}case"Default":{let e=t.inner,i;try{i=He(e,r)}catch(n){i=it(""+n)}return i.type=="Err"?Te(t.value):Te(i.value)}case"Json":return Te(r)}}function Qe(t){switch(t.type){case"Boolean":return!1;case"Number":return 0;case"String":return"";case"MaybeUndefined":return;case"MaybeNull":return null;case"Union":{let r=Object.keys(t.parts)[0],e=Qe(H(t.parts[r]));return e[t.selector]=r,e}case"Array":return[];case"Object":{let r={};for(let e of Object.keys(t.properties)){let i=t.properties[e];r[e]=Qe(i)}return r}case"Recursive":{let r=t.inner();return Qe(r)}case"Invarant":{let r=t.fromFn,e=Qe(t.inner);return r(e)}case"Default":return t.value;case"Json":return null}}function Ze(t,r){switch(t.type){case"Boolean":return r;case"Number":return r;case"String":return r;case"MaybeUndefined":return r==null?null:Ze(t.element,r);case"MaybeNull":return r==null?null:Ze(t.element,r);case"Union":{let e=r[t.selector],i={...r};delete i[t.selector];let n=Ze(H(t.parts[e]),i);return n[t.selector]=e,n}case"Object":{let e={};for(let i of Object.keys(t.properties))e[i]=Ze(t.properties[i],r[i]);return e}case"Array":return r.map(e=>Ze(t.element,e));case"Recursive":{let e=t.inner();return Ze(e,r)}case"Invarant":{let e=t.toFn,i=e(r);return Ze(t.inner,i)}case"Default":return Ze(t.inner,r);case"Json":return r}}function qo(t,r,e){if(typeof t!="object"||t.type!="Object")return it("Only projections of objects are supported");let i={};for(let[n,o]of Object.entries(t.properties)){let a=o;Object.defineProperty(i,n,{get(){let l=r?.[n];if(typeof o=="object"){if(o.type=="Object"){let s=qo(a,l,c=>e(d=>c(d[n])));if(s.type=="Err")throw new Error("Unreachable");return s.value}if(o.type=="Array"){let s=ou(a,l,c=>e(d=>{c(d[n])}));if(s.type=="Err")throw new Error("Unreachable");return s.value}}let u=He(a,l);return u.type=="Err"?Qe(a):u.value},set(l){let u=Ze(a,l);JSON.stringify(r[n])!=JSON.stringify(u)&&e(s=>s[n]=u)}})}return Te(i)}function ou(t,r,e){if(typeof t!="object"||t.type!="Array")return it("Expected an array for projection");let i=t.element,n=[],o=new Proxy(n,{get(a,l,u){if(l=="length")return n.length=r.length,r.length;if(typeof l=="string"&&!Number.isNaN(Number.parseInt(l))){let s=Number.parseInt(l),c=r?.[s];if(typeof i=="object"){if(i.type=="Object"){let f=qo(i,c,p=>e(h=>{p(h[s])}));if(f.type=="Err")throw new Error("Unreachable");return f.value}if(i.type=="Array"){let f=ou(i,c,p=>e(h=>{p(h[l])}));if(f.type=="Err")throw new Error("Unreachable");return f.value}}let d=He(i,c);return d.type=="Err"?Qe(i):d.value}return Reflect.get(n,l,n)},set(a,l,u,s){if(typeof l=="string"&&!Number.isNaN(Number.parseInt(l))){let c=Number.parseInt(l),d=Ze(i,u);if(JSON.stringify(r[c])==JSON.stringify(u))return!1;e(f=>f[c]=d)}return Reflect.set(n,l,u,n)}});return Te(o)}function Tn(t,r,e){if(typeof e!="object"||e.type!="Object")throw new Error("Expected object.");{let o=ja.get(t);if(o!=null)return o}let i=e.properties,n=new Proxy({},{defineProperty(o,a,l){return Reflect.defineProperty(o,a,l)},deleteProperty(o,a){return Reflect.deleteProperty(o,a)},getOwnPropertyDescriptor(o,a){if(i[a]!=null){let l=Reflect.getOwnPropertyDescriptor(i,a);return l==null?void 0:(l={...l},l.value=n[a],l)}return Reflect.getOwnPropertyDescriptor(o,a)},getPrototypeOf(o){return Reflect.getPrototypeOf(o)},has(o,a){return i[a]!=null?!0:Reflect.has(o,a)},isExtensible(o){return Reflect.isExtensible(o)},ownKeys(o){return[...Reflect.ownKeys(i),...Reflect.ownKeys(o)]},preventExtensions(o){return Reflect.preventExtensions(o)},setPrototypeOf(o,a){return Reflect.setPrototypeOf(o,a)},get(o,a,l){if(typeof a=="symbol")return o[a];if(typeof a=="string"){let u=i[a];if(u!=null){if(u.type=="Object")return Tn(t[a],c=>r(d=>c(d[a])),u);if(u.type=="Array")return bo(t[a],c=>r(d=>c(d[a])),u);let s=He(u,t[a]);return s.type=="Err"?Qe(u):s.value}}return Reflect.get(o,a,l)},set(o,a,l,u){if(typeof a=="symbol")return o[a]=l,!0;if(typeof a=="string"){let s=i[a];if(s!=null){let c=Ze(s,l);return r(d=>d[a]=c),!0}}return Reflect.set(o,a,l,u)}});return ja.set(t,n),n}function bo(t,r,e){if(typeof e!="object"||e.type!="Array")throw new Error("Expected object.");{let a=Ua.get(t);if(a!=null)return a}let i=e.element,n=function*(){for(let a=0;a<t.length;++a)yield o[a]},o=new Proxy([void 0],{defineProperty(a,l,u){return Reflect.defineProperty(a,l,u)},deleteProperty(a,l){return Reflect.deleteProperty(a,l)},getOwnPropertyDescriptor(a,l){let u=typeof l=="string"?Number.parseInt(l):void 0;if(Number.isNaN(u)&&(u=void 0),u!=null){let c=Reflect.getOwnPropertyDescriptor(a,0);return c==null?void 0:(c={...c},c.value=o[l],c)}let s=Reflect.getOwnPropertyDescriptor(a,l);if(s!=null)return l==="length"&&(s={...s},s.value=t.length),s},getPrototypeOf(a){return Reflect.getPrototypeOf(a)},has(a,l){let u=typeof l=="string"?Number.parseInt(l):void 0;return Number.isNaN(u)&&(u=void 0),u!=null?0<=u&&u<t.length:Reflect.has(a,l)},isExtensible(a){return Reflect.isExtensible(a)},ownKeys(a){return[...Array(t.length).fill(void 0).map((l,u)=>u.toString()),...Reflect.ownKeys(a).filter(l=>l!="0")]},preventExtensions(a){return Reflect.preventExtensions(a)},setPrototypeOf(a,l){return Reflect.setPrototypeOf(a,l)},get(a,l,u){if(l==Symbol.iterator)return n;if(typeof l=="symbol")return a[l];if(l==="length")return t.length;if(l==="findIndex")return function(s,c){console.log("Intercepted findIndex call!");const d=[];for(let f=0;f<t.length;f++)if(i.type=="Object")d.push(Tn(t[f],p=>r(h=>p(h[f])),i));else if(i.type=="Array")d.push(bo(t[f],p=>r(h=>p(h[f])),i));else{let p=He(i,t[f]);p.type=="Err"?d.push(Qe(i)):d.push(p.value)}return Array.prototype.findIndex.call(d,s,c)};if(typeof l=="string"){let s=typeof l=="string"?Number.parseInt(l):void 0;if(Number.isNaN(s)&&(s=void 0),s!=null&&0<=s&&s<t.length){if(i.type=="Object")return Tn(t[s],d=>r(f=>d(f[l])),i);if(i.type=="Array")return bo(t[s],d=>r(f=>d(f[l])),i);let c=He(i,t[s]);return c.type=="Err"?Qe(i):c.value}}return Reflect.get(a,l,u)},set(a,l,u,s){if(typeof l=="symbol")return a[l]=u,!0;if(l==="length"){let d=u-t.length;if(d>0){let f=Array(d).fill(void 0).map(p=>Qe(i));r(p=>p.push(...f))}else d<0&&r(f=>f.splice(t.length+d,-d));return!0}if(typeof l=="string"){let c=typeof l=="string"?Number.parseInt(l):void 0;if(Number.isNaN(c)&&(c=void 0),c!=null){let d=Ze(i,u);return r(f=>f[l]=d),!0}}return Reflect.set(a,l,u,s)}});return Ua.set(t,o),o}let ja=new WeakMap,Ua=new WeakMap;class re{typeName;typeSchema;constructor(r){this.typeName=r.typeName,this.typeSchema=r.typeSchema}create(r){let[e,i]=je(r);return new an({type:this,state:e,setState:i})}createJsonProjectionV3(r,e){let i=Tn(r,e,this.typeSchema),[n,o]=ye(()=>je(i));return Te(new an({type:this,state:i,setState:o}))}createJsonProjectionV2(r,e){let i=qo(this.typeSchema,r,e);if(i.type=="Err")return it(i.message);let n=i.value,[o,a]=ye(()=>je(n));return Te(new an({type:this,state:o,setState:a}))}createJsonProjection(r,e){let i=E(()=>He(this.typeSchema,r())),n=E(()=>{let l=i();return l.type=="Err"?l:Te(i)},void 0,{equals:(l,u)=>l.type=="Ok"&&u.type=="Ok"?l.value==u.value:!1}),o=E(()=>{let l=n();return l.type=="Err"?l:Te(E(()=>l.value().value))}),a=E(()=>{let l=o();if(l.type=="Err")return l;let u=l.value;return Te(E(()=>{let[s,c]=je(ye(u));ve(he(u,f=>c(f),{defer:!0}));let d=E(()=>{let f=Ze(this.typeSchema,s);return{json:f,jsonString:JSON.stringify(f)}},void 0,{equals:(f,p)=>f.jsonString==p.jsonString});return ve(he(()=>d().json,f=>{e(f)},{defer:!0})),new an({type:this,state:s,setState:c})}))});return E(()=>{let l=a();return l.type=="Err"?l:Te(l.value())})}}class an{type;state;setState;constructor(r){this.type=r.type,this.state=r.state,this.setState=r.setState}}const am=H({childIds:ne(kt())}),$r=new re({typeName:"Children",typeSchema:am}),sm=H({parentId:kt()}),Ir=new re({typeName:"Parent",typeSchema:sm}),lm=H({orderIndex:ot()}),cm=new re({typeName:"SortOrderIndex",typeSchema:lm});class Vo{componentTypes;componentTypeMap;constructor(r){this.componentTypes=r,this.componentTypeMap=new Map(r.map(e=>[e.typeName,e]))}}const au=new Vo([$r,Ir,cm]);class K{x;y;constructor(r,e){this.x=r,this.y=e}static create(r,e){return new K(r,e)}static zero=K.create(0,0);static unitX=K.create(1,0);static unitY=K.create(0,1);add(r){return K.create(this.x+r.x,this.y+r.y)}sub(r){return K.create(this.x-r.x,this.y-r.y)}multScalar(r){return K.create(this.x*r,this.y*r)}cross(r){return this.x*r.y-this.y*r.x}distanceSquared(r){let e=r.x-this.x,i=r.y-this.y;return e*e+i*i}distance(r){return Math.sqrt(this.distanceSquared(r))}lengthSquared(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.lengthSquared())}normalize(){return this.multScalar(1/this.length())}}class _e{x;y;static rot0=new _e(1,0);constructor(r,e){this.x=r,this.y=e}static xy(r){return new _e(r.x,r.y)}static fromAngle(r){let e=r*Math.PI/180;return new _e(Math.cos(e),Math.sin(e))}get u(){return K.create(this.x,this.y)}get v(){return K.create(-this.y,this.x)}getLengthSquared(){return this.x*this.x+this.y*this.y}getLength(){return Math.sqrt(this.getLengthSquared())}normalize(){let r=this.getLength();return new _e(this.x/r,this.y/r)}times(r){let e=this;return new _e(e.x*r.x-e.y*r.y,e.x*r.y+e.y*r.x)}conjugate(){return new _e(this.x,-this.y)}rotate(r){let e=this.x,i=this.y,n=-i,o=e;return K.create(r.x*e+r.y*n,r.x*i+r.y*o)}getAngle(){return(r=>r*180/Math.PI)(Math.atan2(this.y,this.x))}}class X{_x;_y;_z;static zero;static zero_$LI$(){return X.zero==null&&(X.zero=X.create(0,0,0)),X.zero}static unitX;static unitX_$LI$(){return X.unitX==null&&(X.unitX=X.create(1,0,0)),X.unitX}static unitY;static unitY_$LI$(){return X.unitY==null&&(X.unitY=X.create(0,1,0)),X.unitY}static unitZ;static unitZ_$LI$(){return X.unitZ==null&&(X.unitZ=X.create(0,0,1)),X.unitZ}static negUnitX;static negUnitX_$LI$(){return X.negUnitX==null&&(X.negUnitX=X.create(-1,0,0)),X.negUnitX}static negUnitY;static negUnitY_$LI$(){return X.negUnitY==null&&(X.negUnitY=X.create(0,-1,0)),X.negUnitY}static negUnitZ;static negUnitZ_$LI$(){return X.negUnitZ==null&&(X.negUnitZ=X.create(0,0,-1)),X.negUnitZ}constructor(r,e,i){this._x=r,this._y=e,this._z=i}static create(r,e,i){return new X(r,e,i)}get x(){return this._x}get y(){return this._y}get z(){return this._z}xy(){return K.create(this._x,this._y)}xz(){return K.create(this._x,this._z)}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}add(r){return X.create(this.x+r.x,this.y+r.y,this.z+r.z)}sub(r){return X.create(this.x-r.x,this.y-r.y,this.z-r.z)}scale(r){return X.create(this.x*r,this.y*r,this.z*r)}negate(){return X.create(-this.x,-this.y,-this.z)}cross(r){return X.create(this.y*r.z-this.z*r.y,this.z*r.x-this.x*r.z,this.x*r.y-this.y*r.x)}normalize(){let r=this.length();return X.create(this.x/r,this.y/r,this.z/r)}lengthSquared(){return this.dot(this)}length(){return Math.sqrt(this.lengthSquared())}distanceSquared(r){let e=this.x-r.x,i=this.y-r.y,n=this.z-r.z;return e*e+i*i+n*n}distance(r){return Math.sqrt(this.distanceSquared(r))}lerp(r,e){return X.create(this.x+(r.x-this.x)*e,this.y+(r.y-this.y)*e,this.z+(r.z-this.z)*e)}toJSON(){return{x:this.x,y:this.y,z:this.z}}static fromJSON(r){return X.create(r.x,r.y,r.z)}toString(){return"("+(""+this.x)+", "+(""+this.y)+", "+(""+this.z)+")"}}X.negUnitZ_$LI$();X.negUnitY_$LI$();X.negUnitX_$LI$();X.unitZ_$LI$();X.unitY_$LI$();X.unitX_$LI$();X.zero_$LI$();class Wt{_n;_d;constructor(r,e){this._n=r,this._d=e}static create(r,e){return new Wt(r,e)}static fromKnownPtAndNormal(r,e){return Wt.create(e,-e.dot(r))}get n(){return this._n}get d(){return this._d}moveInNormalDirection(r){return new Wt(this.n,this.d-r*this.n.length())}closestPoint(r){let e=-(this.d+r.dot(this.n))/this.n.dot(this.n);return r.add(this.n.scale(e))}threePlaneIntersection(r,e){let i=this,n=i.closestPoint(X.zero_$LI$()),o=r.closestPoint(X.zero_$LI$()),a=e.closestPoint(X.zero_$LI$()),l=i.n,u=r.n,s=e.n,c=u.cross(s).scale(n.dot(l)).add(s.cross(l).scale(o.dot(u))).add(l.cross(u).scale(a.dot(s))),d=l.x,f=l.y,p=l.z,h=u.x,g=u.y,m=u.z,b=s.x,y=s.y,w=s.z,v=d*(g*w-y*m)+h*(y*p-f*w)+b*(f*m-g*p);if(!(Math.abs(v)<.001))return c.scale(1/v)}fromSpace(r){let e=this.closestPoint(X.zero_$LI$()),i=r.vectorFromThisSpace(this.n),n=r.pointFromThisSpace(e);return Wt.fromKnownPtAndNormal(n,i)}toSpace(r){let e=this.closestPoint(X.zero_$LI$()),i=r.vectorToThisSpace(this.n),n=r.pointToThisSpace(e);return Wt.fromKnownPtAndNormal(n,i)}static xyPlane=Wt.create(X.unitZ,0)}class we{_w;_x;_y;_z;static identity;static identity_$LI$(){return we.identity==null&&(we.identity=we.Builder.fromWXYZ().setWXYZ(1,0,0,0).build()),we.identity}constructor(r,e,i,n){this._w=r,this._x=e,this._y=i,this._z=n}static fromAxisAngle(r,e){return we.Builder.fromAxisAngle().setAxis(r).setAngle(e).build()}static fromUV(r,e){return we.Builder.fromUVW().setU(r).setV(e).setW(r.cross(e)).build()}static fromVW(r,e){return we.Builder.fromUVW().setU(r.cross(e)).setV(r).setW(e).build()}static fromWU(r,e){return we.Builder.fromUVW().setU(e).setV(r.cross(e)).setW(r).build()}get w(){return this._w}get x(){return this._x}get y(){return this._y}get z(){return this._z}getLengthSquared(){return this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z}getLength(){return Math.sqrt(this.getLengthSquared())}normalize(){let r=this.getLength();return new we(this.w/r,this.x/r,this.y/r,this.z/r)}times(r){let e=this;return new we(e.w*r.w-e.x*r.x-e.y*r.y-e.z*r.z,e.w*r.x+e.x*r.w+e.y*r.z-e.z*r.y,e.w*r.y-e.x*r.z+e.y*r.w+e.z*r.x,e.w*r.z+e.x*r.y-e.y*r.x+e.z*r.w)}dotProduct(r){let e=this;return e.w*r.w+e.x*r.x+e.y*r.y+e.z*r.z}conjugate(){return new we(this.w,-this.x,-this.y,-this.z)}rotate$Quaternion(r){return this.times(r).times(this.conjugate())}rotate(r){if(r!=null&&r instanceof we||r===null)return this.rotate$Quaternion(r);if(r!=null&&r instanceof X||r===null)return this.rotate$Vec3(r);throw new Error("invalid overload")}rotate$Vec3(r){let e=this.times(we.Builder.fromWXYZ().setWXYZ(0,r.x,r.y,r.z).build()).times(this.conjugate());return X.create(e.x,e.y,e.z)}slerp(r,e,i){let n=this,o=r,a=n.dotProduct(o),l,u;if(1-Math.abs(a)<.01)l=1-e,u=e;else{let s=Math.acos(Math.abs(a)),c=Math.sin(s);l=Math.sin(s*(1-e))/c,u=Math.sin(s*e)/c}return i&&a<0&&(l=-l),new we(l*n.w+u*o.w,l*n.x+u*o.x,l*n.y+u*o.y,l*n.z+u*o.z)}toJSON(){return{w:this.w,x:this.x,y:this.y,z:this.z}}static fromJSON(r){return new we(r.w,r.x,r.y,r.z)}toString(){return"Quaternion "+this.w+" "+this.x+" "+this.y+" "+this.z}}we.__class="Quaternion";(t=>{class r{w;x;y;z;setW(a){return this.w=a,this}setWXYZ(a,l,u,s){return this.w=a,this.x=l,this.y=u,this.z=s,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}build(){return new t(this.w,this.x,this.y,this.z)}constructor(){this.w=0,this.x=0,this.y=0,this.z=0}}t.FromWXYZBuilder=r,r.__class="Quaternion.FromWXYZBuilder",r.__interfaces=["Quaternion.BuildStep","Quaternion.FromWXYZSetWStep","Quaternion.FromWXYZSetXStep","Quaternion.FromWXYZSetZStep","Quaternion.FromWXYZSetYStep"];class e{axisX;axisY;axisZ;angle;setAxisX(a){return this.axisX=a,this}setAxisXYZ(a,l,u){return this.axisX=a,this.axisY=l,this.axisZ=u,this}setAxis(a){return this.axisX=a.x,this.axisY=a.y,this.axisZ=a.z,this}setAxisY(a){return this.axisY=a,this}setAxisZ(a){return this.axisZ=a,this}setAngle(a){return this.angle=a,this}build(){let a=Math.sqrt(this.axisX*this.axisX+this.axisY*this.axisY+this.axisZ*this.axisZ);this.axisX/=a,this.axisY/=a,this.axisZ/=a;let l=Math.cos((s=>s*Math.PI/180)(.5*this.angle)),u=Math.sin((s=>s*Math.PI/180)(.5*this.angle));return new t(l,u*this.axisX,u*this.axisY,u*this.axisZ)}constructor(){this.axisX=0,this.axisY=0,this.axisZ=0,this.angle=0}}t.FromAxisAngleBuilder=e,e.__class="Quaternion.FromAxisAngleBuilder",e.__interfaces=["Quaternion.FromAxisAngleSetAxisYStep","Quaternion.FromAxisAngleSetAngleStep","Quaternion.FromAxisAngleSetAxisXStep","Quaternion.BuildStep","Quaternion.FromAxisAngleSetAxisZStep"];class i{u;v;w;setU(a){return this.u=a,this}setV(a){return this.v=a,this}setW(a){return this.w=a,this}build(){if(this.u==null||this.v==null||this.w==null)throw"Fields not all set";let a=this.u.x,l=this.u.y,u=this.u.z,s=this.v.x,c=this.v.y,d=this.v.z,f=this.w.x,p=this.w.y,h=this.w.z,g=a+c+h,m,b,y,w;if(g>0){let v=Math.sqrt(g+1)*2;m=.25*v,b=(d-p)/v,y=(f-u)/v,w=(l-s)/v}else if(((v,k)=>v&&k)(a>c,a>h)){let v=Math.sqrt(1+a-c-h)*2;m=(d-p)/v,b=.25*v,y=(s+l)/v,w=(f+u)/v}else if(c>h){let v=Math.sqrt(1+c-a-h)*2;m=(f-u)/v,b=(s+l)/v,y=.25*v,w=(p+d)/v}else{let v=Math.sqrt(1+h-a-c)*2;m=(l-s)/v,b=(f+u)/v,y=(p+d)/v,w=.25*v}return new t(m,b,y,w)}constructor(){this.u=null,this.v=null,this.w=null}}t.FromUVWBuilder=i,i.__class="Quaternion.FromUVWBuilder",i.__interfaces=["Quaternion.FromUVWSetUStep","Quaternion.BuildStep","Quaternion.FromUVWSetWStep","Quaternion.FromUVWSetVStep"];class n{static fromWXYZ(){return new t.FromWXYZBuilder}static fromAxisAngle(){return new t.FromAxisAngleBuilder}static fromUVW(){return new t.FromUVWBuilder}constructor(){}}t.Builder=n,n.__class="Quaternion.Builder"})(we||(we={}));we.identity_$LI$();class Se{origin;orientation;static identity=new Se(K.zero,_e.rot0);constructor(r,e){this.origin=r,this.orientation=e}static create(r,e){return new Se(r,e)}get u(){return this.orientation.u}get v(){return this.orientation.v}pointFromSpace(r){return this.orientation.rotate(r).add(this.origin)}pointToSpace(r){return this.orientation.conjugate().rotate(r.sub(this.origin))}vectorFromSpace(r){return this.orientation.rotate(r)}vectorToSpace(r){return this.orientation.conjugate().rotate(r)}transformFromSpace(r){return Se.create(this.pointFromSpace(r.origin),r.orientation.times(this.orientation))}transformToSpace(r){return Se.create(this.pointToSpace(r.origin),this.orientation.conjugate().times(r.orientation))}}class qe{_origin;_orientation;static identity;static identity_$LI$(){return qe.identity==null&&(qe.identity=qe.Builder.fromOriginOrientation().setOrigin(X.zero_$LI$()).setOrientation(we.identity_$LI$()).build()),qe.identity}constructor(r,e){this._origin=r,this._orientation=e}static create(r,e){return new qe(r,e)}get origin(){return this._origin}get orientation(){return this._orientation}get o(){return this.origin}get u(){return this.orientation.rotate$Vec3(X.unitX_$LI$())}get v(){return this.orientation.rotate$Vec3(X.unitY_$LI$())}get w(){return this.orientation.rotate$Vec3(X.unitZ_$LI$())}pointToThisSpace(r){return this.orientation.conjugate().rotate$Vec3(r.sub(this.origin))}vectorToThisSpace(r){return this.orientation.conjugate().rotate$Vec3(r)}toThisSpace(r){return qe.Builder.fromOriginOrientation().setOrigin(this.pointToThisSpace(r.origin)).setOrientation(this.orientation.conjugate().times(r.orientation)).build()}pointFromThisSpace(r){return this.orientation.rotate$Vec3(r).add(this.origin)}vectorFromThisSpace(r){return this.orientation.rotate$Vec3(r)}fromThisSpace(r){return qe.Builder.fromOriginOrientation().setOrigin(this.pointFromThisSpace(r.origin)).setOrientation(this.orientation.times(r.orientation)).build()}invert(){return qe.Builder.fromOriginOrientation().setOrigin(this.orientation.conjugate().rotate$Vec3(this.origin.scale(-1))).setOrientation(this.orientation.conjugate()).build()}times(r){return this.fromThisSpace(r)}toJSON(){return{origin:this.origin,orientation:this.orientation}}static fromJSON(r){return qe.create(X.fromJSON(r.origin),we.fromJSON(r.orientation))}toString(){return"(origin:"+this.origin.toString()+", orientation: "+this.orientation.toString()+")"}}qe.__class="Transform3D";(t=>{class r{originX;originY;originZ;orientation;setOrigin(n){return this.originX=n.x,this.originY=n.y,this.originZ=n.z,this}setOriginX(n){return this.originX=n,this}setOriginXYZ(n,o,a){return this.originX=n,this.originY=o,this.originZ=a,this}setOriginY(n){return this.originY=n,this}setOriginZ(n){return this.originZ=n,this}setOrientation(n){return this.orientation=n,this}build(){if(this.orientation==null)throw"Fields not all set";return new t(X.create(this.originX,this.originY,this.originZ),this.orientation)}constructor(){this.originX=0,this.originY=0,this.originZ=0,this.orientation=null}}t.FromOriginOrientationBuilder=r,r.__class="Transform3D.FromOriginOrientationBuilder",r.__interfaces=["Transform3D.FromOriginOrientationSetOriginYStep","Transform3D.FromOriginOrientationSetOrientationStep","Transform3D.FromOriginOrientationSetOriginXStep","Transform3D.BuildStep","Transform3D.FromOriginOrientationSetOriginZStep"];class e{static fromOriginOrientation(){return new t.FromOriginOrientationBuilder}constructor(){}}t.Builder=e,e.__class="Transform3D.Builder"})(qe||(qe={}));qe.identity_$LI$();function um(t){let r=new Jt,e=E(()=>{let i=[];for(let[n,o]of r.entries())i.push({id:n,pos:o});return i.sort((n,o)=>n.id-o.id),i});{let i=E(()=>e().length==1);ve(()=>{if((t.disableOneFingerPan?.()??!1)||!i())return;let n=E(()=>e()[0].pos),o=ye(()=>t.pan()),a=ye(()=>t.scale()),l=ye(()=>n()),u=1/a;Number.isFinite(u)&&ve(he(n,s=>{t.setPan(o.sub(s.sub(l).multScalar(u)))},{defer:!0}))})}{let i=E(()=>e().length==2);ve(()=>{if(!i())return;let n=E(()=>e()[0].pos),o=E(()=>e()[1].pos),a=E(()=>n().add(o()).multScalar(.5)),l=E(()=>n().distance(o())),u=ye(()=>t.pan()),s=ye(()=>t.scale()),c=ye(()=>a()),d=ye(()=>l()),f=ye(()=>c.multScalar(1/s).add(u));!Number.isFinite(f.x)||!Number.isFinite(f.y)||ve(he([a,l],([p,h])=>{let g=s*h/d,m=f.sub(p.multScalar(1/g));Be(()=>{Number.isFinite(g)&&Number.isFinite(m.x)&&Number.isFinite(m.y)&&(t.setPan(m),t.setScale(g))})},{defer:!0}))})}return{onPointerDown(i){let n,o;if(i.currentTarget instanceof Element){let a=i.currentTarget.getBoundingClientRect();n=a.left,o=a.top}else n=0,o=0;r.set(i.pointerId,K.create(i.clientX-n,i.clientY-o))},onPointerUp(i){r.delete(i.pointerId),t.releasePointerCapture(i.pointerId)},onPointerCancel(i){r.delete(i.pointerId),t.releasePointerCapture(i.pointerId)},onPointerMove(i){if(!r.has(i.pointerId))return;let n,o;if(i.currentTarget instanceof Element){let a=i.currentTarget.getBoundingClientRect();n=a.left,o=a.top}else n=0,o=0;r.set(i.pointerId,K.create(i.clientX-n,i.clientY-o))},onWheel(i){let n,o;if(i.currentTarget instanceof Element){let c=i.currentTarget.getBoundingClientRect();n=c.left,o=c.top}else n=0,o=0;let a=K.create(i.clientX-n,i.clientY-o),l=t.scale(),u=t.scale();if(i.deltaY<0)u*=1.1;else if(i.deltaY>0)u/=1.1;else return;let s=t.pan().add(a.multScalar(1/l-1/u));Be(()=>{t.setPan(s),t.setScale(u)})},numTouches:E(()=>e().length)}}class dm{canUndo;canRedo;undoDisplayName;redoDisplayName;undo;redo;pushUndoUnit;clear;constructor(){let r=[],e=-1,[i,n]=oe(!1),[o,a]=oe(!1),[l,u]=oe(),[s,c]=oe(),d=()=>{Be(()=>{if(n(()=>e!=-1),a(()=>e<r.length-1),e!=-1){let g=r[e];u(g.displayName)}else u(void 0);if(e<r.length-1){let g=r[e+1];c(g.displayName)}else c(void 0)})},f=()=>{if(e==-1)return;r[e].run(!0),--e,d()},p=()=>{if(e>=r.length-1)return;++e,r[e].run(!1),d()},h=g=>{e<r.length-1&&r.splice(e+1,r.length-1-e),++e,r.push(g),d()};this.clear=()=>{r.splice(0,r.length),e=-1,d()},this.canUndo=i,this.canRedo=o,this.undoDisplayName=l,this.redoDisplayName=s,this.undo=f,this.redo=p,this.pushUndoUnit=h}}function su(t){return t==null?[]:[t]}function pm(t,r){let e,i=()=>{},n=0;return()=>{if(Mo()==null)return e!=null?e():t();if(e==null){let{cache:o,dispose:a}=Mt(l=>({cache:E(t),dispose:l}));e=o,i=a,n=1}else++n;return Ne(()=>{--n==0&&(i(),i=()=>{},r?.(),e=void 0)}),e()}}class Yr{value;constructor(r){this.value=r}}function lu(t){for(var r="",e=t.byteLength,i=0;i<e;i++)r+=String.fromCharCode(t[i]);return window.btoa(r)}function cu(t){for(var r=atob(t),e=new Uint8Array(r.length),i=0;i<r.length;i++)e[i]=r.charCodeAt(i);return e}class Lt{entityMap;componentTypeEntitiesMap;componentTypeEntitiesMap_=new Map;constructor(){this.entityMap=new Jt,this.componentTypeEntitiesMap=new Jt}entities(){return Array.from(this.entityMap.keys())}entitiesWithComponentType(r){{let i=this.componentTypeEntitiesMap_.get(r.typeName);if(i!=null)return i()}let e=pm(()=>{let i=this.componentTypeEntitiesMap.get(r.typeName);if(i==null)return[];let n=[];for(let o of i)n.push(o);return n},()=>{this.componentTypeEntitiesMap_.delete(r.typeName)});return this.componentTypeEntitiesMap_.set(r.typeName,e),e()}createEntityWithId(r,e){ye(()=>Be(()=>{this.entityMap.set(r,new Jt(e.map(i=>[i.type.typeName,i])));for(let i of e){let n=this.componentTypeEntitiesMap.get(i.type.typeName);n==null&&(n=new gt,this.componentTypeEntitiesMap.set(i.type.typeName,n)),n.add(r)}}))}createEntity(r){let e=Ht();return this.createEntityWithId(e,r),e}destroyEntity(r){ye(()=>Be(()=>{let e=this.entityMap.get(r);if(e!=null)for(let i of e.values()){let n=this.componentTypeEntitiesMap.get(i.type.typeName);n?.delete(r)}this.entityMap.delete(r)}))}attachToParent(r,e){ye(()=>{this.getComponent(r,Ir)?.state?.parentId!=null&&this.detactFromParent(r);let i=this.getComponent(e,$r);i==null?(i=$r.create({childIds:[r]}),this.setComponent(e,i)):i.setState("childIds",Tr(n=>n.push(r))),this.setComponent(r,Ir.create({parentId:e}))})}detactFromParent(r){ye(()=>{let e=this.getComponent(r,Ir);if(e!=null){this.unsetComponent(r,Ir);let i=e.state.parentId,n=this.getComponent(i,$r);if(n!=null){let o=n.state.childIds.filter(a=>a!==r);o.length==0?this.unsetComponent(i,$r):n.setState("childIds",o)}}})}getComponent(r,e){let i=this.entityMap.get(r);if(i!=null)return i.get(e.typeName)}getComponents(r){return Array.from(this.entityMap.get(r)?.values()??[])}setComponent(r,e){this.setComponents(r,[e])}setComponents(r,e){let i=this.entityMap.get(r);if(i!=null)for(let n of e)i.set(n.type.typeName,n)}unsetComponent(r,e){let i=this.entityMap.get(r);i?.delete(e.typeName)}unsetComponents(r,e){let i=this.entityMap.get(r);if(i!=null)for(let n of e)i.delete(n.typeName)}toJson(){let r={};for(let e of this.entities()){let i={};for(let n of this.getComponents(e))i[n.type.typeName]=Ze(n.type.typeSchema,n.state);r[e]=i}return r}static fromJson(r,e){let i=new Lt;for(let n of Object.keys(e)){let o=e[n],a=Object.keys(o),l=[];for(let u of a){let s=r.componentTypeMap.get(u);if(s==null)return it(`${u} not found`);let c=He(s.typeSchema,o[u]);if(c.type=="Err")return c;let d=c.value,f=s.create(d);l.push(f)}i.createEntityWithId(n,l)}return Te(i)}}const fm=Bo(t=>K.create(t.x,t.y),t=>({x:t.x,y:t.y}),H({x:ot(),y:ot()})),hm=Bo(t=>new _e(t.x,t.y),t=>({x:t.x,y:t.y}),H({x:ot(),y:ot()})),mm=Bo(({origin:t,orientation:r})=>Se.create(t,r),t=>({origin:t.origin,orientation:t.orientation}),H({origin:fm,orientation:hm})),gm=H({transform:mm}),Ae=new re({typeName:"Transform2D",typeSchema:gm});class uu{nodeTypes=[];noteTypeNameToNodeTypeMap=new Map;registerNodeType(r){this.nodeTypes.push(r),this.noteTypeNameToNodeTypeMap.set(r.componentType.typeName,r)}registerNodeTypes(r){for(let e of r)this.registerNodeType(e)}lookupNodeType(r){return this.noteTypeNameToNodeTypeMap.get(r)}}const M=H({target:kt(),pin:kt()});var ym=Y("<svg><path fill=none stroke=blue stroke-width=2 vector-effect=non-scaling-stroke></svg>",!1,!0),bm=Y("<svg><g><rect x=0 stroke=black rx=5 ry=5></rect><text style=user-select:none;></svg>",!1,!0),vm=Y("<svg><foreignObject x=5></svg>",!1,!0),Ba=Y("<svg><circle r=1></svg>",!1,!0),qa=Y("<svg><text></svg>",!1,!0);class vo{Render;constructor(r){this.Render=()=>[D(pt,{get each(){return r.nodes()},children:e=>D(km,{node:e,get isHighlighted(){return r.highlightedEntitySet.has(e.node.nodeParams.entity)},get isSelected(){return r.selectedEntitySet.has(e.node.nodeParams.entity)}})}),D(pt,{get each(){return r.nodes()},children:e=>D(pt,{get each(){return e.node.inputPins?.()??[]},children:i=>D(ge,{get when(){return i.source()},children:n=>{let o=E(()=>r.lookupNodeById(n().target)),a=E(()=>{let u=o();if(u==null)return;let s=u.outputPinPositionMap()?.get(n().pin);if(s!=null)return u.space().pointFromSpace(s)}),l=E(()=>{let u=e.inputPinPositionMap()?.get(i.name);if(u!=null)return e.space().pointFromSpace(u)});return D(ge,{get when(){return a()},children:u=>D(ge,{get when(){return l()},children:s=>{let c=E(()=>du(u().x,-u().y,s().x,-s().y,0));return(()=>{var d=ym();return le(()=>ae(d,"d",c())),d})()}})})}})})})]}}let Yn=(()=>{let t=new Map;return r=>{let e=t.get(r);if(e!=null)return e;let{svg:i,dispose:n}=Mt(u=>({svg:_m(),dispose:u})),o=document.createElementNS("http://www.w3.org/2000/svg","text"),a=document.createTextNode(r);o.appendChild(a),i.appendChild(o);let l=o.getBBox();return n(),e=K.create(l.width,l.height),t.set(r,e),e}})(),wm=(()=>{let t=new Map;return(r,e)=>{let i=t.get(r);return i!=null||(i=e(),t.set(r,i)),i}})();function km(t){let r=E(()=>Yn(t.node.node.type.componentType.typeName)),e=E(zt(()=>t.node.node.inputPins?.()??[],w=>{let v=Yn(w.name);return{name:w.name,size:v}})),i=E(zt(()=>t.node.node.outputPins?.()??[],w=>{let v=Yn(w.name);return{name:w.name,size:v}})),n=E(()=>{let w=t.node.node.ui?.();if(w!=null)return wm(t.node.node.type.componentType.typeName,()=>{let v=xm(),k=document.createElement("div");k.style.setProperty("display","inline-block"),v.append(k);let _=ec(()=>D(w,{}),k),C=k.getBoundingClientRect();return _(),K.create(C.width,C.height)})});const o=5,a=5,l=E(()=>{let w=0;for(let v of e())w+=v.size.y;return w}),u=E(()=>{let w=0;for(let v of i())w+=v.size.y;return w});let s=E(()=>{let w=0;for(let v of e())w=Math.max(w,v.size.x);return w}),c=E(()=>{let w=0;for(let v of i())w=Math.max(w,v.size.x);return w}),d=E(()=>r().y+Math.max(l(),u())+(n()?.y??0)+2*o),f=E(()=>Math.max(r().x,s()+c()+4*a,n()?.x??0)+2*o),p=E(()=>K.create(f(),d())),h=E(()=>{let w={},v=d()-r().y;for(let k of e())v-=k.size.y,w[k.name]={dotPos:K.create(a,v+.28*k.size.y),textPos:K.create(2*a,v)};return w}),g=E(()=>{let w={},v=d()-r().y;for(let k of i())v-=k.size.y,w[k.name]={dotPos:K.create(f()-a,v+.28*k.size.y),textPos:K.create(f()-2*a-k.size.x,v)};return w}),m=E(()=>{let w=new Map;for(let[v,{dotPos:k}]of Object.entries(h()))w.set(v,k);return w}),b=E(()=>{let w=new Map;for(let[v,{dotPos:k}]of Object.entries(g()))w.set(v,k);return w});Sn(()=>{t.node.setRenderSizeAccessor(p),t.node.setInputPinPositionMapAccessor(m),t.node.setOutputPinPositionMapAccessor(b)});let y=E(()=>{let w=t.node.space(),v=w.origin,k=w.u,_=v.x,C=-v.y,S=k.x,P=-k.y,T=-P;return`matrix(${S} ${T} ${P} ${S} ${_} ${C})`});return(()=>{var w=bm(),v=w.firstChild,k=v.nextSibling;return te(w,D(ge,{get when(){return n()},children:_=>D(ge,{get when(){return t.node.node.ui?.()},keyed:!0,children:C=>(()=>{var S=vm();return te(S,D(C,{})),le(P=>{var T=-_().y-o,x=_().x,$=_().y;return T!==P.e&&ae(S,"y",P.e=T),x!==P.t&&ae(S,"width",P.t=x),$!==P.a&&ae(S,"height",P.a=$),P},{e:void 0,t:void 0,a:void 0}),S})()})}),k),te(k,()=>t.node.node.type.componentType.typeName),te(w,D(pt,{get each(){return t.node.node.inputPins?.()??[]},children:_=>{let C=E(()=>h()[_.name]),S=_.isEffectPin??!1;return D(ge,{get when(){return C()},children:P=>[(()=>{var T=Ba();return ae(T,"fill",S?"purple":"black"),le(x=>{var $=P().dotPos.x,O=-P().dotPos.y;return $!==x.e&&ae(T,"cx",x.e=$),O!==x.t&&ae(T,"cy",x.t=O),x},{e:void 0,t:void 0}),T})(),(()=>{var T=qa();return ae(T,"font-weight",S?"bold":"normal"),ae(T,"fill",S?"purple":"black"),te(T,()=>_.name),le(x=>{var $=P().textPos.x,O=-P().textPos.y;return $!==x.e&&ae(T,"x",x.e=$),O!==x.t&&ae(T,"y",x.t=O),x},{e:void 0,t:void 0}),T})()]})}}),null),te(w,D(pt,{get each(){return t.node.node.outputPins?.()??[]},children:_=>{let C=E(()=>g()[_.name]),S=_.isEffectPin??!1;return D(ge,{get when(){return C()},children:P=>[(()=>{var T=Ba();return ae(T,"fill",S?"purple":"black"),le(x=>{var $=P().dotPos.x,O=-P().dotPos.y;return $!==x.e&&ae(T,"cx",x.e=$),O!==x.t&&ae(T,"cy",x.t=O),x},{e:void 0,t:void 0}),T})(),(()=>{var T=qa();return ae(T,"font-weight",S?"bold":"normal"),ae(T,"fill",S?"purple":"black"),te(T,()=>_.name),le(x=>{var $=P().textPos.x,O=-P().textPos.y;return $!==x.e&&ae(T,"x",x.e=$),O!==x.t&&ae(T,"y",x.t=O),x},{e:void 0,t:void 0}),T})()]})}}),null),le(_=>{var C=y(),S=-d(),P=f(),T=d(),x=t.isSelected?"green":t.isHighlighted?"blue":"white",$=.5*(f()-r().x),O=-d()+r().y;return C!==_.e&&ae(w,"transform",_.e=C),S!==_.t&&ae(v,"y",_.t=S),P!==_.a&&ae(v,"width",_.a=P),T!==_.o&&ae(v,"height",_.o=T),x!==_.i&&ae(v,"fill",_.i=x),$!==_.n&&ae(k,"x",_.n=$),O!==_.s&&ae(k,"y",_.s=O),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w})()}const xm=(()=>{let t=0,r;return()=>(r!=null?++t:(r=document.createElement("div"),r.style.setProperty("position","absolute"),r.style.setProperty("left","-1000px"),r.style.setProperty("top","-1000px"),r.style.setProperty("width","500px"),r.style.setProperty("height","500px"),document.body.append(r),t=1),Ne(()=>{--t,t==0&&window.queueMicrotask(()=>{t==0&&r!=null&&(document.body.removeChild(r),r=void 0)})}),r)})(),_m=(()=>{let t=0,r;return()=>(r!=null?++t:(r=document.createElementNS("http://www.w3.org/2000/svg","svg"),r.style.setProperty("position","absolute"),r.style.setProperty("left","-1000px"),r.style.setProperty("top","-1000px"),document.body.append(r),t=1),Ne(()=>{--t,t==0&&window.queueMicrotask(()=>{t==0&&r!=null&&(document.body.removeChild(r),r=void 0)})}),r)})();function du(t,r,e,i,n=.5){const o=(t+e)/2,a=(r+i)/2;let l,u,s,c;return l=t+(o-t)*(1-n),u=r+(a-r)*n,s=e-(e-o)*(1-n),c=i-(i-a)*n,`M ${t} ${r} C ${l} ${u}, ${s} ${c}, ${e} ${i}`}var Sm=Y("<svg><path fill=none stroke-width=2 pointer-events=none vector-effect=non-scaling-stroke></svg>",!1,!0);class Cm{overlaySvg;dragEnd;disablePan=()=>!0;constructor(r){let e=r.modeParams,i=E(()=>e.nodesSystem.lookupNodeById(r.fromNodeId)),n=E(()=>{let l=i();if(l==null)return;let u=l.outputPinPositionMap()?.get(r.fromPin.name);if(u!=null)return l.space().pointFromSpace(u)}),o=E(()=>{let l=e.mousePos();if(l!=null)return e.screenPtToWorldPt(l)}),a=E(()=>{let l=e.pickingSystem.nodeUnderMouseById();if(l==null)return;let u=e.nodesSystem.lookupNodeById(l);if(u==null)return;let s=e.pickingSystem.pinUnderMouse();if(s?.type=="Input")return{nodeId:l,node:u,pin:s}});this.overlaySvg=()=>D(ge,{get when(){return n()},children:l=>D(ge,{get when(){return o()},children:u=>{let s=E(()=>du(l().x,-l().y,u().x,-u().y,0)),c=E(()=>a()!=null);return(()=>{var d=Sm();return le(f=>{var p=s(),h=c()?"blue":"red";return p!==f.e&&ae(d,"d",f.e=p),h!==f.t&&ae(d,"stroke",f.t=h),f},{e:void 0,t:void 0}),d})()}})}),this.dragEnd=()=>{let l=a();if(l!=null){let u=i();if(u!=null){let s=u.node.outputPins?.()??[],c;for(let d of s)if(d.name==r.fromPin.name){c=d;break}if(c!=null){let d=l.node.node.inputPins?.()??[];for(let f of d)if(f.name==l.pin.name){{let p={target:l.nodeId,pin:l.pin.name},h=!1;for(let g of c.sinks())if(g.target==p.target&&g.pin==p.pin){h=!0;break}h||c.setSinks([...c.sinks(),p])}{let p={target:r.fromNodeId,pin:r.fromPin.name};f.setSource(p)}}}}}e.onDone()}}}var Pm=Y("<svg><circle fill=blue pointer-events=none></svg>",!1,!0);class Va{overlaySvg;click;dragStart;dragEnd;highlightedObjectsById;selectedObjectsById;disablePan;constructor(r){let[e,i]=je({dragging:void 0}),n=new gt,o=E(()=>Array.from(n)),a=()=>r.pickingSystem.nodeUnderMouseById(),l=()=>r.pickingSystem.pinUnderMouse();Re(()=>{if(e.dragging==null)return;let s=e.dragging.value,c=r.mousePos();if(c==null)return;let d=r.screenPtToWorldPt(c);if(d==null)return;let f=r.nodesSystem.lookupNodeById(s.nodeId);f?.setSpace(Se.create(d.sub(s.pickupOffset),_e.rot0))}),this.overlaySvg=()=>D(ge,{get when(){return l()},children:s=>D(ge,{get when(){return r.nodesSystem.lookupNodeById(s().nodeId)},keyed:!0,children:c=>{let d=E(()=>{let f=s(),p;if(f.type=="Input"){let h=c.inputPinPositionMap()?.get(f.name);if(h==null)return;p=h}else if(f.type=="Output"){let h=c.outputPinPositionMap()?.get(f.name);if(h==null)return;p=h}else return;return c.space().pointFromSpace(p)});return D(ge,{get when(){return d()},children:f=>(()=>{var p=Pm();return le(h=>{var g=f().x,m=-f().y,b=5/r.scale();return g!==h.e&&ae(p,"cx",h.e=g),m!==h.t&&ae(p,"cy",h.t=m),b!==h.a&&ae(p,"r",h.a=b),h},{e:void 0,t:void 0,a:void 0}),p})()})}})}),this.click=()=>{let s=a();n.clear(),s!=null&&n.add(s)},this.dragStart=()=>{let s=r.mousePos();if(s==null)return;let c=r.screenPtToWorldPt(s);if(c==null)return;{let h=l();if(h!=null&&h.type=="Output"){let g={type:"Output",name:h.name};r.setMode(()=>new Cm({modeParams:r,fromNodeId:h.nodeId,fromPin:g}));return}}if(r.nodesSystem.disablePan())return;let d=a();if(d==null||!n.has(d))return;let f=r.nodesSystem.lookupNodeById(d);if(f==null)return;let p=f.space().pointToSpace(c);i("dragging",new Yr({nodeId:d,pickupOffset:p}))},this.dragEnd=()=>{i("dragging",void 0)};const u=[];this.highlightedObjectsById=E(()=>l()!=null?u:su(a())),this.selectedObjectsById=o,this.disablePan=E(()=>l()!=null||e.dragging!=null)}}class wo{nodes;lookupNodeById;disablePan;constructor(r){let e=r.nodeRegistry,i=E(zt(()=>r.world().entities(),u=>{let s=E(()=>{for(let c of r.world().getComponents(u)){let d=e.lookupNodeType(c.type.typeName);if(d!=null)return{nodeType:d,nodeComponent:c}}});return E(()=>{let c=s();if(c==null)return;let{nodeType:d,nodeComponent:f}=c,p=f,h=d.create({entity:u,state:p.state,setState:p.setState}),g=E(()=>r.world().getComponent(u,Ae)?.state.transform??Se.identity),m=S=>ye(()=>{let P=r.world().getComponent(u,Ae);P==null?(P=Ae.create({transform:S}),r.world().setComponents(u,[P])):P.setState("transform",S)}),[b,y]=oe(),[w,v]=oe(),[k,_]=oe();return{node:h,space:g,setSpace:m,setRenderSizeAccessor:S=>y(()=>S),setInputPinPositionMapAccessor:S=>v(()=>S),setOutputPinPositionMapAccessor:S=>_(()=>S),renderSize:()=>b()?.(),inputPinPositionMap:()=>w()?.(),outputPinPositionMap:()=>k()?.()}})})),n=E(()=>i().flatMap(u=>su(u()))),o=new Jt,a=E(()=>{zt(n,u=>{let s=u.node.nodeParams.entity;o.set(s,u),Ne(()=>{o.delete(s)})})()}),l=u=>(a(),o.get(u));this.nodes=n,this.lookupNodeById=l,this.disablePan=E(()=>{for(let u of n())if(u.node.disablePan?.()??!1)return!0;return!1})}}const Ga=20,Wa=Ga*Ga;class pu{nodeUnderMouseById;pinUnderMouse;constructor(r){let e=E(()=>{let o=r.mousePos();if(o==null)return;let a=r.screenPtToWorldPt(o);if(a!=null)for(let l of r.nodes()){let u=l.renderSize();if(u==null)continue;let s=l.space().pointToSpace(a);if(!(s.x<0||s.y<0||s.x>u.x||s.y>u.y))return l}}),i=()=>e()?.node.nodeParams.entity,n=E(()=>{let o=r.mousePos();if(o==null)return;let a,l;for(let u of r.nodes()){let s=u.inputPinPositionMap();if(s!=null)for(let[d,f]of s.entries()){let p=u.space().pointFromSpace(f),h=r.worldPtToScreenPt(p);if(h==null)continue;let g=h.distanceSquared(o);g>Wa||(l==null||g<l)&&(a={type:"Input",nodeId:u.node.nodeParams.entity,name:d},l=g)}let c=u.outputPinPositionMap();if(c!=null)for(let[d,f]of c.entries()){let p=u.space().pointFromSpace(f),h=r.worldPtToScreenPt(p);if(h==null)continue;let g=h.distanceSquared(o);g>Wa||(l==null||g<l)&&(a={type:"Output",nodeId:u.node.nodeParams.entity,name:d},l=g)}}return a});this.nodeUnderMouseById=i,this.pinUnderMouse=n}}var Tm=Y('<button class="btn btn-primary">End Mode'),Em=Y("<div>"),$m=Y("<svg>"),Im=Y("<div><svg><g>");class Rm{instructions;overlayHtmlUi;sideForm;constructor(r){let[e,i]=je({pan:K.zero,scale:1,formMousePos:void 0,dragging:void 0}),n=new Lt,o=0;for(let _ of r.nodeRegistry.nodeTypes)o-=80,n.createEntity([_.componentType.create(Qe(_.componentType.typeSchema)),Ae.create({transform:Se.create(K.create(0,o),_e.rot0)})]);let a=_=>K.create(e.pan.x+_.x/e.scale,-(e.pan.y+_.y/e.scale)),l=_=>K.create((_.x-e.pan.x)*e.scale,(-_.y-e.pan.y)*e.scale),u=new wo({nodeRegistry:r.nodeRegistry,world:()=>n}),s=new pu({mousePos:()=>e.formMousePos,screenPtToWorldPt:a,worldPtToScreenPt:l,nodes:()=>u.nodes()}),c=()=>s.nodeUnderMouseById(),d=new gt,f=new gt;ve(()=>{let _=c();_==null?d.clear():(d.clear(),d.add(_))});let p=new vo({nodes:()=>u.nodes(),lookupNodeById:_=>u.lookupNodeById(_),highlightedEntitySet:d,selectedEntitySet:f}),h=E(()=>{let _={},C=0;for(let S of u.nodes()){let P=S.renderSize();if(P==null)return;C-=P.y,_[S.node.nodeParams.entity]=K.create(0,C)}return _}),g=E(()=>{let _=h();if(_==null)return 0;let C=0;for(let S of Object.values(_))C=Math.min(C,S.y);return Math.abs(C)});ve(()=>{let _=h();if(_!=null)for(let C of n.entities())ye(()=>{let S=_[C];if(S==null)return;let P=n.getComponent(C,Ae);P?.setState("transform",Se.create(S,_e.rot0))})});let[m,b]=oe(),y,w=_=>{{let C=y.getBoundingClientRect();i("formMousePos",K.create(_.clientX-C.left,_.clientY-C.top))}y.setPointerCapture(_.pointerId),queueMicrotask(()=>{let C=e.formMousePos;if(C==null)return;let S=c();if(S==null)return;let P=u.lookupNodeById(S);if(P==null)return;let T=P.space().origin,x=a(C);x!=null&&i("dragging",new Yr({nodeType:P.node.type,nodeSize:P.renderSize()??K.create(100,50),pickupOffset:x.sub(T)}))})},v=_=>{y.releasePointerCapture(_.pointerId);let C=m();if(e.formMousePos!=null&&e.dragging!=null&&C!=null){let S=e.formMousePos,P=y.getBoundingClientRect(),T=C.getBoundingClientRect(),x=e.dragging.value.pickupOffset,$=K.create(P.left-T.left+S.x-x.x,P.top-T.top+S.y+x.y),O=r.screenPtToWorldPt($);if(O==null)return;r.world().createEntity([e.dragging.value.nodeType.componentType.create(Qe(e.dragging.value.nodeType.componentType.typeSchema)),Ae.create({transform:Se.create(O,_e.rot0)})]),i("dragging",void 0)}},k=_=>{let C=y.getBoundingClientRect();i("formMousePos",K.create(_.clientX-C.left,_.clientY-C.top))};this.instructions=()=>(()=>{var _=Tm();return _.$$click=()=>{r.onDone()},_})(),this.overlayHtmlUi=()=>D(ge,{get when(){return e.dragging?.value},children:_=>D(ge,{get when(){return e.formMousePos},children:C=>{let[S,P]=oe(!0);Ne(()=>{b(void 0)}),Sn(()=>P(!1));let T=E(()=>{if(S())return;let A=m();if(A==null)return;let L=y.getBoundingClientRect(),V=A.getBoundingClientRect();return C().add(K.create(L.left-V.left-_().pickupOffset.x,L.top-V.top-_().nodeSize.y+_().pickupOffset.y))}),x=new Lt,$=x.createEntity([ye(()=>_().nodeType.componentType.create(Qe(_().nodeType.componentType.typeSchema))),Ae.create({transform:Se.create(K.create(0,ye(()=>-_().nodeSize.y)),_e.rot0)})]),O=new wo({nodeRegistry:r.nodeRegistry,world:()=>x}),N=new vo({nodes:()=>O.nodes(),lookupNodeById:A=>O.lookupNodeById(A),highlightedEntitySet:new gt([$]),selectedEntitySet:new gt});return(()=>{var A=Em(),L=b;return typeof L=="function"?Ce(L,A):b=A,A.style.setProperty("position","absolute"),A.style.setProperty("left","0"),A.style.setProperty("top","0"),A.style.setProperty("right","0"),A.style.setProperty("bottom","0"),A.style.setProperty("pointer-events","none"),te(A,D(ge,{get when(){return T()},children:V=>(()=>{var Z=$m();return Z.style.setProperty("position","absolute"),Z.style.setProperty("touch-action","none"),Z.style.setProperty("user-select","none"),te(Z,D(N.Render,{})),le(G=>{var J=`${V().x}px`,ue=`${V().y}px`,de=`${_().nodeSize.x}px`,R=`${_().nodeSize.y}px`;return J!==G.e&&((G.e=J)!=null?Z.style.setProperty("left",J):Z.style.removeProperty("left")),ue!==G.t&&((G.t=ue)!=null?Z.style.setProperty("top",ue):Z.style.removeProperty("top")),de!==G.a&&((G.a=de)!=null?Z.style.setProperty("width",de):Z.style.removeProperty("width")),R!==G.o&&((G.o=R)!=null?Z.style.setProperty("height",R):Z.style.removeProperty("height")),G},{e:void 0,t:void 0,a:void 0,o:void 0}),Z})()})),A})()}})}),this.sideForm=E(()=>()=>(()=>{var _=Im(),C=_.firstChild,S=C.firstChild;_.style.setProperty("width","150px"),_.style.setProperty("height","100%"),_.style.setProperty("overflow-x","hidden"),_.style.setProperty("overflow-y","auto"),C.$$pointermove=k,C.$$pointerup=v,C.$$pointerdown=w;var P=y;return typeof P=="function"?Ce(P,C):y=C,C.style.setProperty("width","100%"),C.style.setProperty("touch-action","pan-y"),C.style.setProperty("user-select","none"),te(S,D(p.Render,{})),le(T=>(T=`${g()}px`)!=null?C.style.setProperty("height",T):C.style.removeProperty("height")),_})())}}Oe(["click","pointerdown","pointerup","pointermove"]);var Xn,Ha;function Go(){if(Ha)return Xn;Ha=1;var t="\0",r="\0",e="";class i{_isDirected=!0;_isMultigraph=!1;_isCompound=!1;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(c){c&&(this._isDirected=Object.hasOwn(c,"directed")?c.directed:!0,this._isMultigraph=Object.hasOwn(c,"multigraph")?c.multigraph:!1,this._isCompound=Object.hasOwn(c,"compound")?c.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[r]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(c){return this._label=c,this}graph(){return this._label}setDefaultNodeLabel(c){return this._defaultNodeLabelFn=c,typeof c!="function"&&(this._defaultNodeLabelFn=()=>c),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var c=this;return this.nodes().filter(d=>Object.keys(c._in[d]).length===0)}sinks(){var c=this;return this.nodes().filter(d=>Object.keys(c._out[d]).length===0)}setNodes(c,d){var f=arguments,p=this;return c.forEach(function(h){f.length>1?p.setNode(h,d):p.setNode(h)}),this}setNode(c,d){return Object.hasOwn(this._nodes,c)?(arguments.length>1&&(this._nodes[c]=d),this):(this._nodes[c]=arguments.length>1?d:this._defaultNodeLabelFn(c),this._isCompound&&(this._parent[c]=r,this._children[c]={},this._children[r][c]=!0),this._in[c]={},this._preds[c]={},this._out[c]={},this._sucs[c]={},++this._nodeCount,this)}node(c){return this._nodes[c]}hasNode(c){return Object.hasOwn(this._nodes,c)}removeNode(c){var d=this;if(Object.hasOwn(this._nodes,c)){var f=p=>d.removeEdge(d._edgeObjs[p]);delete this._nodes[c],this._isCompound&&(this._removeFromParentsChildList(c),delete this._parent[c],this.children(c).forEach(function(p){d.setParent(p)}),delete this._children[c]),Object.keys(this._in[c]).forEach(f),delete this._in[c],delete this._preds[c],Object.keys(this._out[c]).forEach(f),delete this._out[c],delete this._sucs[c],--this._nodeCount}return this}setParent(c,d){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(d===void 0)d=r;else{d+="";for(var f=d;f!==void 0;f=this.parent(f))if(f===c)throw new Error("Setting "+d+" as parent of "+c+" would create a cycle");this.setNode(d)}return this.setNode(c),this._removeFromParentsChildList(c),this._parent[c]=d,this._children[d][c]=!0,this}_removeFromParentsChildList(c){delete this._children[this._parent[c]][c]}parent(c){if(this._isCompound){var d=this._parent[c];if(d!==r)return d}}children(c=r){if(this._isCompound){var d=this._children[c];if(d)return Object.keys(d)}else{if(c===r)return this.nodes();if(this.hasNode(c))return[]}}predecessors(c){var d=this._preds[c];if(d)return Object.keys(d)}successors(c){var d=this._sucs[c];if(d)return Object.keys(d)}neighbors(c){var d=this.predecessors(c);if(d){const p=new Set(d);for(var f of this.successors(c))p.add(f);return Array.from(p.values())}}isLeaf(c){var d;return this.isDirected()?d=this.successors(c):d=this.neighbors(c),d.length===0}filterNodes(c){var d=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});d.setGraph(this.graph());var f=this;Object.entries(this._nodes).forEach(function([g,m]){c(g)&&d.setNode(g,m)}),Object.values(this._edgeObjs).forEach(function(g){d.hasNode(g.v)&&d.hasNode(g.w)&&d.setEdge(g,f.edge(g))});var p={};function h(g){var m=f.parent(g);return m===void 0||d.hasNode(m)?(p[g]=m,m):m in p?p[m]:h(m)}return this._isCompound&&d.nodes().forEach(g=>d.setParent(g,h(g))),d}setDefaultEdgeLabel(c){return this._defaultEdgeLabelFn=c,typeof c!="function"&&(this._defaultEdgeLabelFn=()=>c),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(c,d){var f=this,p=arguments;return c.reduce(function(h,g){return p.length>1?f.setEdge(h,g,d):f.setEdge(h,g),g}),this}setEdge(){var c,d,f,p,h=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(c=g.v,d=g.w,f=g.name,arguments.length===2&&(p=arguments[1],h=!0)):(c=g,d=arguments[1],f=arguments[3],arguments.length>2&&(p=arguments[2],h=!0)),c=""+c,d=""+d,f!==void 0&&(f=""+f);var m=a(this._isDirected,c,d,f);if(Object.hasOwn(this._edgeLabels,m))return h&&(this._edgeLabels[m]=p),this;if(f!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(c),this.setNode(d),this._edgeLabels[m]=h?p:this._defaultEdgeLabelFn(c,d,f);var b=l(this._isDirected,c,d,f);return c=b.v,d=b.w,Object.freeze(b),this._edgeObjs[m]=b,n(this._preds[d],c),n(this._sucs[c],d),this._in[d][m]=b,this._out[c][m]=b,this._edgeCount++,this}edge(c,d,f){var p=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,c,d,f);return this._edgeLabels[p]}edgeAsObj(){const c=this.edge(...arguments);return typeof c!="object"?{label:c}:c}hasEdge(c,d,f){var p=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,c,d,f);return Object.hasOwn(this._edgeLabels,p)}removeEdge(c,d,f){var p=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,c,d,f),h=this._edgeObjs[p];return h&&(c=h.v,d=h.w,delete this._edgeLabels[p],delete this._edgeObjs[p],o(this._preds[d],c),o(this._sucs[c],d),delete this._in[d][p],delete this._out[c][p],this._edgeCount--),this}inEdges(c,d){var f=this._in[c];if(f){var p=Object.values(f);return d?p.filter(h=>h.v===d):p}}outEdges(c,d){var f=this._out[c];if(f){var p=Object.values(f);return d?p.filter(h=>h.w===d):p}}nodeEdges(c,d){var f=this.inEdges(c,d);if(f)return f.concat(this.outEdges(c,d))}}function n(s,c){s[c]?s[c]++:s[c]=1}function o(s,c){--s[c]||delete s[c]}function a(s,c,d,f){var p=""+c,h=""+d;if(!s&&p>h){var g=p;p=h,h=g}return p+e+h+e+(f===void 0?t:f)}function l(s,c,d,f){var p=""+c,h=""+d;if(!s&&p>h){var g=p;p=h,h=g}var m={v:p,w:h};return f&&(m.name=f),m}function u(s,c){return a(s,c.v,c.w,c.name)}return Xn=i,Xn}var Kn,Za;function Nm(){return Za||(Za=1,Kn="2.2.4"),Kn}var Jn,Ya;function Am(){return Ya||(Ya=1,Jn={Graph:Go(),version:Nm()}),Jn}var Qn,Xa;function Mm(){if(Xa)return Qn;Xa=1;var t=Go();Qn={write:r,read:n};function r(o){var a={options:{directed:o.isDirected(),multigraph:o.isMultigraph(),compound:o.isCompound()},nodes:e(o),edges:i(o)};return o.graph()!==void 0&&(a.value=structuredClone(o.graph())),a}function e(o){return o.nodes().map(function(a){var l=o.node(a),u=o.parent(a),s={v:a};return l!==void 0&&(s.value=l),u!==void 0&&(s.parent=u),s})}function i(o){return o.edges().map(function(a){var l=o.edge(a),u={v:a.v,w:a.w};return a.name!==void 0&&(u.name=a.name),l!==void 0&&(u.value=l),u})}function n(o){var a=new t(o.options).setGraph(o.value);return o.nodes.forEach(function(l){a.setNode(l.v,l.value),l.parent&&a.setParent(l.v,l.parent)}),o.edges.forEach(function(l){a.setEdge({v:l.v,w:l.w,name:l.name},l.value)}),a}return Qn}var ei,Ka;function Om(){if(Ka)return ei;Ka=1,ei=t;function t(r){var e={},i=[],n;function o(a){Object.hasOwn(e,a)||(e[a]=!0,n.push(a),r.successors(a).forEach(o),r.predecessors(a).forEach(o))}return r.nodes().forEach(function(a){n=[],o(a),n.length&&i.push(n)}),i}return ei}var ti,Ja;function fu(){if(Ja)return ti;Ja=1;class t{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(e){return e.key})}has(e){return Object.hasOwn(this._keyIndices,e)}priority(e){var i=this._keyIndices[e];if(i!==void 0)return this._arr[i].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(e,i){var n=this._keyIndices;if(e=String(e),!Object.hasOwn(n,e)){var o=this._arr,a=o.length;return n[e]=a,o.push({key:e,priority:i}),this._decrease(a),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key}decrease(e,i){var n=this._keyIndices[e];if(i>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+i);this._arr[n].priority=i,this._decrease(n)}_heapify(e){var i=this._arr,n=2*e,o=n+1,a=e;n<i.length&&(a=i[n].priority<i[a].priority?n:a,o<i.length&&(a=i[o].priority<i[a].priority?o:a),a!==e&&(this._swap(e,a),this._heapify(a)))}_decrease(e){for(var i=this._arr,n=i[e].priority,o;e!==0&&(o=e>>1,!(i[o].priority<n));)this._swap(e,o),e=o}_swap(e,i){var n=this._arr,o=this._keyIndices,a=n[e],l=n[i];n[e]=l,n[i]=a,o[l.key]=e,o[a.key]=i}}return ti=t,ti}var ri,Qa;function hu(){if(Qa)return ri;Qa=1;var t=fu();ri=e;var r=()=>1;function e(n,o,a,l){return i(n,String(o),a||r,l||function(u){return n.outEdges(u)})}function i(n,o,a,l){var u={},s=new t,c,d,f=function(p){var h=p.v!==c?p.v:p.w,g=u[h],m=a(p),b=d.distance+m;if(m<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+p+" Weight: "+m);b<g.distance&&(g.distance=b,g.predecessor=c,s.decrease(h,b))};for(n.nodes().forEach(function(p){var h=p===o?0:Number.POSITIVE_INFINITY;u[p]={distance:h},s.add(p,h)});s.size()>0&&(c=s.removeMin(),d=u[c],d.distance!==Number.POSITIVE_INFINITY);)l(c).forEach(f);return u}return ri}var ni,es;function Fm(){if(es)return ni;es=1;var t=hu();ni=r;function r(e,i,n){return e.nodes().reduce(function(o,a){return o[a]=t(e,a,i,n),o},{})}return ni}var ii,ts;function mu(){if(ts)return ii;ts=1,ii=t;function t(r){var e=0,i=[],n={},o=[];function a(l){var u=n[l]={onStack:!0,lowlink:e,index:e++};if(i.push(l),r.successors(l).forEach(function(d){Object.hasOwn(n,d)?n[d].onStack&&(u.lowlink=Math.min(u.lowlink,n[d].index)):(a(d),u.lowlink=Math.min(u.lowlink,n[d].lowlink))}),u.lowlink===u.index){var s=[],c;do c=i.pop(),n[c].onStack=!1,s.push(c);while(l!==c);o.push(s)}}return r.nodes().forEach(function(l){Object.hasOwn(n,l)||a(l)}),o}return ii}var oi,rs;function Dm(){if(rs)return oi;rs=1;var t=mu();oi=r;function r(e){return t(e).filter(function(i){return i.length>1||i.length===1&&e.hasEdge(i[0],i[0])})}return oi}var ai,ns;function zm(){if(ns)return ai;ns=1,ai=r;var t=()=>1;function r(i,n,o){return e(i,n||t,o||function(a){return i.outEdges(a)})}function e(i,n,o){var a={},l=i.nodes();return l.forEach(function(u){a[u]={},a[u][u]={distance:0},l.forEach(function(s){u!==s&&(a[u][s]={distance:Number.POSITIVE_INFINITY})}),o(u).forEach(function(s){var c=s.v===u?s.w:s.v,d=n(s);a[u][c]={distance:d,predecessor:u}})}),l.forEach(function(u){var s=a[u];l.forEach(function(c){var d=a[c];l.forEach(function(f){var p=d[u],h=s[f],g=d[f],m=p.distance+h.distance;m<g.distance&&(g.distance=m,g.predecessor=h.predecessor)})})}),a}return ai}var si,is;function gu(){if(is)return si;is=1;function t(e){var i={},n={},o=[];function a(l){if(Object.hasOwn(n,l))throw new r;Object.hasOwn(i,l)||(n[l]=!0,i[l]=!0,e.predecessors(l).forEach(a),delete n[l],o.push(l))}if(e.sinks().forEach(a),Object.keys(i).length!==e.nodeCount())throw new r;return o}class r extends Error{constructor(){super(...arguments)}}return si=t,t.CycleException=r,si}var li,os;function Lm(){if(os)return li;os=1;var t=gu();li=r;function r(e){try{t(e)}catch(i){if(i instanceof t.CycleException)return!1;throw i}return!0}return li}var ci,as;function yu(){if(as)return ci;as=1,ci=t;function t(n,o,a){Array.isArray(o)||(o=[o]);var l=n.isDirected()?d=>n.successors(d):d=>n.neighbors(d),u=a==="post"?r:e,s=[],c={};return o.forEach(d=>{if(!n.hasNode(d))throw new Error("Graph does not have node: "+d);u(d,l,c,s)}),s}function r(n,o,a,l){for(var u=[[n,!1]];u.length>0;){var s=u.pop();s[1]?l.push(s[0]):Object.hasOwn(a,s[0])||(a[s[0]]=!0,u.push([s[0],!0]),i(o(s[0]),c=>u.push([c,!1])))}}function e(n,o,a,l){for(var u=[n];u.length>0;){var s=u.pop();Object.hasOwn(a,s)||(a[s]=!0,l.push(s),i(o(s),c=>u.push(c)))}}function i(n,o){for(var a=n.length;a--;)o(n[a],a,n);return n}return ci}var ui,ss;function jm(){if(ss)return ui;ss=1;var t=yu();ui=r;function r(e,i){return t(e,i,"post")}return ui}var di,ls;function Um(){if(ls)return di;ls=1;var t=yu();di=r;function r(e,i){return t(e,i,"pre")}return di}var pi,cs;function Bm(){if(cs)return pi;cs=1;var t=Go(),r=fu();pi=e;function e(i,n){var o=new t,a={},l=new r,u;function s(d){var f=d.v===u?d.w:d.v,p=l.priority(f);if(p!==void 0){var h=n(d);h<p&&(a[f]=u,l.decrease(f,h))}}if(i.nodeCount()===0)return o;i.nodes().forEach(function(d){l.add(d,Number.POSITIVE_INFINITY),o.setNode(d)}),l.decrease(i.nodes()[0],0);for(var c=!1;l.size()>0;){if(u=l.removeMin(),Object.hasOwn(a,u))o.setEdge(u,a[u]);else{if(c)throw new Error("Input graph is not connected: "+i);c=!0}i.nodeEdges(u).forEach(s)}return o}return pi}var fi,us;function qm(){return us||(us=1,fi={components:Om(),dijkstra:hu(),dijkstraAll:Fm(),findCycles:Dm(),floydWarshall:zm(),isAcyclic:Lm(),postorder:jm(),preorder:Um(),prim:Bm(),tarjan:mu(),topsort:gu()}),fi}var hi,ds;function ft(){if(ds)return hi;ds=1;var t=Am();return hi={Graph:t.Graph,json:Mm(),alg:qm(),version:t.version},hi}var mi,ps;function Vm(){if(ps)return mi;ps=1;class t{constructor(){let n={};n._next=n._prev=n,this._sentinel=n}dequeue(){let n=this._sentinel,o=n._prev;if(o!==n)return r(o),o}enqueue(n){let o=this._sentinel;n._prev&&n._next&&r(n),n._next=o._next,o._next._prev=n,o._next=n,n._prev=o}toString(){let n=[],o=this._sentinel,a=o._prev;for(;a!==o;)n.push(JSON.stringify(a,e)),a=a._prev;return"["+n.join(", ")+"]"}}function r(i){i._prev._next=i._next,i._next._prev=i._prev,delete i._next,delete i._prev}function e(i,n){if(i!=="_next"&&i!=="_prev")return n}return mi=t,mi}var gi,fs;function Gm(){if(fs)return gi;fs=1;let t=ft().Graph,r=Vm();gi=i;let e=()=>1;function i(s,c){if(s.nodeCount()<=1)return[];let d=a(s,c||e);return n(d.graph,d.buckets,d.zeroIdx).flatMap(p=>s.outEdges(p.v,p.w))}function n(s,c,d){let f=[],p=c[c.length-1],h=c[0],g;for(;s.nodeCount();){for(;g=h.dequeue();)o(s,c,d,g);for(;g=p.dequeue();)o(s,c,d,g);if(s.nodeCount()){for(let m=c.length-2;m>0;--m)if(g=c[m].dequeue(),g){f=f.concat(o(s,c,d,g,!0));break}}}return f}function o(s,c,d,f,p){let h=p?[]:void 0;return s.inEdges(f.v).forEach(g=>{let m=s.edge(g),b=s.node(g.v);p&&h.push({v:g.v,w:g.w}),b.out-=m,l(c,d,b)}),s.outEdges(f.v).forEach(g=>{let m=s.edge(g),b=g.w,y=s.node(b);y.in-=m,l(c,d,y)}),s.removeNode(f.v),h}function a(s,c){let d=new t,f=0,p=0;s.nodes().forEach(m=>{d.setNode(m,{v:m,in:0,out:0})}),s.edges().forEach(m=>{let b=d.edge(m.v,m.w)||0,y=c(m),w=b+y;d.setEdge(m.v,m.w,w),p=Math.max(p,d.node(m.v).out+=y),f=Math.max(f,d.node(m.w).in+=y)});let h=u(p+f+3).map(()=>new r),g=f+1;return d.nodes().forEach(m=>{l(h,g,d.node(m))}),{graph:d,buckets:h,zeroIdx:g}}function l(s,c,d){d.out?d.in?s[d.out-d.in+c].enqueue(d):s[s.length-1].enqueue(d):s[0].enqueue(d)}function u(s){const c=[];for(let d=0;d<s;d++)c.push(d);return c}return gi}var yi,hs;function Me(){if(hs)return yi;hs=1;let t=ft().Graph;yi={addBorderNode:c,addDummyNode:r,applyWithChunking:p,asNonCompoundGraph:i,buildLayerMatrix:l,intersectRect:a,mapValues:_,maxRank:h,normalizeRanks:u,notime:b,partition:g,pick:k,predecessorWeights:o,range:v,removeEmptyRanks:s,simplify:e,successorWeights:n,time:m,uniqueId:w,zipObject:C};function r(S,P,T,x){for(var $=x;S.hasNode($);)$=w(x);return T.dummy=P,S.setNode($,T),$}function e(S){let P=new t().setGraph(S.graph());return S.nodes().forEach(T=>P.setNode(T,S.node(T))),S.edges().forEach(T=>{let x=P.edge(T.v,T.w)||{weight:0,minlen:1},$=S.edge(T);P.setEdge(T.v,T.w,{weight:x.weight+$.weight,minlen:Math.max(x.minlen,$.minlen)})}),P}function i(S){let P=new t({multigraph:S.isMultigraph()}).setGraph(S.graph());return S.nodes().forEach(T=>{S.children(T).length||P.setNode(T,S.node(T))}),S.edges().forEach(T=>{P.setEdge(T,S.edge(T))}),P}function n(S){let P=S.nodes().map(T=>{let x={};return S.outEdges(T).forEach($=>{x[$.w]=(x[$.w]||0)+S.edge($).weight}),x});return C(S.nodes(),P)}function o(S){let P=S.nodes().map(T=>{let x={};return S.inEdges(T).forEach($=>{x[$.v]=(x[$.v]||0)+S.edge($).weight}),x});return C(S.nodes(),P)}function a(S,P){let T=S.x,x=S.y,$=P.x-T,O=P.y-x,N=S.width/2,A=S.height/2;if(!$&&!O)throw new Error("Not possible to find intersection inside of the rectangle");let L,V;return Math.abs(O)*N>Math.abs($)*A?(O<0&&(A=-A),L=A*$/O,V=A):($<0&&(N=-N),L=N,V=N*O/$),{x:T+L,y:x+V}}function l(S){let P=v(h(S)+1).map(()=>[]);return S.nodes().forEach(T=>{let x=S.node(T),$=x.rank;$!==void 0&&(P[$][x.order]=T)}),P}function u(S){let P=S.nodes().map(x=>{let $=S.node(x).rank;return $===void 0?Number.MAX_VALUE:$}),T=p(Math.min,P);S.nodes().forEach(x=>{let $=S.node(x);Object.hasOwn($,"rank")&&($.rank-=T)})}function s(S){let P=S.nodes().map(N=>S.node(N).rank),T=p(Math.min,P),x=[];S.nodes().forEach(N=>{let A=S.node(N).rank-T;x[A]||(x[A]=[]),x[A].push(N)});let $=0,O=S.graph().nodeRankFactor;Array.from(x).forEach((N,A)=>{N===void 0&&A%O!==0?--$:N!==void 0&&$&&N.forEach(L=>S.node(L).rank+=$)})}function c(S,P,T,x){let $={width:0,height:0};return arguments.length>=4&&($.rank=T,$.order=x),r(S,"border",$,P)}function d(S,P=f){const T=[];for(let x=0;x<S.length;x+=P){const $=S.slice(x,x+P);T.push($)}return T}const f=65535;function p(S,P){if(P.length>f){const T=d(P);return S.apply(null,T.map(x=>S.apply(null,x)))}else return S.apply(null,P)}function h(S){const T=S.nodes().map(x=>{let $=S.node(x).rank;return $===void 0?Number.MIN_VALUE:$});return p(Math.max,T)}function g(S,P){let T={lhs:[],rhs:[]};return S.forEach(x=>{P(x)?T.lhs.push(x):T.rhs.push(x)}),T}function m(S,P){let T=Date.now();try{return P()}finally{console.log(S+" time: "+(Date.now()-T)+"ms")}}function b(S,P){return P()}let y=0;function w(S){var P=++y;return S+(""+P)}function v(S,P,T=1){P==null&&(P=S,S=0);let x=O=>O<P;T<0&&(x=O=>P<O);const $=[];for(let O=S;x(O);O+=T)$.push(O);return $}function k(S,P){const T={};for(const x of P)S[x]!==void 0&&(T[x]=S[x]);return T}function _(S,P){let T=P;return typeof P=="string"&&(T=x=>x[P]),Object.entries(S).reduce((x,[$,O])=>(x[$]=T(O,$),x),{})}function C(S,P){return S.reduce((T,x,$)=>(T[x]=P[$],T),{})}return yi}var bi,ms;function Wm(){if(ms)return bi;ms=1;let t=Gm(),r=Me().uniqueId;bi={run:e,undo:n};function e(o){(o.graph().acyclicer==="greedy"?t(o,l(o)):i(o)).forEach(u=>{let s=o.edge(u);o.removeEdge(u),s.forwardName=u.name,s.reversed=!0,o.setEdge(u.w,u.v,s,r("rev"))});function l(u){return s=>u.edge(s).weight}}function i(o){let a=[],l={},u={};function s(c){Object.hasOwn(u,c)||(u[c]=!0,l[c]=!0,o.outEdges(c).forEach(d=>{Object.hasOwn(l,d.w)?a.push(d):s(d.w)}),delete l[c])}return o.nodes().forEach(s),a}function n(o){o.edges().forEach(a=>{let l=o.edge(a);if(l.reversed){o.removeEdge(a);let u=l.forwardName;delete l.reversed,delete l.forwardName,o.setEdge(a.w,a.v,l,u)}})}return bi}var vi,gs;function Hm(){if(gs)return vi;gs=1;let t=Me();vi={run:r,undo:i};function r(n){n.graph().dummyChains=[],n.edges().forEach(o=>e(n,o))}function e(n,o){let a=o.v,l=n.node(a).rank,u=o.w,s=n.node(u).rank,c=o.name,d=n.edge(o),f=d.labelRank;if(s===l+1)return;n.removeEdge(o);let p,h,g;for(g=0,++l;l<s;++g,++l)d.points=[],h={width:0,height:0,edgeLabel:d,edgeObj:o,rank:l},p=t.addDummyNode(n,"edge",h,"_d"),l===f&&(h.width=d.width,h.height=d.height,h.dummy="edge-label",h.labelpos=d.labelpos),n.setEdge(a,p,{weight:d.weight},c),g===0&&n.graph().dummyChains.push(p),a=p;n.setEdge(a,u,{weight:d.weight},c)}function i(n){n.graph().dummyChains.forEach(o=>{let a=n.node(o),l=a.edgeLabel,u;for(n.setEdge(a.edgeObj,l);a.dummy;)u=n.successors(o)[0],n.removeNode(o),l.points.push({x:a.x,y:a.y}),a.dummy==="edge-label"&&(l.x=a.x,l.y=a.y,l.width=a.width,l.height=a.height),o=u,a=n.node(o)})}return vi}var wi,ys;function En(){if(ys)return wi;ys=1;const{applyWithChunking:t}=Me();wi={longestPath:r,slack:e};function r(i){var n={};function o(a){var l=i.node(a);if(Object.hasOwn(n,a))return l.rank;n[a]=!0;let u=i.outEdges(a).map(c=>c==null?Number.POSITIVE_INFINITY:o(c.w)-i.edge(c).minlen);var s=t(Math.min,u);return s===Number.POSITIVE_INFINITY&&(s=0),l.rank=s}i.sources().forEach(o)}function e(i,n){return i.node(n.w).rank-i.node(n.v).rank-i.edge(n).minlen}return wi}var ki,bs;function bu(){if(bs)return ki;bs=1;var t=ft().Graph,r=En().slack;ki=e;function e(a){var l=new t({directed:!1}),u=a.nodes()[0],s=a.nodeCount();l.setNode(u,{});for(var c,d;i(l,a)<s;)c=n(l,a),d=l.hasNode(c.v)?r(a,c):-r(a,c),o(l,a,d);return l}function i(a,l){function u(s){l.nodeEdges(s).forEach(c=>{var d=c.v,f=s===d?c.w:d;!a.hasNode(f)&&!r(l,c)&&(a.setNode(f,{}),a.setEdge(s,f,{}),u(f))})}return a.nodes().forEach(u),a.nodeCount()}function n(a,l){return l.edges().reduce((s,c)=>{let d=Number.POSITIVE_INFINITY;return a.hasNode(c.v)!==a.hasNode(c.w)&&(d=r(l,c)),d<s[0]?[d,c]:s},[Number.POSITIVE_INFINITY,null])[1]}function o(a,l,u){a.nodes().forEach(s=>l.node(s).rank+=u)}return ki}var xi,vs;function Zm(){if(vs)return xi;vs=1;var t=bu(),r=En().slack,e=En().longestPath,i=ft().alg.preorder,n=ft().alg.postorder,o=Me().simplify;xi=a,a.initLowLimValues=c,a.initCutValues=l,a.calcCutValue=s,a.leaveEdge=f,a.enterEdge=p,a.exchangeEdges=h;function a(y){y=o(y),e(y);var w=t(y);c(w),l(w,y);for(var v,k;v=f(w);)k=p(w,y,v),h(w,y,v,k)}function l(y,w){var v=n(y,y.nodes());v=v.slice(0,v.length-1),v.forEach(k=>u(y,w,k))}function u(y,w,v){var k=y.node(v),_=k.parent;y.edge(v,_).cutvalue=s(y,w,v)}function s(y,w,v){var k=y.node(v),_=k.parent,C=!0,S=w.edge(v,_),P=0;return S||(C=!1,S=w.edge(_,v)),P=S.weight,w.nodeEdges(v).forEach(T=>{var x=T.v===v,$=x?T.w:T.v;if($!==_){var O=x===C,N=w.edge(T).weight;if(P+=O?N:-N,m(y,v,$)){var A=y.edge(v,$).cutvalue;P+=O?-A:A}}}),P}function c(y,w){arguments.length<2&&(w=y.nodes()[0]),d(y,{},1,w)}function d(y,w,v,k,_){var C=v,S=y.node(k);return w[k]=!0,y.neighbors(k).forEach(P=>{Object.hasOwn(w,P)||(v=d(y,w,v,P,k))}),S.low=C,S.lim=v++,_?S.parent=_:delete S.parent,v}function f(y){return y.edges().find(w=>y.edge(w).cutvalue<0)}function p(y,w,v){var k=v.v,_=v.w;w.hasEdge(k,_)||(k=v.w,_=v.v);var C=y.node(k),S=y.node(_),P=C,T=!1;C.lim>S.lim&&(P=S,T=!0);var x=w.edges().filter($=>T===b(y,y.node($.v),P)&&T!==b(y,y.node($.w),P));return x.reduce(($,O)=>r(w,O)<r(w,$)?O:$)}function h(y,w,v,k){var _=v.v,C=v.w;y.removeEdge(_,C),y.setEdge(k.v,k.w,{}),c(y),l(y,w),g(y,w)}function g(y,w){var v=y.nodes().find(_=>!w.node(_).parent),k=i(y,v);k=k.slice(1),k.forEach(_=>{var C=y.node(_).parent,S=w.edge(_,C),P=!1;S||(S=w.edge(C,_),P=!0),w.node(_).rank=w.node(C).rank+(P?S.minlen:-S.minlen)})}function m(y,w,v){return y.hasEdge(w,v)}function b(y,w,v){return v.low<=w.lim&&w.lim<=v.lim}return xi}var _i,ws;function Ym(){if(ws)return _i;ws=1;var t=En(),r=t.longestPath,e=bu(),i=Zm();_i=n;function n(u){var s=u.graph().ranker;if(s instanceof Function)return s(u);switch(u.graph().ranker){case"network-simplex":l(u);break;case"tight-tree":a(u);break;case"longest-path":o(u);break;case"none":break;default:l(u)}}var o=r;function a(u){r(u),e(u)}function l(u){i(u)}return _i}var Si,ks;function Xm(){if(ks)return Si;ks=1,Si=t;function t(i){let n=e(i);i.graph().dummyChains.forEach(o=>{let a=i.node(o),l=a.edgeObj,u=r(i,n,l.v,l.w),s=u.path,c=u.lca,d=0,f=s[d],p=!0;for(;o!==l.w;){if(a=i.node(o),p){for(;(f=s[d])!==c&&i.node(f).maxRank<a.rank;)d++;f===c&&(p=!1)}if(!p){for(;d<s.length-1&&i.node(f=s[d+1]).minRank<=a.rank;)d++;f=s[d]}i.setParent(o,f),o=i.successors(o)[0]}})}function r(i,n,o,a){let l=[],u=[],s=Math.min(n[o].low,n[a].low),c=Math.max(n[o].lim,n[a].lim),d,f;d=o;do d=i.parent(d),l.push(d);while(d&&(n[d].low>s||c>n[d].lim));for(f=d,d=a;(d=i.parent(d))!==f;)u.push(d);return{path:l.concat(u.reverse()),lca:f}}function e(i){let n={},o=0;function a(l){let u=o;i.children(l).forEach(a),n[l]={low:u,lim:o++}}return i.children().forEach(a),n}return Si}var Ci,xs;function Km(){if(xs)return Ci;xs=1;let t=Me();Ci={run:r,cleanup:o};function r(a){let l=t.addDummyNode(a,"root",{},"_root"),u=i(a),s=Object.values(u),c=t.applyWithChunking(Math.max,s)-1,d=2*c+1;a.graph().nestingRoot=l,a.edges().forEach(p=>a.edge(p).minlen*=d);let f=n(a)+1;a.children().forEach(p=>e(a,l,d,f,c,u,p)),a.graph().nodeRankFactor=d}function e(a,l,u,s,c,d,f){let p=a.children(f);if(!p.length){f!==l&&a.setEdge(l,f,{weight:0,minlen:u});return}let h=t.addBorderNode(a,"_bt"),g=t.addBorderNode(a,"_bb"),m=a.node(f);a.setParent(h,f),m.borderTop=h,a.setParent(g,f),m.borderBottom=g,p.forEach(b=>{e(a,l,u,s,c,d,b);let y=a.node(b),w=y.borderTop?y.borderTop:b,v=y.borderBottom?y.borderBottom:b,k=y.borderTop?s:2*s,_=w!==v?1:c-d[f]+1;a.setEdge(h,w,{weight:k,minlen:_,nestingEdge:!0}),a.setEdge(v,g,{weight:k,minlen:_,nestingEdge:!0})}),a.parent(f)||a.setEdge(l,h,{weight:0,minlen:c+d[f]})}function i(a){var l={};function u(s,c){var d=a.children(s);d&&d.length&&d.forEach(f=>u(f,c+1)),l[s]=c}return a.children().forEach(s=>u(s,1)),l}function n(a){return a.edges().reduce((l,u)=>l+a.edge(u).weight,0)}function o(a){var l=a.graph();a.removeNode(l.nestingRoot),delete l.nestingRoot,a.edges().forEach(u=>{var s=a.edge(u);s.nestingEdge&&a.removeEdge(u)})}return Ci}var Pi,_s;function Jm(){if(_s)return Pi;_s=1;let t=Me();Pi=r;function r(i){function n(o){let a=i.children(o),l=i.node(o);if(a.length&&a.forEach(n),Object.hasOwn(l,"minRank")){l.borderLeft=[],l.borderRight=[];for(let u=l.minRank,s=l.maxRank+1;u<s;++u)e(i,"borderLeft","_bl",o,l,u),e(i,"borderRight","_br",o,l,u)}}i.children().forEach(n)}function e(i,n,o,a,l,u){let s={width:0,height:0,rank:u,borderType:n},c=l[n][u-1],d=t.addDummyNode(i,"border",s,o);l[n][u]=d,i.setParent(d,a),c&&i.setEdge(c,d,{weight:1})}return Pi}var Ti,Ss;function Qm(){if(Ss)return Ti;Ss=1,Ti={adjust:t,undo:r};function t(u){let s=u.graph().rankdir.toLowerCase();(s==="lr"||s==="rl")&&e(u)}function r(u){let s=u.graph().rankdir.toLowerCase();(s==="bt"||s==="rl")&&n(u),(s==="lr"||s==="rl")&&(a(u),e(u))}function e(u){u.nodes().forEach(s=>i(u.node(s))),u.edges().forEach(s=>i(u.edge(s)))}function i(u){let s=u.width;u.width=u.height,u.height=s}function n(u){u.nodes().forEach(s=>o(u.node(s))),u.edges().forEach(s=>{let c=u.edge(s);c.points.forEach(o),Object.hasOwn(c,"y")&&o(c)})}function o(u){u.y=-u.y}function a(u){u.nodes().forEach(s=>l(u.node(s))),u.edges().forEach(s=>{let c=u.edge(s);c.points.forEach(l),Object.hasOwn(c,"x")&&l(c)})}function l(u){let s=u.x;u.x=u.y,u.y=s}return Ti}var Ei,Cs;function eg(){if(Cs)return Ei;Cs=1;let t=Me();Ei=r;function r(e){let i={},n=e.nodes().filter(c=>!e.children(c).length),o=n.map(c=>e.node(c).rank),a=t.applyWithChunking(Math.max,o),l=t.range(a+1).map(()=>[]);function u(c){if(i[c])return;i[c]=!0;let d=e.node(c);l[d.rank].push(c),e.successors(c).forEach(u)}return n.sort((c,d)=>e.node(c).rank-e.node(d).rank).forEach(u),l}return Ei}var $i,Ps;function tg(){if(Ps)return $i;Ps=1;let t=Me().zipObject;$i=r;function r(i,n){let o=0;for(let a=1;a<n.length;++a)o+=e(i,n[a-1],n[a]);return o}function e(i,n,o){let a=t(o,o.map((f,p)=>p)),l=n.flatMap(f=>i.outEdges(f).map(p=>({pos:a[p.w],weight:i.edge(p).weight})).sort((p,h)=>p.pos-h.pos)),u=1;for(;u<o.length;)u<<=1;let s=2*u-1;u-=1;let c=new Array(s).fill(0),d=0;return l.forEach(f=>{let p=f.pos+u;c[p]+=f.weight;let h=0;for(;p>0;)p%2&&(h+=c[p+1]),p=p-1>>1,c[p]+=f.weight;d+=f.weight*h}),d}return $i}var Ii,Ts;function rg(){if(Ts)return Ii;Ts=1,Ii=t;function t(r,e=[]){return e.map(i=>{let n=r.inEdges(i);if(n.length){let o=n.reduce((a,l)=>{let u=r.edge(l),s=r.node(l.v);return{sum:a.sum+u.weight*s.order,weight:a.weight+u.weight}},{sum:0,weight:0});return{v:i,barycenter:o.sum/o.weight,weight:o.weight}}else return{v:i}})}return Ii}var Ri,Es;function ng(){if(Es)return Ri;Es=1;let t=Me();Ri=r;function r(n,o){let a={};n.forEach((u,s)=>{let c=a[u.v]={indegree:0,in:[],out:[],vs:[u.v],i:s};u.barycenter!==void 0&&(c.barycenter=u.barycenter,c.weight=u.weight)}),o.edges().forEach(u=>{let s=a[u.v],c=a[u.w];s!==void 0&&c!==void 0&&(c.indegree++,s.out.push(a[u.w]))});let l=Object.values(a).filter(u=>!u.indegree);return e(l)}function e(n){let o=[];function a(u){return s=>{s.merged||(s.barycenter===void 0||u.barycenter===void 0||s.barycenter>=u.barycenter)&&i(u,s)}}function l(u){return s=>{s.in.push(u),--s.indegree===0&&n.push(s)}}for(;n.length;){let u=n.pop();o.push(u),u.in.reverse().forEach(a(u)),u.out.forEach(l(u))}return o.filter(u=>!u.merged).map(u=>t.pick(u,["vs","i","barycenter","weight"]))}function i(n,o){let a=0,l=0;n.weight&&(a+=n.barycenter*n.weight,l+=n.weight),o.weight&&(a+=o.barycenter*o.weight,l+=o.weight),n.vs=o.vs.concat(n.vs),n.barycenter=a/l,n.weight=l,n.i=Math.min(o.i,n.i),o.merged=!0}return Ri}var Ni,$s;function ig(){if($s)return Ni;$s=1;let t=Me();Ni=r;function r(n,o){let a=t.partition(n,h=>Object.hasOwn(h,"barycenter")),l=a.lhs,u=a.rhs.sort((h,g)=>g.i-h.i),s=[],c=0,d=0,f=0;l.sort(i(!!o)),f=e(s,u,f),l.forEach(h=>{f+=h.vs.length,s.push(h.vs),c+=h.barycenter*h.weight,d+=h.weight,f=e(s,u,f)});let p={vs:s.flat(!0)};return d&&(p.barycenter=c/d,p.weight=d),p}function e(n,o,a){let l;for(;o.length&&(l=o[o.length-1]).i<=a;)o.pop(),n.push(l.vs),a++;return a}function i(n){return(o,a)=>o.barycenter<a.barycenter?-1:o.barycenter>a.barycenter?1:n?a.i-o.i:o.i-a.i}return Ni}var Ai,Is;function og(){if(Is)return Ai;Is=1;let t=rg(),r=ng(),e=ig();Ai=i;function i(a,l,u,s){let c=a.children(l),d=a.node(l),f=d?d.borderLeft:void 0,p=d?d.borderRight:void 0,h={};f&&(c=c.filter(y=>y!==f&&y!==p));let g=t(a,c);g.forEach(y=>{if(a.children(y.v).length){let w=i(a,y.v,u,s);h[y.v]=w,Object.hasOwn(w,"barycenter")&&o(y,w)}});let m=r(g,u);n(m,h);let b=e(m,s);if(f&&(b.vs=[f,b.vs,p].flat(!0),a.predecessors(f).length)){let y=a.node(a.predecessors(f)[0]),w=a.node(a.predecessors(p)[0]);Object.hasOwn(b,"barycenter")||(b.barycenter=0,b.weight=0),b.barycenter=(b.barycenter*b.weight+y.order+w.order)/(b.weight+2),b.weight+=2}return b}function n(a,l){a.forEach(u=>{u.vs=u.vs.flatMap(s=>l[s]?l[s].vs:s)})}function o(a,l){a.barycenter!==void 0?(a.barycenter=(a.barycenter*a.weight+l.barycenter*l.weight)/(a.weight+l.weight),a.weight+=l.weight):(a.barycenter=l.barycenter,a.weight=l.weight)}return Ai}var Mi,Rs;function ag(){if(Rs)return Mi;Rs=1;let t=ft().Graph,r=Me();Mi=e;function e(n,o,a){let l=i(n),u=new t({compound:!0}).setGraph({root:l}).setDefaultNodeLabel(s=>n.node(s));return n.nodes().forEach(s=>{let c=n.node(s),d=n.parent(s);(c.rank===o||c.minRank<=o&&o<=c.maxRank)&&(u.setNode(s),u.setParent(s,d||l),n[a](s).forEach(f=>{let p=f.v===s?f.w:f.v,h=u.edge(p,s),g=h!==void 0?h.weight:0;u.setEdge(p,s,{weight:n.edge(f).weight+g})}),Object.hasOwn(c,"minRank")&&u.setNode(s,{borderLeft:c.borderLeft[o],borderRight:c.borderRight[o]}))}),u}function i(n){for(var o;n.hasNode(o=r.uniqueId("_root")););return o}return Mi}var Oi,Ns;function sg(){if(Ns)return Oi;Ns=1,Oi=t;function t(r,e,i){let n={},o;i.forEach(a=>{let l=r.parent(a),u,s;for(;l;){if(u=r.parent(l),u?(s=n[u],n[u]=l):(s=o,o=l),s&&s!==l){e.setEdge(s,l);return}l=u}})}return Oi}var Fi,As;function lg(){if(As)return Fi;As=1;let t=eg(),r=tg(),e=og(),i=ag(),n=sg(),o=ft().Graph,a=Me();Fi=l;function l(d,f){if(f&&typeof f.customOrder=="function"){f.customOrder(d,l);return}let p=a.maxRank(d),h=u(d,a.range(1,p+1),"inEdges"),g=u(d,a.range(p-1,-1,-1),"outEdges"),m=t(d);if(c(d,m),f&&f.disableOptimalOrderHeuristic)return;let b=Number.POSITIVE_INFINITY,y;for(let w=0,v=0;v<4;++w,++v){s(w%2?h:g,w%4>=2),m=a.buildLayerMatrix(d);let k=r(d,m);k<b&&(v=0,y=Object.assign({},m),b=k)}c(d,y)}function u(d,f,p){return f.map(function(h){return i(d,h,p)})}function s(d,f){let p=new o;d.forEach(function(h){let g=h.graph().root,m=e(h,g,p,f);m.vs.forEach((b,y)=>h.node(b).order=y),n(h,p,m.vs)})}function c(d,f){Object.values(f).forEach(p=>p.forEach((h,g)=>d.node(h).order=g))}return Fi}var Di,Ms;function cg(){if(Ms)return Di;Ms=1;let t=ft().Graph,r=Me();Di={positionX:p,findType1Conflicts:e,findType2Conflicts:i,addConflict:o,hasConflict:a,verticalAlignment:l,horizontalCompaction:u,alignCoordinates:d,findSmallestWidthAlignment:c,balance:f};function e(m,b){let y={};function w(v,k){let _=0,C=0,S=v.length,P=k[k.length-1];return k.forEach((T,x)=>{let $=n(m,T),O=$?m.node($).order:S;($||T===P)&&(k.slice(C,x+1).forEach(N=>{m.predecessors(N).forEach(A=>{let L=m.node(A),V=L.order;(V<_||O<V)&&!(L.dummy&&m.node(N).dummy)&&o(y,A,N)})}),C=x+1,_=O)}),k}return b.length&&b.reduce(w),y}function i(m,b){let y={};function w(k,_,C,S,P){let T;r.range(_,C).forEach(x=>{T=k[x],m.node(T).dummy&&m.predecessors(T).forEach($=>{let O=m.node($);O.dummy&&(O.order<S||O.order>P)&&o(y,$,T)})})}function v(k,_){let C=-1,S,P=0;return _.forEach((T,x)=>{if(m.node(T).dummy==="border"){let $=m.predecessors(T);$.length&&(S=m.node($[0]).order,w(_,P,x,C,S),P=x,C=S)}w(_,P,_.length,S,k.length)}),_}return b.length&&b.reduce(v),y}function n(m,b){if(m.node(b).dummy)return m.predecessors(b).find(y=>m.node(y).dummy)}function o(m,b,y){if(b>y){let v=b;b=y,y=v}let w=m[b];w||(m[b]=w={}),w[y]=!0}function a(m,b,y){if(b>y){let w=b;b=y,y=w}return!!m[b]&&Object.hasOwn(m[b],y)}function l(m,b,y,w){let v={},k={},_={};return b.forEach(C=>{C.forEach((S,P)=>{v[S]=S,k[S]=S,_[S]=P})}),b.forEach(C=>{let S=-1;C.forEach(P=>{let T=w(P);if(T.length){T=T.sort(($,O)=>_[$]-_[O]);let x=(T.length-1)/2;for(let $=Math.floor(x),O=Math.ceil(x);$<=O;++$){let N=T[$];k[P]===P&&S<_[N]&&!a(y,P,N)&&(k[N]=P,k[P]=v[P]=v[N],S=_[N])}}})}),{root:v,align:k}}function u(m,b,y,w,v){let k={},_=s(m,b,y,v),C=v?"borderLeft":"borderRight";function S(x,$){let O=_.nodes(),N=O.pop(),A={};for(;N;)A[N]?x(N):(A[N]=!0,O.push(N),O=O.concat($(N))),N=O.pop()}function P(x){k[x]=_.inEdges(x).reduce(($,O)=>Math.max($,k[O.v]+_.edge(O)),0)}function T(x){let $=_.outEdges(x).reduce((N,A)=>Math.min(N,k[A.w]-_.edge(A)),Number.POSITIVE_INFINITY),O=m.node(x);$!==Number.POSITIVE_INFINITY&&O.borderType!==C&&(k[x]=Math.max(k[x],$))}return S(P,_.predecessors.bind(_)),S(T,_.successors.bind(_)),Object.keys(w).forEach(x=>k[x]=k[y[x]]),k}function s(m,b,y,w){let v=new t,k=m.graph(),_=h(k.nodesep,k.edgesep,w);return b.forEach(C=>{let S;C.forEach(P=>{let T=y[P];if(v.setNode(T),S){var x=y[S],$=v.edge(x,T);v.setEdge(x,T,Math.max(_(m,P,S),$||0))}S=P})}),v}function c(m,b){return Object.values(b).reduce((y,w)=>{let v=Number.NEGATIVE_INFINITY,k=Number.POSITIVE_INFINITY;Object.entries(w).forEach(([C,S])=>{let P=g(m,C)/2;v=Math.max(S+P,v),k=Math.min(S-P,k)});const _=v-k;return _<y[0]&&(y=[_,w]),y},[Number.POSITIVE_INFINITY,null])[1]}function d(m,b){let y=Object.values(b),w=r.applyWithChunking(Math.min,y),v=r.applyWithChunking(Math.max,y);["u","d"].forEach(k=>{["l","r"].forEach(_=>{let C=k+_,S=m[C];if(S===b)return;let P=Object.values(S),T=w-r.applyWithChunking(Math.min,P);_!=="l"&&(T=v-r.applyWithChunking(Math.max,P)),T&&(m[C]=r.mapValues(S,x=>x+T))})})}function f(m,b){return r.mapValues(m.ul,(y,w)=>{if(b)return m[b.toLowerCase()][w];{let v=Object.values(m).map(k=>k[w]).sort((k,_)=>k-_);return(v[1]+v[2])/2}})}function p(m){let b=r.buildLayerMatrix(m),y=Object.assign(e(m,b),i(m,b)),w={},v;["u","d"].forEach(_=>{v=_==="u"?b:Object.values(b).reverse(),["l","r"].forEach(C=>{C==="r"&&(v=v.map(x=>Object.values(x).reverse()));let S=(_==="u"?m.predecessors:m.successors).bind(m),P=l(m,v,y,S),T=u(m,v,P.root,P.align,C==="r");C==="r"&&(T=r.mapValues(T,x=>-x)),w[_+C]=T})});let k=c(m,w);return d(w,k),f(w,m.graph().align)}function h(m,b,y){return(w,v,k)=>{let _=w.node(v),C=w.node(k),S=0,P;if(S+=_.width/2,Object.hasOwn(_,"labelpos"))switch(_.labelpos.toLowerCase()){case"l":P=-_.width/2;break;case"r":P=_.width/2;break}if(P&&(S+=y?P:-P),P=0,S+=(_.dummy?b:m)/2,S+=(C.dummy?b:m)/2,S+=C.width/2,Object.hasOwn(C,"labelpos"))switch(C.labelpos.toLowerCase()){case"l":P=C.width/2;break;case"r":P=-C.width/2;break}return P&&(S+=y?P:-P),P=0,S}}function g(m,b){return m.node(b).width}return Di}var zi,Os;function ug(){if(Os)return zi;Os=1;let t=Me(),r=cg().positionX;zi=e;function e(n){n=t.asNonCompoundGraph(n),i(n),Object.entries(r(n)).forEach(([o,a])=>n.node(o).x=a)}function i(n){let o=t.buildLayerMatrix(n),a=n.graph().ranksep,l=0;o.forEach(u=>{const s=u.reduce((c,d)=>{const f=n.node(d).height;return c>f?c:f},0);u.forEach(c=>n.node(c).y=l+s/2),l+=s+a})}return zi}var Li,Fs;function dg(){if(Fs)return Li;Fs=1;let t=Wm(),r=Hm(),e=Ym(),i=Me().normalizeRanks,n=Xm(),o=Me().removeEmptyRanks,a=Km(),l=Jm(),u=Qm(),s=lg(),c=ug(),d=Me(),f=ft().Graph;Li=p;function p(R,F){let z=F&&F.debugTiming?d.time:d.notime;z("layout",()=>{let q=z("  buildLayoutGraph",()=>S(R));z("  runLayout",()=>h(q,z,F)),z("  updateInputGraph",()=>g(R,q))})}function h(R,F,z){F("    makeSpaceForEdgeLabels",()=>P(R)),F("    removeSelfEdges",()=>Z(R)),F("    acyclic",()=>t.run(R)),F("    nestingGraph.run",()=>a.run(R)),F("    rank",()=>e(d.asNonCompoundGraph(R))),F("    injectEdgeLabelProxies",()=>T(R)),F("    removeEmptyRanks",()=>o(R)),F("    nestingGraph.cleanup",()=>a.cleanup(R)),F("    normalizeRanks",()=>i(R)),F("    assignRankMinMax",()=>x(R)),F("    removeEdgeLabelProxies",()=>$(R)),F("    normalize.run",()=>r.run(R)),F("    parentDummyChains",()=>n(R)),F("    addBorderSegments",()=>l(R)),F("    order",()=>s(R,z)),F("    insertSelfEdges",()=>G(R)),F("    adjustCoordinateSystem",()=>u.adjust(R)),F("    position",()=>c(R)),F("    positionSelfEdges",()=>J(R)),F("    removeBorderNodes",()=>V(R)),F("    normalize.undo",()=>r.undo(R)),F("    fixupEdgeLabelCoords",()=>A(R)),F("    undoCoordinateSystem",()=>u.undo(R)),F("    translateGraph",()=>O(R)),F("    assignNodeIntersects",()=>N(R)),F("    reversePoints",()=>L(R)),F("    acyclic.undo",()=>t.undo(R))}function g(R,F){R.nodes().forEach(z=>{let q=R.node(z),ee=F.node(z);q&&(q.x=ee.x,q.y=ee.y,q.rank=ee.rank,F.children(z).length&&(q.width=ee.width,q.height=ee.height))}),R.edges().forEach(z=>{let q=R.edge(z),ee=F.edge(z);q.points=ee.points,Object.hasOwn(ee,"x")&&(q.x=ee.x,q.y=ee.y)}),R.graph().width=F.graph().width,R.graph().height=F.graph().height}let m=["nodesep","edgesep","ranksep","marginx","marginy"],b={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},y=["acyclicer","ranker","rankdir","align"],w=["width","height","rank"],v={width:0,height:0},k=["minlen","weight","width","height","labeloffset"],_={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},C=["labelpos"];function S(R){let F=new f({multigraph:!0,compound:!0}),z=de(R.graph());return F.setGraph(Object.assign({},b,ue(z,m),d.pick(z,y))),R.nodes().forEach(q=>{let ee=de(R.node(q));const I=ue(ee,w);Object.keys(v).forEach(j=>{I[j]===void 0&&(I[j]=v[j])}),F.setNode(q,I),F.setParent(q,R.parent(q))}),R.edges().forEach(q=>{let ee=de(R.edge(q));F.setEdge(q,Object.assign({},_,ue(ee,k),d.pick(ee,C)))}),F}function P(R){let F=R.graph();F.ranksep/=2,R.edges().forEach(z=>{let q=R.edge(z);q.minlen*=2,q.labelpos.toLowerCase()!=="c"&&(F.rankdir==="TB"||F.rankdir==="BT"?q.width+=q.labeloffset:q.height+=q.labeloffset)})}function T(R){R.edges().forEach(F=>{let z=R.edge(F);if(z.width&&z.height){let q=R.node(F.v),I={rank:(R.node(F.w).rank-q.rank)/2+q.rank,e:F};d.addDummyNode(R,"edge-proxy",I,"_ep")}})}function x(R){let F=0;R.nodes().forEach(z=>{let q=R.node(z);q.borderTop&&(q.minRank=R.node(q.borderTop).rank,q.maxRank=R.node(q.borderBottom).rank,F=Math.max(F,q.maxRank))}),R.graph().maxRank=F}function $(R){R.nodes().forEach(F=>{let z=R.node(F);z.dummy==="edge-proxy"&&(R.edge(z.e).labelRank=z.rank,R.removeNode(F))})}function O(R){let F=Number.POSITIVE_INFINITY,z=0,q=Number.POSITIVE_INFINITY,ee=0,I=R.graph(),j=I.marginx||0,se=I.marginy||0;function ke(be){let fe=be.x,De=be.y,tt=be.width,Ee=be.height;F=Math.min(F,fe-tt/2),z=Math.max(z,fe+tt/2),q=Math.min(q,De-Ee/2),ee=Math.max(ee,De+Ee/2)}R.nodes().forEach(be=>ke(R.node(be))),R.edges().forEach(be=>{let fe=R.edge(be);Object.hasOwn(fe,"x")&&ke(fe)}),F-=j,q-=se,R.nodes().forEach(be=>{let fe=R.node(be);fe.x-=F,fe.y-=q}),R.edges().forEach(be=>{let fe=R.edge(be);fe.points.forEach(De=>{De.x-=F,De.y-=q}),Object.hasOwn(fe,"x")&&(fe.x-=F),Object.hasOwn(fe,"y")&&(fe.y-=q)}),I.width=z-F+j,I.height=ee-q+se}function N(R){R.edges().forEach(F=>{let z=R.edge(F),q=R.node(F.v),ee=R.node(F.w),I,j;z.points?(I=z.points[0],j=z.points[z.points.length-1]):(z.points=[],I=ee,j=q),z.points.unshift(d.intersectRect(q,I)),z.points.push(d.intersectRect(ee,j))})}function A(R){R.edges().forEach(F=>{let z=R.edge(F);if(Object.hasOwn(z,"x"))switch((z.labelpos==="l"||z.labelpos==="r")&&(z.width-=z.labeloffset),z.labelpos){case"l":z.x-=z.width/2+z.labeloffset;break;case"r":z.x+=z.width/2+z.labeloffset;break}})}function L(R){R.edges().forEach(F=>{let z=R.edge(F);z.reversed&&z.points.reverse()})}function V(R){R.nodes().forEach(F=>{if(R.children(F).length){let z=R.node(F),q=R.node(z.borderTop),ee=R.node(z.borderBottom),I=R.node(z.borderLeft[z.borderLeft.length-1]),j=R.node(z.borderRight[z.borderRight.length-1]);z.width=Math.abs(j.x-I.x),z.height=Math.abs(ee.y-q.y),z.x=I.x+z.width/2,z.y=q.y+z.height/2}}),R.nodes().forEach(F=>{R.node(F).dummy==="border"&&R.removeNode(F)})}function Z(R){R.edges().forEach(F=>{if(F.v===F.w){var z=R.node(F.v);z.selfEdges||(z.selfEdges=[]),z.selfEdges.push({e:F,label:R.edge(F)}),R.removeEdge(F)}})}function G(R){var F=d.buildLayerMatrix(R);F.forEach(z=>{var q=0;z.forEach((ee,I)=>{var j=R.node(ee);j.order=I+q,(j.selfEdges||[]).forEach(se=>{d.addDummyNode(R,"selfedge",{width:se.label.width,height:se.label.height,rank:j.rank,order:I+ ++q,e:se.e,label:se.label},"_se")}),delete j.selfEdges})})}function J(R){R.nodes().forEach(F=>{var z=R.node(F);if(z.dummy==="selfedge"){var q=R.node(z.e.v),ee=q.x+q.width/2,I=q.y,j=z.x-ee,se=q.height/2;R.setEdge(z.e,z.label),R.removeNode(F),z.label.points=[{x:ee+2*j/3,y:I-se},{x:ee+5*j/6,y:I-se},{x:ee+j,y:I},{x:ee+5*j/6,y:I+se},{x:ee+2*j/3,y:I+se}],z.label.x=z.x,z.label.y=z.y}})}function ue(R,F){return d.mapValues(d.pick(R,F),Number)}function de(R){var F={};return R&&Object.entries(R).forEach(([z,q])=>{typeof z=="string"&&(z=z.toLowerCase()),F[z]=q}),F}return Li}var ji,Ds;function pg(){if(Ds)return ji;Ds=1;let t=Me(),r=ft().Graph;ji={debugOrdering:e};function e(i){let n=t.buildLayerMatrix(i),o=new r({compound:!0,multigraph:!0}).setGraph({});return i.nodes().forEach(a=>{o.setNode(a,{label:a}),o.setParent(a,"layer"+i.node(a).rank)}),i.edges().forEach(a=>o.setEdge(a.v,a.w,{},a.name)),n.forEach((a,l)=>{let u="layer"+l;o.setNode(u,{rank:"same"}),a.reduce((s,c)=>(o.setEdge(s,c,{style:"invis"}),c))}),o}return ji}var Ui,zs;function fg(){return zs||(zs=1,Ui="1.1.5"),Ui}var Bi,Ls;function hg(){return Ls||(Ls=1,Bi={graphlib:ft(),layout:dg(),debug:pg(),util:{time:Me().time,notime:Me().notime},version:fg()}),Bi}var mg=hg();const js=Nn(mg);function gg(t){let r=U(M),e=ne(M),i=["let registry: EcsRegistry | undefined;","let world: EcsWorld | undefined;","","export async function withWorld<A>(registry_: EcsRegistry, world_: EcsWorld, k: () => Promise<A>): Promise<A> {","  let oldRegistry = registry;","  let oldWorld = world;","  let result: A;","  try {","    registry = registry_;","    world = world_;","    result = await k();","  } finally {","    registry = oldRegistry;","    world = oldWorld;","  }","  return result;","}",""];for(let n of t.nodeRegistry.nodeTypes){let o=n.componentType.typeSchema;if(o.type!="Object")continue;let a=[],l=[],u=[];for(let s of Object.keys(o.properties)){let c=o.properties[s];ko(c,r)?l.push(s):ko(c,e)?u.push(s):a.push(s)}i.push(`export function ${vu(n.componentType.typeName)}(params: { ${[...a.map(s=>`${s}: any`),...l.map(s=>`${s}?: any`)].join(", ")} }) {`,"  if (world == undefined) {",'    throw new Error("must use with_world(...)");',"  }","  let entity = world.createEntity([",`    registry.componentTypeMap.get("${n.componentType.typeName}")!.create({`,[...a.map(s=>`      ${s}: params.${s}`),...l.map(s=>`      ${s}: params.${s} == undefined ? undefined : { target: params.${s}.target, pin: params.${s}.pin, }`),...u.map(s=>`      ${s}: []`)].join(`,\r
`),"    }),","  ]);",`${u.length==0?"}":["  return {",...u.length==1?["    target: entity,",`    pin: "${u[0]}",`]:u.map(s=>`    { target: entity, pin: "${s}", },`),"  };","}"].join(`\r
`)}`,"")}return i.join(`\r
`)}function yg(t){let{nodesSystem:r}=t,e=0,i=()=>`x${e++}`,n=new Map,o=c=>n.get(c.nodeId)?.get(c.outPinName),a=c=>{let d=n.get(c.nodeId);d==null&&(d=new Map,n.set(c.nodeId,d)),d.set(c.outPinName,c.varName)},l=[...r.nodes()],u=[],s=['import * as $ from "prelude";',""];for(;;){let c=l.pop();if(c==null){let v=l;if(l=u,u=v,c=l.pop(),c==null)break}let d=!0;for(let v of c.node.inputPins?.()??[]){let k=v.source();if(k!=null&&r.lookupNodeById(k.target)!=null&&o({nodeId:k.target,outPinName:k.pin})==null){d=!1;break}}if(!d){u.push(c);continue}let f={},p=new Set;for(let v of c.node.inputPins?.()??[]){p.add(v.name);let k=v.source();if(k==null)continue;let _=o({nodeId:k.target,outPinName:k.pin});f[v.name]=_}let h={},g=c.node.outputPins?.()??[],m=new Set;for(let v of g){m.add(v.name);let k=i();h[v.name]=k,a({nodeId:c.node.nodeParams.entity,outPinName:v.name,varName:k})}let b={};{let v=c.node.type.componentType.typeSchema;if(v.type=="Object")for(let k of Object.keys(v.properties)){if(p.has(k)||m.has(k))continue;let _=v.properties[k],C=Ze(_,c.node.nodeParams.state[k]);b[k]=JSON.stringify(C)}}let y=0;{let v={};for(let[k,_]of Object.entries(b))v[k]=_,++y;for(let[k,_]of Object.entries(f))v[k]=_,++y;f=v}let w;g.length==0?w=void 0:g.length==1?w=Object.values(h)[0]:w=Object.entries(h).map(([v,k])=>`${v}: ${k}`).join(", "),s.push(`${w==null?"":`let ${g.length>1?"{ ":""}${w??""}${g.length>1?" }":""} = `}$.${vu(c.node.type.componentType.typeName)}(${y==0?"{}":`{ ${Object.entries(f).map(([v,k])=>`${v}: ${k}`).join(", ")}, }`});`)}return s.join(`\r
`)}function vu(t){return t.slice(0,1).toLowerCase()+t.slice(1)}function ko(t,r){if(t===r)return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;const e=Object.keys(t),i=Object.keys(r);if(e.length!==i.length)return!1;for(const n of e)if(!i.includes(n)||!ko(t[n],r[n]))return!1;return!0}var bg=Y('<button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-rotate">'),vg=Y("<svg><g>"),Us=Y("<div>"),wg=Y('<div><div><div><button class="btn btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-t"></i></button><button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-upload"></i></button><input type=file hidden><button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-download"></i></button><button class="btn btn-primary"style=margin-left:5px;>Add Node</button><button class="btn btn-primary"style=margin-left:5px;>Delete</button><label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Freeze Pan/Zoom</label></div><div>'),kg=Y('<details class=dropdown><summary class="btn btn-primary"><i class="fa-solid fa-bars"></i></summary><div tabindex=-1><div class="dropdown-content bg-base-100 rounded-box z-1 w-52 p-2 shadow-sm"><ul class="menu w-full"><li><a><div>Format</div></a></li></ul><hr><ul class="menu w-full"><li><a>Convert To '),Bs=Y("<div><div>");const xg=We(()=>Ge(()=>import("./TypeScriptUI-CYrtd8I9.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));function wu(t){let[r,e]=Oo(t,["onInit","componentRegistry","nodeRegistry","world","menu","toolbar"]),i=r.nodeRegistry,[n,o]=je({pan:K.zero,scale:1,mousePos:void 0,mkMode:()=>new Va(v),showCode:!1,makeSound:!1,freezePanZoom:!1,filename:"node-graph",inTypeScriptView:!1,typeScriptSource:""}),a=new dm,l=gg({nodeRegistry:r.nodeRegistry}),u,[s,c]=oe(K.zero);Sn(()=>{{let j=u.getBoundingClientRect();o("pan",K.create(0,-j.height))}let I=new ResizeObserver(()=>{let j=u.getBoundingClientRect();queueMicrotask(()=>{c(K.create(j.width,j.height))})});I.observe(u),Ne(()=>{I.unobserve(u),I.disconnect()})});let d=E(()=>`scale(${n.scale}) translate(${-n.pan.x} ${-n.pan.y})`),f=I=>{o("mkMode",()=>I)},p=I=>K.create(n.pan.x+I.x/n.scale,-(n.pan.y+I.y/n.scale)),h=I=>K.create((I.x-n.pan.x)*n.scale,(-I.y-n.pan.y)*n.scale),g=new wo({nodeRegistry:i,world:()=>r.world}),m=new pu({mousePos:()=>n.mousePos,screenPtToWorldPt:p,worldPtToScreenPt:h,nodes:()=>g.nodes()}),b=new gt,y=new gt,w=new vo({nodes:()=>g.nodes(),lookupNodeById:I=>g.lookupNodeById(I),highlightedEntitySet:b,selectedEntitySet:y}),v={undoManager:a,nodeRegistry:i,nodesSystem:g,pickingSystem:m,mousePos:()=>n.mousePos,screenPtToWorldPt:p,worldPtToScreenPt:h,world:()=>r.world,onDone:()=>{f(()=>new Va(v))},pan:()=>n.pan,setPan:I=>o("pan",I),scale:()=>n.scale,setScale:I=>o("scale",I),setMode:f},k=E(()=>n.mkMode()),_=um({pan:()=>n.pan,setPan:I=>o("pan",I),scale:()=>n.scale,setScale:I=>o("scale",I),setPointerCapture:I=>u.setPointerCapture(I),releasePointerCapture:I=>u.releasePointerCapture(I),disableOneFingerPan:E(()=>(k().disablePan?.()??!1)||n.freezePanZoom||g.disablePan())}),C=E(()=>k().highlightedObjectsById?.()??[]),S=E(()=>k().selectedObjectsById?.()??[]);ve(zt(C,I=>{b.add(I),Ne(()=>{b.delete(I)})})),ve(zt(S,I=>{y.add(I),Ne(()=>{y.delete(I)})}));let P=()=>{k().click?.()},T,x=!1,$=I=>{let j=u.getBoundingClientRect();o("mousePos",K.create(I.clientX-j.left,I.clientY-j.top)),k().dragStart?.(),x=!0,_.onPointerDown(I)},O=I=>{_.onPointerUp(I),_.numTouches()==0&&P(),x&&k().dragEnd?.(),window.clearTimeout(T),T=void 0},N=I=>{_.onPointerCancel(I)},A=I=>{let j=u.getBoundingClientRect();o("mousePos",K.create(I.clientX-j.left,I.clientY-j.top)),_.onPointerMove(I)},L=I=>{_.numTouches()==0&&o("mousePos",void 0)},V=I=>{_.onWheel(I)},Z=()=>{for(let I of S())r.world.destroyEntity(I);y.clear()},[G,J]=oe();r.onInit({nodesSystem:g,closeMenu:()=>{let I=G();I!=null&&(I.open=!1)}});let[ue,de]=oe();const R=async I=>{let j=await I.text().then(fe=>JSON.parse(fe)),se=Lt.fromJson(r.componentRegistry,j);if(se.type=="Err"){alert(se.message);return}let ke=se.value;Be(()=>{let fe=r.world;for(let De of[...fe.entities()])fe.destroyEntity(De);for(let De of ke.entities()){let tt=ke.getComponents(De);fe.createEntityWithId(De,tt)}});let be=I.name;be.endsWith(".json")&&(be=be.slice(0,be.length-5)),o("filename",be)},F=()=>{let I=JSON.stringify(r.world.toJson(),void 0,2),j=new Blob([I],{type:"application/json"});hc.saveAs(j,`${n.filename}.json`)},z=()=>{let I=new js.graphlib.Graph;I.setGraph({rankdir:"LR"}),I.setDefaultEdgeLabel(()=>({}));for(let j of g.nodes())I.setNode(j.node.nodeParams.entity,{label:j.node.nodeParams.entity,width:j.renderSize()?.x??100,height:j.renderSize()?.y??100});for(let j of g.nodes())for(let se of j.node.inputPins?.()??[]){let ke=se.source();ke!=null&&I.setEdge(ke.target,j.node.nodeParams.entity)}js.layout(I);for(let j of I.nodes()){let se=I.node(j),ke=g.lookupNodeById(j);ke?.setSpace(Se.create(K.create(se.x,-se.y),_e.rot0))}};let[q,ee]=oe();return(()=>{var I=wg(),j=I.firstChild,se=j.firstChild,ke=se.firstChild,be=ke.nextSibling,fe=be.nextSibling,De=fe.nextSibling,tt=De.nextSibling,Ee=tt.nextSibling,st=Ee.nextSibling,It=st.firstChild,lt=se.nextSibling;Ao(I,e,!1,!0),j.style.setProperty("width","100%"),j.style.setProperty("height","100%"),j.style.setProperty("display","flex"),j.style.setProperty("flex-direction","column"),te(se,()=>ye(()=>{let W,ce,xe=!1;return Sn(()=>{J(W)}),(()=>{var $e=kg(),rt=$e.firstChild,Ke=rt.nextSibling,Ut=Ke.firstChild,xt=Ut.firstChild,_t=xt.firstChild,en=_t.firstChild,yr=xt.nextSibling,br=yr.nextSibling,vr=br.firstChild,St=vr.firstChild,$_=St.firstChild;$e.$$mouseout=()=>{xe=!1},$e.$$mouseover=()=>{xe=!0},$e.addEventListener("toggle",lf=>{lf.currentTarget.open&&ce.focus()});var ua=W;typeof ua=="function"?Ce(ua,$e):W=$e,Ke.$$focusout=()=>{xe||(W.open=!1)};var da=ce;return typeof da=="function"?Ce(da,Ke):ce=Ke,te(xt,()=>r.menu,_t),en.$$click=()=>{z(),W.open=!1},St.$$click=()=>{n.inTypeScriptView?(o("inTypeScriptView",!1),W.open=!1):(Be(()=>{o("inTypeScriptView",!0),o("typeScriptSource",yg({nodesSystem:g}))}),W.open=!1)},te(St,()=>n.inTypeScriptView?"Node Graph":"TypeScript",null),$e})()}),ke),ke.$$click=()=>{let W=window.prompt("Enter new filename:",n.filename);W!=null&&(W=W.trim(),W!=""&&o("filename",W))},be.$$click=()=>ue()?.click(),fe.addEventListener("change",W=>{let ce=W.currentTarget.files;if(ce?.length!=1)return;let xe=ce[0];R(xe),W.currentTarget.value=""});var B=de;return typeof B=="function"?Ce(B,fe):de=fe,De.$$click=()=>F(),tt.$$click=()=>f(()=>new Rm(v)),Ee.$$click=()=>{Z()},te(se,D(ge,{get when(){return n.inTypeScriptView},get children(){var W=bg();return W.$$click=()=>{let ce=q();ce?.refresh()},W}}),st),te(se,()=>r.toolbar,st),It.addEventListener("change",W=>o("freezePanZoom",W.currentTarget.checked)),lt.style.setProperty("flex-grow","1"),lt.style.setProperty("position","relative"),te(lt,D(An,{get children(){return[D($t,{get when(){return!n.inTypeScriptView},get children(){var W=vg(),ce=W.firstChild;W.$$pointerout=L,W.addEventListener("wheel",V),W.$$pointermove=A,W.addEventListener("pointercancel",N),W.$$pointerup=O,W.$$pointerdown=$;var xe=u;return typeof xe=="function"?Ce(xe,W):u=W,W.style.setProperty("position","absolute"),W.style.setProperty("left","0"),W.style.setProperty("top","0"),W.style.setProperty("width","100%"),W.style.setProperty("height","100%"),W.style.setProperty("touch-action","none"),W.style.setProperty("user-select","none"),te(ce,D(w.Render,{}),null),te(ce,D(ge,{get when(){return k().overlaySvg},keyed:!0,children:$e=>D($e,{})}),null),le(()=>ae(ce,"transform",d())),W}}),D($t,{get when(){return n.inTypeScriptView},get children(){var W=Us();return W.style.setProperty("position","absolute"),W.style.setProperty("left","0"),W.style.setProperty("top","0"),W.style.setProperty("width","100%"),W.style.setProperty("height","100%"),W.style.setProperty("overflow","auto"),te(W,D(xg,{get registry(){return r.componentRegistry},preludeSource:l,get initSource(){return n.typeScriptSource},onInit:ce=>{ee(ce)},onWorldUpdate:ce=>{Be(()=>{let xe=r.world;for(let $e of[...xe.entities()])xe.destroyEntity($e);for(let $e of ce.entities()){let rt=ce.getComponents($e);xe.createEntityWithId($e,[...rt,Ae.create({transform:Se.identity})])}for(let $e of g.nodes())for(let rt of $e.node.inputPins?.()??[]){let Ke=rt.source();if(Ke==null)continue;let Ut=g.lookupNodeById(Ke.target);if(Ut==null)continue;let xt=Ut.node.outputPins?.()??[];for(let _t of xt)if(_t.name==Ke.pin){_t.setSinks([..._t.sinks(),{target:$e.node.nodeParams.entity,pin:rt.name}]);break}}})}})),W}})]}}),null),te(lt,D(ge,{get when(){return k().sideForm?.()==null},get children(){return D(ge,{get when(){return k().instructions},keyed:!0,children:W=>(()=>{var ce=Us();return ce.style.setProperty("position","absolute"),ce.style.setProperty("left","0"),ce.style.setProperty("top","0"),te(ce,D(W,{})),ce})()})}}),null),te(lt,D(ge,{get when(){return k().sideForm?.()},keyed:!0,children:W=>(()=>{var ce=Bs(),xe=ce.firstChild;return ce.style.setProperty("position","absolute"),ce.style.setProperty("left","0"),ce.style.setProperty("top","0"),ce.style.setProperty("height","100%"),ce.style.setProperty("display","flex"),ce.style.setProperty("flex-direction","row"),ce.style.setProperty("pointer-events","none"),xe.style.setProperty("background","black"),xe.style.setProperty("pointer-events","auto"),te(xe,D(W,{})),te(ce,D(ge,{get when(){return k().instructions},keyed:!0,children:$e=>(()=>{var rt=Bs(),Ke=rt.firstChild;return Ke.style.setProperty("pointer-events","auto"),te(Ke,D($e,{})),rt})()}),null),ce})()}),null),te(lt,D(ge,{get when(){return k().overlayHtmlUi},keyed:!0,children:W=>D(W,{})}),null),le(()=>Ee.disabled=y.size==0),le(()=>It.checked=n.freezePanZoom),I})()}Oe(["click","pointerdown","pointerup","pointermove","pointerout","mouseover","mouseout","focusout"]);const _g=H({frequency:U(M),amplitude:U(M),centre:U(M),out:ne(M)}),Wo=new re({typeName:"SineWave",typeSchema:_g});let Sg=class{nextFieldIdx=0;fieldDeclarations="";constructorCode="";messageHandlers=new Map;globalCode="";code_="";postCode="";allocField(r){let e=`x${this.nextFieldIdx++}`;return this.fieldDeclarations+=`  ${e} = ${r};\r
`,`this.${e}`}allocFieldNoDecl(){return`this.${`x${this.nextFieldIdx++}`}`}addDeclToExistingForField(r,e){r.startsWith("this.")&&(r=r.substring(5)),this.fieldDeclarations+=`  ${r} = ${e};\r
`}insertConstructorCode(r){this.constructorCode+=r.map(e=>`      ${e}\r
`).join("")}insertMessageHandlerCode(r,e){this.messageHandlers.get(r);let i=e.map(n=>`        ${n}\r
`).join("");this.messageHandlers.set(r,i)}insertGlobalCode(r){this.globalCode+=r.map(e=>`${e}\r
`).join("")}insertCode(r){this.code_+=r.map(e=>`      ${e}\r
`).join("")}insertPostCode(r){this.postCode+=r.map(e=>`      ${e}\r
`).join("")}get code(){let r="";return this.messageHandlers.size!=0?r=[`    this.port.onmessage = (e) => {\r
`,`      let data = e.data;\r
`,...this.messageHandlers.entries().map(([e,i],n)=>{let o,a=n==this.messageHandlers.size-1;return n==0?o="      if":o="      } else if",`${o} (data.type == "${e}") {\r
        let params = data.params;\r
${i}${a?`      }\r
`:""}`}),`    };\r
`].join(""):r="",[this.globalCode,"class CompiledGraphAudioWorkletProcessor extends AudioWorkletProcessor {","  runningEffectsHead = null;","  runningEffectsTail = null;","  variables = {};",this.fieldDeclarations,"  constructor(options) {","    super();",`${this.constructorCode}${r}  }`,"","  insertRunningEffect(effect) {","    if (this.runningEffectsTail == null) {","      this.runningEffectsHead = effect;","      this.runningEffectsTail = effect;","    } else {","      this.runningEffectsTail.next = effect;","      effect.prev = this.runningEffectsTail;","      this.runningEffectsTail = effect;","    }","  }","","  removeRunningEffect(effect) {","    if (effect.prev != null) {","      effect.prev.next = effect.next;","    }","    if (effect.next != null) {","      effect.next.prev = effect.prev;","    }","    if (this.runningEffectsHead == effect) {","      this.runningEffectsHead = effect.next;","    }","    if (this.runningEffectsTail == effect) {","      this.runningEffectsTail = effect.prev;","    }","    effect.prev = null;","    effect.next = null;","  }","","  process(inputs, outputs, parameters) {","    let output = outputs[0][0];","    debugger;","    for (let i = 0; i < output.length; ++i) {","      let result = 0.0;",`${this.code_}${this.postCode}      let effect = this.runningEffectsHead;`,"      while (effect != null) {","        let isDone = effect.update();","        if (isDone) {","          this.removeRunningEffect(effect);","          for (let onDone of effect.onDone) {","            onDone();","          }","        }","        effect = effect.next;","      }","      output[i] = result;","    }","    return true;","  }","}","",'registerProcessor("compiled-graph-audio-worklet-processor", CompiledGraphAudioWorkletProcessor);'].join(`\r
`)}};function Cg(t,r){let e=new Map,i=[t];for(;;){let n=i.pop();if(n==null)break;if(e.has(n))continue;let o={};for(let l of Object.entries(n.inputs))o[l[0]]={...l[1]};let a={id:0,inputs:o,outputs:{},height:n.height,node:n.node};r(a),e.set(n,a);for(let l of Object.values(n.outputs))for(let u of l)i.push(u.node)}for(let n of e.values())for(let o of Object.entries(n.inputs)){let a=e.get(o[1].node);a!=null&&(o[1].node=a)}for(let n of e.values())for(let[o,{node:a,pin:l}]of Object.entries(n.inputs)){let u=a.outputs[l],s={node:n,pin:o};u==null?(u=[s],a.outputs[l]=u):u.push(s)}return e.get(t)}function Pg(t){let r=t.nodesSystem,e=[];{let a=new Map;for(let l of r.nodes()){let u={id:0,inputs:{},outputs:{},height:0,node:l};a.set(l.node.nodeParams.entity,u),e.push(u)}for(let l of a.values())for(let u of l.node.node.inputPins?.()??[]){let s=u.source();if(s==null)continue;let c=a.get(s.target);c!=null&&(l.inputs[u.name]={node:c,pin:s.pin})}}for(let a of e)for(let[l,{node:u,pin:s}]of Object.entries(a.inputs)){let c=u.outputs[s],d={node:a,pin:l};c==null?(c=[d],u.outputs[s]=c):c.push(d)}let i=[];{let a=new Set;for(;;){let l=!1;qs(e);for(let u of e){let s=i[u.height];s==null?(s=[u],i[u.height]=s):s.push(u)}for(let u=0;u<i.length;++u){let s=i[u]??[];for(let c of s){if(a.has(c))continue;let d=c.node.node;if(d.ext.macro!=null){d.ext.macro(c,f=>e.push(f)),a.add(c),l=!0;break}}if(l)break}if(!l)break}}qs(e);{let a=0;for(let l of e)l.id=a++}let n=new Sg;{let a=new Set;for(let l of r.nodes()){let u=l.node.type;a.has(u.componentType.typeName)||(a.add(u.componentType.typeName),u.ext.generateInitOnceCode?.({ctx:n}))}}i.splice(0,i.length);for(let a of e){let l=i[a.height];l==null?(l=[a],i[a.height]=l):l.push(a)}let o=new Map;for(let a=0;a<i.length;++a){let l=i[a]??[];for(let u of l){let s=u.node.node,c=new Map;for(let d of Object.entries(u.inputs)){let f=o.get(d[1].node)?.get(d[1].pin);f!=null?c.set(d[0],f):c.set(d[0],`this.n_${d[1].node.id}_${d[1].pin}`)}if(s.ext.generateCode!=null){let d=s.ext.generateCode({ctx:n,inputAtoms:c,codeGenNodeId:u.id});if(d.length==1){let f=d[0].outputAtoms;o.set(u,f)}}}}return n.code}function qs(t){let r=new Set,e=[...t],i=[];for(;;){let n=e.pop();if(n==null){let l=e;if(e=i,i=l,n=e.pop(),n==null)break}if(r.has(n))continue;let o=!0;for(let[l,{node:u}]of Object.entries(n.inputs))if(!(n.node.node.inputPins?.().find(s=>s.name==l)?.isEffectPin??!1)&&!r.has(u)){o=!1;break}if(!o){i.push(n);continue}let a=0;for(let[,{node:l,pin:u}]of Object.entries(n.inputs))(l.node.node.outputPins?.().find(({name:s})=>s==u)?.isEffectPin??!1)||l.height>=a&&(a=l.height+1);n.height=a,r.add(n)}}var qt={},sn={},qi,Vs;function Tg(){if(Vs)return qi;Vs=1;function t(n){var o=new i(n),a=o.readChunk();if(a.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+a.id+"'";for(var l=r(a.data),u=[],s=0;!o.eof()&&s<l.numTracks;s++){var c=o.readChunk();if(c.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+c.id+"'";var d=e(c.data);u.push(d)}return{header:l,tracks:u}}function r(n){var o=new i(n),a=o.readUInt16(),l=o.readUInt16(),u={format:a,numTracks:l},s=o.readUInt16();return s&32768?(u.framesPerSecond=256-(s>>8),u.ticksPerFrame=s&255):u.ticksPerBeat=s,u}function e(n){for(var o=new i(n),a=[];!o.eof();){var l=s();a.push(l)}return a;var u;function s(){var c={};c.deltaTime=o.readVarInt();var d=o.readUInt8();if((d&240)===240)if(d===255){c.meta=!0;var f=o.readUInt8(),p=o.readVarInt();switch(f){case 0:if(c.type="sequenceNumber",p!==2)throw"Expected length for sequenceNumber event is 2, got "+p;return c.number=o.readUInt16(),c;case 1:return c.type="text",c.text=o.readString(p),c;case 2:return c.type="copyrightNotice",c.text=o.readString(p),c;case 3:return c.type="trackName",c.text=o.readString(p),c;case 4:return c.type="instrumentName",c.text=o.readString(p),c;case 5:return c.type="lyrics",c.text=o.readString(p),c;case 6:return c.type="marker",c.text=o.readString(p),c;case 7:return c.type="cuePoint",c.text=o.readString(p),c;case 32:if(c.type="channelPrefix",p!=1)throw"Expected length for channelPrefix event is 1, got "+p;return c.channel=o.readUInt8(),c;case 33:if(c.type="portPrefix",p!=1)throw"Expected length for portPrefix event is 1, got "+p;return c.port=o.readUInt8(),c;case 47:if(c.type="endOfTrack",p!=0)throw"Expected length for endOfTrack event is 0, got "+p;return c;case 81:if(c.type="setTempo",p!=3)throw"Expected length for setTempo event is 3, got "+p;return c.microsecondsPerBeat=o.readUInt24(),c;case 84:if(c.type="smpteOffset",p!=5)throw"Expected length for smpteOffset event is 5, got "+p;var h=o.readUInt8(),g={0:24,32:25,64:29,96:30};return c.frameRate=g[h&96],c.hour=h&31,c.min=o.readUInt8(),c.sec=o.readUInt8(),c.frame=o.readUInt8(),c.subFrame=o.readUInt8(),c;case 88:if(c.type="timeSignature",p!=2&&p!=4)throw"Expected length for timeSignature event is 4 or 2, got "+p;return c.numerator=o.readUInt8(),c.denominator=1<<o.readUInt8(),p===4?(c.metronome=o.readUInt8(),c.thirtyseconds=o.readUInt8()):(c.metronome=36,c.thirtyseconds=8),c;case 89:if(c.type="keySignature",p!=2)throw"Expected length for keySignature event is 2, got "+p;return c.key=o.readInt8(),c.scale=o.readUInt8(),c;case 127:return c.type="sequencerSpecific",c.data=o.readBytes(p),c;default:return c.type="unknownMeta",c.data=o.readBytes(p),c.metatypeByte=f,c}}else if(d==240){c.type="sysEx";var p=o.readVarInt();return c.data=o.readBytes(p),c}else if(d==247){c.type="endSysEx";var p=o.readVarInt();return c.data=o.readBytes(p),c}else throw"Unrecognised MIDI event type byte: "+d;else{var m;if(d&128)m=o.readUInt8(),u=d;else{if(u===null)throw"Running status byte encountered before status byte";m=d,d=u,c.running=!0}var b=d>>4;switch(c.channel=d&15,b){case 8:return c.type="noteOff",c.noteNumber=m,c.velocity=o.readUInt8(),c;case 9:var y=o.readUInt8();return c.type=y===0?"noteOff":"noteOn",c.noteNumber=m,c.velocity=y,y===0&&(c.byte9=!0),c;case 10:return c.type="noteAftertouch",c.noteNumber=m,c.amount=o.readUInt8(),c;case 11:return c.type="controller",c.controllerType=m,c.value=o.readUInt8(),c;case 12:return c.type="programChange",c.programNumber=m,c;case 13:return c.type="channelAftertouch",c.amount=m,c;case 14:return c.type="pitchBend",c.value=m+(o.readUInt8()<<7)-8192,c;default:throw"Unrecognised MIDI event type: "+b}}}}function i(n){this.buffer=n,this.bufferLen=this.buffer.length,this.pos=0}return i.prototype.eof=function(){return this.pos>=this.bufferLen},i.prototype.readUInt8=function(){var n=this.buffer[this.pos];return this.pos+=1,n},i.prototype.readInt8=function(){var n=this.readUInt8();return n&128?n-256:n},i.prototype.readUInt16=function(){var n=this.readUInt8(),o=this.readUInt8();return(n<<8)+o},i.prototype.readInt16=function(){var n=this.readUInt16();return n&32768?n-65536:n},i.prototype.readUInt24=function(){var n=this.readUInt8(),o=this.readUInt8(),a=this.readUInt8();return(n<<16)+(o<<8)+a},i.prototype.readInt24=function(){var n=this.readUInt24();return n&8388608?n-16777216:n},i.prototype.readUInt32=function(){var n=this.readUInt8(),o=this.readUInt8(),a=this.readUInt8(),l=this.readUInt8();return(n<<24)+(o<<16)+(a<<8)+l},i.prototype.readBytes=function(n){var o=this.buffer.slice(this.pos,this.pos+n);return this.pos+=n,o},i.prototype.readString=function(n){var o=this.readBytes(n);return String.fromCharCode.apply(null,o)},i.prototype.readVarInt=function(){for(var n=0;!this.eof();){var o=this.readUInt8();if(o&128)n+=o&127,n<<=7;else return n+o}return n},i.prototype.readChunk=function(){var n=this.readString(4),o=this.readUInt32(),a=this.readBytes(o);return{id:n,length:o,data:a}},qi=t,qi}var Vi,Gs;function Eg(){if(Gs)return Vi;Gs=1;function t(o,a){if(typeof o!="object")throw"Invalid MIDI data";a=a||{};var l=o.header||{},u=o.tracks||[],s,c=u.length,d=new n;for(r(d,l,c),s=0;s<c;s++)e(d,u[s],a);return d.buffer}function r(o,a,l){var u=a.format==null?1:a.format,s=128;a.timeDivision?s=a.timeDivision:a.ticksPerFrame&&a.framesPerSecond?s=-(a.framesPerSecond&255)<<8|a.ticksPerFrame&255:a.ticksPerBeat&&(s=a.ticksPerBeat&32767);var c=new n;c.writeUInt16(u),c.writeUInt16(l),c.writeUInt16(s),o.writeChunk("MThd",c.buffer)}function e(o,a,l){var u=new n,s,c=a.length,d=null;for(s=0;s<c;s++)(l.running===!1||!l.running&&!a[s].running)&&(d=null),d=i(u,a[s],d,l.useByte9ForNoteOff);o.writeChunk("MTrk",u.buffer)}function i(o,a,l,u){var s=a.type,c=a.deltaTime,d=a.text||"",f=a.data||[],p=null;switch(o.writeVarInt(c),s){case"sequenceNumber":o.writeUInt8(255),o.writeUInt8(0),o.writeVarInt(2),o.writeUInt16(a.number);break;case"text":o.writeUInt8(255),o.writeUInt8(1),o.writeVarInt(d.length),o.writeString(d);break;case"copyrightNotice":o.writeUInt8(255),o.writeUInt8(2),o.writeVarInt(d.length),o.writeString(d);break;case"trackName":o.writeUInt8(255),o.writeUInt8(3),o.writeVarInt(d.length),o.writeString(d);break;case"instrumentName":o.writeUInt8(255),o.writeUInt8(4),o.writeVarInt(d.length),o.writeString(d);break;case"lyrics":o.writeUInt8(255),o.writeUInt8(5),o.writeVarInt(d.length),o.writeString(d);break;case"marker":o.writeUInt8(255),o.writeUInt8(6),o.writeVarInt(d.length),o.writeString(d);break;case"cuePoint":o.writeUInt8(255),o.writeUInt8(7),o.writeVarInt(d.length),o.writeString(d);break;case"channelPrefix":o.writeUInt8(255),o.writeUInt8(32),o.writeVarInt(1),o.writeUInt8(a.channel);break;case"portPrefix":o.writeUInt8(255),o.writeUInt8(33),o.writeVarInt(1),o.writeUInt8(a.port);break;case"endOfTrack":o.writeUInt8(255),o.writeUInt8(47),o.writeVarInt(0);break;case"setTempo":o.writeUInt8(255),o.writeUInt8(81),o.writeVarInt(3),o.writeUInt24(a.microsecondsPerBeat);break;case"smpteOffset":o.writeUInt8(255),o.writeUInt8(84),o.writeVarInt(5);var h={24:0,25:32,29:64,30:96},g=a.hour&31|h[a.frameRate];o.writeUInt8(g),o.writeUInt8(a.min),o.writeUInt8(a.sec),o.writeUInt8(a.frame),o.writeUInt8(a.subFrame);break;case"timeSignature":o.writeUInt8(255),o.writeUInt8(88),o.writeVarInt(4),o.writeUInt8(a.numerator);var m=Math.floor(Math.log(a.denominator)/Math.LN2)&255;o.writeUInt8(m),o.writeUInt8(a.metronome),o.writeUInt8(a.thirtyseconds||8);break;case"keySignature":o.writeUInt8(255),o.writeUInt8(89),o.writeVarInt(2),o.writeInt8(a.key),o.writeUInt8(a.scale);break;case"sequencerSpecific":o.writeUInt8(255),o.writeUInt8(127),o.writeVarInt(f.length),o.writeBytes(f);break;case"unknownMeta":a.metatypeByte!=null&&(o.writeUInt8(255),o.writeUInt8(a.metatypeByte),o.writeVarInt(f.length),o.writeBytes(f));break;case"sysEx":o.writeUInt8(240),o.writeVarInt(f.length),o.writeBytes(f);break;case"endSysEx":o.writeUInt8(247),o.writeVarInt(f.length),o.writeBytes(f);break;case"noteOff":var b=u!==!1&&a.byte9||u&&a.velocity==0?144:128;p=b|a.channel,p!==l&&o.writeUInt8(p),o.writeUInt8(a.noteNumber),o.writeUInt8(a.velocity);break;case"noteOn":p=144|a.channel,p!==l&&o.writeUInt8(p),o.writeUInt8(a.noteNumber),o.writeUInt8(a.velocity);break;case"noteAftertouch":p=160|a.channel,p!==l&&o.writeUInt8(p),o.writeUInt8(a.noteNumber),o.writeUInt8(a.amount);break;case"controller":p=176|a.channel,p!==l&&o.writeUInt8(p),o.writeUInt8(a.controllerType),o.writeUInt8(a.value);break;case"programChange":p=192|a.channel,p!==l&&o.writeUInt8(p),o.writeUInt8(a.programNumber);break;case"channelAftertouch":p=208|a.channel,p!==l&&o.writeUInt8(p),o.writeUInt8(a.amount);break;case"pitchBend":p=224|a.channel,p!==l&&o.writeUInt8(p);var y=8192+a.value,w=y&127,v=y>>7&127;o.writeUInt8(w),o.writeUInt8(v);break;default:throw"Unrecognized event type: "+s}return p}function n(){this.buffer=[]}return n.prototype.writeUInt8=function(o){this.buffer.push(o&255)},n.prototype.writeInt8=n.prototype.writeUInt8,n.prototype.writeUInt16=function(o){var a=o>>8&255,l=o&255;this.writeUInt8(a),this.writeUInt8(l)},n.prototype.writeInt16=n.prototype.writeUInt16,n.prototype.writeUInt24=function(o){var a=o>>16&255,l=o>>8&255,u=o&255;this.writeUInt8(a),this.writeUInt8(l),this.writeUInt8(u)},n.prototype.writeInt24=n.prototype.writeUInt24,n.prototype.writeUInt32=function(o){var a=o>>24&255,l=o>>16&255,u=o>>8&255,s=o&255;this.writeUInt8(a),this.writeUInt8(l),this.writeUInt8(u),this.writeUInt8(s)},n.prototype.writeInt32=n.prototype.writeUInt32,n.prototype.writeBytes=function(o){this.buffer=this.buffer.concat(Array.prototype.slice.call(o,0))},n.prototype.writeString=function(o){var a,l=o.length,u=[];for(a=0;a<l;a++)u.push(o.codePointAt(a));this.writeBytes(u)},n.prototype.writeVarInt=function(o){if(o<0)throw"Cannot write negative variable-length integer";if(o<=127)this.writeUInt8(o);else{var a=o,l=[];for(l.push(a&127),a>>=7;a;){var u=a&127|128;l.push(u),a>>=7}this.writeBytes(l.reverse())}},n.prototype.writeChunk=function(o,a){this.writeString(o),this.writeUInt32(a.length),this.writeBytes(a)},Vi=t,Vi}var Ws;function ku(){return Ws||(Ws=1,sn.parseMidi=Tg(),sn.writeMidi=Eg()),sn}var Gi={},Vt={},Hs;function xu(){if(Hs)return Vt;Hs=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.insert=Vt.search=void 0;function t(e,i,n){n===void 0&&(n="ticks");var o=0,a=e.length,l=a;if(a>0&&e[a-1][n]<=i)return a-1;for(;o<l;){var u=Math.floor(o+(l-o)/2),s=e[u],c=e[u+1];if(s[n]===i){for(var d=u;d<e.length;d++){var f=e[d];f[n]===i&&(u=d)}return u}else{if(s[n]<i&&c[n]>i)return u;s[n]>i?l=u:s[n]<i&&(o=u+1)}}return-1}Vt.search=t;function r(e,i,n){if(n===void 0&&(n="ticks"),e.length){var o=t(e,i[n],n);e.splice(o+1,0,i)}else e.push(i)}return Vt.insert=r,Vt}var Zs;function xo(){return Zs||(Zs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.keySignatureKeys=void 0;var r=xu(),e=new WeakMap;t.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var i=function(){function n(o){var a=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",e.set(this,480),o){e.set(this,o.header.ticksPerBeat),o.tracks.forEach(function(u){u.forEach(function(s){s.meta&&(s.type==="timeSignature"?a.timeSignatures.push({ticks:s.absoluteTime,timeSignature:[s.numerator,s.denominator]}):s.type==="setTempo"?a.tempos.push({bpm:6e7/s.microsecondsPerBeat,ticks:s.absoluteTime}):s.type==="keySignature"&&a.keySignatures.push({key:t.keySignatureKeys[s.key+7],scale:s.scale===0?"major":"minor",ticks:s.absoluteTime}))})});var l=0;o.tracks[0].forEach(function(u){l+=u.deltaTime,u.meta&&(u.type==="trackName"?a.name=u.text:(u.type==="text"||u.type==="cuePoint"||u.type==="marker"||u.type==="lyrics")&&a.meta.push({text:u.text,ticks:l,type:u.type}))}),this.update()}}return n.prototype.update=function(){var o=this,a=0,l=0;this.tempos.sort(function(u,s){return u.ticks-s.ticks}),this.tempos.forEach(function(u,s){var c=s>0?o.tempos[s-1].bpm:o.tempos[0].bpm,d=u.ticks/o.ppq-l,f=60/c*d;u.time=f+a,a=u.time,l+=d}),this.timeSignatures.sort(function(u,s){return u.ticks-s.ticks}),this.timeSignatures.forEach(function(u,s){var c=s>0?o.timeSignatures[s-1]:o.timeSignatures[0],d=(u.ticks-c.ticks)/o.ppq,f=d/c.timeSignature[0]/(c.timeSignature[1]/4);c.measures=c.measures||0,u.measures=f+c.measures})},n.prototype.ticksToSeconds=function(o){var a=(0,r.search)(this.tempos,o);if(a!==-1){var l=this.tempos[a],u=l.time,s=(o-l.ticks)/this.ppq;return u+60/l.bpm*s}else{var c=o/this.ppq;return 60/120*c}},n.prototype.ticksToMeasures=function(o){var a=(0,r.search)(this.timeSignatures,o);if(a!==-1){var l=this.timeSignatures[a],u=(o-l.ticks)/this.ppq;return l.measures+u/(l.timeSignature[0]/l.timeSignature[1])/4}else return o/this.ppq/4},Object.defineProperty(n.prototype,"ppq",{get:function(){return e.get(this)},enumerable:!1,configurable:!0}),n.prototype.secondsToTicks=function(o){var a=(0,r.search)(this.tempos,o,"time");if(a!==-1){var l=this.tempos[a],u=l.time,s=o-u,c=s/(60/l.bpm);return Math.round(l.ticks+c*this.ppq)}else{var d=o/.5;return Math.round(d*this.ppq)}},n.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(o){return{bpm:o.bpm,ticks:o.ticks}}),timeSignatures:this.timeSignatures}},n.prototype.fromJSON=function(o){this.name=o.name,this.tempos=o.tempos.map(function(a){return Object.assign({},a)}),this.timeSignatures=o.timeSignatures.map(function(a){return Object.assign({},a)}),this.keySignatures=o.keySignatures.map(function(a){return Object.assign({},a)}),this.meta=o.meta.map(function(a){return Object.assign({},a)}),e.set(this,o.ppq),this.update()},n.prototype.setTempo=function(o){this.tempos=[{bpm:o,ticks:0}],this.update()},n}();t.Header=i}(Gi)),Gi}var kr={},Wi={},Ys;function _u(){return Ys||(Ys=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ControlChange=t.controlChangeIds=t.controlChangeNames=void 0,t.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},t.controlChangeIds=Object.keys(t.controlChangeNames).reduce(function(n,o){return n[t.controlChangeNames[o]]=o,n},{});var r=new WeakMap,e=new WeakMap,i=function(){function n(o,a){r.set(this,a),e.set(this,o.controllerType),this.ticks=o.absoluteTime,this.value=o.value}return Object.defineProperty(n.prototype,"number",{get:function(){return e.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return t.controlChangeNames[this.number]?t.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){var o=r.get(this);return o.ticksToSeconds(this.ticks)},set:function(o){var a=r.get(this);this.ticks=a.secondsToTicks(o)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},n}();t.ControlChange=i}(Wi)),Wi}var xr={},Xs;function $g(){if(Xs)return xr;Xs=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.createControlChanges=void 0;var t=_u();function r(){return new Proxy({},{get:function(e,i){if(e[i])return e[i];if(t.controlChangeIds.hasOwnProperty(i))return e[t.controlChangeIds[i]]},set:function(e,i,n){return t.controlChangeIds.hasOwnProperty(i)?e[t.controlChangeIds[i]]=n:e[i]=n,!0}})}return xr.createControlChanges=r,xr}var _r={},Ks;function Ig(){if(Ks)return _r;Ks=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.PitchBend=void 0;var t=new WeakMap,r=function(){function e(i,n){t.set(this,n),this.ticks=i.absoluteTime,this.value=i.value}return Object.defineProperty(e.prototype,"time",{get:function(){var i=t.get(this);return i.ticksToSeconds(this.ticks)},set:function(i){var n=t.get(this);this.ticks=n.secondsToTicks(i)},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},e}();return _r.PitchBend=r,_r}var Sr={},Ct={},Js;function Rg(){return Js||(Js=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.DrumKitByPatchID=Ct.InstrumentFamilyByID=Ct.instrumentByPatchID=void 0,Ct.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],Ct.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],Ct.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}),Ct}var Qs;function Ng(){if(Qs)return Sr;Qs=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.Instrument=void 0;var t=Rg(),r=new WeakMap,e=function(){function i(n,o){if(this.number=0,r.set(this,o),this.number=0,n){var a=n.find(function(l){return l.type==="programChange"});a&&(this.number=a.programNumber)}}return Object.defineProperty(i.prototype,"name",{get:function(){return this.percussion?t.DrumKitByPatchID[this.number]:t.instrumentByPatchID[this.number]},set:function(n){var o=t.instrumentByPatchID.indexOf(n);o!==-1&&(this.number=o)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"family",{get:function(){return this.percussion?"drums":t.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"percussion",{get:function(){var n=r.get(this);return n.channel===9},enumerable:!1,configurable:!0}),i.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},i.prototype.fromJSON=function(n){this.number=n.number},i}();return Sr.Instrument=e,Sr}var Cr={},el;function Ag(){if(el)return Cr;el=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.Note=void 0;function t(a){var l=Math.floor(a/12)-1;return r(a)+l.toString()}function r(a){var l=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],u=a%12;return l[u]}function e(a){var l=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return l.indexOf(a)}var i=function(){var a=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,l={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(u){var s=a.exec(u),c=s[1],d=s[2],f=l[c.toLowerCase()];return f+(parseInt(d,10)+1)*12}}(),n=new WeakMap,o=function(){function a(l,u,s){n.set(this,s),this.midi=l.midi,this.velocity=l.velocity,this.noteOffVelocity=u.velocity,this.ticks=l.ticks,this.durationTicks=u.ticks-l.ticks}return Object.defineProperty(a.prototype,"name",{get:function(){return t(this.midi)},set:function(l){this.midi=i(l)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(l){var u=l-this.octave;this.midi+=u*12},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pitch",{get:function(){return r(this.midi)},set:function(l){this.midi=12*(this.octave+1)+e(l)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){var l=n.get(this);return l.ticksToSeconds(this.ticks+this.durationTicks)-l.ticksToSeconds(this.ticks)},set:function(l){var u=n.get(this),s=u.secondsToTicks(this.time+l);this.durationTicks=s-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){var l=n.get(this);return l.ticksToSeconds(this.ticks)},set:function(l){var u=n.get(this);this.ticks=u.secondsToTicks(l)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bars",{get:function(){var l=n.get(this);return l.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},a}();return Cr.Note=o,Cr}var tl;function rl(){if(tl)return kr;tl=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.Track=void 0;var t=xu(),r=_u(),e=$g(),i=Ig(),n=Ng(),o=Ag(),a=new WeakMap,l=function(){function u(s,c){var d=this;if(this.name="",this.notes=[],this.controlChanges=(0,e.createControlChanges)(),this.pitchBends=[],a.set(this,c),s){var f=s.find(function(v){return v.type==="trackName"});this.name=f?f.text:""}if(this.instrument=new n.Instrument(s,this),this.channel=0,s){for(var p=s.filter(function(v){return v.type==="noteOn"}),h=s.filter(function(v){return v.type==="noteOff"}),g=function(){var v=p.shift();m.channel=v.channel;var k=h.findIndex(function(C){return C.noteNumber===v.noteNumber&&C.absoluteTime>=v.absoluteTime});if(k!==-1){var _=h.splice(k,1)[0];m.addNote({durationTicks:_.absoluteTime-v.absoluteTime,midi:v.noteNumber,noteOffVelocity:_.velocity/127,ticks:v.absoluteTime,velocity:v.velocity/127})}},m=this;p.length;)g();var b=s.filter(function(v){return v.type==="controller"});b.forEach(function(v){d.addCC({number:v.controllerType,ticks:v.absoluteTime,value:v.value/127})});var y=s.filter(function(v){return v.type==="pitchBend"});y.forEach(function(v){d.addPitchBend({ticks:v.absoluteTime,value:v.value/Math.pow(2,13)})});var w=s.find(function(v){return v.type==="endOfTrack"});this.endOfTrackTicks=w!==void 0?w.absoluteTime:void 0}}return u.prototype.addNote=function(s){var c=a.get(this),d=new o.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},c);return Object.assign(d,s),(0,t.insert)(this.notes,d,"ticks"),this},u.prototype.addCC=function(s){var c=a.get(this),d=new r.ControlChange({controllerType:s.number},c);return delete s.number,Object.assign(d,s),Array.isArray(this.controlChanges[d.number])||(this.controlChanges[d.number]=[]),(0,t.insert)(this.controlChanges[d.number],d,"ticks"),this},u.prototype.addPitchBend=function(s){var c=a.get(this),d=new i.PitchBend({},c);return Object.assign(d,s),(0,t.insert)(this.pitchBends,d,"ticks"),this},Object.defineProperty(u.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var s=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,c=0;c<this.notes.length-1;c++){var d=this.notes[c].time+this.notes[c].duration;s<d&&(s=d)}return s},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var s=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,c=0;c<this.notes.length-1;c++){var d=this.notes[c].ticks+this.notes[c].durationTicks;s<d&&(s=d)}return s},enumerable:!1,configurable:!0}),u.prototype.fromJSON=function(s){var c=this;this.name=s.name,this.channel=s.channel,this.instrument=new n.Instrument(void 0,this),this.instrument.fromJSON(s.instrument),s.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=s.endOfTrackTicks);for(var d in s.controlChanges)s.controlChanges[d]&&s.controlChanges[d].forEach(function(f){c.addCC({number:f.number,ticks:f.ticks,value:f.value})});s.notes.forEach(function(f){c.addNote({durationTicks:f.durationTicks,midi:f.midi,ticks:f.ticks,velocity:f.velocity})})},u.prototype.toJSON=function(){for(var s={},c=0;c<127;c++)this.controlChanges.hasOwnProperty(c)&&(s[c]=this.controlChanges[c].map(function(f){return f.toJSON()}));var d={channel:this.channel,controlChanges:s,pitchBends:this.pitchBends.map(function(f){return f.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(f){return f.toJSON()})};return this.endOfTrackTicks!==void 0&&(d.endOfTrackTicks=this.endOfTrackTicks),d},u}();return kr.Track=l,kr}var Gt={};function Mg(t){var r=[];return Su(t,r),r}function Su(t,r){for(var e=0;e<t.length;e++){var i=t[e];Array.isArray(i)?Su(i,r):r.push(i)}}const Og=Object.freeze(Object.defineProperty({__proto__:null,flatten:Mg},Symbol.toStringTag,{value:"Module"})),Fg=uf(Og);var nl;function Dg(){if(nl)return Gt;nl=1;var t=Gt&&Gt.__spreadArray||function(b,y,w){if(w||arguments.length===2)for(var v=0,k=y.length,_;v<k;v++)(_||!(v in y))&&(_||(_=Array.prototype.slice.call(y,0,v)),_[v]=y[v]);return b.concat(_||Array.prototype.slice.call(y))};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.encode=void 0;var r=ku(),e=xo(),i=Fg;function n(b,y){return[{absoluteTime:b.ticks,channel:y,deltaTime:0,noteNumber:b.midi,type:"noteOn",velocity:Math.floor(b.velocity*127)},{absoluteTime:b.ticks+b.durationTicks,channel:y,deltaTime:0,noteNumber:b.midi,type:"noteOff",velocity:Math.floor(b.noteOffVelocity*127)}]}function o(b){return(0,i.flatten)(b.notes.map(function(y){return n(y,b.channel)}))}function a(b,y){return{absoluteTime:b.ticks,channel:y,controllerType:b.number,deltaTime:0,type:"controller",value:Math.floor(b.value*127)}}function l(b){for(var y=[],w=0;w<127;w++)b.controlChanges.hasOwnProperty(w)&&b.controlChanges[w].forEach(function(v){y.push(a(v,b.channel))});return y}function u(b,y){return{absoluteTime:b.ticks,channel:y,deltaTime:0,type:"pitchBend",value:b.value}}function s(b){var y=[];return b.pitchBends.forEach(function(w){y.push(u(w,b.channel))}),y}function c(b){return{absoluteTime:0,channel:b.channel,deltaTime:0,programNumber:b.instrument.number,type:"programChange"}}function d(b){return{absoluteTime:0,deltaTime:0,meta:!0,text:b,type:"trackName"}}function f(b){return{absoluteTime:b.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/b.bpm),type:"setTempo"}}function p(b){return{absoluteTime:b.ticks,deltaTime:0,denominator:b.timeSignature[1],meta:!0,metronome:24,numerator:b.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function h(b){var y=e.keySignatureKeys.indexOf(b.key);return{absoluteTime:b.ticks,deltaTime:0,key:y+7,meta:!0,scale:b.scale==="major"?0:1,type:"keySignature"}}function g(b){return{absoluteTime:b.ticks,deltaTime:0,meta:!0,text:b.text,type:b.type}}function m(b){var y={header:{format:1,numTracks:b.tracks.length+1,ticksPerBeat:b.header.ppq},tracks:t([t(t(t(t([{absoluteTime:0,deltaTime:0,meta:!0,text:b.header.name,type:"trackName"}],b.header.keySignatures.map(function(w){return h(w)}),!0),b.header.meta.map(function(w){return g(w)}),!0),b.header.tempos.map(function(w){return f(w)}),!0),b.header.timeSignatures.map(function(w){return p(w)}),!0)],b.tracks.map(function(w){return t(t(t([d(w.name),c(w)],o(w),!0),l(w),!0),s(w),!0)}),!0)};return y.tracks=y.tracks.map(function(w){w=w.sort(function(k,_){return k.absoluteTime-_.absoluteTime});var v=0;return w.forEach(function(k){k.deltaTime=k.absoluteTime-v,v=k.absoluteTime,delete k.absoluteTime}),w.push({deltaTime:0,meta:!0,type:"endOfTrack"}),w}),new Uint8Array((0,r.writeMidi)(y))}return Gt.encode=m,Gt}var il;function zg(){return il||(il=1,function(t){var r=qt&&qt.__awaiter||function(d,f,p,h){function g(m){return m instanceof p?m:new p(function(b){b(m)})}return new(p||(p=Promise))(function(m,b){function y(k){try{v(h.next(k))}catch(_){b(_)}}function w(k){try{v(h.throw(k))}catch(_){b(_)}}function v(k){k.done?m(k.value):g(k.value).then(y,w)}v((h=h.apply(d,f||[])).next())})},e=qt&&qt.__generator||function(d,f){var p={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},h,g,m,b;return b={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(b[Symbol.iterator]=function(){return this}),b;function y(v){return function(k){return w([v,k])}}function w(v){if(h)throw new TypeError("Generator is already executing.");for(;p;)try{if(h=1,g&&(m=v[0]&2?g.return:v[0]?g.throw||((m=g.return)&&m.call(g),0):g.next)&&!(m=m.call(g,v[1])).done)return m;switch(g=0,m&&(v=[v[0]&2,m.value]),v[0]){case 0:case 1:m=v;break;case 4:return p.label++,{value:v[1],done:!1};case 5:p.label++,g=v[1],v=[0];continue;case 7:v=p.ops.pop(),p.trys.pop();continue;default:if(m=p.trys,!(m=m.length>0&&m[m.length-1])&&(v[0]===6||v[0]===2)){p=0;continue}if(v[0]===3&&(!m||v[1]>m[0]&&v[1]<m[3])){p.label=v[1];break}if(v[0]===6&&p.label<m[1]){p.label=m[1],m=v;break}if(m&&p.label<m[2]){p.label=m[2],p.ops.push(v);break}m[2]&&p.ops.pop(),p.trys.pop();continue}v=f.call(d,p)}catch(k){v=[6,k],g=0}finally{h=m=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.Track=t.Midi=void 0;var i=ku(),n=xo(),o=rl(),a=Dg(),l=function(){function d(f){var p=this,h=null;if(f){var g=f instanceof ArrayBuffer?new Uint8Array(f):f;h=(0,i.parseMidi)(g),h.tracks.forEach(function(m){var b=0;m.forEach(function(y){b+=y.deltaTime,y.absoluteTime=b})}),h.tracks=c(h.tracks)}this.header=new n.Header(h),this.tracks=[],f&&(this.tracks=h.tracks.map(function(m){return new o.Track(m,p.header)}),h.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return d.fromUrl=function(f){return r(this,void 0,void 0,function(){var p,h;return e(this,function(g){switch(g.label){case 0:return[4,fetch(f)];case 1:return p=g.sent(),p.ok?[4,p.arrayBuffer()]:[3,3];case 2:return h=g.sent(),[2,new d(h)];case 3:throw new Error("Could not load '".concat(f,"'"))}})})},Object.defineProperty(d.prototype,"name",{get:function(){return this.header.name},set:function(f){this.header.name=f},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"duration",{get:function(){var f=this.tracks.map(function(p){return p.duration});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"durationTicks",{get:function(){var f=this.tracks.map(function(p){return p.durationTicks});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),d.prototype.addTrack=function(){var f=new o.Track(void 0,this.header);return this.tracks.push(f),f},d.prototype.toArray=function(){return(0,a.encode)(this)},d.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(f){return f.toJSON()})}},d.prototype.fromJSON=function(f){var p=this;this.header=new n.Header,this.header.fromJSON(f.header),this.tracks=f.tracks.map(function(h){var g=new o.Track(void 0,p.header);return g.fromJSON(h),g})},d.prototype.clone=function(){var f=new d;return f.fromJSON(this.toJSON()),f},d}();t.Midi=l;var u=rl();Object.defineProperty(t,"Track",{enumerable:!0,get:function(){return u.Track}});var s=xo();Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return s.Header}});function c(d){for(var f=[],p=0;p<d.length;p++)for(var h=f.length,g=new Map,m=Array(16).fill(0),b=0,y=d[p];b<y.length;b++){var w=y[b],v=h,k=w.channel;if(k!==void 0){w.type==="programChange"&&(m[k]=w.programNumber);var _=m[k],C="".concat(_," ").concat(k);g.has(C)?v=g.get(C):(v=h+g.size,g.set(C,v))}f[v]||f.push([]),f[v].push(w)}return f}}(qt)),qt}var Cu=zg();const Lg=H({prev:U(M),delay:U(M),next:ne(M)}),Ho=new re({typeName:"Delay",typeSchema:Lg}),jg=H({next:ne(M)}),Zo=new re({typeName:"Start",typeSchema:jg}),Ug=H({value:ot(),out:ne(M)}),Mr=new re({typeName:"Number",typeSchema:Ug}),Bg=H({id:kt(),prev:U(M),value:U(M),next:ne(M)}),Yo=new re({typeName:"SetVariable",typeSchema:Bg}),qg=H({id:kt(),value:ne(M)}),Xo=new re({typeName:"Variable",typeSchema:qg}),Vg=H({frequency:U(M),out:ne(M)}),Ko=new re({typeName:"Meow",typeSchema:Vg}),Gg=H({in:U(M)}),Jo=new re({typeName:"Speaker",typeSchema:Gg});async function Wg(t,r){let e=[],i=new Cu.Midi(await r.arrayBuffer());for(let g of i.tracks)for(let m of g.notes)e.push({time:m.time,type:"NoteOn",note:m.midi}),e.push({time:m.time+m.duration,type:"NoteOff",note:m.midi});e.sort((g,m)=>g.time-m.time);let n=1e3,o=new Set,a=new Map,l=0;for(let g of e){let m=a.get(g.time);if(m==null?(m=[g],a.set(g.time,m)):m.push(g),o.add(g.note),++l,l>=n)break}let u=0,s=0,c,d;{let g=Zo.create({next:[]});d=b=>{g.setState("next",y=>[...y,b])},c={target:t.createEntity([g,Ae.create({transform:Se.create(K.create(s,0),_e.rot0)})]),pin:"next"}}s+=200;let f=[],p,h=-200;for(let g=21;g<=108;++g){if(!o.has(g))continue;let m=261.63*Math.pow(2,(g-60)/12),b=Mr.create({value:m,out:[]}),y=t.createEntity([b,Ae.create({transform:Se.create(K.create(s,h),_e.rot0)})]);f[g]={id:y,c:b},h-=100}{let g=Mr.create({value:0,out:[]});p={id:t.createEntity([g,Ae.create({transform:Se.create(K.create(s,h),_e.rot0)})]),c:g}}for(let g=21;g<=108;++g){if(!o.has(g))continue;let m=Xo.create({id:`n${g}`,value:[]}),b=t.createEntity([m,Ae.create({transform:Se.create(K.create(s,h),_e.rot0)})]),y=Ko.create({frequency:{target:b,pin:"value"},out:[]}),w=t.createEntity([y,Ae.create({transform:Se.create(K.create(s+150,h),_e.rot0)})]);m.setState("value",[{target:w,pin:"frequency"}]);let v=Jo.create({in:{target:w,pin:"out"}}),k=t.createEntity([v,Ae.create({transform:Se.create(K.create(s+300,h),_e.rot0)})]);y.setState("out",[{target:k,pin:"in"}]),h-=100}for(let[g,m]of a.entries()){let b=g-u;u=g;{let y=Ho.create({prev:c,delay:void 0,next:[]});d=_=>{y.setState("next",C=>[...C,_])};let w=t.createEntity([y,Ae.create({transform:Se.create(K.create(s,0),_e.rot0)})]),v=t.createEntity([Mr.create({value:b*1e3,out:[{target:w,pin:"delay"}]}),Ae.create({transform:Se.create(K.create(s,-100),_e.rot0)})]);y.setState("delay",{target:v,pin:"out"}),c={target:w,pin:"next"};let k=-250;for(let _ of m){_.type=="NoteOn"&&261.63*Math.pow(2,(_.note-128)/12);let C=Yo.create({id:`n${_.note}`,prev:{...c},value:void 0,next:[]}),S=t.createEntity([C,Ae.create({transform:Se.create(K.create(s,k),_e.rot0)})]);if(_.type=="NoteOn"){let P=f[_.note];P.c.setState("out",T=>[...T,{target:S,pin:"value"}]),C.setState("value",{target:P.id,pin:"out"})}else p.c.setState("out",P=>[...P,{target:S,pin:"value"}]),C.setState("value",{target:p.id,pin:"out"});d({target:S,pin:"prev"}),k-=200}}if(s+=200,n-=m.length,await new Promise(y=>requestAnimationFrame(()=>y())),n<=0)break}}const Hg=H({a:U(M),b:U(M),out:ne(M)}),Pu=new re({typeName:"Add",typeSchema:Hg});class Zg{componentType=Pu;ext={};create(r){return new Yg(r)}}const Tu=new Zg;class Yg{type=Tu;nodeParams;inputPins;outputPins;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"a",source:()=>e.a,setSource:n=>i("a",n)},{name:"b",source:()=>e.b,setSource:n=>i("b",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("a");if(a==null)return[];let l=o.get("b");if(l==null)return[];let u=n.allocField("0.0");n.insertCode([`${u} = ${a} + ${l}`]);let s=new Map;return s.set("out",u),[{outputAtoms:s}]}}}}const Xg=H({timeToOne:U(M),out:ne(M)}),Eu=new re({typeName:"Attack",typeSchema:Xg});class Kg{componentType=Eu;ext={};create(r){return new Jg(r)}}const $u=new Kg;class Jg{type=$u;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"timeToOne",source:()=>e.timeToOne,setSource:n=>i("timeToOne",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}])}}class Qg{componentType=Ho;ext={};create(r){return new ey(r)}}const Iu=new Qg;class ey{type=Iu;nodeParams;inputPins;outputPins;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"prev",source:()=>e.prev,setSource:n=>i("prev",n),isEffectPin:!0},{name:"delay",source:()=>e.delay,setSource:n=>i("delay",n)}]),this.outputPins=E(()=>[{name:"next",sinks:()=>e.next,setSinks:n=>i("next",n),isEffectPin:!0}]),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let l=o.get("prev");if(l==null)return[];let u=o.get("delay");if(u==null)return[];let s=`this.n_${a}_next`;n.addDeclToExistingForField(s,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`);let c=n.allocField("0.0");n.insertConstructorCode([`${l}.onDone.push(() => {`,`  ${c} = currentTime * 1000.0;`,`  this.insertRunningEffect(${s});`,"});",`${s}.update = () => {`,`  let time = currentTime * 1000.0 - ${c};`,"  // return true when done.",`  return time >= ${u};`,"};"]);let d=`${s}`,f=new Map;return f.set("next",d),[{outputAtoms:f}]}}}}const ty=H({prev:U(M),entry:U(M),next:ne(M)}),Ru=new re({typeName:"Goto",typeSchema:ty});class ry{componentType=Ru;ext={};create(r){return new ny(r)}}const Nu=new ry;class ny{type=Nu;nodeParams;inputPins;outputPins;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"prev",source:()=>e.prev,setSource:n=>i("prev",n),isEffectPin:!0},{name:"entry",source:()=>e.entry,setSource:n=>i("entry",n),isEffectPin:!0}]),this.outputPins=E(()=>[{name:"next",sinks:()=>e.next,setSinks:n=>i("next",n),isEffectPin:!0}]),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let l=o.get("prev");if(l==null)return[];let u=o.get("entry");if(u==null)return[];let s=`this.n_${a}_next`;n.addDeclToExistingForField(s,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),n.insertConstructorCode([`${l}.onDone.push(() => {`,`  this.insertRunningEffect(${s});`,"});",`${u}.onDone.push(() => {`,`  this.insertRunningEffect(${s});`,"});",`${s}.update = () => true;`]);let c=`${s}`,d=new Map;return d.set("next",c),[{outputAtoms:d}]}}}}const iy=H({out:ne(M)}),Qo=new re({typeName:"Knob",typeSchema:iy});var oy=Y(`<svg version=1.1 viewBox="-16 -16 32 32"><defs><linearGradient id=shape-fill x1=0 x2=0 y1=0 y2=1><stop offset=0% stop-color="rgb(80, 80, 81)"></stop><stop offset=100% stop-color="rgb(30, 30, 31)"></stop></linearGradient><path id=shape d="
        M14.876 -5.890A-16 -16 0 0 0 14.876 5.890A16 16 0 0 112.539 9.938A-16 -16 0 0 0 2.337 15.828
        A16 16 0 0 1-2.337 15.828A-16 -16 0 0 0 -12.539 9.938A16 16 0 0 1-14.876 5.890A-16 -16 0 0 0 -14.876 -5.890
        A16 16 0 0 1-12.539 -9.938A-16 -16 0 0 0 -2.337 -15.828A16 16 0 0 12.337 -15.828A-16 -16 0 0 0 12.539 -9.938
        A16 16 0 0 114.876 -5.890"></path><clipPath id=shape-mask style="transform:rotate(var(--rot)) scale(0.87)"><use href=#shape></use></clipPath><filter id=lights></filter><filter id=shadow></filter></defs><circle cx=0 cy=0 r=15.0 fill="rgb(36, 36, 37)"stroke="rgb(28, 28, 29)"stroke-width=0.5></circle><g filter=url(#shadow)><g filter=url(#lights)><g clip-path=url(#shape-mask)><rect x=-16 y=-16 width=32 height=32 fill=url(#shape-fill)></rect><circle cx=-28 cy=-28 r=32 fill="rgba(250, 250, 255, .16)"></circle></g></g></g><g style=transform:rotate(var(--rot))><circle cx=0 cy=-11 r=1.1 fill=black></circle><circle cx=0 cy=-11 r=0.8 fill=white></circle></g><circle cx=0 cy=0 r=9 stroke="rgb(50, 50, 51)"stroke-width=0.7 fill=none></circle><foreignObject x=-9 y=-9 width=18 height=18><div style=width:18px;height:18px;border-radius:50%;background-image:conic-gradient(#aaa,#666,#aaa,#666,#aaa,#666,#aaa);>`);const ay=t=>{let[r,e]=je({dragging:void 0}),[i,n]=oe();Ne(()=>{r.dragging&&t.setDisablePan(!1)});let o=-165,a=-o,l=E(()=>o+(t.value-t.minValue)*(a-o)/(t.maxValue-t.minValue)),u=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");u.setAttribute("dx","-0.3"),u.setAttribute("dy","-0.3"),u.setAttribute("stdDeviation","0.1"),u.setAttribute("flood-opacity","0.7"),u.setAttribute("flood-color","white");let s=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");s.setAttribute("dx","1.5"),s.setAttribute("dy","1.5"),s.setAttribute("stdDeviation","0.5"),s.setAttribute("flood-opacity","0.9"),s.setAttribute("flood-color","black");let c=p=>{let h=i(),g=h.getBoundingClientRect(),m=p.clientX-g.left,b=p.clientY-g.top,y=m-.5*g.width,w=b-.5*g.width;console.log("x",m.toFixed()),console.log("y",b.toFixed()),console.log("dx",y.toFixed()),console.log("dy",w.toFixed());let v=y*y+w*w;if(v>g.width*g.width)return;let k=Math.sqrt(v),C=360/(2*Math.PI*k),S=w>0?-C:C,P=y>0?C:-C;e("dragging",new Yr({pointerId:p.pointerId,startX:m,startY:b,startValue:t.value,dadx:S,dady:P})),h.setPointerCapture(p.pointerId),t.setDisablePan(!0)},d=p=>{if(r.dragging==null||p.pointerId!=r.dragging.value.pointerId)return;let h=i(),g=r.dragging.value,m=h.getBoundingClientRect(),b=p.clientX-m.left,y=p.clientY-m.top,w=o+(g.startValue-t.minValue)*(a-o)/(t.maxValue-t.minValue)+(b-g.startX)*g.dadx+(y-g.startY)*g.dady,v=t.minValue+(w-o)*(t.maxValue-t.minValue)/(a-o);v=Math.max(t.minValue,Math.min(t.maxValue,v)),t.setValue(v)},f=p=>{r.dragging!=null&&r.dragging.value.pointerId==p.pointerId&&(i().releasePointerCapture(r.dragging.value.pointerId),t.setDisablePan(!1))};return(()=>{var p=oy(),h=p.firstChild,g=h.firstChild,m=g.nextSibling,b=m.nextSibling,y=b.nextSibling,w=y.nextSibling;p.$$pointerup=f,p.$$pointermove=d,p.$$pointerdown=c;var v=n;return typeof v=="function"?Ce(v,p):n=p,p.style.setProperty("user-select","none"),p.style.setProperty("outline","none"),te(y,u),te(w,s),le(k=>{var _=`${t.size}px`,C=`${t.size}px`,S=`${l()}deg`;return _!==k.e&&((k.e=_)!=null?p.style.setProperty("width",_):p.style.removeProperty("width")),C!==k.t&&((k.t=C)!=null?p.style.setProperty("height",C):p.style.removeProperty("height")),S!==k.a&&((k.a=S)!=null?p.style.setProperty("--rot",S):p.style.removeProperty("--rot")),k},{e:void 0,t:void 0,a:void 0}),p})()};Oe(["pointerdown","pointermove","pointerup"]);var sy=Y("<div><div><label class=input>min<input type=text value=0.00></label><label class=input>max<input type=text value=1.00></label><label class=input>value<input type=text>");class ly{componentType=Qo;ext;constructor(){this.ext={generateInitOnceCode:({ctx:r})=>{r.insertGlobalCode(["let knobValues = {};"]),r.insertMessageHandlerCode("KnobChange",["knobValues[params.id] = params.value;"])}}}create(r){return new cy(r)}}const Au=new ly;class cy{type=Au;nodeParams;outputPins;ui;disablePan;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:u=>i("out",u)}]);let[n,o]=oe(!1),[a,l]=oe();this.ui=E(()=>()=>{let[u,s]=oe(0);ve(he(u,d=>{let f=a();f?.port.postMessage({type:"KnobChange",params:{id:`${r.entity}`,value:d}})})),Ne(()=>o(!1));let c=100;return(()=>{var d=sy(),f=d.firstChild,p=f.firstChild,h=p.nextSibling,g=h.nextSibling,m=g.firstChild,b=m.nextSibling;return f.style.setProperty("max-width","100px"),te(d,D(ay,{size:c,indentSize:10,minValue:0,maxValue:1,get value(){return u()},setValue:s,setDisablePan:o}),null),le(()=>b.value=u().toFixed(2)),d})()}),this.disablePan=n,this.ext={init:async u=>{l(u)},generateCode:({ctx:u})=>{u.insertGlobalCode([`knobValues["${r.entity}"] = 0.0;`]);let s=`knobValues["${r.entity}"]`,c=new Map;return c.set("out",s),[{outputAtoms:c}]}}}}var Hi={exports:{}},ol;function uy(){return ol||(ol=1,function(t,r){(function(e,i){t.exports=i()})(window,function(){return function(e){var i={};function n(o){if(i[o])return i[o].exports;var a=i[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=i,n.d=function(o,a,l){n.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:l})},n.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},n.t=function(o,a){if(1&a&&(o=n(o)),8&a||4&a&&typeof o=="object"&&o&&o.__esModule)return o;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:o}),2&a&&typeof o!="string")for(var u in o)n.d(l,u,function(s){return o[s]}.bind(null,u));return l},n.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return n.d(a,"a",a),a},n.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},n.p="",n(n.s="./src/index.ts")}({"./src/chunk.ts":function(e,i,n){n.r(i),n.d(i,"SF2Chunk",function(){return p});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),l=n("./src/chunks/index.ts");function u(h){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(h)}function s(h,g){for(var m=0;m<g.length;m++){var b=g[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,b.key,b)}}function c(h){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)})(h)}function d(h,g){return(d=Object.setPrototypeOf||function(m,b){return m.__proto__=b,m})(h,g)}function f(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}var p=function(h){function g(y){var w,v,k,_,C,S;return function(P,T){if(!(P instanceof T))throw new TypeError("Cannot call a class as a function")}(this,g),v=this,w=!(k=c(g).call(this,y.id,y.length,y.buffer,y.subChunks))||u(k)!=="object"&&typeof k!="function"?f(v):k,_=f(f(w)),S=void 0,(C="subChunks")in _?Object.defineProperty(_,C,{value:S,enumerable:!0,configurable:!0,writable:!0}):_[C]=S,w.subChunks=y.subChunks.map(function(P){return new g(P)}),w}var m,b;return function(y,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(w&&w.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),w&&d(y,w)}(g,h),m=g,(b=[{key:"getMetaData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var y=this.subChunks.reduce(function(w,v){if(v.id==="ifil"||v.id==="iver"){if(v.length!==a.SF_VERSION_LENGTH)throw new o.ParseError("Invalid size for the '".concat(v.id,"' sub-chunk"));w[v.id]="".concat(v.getInt16(),".").concat(v.getInt16(2))}else w[v.id]=v.getString();return w},{});if(!y.ifil)throw new o.ParseError("Missing required 'ifil' sub-chunk");if(!y.INAM)throw new o.ParseError("Missing required 'INAM' sub-chunk");return{version:y.ifil,soundEngine:y.isng||"EMU8000",name:y.INAM,rom:y.irom,romVersion:y.iver,creationDate:y.ICRD,author:y.IENG,product:y.IPRD,copyright:y.ICOP,comments:y.ICMT,createdBy:y.ISFT}}},{key:"getSampleData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var y=this.subChunks[0];if(y.id!=="smpl")throw new o.ParseError("Invalid chunk signature","'smpl'","'".concat(y.id,"'"));return y.buffer}},{key:"getPresetData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));return{presetHeaders:Object(l.getPresetHeaders)(this.subChunks[0]),presetZones:Object(l.getZones)(this.subChunks[1],"pbag"),presetModulators:Object(l.getModulators)(this.subChunks[2],"pmod"),presetGenerators:Object(l.getGenerators)(this.subChunks[3],"pgen"),instrumentHeaders:Object(l.getInstrumentHeaders)(this.subChunks[4]),instrumentZones:Object(l.getZones)(this.subChunks[5],"ibag"),instrumentModulators:Object(l.getModulators)(this.subChunks[6],"imod"),instrumentGenerators:Object(l.getGenerators)(this.subChunks[7],"igen"),sampleHeaders:Object(l.getSampleHeaders)(this.subChunks[8])}}}])&&s(m.prototype,b),g}(o.RIFFChunk)},"./src/chunks/generators.ts":function(e,i,n){n.r(i),n.d(i,"getGenerators",function(){return d});var o=n("./src/riff/index.ts"),a=n("./src/types/index.ts"),l=n("./src/constants.ts"),u=[a.GeneratorType.StartAddrsOffset,a.GeneratorType.EndAddrsOffset,a.GeneratorType.StartLoopAddrsOffset,a.GeneratorType.EndLoopAddrsOffset,a.GeneratorType.StartAddrsCoarseOffset,a.GeneratorType.EndAddrsCoarseOffset,a.GeneratorType.StartLoopAddrsCoarseOffset,a.GeneratorType.KeyNum,a.GeneratorType.Velocity,a.GeneratorType.EndLoopAddrsCoarseOffset,a.GeneratorType.SampleModes,a.GeneratorType.ExclusiveClass,a.GeneratorType.OverridingRootKey],s=[a.GeneratorType.Unused1,a.GeneratorType.Unused2,a.GeneratorType.Unused3,a.GeneratorType.Unused4,a.GeneratorType.Reserved1,a.GeneratorType.Reserved2,a.GeneratorType.Reserved3],c=[a.GeneratorType.KeyRange,a.GeneratorType.VelRange],d=function(f,p){if(f.id!==p)throw new o.ParseError("Unexpected chunk ID","'".concat(p,"'"),"'".concat(f.id,"'"));if(f.length%l.SF_GENERATOR_SIZE)throw new o.ParseError("Invalid size for the '".concat(p,"' sub-chunk"));return f.iterate(function(h){var g=h.getInt16();return a.GeneratorType[g]?p==="pgen"&&u.includes(g)||p==="igen"&&s.includes(g)?null:c.includes(g)?{id:g,range:{lo:h.getByte(),hi:h.getByte()}}:{id:g,value:h.getInt16BE()}:null})}},"./src/chunks/index.ts":function(e,i,n){n.r(i);var o=n("./src/chunks/instruments/index.ts");n.d(i,"getInstrumentHeaders",function(){return o.getInstrumentHeaders});var a=n("./src/chunks/presets/index.ts");n.d(i,"getPresetHeaders",function(){return a.getPresetHeaders});var l=n("./src/chunks/samples/index.ts");n.d(i,"getSampleHeaders",function(){return l.getSampleHeaders});var u=n("./src/chunks/generators.ts");n.d(i,"getGenerators",function(){return u.getGenerators});var s=n("./src/chunks/modulators.ts");n.d(i,"getModulators",function(){return s.getModulators});var c=n("./src/chunks/zones.ts");n.d(i,"getZones",function(){return c.getZones}),n.d(i,"getItemsInZone",function(){return c.getItemsInZone})},"./src/chunks/instruments/headers.ts":function(e,i,n){n.r(i),n.d(i,"getInstrumentHeaders",function(){return l});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),l=function(u){if(u.id!=="inst")throw new o.ParseError("Unexpected chunk ID","'inst'","'".concat(u.id,"'"));if(u.length%a.SF_INSTRUMENT_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'inst' sub-chunk");return u.iterate(function(s){return{name:s.getString(),bagIndex:s.getInt16()}})}},"./src/chunks/instruments/index.ts":function(e,i,n){n.r(i);var o=n("./src/chunks/instruments/headers.ts");n.d(i,"getInstrumentHeaders",function(){return o.getInstrumentHeaders})},"./src/chunks/modulators.ts":function(e,i,n){n.r(i),n.d(i,"getModulators",function(){return u});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),l=function(s){return{type:s>>10&63,polarity:s>>9&1,direction:s>>8&1,palette:s>>7&1,index:127&s}},u=function(s,c){if(s.id!==c)throw new o.ParseError("Unexpected chunk ID","'".concat(c,"'"),"'".concat(s.id,"'"));if(s.length%a.SF_MODULATOR_SIZE)throw new o.ParseError("Invalid size for the '".concat(c,"' sub-chunk"));return s.iterate(function(d){return{source:l(d.getInt16BE()),id:d.getInt16BE(),value:d.getInt16BE(),valueSource:l(d.getInt16BE()),transform:d.getInt16BE()}})}},"./src/chunks/presets/headers.ts":function(e,i,n){n.r(i),n.d(i,"getPresetHeaders",function(){return l});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),l=function(u){if(u.id!=="phdr")throw new o.ParseError("Invalid chunk ID","'phdr'","'".concat(u.id,"'"));if(u.length%a.SF_PRESET_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'phdr' sub-chunk");return u.iterate(function(s){return{name:s.getString(),preset:s.getInt16(),bank:s.getInt16(),bagIndex:s.getInt16(),library:s.getUInt32(),genre:s.getUInt32(),morphology:s.getUInt32()}})}},"./src/chunks/presets/index.ts":function(e,i,n){n.r(i);var o=n("./src/chunks/presets/headers.ts");n.d(i,"getPresetHeaders",function(){return o.getPresetHeaders})},"./src/chunks/samples/headers.ts":function(e,i,n){n.r(i),n.d(i,"getSampleHeaders",function(){return l});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),l=function(u){if(u.id!=="shdr")throw new o.ParseError("Unexpected chunk ID","'shdr'","'".concat(u.id,"'"));if(u.length%a.SF_SAMPLE_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'shdr' sub-chunk");return u.iterate(function(s){return{name:s.getString(),start:s.getUInt32(),end:s.getUInt32(),startLoop:s.getUInt32(),endLoop:s.getUInt32(),sampleRate:s.getUInt32(),originalPitch:s.getByte(),pitchCorrection:s.getChar(),link:s.getInt16(),type:s.getInt16()}})}},"./src/chunks/samples/index.ts":function(e,i,n){n.r(i);var o=n("./src/chunks/samples/headers.ts");n.d(i,"getSampleHeaders",function(){return o.getSampleHeaders})},"./src/chunks/zones.ts":function(e,i,n){n.r(i),n.d(i,"getZones",function(){return u}),n.d(i,"getItemsInZone",function(){return s});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),l=n("./src/types/index.ts"),u=function(p,h){if(p.id!==h)throw new o.ParseError("Unexpected chunk ID","'".concat(h,"'"),"'".concat(p.id,"'"));if(p.length%a.SF_BAG_SIZE)throw new o.ParseError("Invalid size for the '".concat(h,"' sub-chunk"));return p.iterate(function(g){return{generatorIndex:g.getInt16(),modulatorIndex:g.getInt16()}})},s=function(p,h,g,m,b,y){for(var w=[],v=0;v<p.length;v++){for(var k=p[v],_=p[v+1],C=k.bagIndex,S=_?_.bagIndex:h.length,P=[],T=void 0,x=C;x<S;x++){var $=c(x,h,g),O=d(x,h,m),N=O[l.GeneratorType.KeyRange]&&O[l.GeneratorType.KeyRange].range,A=O[y];if(A){var L=b[A.value];L&&P.push({keyRange:N,modulators:$,generators:O,reference:L})}else x-C==0&&(T={keyRange:N,modulators:$,generators:O})}w.push({header:k,globalZone:T,zones:P})}return w},c=function(p,h,g){var m=h[p],b=h[p+1],y=m.modulatorIndex,w=b?b.modulatorIndex:h.length;return f(y,w,g)},d=function(p,h,g){var m=h[p],b=h[p+1],y=m.generatorIndex,w=b?b.generatorIndex:h.length;return f(y,w,g)},f=function(p,h,g){for(var m={},b=p;b<h;b++){var y=g[b];y&&(m[y.id]=y)}return m}},"./src/constants.ts":function(e,i,n){n.r(i),n.d(i,"SF_VERSION_LENGTH",function(){return o}),n.d(i,"SF_PRESET_HEADER_SIZE",function(){return a}),n.d(i,"SF_BAG_SIZE",function(){return l}),n.d(i,"SF_MODULATOR_SIZE",function(){return u}),n.d(i,"SF_GENERATOR_SIZE",function(){return s}),n.d(i,"SF_INSTRUMENT_HEADER_SIZE",function(){return c}),n.d(i,"SF_SAMPLE_HEADER_SIZE",function(){return d}),n.d(i,"DEFAULT_SAMPLE_RATE",function(){return f});var o=4,a=38,l=4,u=10,s=4,c=22,d=46,f=22050},"./src/index.ts":function(e,i,n){n.r(i);var o=n("./src/types/index.ts");for(var a in o)["default"].indexOf(a)<0&&function(c){n.d(i,c,function(){return o[c]})}(a);var l=n("./src/chunk.ts");n.d(i,"SF2Chunk",function(){return l.SF2Chunk});var u=n("./src/constants.ts");n.d(i,"SF_VERSION_LENGTH",function(){return u.SF_VERSION_LENGTH}),n.d(i,"SF_PRESET_HEADER_SIZE",function(){return u.SF_PRESET_HEADER_SIZE}),n.d(i,"SF_BAG_SIZE",function(){return u.SF_BAG_SIZE}),n.d(i,"SF_MODULATOR_SIZE",function(){return u.SF_MODULATOR_SIZE}),n.d(i,"SF_GENERATOR_SIZE",function(){return u.SF_GENERATOR_SIZE}),n.d(i,"SF_INSTRUMENT_HEADER_SIZE",function(){return u.SF_INSTRUMENT_HEADER_SIZE}),n.d(i,"SF_SAMPLE_HEADER_SIZE",function(){return u.SF_SAMPLE_HEADER_SIZE}),n.d(i,"DEFAULT_SAMPLE_RATE",function(){return u.DEFAULT_SAMPLE_RATE});var s=n("./src/soundFont2.ts");n.d(i,"SoundFont2",function(){return s.SoundFont2})},"./src/riff/chunkIterator.ts":function(e,i,n){n.r(i),n.d(i,"ChunkIterator",function(){return s});var o=n("./src/utils/index.ts");function a(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")}function l(c,d){for(var f=0;f<d.length;f++){var p=d[f];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function u(c,d,f){return d in c?Object.defineProperty(c,d,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[d]=f,c}var s=function(){function c(p){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;a(this,c),u(this,"target",[]),u(this,"chunk",void 0),u(this,"position",0),this.chunk=p,this.position=h}var d,f;return d=c,(f=[{key:"iterate",value:function(p){for(;this.position<this.chunk.length;){var h=p(this);h&&this.target.push(h)}}},{key:"getString",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20,h=Object(o.getStringFromBuffer)(this.getBuffer(this.position,p));return this.position+=p,h}},{key:"getInt16",value:function(){return this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8}},{key:"getInt16BE",value:function(){return this.getInt16()<<16>>16}},{key:"getUInt32",value:function(){return(this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8|this.chunk.buffer[this.position++]<<16|this.chunk.buffer[this.position++]<<24)>>>0}},{key:"getByte",value:function(){return this.chunk.buffer[this.position++]}},{key:"getChar",value:function(){return this.chunk.buffer[this.position++]<<24>>24}},{key:"skip",value:function(p){this.position+=p}},{key:"getBuffer",value:function(p,h){return this.chunk.buffer.subarray(p,p+h)}},{key:"currentPosition",get:function(){return this.position}}])&&l(d.prototype,f),c}()},"./src/riff/index.ts":function(e,i,n){n.r(i);var o=n("./src/riff/chunkIterator.ts");n.d(i,"ChunkIterator",function(){return o.ChunkIterator});var a=n("./src/riff/parseError.ts");n.d(i,"ParseError",function(){return a.ParseError});var l=n("./src/riff/parser.ts");n.d(i,"parseBuffer",function(){return l.parseBuffer}),n.d(i,"getChunk",function(){return l.getChunk}),n.d(i,"getChunkLength",function(){return l.getChunkLength}),n.d(i,"getSubChunks",function(){return l.getSubChunks}),n.d(i,"getChunkId",function(){return l.getChunkId});var u=n("./src/riff/riffChunk.ts");n.d(i,"RIFFChunk",function(){return u.RIFFChunk})},"./src/riff/parseError.ts":function(e,i,n){function o(p){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(p)}function a(p,h){return!h||o(h)!=="object"&&typeof h!="function"?function(g){if(g===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}(p):h}function l(p){var h=typeof Map=="function"?new Map:void 0;return(l=function(g){if(g===null||(m=g,Function.toString.call(m).indexOf("[native code]")===-1))return g;var m;if(typeof g!="function")throw new TypeError("Super expression must either be null or a function");if(h!==void 0){if(h.has(g))return h.get(g);h.set(g,b)}function b(){return s(g,arguments,d(this).constructor)}return b.prototype=Object.create(g.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c(b,g)})(p)}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function s(p,h,g){return(s=u()?Reflect.construct:function(m,b,y){var w=[null];w.push.apply(w,b);var v=new(Function.bind.apply(m,w));return y&&c(v,y.prototype),v}).apply(null,arguments)}function c(p,h){return(c=Object.setPrototypeOf||function(g,m){return g.__proto__=m,g})(p,h)}function d(p){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(p)}n.r(i),n.d(i,"ParseError",function(){return f});var f=function(p){function h(g,m,b){return function(y,w){if(!(y instanceof w))throw new TypeError("Cannot call a class as a function")}(this,h),a(this,d(h).call(this,"".concat(g).concat(m&&b?", expected ".concat(m,", received ").concat(b):"")))}return function(g,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(m&&m.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),m&&c(g,m)}(h,p),h}(l(Error))},"./src/riff/parser.ts":function(e,i,n){n.r(i),n.d(i,"parseBuffer",function(){return u}),n.d(i,"getChunk",function(){return s}),n.d(i,"getChunkLength",function(){return c}),n.d(i,"getSubChunks",function(){return d}),n.d(i,"getChunkId",function(){return f});var o=n("./src/riff/parseError.ts"),a=n("./src/utils/buffer.ts"),l=n("./src/riff/riffChunk.ts"),u=function(p){var h=f(p);if(h!=="RIFF")throw new o.ParseError("Invalid file format","RIFF",h);var g=f(p,8);if(g!=="sfbk")throw new o.ParseError("Invalid signature","sfbk",g);var m=p.subarray(8),b=d(m.subarray(4));return new l.RIFFChunk(h,m.length,m,b)},s=function(p,h){var g=f(p,h),m=c(p,h+4),b=[];return g!=="RIFF"&&g!=="LIST"||(b=d(p.subarray(h+12))),new l.RIFFChunk(g,m,p.subarray(h+8),b)},c=function(p,h){return((p=p.subarray(h,h+4))[0]|p[1]<<8|p[2]<<16|p[3]<<24)>>>0},d=function(p){for(var h=[],g=0;g<=p.length-8;){var m=s(p,g);h.push(m),g=(g+=8+m.length)%2?g+1:g}return h},f=function(p){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Object(a.getStringFromBuffer)(p.subarray(h,h+4))}},"./src/riff/riffChunk.ts":function(e,i,n){n.r(i),n.d(i,"RIFFChunk",function(){return s});var o=n("./src/riff/chunkIterator.ts"),a=n("./src/utils/index.ts");function l(c,d){for(var f=0;f<d.length;f++){var p=d[f];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function u(c,d,f){return d in c?Object.defineProperty(c,d,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[d]=f,c}var s=function(){function c(p,h,g,m){(function(b,y){if(!(b instanceof y))throw new TypeError("Cannot call a class as a function")})(this,c),u(this,"id",void 0),u(this,"length",void 0),u(this,"buffer",void 0),u(this,"subChunks",void 0),this.id=p,this.length=h,this.buffer=g,this.subChunks=m}var d,f;return d=c,(f=[{key:"getString",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,h=arguments.length>1?arguments[1]:void 0;return Object(a.getStringFromBuffer)(this.getBuffer(p,h||this.length-p))}},{key:"getInt16",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[p++]|this.buffer[p]<<8}},{key:"getUInt32",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(this.buffer[p++]|this.buffer[p++]<<8|this.buffer[p++]<<16|this.buffer[p]<<24)>>>0}},{key:"getByte",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[p]}},{key:"getChar",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[p]<<24>>24}},{key:"iterator",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new o.ChunkIterator(this,p)}},{key:"iterate",value:function(p){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,g=new o.ChunkIterator(this,h);return g.iterate(p),g.target}},{key:"getBuffer",value:function(p,h){return this.buffer.subarray(p,p+h)}}])&&l(d.prototype,f),c}()},"./src/soundFont2.ts":function(e,i,n){n.r(i),n.d(i,"SoundFont2",function(){return h});var o=n("./src/types/index.ts"),a=n("./src/chunk.ts"),l=n("./src/riff/index.ts"),u=n("./src/chunks/index.ts"),s=n("./src/utils/index.ts");function c(g){for(var m=1;m<arguments.length;m++){var b=arguments[m]!=null?arguments[m]:{},y=Object.keys(b);typeof Object.getOwnPropertySymbols=="function"&&(y=y.concat(Object.getOwnPropertySymbols(b).filter(function(w){return Object.getOwnPropertyDescriptor(b,w).enumerable}))),y.forEach(function(w){p(g,w,b[w])})}return g}function d(g,m){for(var b=0;b<m.length;b++){var y=m[b];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(g,y.key,y)}}function f(g,m,b){return m&&d(g.prototype,m),b&&d(g,b),g}function p(g,m,b){return m in g?Object.defineProperty(g,m,{value:b,enumerable:!0,configurable:!0,writable:!0}):g[m]=b,g}var h=function(){function g(m){if(function(y,w){if(!(y instanceof w))throw new TypeError("Cannot call a class as a function")}(this,g),p(this,"chunk",void 0),p(this,"metaData",void 0),p(this,"sampleData",void 0),p(this,"samples",void 0),p(this,"presetData",void 0),p(this,"instruments",void 0),p(this,"presets",void 0),p(this,"banks",void 0),!(m instanceof a.SF2Chunk)){var b=Object(l.parseBuffer)(m);m=new a.SF2Chunk(b)}if(m.subChunks.length!==3)throw new l.ParseError("Invalid sfbk structure","3 chunks","".concat(m.subChunks.length," chunks"));this.chunk=m,this.metaData=m.subChunks[0].getMetaData(),this.sampleData=m.subChunks[1].getSampleData(),this.presetData=m.subChunks[2].getPresetData(),this.samples=this.getSamples(),this.instruments=this.getInstruments(),this.presets=this.getPresets(),this.banks=this.getBanks()}return f(g,null,[{key:"from",value:function(m){return new g(m)}}]),f(g,[{key:"getKeyData",value:function(m){var b=this,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Object(s.memoize)(function(v,k,_){var C=b.banks[k];if(C){var S=C.presets[_];if(S){var P=S.zones.filter(function(ee){return b.isKeyInRange(ee,v)});if(P.length>0){var T=!0,x=!1,$=void 0;try{for(var O,N=P[Symbol.iterator]();!(T=(O=N.next()).done);T=!0){var A=O.value,L=A.instrument,V=L.zones.filter(function(ee){return b.isKeyInRange(ee,v)});if(V.length>0){var Z=!0,G=!1,J=void 0;try{for(var ue,de=V[Symbol.iterator]();!(Z=(ue=de.next()).done);Z=!0){var R=ue.value,F=R.sample,z=c({},A.generators,R.generators),q=c({},A.modulators,R.modulators);return{keyNumber:v,preset:S,instrument:L,sample:F,generators:z,modulators:q}}}catch(ee){G=!0,J=ee}finally{try{Z||de.return==null||de.return()}finally{if(G)throw J}}}}}catch(ee){x=!0,$=ee}finally{try{T||N.return==null||N.return()}finally{if(x)throw $}}}}}return null})(m,y,w)}},{key:"isKeyInRange",value:function(m,b){return m.keyRange===void 0||m.keyRange.lo<=b&&m.keyRange.hi>=b}},{key:"getBanks",value:function(){return this.presets.reduce(function(m,b){var y=b.header.bank;return m[y]||(m[y]={presets:[]}),m[y].presets[b.header.preset]=b,m},[])}},{key:"getPresets",value:function(){var m=this.presetData,b=m.presetHeaders,y=m.presetZones,w=m.presetGenerators,v=m.presetModulators;return Object(u.getItemsInZone)(b,y,v,w,this.instruments,o.GeneratorType.Instrument).filter(function(k){return k.header.name!=="EOP"}).map(function(k){return{header:k.header,globalZone:k.globalZone,zones:k.zones.map(function(_){return{keyRange:_.keyRange,generators:_.generators,modulators:_.modulators,instrument:_.reference}})}})}},{key:"getInstruments",value:function(){var m=this.presetData,b=m.instrumentHeaders,y=m.instrumentZones,w=m.instrumentModulators,v=m.instrumentGenerators;return Object(u.getItemsInZone)(b,y,w,v,this.samples,o.GeneratorType.SampleId).filter(function(k){return k.header.name!=="EOI"}).map(function(k){return{header:k.header,globalZone:k.globalZone,zones:k.zones.map(function(_){return{keyRange:_.keyRange,generators:_.generators,modulators:_.modulators,sample:_.reference}})}})}},{key:"getSamples",value:function(){var m=this;return this.presetData.sampleHeaders.filter(function(b){return b.name!=="EOS"}).map(function(b){if(b.name!=="EOS"&&b.sampleRate<=0)throw new Error("Illegal sample rate of ".concat(b.sampleRate," hz in sample '").concat(b.name,"'"));return b.originalPitch>=128&&b.originalPitch<=254&&(b.originalPitch=60),b.startLoop-=b.start,b.endLoop-=b.start,{header:b,data:new Int16Array(new Uint8Array(m.sampleData.subarray(2*b.start,2*b.end)).buffer)}})}}]),g}()},"./src/types/bank.ts":function(e,i){},"./src/types/generator.ts":function(e,i,n){var o,a;function l(s,c,d){return c in s?Object.defineProperty(s,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):s[c]=d,s}n.r(i),n.d(i,"GeneratorType",function(){return a}),n.d(i,"DEFAULT_GENERATOR_VALUES",function(){return u}),function(s){s[s.StartAddrsOffset=0]="StartAddrsOffset",s[s.EndAddrsOffset=1]="EndAddrsOffset",s[s.StartLoopAddrsOffset=2]="StartLoopAddrsOffset",s[s.EndLoopAddrsOffset=3]="EndLoopAddrsOffset",s[s.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",s[s.ModLFOToPitch=5]="ModLFOToPitch",s[s.VibLFOToPitch=6]="VibLFOToPitch",s[s.ModEnvToPitch=7]="ModEnvToPitch",s[s.InitialFilterFc=8]="InitialFilterFc",s[s.InitialFilterQ=9]="InitialFilterQ",s[s.ModLFOToFilterFc=10]="ModLFOToFilterFc",s[s.ModEnvToFilterFc=11]="ModEnvToFilterFc",s[s.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",s[s.ModLFOToVolume=13]="ModLFOToVolume",s[s.Unused1=14]="Unused1",s[s.ChorusEffectsSend=15]="ChorusEffectsSend",s[s.ReverbEffectsSend=16]="ReverbEffectsSend",s[s.Pan=17]="Pan",s[s.Unused2=18]="Unused2",s[s.Unused3=19]="Unused3",s[s.Unused4=20]="Unused4",s[s.DelayModLFO=21]="DelayModLFO",s[s.FreqModLFO=22]="FreqModLFO",s[s.DelayVibLFO=23]="DelayVibLFO",s[s.FreqVibLFO=24]="FreqVibLFO",s[s.DelayModEnv=25]="DelayModEnv",s[s.AttackModEnv=26]="AttackModEnv",s[s.HoldModEnv=27]="HoldModEnv",s[s.DecayModEnv=28]="DecayModEnv",s[s.SustainModEnv=29]="SustainModEnv",s[s.ReleaseModEnv=30]="ReleaseModEnv",s[s.KeyNumToModEnvHold=31]="KeyNumToModEnvHold",s[s.KeyNumToModEnvDecay=32]="KeyNumToModEnvDecay",s[s.DelayVolEnv=33]="DelayVolEnv",s[s.AttackVolEnv=34]="AttackVolEnv",s[s.HoldVolEnv=35]="HoldVolEnv",s[s.DecayVolEnv=36]="DecayVolEnv",s[s.SustainVolEnv=37]="SustainVolEnv",s[s.ReleaseVolEnv=38]="ReleaseVolEnv",s[s.KeyNumToVolEnvHold=39]="KeyNumToVolEnvHold",s[s.KeyNumToVolEnvDecay=40]="KeyNumToVolEnvDecay",s[s.Instrument=41]="Instrument",s[s.Reserved1=42]="Reserved1",s[s.KeyRange=43]="KeyRange",s[s.VelRange=44]="VelRange",s[s.StartLoopAddrsCoarseOffset=45]="StartLoopAddrsCoarseOffset",s[s.KeyNum=46]="KeyNum",s[s.Velocity=47]="Velocity",s[s.InitialAttenuation=48]="InitialAttenuation",s[s.Reserved2=49]="Reserved2",s[s.EndLoopAddrsCoarseOffset=50]="EndLoopAddrsCoarseOffset",s[s.CoarseTune=51]="CoarseTune",s[s.FineTune=52]="FineTune",s[s.SampleId=53]="SampleId",s[s.SampleModes=54]="SampleModes",s[s.Reserved3=55]="Reserved3",s[s.ScaleTuning=56]="ScaleTuning",s[s.ExclusiveClass=57]="ExclusiveClass",s[s.OverridingRootKey=58]="OverridingRootKey",s[s.Unused5=59]="Unused5",s[s.EndOper=60]="EndOper"}(a||(a={}));var u=(l(o={},a.StartAddrsOffset,0),l(o,a.EndAddrsOffset,0),l(o,a.StartLoopAddrsOffset,0),l(o,a.EndLoopAddrsOffset,0),l(o,a.StartAddrsCoarseOffset,0),l(o,a.ModLFOToPitch,0),l(o,a.VibLFOToPitch,0),l(o,a.ModEnvToPitch,0),l(o,a.InitialFilterFc,13500),l(o,a.InitialFilterQ,0),l(o,a.ModLFOToFilterFc,0),l(o,a.ModEnvToFilterFc,0),l(o,a.EndAddrsCoarseOffset,0),l(o,a.ModLFOToVolume,0),l(o,a.ChorusEffectsSend,0),l(o,a.ReverbEffectsSend,0),l(o,a.Pan,0),l(o,a.DelayModLFO,-12e3),l(o,a.FreqModLFO,0),l(o,a.DelayVibLFO,-12e3),l(o,a.FreqVibLFO,0),l(o,a.DelayModEnv,-12e3),l(o,a.AttackModEnv,-12e3),l(o,a.HoldModEnv,-12e3),l(o,a.DecayModEnv,-12e3),l(o,a.SustainModEnv,0),l(o,a.ReleaseModEnv,-12e3),l(o,a.KeyNumToModEnvHold,0),l(o,a.KeyNumToModEnvDecay,0),l(o,a.DelayVolEnv,-12e3),l(o,a.AttackVolEnv,-12e3),l(o,a.HoldVolEnv,-12e3),l(o,a.DecayVolEnv,-12e3),l(o,a.SustainVolEnv,0),l(o,a.ReleaseVolEnv,-12e3),l(o,a.KeyNumToVolEnvHold,0),l(o,a.KeyNumToVolEnvDecay,0),l(o,a.StartLoopAddrsCoarseOffset,0),l(o,a.KeyNum,-1),l(o,a.Velocity,-1),l(o,a.InitialAttenuation,0),l(o,a.EndLoopAddrsCoarseOffset,0),l(o,a.CoarseTune,0),l(o,a.FineTune,0),l(o,a.SampleModes,0),l(o,a.ScaleTuning,100),l(o,a.ExclusiveClass,0),l(o,a.OverridingRootKey,-1),o)},"./src/types/index.ts":function(e,i,n){n.r(i);var o=n("./src/types/bank.ts");for(var a in o)["default"].indexOf(a)<0&&function(m){n.d(i,m,function(){return o[m]})}(a);var l=n("./src/types/generator.ts");n.d(i,"GeneratorType",function(){return l.GeneratorType}),n.d(i,"DEFAULT_GENERATOR_VALUES",function(){return l.DEFAULT_GENERATOR_VALUES});var u=n("./src/types/instrument.ts");for(var a in u)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(b){n.d(i,b,function(){return u[b]})}(a);var s=n("./src/types/key.ts");for(var a in s)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(b){n.d(i,b,function(){return s[b]})}(a);var c=n("./src/types/metaData.ts");for(var a in c)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(b){n.d(i,b,function(){return c[b]})}(a);var d=n("./src/types/modulator.ts");n.d(i,"ControllerType",function(){return d.ControllerType}),n.d(i,"ControllerPolarity",function(){return d.ControllerPolarity}),n.d(i,"ControllerDirection",function(){return d.ControllerDirection}),n.d(i,"ControllerPalette",function(){return d.ControllerPalette}),n.d(i,"Controller",function(){return d.Controller}),n.d(i,"TransformType",function(){return d.TransformType}),n.d(i,"DEFAULT_INSTRUMENT_MODULATORS",function(){return d.DEFAULT_INSTRUMENT_MODULATORS});var f=n("./src/types/preset.ts");for(var a in f)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(a)<0&&function(b){n.d(i,b,function(){return f[b]})}(a);var p=n("./src/types/presetData.ts");for(var a in p)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(a)<0&&function(b){n.d(i,b,function(){return p[b]})}(a);var h=n("./src/types/sample.ts");n.d(i,"SampleType",function(){return h.SampleType});var g=n("./src/types/zone.ts");for(var a in g)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","SampleType"].indexOf(a)<0&&function(b){n.d(i,b,function(){return g[b]})}(a)},"./src/types/instrument.ts":function(e,i){},"./src/types/key.ts":function(e,i){},"./src/types/metaData.ts":function(e,i){},"./src/types/modulator.ts":function(e,i,n){n.r(i),n.d(i,"ControllerType",function(){return o}),n.d(i,"ControllerPolarity",function(){return a}),n.d(i,"ControllerDirection",function(){return l}),n.d(i,"ControllerPalette",function(){return u}),n.d(i,"Controller",function(){return s}),n.d(i,"TransformType",function(){return c}),n.d(i,"DEFAULT_INSTRUMENT_MODULATORS",function(){return f});var o,a,l,u,s,c,d=n("./src/types/generator.ts");(function(p){p[p.Linear=0]="Linear",p[p.Concave=1]="Concave",p[p.Convex=2]="Convex",p[p.Switch=3]="Switch"})(o||(o={})),function(p){p[p.Unipolar=0]="Unipolar",p[p.Bipolar=1]="Bipolar"}(a||(a={})),function(p){p[p.Increasing=0]="Increasing",p[p.Decreasing=1]="Decreasing"}(l||(l={})),function(p){p[p.GeneralController=0]="GeneralController",p[p.MidiController=1]="MidiController"}(u||(u={})),function(p){p[p.NoController=0]="NoController",p[p.NoteOnVelocity=2]="NoteOnVelocity",p[p.NoteOnKeyNumber=3]="NoteOnKeyNumber",p[p.PolyPressure=10]="PolyPressure",p[p.ChannelPressure=13]="ChannelPressure",p[p.PitchWheel=14]="PitchWheel",p[p.PitchWheelSensitivity=16]="PitchWheelSensitivity",p[p.Link=127]="Link"}(s||(s={})),function(p){p[p.Linear=0]="Linear",p[p.Absolute=2]="Absolute"}(c||(c={}));var f=[{id:d.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:l.Decreasing,palette:u.GeneralController,index:s.NoteOnVelocity},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:d.GeneratorType.InitialFilterFc,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Decreasing,palette:u.GeneralController,index:s.NoteOnVelocity},value:-2400,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:d.GeneratorType.VibLFOToPitch,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.ChannelPressure},value:50,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:d.GeneratorType.VibLFOToPitch,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.MidiController,index:1},value:50,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:d.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:l.Decreasing,palette:u.MidiController,index:7},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:d.GeneratorType.InitialAttenuation,source:{type:o.Linear,polarity:a.Bipolar,direction:l.Increasing,palette:u.MidiController,index:10},value:1e3,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:d.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:l.Decreasing,palette:u.MidiController,index:11},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:d.GeneratorType.ReverbEffectsSend,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.MidiController,index:91},value:200,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:d.GeneratorType.ChorusEffectsSend,source:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.MidiController,index:93},value:200,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.NoController},transform:c.Linear},{id:d.GeneratorType.CoarseTune,source:{type:o.Linear,polarity:a.Bipolar,direction:l.Increasing,palette:u.GeneralController,index:s.PitchWheel},value:12700,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:l.Increasing,palette:u.GeneralController,index:s.PitchWheelSensitivity},transform:c.Linear}]},"./src/types/preset.ts":function(e,i){},"./src/types/presetData.ts":function(e,i){},"./src/types/sample.ts":function(e,i,n){var o;n.r(i),n.d(i,"SampleType",function(){return o}),function(a){a[a.EOS=0]="EOS",a[a.Mono=1]="Mono",a[a.Right=2]="Right",a[a.Left=4]="Left",a[a.Linked=8]="Linked",a[a.RomMono=32769]="RomMono",a[a.RomRight=32770]="RomRight",a[a.RomLeft=32772]="RomLeft",a[a.RomLinked=32776]="RomLinked"}(o||(o={}))},"./src/types/zone.ts":function(e,i){},"./src/utils/buffer.ts":function(e,i,n){n.r(i),n.d(i,"getStringFromBuffer",function(){return o});var o=function(a){var l=new TextDecoder("utf8").decode(a),u=l.indexOf("\0");return(u===-1?l:l.slice(0,u)).trim()}},"./src/utils/index.ts":function(e,i,n){n.r(i);var o=n("./src/utils/buffer.ts");n.d(i,"getStringFromBuffer",function(){return o.getStringFromBuffer});var a=n("./src/utils/memoize.ts");n.d(i,"memoize",function(){return a.memoize})},"./src/utils/memoize.ts":function(e,i,n){n.r(i),n.d(i,"memoize",function(){return o});var o=function(a){var l={};return function(){for(var u=arguments.length,s=new Array(u),c=0;c<u;c++)s[c]=arguments[c];var d=JSON.stringify(s);if(d in l)return l[d];var f=a.apply(void 0,s);return l[d]=f,f}}}})})}(Hi)),Hi.exports}var Mu=uy(),dy=Y("<img width=120px height=120px src=./cat-node.jpg>");class py{componentType=Ko;ext;constructor(){this.ext={initAudioCtx:async(r,e)=>{const n=await fetch("./Thurston Waffles.sf2").then(g=>g.arrayBuffer()),o=new Mu.SoundFont2(new Uint8Array(n)),a=o.presets[0];if(!a)throw new Error("Preset at index 0 not found.");const l=o.instruments[a.header.bagIndex];if(!l)throw new Error("No instrument found for preset at index 0");const u=(g,m)=>{for(const b of g.zones)if(b.keyRange!=null&&m>=b.keyRange.lo&&m<=b.keyRange.hi)return b.sample;return null};let s=60;const c=u(l,s);if(!c)throw new Error(`No sample found for note ${s} in preset 0.`);const d=c.header.sampleRate,f=c.data.length,p=new Float32Array(f);for(let g=0;g<f;g++)p[g]=c.data[g]/32768;const h=c.header.originalPitch;e.port.postMessage({type:"meowData",params:{meowOriginalPitch:h,meowSampleRate:d,meowData:p}})},generateInitOnceCode:({ctx:r})=>{r.insertGlobalCode(["let meowOriginalPitch = undefined;","let meowSampleRate = undefined;","let meowData = undefined;","let meowStepPerHz = undefined;"]),r.insertMessageHandlerCode("meowData",["meowOriginalPitch = params.meowOriginalPitch;","meowSampleRate = params.meowSampleRate;","meowData = params.meowData;",`meowStepPerHz = meowSampleRate / (sampleRate * ${261.625565});`])}}}create(r){return new fy(r)}}const Ou=new py;class fy{type=Ou;nodeParams;inputPins;outputPins;ui;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"frequency",source:()=>e.frequency,setSource:n=>i("frequency",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ui=E(()=>()=>dy()),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let l=n.allocField("0.0"),u=n.allocField("0.0"),s=new Map,c=n.allocField("0.0"),d=n.allocField("0");return n.insertCode([`if (meowData == undefined || ${a} != ${l}) {`,`  ${u} = 0.0;`,`  ${c} = 0.0;`,`  ${l} = ${a};`,"} else {",`  if (${c} >= meowData.length) {`,`    ${u} = 0.0;`,"  } else {",`    ${d} = Math.floor(${c});`,`    let value = meowData[${d}];`,`    ${u} = value;`,`    let step = ${a} * meowStepPerHz;`,`    ${c} += step;`,"  }","}"]),s.set("out",u),[{outputAtoms:s}]}}}}const hy=H({a:U(M),b:U(M),out:ne(M)}),Fu=new re({typeName:"Mult",typeSchema:hy});class my{componentType=Fu;ext={};create(r){return new gy(r)}}const Du=new my;class gy{type=Du;nodeParams;inputPins;outputPins;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"a",source:()=>e.a,setSource:n=>i("a",n)},{name:"b",source:()=>e.b,setSource:n=>i("b",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("a");if(a==null)return[];let l=o.get("b");if(l==null)return[];let u=n.allocField("0.0");n.insertCode([`${u} = ${a} * ${l}`]);let s=new Map;return s.set("out",u),[{outputAtoms:s}]}}}}const yy=H({out:ne(M)}),zu=new re({typeName:"NoiseWave",typeSchema:yy});class by{componentType=zu;ext={};create(r){return new vy(r)}}const Lu=new by;class vy{type=Lu;nodeParams;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}])}}const wy=H({entity:kt(),note:kt(),out:ne(M)}),ju=new re({typeName:"Note",typeSchema:wy});class ky{componentType=ju;ext={};create(r){return new xy(r)}}const ea=new ky;class xy{type=ea;nodeParams;outputPins;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:a=>i("out",a)}]);const n=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=261.63;this.ext={generateCode:({ctx:a,inputAtoms:l})=>{let u=n.indexOf(e.note);if(u==-1)return[];let s=o*Math.pow(2,u/12),c=a.allocField("0.0"),d=new Map;return d.set("out",c),a.insertCode([`if (noteDown["${e.entity}/${e.note}"]) {`,`  ${c} = ${s};`,"} else {",`  ${c} = 0.0;`,"}"]),[{outputAtoms:d}]}}}}var _y=Y("<input class=input type=text size=8>");let Sy=class{componentType=Mr;ext={};create(r){return new Cy(r)}};const Uu=new Sy;let Cy=class{type=Uu;nodeParams;outputPins;ui;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ui=E(()=>()=>{let[n,o]=je({valueText:ye(()=>e.value.toFixed(3))});return ve(he(()=>n.valueText,()=>{let a=Number.parseFloat(n.valueText);Number.isNaN(a)||i("value",a)},{defer:!0})),(()=>{var a=_y();return a.$$input=l=>{o("valueText",l.currentTarget.value)},le(()=>a.value=n.valueText),a})()}),this.ext={generateCode:({ctx:n})=>{let o=new Map;return o.set("out",`${e.value}`),[{outputAtoms:o}]}}}};Oe(["input"]);const Py=H({out:ne(M)}),Bu=new re({typeName:"PianoKeys",typeSchema:Py});var Ty=Y("<div class=piano>"),Ey=Y("<div class=white-key>"),$y=Y("<div class=black-key>");const Iy=t=>{const r=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}],e=150,i=80;let n,o=new Jt,a=new gt;return(()=>{var l=Ty();l.$$pointermove=s=>{if(!o.get(s.pointerId))return;let c=n.getBoundingClientRect();o.set(s.pointerId,K.create(s.clientX-c.left,s.clientY-c.top))},l.addEventListener("pointercancel",s=>{o.delete(s.pointerId),n.releasePointerCapture(s.pointerId)}),l.$$pointerup=s=>{o.delete(s.pointerId),n.releasePointerCapture(s.pointerId)},l.$$pointerdown=s=>{let c=n.getBoundingClientRect();o.set(s.pointerId,K.create(s.clientX-c.left,s.clientY-c.top)),n.setPointerCapture(s.pointerId)};var u=n;return typeof u=="function"?Ce(u,l):n=l,l.style.setProperty("display","flex"),l.style.setProperty("flex-direction","row"),l.style.setProperty("overflow-x","auto"),l.style.setProperty("user-select","none"),l.style.setProperty("touch-action","none"),te(l,D(pt,{each:r,children:s=>{let[c,d]=oe();s.type=="black"&&ve(()=>{let p=c();p!=null&&(a.add(p),Ne(()=>a.delete(p)))});let f=E(()=>{let p=c();if(p==null)return!1;let h=n.getBoundingClientRect(),g=p.getBoundingClientRect();for(let m of o.values()){let b=h.left+m.x-g.left,y=h.top+m.y-g.top;if(0<b&&b<g.width&&0<y&&y<g.height){if(s.type=="white")for(let w of a){let v=w.getBoundingClientRect(),k=h.left+m.x-v.left,_=h.top+m.y-v.top;if(0<k&&k<v.width&&0<_&&_<v.height)return!1}return!0}}return!1});return ve(he(f,p=>{p?t.onNoteOn(s.name):t.onNoteOff(s.name)},{defer:!0})),D(An,{get children(){return[D($t,{get when(){return s.type=="white"},get children(){var p=Ey(),h=d;return typeof h=="function"?Ce(h,p):d=p,p.style.setProperty("width","50px"),p.style.setProperty("pointer-events","none"),le(g=>{var m=!!f(),b=`${e+(f()?2:0)}px`;return m!==g.e&&p.classList.toggle("pressed",g.e=m),b!==g.t&&((g.t=b)!=null?p.style.setProperty("height",b):p.style.removeProperty("height")),g},{e:void 0,t:void 0}),p}}),D($t,{get when(){return s.type=="black"},get children(){var p=$y(),h=d;return typeof h=="function"?Ce(h,p):d=p,p.style.setProperty("margin-left","-16px"),p.style.setProperty("margin-right","-14px"),p.style.setProperty("width","30px"),p.style.setProperty("pointer-events","none"),le(g=>{var m=!!f(),b=`${i+(f()?2:0)}px`;return m!==g.e&&p.classList.toggle("pressed",g.e=m),b!==g.t&&((g.t=b)!=null?p.style.setProperty("height",b):p.style.removeProperty("height")),g},{e:void 0,t:void 0}),p}})]}})}})),l})()};Oe(["pointerdown","pointerup","pointermove"]);class Ry{componentType=Bu;ext;constructor(){this.ext={generateInitOnceCode:({ctx:r})=>{r.insertGlobalCode(["let noteDown = {};"]),r.insertMessageHandlerCode("NoteOn",["noteDown[params.id] = true;"]),r.insertMessageHandlerCode("NoteOff",["noteDown[params.id] = false;"])}}}create(r){return new Ny(r)}}const qu=new Ry;class Ny{type=qu;nodeParams;outputPins;ui;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:l=>i("out",l)}]);let[n,o]=oe();this.ui=E(()=>()=>D(Iy,{onNoteOn:l=>{let u=n();u?.port.postMessage({type:"NoteOn",params:{id:`${r.entity}/${l}`}})},onNoteOff:l=>{let u=n();u?.port.postMessage({type:"NoteOff",params:{id:`${r.entity}/${l}`}})}}));const a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];this.ext={macro:(l,u)=>{let s=[],c=[...l.outputs.out];for(let f of c){s.push(f);for(let p=0;p<a.length-1;++p){let h=Cg(f.node,u);s.push({node:h,pin:f.pin})}}let d=0;for(let{node:f,pin:p}of s){let[h,g]=je({entity:r.entity,note:a[d],out:[]}),b={node:ea.create({entity:Ht(),state:h,setState:g}),space:()=>Se.identity,setSpace:()=>{},setRenderSizeAccessor:()=>{},setInputPinPositionMapAccessor:()=>{},setOutputPinPositionMapAccessor:()=>{},renderSize:()=>{},inputPinPositionMap:()=>{},outputPinPositionMap:()=>{}},y={id:0,inputs:{},outputs:{out:[{node:f,pin:p}]},height:0,node:b};u(y),f.inputs[p]={node:y,pin:"out"},++d,d>=a.length&&(d=0)}l.outputs.out=[]},generateCode:({ctx:l})=>{{let u=[];for(let s of a)u.push(`noteDown["${r.entity}/${s}"] = false;`);l.insertGlobalCode(u)}return[{outputAtoms:new Map}]},init:async l=>{o(l)}}}}const Ay=H({timeToZero:U(M),out:ne(M)}),Vu=new re({typeName:"Release",typeSchema:Ay});class My{componentType=Vu;ext={};create(r){return new Oy(r)}}const Gu=new My;class Oy{type=Gu;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"timeToZero",source:()=>e.timeToZero,setSource:n=>i("timeToZero",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}])}}const Fy=H({frequency:U(M),amplitude:U(M),centre:U(M),out:ne(M)}),Wu=new re({typeName:"SawWave",typeSchema:Fy});class Dy{componentType=Wu;ext={};create(r){return new zy(r)}}const Hu=new Dy;class zy{type=Hu;nodeParams;inputPins;outputPins;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"frequency",source:()=>e.frequency,setSource:n=>i("frequency",n)},{name:"amplitude",source:()=>e.amplitude,setSource:n=>i("amplitude",n)},{name:"centre",source:()=>e.centre,setSource:n=>i("centre",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let l=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",s=new Map,c=n.allocField("0.0"),d=n.allocField("0.0");return n.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${d} = ${l} * ((${c} / Math.PI) - 1.0) + ${u};`,`${c} %= 2 * Math.PI;`]),s.set("out",d),[{outputAtoms:s}]}}}}var Ly=Y("<label><span style=color:black;padding-right:5px;>Id:</span><input class=input type=text size=8>");class jy{componentType=Yo;ext={};create(r){return new Uy(r)}}const Zu=new jy;class Uy{type=Zu;nodeParams;inputPins;outputPins;ui;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"prev",source:()=>e.prev,setSource:n=>i("prev",n),isEffectPin:!0},{name:"value",source:()=>e.value,setSource:n=>i("value",n)}]),this.outputPins=E(()=>[{name:"next",sinks:()=>e.next,setSinks:n=>i("next",n),isEffectPin:!0}]),this.ui=E(()=>()=>(()=>{var n=Ly(),o=n.firstChild,a=o.nextSibling;return a.$$input=l=>{i("id",l.currentTarget.value)},le(()=>a.value=e.id),n})()),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let l=o.get("prev");if(l==null)return[];let u=o.get("value");if(u==null)return[];let s=`this.n_${a}_next`;n.addDeclToExistingForField(s,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),n.insertConstructorCode([`${l}.onDone.push(() => {`,`  this.insertRunningEffect(${s});`,"});",`${s}.update = () => {`,`  this.variables["${e.id}"] = ${u};`,"  return true;","};"]);let c=`${s}`,d=new Map;return d.set("next",c),[{outputAtoms:d}]}}}}Oe(["input"]);class By{componentType=Wo;ext={};create(r){return new qy(r)}}const Yu=new By;class qy{type=Yu;nodeParams;inputPins;outputPins;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"frequency",source:()=>e.frequency,setSource:n=>i("frequency",n)},{name:"amplitude",source:()=>e.amplitude,setSource:n=>i("amplitude",n)},{name:"centre",source:()=>e.centre,setSource:n=>i("centre",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let l=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",s=new Map,c=n.allocField("0.0"),d=n.allocField("0.0");return n.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${d} = ${l} * Math.sin(${c}) + ${u};`,`${c} %= 2 * Math.PI;`]),s.set("out",d),[{outputAtoms:s}]}}}}var Vy=Y('<i class="fa-solid fa-volume-high">');class Gy{componentType=Jo;ext={};create(r){return new Wy(r)}}const Xu=new Gy;class Wy{type=Xu;nodeParams;inputPins;ui;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"in",source:()=>e.in,setSource:n=>i("in",n)}]),this.ui=E(()=>()=>(()=>{var n=Vy();return n.style.setProperty("font-size","24px"),n.style.setProperty("color","green"),n})()),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("in");return a==null?[]:(n.insertCode([`result += ${a}`]),[{outputAtoms:new Map}])}}}}const Hy=H({frequency:U(M),amplitude:U(M),centre:U(M),out:ne(M)}),Ku=new re({typeName:"SquareWave",typeSchema:Hy});class Zy{componentType=Ku;ext={};create(r){return new Yy(r)}}const Ju=new Zy;class Yy{type=Ju;nodeParams;inputPins;outputPins;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"frequency",source:()=>e.frequency,setSource:n=>i("frequency",n)},{name:"amplitude",source:()=>e.amplitude,setSource:n=>i("amplitude",n)},{name:"centre",source:()=>e.centre,setSource:n=>i("centre",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let l=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",s=new Map,c=n.allocField("0.0"),d=n.allocField("0.0");return n.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${d} = ${l} * (${c} < Math.PI ? -1 : 1) + ${u};`,`${c} %= 2 * Math.PI;`]),s.set("out",d),[{outputAtoms:s}]}}}}class Xy{componentType=Zo;ext={};create(r){return new Ky(r)}}const Qu=new Xy;class Ky{type=Qu;nodeParams;outputPins;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"next",sinks:()=>e.next,setSinks:n=>i("next",n),isEffectPin:!0}]),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let l=`this.n_${a}_next`;n.addDeclToExistingForField(l,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),n.insertConstructorCode([`${l}.update = () => true;`,`this.insertRunningEffect(${l});`]);let u=`${l}`,s=new Map;return s.set("next",u),[{outputAtoms:s}]}}}}var Jy=Y("<label><span style=color:black;padding-right:5px;>Id:</span><input class=input type=text size=8>");class Qy{componentType=Xo;ext={};create(r){return new eb(r)}}const ed=new Qy;class eb{type=ed;nodeParams;outputPins;ui;ext;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"value",sinks:()=>e.value,setSinks:n=>i("value",n)}]),this.ui=E(()=>()=>(()=>{var n=Jy(),o=n.firstChild,a=o.nextSibling;return a.$$input=l=>{i("id",l.currentTarget.value)},le(()=>a.value=e.id),n})()),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{n.insertConstructorCode([`this.variables["${e.id}"] = 0.0;`]);let a=`this.variables["${e.id}"]`,l=new Map;return l.set("value",a),[{outputAtoms:l}]}}}}Oe(["input"]);const td=new uu;td.registerNodeTypes([Tu,$u,Iu,Nu,Au,Ou,Du,Lu,ea,Uu,qu,Gu,Hu,Zu,Yu,Xu,Ju,Qu,ed]);const tb=new Vo([...au.componentTypes,Pu,Eu,Ho,Ru,Qo,Ko,Fu,zu,ju,Mr,Bu,Vu,Wu,Yo,Wo,Jo,Ku,Zo,Ae,Xo]);var rb=Y("<div><div>"),nb=Y('<button class="btn btn-primary">Import Midi<input type=file hidden>'),ib=Y("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Show Code"),ob=Y("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Make Sound"),ab=Y("<div><pre>");const sb=t=>{let[r,e]=Oo(t,["world"]),[i,n]=je({showCode:!1,makeSound:!1}),[o,a]=oe();setTimeout(()=>{let c=r.world;c.entities().length==0&&c.createEntity([Wo.create({frequency:void 0,amplitude:void 0,centre:void 0,out:[]}),Ae.create({transform:Se.create(K.create(50,50),_e.rot0)})])});let l=E(()=>{let c=o();if(c!=null&&(i.showCode||i.makeSound))return Pg({nodesSystem:c})});ve(he([()=>i.makeSound,l],([c,d])=>{let f=o();if(f==null||!c||d==null)return;let p=URL.createObjectURL(new Blob([d],{type:"text/javascript"})),h=new AudioContext;(async()=>{await h.audioWorklet.addModule(p);let g=new AudioWorkletNode(h,"compiled-graph-audio-worklet-processor"),m=new Set;for(let b of f.nodes()){let y=b.node.type;m.has(y.componentType.typeName)||(m.add(y.componentType.typeName),await y.ext.initAudioCtx?.(h,g))}for(let b of f.nodes())await b.node.ext.init?.(g);g.connect(h.destination)})(),Ne(()=>{(async()=>(await h.close(),URL.revokeObjectURL(p)))()})}));let[u,s]=oe();return(()=>{var c=rb(),d=c.firstChild;return Ao(c,e,!1,!0),d.style.setProperty("width","100%"),d.style.setProperty("height","100%"),d.style.setProperty("display","flex"),d.style.setProperty("flex-direction","column"),d.style.setProperty("position","relative"),te(d,D(wu,{style:{"flex-grow":"1"},onInit:f=>{a(f.nodesSystem)},componentRegistry:tb,nodeRegistry:td,get world(){return r.world},get toolbar(){return[(()=>{var f=nb(),p=f.firstChild,h=p.nextSibling;f.$$click=()=>{let m=u();m?.click()},h.$$input=m=>{let b=m.currentTarget.files;if(b==null||b.length!=1)return;let y=b[0];Wg(r.world,y),m.currentTarget.value=""};var g=s;return typeof g=="function"?Ce(g,h):s=h,f})(),(()=>{var f=ib(),p=f.firstChild;return p.addEventListener("change",h=>n("showCode",h.currentTarget.checked)),le(()=>p.checked=i.showCode),f})(),(()=>{var f=ob(),p=f.firstChild;return p.addEventListener("change",h=>n("makeSound",h.currentTarget.checked)),le(()=>p.checked=i.makeSound),f})()]}}),null),te(d,D(ge,{get when(){return E(()=>!!i.showCode)()?l():void 0},children:f=>(()=>{var p=ab(),h=p.firstChild;return p.style.setProperty("position","absolute"),p.style.setProperty("right","0"),p.style.setProperty("top","0"),p.style.setProperty("bottom","0"),p.style.setProperty("overflow","auto"),p.style.setProperty("width","50%"),le(()=>h.innerText=f()),p})()}),null),c})()};Oe(["click","input"]);const lb=""+new URL("music-audio-worklet-processor-D_ZxFmGc.js",import.meta.url).href,cb=`attribute vec4 aVertexPosition;

uniform mat4 uModelViewMatrix;

void main(void) {
  gl_Position = uModelViewMatrix * aVertexPosition;
}
`,ub=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif

uniform float time;
uniform float uOffsetY;
uniform vec2 resolution;
uniform float uFocalLength;

float sdRoundBox(vec3 p, vec3 b, float r){
  vec3 q = abs(p) - b + r;
  return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0) - r;
}

float map(vec3 p) {
  p.x += 700.0;
  float b = 100.0*7.0/12.0;
  vec3 p3 = p;
  vec3 p2 = p;
  p.x = mod(p.x + 100.0, 200.0) - 100.0;
  float i = mod(floor((p2.x) / (2.0*b)) - 6.0,12.0);
  p2.x = mod(p2.x, b*2.0);
  bool skipB = false;
  float w = 52.0 * 200.0;
  if ( i == 0.0 || i == 2.0 ||
       i == 4.0 || i == 6.0 ||
       i == 7.0 || i == 9.0 || i == 11.0 ||
       p3.x < -0.5*w+900.0 ||
       p3.x > 0.5*w+600.0
  ) {
    skipB = true;
  }
  float d3;
  float d1 = sdRoundBox(p, vec3(100,600,100), 30.0);
  if (skipB) {
    d3 = d1;
  } else {
    d3 = min(
      d1,
      sdRoundBox(p2 + vec3(-b,-180,-150), vec3(100*7/12,420,50), 20.0)
    );
  }
  return max(d3,
    max(
      p3.x - 0.5 * w - 700.0,
      -p3.x - 0.5 * w + 700.0
    )
  );
}

bool march(vec3 ro, vec3 rd, out float t) {
  vec3 p = ro;
  t = 0.0;
  for (int i = 0; i < 20; ++i) {
    vec3 p = ro + rd*t;
    float d = map(p);
    if (abs(d) < 1.0) {
      return true;
    }
    t += d;
  }
  return false;
}

vec3 normal(vec3 p) {
  float d = 0.001;
  float mp = map(p);
  float dx = map(p + vec3(d,0,0)) - mp;
  float dy = map(p + vec3(0,d,0)) - mp;
  float dz = map(p + vec3(0,0,d)) - mp;
  return normalize(vec3(dx,dy,dz));
}

void main(void) {
  float fl = uFocalLength;
  float d = 52.0 * 200.0 * fl / resolution.x;
  float mx = max(resolution.x, resolution.y);
  vec2 uv = gl_FragCoord.xy / mx;
  vec3 w = normalize(vec3(0, -1, 3));
  vec3 ro = w * d + vec3(0.0, -600.0, 50.0);
  vec3 u = normalize(cross(vec3(0,1,0),w));
  vec3 v = cross(w,u);
  vec3 rd = normalize(
    (gl_FragCoord.x - 0.5 * resolution.x) * u +
    (gl_FragCoord.y - 0.5 * resolution.y) * v +
    -fl * w
  );
  ro -= uOffsetY * v;
  float t = 0.0;
  bool hit = march(ro, rd, t);
  if (!hit) {
    gl_FragColor = vec4(0.2, 0.2, 0.2, 1.0);
    return;
  }
  vec3 p = ro + rd*t;
  vec3 n = normal(p);
  float s = dot(n,normalize(vec3(1,1,1))) + 0.2;
  if (p.z > 101.0) {
    s *= 0.5;
  }
  gl_FragColor = vec4(s,s,s,1.0);
}
`;var db=Y('<div><div><button class="btn btn-primary">Import Midi</button><input type=file hidden><button class="btn btn-primary">Run</button></div><div><canvas>');const pb=50,kn=1e4,fb=t=>{let[r,e]=oe(),[i,n]=oe(),[o,a]=oe();Re(he([r,i],([g,m])=>{if(g==null||m==null)return;let b=g.getBoundingClientRect();m.width=b.width*window.devicePixelRatio,m.height=b.height*window.devicePixelRatio,m.style.setProperty("width",`${b.width}px`),m.style.setProperty("height",`${b.height}px`),a(m.getContext("webgl")??void 0)}));let l=E(he([o,i],([g,m])=>{if(g!=null&&m!=null)return yb(g,m)})),[u,s]=oe(),c=!1,d=!0,f=0,p=g=>{let m=o();if(m==null)return;let b=l();if(b==null||(d&&(f=g,d=!1),!c))return;let y=g-f;b.time=y,gb(b),bb(m,b),requestAnimationFrame(p)},h=async()=>{let g=l();if(g==null)return;let[m,b]=await kb(),y=[],w=g.notesHead,v=0;for(;w!=null;){let k=v++;y.push({id:k,time:w.startTime*.001,note:w.note,type:"On"}),y.push({id:k,time:(w.startTime+w.holdTime)*.001,note:w.note,type:"Off"}),w=w.next}y.sort((k,_)=>{let C=k.time-_.time;return C!=0||(C=k.note-_.note,C!=0)?C:k.type==_.type?0:k.type=="Off"?-1:1}),b.port.postMessage({type:"musicData",params:{noteEvents:y}}),c=!0,d=!0,requestAnimationFrame(p)};return(()=>{var g=db(),m=g.firstChild,b=m.firstChild,y=b.nextSibling,w=y.nextSibling,v=m.nextSibling,k=v.firstChild;g.style.setProperty("flex-grow","1"),g.style.setProperty("display","flex"),g.style.setProperty("flex-direction","column"),g.style.setProperty("overflow","hidden"),b.$$click=()=>{u()?.click()},y.addEventListener("change",P=>{let T=l();if(T==null)return;let x=P.currentTarget.files;if(x==null||x.length==0)return;let $=x[0];hb(T,$),P.currentTarget.value=""});var _=s;typeof _=="function"?Ce(_,y):s=y,w.$$click=()=>h();var C=e;typeof C=="function"?Ce(C,v):e=v,v.style.setProperty("flex-grow","1");var S=n;return typeof S=="function"?Ce(S,k):n=k,g})()};async function hb(t,r){let e=new Cu.Midi(await r.arrayBuffer()),i=[];for(let n of e.tracks){let o=wb();for(let a of n.notes){let l={startTime:a.time*1e3,holdTime:a.duration*1e3,note:a.midi,colourR:o.r,colourG:o.g,colourB:o.b,colourA:1,isAlive:!1,prev:void 0,next:void 0};l.prev=l,i.push(l)}}i.sort((n,o)=>n.startTime-o.startTime);for(let n of i)mb(t,n)}function mb(t,r){if(t.notesHead==null)t.notesHead=t.notesTail=r;else{let e=t.notesTail;e.next=r,r.prev=e,t.notesTail=r}}function gb(t){let r=t.time-t.height/t.fallSpeed,e=t.time,i=t.visibleNotesEnd?.next??t.notesHead;for(;i!=null&&!(i.startTime>=e);)t.visibleNotesEnd==null?t.visibleNotesStart=t.visibleNotesEnd=i:t.visibleNotesEnd=i,t.numVisibleNotes++,i=i.next;for(i=t.visibleNotesStart;;){if(i==null){t.numVisibleNotes=0,t.visibleNotesStart=t.visibleNotesEnd=void 0;break}if(i.startTime+i.holdTime<=r){t.numVisibleNotes--,i=i.next,t.visibleNotesStart=i;continue}break}}function yb(t,r){const e=.5*r.height/Math.tan(.5*pb*Math.PI/180);let i={width:r.width,height:r.height,time:0,fallSpeed:.5,maxNotes:kn,numNotes:0,notesVertices:new Float32Array(kn*8*6),notesGLVertexBuffer:t.createBuffer(),notesHead:void 0,notesTail:void 0,freeNotesHead:void 0,freeNotesTail:void 0,visibleNotesStart:void 0,visibleNotesEnd:void 0,numVisibleNotes:0,program:void 0,positionLocation:-1,colourLocation:-1,textureCoordLocation:-1,pianoVertices:new Float32Array(12),pianoGLVertexBuffer:t.createBuffer(),pianoProgram:void 0,pianoPositionLocation:-1};for(let m=0,b=0;m<kn;++m)i.notesVertices[b+6]=0,i.notesVertices[b+7]=0,b+=8,i.notesVertices[b+6]=1,i.notesVertices[b+7]=0,b+=8,i.notesVertices[b+6]=1,i.notesVertices[b+7]=1,b+=8,i.notesVertices[b+6]=0,i.notesVertices[b+7]=0,b+=8,i.notesVertices[b+6]=1,i.notesVertices[b+7]=1,b+=8,i.notesVertices[b+6]=0,i.notesVertices[b+7]=1,b+=8;const a=sl(t,`
    attribute vec4 aVertexPosition;
    attribute vec4 aColour;
    attribute vec2 aTextureCoord;

    uniform mat4 uModelViewMatrix;

    varying highp vec4 vColour;
    varying highp vec2 vTextureCoord;

    void main(void) {
        gl_Position = uModelViewMatrix * aVertexPosition;
        vTextureCoord = aTextureCoord;
        vColour = aColour;
    }
  `,`
    varying highp vec4 vColour;
    varying highp vec2 vTextureCoord;

    void main(void) {
        gl_FragColor = vColour;
    }
  `);if(a==null)return;const l=sl(t,cb,ub);if(l==null)return;i.program=a,i.pianoProgram=l,t.useProgram(a);const u=t.getUniformLocation(a,"uModelViewMatrix");function s(m,b,y,w){var v=-1,k=1,_=b-m,C=w-y,S=k-v;return[2/_,0,0,0,0,2/C,0,0,0,0,-2/S,0,-(b+m)/_,-(w+y)/C,-(k+v)/S,1]}const c=new Float32Array(s(0,i.width,0,i.height));t.uniformMatrix4fv(u,!1,c),i.positionLocation=t.getAttribLocation(a,"aVertexPosition"),i.colourLocation=t.getAttribLocation(a,"aColour"),i.textureCoordLocation=t.getAttribLocation(a,"aTextureCoord"),t.bindBuffer(t.ARRAY_BUFFER,i.notesGLVertexBuffer),t.bufferData(t.ARRAY_BUFFER,i.notesVertices,t.DYNAMIC_DRAW),t.vertexAttribPointer(i.positionLocation,2,t.FLOAT,!1,8*4,0*4),t.vertexAttribPointer(i.colourLocation,4,t.FLOAT,!1,8*4,4*4),t.vertexAttribPointer(i.textureCoordLocation,2,t.FLOAT,!1,8*4,6*4),t.useProgram(l);const d=t.getUniformLocation(l,"uModelViewMatrix");t.uniformMatrix4fv(d,!1,c);const f=t.getUniformLocation(l,"uFocalLength");t.uniform1f(f,e);const p=t.getUniformLocation(l,"resolution"),h=t.getUniformLocation(l,"uOffsetY");let g;{let m=10400*e/i.width,b=-1,y=3,w=Math.sqrt(b*b+y*y);b/=w,y/=w;let v=y,k=-b,_=b*m-600,C=y*m+50,S=(-600-_)*-b+(-50-C)*-y,P=S*-.5*i.height/e,T=S,x=P+1200*v+400*-b,$=T+1200*k+400*-y,O=P+200*-b,N=P*e/T,A=x*e/$;g=Math.abs(A-N),t.uniform1f(h,O)}return t.uniform2f(p,i.width,i.height),i.pianoPositionLocation=t.getAttribLocation(l,"aVertexPosition"),i.pianoVertices[0]=0,i.pianoVertices[1]=0,i.pianoVertices[2]=i.width,i.pianoVertices[3]=0,i.pianoVertices[4]=i.width,i.pianoVertices[5]=g,i.pianoVertices[6]=0,i.pianoVertices[7]=0,i.pianoVertices[8]=i.width,i.pianoVertices[9]=g,i.pianoVertices[10]=0,i.pianoVertices[11]=g,t.bindBuffer(t.ARRAY_BUFFER,i.pianoGLVertexBuffer),t.bufferData(t.ARRAY_BUFFER,i.pianoVertices,t.DYNAMIC_DRAW),t.vertexAttribPointer(i.pianoPositionLocation,2,t.FLOAT,!1,0,0),t.viewport(0,0,r.width,r.height),i}function bb(t,r){if(r.program==null||r.pianoProgram==null)return;let e=0,i=r.visibleNotesStart,n=0,o=r.width/88;for(t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT);i!=r.visibleNotesEnd?.next&&i!=null;){let a=0;for(;i!=r.visibleNotesEnd?.next&&i!=null;){let l=n+(i.note-21)*o,u=r.height-(r.time-i.startTime)*r.fallSpeed,s=l+o,c=u,d=s,f=c+i.holdTime*r.fallSpeed,p=l,h=f;if(r.notesVertices[e+0]=l,r.notesVertices[e+1]=u,r.notesVertices[e+2]=i.colourR,r.notesVertices[e+3]=i.colourG,r.notesVertices[e+4]=i.colourB,r.notesVertices[e+5]=i.colourA,e+=8,r.notesVertices[e+0]=s,r.notesVertices[e+1]=c,r.notesVertices[e+2]=i.colourR,r.notesVertices[e+3]=i.colourG,r.notesVertices[e+4]=i.colourB,r.notesVertices[e+5]=i.colourA,e+=8,r.notesVertices[e+0]=d,r.notesVertices[e+1]=f,r.notesVertices[e+2]=i.colourR,r.notesVertices[e+3]=i.colourG,r.notesVertices[e+4]=i.colourB,r.notesVertices[e+5]=i.colourA,e+=8,r.notesVertices[e+0]=l,r.notesVertices[e+1]=u,r.notesVertices[e+2]=i.colourR,r.notesVertices[e+3]=i.colourG,r.notesVertices[e+4]=i.colourB,r.notesVertices[e+5]=i.colourA,e+=8,r.notesVertices[e+0]=d,r.notesVertices[e+1]=f,r.notesVertices[e+2]=i.colourR,r.notesVertices[e+3]=i.colourG,r.notesVertices[e+4]=i.colourB,r.notesVertices[e+5]=i.colourA,e+=8,r.notesVertices[e+0]=p,r.notesVertices[e+1]=h,r.notesVertices[e+2]=i.colourR,r.notesVertices[e+3]=i.colourG,r.notesVertices[e+4]=i.colourB,r.notesVertices[e+5]=i.colourA,e+=8,i=i.next,++a,a>=kn)break}a!=null&&(t.useProgram(r.program),t.bindBuffer(t.ARRAY_BUFFER,r.notesGLVertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,r.notesVertices.subarray(0,a*8*6)),t.vertexAttribPointer(r.positionLocation,2,t.FLOAT,!1,8*4,0*4),t.vertexAttribPointer(r.colourLocation,4,t.FLOAT,!1,8*4,4*4),t.vertexAttribPointer(r.textureCoordLocation,2,t.FLOAT,!1,8*4,6*4),t.enableVertexAttribArray(r.positionLocation),t.enableVertexAttribArray(r.colourLocation),t.enableVertexAttribArray(r.textureCoordLocation),t.drawArrays(t.TRIANGLES,0,a*6),t.disableVertexAttribArray(r.positionLocation),t.disableVertexAttribArray(r.colourLocation),t.disableVertexAttribArray(r.textureCoordLocation))}t.useProgram(r.pianoProgram),t.bindBuffer(t.ARRAY_BUFFER,r.pianoGLVertexBuffer),t.vertexAttribPointer(r.pianoPositionLocation,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r.pianoPositionLocation),t.drawArrays(t.TRIANGLES,0,6),t.disableVertexAttribArray(r.pianoPositionLocation)}function al(t,r,e){const i=t.createShader(r);if(i!=null){if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){console.error("An error occurred compiling the shaders: "+t.getShaderInfoLog(i)),t.deleteShader(i);return}return i}}function sl(t,r,e){const i=al(t,t.VERTEX_SHADER,r),n=al(t,t.FRAGMENT_SHADER,e);if(i==null||n==null)return;const o=t.createProgram();if(t.attachShader(o,i),t.attachShader(o,n),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS)){console.error("Unable to initialize the shader program: "+t.getProgramInfoLog(o));return}return o}function vb(t,r,e){let i,n,o;const a=Math.floor(t*6),l=t*6-a,u=e*(1-r),s=e*(1-l*r),c=e*(1-(1-l)*r);switch(a%6){case 0:i=e,n=c,o=u;break;case 1:i=s,n=e,o=u;break;case 2:i=u,n=e,o=c;break;case 3:i=u,n=s,o=e;break;case 4:i=c,n=u,o=e;break;case 5:i=e,n=u,o=s;break;default:i=0,n=0,o=0;break}return{r:i,g:n,b:o}}function wb(){const t=Math.random(),r=Math.random()*(1-.7)+.7;return vb(t,r,1)}async function kb(){let t=new AudioContext;await t.audioWorklet.addModule(lb);let r=new AudioWorkletNode(t,"music-audio-worklet-processor");return xb(t,r),r.connect(t.destination),[t,r]}let xb=async(t,r)=>{const i=await fetch("./Thurston Waffles.sf2").then(h=>h.arrayBuffer()),n=new Mu.SoundFont2(new Uint8Array(i)),o=n.presets[0];if(!o)throw new Error("Preset at index 0 not found.");const a=n.instruments[o.header.bagIndex];if(!a)throw new Error("No instrument found for preset at index 0");const l=(h,g)=>{for(const m of h.zones)if(m.keyRange!=null&&g>=m.keyRange.lo&&g<=m.keyRange.hi)return m.sample;return null};let u=60;const s=l(a,u);if(!s)throw new Error(`No sample found for note ${u} in preset 0.`);const c=s.header.sampleRate,d=s.data.length,f=new Float32Array(d);for(let h=0;h<d;h++)f[h]=s.data[h]/32768;const p=s.header.originalPitch;r.port.postMessage({type:"meowData",params:{meowOriginalPitch:p,meowSampleRate:c,meowData:f}})};Oe(["click"]);var _b=Y('<div><div role=tablist class="tabs tabs-box">'),Sb=Y("<a role=tab class=tab>");const Cb=t=>{const r=["Piano Keys","Waterfall","Instrument Editor"];let[e,i]=je({selectedTab:"Piano Keys"}),n=new Wh;n.init();let o=new Lt;return(()=>{var a=_b(),l=a.firstChild;return a.style.setProperty("flex-grow","1"),a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("overflow","hidden"),te(l,()=>r.map(u=>ye(()=>(()=>{var s=Sb();return s.$$click=()=>{i("selectedTab",u)},te(s,u),le(()=>s.classList.toggle("tab-active",e.selectedTab==u)),s})()))),te(a,D(An,{get children(){return[D($t,{get when(){return e.selectedTab=="Piano Keys"},get children(){return D(im,{onNoteOn:u=>n.noteOn(u),onNoteOff:u=>n.noteOff(u)})}}),D($t,{get when(){return e.selectedTab=="Waterfall"},get children(){return D(fb,{})}}),D($t,{get when(){return e.selectedTab=="Instrument Editor"},get children(){return D(sb,{style:{"flex-grow":"1"},world:o})}})]}}),null),a})()};Oe(["click"]);const Pb=H({radius:U(M),out:ne(M)}),rd=new re({typeName:"Sphere",typeSchema:Pb});var Tb=Object.defineProperty,Eb=(t,r)=>{for(var e in r)Tb(t,e,{get:r[e],enumerable:!0})},ll=new WeakMap;function $b(t){if(t instanceof WebGL2RenderingContext)return t;const r=ll.get(t);if(r)return r;const e=t.getExtension("ANGLE_instanced_arrays");if(!e)return;const i={drawArraysInstanced:e.drawArraysInstancedANGLE.bind(e),drawElementsInstanced:e.drawElementsInstancedANGLE.bind(e),vertexAttribDivisor:e.vertexAttribDivisorANGLE.bind(e)};return ll.set(t,i),i}var cl=new WeakMap;function Ib(t){if(t instanceof WebGL2RenderingContext)return t;const r=cl.get(t);if(r)return r;const e=t.getExtension("OES_vertex_array_object");if(!e)return null;const i={bindVertexArray:e.bindVertexArrayOES.bind(e),createVertexArray:e.createVertexArrayOES.bind(e),deleteVertexArray:e.deleteVertexArrayOES.bind(e)};return cl.set(t,i),i}var jt={};Eb(jt,{forEach:()=>nd,map:()=>Rb});function nd(t,r){let e=0;for(const i in t)r(t[i],i,e),e++;for(const i of Object.getOwnPropertySymbols(t))r(t[i],i,e),e++}function Rb(t,r){const e={};return nd(t,(i,n,o)=>{e[n]=r(i,n,o)}),e}function Mn(t,r){if(t==null)throw new Error(r);return t}function ul(t,r,e){const i=t.createShader(r);if(!i)throw new Error("Failed to create shader");if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){const n=t.getShaderInfoLog(i);throw t.deleteShader(i),new Error(`Failed to compile ${r===t.VERTEX_SHADER?"vertex":"fragment"} shader: ${n}`)}return i}function Nb(t,r,e){const i=t.createProgram();if(!i)throw new Error("Failed to create WebGL program");const n=ul(t,t.VERTEX_SHADER,r),o=ul(t,t.FRAGMENT_SHADER,e);if(t.attachShader(i,n),t.attachShader(i,o),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){const a=t.getProgramInfoLog(i);throw t.deleteProgram(i),t.deleteShader(n),t.deleteShader(o),new Error(`Failed to link program: ${a}`)}return t.deleteShader(n),t.deleteShader(o),i}var Ab=t=>{switch(t[0]){case"m":return"Matrix"+t.slice(3)+"fv";case"s":case"b":case"i":return(t.match(/\d/)?.[0]??"1")+"i";case"u":return(t[4]||"1")+"ui";case"v":return t[3]+"f";default:switch(t){case"float":return"1f";case"uint":return"1ui";default:return"1i"}}},id=t=>{switch(t[0]){case"m":const[r,e]=t.match(/\d+/g).map(Number);return r*(e??r);case"v":case"i":case"b":case"u":const i=t.match(/\d/);return i?+i[0]:1;default:return 1}},Mb=t=>t.includes("mat"),Ob=t=>t.includes("sampler");function Fb(t){const r=new(t??Map);return Object.assign(r,{getOrInsert(e,i){let n=r.get(e);return n||(n=i(),r.set(e,n),n)}})}var Db=0,zb="VIEW_GL_ALIAS",Lb=navigator.userAgent.toLowerCase().indexOf("firefox")>=0,jb=Fb(Lb?Map:WeakMap);function Rt(t){return typeof t=="string"?t:typeof t=="symbol"?jb.getOrInsert(t,()=>`${zb}_${Db++}`):t.toString()}function Ub(t,r,e,i){return{uniforms:e.uniforms?Bb(t,r,e.uniforms):void 0,attributes:e.attributes?qb(t,r,e.attributes,i):void 0,interleavedAttributes:e.interleavedAttributes?Vb(t,r,e.interleavedAttributes,i):void 0,buffers:e.buffers?Gb(t,e.buffers):void 0}}function Bb(t,r,e){return jt.map(e,({kind:i,size:n},o)=>{const a=Rt(o),l=t.getUniformLocation(r,a);if(Ob(i))return{set(c){t.uniform1i(l,c)}};const u=`uniform${Ab(i)}${n?"v":""}`,s=t[u].bind(t);return Mb(i)?{set(...c){s(l,!1,c[0])}}:{set(...c){s(l,...c)}}})}function od(t,r,e,i,n,o,a){t.enableVertexAttribArray(r),t.vertexAttribPointer(r,e,t[o],!1,i,n),a&&Mn($b(t)).vertexAttribDivisor(r,1)}function qb(t,r,e,{signal:i}={}){const n=jt.map(e,({kind:o,instanced:a,buffer:l=Mn(t.createBuffer())},u)=>{const s=Rt(u),c=t.getAttribLocation(r,s);if(c<0)throw new Error(`Attribute '${s}' not found`);const d=id(o),f=o.startsWith("i")?"INT":"FLOAT";return{buffer:l,bind(){t.bindBuffer(t.ARRAY_BUFFER,l),od(t,c,d,0,0,f,a)},dispose(){t.deleteBuffer(l)},set(p,h="STATIC_DRAW"){return t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferData(t.ARRAY_BUFFER,p,t[h]),this}}});return i?.addEventListener("abort",function(){jt.forEach(n,a=>a.dispose())}),n}function Vb(t,r,e,{signal:i}={}){const n=jt.map(e,({layout:o,instanced:a})=>{let l=0;const u=o.map(p=>{const h=Rt(p.key),g=t.getAttribLocation(r,h);if(g<0)throw new Error(`Attribute '${h}' not found`);const m=id(p.kind),b=l,y=p.kind.startsWith("i")?"INT":"FLOAT";return l+=m*4,()=>od(t,g,m,s,b,y,a)}),s=l,c=Mn(t.createBuffer());let d;const f=Ib(t);if(f){const p=f.createVertexArray();f.bindVertexArray(p),t.bindBuffer(t.ARRAY_BUFFER,c);for(const h of u)h();f.bindVertexArray(null),d={unbind(){f.bindVertexArray(null)},bind(){f.bindVertexArray(p)},dispose(){f.deleteVertexArray(p)}}}return{bind(){if(t.bindBuffer(t.ARRAY_BUFFER,c),d)d.bind();else for(const p of u)p()},unbind(){d&&d.unbind()},dispose(){t.deleteBuffer(c),d&&d.dispose()},set(p,h="STATIC_DRAW"){d?d.bind():t.bindBuffer(t.ARRAY_BUFFER,c),t.bufferData(t.ARRAY_BUFFER,p,t[h]),d&&d.unbind()}}});return i?.addEventListener("abort",function(){jt.forEach(n,a=>a.dispose())}),n}function Gb(t,r,{signal:e}={}){const i=jt.map(r,({target:n="ARRAY_BUFFER",usage:o="STATIC_DRAW"})=>{const a=Mn(t.createBuffer());return{bind(){t.bindBuffer(t[n],a)},dispose(){t.deleteBuffer(a)},set(l){t.bindBuffer(t[n],a),t.bufferData(t[n],l,t[o])}}});return e?.addEventListener("abort",function(){jt.forEach(i,o=>o.dispose())}),i}function ie(t,...r){return{template:t,slots:r,type:"glsl"}}var ta=new Proxy({},{get(t,r){return typeof r=="symbol"?t[r]:(e,i)=>({type:"uniform",key:e,kind:r,...i})}});new Proxy({},{get(t,r){return typeof r=="symbol"?t[r]:(e,i)=>({type:"attribute",key:e,kind:r,...i})}});function ut(t,r,e,i){const n=dl(r),o=dl(e),a={uniforms:{...n.schema.uniforms,...o.schema.uniforms},attributes:{...n.schema.attributes,...o.schema.attributes},interleavedAttributes:{...n.schema.interleavedAttributes,...o.schema.interleavedAttributes}};for(const u in i){const s=a[u],c=i[u];for(const d in c)s[d]={...s[d],...c[d]}}const l=Nb(t,n.template,o.template);return{program:l,schema:a,view:Ub(t,l,a),vertex:n.template,fragment:o.template}}function dl(t){return{template:ut.toString(t),schema:ut.toSchema(t)}}ut.toSchema=function(t){const r={uniforms:{},attributes:{},interleavedAttributes:{}};function e(i){if(Array.isArray(i)){i.forEach(e);return}if(typeof i!="object")return;if(i.type==="glsl"){const{uniforms:l,attributes:u,interleavedAttributes:s}=ut.toSchema(i);r.uniforms={...r.uniforms,...l},r.attributes={...r.attributes,...u},r.interleavedAttributes={...r.interleavedAttributes,...s};return}const{key:n,type:o,...a}=i;r[`${o}s`][n]=a}return t.slots.forEach(e),r};ut.toString=function({template:[t,...r],slots:e}){const i=!!t?.startsWith("#version 300 es");let n=t??"";for(let o=0;o<r.length;o++)n+=`${ad(e[o],i)}${r[o]}`;return n};function ad(t,r){return typeof t!="object"?Rt(t):Array.isArray(t)?t.map(e=>ad(e,r)).join(""):t.type==="glsl"?ut.toString(t):t.type==="interleavedAttribute"?t.layout.reduce((e,i)=>r?`${e}in ${i.kind} ${Rt(i.key)};
`:`${e}attribute ${i.kind} ${Rt(i.key)};
`,""):t.type==="uniform"&&"size"in t?`${t.type} ${t.kind} ${Rt(t.key)}[${t.size}];`:`${t.type==="attribute"&&r?"in":t.type} ${t.kind} ${Rt(t.key)};`}class Wb{componentType=rd;ext={};create(r){return new Hb(r)}}const sd=new Wb;class Hb{type=sd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"radius",source:()=>e.radius,setSource:n=>i("radius",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let l=a.value,u=n.allocVar();return n.insertGlobalCode(ie`
        float ${u}(vec3 p) {
          return length(p) - ${l};
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:"defaultColour"}}]])}}}const Zb=H({value:ot(),out:ne(M)}),ld=new re({typeName:"Number",typeSchema:Zb});var Yb=Y("<input class=input type=text size=8>");class Xb{componentType=ld;ext={};create(r){return new Kb(r)}}const cd=new Xb;class Kb{type=cd;nodeParams;outputPins;ui;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ui=E(()=>()=>{let[n,o]=je({valueText:ye(()=>e.value.toFixed(3))});return ve(he(()=>n.valueText,()=>{let a=Number.parseFloat(n.valueText);Number.isNaN(a)||i("value",a)},{defer:!0})),(()=>{var a=Yb();return a.$$input=l=>{o("valueText",l.currentTarget.value)},le(()=>a.value=n.valueText),a})()}),this.ext.generateCode=({ctx:n,inputs:o})=>new Map([["out",{type:"Atom",value:Jb(e.value)}]])}}function Jb(t){let r=t.toString();return!r.includes(".")&&!r.includes("e")&&!r.includes("E")&&(r+=".0"),r}Oe(["input"]);const Qb=H({visible:iu(!0,om()),in:U(M)}),ud=new re({typeName:"Display",typeSchema:Qb});var ev=Object.defineProperty,tv=(t,r)=>{for(var e in r)ev(t,e,{get:r[e],enumerable:!0})},dd={};tv(dd,{forEach:()=>pd,map:()=>rv});function pd(t,r){let e=0;for(const i in t)r(t[i],i,e),e++;for(const i of Object.getOwnPropertySymbols(t))r(t[i],i,e),e++}function rv(t,r){const e={};return pd(t,(i,n,o)=>{e[n]=r(i,n,o)}),e}var nv=t=>{switch(t[0]){case"m":return"Matrix"+t.slice(3)+"fv";case"s":case"b":case"i":return(t.match(/\d/)?.[0]??"1")+"i";case"u":return(t[4]||"1")+"ui";case"v":return t[3]+"f";default:switch(t){case"float":return"1f";case"uint":return"1ui";default:return"1i"}}},iv=t=>t.includes("mat"),ov=t=>t.includes("sampler");function av(t){const r=new(t??Map);return Object.assign(r,{getOrInsert(e,i){let n=r.get(e);return n||(n=i(),r.set(e,n),n)}})}var sv=0,lv="VIEW_GL_ALIAS",cv=navigator.userAgent.toLowerCase().indexOf("firefox")>=0,uv=av(cv?Map:WeakMap);function dv(t){return typeof t=="string"?t:typeof t=="symbol"?uv.getOrInsert(t,()=>`${lv}_${sv++}`):t.toString()}function ra(t,r,e){return dd.map(e,({kind:i,size:n},o)=>{const a=dv(o),l=t.getUniformLocation(r,a);if(ov(i))return{set(c){t.uniform1i(l,c)}};const u=`uniform${nv(i)}${n?"v":""}`,s=t[u].bind(t);return iv(i)?{set(...c){s(l,!1,c[0])}}:{set(...c){s(l,...c)}}})}var pv=Y('<div class="bg-base-200 mt-2 mb-2"><label class=label><input class="checkbox checkbox-sm pl-2"type=checkbox>Visible'),fv=Y('<i class="fa-solid fa-desktop">');class hv{componentType=ud;ext={};create(r){return new mv(r)}}const fd=new hv;class mv{type=fd;nodeParams;inputPins;ui;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"in",source:()=>e.in,setSource:n=>i("in",n)}]),this.ui=E(()=>()=>[(()=>{var n=pv(),o=n.firstChild,a=o.firstChild;return a.addEventListener("change",l=>{i("visible",l.currentTarget.checked)}),le(()=>a.checked=e.visible),n})(),(()=>{var n=fv();return n.style.setProperty("font-size","24px"),n.style.setProperty("color","green"),n})()]),this.ext.generateCode=({ctx:n,inputs:o,onInit:a})=>{let l=o.get("in");if(l?.type!="Model")return;let u=l.value,{sdfFuncName:s,colourFuncName:c}=u,d=n.allocVar(),f=ie`
        ${ta.bool(d)}
      `;n.insertGlobalCode(f),n.insertCode(ie`
        if (${d}) {
          d = min(d, ${s}(p));
        }
      `);let p=n.allocVar();return n.insertColourCode(ie`
        if (${d}) {
          float ${p} = ${s}(p);
          if (${p} < d) {
            d = ${p};
            ${c}(p, c);
          }
        }
      `),a(({gl:h,program:g,rerender:m})=>{let b=ra(h,g,ut.toSchema(f).uniforms);Re(he(()=>e.visible,y=>{b[d].set(y?1:0),m()}))}),new Map}}}const gv=H({x:U(M),y:U(M),z:U(M),out:ne(M)}),hd=new re({typeName:"Vec3",typeSchema:gv});class yv{componentType=hd;ext={};create(r){return new bv(r)}}const md=new yv;class bv{type=md;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"x",source:()=>e.x,setSource:n=>i("x",n)},{name:"y",source:()=>e.y,setSource:n=>i("y",n)},{name:"z",source:()=>e.z,setSource:n=>i("z",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("x"),l=o.get("y"),u=o.get("z"),s,c,d;return a?.type=="Atom"?s=a.value:s="0.0",l?.type=="Atom"?c=l.value:c="0.0",u?.type=="Atom"?d=u.value:d="0.0",new Map([["out",{type:"Atom",value:`vec3(${s}, ${c}, ${d})`}]])}}}const vv=H({model:U(M),offset:U(M),out:ne(M)}),gd=new re({typeName:"Translate",typeSchema:vv});class wv{componentType=gd;ext={};create(r){return new kv(r)}}const yd=new wv;class kv{type=yd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"offset",source:()=>e.offset,setSource:n=>i("offset",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("offset");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          return ${l.sdfFuncName}(p - ${s});
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ie`
        void ${d}(vec3 p, out vec4 c) {
          ${l.colourFuncName}(p - ${s}, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const xv=H({size:U(M),out:ne(M)}),bd=new re({typeName:"Box",typeSchema:xv});class _v{componentType=bd;ext={};create(r){return new Sv(r)}}const vd=new _v;class Sv{type=vd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"size",source:()=>e.size,setSource:n=>i("size",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("size");if(a?.type!="Atom")return;let l=a.value,u=n.allocVar();return n.insertGlobalCode(ie`
        float ${u}(vec3 p) {
          vec3 q = abs(p) - 0.5 * ${l};
          return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:"defaultColour"}}]])}}}const Cv=H({model1:U(M),model2:U(M),k:U(M),out:ne(M)}),wd=new re({typeName:"Union",typeSchema:Cv});class Pv{componentType=wd;ext={};create(r){return new Tv(r)}}const kd=new Pv;class Tv{type=kd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model1",source:()=>e.model1,setSource:n=>i("model1",n)},{name:"model2",source:()=>e.model2,setSource:n=>i("model2",n)},{name:"k",source:()=>e.k,setSource:n=>i("k",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let d=n.allocVar();if(c?.type=="Atom"){let p=c.value;n.insertGlobalCode(ie`
          float ${d}(vec3 p) {
            float k = ${p} * 4.0;
            float d1 = ${l.sdfFuncName}(p);
            float d2 = ${s.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return min(d1, d2) - h*h*0.25/k;
          }
        `)}else n.insertGlobalCode(ie`
          float ${d}(vec3 p) {
            return min(${l.sdfFuncName}(p), ${s.sdfFuncName}(p));
          }
        `);let f=n.allocVar();return n.insertGlobalCode(ie`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:d,colourFuncName:f}}]])}}}const Ev=H({model1:U(M),model2:U(M),k:U(M),out:ne(M)}),xd=new re({typeName:"Difference",typeSchema:Ev});class $v{componentType=xd;ext={};create(r){return new Iv(r)}}const _d=new $v;class Iv{type=_d;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model1",source:()=>e.model1,setSource:n=>i("model1",n)},{name:"model2",source:()=>e.model2,setSource:n=>i("model2",n)},{name:"k",source:()=>e.k,setSource:n=>i("k",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let d=n.allocVar();if(c?.type=="Atom"){let p=c.value;n.insertGlobalCode(ie`
          float ${d}(vec3 p) {
            float k = ${p} * 4.0;
            float d1 = -${l.sdfFuncName}(p);
            float d2 = ${s.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return -(min(d1, d2) - h*h*0.25/k);
          }
        `)}else n.insertGlobalCode(ie`
          float ${d}(vec3 p) {
            return -min(-${l.sdfFuncName}(p), ${s.sdfFuncName}(p));
          }
        `);let f=n.allocVar();return n.insertGlobalCode(ie`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:d,colourFuncName:f}}]])}}}const Rv=H({model:U(M),step:U(M),out:ne(M)}),Sd=new re({typeName:"Repeat",typeSchema:Rv});class Nv{componentType=Sd;ext={};create(r){return new Av(r)}}const Cd=new Nv;class Av{type=Cd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"step",source:()=>e.step,setSource:n=>i("step",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("step");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          vec3 s = ${s};
          vec3 id = vec3(floor(p.x/s.x + 0.5),floor(p.y/s.y + 0.5),floor(p.z/s.z + 0.5));
          vec3  o = sign(p-s*id);
          float d = 1e20;
          for( int k=0; k<2; k++ )
          for( int j=0; j<2; j++ )
          for( int i=0; i<2; i++ )
          {
            vec3 rid = id + vec3(i,j,k)*o;
            vec3 r = p - s*rid;
            d = min( d, ${l.sdfFuncName}(r));
          }
          return d;
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ie`
        void ${d}(vec3 p, out vec4 c) {
          vec3 s = ${s};
          vec3 id = vec3(floor(p.x/s.x + 0.5),floor(p.y/s.y + 0.5),floor(p.z/s.z + 0.5));
          p = p-s*id;
          ${l.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const Mv=H({model:U(M),scale:U(M),out:ne(M)}),Pd=new re({typeName:"Scale",typeSchema:Mv});class Ov{componentType=Pd;ext={};create(r){return new Fv(r)}}const Td=new Ov;class Fv{type=Td;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"scale",source:()=>e.scale,setSource:n=>i("scale",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("scale");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          return ${l.sdfFuncName}(p / ${s}) * ${s};
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ie`
        void ${d}(vec3 p, out vec4 c) {
          ${l.colourFuncName}(p / ${s}, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const Dv=H({model:U(M),axis:U(M),angle:U(M),out:ne(M)}),Ed=new re({typeName:"Rotate",typeSchema:Dv});class zv{componentType=Ed;ext={};create(r){return new Lv(r)}}const $d=new zv;class Lv{type=$d;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"axis",source:()=>e.axis,setSource:n=>i("axis",n)},{name:"angle",source:()=>e.angle,setSource:n=>i("angle",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("axis");if(u?.type!="Atom")return;let s=u.value,c=o.get("angle");if(c?.type!="Atom")return;let d=c.value,f=n.allocVar();n.insertGlobalCode(ie`
        float ${f}(vec3 p) {
          float a = 0.5 * ${d} * ${Math.PI/180};
          vec3 tmp = sin(a) * normalize(${s});
          vec4 q = vec4(tmp.x, tmp.y, tmp.z, cos(a));
          p = p + 2.0 * cross(-q.xyz, cross(-q.xyz, p) + q.w * p);
          return ${l.sdfFuncName}(p);
        }
      `);let p=n.allocVar();return n.insertGlobalCode(ie`
        void ${p}(vec3 p, out vec4 c) {
          float a = 0.5 * ${d} * ${Math.PI/180};
          vec3 tmp = sin(a) * normalize(${s});
          vec4 q = vec4(tmp.x, tmp.y, tmp.z, cos(a));
          p = p + 2.0 * cross(-q.xyz, cross(-q.xyz, p) + q.w * p);
          ${l.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:f,colourFuncName:p}}]])}}}const jv=H({radius:U(M),out:ne(M)}),Id=new re({typeName:"InfiniteCylinder",typeSchema:jv});class Uv{componentType=Id;ext={};create(r){return new Bv(r)}}const Rd=new Uv;class Bv{type=Rd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"radius",source:()=>e.radius,setSource:n=>i("radius",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let l=a.value,u=n.allocVar();n.insertGlobalCode(ie`
        float ${u}(vec3 p) {
          return length(p.xy) - ${l};
        }
      `);let s=n.allocVar();return n.insertGlobalCode(ie`
        void ${s}(vec3 p, out vec4 c) {
          c = vec4(0.7, 0.7, 0.7, 1.0);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:s}}]])}}}const qv=H({colour:H({red:ot(),green:ot(),blue:ot(),alpha:ot()}),out:ne(M)}),Nd=new re({typeName:"Colour",typeSchema:qv});class xn{r;g;b;a;constructor(r,e,i,n){this.r=r,this.g=e,this.b=i,this.a=n}}var Vv=Y("<div><div><div><div></div><svg><circle r=5 stroke=black stroke-width=2 fill=none pointer-events=none></circle></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div></div><div><div></div><div><table><thead></thead><tbody><tr><td>Red:</td><td><input type=text size=4></td></tr><tr><td>Green:</td><td><input type=text size=4></td></tr><tr><td>Blue:</td><td><input type=text size=4></td></tr><tr><td>Alpha:</td><td><input type=text size=4></td></tr></tbody></table></div><div><div>");const Gv=t=>{let[r,e]=je({cursorPos:K.zero,chartMousePos:void 0,chartMouseDown:!1,brightness:255,brightnessMousePos:void 0,brightnessMouseDown:!1,alpha:255,alphaMousePos:void 0,alphaMouseDown:!1,userColour:ye(()=>t.colour),userRedText:void 0,userGreenText:void 0,userBlueText:void 0,userAlphaText:void 0}),[i,n]=oe(),[o,a]=oe();ve(()=>{let y=i();if(y==null)return;let w=new ResizeObserver(()=>{let v=y.getBoundingClientRect();o(),a(K.create(v.width,v.height))});w.observe(y),Ne(()=>{w.unobserve(y),w.disconnect()})});let l=E(()=>{let y=o();if(y==null)return;let w=document.createElement("canvas");w.setAttribute("width",`${y.x}`),w.setAttribute("height",`${y.y}`),w.style.setProperty("flex-grow","1");let v=w.getContext("2d");if(v==null)return;let k=new ImageData(y.x,y.y),_=256*6;for(let N=0;N<y.x;++N){let A,L,V,Z=Math.floor(N*_/y.x);if(Z<256){let J=Z;A=255,L=J,V=0}else if(Z<256*2)A=255-(Z-256),L=255,V=0;else if(Z<256*3){let J=Z-512;A=0,L=255,V=J}else if(Z<256*4){let J=Z-768;A=0,L=255-J,V=255}else if(Z<256*5)A=Z-1024,L=0,V=255;else{let J=Z-1280;A=255,L=0,V=255-J}let G=N<<2;for(let J=0;J<y.y;++J){let ue=A+Math.floor((256-A)*J/y.y),de=L+Math.floor((256-L)*J/y.y),R=V+Math.floor((256-V)*J/y.y);k.data[G]=ue,k.data[G+1]=de,k.data[G+2]=R,k.data[G+3]=255,G+=y.x<<2}}let C=new ImageData(y.x,y.y);ve(he(()=>r.brightness,()=>{let N=r.brightness,A=y.x*y.y<<2;for(let L=0;L<A;L+=4){let V=k.data[L],Z=k.data[L+1],G=k.data[L+2],J=k.data[L+3],ue=Math.floor(V*N/255),de=Math.floor(Z*N/255),R=Math.floor(G*N/255);C.data[L]=ue,C.data[L+1]=de,C.data[L+2]=R,C.data[L+3]=J}v.putImageData(C,0,0)}));let S=document.createElement("canvas");S.setAttribute("width","1"),S.setAttribute("height",`${y.y}`),S.style.setProperty("flex-grow","1");let P=S.getContext("2d");if(P==null)return;let T=new ImageData(1,y.y);ve(()=>{let N=r.cursorPos;if(N==null)return;let A=k.width*N.y+N.x<<2,L=k.data[A],V=k.data[A+1],Z=k.data[A+2];for(let G=0;G<y.y;++G){let J=G<<2,ue=Math.floor(L*(y.y-1-G)/(y.y-1)),de=Math.floor(V*(y.y-1-G)/(y.y-1)),R=Math.floor(Z*(y.y-1-G)/(y.y-1));T.data[J]=ue,T.data[J+1]=de,T.data[J+2]=R,T.data[J+3]=255}P.putImageData(T,0,0)});let x=document.createElement("canvas");x.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),x.style.setProperty("background-size","20px 20px"),x.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),x.setAttribute("width","1"),x.setAttribute("height",`${y.y}`),x.style.setProperty("flex-grow","1");let $=x.getContext("2d");if($==null)return;let O=new ImageData(1,y.y);return ve(()=>{let N=r.cursorPos;if(N==null)return;let A=k.width*N.y+N.x<<2,L=k.data[A],V=k.data[A+1],Z=k.data[A+2],G=k.data[A+3];for(let J=0;J<y.y;++J){let ue=J<<2,de=Math.floor(G*(y.y-1-J)/(y.y-1));O.data[ue]=L,O.data[ue+1]=V,O.data[ue+2]=Z,O.data[ue+3]=de}$.putImageData(O,0,0)}),{canvas:w,sliderCanvas:S,alphaSliderCanvas:x,size:y,sliderImageData:T,alphaSliderImageData:O}});Re(()=>{let y=l();if(y==null||!r.chartMouseDown)return;let w=r.chartMousePos;w!=null&&(e("userColour",void 0),e("userRedText",void 0),e("userGreenText",void 0),e("userBlueText",void 0),e("cursorPos",K.create(Math.max(0,Math.min(y.size.x-1,Math.floor(w.x))),Math.max(0,Math.min(y.size.y-1,Math.floor(w.y))))))}),Re(()=>{if(!r.brightnessMouseDown)return;let y=r.brightnessMousePos;if(y==null)return;let w=l()?.size.y;w!=null&&(e("userColour",void 0),e("userRedText",void 0),e("userGreenText",void 0),e("userBlueText",void 0),e("brightness",Math.max(0,Math.min(255,Math.floor(256*(w-y.y)/w)))))}),Re(()=>{if(!r.alphaMouseDown)return;let y=r.alphaMousePos;if(y==null)return;let w=l()?.size.y;w!=null&&(e("userColour",void 0),e("userRedText",void 0),e("userGreenText",void 0),e("userBlueText",void 0),e("userAlphaText",void 0),e("alpha",Math.max(0,Math.min(255,Math.floor(256*(w-y.y)/w)))))});let u=E(he([l,()=>r.cursorPos,()=>r.brightness,()=>r.alpha],()=>{let y=l();if(y==null)return;let v=Math.max(0,Math.min(y.size.y,Math.floor((255-r.brightness)*y.size.y/256)))<<2,k=y.sliderImageData.data[v],_=y.sliderImageData.data[v+1],C=y.sliderImageData.data[v+2],S=r.alpha;return new xn(k,_,C,S)})),s=E(()=>{if(r.userRedText==null)return;let y=Number.parseFloat(r.userRedText);if(Number.isFinite(y))return Math.max(0,Math.min(255,y))}),c=E(()=>{if(r.userGreenText==null)return;let y=Number.parseFloat(r.userGreenText);if(Number.isFinite(y))return Math.max(0,Math.min(255,y))}),d=E(()=>{if(r.userBlueText==null)return;let y=Number.parseFloat(r.userBlueText);if(Number.isFinite(y))return Math.max(0,Math.min(255,y))}),f=E(()=>{if(r.userAlphaText==null)return;let y=Number.parseFloat(r.userAlphaText);if(Number.isFinite(y))return Math.max(0,Math.min(255,y))}),p=E(()=>{let y;return r.userColour!=null?y=r.userColour:y=u(),new xn(s()??y?.r??0,c()??y?.g??0,d()??y?.b??0,f()??y?.a??255)});Re(he([()=>t.colour],()=>{let y=p();if(y==null||t.colour==null)return;let w=t.colour;w.r==y.r&&w.g==y.g&&w.b==y.b&&w.a==y.a||e("userColour",w)},{defer:!0})),Re(he([()=>r.userColour,p],()=>{if(r.userColour!=null)return;let y=p();y!=null&&t.onColour?.(y)})),Re(()=>{let y=l();if(!y||r.userColour==null&&s()==null&&c()==null&&d()==null&&f()==null)return;let w=r.userColour,v=new xn(s()??w?.r??0,c()??w?.g??0,d()??w?.b??0,f()??w?.a??255),k=Math.max(v.r,v.g,v.b),_=Math.min(v.r,v.g,v.b),C=k,S=255/(k-_);if(!Number.isFinite(S))return;let P=Math.floor((v.r-_)*S),T=Math.floor((v.g-_)*S),x=Math.floor((v.b-_)*S),$=v.r==k,O=v.g==k,N=v.b==k,A;$&&!O&&x==0?A=T:!$&&O&&x==0?A=256+(255-P):P==0&&O&&!N?A=256*2+x:P==0&&!O&&N?A=256*3+(255-T):!$&&T==0&&N?A=256*4+P:A=256*5+(255-x);let L=Math.floor(y.size.x*A/(256*6)),V=_;Be(()=>{e("cursorPos",K.create(L,V)),e("brightness",C),e("alpha",v.a)})});let[h,g]=oe(),[m,b]=oe(50);return Re(he(h,()=>{let y=h();if(y==null)return;let w=new ResizeObserver(()=>{let v=y.getBoundingClientRect();console.log(v),v.width!=v.height&&b(v.height)});w.observe(y),Ne(()=>{w.unobserve(y),w.disconnect()})})),(()=>{var y=Vv(),w=y.firstChild,v=w.firstChild,k=v.firstChild,_=k.nextSibling,C=_.firstChild,S=v.nextSibling,P=S.firstChild,T=P.firstChild,x=S.nextSibling,$=x.firstChild,O=$.firstChild,N=w.nextSibling,A=N.firstChild,L=A.nextSibling,V=L.firstChild,Z=V.firstChild,G=Z.nextSibling,J=G.firstChild,ue=J.firstChild,de=ue.nextSibling,R=de.firstChild,F=J.nextSibling,z=F.firstChild,q=z.nextSibling,ee=q.firstChild,I=F.nextSibling,j=I.firstChild,se=j.nextSibling,ke=se.firstChild,be=I.nextSibling,fe=be.firstChild,De=fe.nextSibling,tt=De.firstChild,Ee=L.nextSibling,st=Ee.firstChild;y.style.setProperty("flex-grow","1"),y.style.setProperty("display","flex"),y.style.setProperty("flex-direction","column"),w.style.setProperty("flex-grow","1"),w.style.setProperty("display","flex"),w.style.setProperty("flex-direction","row"),v.$$pointerup=B=>{e("chartMouseDown",!1),B.currentTarget.releasePointerCapture(B.pointerId),B.preventDefault()},v.$$pointerdown=B=>{e("chartMouseDown",!0),B.currentTarget.setPointerCapture(B.pointerId),B.preventDefault()},v.$$pointerout=B=>{e("chartMousePos",void 0),B.preventDefault()},v.$$pointermove=B=>{let W=B.currentTarget.getBoundingClientRect(),ce=B.clientX-W.left,xe=B.clientY-W.top;e("chartMousePos",K.create(ce,xe)),B.preventDefault()},v.style.setProperty("position","relative"),v.style.setProperty("flex-grow","1"),v.style.setProperty("display","flex"),v.style.setProperty("flex-direction","column"),v.style.setProperty("touch-action","none");var It=n;typeof It=="function"?Ce(It,k):n=k,k.style.setProperty("flex-grow","1"),k.style.setProperty("display","flex"),k.style.setProperty("flex-direction","column"),te(k,()=>l()?.canvas),_.style.setProperty("position","absolute"),_.style.setProperty("left","0"),_.style.setProperty("top","0"),_.style.setProperty("right","0"),_.style.setProperty("bottom","0"),S.$$pointerup=B=>{e("brightnessMouseDown",!1),B.currentTarget.releasePointerCapture(B.pointerId),B.preventDefault()},S.$$pointerdown=B=>{e("brightnessMouseDown",!0),B.currentTarget.setPointerCapture(B.pointerId),B.preventDefault()},S.$$pointerout=B=>{e("brightnessMousePos",void 0),B.preventDefault()},S.$$pointermove=B=>{let W=B.currentTarget.getBoundingClientRect(),ce=B.clientX-W.left,xe=B.clientY-W.top;e("brightnessMousePos",K.create(ce,xe)),B.preventDefault()},S.style.setProperty("position","relative"),S.style.setProperty("display","flex"),S.style.setProperty("flex-direction","row"),S.style.setProperty("width","25px"),S.style.setProperty("margin-left","15px"),S.style.setProperty("overflow","hidden"),S.style.setProperty("touch-action","none"),te(S,()=>l()?.sliderCanvas,P),P.style.setProperty("position","absolute"),P.style.setProperty("left","0"),P.style.setProperty("top","0"),P.style.setProperty("right","0"),P.style.setProperty("bottom","0"),x.$$pointerup=B=>{e("alphaMouseDown",!1),B.currentTarget.releasePointerCapture(B.pointerId),B.preventDefault()},x.$$pointerdown=B=>{e("alphaMouseDown",!0),B.currentTarget.setPointerCapture(B.pointerId),B.preventDefault()},x.$$pointerout=B=>{e("alphaMousePos",void 0),B.preventDefault()},x.$$pointermove=B=>{let W=B.currentTarget.getBoundingClientRect(),ce=B.clientX-W.left,xe=B.clientY-W.top;e("alphaMousePos",K.create(ce,xe)),B.preventDefault()},x.style.setProperty("position","relative"),x.style.setProperty("display","flex"),x.style.setProperty("flex-direction","row"),x.style.setProperty("width","25px"),x.style.setProperty("margin-left","15px"),x.style.setProperty("overflow","hidden"),x.style.setProperty("touch-action","none"),te(x,()=>l()?.alphaSliderCanvas,$),$.style.setProperty("position","absolute"),$.style.setProperty("left","0"),$.style.setProperty("top","0"),$.style.setProperty("right","0"),$.style.setProperty("bottom","0"),N.style.setProperty("display","flex"),N.style.setProperty("flex-direction","row"),A.style.setProperty("flex-grow","1"),R.$$input=B=>{Be(()=>{e("userRedText",B.currentTarget.value),e("userGreenText",p().g.toFixed(0)),e("userBlueText",p().b.toFixed(0)),e("userAlphaText",p().a.toFixed(0))})},ee.$$input=B=>{Be(()=>{e("userRedText",p().r.toFixed(0)),e("userGreenText",B.currentTarget.value),e("userBlueText",p().b.toFixed(0)),e("userAlphaText",p().a.toFixed(0))})},ke.$$input=B=>{Be(()=>{e("userRedText",p().r.toFixed(0)),e("userGreenText",p().g.toFixed(0)),e("userBlueText",B.currentTarget.value),e("userAlphaText",p().a.toFixed(0))})},tt.$$input=B=>{Be(()=>{e("userRedText",p().r.toFixed(0)),e("userGreenText",p().g.toFixed(0)),e("userBlueText",p().b.toFixed(0)),e("userAlphaText",B.currentTarget.value)})};var lt=g;return typeof lt=="function"?Ce(lt,Ee):g=Ee,Ee.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),Ee.style.setProperty("background-size","20px 20px"),Ee.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),Ee.style.setProperty("margin-top","10px"),Ee.style.setProperty("margin-bottom","10px"),Ee.style.setProperty("margin-left","10px"),Ee.style.setProperty("display","flex"),Ee.style.setProperty("flex-direction","column"),st.style.setProperty("flex-grow","1"),le(B=>{var W=l()?.size.x??300,ce=l()?.size.y??300,xe=r.cursorPos.x,$e=r.cursorPos.y,rt=`${l()?.size.y??0}px`,Ke=l()?.size.y??0,Ut=(l()?.size.y??0)-r.brightness*(l()?.size.y??0)/255-5,xt=`${l()?.size.y??0}px`,_t=l()?.size.y??0,en=(l()?.size.y??0)-r.alpha*(l()?.size.y??0)/255-5,yr=`${m()}px`,br=(()=>{let St=p();if(St!=null)return`rgb(${St.r}, ${St.g}, ${St.b})`})(),vr=p().a/255;return W!==B.e&&ae(_,"width",B.e=W),ce!==B.t&&ae(_,"height",B.t=ce),xe!==B.a&&ae(C,"cx",B.a=xe),$e!==B.o&&ae(C,"cy",B.o=$e),rt!==B.i&&((B.i=rt)!=null?S.style.setProperty("height",rt):S.style.removeProperty("height")),Ke!==B.n&&ae(P,"height",B.n=Ke),Ut!==B.s&&ae(T,"y",B.s=Ut),xt!==B.h&&((B.h=xt)!=null?x.style.setProperty("height",xt):x.style.removeProperty("height")),_t!==B.r&&ae($,"height",B.r=_t),en!==B.d&&ae(O,"y",B.d=en),yr!==B.l&&((B.l=yr)!=null?Ee.style.setProperty("width",yr):Ee.style.removeProperty("width")),br!==B.u&&((B.u=br)!=null?st.style.setProperty("background-color",br):st.style.removeProperty("background-color")),vr!==B.c&&((B.c=vr)!=null?st.style.setProperty("opacity",vr):st.style.removeProperty("opacity")),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),le(()=>R.value=r.userRedText??r.userColour?.r??u()?.r),le(()=>ee.value=r.userGreenText??r.userColour?.g??u()?.g),le(()=>ke.value=r.userBlueText??r.userColour?.b??u()?.b),le(()=>tt.value=r.userAlphaText??r.userColour?.a??u()?.a),y})()};Oe(["pointermove","pointerout","pointerdown","pointerup","input"]);var Wv=Y(`<svg version=1.1 viewBox="-16 -16 32 32"><defs><linearGradient x1=0 x2=0 y1=0 y2=1><stop offset=0% stop-color="rgb(80, 80, 81)"></stop><stop offset=100% stop-color="rgb(30, 30, 31)"></stop></linearGradient><path d="
        M14.876 -5.890A-16 -16 0 0 0 14.876 5.890A16 16 0 0 112.539 9.938A-16 -16 0 0 0 2.337 15.828
        A16 16 0 0 1-2.337 15.828A-16 -16 0 0 0 -12.539 9.938A16 16 0 0 1-14.876 5.890A-16 -16 0 0 0 -14.876 -5.890
        A16 16 0 0 1-12.539 -9.938A-16 -16 0 0 0 -2.337 -15.828A16 16 0 0 12.337 -15.828A-16 -16 0 0 0 12.539 -9.938
        A16 16 0 0 114.876 -5.890"></path><clipPath><use></use></clipPath><filter></filter><filter></filter></defs><circle cx=0 cy=0 r=15.0 fill="rgb(36, 36, 37)"stroke="rgb(28, 28, 29)"stroke-width=0.5></circle><g><g><g><rect x=-16 y=-16 width=32 height=32></rect><circle cx=-28 cy=-28 r=32 fill="rgba(250, 250, 255, .16)"></circle></g></g></g><g><circle cx=0 cy=-11 r=1.1 fill=black></circle><circle cx=0 cy=-11 r=0.8 fill=white></circle></g><circle cx=0 cy=0 r=9 stroke="rgb(50, 50, 51)"stroke-width=0.7 fill=none></circle><foreignObject x=-9 y=-9 width=18 height=18><div style=width:18px;height:18px;border-radius:50%;background-image:conic-gradient(#aaa,#666,#aaa,#666,#aaa,#666,#aaa);>`);const Hv=t=>{let[r,e]=je({dragging:void 0}),[i,n]=oe();Ne(()=>{r.dragging&&t.setDisablePan(!1)});let o=-165,a=-o,l=E(()=>o+(t.value-t.minValue)*(a-o)/(t.maxValue-t.minValue)),u=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");u.setAttribute("dx","-0.3"),u.setAttribute("dy","-0.3"),u.setAttribute("stdDeviation","0.1"),u.setAttribute("flood-opacity","0.7"),u.setAttribute("flood-color","white");let s=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");s.setAttribute("dx","1.5"),s.setAttribute("dy","1.5"),s.setAttribute("stdDeviation","0.5"),s.setAttribute("flood-opacity","0.9"),s.setAttribute("flood-color","black");let c=y=>{let w=i(),v=w.getBoundingClientRect(),k=y.clientX-v.left,_=y.clientY-v.top,C=k-.5*v.width,S=_-.5*v.width;console.log("x",k.toFixed()),console.log("y",_.toFixed()),console.log("dx",C.toFixed()),console.log("dy",S.toFixed());let P=C*C+S*S;if(P>v.width*v.width)return;let T=Math.sqrt(P),$=360/(2*Math.PI*T),O=S>0?-$:$,N=C>0?$:-$;e("dragging",new Yr({pointerId:y.pointerId,startX:k,startY:_,startValue:t.value,dadx:O,dady:N})),w.setPointerCapture(y.pointerId),t.setDisablePan(!0)},d=y=>{if(r.dragging==null||y.pointerId!=r.dragging.value.pointerId)return;let w=i(),v=r.dragging.value,k=w.getBoundingClientRect(),_=y.clientX-k.left,C=y.clientY-k.top,S=o+(v.startValue-t.minValue)*(a-o)/(t.maxValue-t.minValue)+(_-v.startX)*v.dadx+(C-v.startY)*v.dady,P=t.minValue+(S-o)*(t.maxValue-t.minValue)/(a-o);(t.unbounded??!1)||(P=Math.max(t.minValue,Math.min(t.maxValue,P))),t.setValue(P)},f=y=>{r.dragging!=null&&r.dragging.value.pointerId==y.pointerId&&(i().releasePointerCapture(r.dragging.value.pointerId),t.setDisablePan(!1),e("dragging",void 0))},p=Ht(),h=Ht(),g=Ht(),m=Ht(),b=Ht();return(()=>{var y=Wv(),w=y.firstChild,v=w.firstChild,k=v.nextSibling,_=k.nextSibling,C=_.firstChild,S=_.nextSibling,P=S.nextSibling,T=w.nextSibling,x=T.nextSibling,$=x.firstChild,O=$.firstChild,N=O.firstChild,A=x.nextSibling;y.$$pointerup=f,y.$$pointermove=d,y.$$pointerdown=c;var L=n;return typeof L=="function"?Ce(L,y):n=y,y.style.setProperty("user-select","none"),y.style.setProperty("outline","none"),ae(v,"id",p),ae(k,"id",h),ae(_,"id",g),ae(C,"href",`#${h}`),ae(S,"id",m),te(S,u),ae(P,"id",b),te(P,s),ae(x,"filter",`url(#${b})`),ae($,"filter",`url(#${m})`),ae(O,"clip-path",`url(#${g})`),ae(N,"fill",`url(#${p})`),le(V=>{var Z=`${t.size}px`,G=`${t.size}px`,J=`transform: rotate(${l()}deg) scale(0.87)`,ue=`transform: rotate(${l()}deg)`;return Z!==V.e&&((V.e=Z)!=null?y.style.setProperty("width",Z):y.style.removeProperty("width")),G!==V.t&&((V.t=G)!=null?y.style.setProperty("height",G):y.style.removeProperty("height")),V.a=pa(_,J,V.a),V.o=pa(A,ue,V.o),V},{e:void 0,t:void 0,a:void 0,o:void 0}),y})()};Oe(["pointerdown","pointermove","pointerup"]);var Zv=Y("<div style=width:300px;height:300px;display:flex;flex-direction:column;>");class Yv{componentType=Nd;ext={};create(r){return new Xv(r)}}const Ad=new Yv;class Xv{type=Ad;nodeParams;inputPins;outputPins;ui;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ui=E(()=>()=>(()=>{var n=Zv();return te(n,D(Gv,{get colour(){return new xn(e.colour.red,e.colour.green,e.colour.blue,e.colour.alpha)},onColour:o=>{i("colour",{red:o.r,green:o.g,blue:o.b,alpha:o.a})}})),n})()),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=`vec4(${e.colour.red/255}, ${e.colour.green/255}, ${e.colour.blue/255}, ${e.colour.alpha/255})`;return new Map([["out",{type:"Atom",value:a}]])}}}const Kv=H({colour:U(M),model:U(M),out:ne(M)}),Md=new re({typeName:"ApplyColour",typeSchema:Kv});class Jv{componentType=Md;ext={};create(r){return new Qv(r)}}const Od=new Jv;class Qv{type=Od;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"colour",source:()=>e.colour,setSource:n=>i("colour",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("colour");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();return n.insertGlobalCode(ie`
        void ${c}(vec3 p, out vec4 c) {
          c = vec4(${s});
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:l.sdfFuncName,colourFuncName:c}}]])}}}const e0=H({colour1:U(M),colour2:U(M),size:U(M),model:U(M),out:ne(M)}),Fd=new re({typeName:"ApplyCheckers",typeSchema:e0});class t0{componentType=Fd;ext={};create(r){return new r0(r)}}const Dd=new t0;class r0{type=Dd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"colour1",source:()=>e.colour1,setSource:n=>i("colour1",n)},{name:"colour2",source:()=>e.colour2,setSource:n=>i("colour2",n)},{name:"size",source:()=>e.size,setSource:n=>i("size",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("colour1");if(u?.type!="Atom")return;let s=u.value,c=o.get("colour2");if(c?.type!="Atom")return;let d=c.value,f=o.get("size");if(f?.type!="Atom")return;let p=f.value,h=n.allocVar();return n.insertGlobalCode(ie`
        void ${h}(vec3 p, out vec4 c) {
          p = floor(p / ${p});
          float a = mod(p.x + p.y + p.z, 2.0);
          if (a < 0.5) {
            c = vec4(${s});
          } else {
            c = vec4(${d});
          }
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:l.sdfFuncName,colourFuncName:h}}]])}}}const n0=H({value:ot(),sensitivity:iu(1,ot()),out:ne(M)}),zd=new re({typeName:"UnboundKnob",typeSchema:n0});var i0=Y("<div><label class=label style=color:black;>Value</label><input class=input type=text size=5><label class=label style=color:black;>Sensitivity</label><input class=input type=text size=5>");class o0{componentType=zd;ext={};create(r){return new a0(r)}}const Ld=new o0;class a0{type=Ld;nodeParams;outputPins;ui;disablePan;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r;let[n,o]=oe(!1);this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:a=>i("out",a)}]),this.ui=E(()=>()=>{let[a,l]=oe(e.value.toFixed(3)),[u,s]=oe(e.sensitivity.toFixed(3)),c=!1,d=!1;return Re(he(()=>e.value,f=>{c||l(f.toFixed(3))},{defer:!0})),Re(he(()=>e.sensitivity,f=>{d||s(f.toFixed(3))})),(()=>{var f=i0(),p=f.firstChild,h=p.nextSibling,g=h.nextSibling,m=g.nextSibling;return f.style.setProperty("display","flex"),f.style.setProperty("flex-direction","column"),h.$$input=b=>{let y=b.currentTarget.value;l(y);let w=Number.parseFloat(y.trim());if(!Number.isNaN(w))try{c=!0,i("value",w)}finally{c=!1}},m.$$input=b=>{let y=b.currentTarget.value;s(y);let w=Number.parseFloat(y.trim());if(!Number.isNaN(w))try{d=!0,i("sensitivity",w)}finally{d=!1}},te(f,D(Hv,{size:100,indentSize:10,minValue:0,get maxValue(){return 100*e.sensitivity},unbounded:!0,get value(){return e.value},setValue:b=>i("value",b),setDisablePan:o}),null),le(()=>h.value=a()),le(()=>m.value=u()),f})()}),this.disablePan=n,this.ext.generateCode=({ctx:a,inputs:l,onInit:u})=>{let s=a.allocVar(),c=ie`
        ${ta.float(s)}
      `,d=ut.toSchema(c);return a.insertGlobalCode(c),u(({gl:f,program:p,rerender:h})=>{let g=ra(f,p,d.uniforms);Re(he(()=>e.value,m=>{g[s].set(m),h()}))}),new Map([["out",{type:"Atom",value:s}]])}}}Oe(["input"]);const s0=H({radius:U(M),height:U(M),out:ne(M)}),jd=new re({typeName:"Cylinder",typeSchema:s0});class l0{componentType=jd;ext={};create(r){return new c0(r)}}const Ud=new l0;class c0{type=Ud;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"radius",source:()=>e.radius,setSource:n=>i("radius",n)},{name:"height",source:()=>e.height,setSource:n=>i("height",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let l=a.value,u=o.get("height");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();return n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(${l},${s});
          return min(max(d.x,d.y),0.0) + length(max(d,0.0));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const u0=H({frequency:U(M),magnitude:U(M),out:ne(M)}),Bd=new re({typeName:"SinXYZField",typeSchema:u0});class d0{componentType=Bd;ext={};create(r){return new p0(r)}}const qd=new d0;class p0{type=qd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"frequency",source:()=>e.frequency,setSource:n=>i("frequency",n)},{name:"magnitude",source:()=>e.magnitude,setSource:n=>i("magnitude",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("frequency");if(a?.type!="Atom")return;let l=a.value,u=o.get("magnitude");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();return n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          return ${s} * sin(p.x*${l}) * sin(p.y*${l}) * sin(p.z*${l});
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const f0=H({model1:U(M),model2:U(M),out:ne(M)}),Vd=new re({typeName:"Displace",typeSchema:f0});class h0{componentType=Vd;ext={};create(r){return new m0(r)}}const Gd=new h0;class m0{type=Gd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model1",source:()=>e.model1,setSource:n=>i("model1",n)},{name:"model2",source:()=>e.model2,setSource:n=>i("model2",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=n.allocVar();n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          return d1 + d2;
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ie`
        void ${d}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const g0=H({model:U(M),count:U(M),out:ne(M)}),Wd=new re({typeName:"RepeatRotational",typeSchema:g0});class y0{componentType=Wd;ext={};create(r){return new b0(r)}}const Hd=new y0;class b0{type=Hd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"count",source:()=>e.count,setSource:n=>i("count",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("count");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          float sp = 6.283185/float(${s});
          float an = atan(p.y,p.x);
          float id = floor(an/sp);

          float a1 = sp*(id+0.0);
          float a2 = sp*(id+1.0);
          vec2 r1 = mat2(cos(a1),-sin(a1),sin(a1),cos(a1))*p.xy;
          vec2 r2 = mat2(cos(a2),-sin(a2),sin(a2),cos(a2))*p.xy;

          return min(${l.sdfFuncName}(vec3(r1.x, r1.y, p.z)), ${l.sdfFuncName}(vec3(r2.x,r2.y,p.z)));
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ie`
        void ${d}(vec3 p, out vec4 c) {
          float sp = 6.283185/float(${s});
          float an = atan(p.y,p.x);
          float id = floor(an/sp);
          float a1 = sp*(id+0.0);
          float a2 = sp*(id+1.0);
          vec2 r1 = mat2(cos(a1),-sin(a1),sin(a1),cos(a1))*p.xy;
          vec2 r2 = mat2(cos(a2),-sin(a2),sin(a2),cos(a2))*p.xy;
          vec3 p1 = vec3(r1.x, r1.y, p.z);
          vec3 p2 = vec3(r2.x, r2.y, p.z);
          float d1 = ${l.sdfFuncName}(p1);
          float d2 = ${l.sdfFuncName}(p2);
          if (d1 < d2) {
            p = p1;
          } else {
            p = p2;
          }
          ${l.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const v0=H({model:U(M),k:U(M),out:ne(M)}),Zd=new re({typeName:"Bend",typeSchema:v0});class w0{componentType=Zd;ext={};create(r){return new k0(r)}}const Yd=new w0;class k0{type=Yd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"k",source:()=>e.k,setSource:n=>i("k",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("k");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();return n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          float k = ${s};
          float c = cos(k*p.x);
          float s = sin(k*p.x);
          mat2  m = mat2(c,-s,s,c);
          vec3  q = vec3(m*p.xy,p.z);
          return ${l.sdfFuncName}(q);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const x0=H({mimeType:kt(),base64Data:kt(),out:ne(M)}),Xd=new re({typeName:"Texture",typeSchema:x0});var _0=Y('<button class="btn btn-primary">Browse...'),S0=Y("<input type=file hidden>");class C0{componentType=Xd;ext={};create(r){return new P0(r)}}const Kd=new C0;class P0{type=Kd;nodeParams;outputPins;ui;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:a=>i("out",a)}]),this.ui=E(()=>()=>{let[a,l]=oe(),u=async s=>{let c=s.type,d=await s.arrayBuffer(),f=new Uint8Array(d),p=lu(f);Be(()=>{i("mimeType",c),i("base64Data",p)})};return[(()=>{var s=_0();return s.$$click=()=>a()?.click(),s})(),(()=>{var s=S0();s.addEventListener("change",d=>{let f=d.currentTarget.files;if(f==null||f.length!=1)return;let p=f[0];u(p),d.currentTarget.value=""});var c=l;return typeof c=="function"?Ce(c,s):l=s,s})()]});let n=E(()=>{if(e.mimeType==""||e.base64Data=="")return;let a=cu(e.base64Data),l=new Blob([a],{type:e.mimeType}),u=URL.createObjectURL(l),[s,c]=oe(),d=document.createElement("img");return d.src=u,d.onload=()=>{c(d)},Ne(()=>{URL.revokeObjectURL(u)}),s}),o=E(()=>n()?.());this.ext.generateCode=({ctx:a,onInit:l})=>{let u=a.allocVar(),s=ie`
        ${ta.sampler2D(u)}
      `;a.insertGlobalCode(s);let c=ut.toSchema(s);return l(({gl:d,program:f,rerender:p})=>{ra(d,f,c.uniforms)[u].set(0);let g=d.createTexture();d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,g),Re(he(o,m=>{m!=null&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,m),p())})),Ne(()=>{d.deleteTexture(g)})}),new Map([["out",{type:"Atom",value:u}]])}}}Oe(["click"]);const T0=H({model:U(M),texture:U(M),scaleX:U(M),scaleY:U(M),offsetX:U(M),offsetY:U(M),out:ne(M)}),Jd=new re({typeName:"ApplyTexture",typeSchema:T0});class E0{componentType=Jd;ext={};create(r){return new $0(r)}}const Qd=new E0;class $0{type=Qd;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"texture",source:()=>e.texture,setSource:n=>i("texture",n)},{name:"scaleX",source:()=>e.scaleX,setSource:n=>i("scaleX",n)},{name:"scaleY",source:()=>e.scaleY,setSource:n=>i("scaleY",n)},{name:"offsetX",source:()=>e.offsetX,setSource:n=>i("offsetX",n)},{name:"offsetY",source:()=>e.offsetY,setSource:n=>i("offsetY",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("texture");if(u?.type!="Atom")return;let s=u.value,c=o.get("scaleX"),d;c?.type=="Atom"?d=c.value:d="1.0";let f=o.get("scaleY"),p;f?.type=="Atom"?p=f.value:p="1.0";let h=o.get("offsetX"),g;h?.type=="Atom"?g=h.value:g="0.0";let m=o.get("offsetY"),b;m?.type=="Atom"?b=m.value:b="0.0";let y=n.allocVar();return n.insertGlobalCode(ie`
        void ${y}(vec3 p, out vec4 c) {
          c = texture2D(${s}, (p.xy + vec2(${g}, ${b})) / vec2(${d}, ${p}));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:l.sdfFuncName,colourFuncName:y}}]])}}}const I0=H({radius:U(M),height:U(M),out:ne(M)}),ep=new re({typeName:"Cone",typeSchema:I0});class R0{componentType=ep;ext={};create(r){return new N0(r)}}const tp=new R0;class N0{type=tp;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"radius",source:()=>e.radius,setSource:n=>i("radius",n)},{name:"height",source:()=>e.height,setSource:n=>i("height",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let l=a.value,u=o.get("height");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();return n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          float h = ${s};
          float z = sqrt(${s} * ${s} + ${l} * ${l});
          vec2 c = vec2(${l} / z, ${s} / z);
          vec2 q = h*vec2(c.x/c.y,-1.0);
          vec2 w = vec2( length(p.xz), p.y );
          vec2 a = w - q*clamp( dot(w,q)/dot(q,q), 0.0, 1.0 );
          vec2 b = w - q*vec2( clamp( w.x/q.x, 0.0, 1.0 ), 1.0 );
          float k = sign( q.y );
          float d = min(dot( a, a ),dot(b, b));
          float s = max( k*(w.x*q.y-w.y*q.x),k*(w.y-q.y)  );
          return sqrt(d)*sign(s);        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const A0=H({radius1:U(M),radius2:U(M),out:ne(M)}),rp=new re({typeName:"Torus",typeSchema:A0});class M0{componentType=rp;ext={};create(r){return new O0(r)}}const np=new M0;class O0{type=np;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"radius1",source:()=>e.radius1,setSource:n=>i("radius1",n)},{name:"radius2",source:()=>e.radius2,setSource:n=>i("radius2",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius1");if(a?.type!="Atom")return;let l=a.value,u=o.get("radius2");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();return n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          vec2 q = vec2(length(p.xz)-${l},p.y);
          return length(q)-${s};
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const F0=H({model:U(M),out:ne(M)}),ip=new re({typeName:"Mirror",typeSchema:F0});class D0{componentType=ip;ext={};create(r){return new z0(r)}}const op=new D0;class z0{type=op;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=n.allocVar();n.insertGlobalCode(ie`
        float ${u}(vec3 p) {
          return ${l.sdfFuncName}(
            vec3(-p.x, p.y, p.z)
          );
        }
      `);let s=n.allocVar();return n.insertGlobalCode(ie`
        void ${s}(vec3 p, out vec4 c) {
          ${l.colourFuncName}(
            vec3(-p.x, p.y, p.z),
            c
          );
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:s}}]])}}}const L0=H({model1:U(M),model2:U(M),k:U(M),out:ne(M)}),ap=new re({typeName:"Intersection",typeSchema:L0});class j0{componentType=ap;ext={};create(r){return new U0(r)}}const sp=new j0;class U0{type=sp;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model1",source:()=>e.model1,setSource:n=>i("model1",n)},{name:"model2",source:()=>e.model2,setSource:n=>i("model2",n)},{name:"k",source:()=>e.k,setSource:n=>i("k",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let d=n.allocVar();if(c?.type=="Atom"){let p=c.value;n.insertGlobalCode(ie`
          float ${d}(vec3 p) {
            float k = ${p} * 4.0;
            float d1 = -${l.sdfFuncName}(p);
            float d2 = -${s.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return -(min(d1, d2) - h*h*0.25/k);
          }
        `)}else n.insertGlobalCode(ie`
          float ${d}(vec3 p) {
            return max(${l.sdfFuncName}(p), ${s.sdfFuncName}(p));
          }
        `);let f=n.allocVar();return n.insertGlobalCode(ie`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:d,colourFuncName:f}}]])}}}const B0=H({model1:U(M),model2:U(M),k:U(M),out:ne(M)}),lp=new re({typeName:"Xor",typeSchema:B0});class q0{componentType=lp;ext={};create(r){return new V0(r)}}const cp=new q0;class V0{type=cp;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model1",source:()=>e.model1,setSource:n=>i("model1",n)},{name:"model2",source:()=>e.model2,setSource:n=>i("model2",n)},{name:"k",source:()=>e.k,setSource:n=>i("k",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let l=a.value,u=o.get("model2");if(u?.type!="Model")return;let s=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let d=n.allocVar();if(c?.type=="Atom"){let p=c.value;n.insertGlobalCode(ie`
          float ${d}(vec3 p) {
            float k = ${p} * 4.0;
            float d1 = ${l.sdfFuncName}(p);
            float d2 = ${s.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return max(min(d1,d2),-max(d1,d2)) - h*h*0.25/k;
          }
        `)}else n.insertGlobalCode(ie`
          float ${d}(vec3 p) {
            float d1 = ${l.sdfFuncName}(p);
            float d2 = ${s.sdfFuncName}(p);
            return max(min(d1,d2),-max(d1,d2));
          }
        `);let f=n.allocVar();return n.insertGlobalCode(ie`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${l.sdfFuncName}(p);
          float d2 = ${s.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${l.colourFuncName}(p, c1);
          ${s.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:d,colourFuncName:f}}]])}}}const G0=H({size:U(M),out:ne(M)}),up=new re({typeName:"Octahedron",typeSchema:G0});class W0{componentType=up;ext={};create(r){return new H0(r)}}const dp=new W0;class H0{type=dp;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"size",source:()=>e.size,setSource:n=>i("size",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("size");if(a?.type!="Atom")return;let l=a.value,u=n.allocVar();return n.insertGlobalCode(ie`
        float ${u}(vec3 p) {
          p = abs(p);
          float s = ${l};
          float m = p.x+p.y+p.z-s;
          vec3 q;
               if( 3.0*p.x < m ) q = p.xyz;
          else if( 3.0*p.y < m ) q = p.yzx;
          else if( 3.0*p.z < m ) q = p.zxy;
          else return m*0.57735027;
          float k = clamp(0.5*(q.z-q.y+s),0.0,s); 
          return length(vec3(q.x,q.y-s+k,q.z-k));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:"defaultColour"}}]])}}}const Z0=H({model:U(M),radius:U(M),out:ne(M)}),pp=new re({typeName:"Round",typeSchema:Z0});class Y0{componentType=pp;ext={};create(r){return new X0(r)}}const fp=new Y0;class X0{type=fp;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"radius",source:()=>e.radius,setSource:n=>i("radius",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("radius");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();return n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          return ${l.sdfFuncName}(p) - ${s};
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:l.colourFuncName}}]])}}}const K0=H({out:ne(M)}),hp=new re({typeName:"Heart2D",typeSchema:K0});class J0{componentType=hp;ext={};create(r){return new Q0(r)}}const mp=new J0;class Q0{type=mp;nodeParams;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=n.allocVar();return n.insertGlobalCode(ie`
        float ${a}(vec3 p2) {
          vec2 p = p2.xy;
          p.x = abs(p.x);
          if( p.y+p.x>1.0 )
            return sqrt(dot2(p-vec2(0.25,0.75))) - sqrt(2.0)/4.0;
          return sqrt(min(dot2(p-vec2(0.00,1.00)),
                          dot2(p-0.5*max(p.x+p.y,0.0)))) * sign(p.x-p.y);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:a,colourFuncName:"defaultColour"}}]])}}}const ew=H({model2D:U(M),height:U(M),out:ne(M)}),gp=new re({typeName:"Extrusion",typeSchema:ew});class tw{componentType=gp;ext={};create(r){return new rw(r)}}const yp=new tw;class rw{type=yp;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model2D",source:()=>e.model2D,setSource:n=>i("model2D",n)},{name:"height",source:()=>e.height,setSource:n=>i("height",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model2D");if(a?.type!="Model")return;let l=a.value,u=o.get("height");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();return n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          float d = ${l.sdfFuncName}(p);
          vec2 w = vec2( d, abs(p.z) - ${s} );
          return min(max(w.x,w.y),0.0) + length(max(w,0.0));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const nw=H({model:U(M),out:ne(M)}),bp=new re({typeName:"Revolution",typeSchema:nw});class iw{componentType=bp;ext={};create(r){return new ow(r)}}const vp=new iw;class ow{type=vp;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=n.allocVar();return n.insertGlobalCode(ie`
        float ${u}(vec3 p) {
          vec3 q = vec3( length(p.xz), p.y, 0.0 );
          return ${l.sdfFuncName}(q);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:l.colourFuncName}}]])}}}const aw=H({model:U(M),scaleX:U(M),out:ne(M)}),wp=new re({typeName:"ScaleX",typeSchema:aw});var sw=Y('<i style=color:yellow;background-color:black; class="fa-solid fa-triangle-exclamation">');class lw{componentType=wp;ext={};create(r){return new cw(r)}}const kp=new lw;class cw{type=kp;nodeParams;inputPins;outputPins;ext={};ui;constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"model",source:()=>e.model,setSource:n=>i("model",n)},{name:"scaleX",source:()=>e.scaleX,setSource:n=>i("scaleX",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ui=E(()=>()=>sw()),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let l=a.value,u=o.get("scaleX");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          return ${l.sdfFuncName}(vec3(p.x / ${s}, p.y, p.z));
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ie`
        void ${d}(vec3 p, out vec4 c) {
          ${l.colourFuncName}(vec3(p.x / ${s}, p.y, p.z), c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const uw=H({radius:U(M),height:U(M),out:ne(M)}),xp=new re({typeName:"Capsule",typeSchema:uw});class dw{componentType=xp;ext={};create(r){return new pw(r)}}const _p=new dw;class pw{type=_p;nodeParams;inputPins;outputPins;ext={};constructor(r){let e=r.state,i=r.setState;this.nodeParams=r,this.inputPins=E(()=>[{name:"height",source:()=>e.height,setSource:n=>i("height",n)},{name:"radius",source:()=>e.radius,setSource:n=>i("radius",n)}]),this.outputPins=E(()=>[{name:"out",sinks:()=>e.out,setSinks:n=>i("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("height");if(a?.type!="Atom")return;let l=a.value,u=o.get("radius");if(u?.type!="Atom")return;let s=u.value,c=n.allocVar();return n.insertGlobalCode(ie`
        float ${c}(vec3 p) {
          p.y -= clamp( p.y, 0.0, ${l} );
          return length( p ) - ${s};
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const Sp=new uu;Sp.registerNodeTypes([Dd,Od,Qd,Yd,vd,_p,Ad,tp,Ud,_d,Gd,fd,yp,mp,Rd,sp,op,Ld,cd,dp,Cd,Hd,vp,$d,fp,Td,kp,qd,sd,Kd,np,yd,kd,md,cp]);class fw{nextId=0;globalCode=[];mainBody=[];colourBody=[];allocVar(){return`x${this.nextId++}`}insertGlobalCode(r){this.globalCode.push(r)}insertCode(r){this.mainBody.push(r)}insertColourCode(r){this.colourBody.push(r)}genCode(r){let e=r.maxIterations??100;return ie`precision highp float;
uniform vec2 resolution;
uniform float uTollerance;
uniform float uMaxStep;
uniform float uFocalLength;
uniform mat4 uInverseViewMatrix;
uniform bool uUseOrthogonalProjection;
uniform float uOrthogonalScale;

float dot2( in vec2 v ) { return dot(v,v); }
float dot2( in vec3 v ) { return dot(v,v); }
float ndot( in vec2 a, in vec2 b ) { return a.x*b.x - a.y*b.y; }

void defaultColour(vec3 p, out vec4 c) {
  c = vec4(1.0, 1.0, 1.0, 1.0);
}

${this.globalCode}

float map(vec3 p) {
  float d = 100000000.0;
  ${this.mainBody}
  return d;
}

void colourMap(vec3 p, out vec4 c) {
  float d = 100000000.0;
  ${this.colourBody}
}

bool march(vec3 ro, vec3 rd, bool negateDist, out float t) {
  vec3 p = ro;
  t = 0.0;
  for (int i = 0; i < ${e}; ++i) {
    vec3 p = ro + rd*t;
    float d = map(p);
    if (negateDist) {
      d = -d;
    }
    if (d <= uTollerance) {
      return true;
    }
    if (d > uMaxStep) {
      return false;
    }
    t += d;
  }
  return false;
}

vec3 normal(vec3 p) {
  float d = 0.01;
  float mp = map(p);
  float dx = map(p + vec3(d,0,0)) - mp;
  float dy = map(p + vec3(0,d,0)) - mp;
  float dz = map(p + vec3(0,0,d)) - mp;
  return normalize(vec3(dx,dy,dz));
}

void main(void) {
  float fl = uFocalLength;
  float d = 10000.0;
  float mx = max(resolution.x, resolution.y);
  vec2 uv = gl_FragCoord.xy / mx;
  vec3 w = normalize(vec3(0.0, 0.0, 1.0));
  vec3 u = normalize(cross(vec3(0,1,0),w));
  vec3 v = cross(w,u);
  vec3 ro;
  vec3 rd;
  if (uUseOrthogonalProjection) {
    ro = (gl_FragCoord.x - 0.5 * resolution.x) * u / uOrthogonalScale
       + (gl_FragCoord.y - 0.5 * resolution.y) * v / uOrthogonalScale;
    rd = vec3(0.0, 0.0, -1.0);
  } else {
    ro = vec3(0.0);
    rd = normalize(
      (gl_FragCoord.x - 0.5 * resolution.x) * u +
      (gl_FragCoord.y - 0.5 * resolution.y) * v +
      -fl * w
    );
  }
  vec3 rp = ro + rd;
  ro = (uInverseViewMatrix * vec4(ro, 1.0)).xyz;
  rp = (uInverseViewMatrix * vec4(rp, 1.0)).xyz;
  rd = rp - ro;
  float t = 0.0;
  bool hit = march(ro, rd, false, t);
  if (!hit) {
    gl_FragColor = vec4(0.2, 0.2, 0.2, 1.0);
    return;
  }
  vec3 p = ro + rd*t;
  vec3 n = normal(p);
  float s = dot(n,normalize(vec3(1,1,1))) + 0.2;
  vec4 c = vec4(1.0, 1.0, 1.0, 1.0);
  colourMap(p, c);
  c = vec4(c.rgb * s, c.a);
  if (c.a < 1.0) {
    vec3 ro2 = p + rd*100.0;
    vec3 rd2 = refract(rd, n, 1.0/1.5);
    march(ro2, rd2, true, t);
    p = ro2 + rd2*t;
    n = normal(p);
    ro2 = p + rd2*100.0;
    rd2 = refract(rd2, -n, 1.5);
    hit = march(ro2, rd2, false, t);
    vec4 c2;
    if (!hit) {
      c2 = vec4(0.2,0.2,0.2,1.0);
    } else {
      p = ro2 + rd2*t;
      n = normal(p);
      colourMap(p, c2);
      s = dot(n,normalize(vec3(1,1,1))) + 0.2;
      c2 = vec4(c2.rgb * s, 1.0);
    }
    c = vec4(c.rgb * c.a + c2.rgb * (1.0 - c.a), 1.0);
  }
  gl_FragColor = c;
}`}}function hw(t){let r=t.nodesSystem,e=[];{let u=new Map;for(let s of r.nodes()){let c={id:0,inputs:{},outputs:{},height:0,node:s};u.set(s.node.nodeParams.entity,c),e.push(c)}for(let s of u.values())for(let c of s.node.node.inputPins?.()??[]){let d=c.source();if(d==null)continue;let f=u.get(d.target);f!=null&&(s.inputs[c.name]={node:f,pin:d.pin})}}for(let u of e)for(let[s,{node:c,pin:d}]of Object.entries(u.inputs)){let f=c.outputs[d],p={node:u,pin:s};f==null?(f=[p],c.outputs[d]=f):f.push(p)}let i=[];mw(e);{let u=0;for(let s of e)s.id=u++}let n=new fw;i.splice(0,i.length);for(let u of e){let s=i[u.height];s==null?(s=[u],i[u.height]=s):s.push(u)}let o=new Map,a=[];for(let u=0;u<i.length;++u){let s=i[u]??[];for(let c of s){let d=c.node.node,f=new Map;for(let p of Object.entries(c.inputs)){let h=o.get(p[1].node)?.get(p[1].pin);h!=null&&f.set(p[0],h)}if(d.ext.generateCode!=null){let p=d.ext.generateCode({ctx:n,inputs:f,onInit:h=>a.push(h)});p!=null&&o.set(c,p)}}}let l=u=>{for(let s of a)s(u)};return{code:n.genCode({maxIterations:t.maxIterations}),onInit:l}}function mw(t){let r=new Set,e=[...t],i=[];for(;;){let n=e.pop();if(n==null){let l=e;if(e=i,i=l,n=e.pop(),n==null)break}if(r.has(n))continue;let o=!0;for(let[l,{node:u}]of Object.entries(n.inputs))if(!(n.node.node.inputPins?.().find(s=>s.name==l)?.isEffectPin??!1)&&!r.has(u)){o=!1;break}if(!o){i.push(n);continue}let a=0;for(let[,{node:l,pin:u}]of Object.entries(n.inputs))(l.node.node.outputPins?.().find(({name:s})=>s==u)?.isEffectPin??!1)||l.height>=a&&(a=l.height+1);n.height=a,r.add(n)}}const pl=new Vo([...au.componentTypes,Fd,Md,Jd,Zd,bd,xp,Nd,ep,jd,xd,Vd,ud,gp,hp,Id,ap,ip,Qo,ld,up,Sd,Wd,bp,Ed,pp,Pd,wp,Bd,rd,Xd,rp,Ae,gd,zd,wd,hd,lp]);class gw{space;pointerDown;pointerUp;pointerMove;constructor(r){let[e,i]=je({space:r.initSpace,orbitTarget:r.initOrbitTarget,orbiting:void 0});this.space=()=>e.space,this.pointerDown=n=>{e.orbiting||i("orbiting",new Yr({pointerId:n.pointerId,startPoint:lo.create(n.clientX,n.clientY),startOrigin:e.space.origin}))},this.pointerUp=n=>{e.orbiting!=null&&n.pointerId==n.pointerId&&i("orbiting",void 0)},this.pointerMove=n=>{if(e.orbiting){let o=e.orbiting.value,a=n.clientX-o.startPoint.x,l=n.clientY-o.startPoint.y,s=we.fromAxisAngle(X.unitY,-a).rotate$Vec3(o.startOrigin.sub(e.orbitTarget)),c=X.create(s.z,0,-s.x).normalize();s=we.fromAxisAngle(c,-l).rotate$Vec3(s);let f=s.add(e.orbitTarget),p=s.normalize();c=X.unitY.cross(p).normalize();let h=qe.create(f,we.fromWU(p,c));i("space",h)}}}writeGLInverseViewMatrix(r){let e=this.space(),i=e.u,n=e.v,o=e.w,a=e.o;r[0]=i.x,r[4]=n.x,r[8]=o.x,r[12]=a.x,r[1]=i.y,r[5]=n.y,r[9]=o.y,r[13]=a.y,r[2]=i.z,r[6]=n.z,r[10]=o.z,r[14]=a.z,r[3]=0,r[7]=0,r[11]=0,r[15]=1}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const yw=4,fl=0,hl=1,bw=2;function fr(t){let r=t.length;for(;--r>=0;)t[r]=0}const vw=0,Cp=1,ww=2,kw=3,xw=258,na=29,Xr=256,Ur=Xr+1+na,cr=30,ia=19,Pp=2*Ur+1,Yt=15,Zi=16,_w=7,oa=256,Tp=16,Ep=17,$p=18,_o=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),_n=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Sw=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ip=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Cw=512,Tt=new Array((Ur+2)*2);fr(Tt);const Or=new Array(cr*2);fr(Or);const Br=new Array(Cw);fr(Br);const qr=new Array(xw-kw+1);fr(qr);const aa=new Array(na);fr(aa);const $n=new Array(cr);fr($n);function Yi(t,r,e,i,n){this.static_tree=t,this.extra_bits=r,this.extra_base=e,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let Rp,Np,Ap;function Xi(t,r){this.dyn_tree=t,this.max_code=0,this.stat_desc=r}const Mp=t=>t<256?Br[t]:Br[256+(t>>>7)],Vr=(t,r)=>{t.pending_buf[t.pending++]=r&255,t.pending_buf[t.pending++]=r>>>8&255},et=(t,r,e)=>{t.bi_valid>Zi-e?(t.bi_buf|=r<<t.bi_valid&65535,Vr(t,t.bi_buf),t.bi_buf=r>>Zi-t.bi_valid,t.bi_valid+=e-Zi):(t.bi_buf|=r<<t.bi_valid&65535,t.bi_valid+=e)},mt=(t,r,e)=>{et(t,e[r*2],e[r*2+1])},Op=(t,r)=>{let e=0;do e|=t&1,t>>>=1,e<<=1;while(--r>0);return e>>>1},Pw=t=>{t.bi_valid===16?(Vr(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},Tw=(t,r)=>{const e=r.dyn_tree,i=r.max_code,n=r.stat_desc.static_tree,o=r.stat_desc.has_stree,a=r.stat_desc.extra_bits,l=r.stat_desc.extra_base,u=r.stat_desc.max_length;let s,c,d,f,p,h,g=0;for(f=0;f<=Yt;f++)t.bl_count[f]=0;for(e[t.heap[t.heap_max]*2+1]=0,s=t.heap_max+1;s<Pp;s++)c=t.heap[s],f=e[e[c*2+1]*2+1]+1,f>u&&(f=u,g++),e[c*2+1]=f,!(c>i)&&(t.bl_count[f]++,p=0,c>=l&&(p=a[c-l]),h=e[c*2],t.opt_len+=h*(f+p),o&&(t.static_len+=h*(n[c*2+1]+p)));if(g!==0){do{for(f=u-1;t.bl_count[f]===0;)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[u]--,g-=2}while(g>0);for(f=u;f!==0;f--)for(c=t.bl_count[f];c!==0;)d=t.heap[--s],!(d>i)&&(e[d*2+1]!==f&&(t.opt_len+=(f-e[d*2+1])*e[d*2],e[d*2+1]=f),c--)}},Fp=(t,r,e)=>{const i=new Array(Yt+1);let n=0,o,a;for(o=1;o<=Yt;o++)n=n+e[o-1]<<1,i[o]=n;for(a=0;a<=r;a++){let l=t[a*2+1];l!==0&&(t[a*2]=Op(i[l]++,l))}},Ew=()=>{let t,r,e,i,n;const o=new Array(Yt+1);for(e=0,i=0;i<na-1;i++)for(aa[i]=e,t=0;t<1<<_o[i];t++)qr[e++]=i;for(qr[e-1]=i,n=0,i=0;i<16;i++)for($n[i]=n,t=0;t<1<<_n[i];t++)Br[n++]=i;for(n>>=7;i<cr;i++)for($n[i]=n<<7,t=0;t<1<<_n[i]-7;t++)Br[256+n++]=i;for(r=0;r<=Yt;r++)o[r]=0;for(t=0;t<=143;)Tt[t*2+1]=8,t++,o[8]++;for(;t<=255;)Tt[t*2+1]=9,t++,o[9]++;for(;t<=279;)Tt[t*2+1]=7,t++,o[7]++;for(;t<=287;)Tt[t*2+1]=8,t++,o[8]++;for(Fp(Tt,Ur+1,o),t=0;t<cr;t++)Or[t*2+1]=5,Or[t*2]=Op(t,5);Rp=new Yi(Tt,_o,Xr+1,Ur,Yt),Np=new Yi(Or,_n,0,cr,Yt),Ap=new Yi(new Array(0),Sw,0,ia,_w)},Dp=t=>{let r;for(r=0;r<Ur;r++)t.dyn_ltree[r*2]=0;for(r=0;r<cr;r++)t.dyn_dtree[r*2]=0;for(r=0;r<ia;r++)t.bl_tree[r*2]=0;t.dyn_ltree[oa*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},zp=t=>{t.bi_valid>8?Vr(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},ml=(t,r,e,i)=>{const n=r*2,o=e*2;return t[n]<t[o]||t[n]===t[o]&&i[r]<=i[e]},Ki=(t,r,e)=>{const i=t.heap[e];let n=e<<1;for(;n<=t.heap_len&&(n<t.heap_len&&ml(r,t.heap[n+1],t.heap[n],t.depth)&&n++,!ml(r,i,t.heap[n],t.depth));)t.heap[e]=t.heap[n],e=n,n<<=1;t.heap[e]=i},gl=(t,r,e)=>{let i,n,o=0,a,l;if(t.sym_next!==0)do i=t.pending_buf[t.sym_buf+o++]&255,i+=(t.pending_buf[t.sym_buf+o++]&255)<<8,n=t.pending_buf[t.sym_buf+o++],i===0?mt(t,n,r):(a=qr[n],mt(t,a+Xr+1,r),l=_o[a],l!==0&&(n-=aa[a],et(t,n,l)),i--,a=Mp(i),mt(t,a,e),l=_n[a],l!==0&&(i-=$n[a],et(t,i,l)));while(o<t.sym_next);mt(t,oa,r)},So=(t,r)=>{const e=r.dyn_tree,i=r.stat_desc.static_tree,n=r.stat_desc.has_stree,o=r.stat_desc.elems;let a,l,u=-1,s;for(t.heap_len=0,t.heap_max=Pp,a=0;a<o;a++)e[a*2]!==0?(t.heap[++t.heap_len]=u=a,t.depth[a]=0):e[a*2+1]=0;for(;t.heap_len<2;)s=t.heap[++t.heap_len]=u<2?++u:0,e[s*2]=1,t.depth[s]=0,t.opt_len--,n&&(t.static_len-=i[s*2+1]);for(r.max_code=u,a=t.heap_len>>1;a>=1;a--)Ki(t,e,a);s=o;do a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Ki(t,e,1),l=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=l,e[s*2]=e[a*2]+e[l*2],t.depth[s]=(t.depth[a]>=t.depth[l]?t.depth[a]:t.depth[l])+1,e[a*2+1]=e[l*2+1]=s,t.heap[1]=s++,Ki(t,e,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],Tw(t,r),Fp(e,u,t.bl_count)},yl=(t,r,e)=>{let i,n=-1,o,a=r[0*2+1],l=0,u=7,s=4;for(a===0&&(u=138,s=3),r[(e+1)*2+1]=65535,i=0;i<=e;i++)o=a,a=r[(i+1)*2+1],!(++l<u&&o===a)&&(l<s?t.bl_tree[o*2]+=l:o!==0?(o!==n&&t.bl_tree[o*2]++,t.bl_tree[Tp*2]++):l<=10?t.bl_tree[Ep*2]++:t.bl_tree[$p*2]++,l=0,n=o,a===0?(u=138,s=3):o===a?(u=6,s=3):(u=7,s=4))},bl=(t,r,e)=>{let i,n=-1,o,a=r[0*2+1],l=0,u=7,s=4;for(a===0&&(u=138,s=3),i=0;i<=e;i++)if(o=a,a=r[(i+1)*2+1],!(++l<u&&o===a)){if(l<s)do mt(t,o,t.bl_tree);while(--l!==0);else o!==0?(o!==n&&(mt(t,o,t.bl_tree),l--),mt(t,Tp,t.bl_tree),et(t,l-3,2)):l<=10?(mt(t,Ep,t.bl_tree),et(t,l-3,3)):(mt(t,$p,t.bl_tree),et(t,l-11,7));l=0,n=o,a===0?(u=138,s=3):o===a?(u=6,s=3):(u=7,s=4)}},$w=t=>{let r;for(yl(t,t.dyn_ltree,t.l_desc.max_code),yl(t,t.dyn_dtree,t.d_desc.max_code),So(t,t.bl_desc),r=ia-1;r>=3&&t.bl_tree[Ip[r]*2+1]===0;r--);return t.opt_len+=3*(r+1)+5+5+4,r},Iw=(t,r,e,i)=>{let n;for(et(t,r-257,5),et(t,e-1,5),et(t,i-4,4),n=0;n<i;n++)et(t,t.bl_tree[Ip[n]*2+1],3);bl(t,t.dyn_ltree,r-1),bl(t,t.dyn_dtree,e-1)},Rw=t=>{let r=4093624447,e;for(e=0;e<=31;e++,r>>>=1)if(r&1&&t.dyn_ltree[e*2]!==0)return fl;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return hl;for(e=32;e<Xr;e++)if(t.dyn_ltree[e*2]!==0)return hl;return fl};let vl=!1;const Nw=t=>{vl||(Ew(),vl=!0),t.l_desc=new Xi(t.dyn_ltree,Rp),t.d_desc=new Xi(t.dyn_dtree,Np),t.bl_desc=new Xi(t.bl_tree,Ap),t.bi_buf=0,t.bi_valid=0,Dp(t)},Lp=(t,r,e,i)=>{et(t,(vw<<1)+(i?1:0),3),zp(t),Vr(t,e),Vr(t,~e),e&&t.pending_buf.set(t.window.subarray(r,r+e),t.pending),t.pending+=e},Aw=t=>{et(t,Cp<<1,3),mt(t,oa,Tt),Pw(t)},Mw=(t,r,e,i)=>{let n,o,a=0;t.level>0?(t.strm.data_type===bw&&(t.strm.data_type=Rw(t)),So(t,t.l_desc),So(t,t.d_desc),a=$w(t),n=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=n&&(n=o)):n=o=e+5,e+4<=n&&r!==-1?Lp(t,r,e,i):t.strategy===yw||o===n?(et(t,(Cp<<1)+(i?1:0),3),gl(t,Tt,Or)):(et(t,(ww<<1)+(i?1:0),3),Iw(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),gl(t,t.dyn_ltree,t.dyn_dtree)),Dp(t),i&&zp(t)},Ow=(t,r,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=r,t.pending_buf[t.sym_buf+t.sym_next++]=r>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,r===0?t.dyn_ltree[e*2]++:(t.matches++,r--,t.dyn_ltree[(qr[e]+Xr+1)*2]++,t.dyn_dtree[Mp(r)*2]++),t.sym_next===t.sym_end);var Fw=Nw,Dw=Lp,zw=Mw,Lw=Ow,jw=Aw,Uw={_tr_init:Fw,_tr_stored_block:Dw,_tr_flush_block:zw,_tr_tally:Lw,_tr_align:jw};const Bw=(t,r,e,i)=>{let n=t&65535|0,o=t>>>16&65535|0,a=0;for(;e!==0;){a=e>2e3?2e3:e,e-=a;do n=n+r[i++]|0,o=o+n|0;while(--a);n%=65521,o%=65521}return n|o<<16|0};var Gr=Bw;const qw=()=>{let t,r=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;r[e]=t}return r},Vw=new Uint32Array(qw()),Gw=(t,r,e,i)=>{const n=Vw,o=i+e;t^=-1;for(let a=i;a<o;a++)t=t>>>8^n[(t^r[a])&255];return t^-1};var ze=Gw,Qt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},hr={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ww,_tr_stored_block:Co,_tr_flush_block:Hw,_tr_tally:Ot,_tr_align:Zw}=Uw,{Z_NO_FLUSH:Ft,Z_PARTIAL_FLUSH:Yw,Z_FULL_FLUSH:Xw,Z_FINISH:ct,Z_BLOCK:wl,Z_OK:Ue,Z_STREAM_END:kl,Z_STREAM_ERROR:vt,Z_DATA_ERROR:Kw,Z_BUF_ERROR:Ji,Z_DEFAULT_COMPRESSION:Jw,Z_FILTERED:Qw,Z_HUFFMAN_ONLY:ln,Z_RLE:ek,Z_FIXED:tk,Z_DEFAULT_STRATEGY:rk,Z_UNKNOWN:nk,Z_DEFLATED:On}=hr,ik=9,ok=15,ak=8,sk=29,lk=256,Po=lk+1+sk,ck=30,uk=19,dk=2*Po+1,pk=15,pe=3,At=258,wt=At+pe+1,fk=32,dr=42,sa=57,To=69,Eo=73,$o=91,Io=103,Xt=113,Rr=666,Ye=1,mr=2,er=3,gr=4,hk=3,Kt=(t,r)=>(t.msg=Qt[r],r),xl=t=>t*2-(t>4?9:0),Nt=t=>{let r=t.length;for(;--r>=0;)t[r]=0},mk=t=>{let r,e,i,n=t.w_size;r=t.hash_size,i=r;do e=t.head[--i],t.head[i]=e>=n?e-n:0;while(--r);r=n,i=r;do e=t.prev[--i],t.prev[i]=e>=n?e-n:0;while(--r)};let gk=(t,r,e)=>(r<<t.hash_shift^e)&t.hash_mask,Dt=gk;const nt=t=>{const r=t.state;let e=r.pending;e>t.avail_out&&(e=t.avail_out),e!==0&&(t.output.set(r.pending_buf.subarray(r.pending_out,r.pending_out+e),t.next_out),t.next_out+=e,r.pending_out+=e,t.total_out+=e,t.avail_out-=e,r.pending-=e,r.pending===0&&(r.pending_out=0))},at=(t,r)=>{Hw(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,r),t.block_start=t.strstart,nt(t.strm)},me=(t,r)=>{t.pending_buf[t.pending++]=r},Pr=(t,r)=>{t.pending_buf[t.pending++]=r>>>8&255,t.pending_buf[t.pending++]=r&255},Ro=(t,r,e,i)=>{let n=t.avail_in;return n>i&&(n=i),n===0?0:(t.avail_in-=n,r.set(t.input.subarray(t.next_in,t.next_in+n),e),t.state.wrap===1?t.adler=Gr(t.adler,r,n,e):t.state.wrap===2&&(t.adler=ze(t.adler,r,n,e)),t.next_in+=n,t.total_in+=n,n)},jp=(t,r)=>{let e=t.max_chain_length,i=t.strstart,n,o,a=t.prev_length,l=t.nice_match;const u=t.strstart>t.w_size-wt?t.strstart-(t.w_size-wt):0,s=t.window,c=t.w_mask,d=t.prev,f=t.strstart+At;let p=s[i+a-1],h=s[i+a];t.prev_length>=t.good_match&&(e>>=2),l>t.lookahead&&(l=t.lookahead);do if(n=r,!(s[n+a]!==h||s[n+a-1]!==p||s[n]!==s[i]||s[++n]!==s[i+1])){i+=2,n++;do;while(s[++i]===s[++n]&&s[++i]===s[++n]&&s[++i]===s[++n]&&s[++i]===s[++n]&&s[++i]===s[++n]&&s[++i]===s[++n]&&s[++i]===s[++n]&&s[++i]===s[++n]&&i<f);if(o=At-(f-i),i=f-At,o>a){if(t.match_start=r,a=o,o>=l)break;p=s[i+a-1],h=s[i+a]}}while((r=d[r&c])>u&&--e!==0);return a<=t.lookahead?a:t.lookahead},pr=t=>{const r=t.w_size;let e,i,n;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=r+(r-wt)&&(t.window.set(t.window.subarray(r,r+r-i),0),t.match_start-=r,t.strstart-=r,t.block_start-=r,t.insert>t.strstart&&(t.insert=t.strstart),mk(t),i+=r),t.strm.avail_in===0)break;if(e=Ro(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=e,t.lookahead+t.insert>=pe)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=Dt(t,t.ins_h,t.window[n+1]);t.insert&&(t.ins_h=Dt(t,t.ins_h,t.window[n+pe-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<pe)););}while(t.lookahead<wt&&t.strm.avail_in!==0)},Up=(t,r)=>{let e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,i,n,o,a=0,l=t.strm.avail_in;do{if(i=65535,o=t.bi_valid+42>>3,t.strm.avail_out<o||(o=t.strm.avail_out-o,n=t.strstart-t.block_start,i>n+t.strm.avail_in&&(i=n+t.strm.avail_in),i>o&&(i=o),i<e&&(i===0&&r!==ct||r===Ft||i!==n+t.strm.avail_in)))break;a=r===ct&&i===n+t.strm.avail_in?1:0,Co(t,0,0,a),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,nt(t.strm),n&&(n>i&&(n=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+n),t.strm.next_out),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n,t.block_start+=n,i-=n),i&&(Ro(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(a===0);return l-=t.strm.avail_in,l&&(l>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=l&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-l,t.strm.next_in),t.strstart),t.strstart+=l,t.insert+=l>t.w_size-t.insert?t.w_size-t.insert:l),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?gr:r!==Ft&&r!==ct&&t.strm.avail_in===0&&t.strstart===t.block_start?mr:(o=t.window_size-t.strstart,t.strm.avail_in>o&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,o+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),o>t.strm.avail_in&&(o=t.strm.avail_in),o&&(Ro(t.strm,t.window,t.strstart,o),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.high_water<t.strstart&&(t.high_water=t.strstart),o=t.bi_valid+42>>3,o=t.pending_buf_size-o>65535?65535:t.pending_buf_size-o,e=o>t.w_size?t.w_size:o,n=t.strstart-t.block_start,(n>=e||(n||r===ct)&&r!==Ft&&t.strm.avail_in===0&&n<=o)&&(i=n>o?o:n,a=r===ct&&t.strm.avail_in===0&&i===n?1:0,Co(t,t.block_start,i,a),t.block_start+=i,nt(t.strm)),a?er:Ye)},Qi=(t,r)=>{let e,i;for(;;){if(t.lookahead<wt){if(pr(t),t.lookahead<wt&&r===Ft)return Ye;if(t.lookahead===0)break}if(e=0,t.lookahead>=pe&&(t.ins_h=Dt(t,t.ins_h,t.window[t.strstart+pe-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),e!==0&&t.strstart-e<=t.w_size-wt&&(t.match_length=jp(t,e)),t.match_length>=pe)if(i=Ot(t,t.strstart-t.match_start,t.match_length-pe),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=pe){t.match_length--;do t.strstart++,t.ins_h=Dt(t,t.ins_h,t.window[t.strstart+pe-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Dt(t,t.ins_h,t.window[t.strstart+1]);else i=Ot(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(at(t,!1),t.strm.avail_out===0))return Ye}return t.insert=t.strstart<pe-1?t.strstart:pe-1,r===ct?(at(t,!0),t.strm.avail_out===0?er:gr):t.sym_next&&(at(t,!1),t.strm.avail_out===0)?Ye:mr},ar=(t,r)=>{let e,i,n;for(;;){if(t.lookahead<wt){if(pr(t),t.lookahead<wt&&r===Ft)return Ye;if(t.lookahead===0)break}if(e=0,t.lookahead>=pe&&(t.ins_h=Dt(t,t.ins_h,t.window[t.strstart+pe-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=pe-1,e!==0&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-wt&&(t.match_length=jp(t,e),t.match_length<=5&&(t.strategy===Qw||t.match_length===pe&&t.strstart-t.match_start>4096)&&(t.match_length=pe-1)),t.prev_length>=pe&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-pe,i=Ot(t,t.strstart-1-t.prev_match,t.prev_length-pe),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=n&&(t.ins_h=Dt(t,t.ins_h,t.window[t.strstart+pe-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=pe-1,t.strstart++,i&&(at(t,!1),t.strm.avail_out===0))return Ye}else if(t.match_available){if(i=Ot(t,0,t.window[t.strstart-1]),i&&at(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Ye}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Ot(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<pe-1?t.strstart:pe-1,r===ct?(at(t,!0),t.strm.avail_out===0?er:gr):t.sym_next&&(at(t,!1),t.strm.avail_out===0)?Ye:mr},yk=(t,r)=>{let e,i,n,o;const a=t.window;for(;;){if(t.lookahead<=At){if(pr(t),t.lookahead<=At&&r===Ft)return Ye;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=pe&&t.strstart>0&&(n=t.strstart-1,i=a[n],i===a[++n]&&i===a[++n]&&i===a[++n])){o=t.strstart+At;do;while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<o);t.match_length=At-(o-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=pe?(e=Ot(t,1,t.match_length-pe),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=Ot(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(at(t,!1),t.strm.avail_out===0))return Ye}return t.insert=0,r===ct?(at(t,!0),t.strm.avail_out===0?er:gr):t.sym_next&&(at(t,!1),t.strm.avail_out===0)?Ye:mr},bk=(t,r)=>{let e;for(;;){if(t.lookahead===0&&(pr(t),t.lookahead===0)){if(r===Ft)return Ye;break}if(t.match_length=0,e=Ot(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(at(t,!1),t.strm.avail_out===0))return Ye}return t.insert=0,r===ct?(at(t,!0),t.strm.avail_out===0?er:gr):t.sym_next&&(at(t,!1),t.strm.avail_out===0)?Ye:mr};function ht(t,r,e,i,n){this.good_length=t,this.max_lazy=r,this.nice_length=e,this.max_chain=i,this.func=n}const Nr=[new ht(0,0,0,0,Up),new ht(4,4,8,4,Qi),new ht(4,5,16,8,Qi),new ht(4,6,32,32,Qi),new ht(4,4,16,16,ar),new ht(8,16,32,32,ar),new ht(8,16,128,128,ar),new ht(8,32,128,256,ar),new ht(32,128,258,1024,ar),new ht(32,258,258,4096,ar)],vk=t=>{t.window_size=2*t.w_size,Nt(t.head),t.max_lazy_match=Nr[t.level].max_lazy,t.good_match=Nr[t.level].good_length,t.nice_match=Nr[t.level].nice_length,t.max_chain_length=Nr[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=pe-1,t.match_available=0,t.ins_h=0};function wk(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=On,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(dk*2),this.dyn_dtree=new Uint16Array((2*ck+1)*2),this.bl_tree=new Uint16Array((2*uk+1)*2),Nt(this.dyn_ltree),Nt(this.dyn_dtree),Nt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(pk+1),this.heap=new Uint16Array(2*Po+1),Nt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Po+1),Nt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Kr=t=>{if(!t)return 1;const r=t.state;return!r||r.strm!==t||r.status!==dr&&r.status!==sa&&r.status!==To&&r.status!==Eo&&r.status!==$o&&r.status!==Io&&r.status!==Xt&&r.status!==Rr?1:0},Bp=t=>{if(Kr(t))return Kt(t,vt);t.total_in=t.total_out=0,t.data_type=nk;const r=t.state;return r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap===2?sa:r.wrap?dr:Xt,t.adler=r.wrap===2?0:1,r.last_flush=-2,Ww(r),Ue},qp=t=>{const r=Bp(t);return r===Ue&&vk(t.state),r},kk=(t,r)=>Kr(t)||t.state.wrap!==2?vt:(t.state.gzhead=r,Ue),Vp=(t,r,e,i,n,o)=>{if(!t)return vt;let a=1;if(r===Jw&&(r=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),n<1||n>ik||e!==On||i<8||i>15||r<0||r>9||o<0||o>tk||i===8&&a!==1)return Kt(t,vt);i===8&&(i=9);const l=new wk;return t.state=l,l.strm=t,l.status=dr,l.wrap=a,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=n+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+pe-1)/pe),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<n+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=r,l.strategy=o,l.method=e,qp(t)},xk=(t,r)=>Vp(t,r,On,ok,ak,rk),_k=(t,r)=>{if(Kr(t)||r>wl||r<0)return t?Kt(t,vt):vt;const e=t.state;if(!t.output||t.avail_in!==0&&!t.input||e.status===Rr&&r!==ct)return Kt(t,t.avail_out===0?Ji:vt);const i=e.last_flush;if(e.last_flush=r,e.pending!==0){if(nt(t),t.avail_out===0)return e.last_flush=-1,Ue}else if(t.avail_in===0&&xl(r)<=xl(i)&&r!==ct)return Kt(t,Ji);if(e.status===Rr&&t.avail_in!==0)return Kt(t,Ji);if(e.status===dr&&e.wrap===0&&(e.status=Xt),e.status===dr){let n=On+(e.w_bits-8<<4)<<8,o=-1;if(e.strategy>=ln||e.level<2?o=0:e.level<6?o=1:e.level===6?o=2:o=3,n|=o<<6,e.strstart!==0&&(n|=fk),n+=31-n%31,Pr(e,n),e.strstart!==0&&(Pr(e,t.adler>>>16),Pr(e,t.adler&65535)),t.adler=1,e.status=Xt,nt(t),e.pending!==0)return e.last_flush=-1,Ue}if(e.status===sa){if(t.adler=0,me(e,31),me(e,139),me(e,8),e.gzhead)me(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),me(e,e.gzhead.time&255),me(e,e.gzhead.time>>8&255),me(e,e.gzhead.time>>16&255),me(e,e.gzhead.time>>24&255),me(e,e.level===9?2:e.strategy>=ln||e.level<2?4:0),me(e,e.gzhead.os&255),e.gzhead.extra&&e.gzhead.extra.length&&(me(e,e.gzhead.extra.length&255),me(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=ze(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=To;else if(me(e,0),me(e,0),me(e,0),me(e,0),me(e,0),me(e,e.level===9?2:e.strategy>=ln||e.level<2?4:0),me(e,hk),e.status=Xt,nt(t),e.pending!==0)return e.last_flush=-1,Ue}if(e.status===To){if(e.gzhead.extra){let n=e.pending,o=(e.gzhead.extra.length&65535)-e.gzindex;for(;e.pending+o>e.pending_buf_size;){let l=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+l),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>n&&(t.adler=ze(t.adler,e.pending_buf,e.pending-n,n)),e.gzindex+=l,nt(t),e.pending!==0)return e.last_flush=-1,Ue;n=0,o-=l}let a=new Uint8Array(e.gzhead.extra);e.pending_buf.set(a.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending+=o,e.gzhead.hcrc&&e.pending>n&&(t.adler=ze(t.adler,e.pending_buf,e.pending-n,n)),e.gzindex=0}e.status=Eo}if(e.status===Eo){if(e.gzhead.name){let n=e.pending,o;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>n&&(t.adler=ze(t.adler,e.pending_buf,e.pending-n,n)),nt(t),e.pending!==0)return e.last_flush=-1,Ue;n=0}e.gzindex<e.gzhead.name.length?o=e.gzhead.name.charCodeAt(e.gzindex++)&255:o=0,me(e,o)}while(o!==0);e.gzhead.hcrc&&e.pending>n&&(t.adler=ze(t.adler,e.pending_buf,e.pending-n,n)),e.gzindex=0}e.status=$o}if(e.status===$o){if(e.gzhead.comment){let n=e.pending,o;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>n&&(t.adler=ze(t.adler,e.pending_buf,e.pending-n,n)),nt(t),e.pending!==0)return e.last_flush=-1,Ue;n=0}e.gzindex<e.gzhead.comment.length?o=e.gzhead.comment.charCodeAt(e.gzindex++)&255:o=0,me(e,o)}while(o!==0);e.gzhead.hcrc&&e.pending>n&&(t.adler=ze(t.adler,e.pending_buf,e.pending-n,n))}e.status=Io}if(e.status===Io){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(nt(t),e.pending!==0))return e.last_flush=-1,Ue;me(e,t.adler&255),me(e,t.adler>>8&255),t.adler=0}if(e.status=Xt,nt(t),e.pending!==0)return e.last_flush=-1,Ue}if(t.avail_in!==0||e.lookahead!==0||r!==Ft&&e.status!==Rr){let n=e.level===0?Up(e,r):e.strategy===ln?bk(e,r):e.strategy===ek?yk(e,r):Nr[e.level].func(e,r);if((n===er||n===gr)&&(e.status=Rr),n===Ye||n===er)return t.avail_out===0&&(e.last_flush=-1),Ue;if(n===mr&&(r===Yw?Zw(e):r!==wl&&(Co(e,0,0,!1),r===Xw&&(Nt(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),nt(t),t.avail_out===0))return e.last_flush=-1,Ue}return r!==ct?Ue:e.wrap<=0?kl:(e.wrap===2?(me(e,t.adler&255),me(e,t.adler>>8&255),me(e,t.adler>>16&255),me(e,t.adler>>24&255),me(e,t.total_in&255),me(e,t.total_in>>8&255),me(e,t.total_in>>16&255),me(e,t.total_in>>24&255)):(Pr(e,t.adler>>>16),Pr(e,t.adler&65535)),nt(t),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?Ue:kl)},Sk=t=>{if(Kr(t))return vt;const r=t.state.status;return t.state=null,r===Xt?Kt(t,Kw):Ue},Ck=(t,r)=>{let e=r.length;if(Kr(t))return vt;const i=t.state,n=i.wrap;if(n===2||n===1&&i.status!==dr||i.lookahead)return vt;if(n===1&&(t.adler=Gr(t.adler,r,e,0)),i.wrap=0,e>=i.w_size){n===0&&(Nt(i.head),i.strstart=0,i.block_start=0,i.insert=0);let u=new Uint8Array(i.w_size);u.set(r.subarray(e-i.w_size,e),0),r=u,e=i.w_size}const o=t.avail_in,a=t.next_in,l=t.input;for(t.avail_in=e,t.next_in=0,t.input=r,pr(i);i.lookahead>=pe;){let u=i.strstart,s=i.lookahead-(pe-1);do i.ins_h=Dt(i,i.ins_h,i.window[u+pe-1]),i.prev[u&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=u,u++;while(--s);i.strstart=u,i.lookahead=pe-1,pr(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=pe-1,i.match_available=0,t.next_in=a,t.input=l,t.avail_in=o,i.wrap=n,Ue};var Pk=xk,Tk=Vp,Ek=qp,$k=Bp,Ik=kk,Rk=_k,Nk=Sk,Ak=Ck,Mk="pako deflate (from Nodeca project)",Fr={deflateInit:Pk,deflateInit2:Tk,deflateReset:Ek,deflateResetKeep:$k,deflateSetHeader:Ik,deflate:Rk,deflateEnd:Nk,deflateSetDictionary:Ak,deflateInfo:Mk};const Ok=(t,r)=>Object.prototype.hasOwnProperty.call(t,r);var Fk=function(t){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const e=r.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const i in e)Ok(e,i)&&(t[i]=e[i])}}return t},Dk=t=>{let r=0;for(let i=0,n=t.length;i<n;i++)r+=t[i].length;const e=new Uint8Array(r);for(let i=0,n=0,o=t.length;i<o;i++){let a=t[i];e.set(a,n),n+=a.length}return e},Fn={assign:Fk,flattenChunks:Dk};let Gp=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Gp=!1}const Wr=new Uint8Array(256);for(let t=0;t<256;t++)Wr[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Wr[254]=Wr[254]=1;var zk=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let r,e,i,n,o,a=t.length,l=0;for(n=0;n<a;n++)e=t.charCodeAt(n),(e&64512)===55296&&n+1<a&&(i=t.charCodeAt(n+1),(i&64512)===56320&&(e=65536+(e-55296<<10)+(i-56320),n++)),l+=e<128?1:e<2048?2:e<65536?3:4;for(r=new Uint8Array(l),o=0,n=0;o<l;n++)e=t.charCodeAt(n),(e&64512)===55296&&n+1<a&&(i=t.charCodeAt(n+1),(i&64512)===56320&&(e=65536+(e-55296<<10)+(i-56320),n++)),e<128?r[o++]=e:e<2048?(r[o++]=192|e>>>6,r[o++]=128|e&63):e<65536?(r[o++]=224|e>>>12,r[o++]=128|e>>>6&63,r[o++]=128|e&63):(r[o++]=240|e>>>18,r[o++]=128|e>>>12&63,r[o++]=128|e>>>6&63,r[o++]=128|e&63);return r};const Lk=(t,r)=>{if(r<65534&&t.subarray&&Gp)return String.fromCharCode.apply(null,t.length===r?t:t.subarray(0,r));let e="";for(let i=0;i<r;i++)e+=String.fromCharCode(t[i]);return e};var jk=(t,r)=>{const e=r||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,r));let i,n;const o=new Array(e*2);for(n=0,i=0;i<e;){let a=t[i++];if(a<128){o[n++]=a;continue}let l=Wr[a];if(l>4){o[n++]=65533,i+=l-1;continue}for(a&=l===2?31:l===3?15:7;l>1&&i<e;)a=a<<6|t[i++]&63,l--;if(l>1){o[n++]=65533;continue}a<65536?o[n++]=a:(a-=65536,o[n++]=55296|a>>10&1023,o[n++]=56320|a&1023)}return Lk(o,n)},Uk=(t,r)=>{r=r||t.length,r>t.length&&(r=t.length);let e=r-1;for(;e>=0&&(t[e]&192)===128;)e--;return e<0||e===0?r:e+Wr[t[e]]>r?e:r},Hr={string2buf:zk,buf2string:jk,utf8border:Uk};function Bk(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Wp=Bk;const Hp=Object.prototype.toString,{Z_NO_FLUSH:qk,Z_SYNC_FLUSH:Vk,Z_FULL_FLUSH:Gk,Z_FINISH:Wk,Z_OK:In,Z_STREAM_END:Hk,Z_DEFAULT_COMPRESSION:Zk,Z_DEFAULT_STRATEGY:Yk,Z_DEFLATED:Xk}=hr;function Jr(t){this.options=Fn.assign({level:Zk,method:Xk,chunkSize:16384,windowBits:15,memLevel:8,strategy:Yk},t||{});let r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Wp,this.strm.avail_out=0;let e=Fr.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(e!==In)throw new Error(Qt[e]);if(r.header&&Fr.deflateSetHeader(this.strm,r.header),r.dictionary){let i;if(typeof r.dictionary=="string"?i=Hr.string2buf(r.dictionary):Hp.call(r.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(r.dictionary):i=r.dictionary,e=Fr.deflateSetDictionary(this.strm,i),e!==In)throw new Error(Qt[e]);this._dict_set=!0}}Jr.prototype.push=function(t,r){const e=this.strm,i=this.options.chunkSize;let n,o;if(this.ended)return!1;for(r===~~r?o=r:o=r===!0?Wk:qk,typeof t=="string"?e.input=Hr.string2buf(t):Hp.call(t)==="[object ArrayBuffer]"?e.input=new Uint8Array(t):e.input=t,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(o===Vk||o===Gk)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(n=Fr.deflate(e,o),n===Hk)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),n=Fr.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===In;if(e.avail_out===0){this.onData(e.output);continue}if(o>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0};Jr.prototype.onData=function(t){this.chunks.push(t)};Jr.prototype.onEnd=function(t){t===In&&(this.result=Fn.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function la(t,r){const e=new Jr(r);if(e.push(t,!0),e.err)throw e.msg||Qt[e.err];return e.result}function Kk(t,r){return r=r||{},r.raw=!0,la(t,r)}function Jk(t,r){return r=r||{},r.gzip=!0,la(t,r)}var Qk=Jr,ex=la,tx=Kk,rx=Jk,nx=hr,ix={Deflate:Qk,deflate:ex,deflateRaw:tx,gzip:rx,constants:nx};const cn=16209,ox=16191;var ax=function(r,e){let i,n,o,a,l,u,s,c,d,f,p,h,g,m,b,y,w,v,k,_,C,S,P,T;const x=r.state;i=r.next_in,P=r.input,n=i+(r.avail_in-5),o=r.next_out,T=r.output,a=o-(e-r.avail_out),l=o+(r.avail_out-257),u=x.dmax,s=x.wsize,c=x.whave,d=x.wnext,f=x.window,p=x.hold,h=x.bits,g=x.lencode,m=x.distcode,b=(1<<x.lenbits)-1,y=(1<<x.distbits)-1;e:do{h<15&&(p+=P[i++]<<h,h+=8,p+=P[i++]<<h,h+=8),w=g[p&b];t:for(;;){if(v=w>>>24,p>>>=v,h-=v,v=w>>>16&255,v===0)T[o++]=w&65535;else if(v&16){k=w&65535,v&=15,v&&(h<v&&(p+=P[i++]<<h,h+=8),k+=p&(1<<v)-1,p>>>=v,h-=v),h<15&&(p+=P[i++]<<h,h+=8,p+=P[i++]<<h,h+=8),w=m[p&y];r:for(;;){if(v=w>>>24,p>>>=v,h-=v,v=w>>>16&255,v&16){if(_=w&65535,v&=15,h<v&&(p+=P[i++]<<h,h+=8,h<v&&(p+=P[i++]<<h,h+=8)),_+=p&(1<<v)-1,_>u){r.msg="invalid distance too far back",x.mode=cn;break e}if(p>>>=v,h-=v,v=o-a,_>v){if(v=_-v,v>c&&x.sane){r.msg="invalid distance too far back",x.mode=cn;break e}if(C=0,S=f,d===0){if(C+=s-v,v<k){k-=v;do T[o++]=f[C++];while(--v);C=o-_,S=T}}else if(d<v){if(C+=s+d-v,v-=d,v<k){k-=v;do T[o++]=f[C++];while(--v);if(C=0,d<k){v=d,k-=v;do T[o++]=f[C++];while(--v);C=o-_,S=T}}}else if(C+=d-v,v<k){k-=v;do T[o++]=f[C++];while(--v);C=o-_,S=T}for(;k>2;)T[o++]=S[C++],T[o++]=S[C++],T[o++]=S[C++],k-=3;k&&(T[o++]=S[C++],k>1&&(T[o++]=S[C++]))}else{C=o-_;do T[o++]=T[C++],T[o++]=T[C++],T[o++]=T[C++],k-=3;while(k>2);k&&(T[o++]=T[C++],k>1&&(T[o++]=T[C++]))}}else if(v&64){r.msg="invalid distance code",x.mode=cn;break e}else{w=m[(w&65535)+(p&(1<<v)-1)];continue r}break}}else if(v&64)if(v&32){x.mode=ox;break e}else{r.msg="invalid literal/length code",x.mode=cn;break e}else{w=g[(w&65535)+(p&(1<<v)-1)];continue t}break}}while(i<n&&o<l);k=h>>3,i-=k,h-=k<<3,p&=(1<<h)-1,r.next_in=i,r.next_out=o,r.avail_in=i<n?5+(n-i):5-(i-n),r.avail_out=o<l?257+(l-o):257-(o-l),x.hold=p,x.bits=h};const sr=15,_l=852,Sl=592,Cl=0,eo=1,Pl=2,sx=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lx=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),cx=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ux=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),dx=(t,r,e,i,n,o,a,l)=>{const u=l.bits;let s=0,c=0,d=0,f=0,p=0,h=0,g=0,m=0,b=0,y=0,w,v,k,_,C,S=null,P;const T=new Uint16Array(sr+1),x=new Uint16Array(sr+1);let $=null,O,N,A;for(s=0;s<=sr;s++)T[s]=0;for(c=0;c<i;c++)T[r[e+c]]++;for(p=u,f=sr;f>=1&&T[f]===0;f--);if(p>f&&(p=f),f===0)return n[o++]=1<<24|64<<16|0,n[o++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<f&&T[d]===0;d++);for(p<d&&(p=d),m=1,s=1;s<=sr;s++)if(m<<=1,m-=T[s],m<0)return-1;if(m>0&&(t===Cl||f!==1))return-1;for(x[1]=0,s=1;s<sr;s++)x[s+1]=x[s]+T[s];for(c=0;c<i;c++)r[e+c]!==0&&(a[x[r[e+c]]++]=c);if(t===Cl?(S=$=a,P=20):t===eo?(S=sx,$=lx,P=257):(S=cx,$=ux,P=0),y=0,c=0,s=d,C=o,h=p,g=0,k=-1,b=1<<p,_=b-1,t===eo&&b>_l||t===Pl&&b>Sl)return 1;for(;;){O=s-g,a[c]+1<P?(N=0,A=a[c]):a[c]>=P?(N=$[a[c]-P],A=S[a[c]-P]):(N=96,A=0),w=1<<s-g,v=1<<h,d=v;do v-=w,n[C+(y>>g)+v]=O<<24|N<<16|A|0;while(v!==0);for(w=1<<s-1;y&w;)w>>=1;if(w!==0?(y&=w-1,y+=w):y=0,c++,--T[s]===0){if(s===f)break;s=r[e+a[c]]}if(s>p&&(y&_)!==k){for(g===0&&(g=p),C+=d,h=s-g,m=1<<h;h+g<f&&(m-=T[h+g],!(m<=0));)h++,m<<=1;if(b+=1<<h,t===eo&&b>_l||t===Pl&&b>Sl)return 1;k=y&_,n[k]=p<<24|h<<16|C-o|0}}return y!==0&&(n[C+y]=s-g<<24|64<<16|0),l.bits=p,0};var Dr=dx;const px=0,Zp=1,Yp=2,{Z_FINISH:Tl,Z_BLOCK:fx,Z_TREES:un,Z_OK:tr,Z_STREAM_END:hx,Z_NEED_DICT:mx,Z_STREAM_ERROR:dt,Z_DATA_ERROR:Xp,Z_MEM_ERROR:Kp,Z_BUF_ERROR:gx,Z_DEFLATED:El}=hr,Dn=16180,$l=16181,Il=16182,Rl=16183,Nl=16184,Al=16185,Ml=16186,Ol=16187,Fl=16188,Dl=16189,Rn=16190,Pt=16191,to=16192,zl=16193,ro=16194,Ll=16195,jl=16196,Ul=16197,Bl=16198,dn=16199,pn=16200,ql=16201,Vl=16202,Gl=16203,Wl=16204,Hl=16205,no=16206,Zl=16207,Yl=16208,Pe=16209,Jp=16210,Qp=16211,yx=852,bx=592,vx=15,wx=vx,Xl=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function kx(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const or=t=>{if(!t)return 1;const r=t.state;return!r||r.strm!==t||r.mode<Dn||r.mode>Qp?1:0},ef=t=>{if(or(t))return dt;const r=t.state;return t.total_in=t.total_out=r.total=0,t.msg="",r.wrap&&(t.adler=r.wrap&1),r.mode=Dn,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(yx),r.distcode=r.distdyn=new Int32Array(bx),r.sane=1,r.back=-1,tr},tf=t=>{if(or(t))return dt;const r=t.state;return r.wsize=0,r.whave=0,r.wnext=0,ef(t)},rf=(t,r)=>{let e;if(or(t))return dt;const i=t.state;return r<0?(e=0,r=-r):(e=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?dt:(i.window!==null&&i.wbits!==r&&(i.window=null),i.wrap=e,i.wbits=r,tf(t))},nf=(t,r)=>{if(!t)return dt;const e=new kx;t.state=e,e.strm=t,e.window=null,e.mode=Dn;const i=rf(t,r);return i!==tr&&(t.state=null),i},xx=t=>nf(t,wx);let Kl=!0,io,oo;const _x=t=>{if(Kl){io=new Int32Array(512),oo=new Int32Array(32);let r=0;for(;r<144;)t.lens[r++]=8;for(;r<256;)t.lens[r++]=9;for(;r<280;)t.lens[r++]=7;for(;r<288;)t.lens[r++]=8;for(Dr(Zp,t.lens,0,288,io,0,t.work,{bits:9}),r=0;r<32;)t.lens[r++]=5;Dr(Yp,t.lens,0,32,oo,0,t.work,{bits:5}),Kl=!1}t.lencode=io,t.lenbits=9,t.distcode=oo,t.distbits=5},of=(t,r,e,i)=>{let n;const o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(r.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(n=o.wsize-o.wnext,n>i&&(n=i),o.window.set(r.subarray(e-i,e-i+n),o.wnext),i-=n,i?(o.window.set(r.subarray(e-i,e),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=n,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=n))),0},Sx=(t,r)=>{let e,i,n,o,a,l,u,s,c,d,f,p,h,g,m=0,b,y,w,v,k,_,C,S;const P=new Uint8Array(4);let T,x;const $=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(or(t)||!t.output||!t.input&&t.avail_in!==0)return dt;e=t.state,e.mode===Pt&&(e.mode=to),a=t.next_out,n=t.output,u=t.avail_out,o=t.next_in,i=t.input,l=t.avail_in,s=e.hold,c=e.bits,d=l,f=u,S=tr;e:for(;;)switch(e.mode){case Dn:if(e.wrap===0){e.mode=to;break}for(;c<16;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if(e.wrap&2&&s===35615){e.wbits===0&&(e.wbits=15),e.check=0,P[0]=s&255,P[1]=s>>>8&255,e.check=ze(e.check,P,2,0),s=0,c=0,e.mode=$l;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((s&255)<<8)+(s>>8))%31){t.msg="incorrect header check",e.mode=Pe;break}if((s&15)!==El){t.msg="unknown compression method",e.mode=Pe;break}if(s>>>=4,c-=4,C=(s&15)+8,e.wbits===0&&(e.wbits=C),C>15||C>e.wbits){t.msg="invalid window size",e.mode=Pe;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=s&512?Dl:Pt,s=0,c=0;break;case $l:for(;c<16;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if(e.flags=s,(e.flags&255)!==El){t.msg="unknown compression method",e.mode=Pe;break}if(e.flags&57344){t.msg="unknown header flags set",e.mode=Pe;break}e.head&&(e.head.text=s>>8&1),e.flags&512&&e.wrap&4&&(P[0]=s&255,P[1]=s>>>8&255,e.check=ze(e.check,P,2,0)),s=0,c=0,e.mode=Il;case Il:for(;c<32;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}e.head&&(e.head.time=s),e.flags&512&&e.wrap&4&&(P[0]=s&255,P[1]=s>>>8&255,P[2]=s>>>16&255,P[3]=s>>>24&255,e.check=ze(e.check,P,4,0)),s=0,c=0,e.mode=Rl;case Rl:for(;c<16;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}e.head&&(e.head.xflags=s&255,e.head.os=s>>8),e.flags&512&&e.wrap&4&&(P[0]=s&255,P[1]=s>>>8&255,e.check=ze(e.check,P,2,0)),s=0,c=0,e.mode=Nl;case Nl:if(e.flags&1024){for(;c<16;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}e.length=s,e.head&&(e.head.extra_len=s),e.flags&512&&e.wrap&4&&(P[0]=s&255,P[1]=s>>>8&255,e.check=ze(e.check,P,2,0)),s=0,c=0}else e.head&&(e.head.extra=null);e.mode=Al;case Al:if(e.flags&1024&&(p=e.length,p>l&&(p=l),p&&(e.head&&(C=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(o,o+p),C)),e.flags&512&&e.wrap&4&&(e.check=ze(e.check,i,p,o)),l-=p,o+=p,e.length-=p),e.length))break e;e.length=0,e.mode=Ml;case Ml:if(e.flags&2048){if(l===0)break e;p=0;do C=i[o+p++],e.head&&C&&e.length<65536&&(e.head.name+=String.fromCharCode(C));while(C&&p<l);if(e.flags&512&&e.wrap&4&&(e.check=ze(e.check,i,p,o)),l-=p,o+=p,C)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=Ol;case Ol:if(e.flags&4096){if(l===0)break e;p=0;do C=i[o+p++],e.head&&C&&e.length<65536&&(e.head.comment+=String.fromCharCode(C));while(C&&p<l);if(e.flags&512&&e.wrap&4&&(e.check=ze(e.check,i,p,o)),l-=p,o+=p,C)break e}else e.head&&(e.head.comment=null);e.mode=Fl;case Fl:if(e.flags&512){for(;c<16;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if(e.wrap&4&&s!==(e.check&65535)){t.msg="header crc mismatch",e.mode=Pe;break}s=0,c=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=Pt;break;case Dl:for(;c<32;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}t.adler=e.check=Xl(s),s=0,c=0,e.mode=Rn;case Rn:if(e.havedict===0)return t.next_out=a,t.avail_out=u,t.next_in=o,t.avail_in=l,e.hold=s,e.bits=c,mx;t.adler=e.check=1,e.mode=Pt;case Pt:if(r===fx||r===un)break e;case to:if(e.last){s>>>=c&7,c-=c&7,e.mode=no;break}for(;c<3;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}switch(e.last=s&1,s>>>=1,c-=1,s&3){case 0:e.mode=zl;break;case 1:if(_x(e),e.mode=dn,r===un){s>>>=2,c-=2;break e}break;case 2:e.mode=jl;break;case 3:t.msg="invalid block type",e.mode=Pe}s>>>=2,c-=2;break;case zl:for(s>>>=c&7,c-=c&7;c<32;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if((s&65535)!==(s>>>16^65535)){t.msg="invalid stored block lengths",e.mode=Pe;break}if(e.length=s&65535,s=0,c=0,e.mode=ro,r===un)break e;case ro:e.mode=Ll;case Ll:if(p=e.length,p){if(p>l&&(p=l),p>u&&(p=u),p===0)break e;n.set(i.subarray(o,o+p),a),l-=p,o+=p,u-=p,a+=p,e.length-=p;break}e.mode=Pt;break;case jl:for(;c<14;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if(e.nlen=(s&31)+257,s>>>=5,c-=5,e.ndist=(s&31)+1,s>>>=5,c-=5,e.ncode=(s&15)+4,s>>>=4,c-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=Pe;break}e.have=0,e.mode=Ul;case Ul:for(;e.have<e.ncode;){for(;c<3;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}e.lens[$[e.have++]]=s&7,s>>>=3,c-=3}for(;e.have<19;)e.lens[$[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,T={bits:e.lenbits},S=Dr(px,e.lens,0,19,e.lencode,0,e.work,T),e.lenbits=T.bits,S){t.msg="invalid code lengths set",e.mode=Pe;break}e.have=0,e.mode=Bl;case Bl:for(;e.have<e.nlen+e.ndist;){for(;m=e.lencode[s&(1<<e.lenbits)-1],b=m>>>24,y=m>>>16&255,w=m&65535,!(b<=c);){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if(w<16)s>>>=b,c-=b,e.lens[e.have++]=w;else{if(w===16){for(x=b+2;c<x;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if(s>>>=b,c-=b,e.have===0){t.msg="invalid bit length repeat",e.mode=Pe;break}C=e.lens[e.have-1],p=3+(s&3),s>>>=2,c-=2}else if(w===17){for(x=b+3;c<x;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}s>>>=b,c-=b,C=0,p=3+(s&7),s>>>=3,c-=3}else{for(x=b+7;c<x;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}s>>>=b,c-=b,C=0,p=11+(s&127),s>>>=7,c-=7}if(e.have+p>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=Pe;break}for(;p--;)e.lens[e.have++]=C}}if(e.mode===Pe)break;if(e.lens[256]===0){t.msg="invalid code -- missing end-of-block",e.mode=Pe;break}if(e.lenbits=9,T={bits:e.lenbits},S=Dr(Zp,e.lens,0,e.nlen,e.lencode,0,e.work,T),e.lenbits=T.bits,S){t.msg="invalid literal/lengths set",e.mode=Pe;break}if(e.distbits=6,e.distcode=e.distdyn,T={bits:e.distbits},S=Dr(Yp,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,T),e.distbits=T.bits,S){t.msg="invalid distances set",e.mode=Pe;break}if(e.mode=dn,r===un)break e;case dn:e.mode=pn;case pn:if(l>=6&&u>=258){t.next_out=a,t.avail_out=u,t.next_in=o,t.avail_in=l,e.hold=s,e.bits=c,ax(t,f),a=t.next_out,n=t.output,u=t.avail_out,o=t.next_in,i=t.input,l=t.avail_in,s=e.hold,c=e.bits,e.mode===Pt&&(e.back=-1);break}for(e.back=0;m=e.lencode[s&(1<<e.lenbits)-1],b=m>>>24,y=m>>>16&255,w=m&65535,!(b<=c);){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if(y&&!(y&240)){for(v=b,k=y,_=w;m=e.lencode[_+((s&(1<<v+k)-1)>>v)],b=m>>>24,y=m>>>16&255,w=m&65535,!(v+b<=c);){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}s>>>=v,c-=v,e.back+=v}if(s>>>=b,c-=b,e.back+=b,e.length=w,y===0){e.mode=Hl;break}if(y&32){e.back=-1,e.mode=Pt;break}if(y&64){t.msg="invalid literal/length code",e.mode=Pe;break}e.extra=y&15,e.mode=ql;case ql:if(e.extra){for(x=e.extra;c<x;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}e.length+=s&(1<<e.extra)-1,s>>>=e.extra,c-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=Vl;case Vl:for(;m=e.distcode[s&(1<<e.distbits)-1],b=m>>>24,y=m>>>16&255,w=m&65535,!(b<=c);){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if(!(y&240)){for(v=b,k=y,_=w;m=e.distcode[_+((s&(1<<v+k)-1)>>v)],b=m>>>24,y=m>>>16&255,w=m&65535,!(v+b<=c);){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}s>>>=v,c-=v,e.back+=v}if(s>>>=b,c-=b,e.back+=b,y&64){t.msg="invalid distance code",e.mode=Pe;break}e.offset=w,e.extra=y&15,e.mode=Gl;case Gl:if(e.extra){for(x=e.extra;c<x;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}e.offset+=s&(1<<e.extra)-1,s>>>=e.extra,c-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=Pe;break}e.mode=Wl;case Wl:if(u===0)break e;if(p=f-u,e.offset>p){if(p=e.offset-p,p>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=Pe;break}p>e.wnext?(p-=e.wnext,h=e.wsize-p):h=e.wnext-p,p>e.length&&(p=e.length),g=e.window}else g=n,h=a-e.offset,p=e.length;p>u&&(p=u),u-=p,e.length-=p;do n[a++]=g[h++];while(--p);e.length===0&&(e.mode=pn);break;case Hl:if(u===0)break e;n[a++]=e.length,u--,e.mode=pn;break;case no:if(e.wrap){for(;c<32;){if(l===0)break e;l--,s|=i[o++]<<c,c+=8}if(f-=u,t.total_out+=f,e.total+=f,e.wrap&4&&f&&(t.adler=e.check=e.flags?ze(e.check,n,f,a-f):Gr(e.check,n,f,a-f)),f=u,e.wrap&4&&(e.flags?s:Xl(s))!==e.check){t.msg="incorrect data check",e.mode=Pe;break}s=0,c=0}e.mode=Zl;case Zl:if(e.wrap&&e.flags){for(;c<32;){if(l===0)break e;l--,s+=i[o++]<<c,c+=8}if(e.wrap&4&&s!==(e.total&4294967295)){t.msg="incorrect length check",e.mode=Pe;break}s=0,c=0}e.mode=Yl;case Yl:S=hx;break e;case Pe:S=Xp;break e;case Jp:return Kp;case Qp:default:return dt}return t.next_out=a,t.avail_out=u,t.next_in=o,t.avail_in=l,e.hold=s,e.bits=c,(e.wsize||f!==t.avail_out&&e.mode<Pe&&(e.mode<no||r!==Tl))&&of(t,t.output,t.next_out,f-t.avail_out),d-=t.avail_in,f-=t.avail_out,t.total_in+=d,t.total_out+=f,e.total+=f,e.wrap&4&&f&&(t.adler=e.check=e.flags?ze(e.check,n,f,t.next_out-f):Gr(e.check,n,f,t.next_out-f)),t.data_type=e.bits+(e.last?64:0)+(e.mode===Pt?128:0)+(e.mode===dn||e.mode===ro?256:0),(d===0&&f===0||r===Tl)&&S===tr&&(S=gx),S},Cx=t=>{if(or(t))return dt;let r=t.state;return r.window&&(r.window=null),t.state=null,tr},Px=(t,r)=>{if(or(t))return dt;const e=t.state;return e.wrap&2?(e.head=r,r.done=!1,tr):dt},Tx=(t,r)=>{const e=r.length;let i,n,o;return or(t)||(i=t.state,i.wrap!==0&&i.mode!==Rn)?dt:i.mode===Rn&&(n=1,n=Gr(n,r,e,0),n!==i.check)?Xp:(o=of(t,r,e,e),o?(i.mode=Jp,Kp):(i.havedict=1,tr))};var Ex=tf,$x=rf,Ix=ef,Rx=xx,Nx=nf,Ax=Sx,Mx=Cx,Ox=Px,Fx=Tx,Dx="pako inflate (from Nodeca project)",Et={inflateReset:Ex,inflateReset2:$x,inflateResetKeep:Ix,inflateInit:Rx,inflateInit2:Nx,inflate:Ax,inflateEnd:Mx,inflateGetHeader:Ox,inflateSetDictionary:Fx,inflateInfo:Dx};function zx(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Lx=zx;const af=Object.prototype.toString,{Z_NO_FLUSH:jx,Z_FINISH:Ux,Z_OK:Zr,Z_STREAM_END:ao,Z_NEED_DICT:so,Z_STREAM_ERROR:Bx,Z_DATA_ERROR:Jl,Z_MEM_ERROR:qx}=hr;function Qr(t){this.options=Fn.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(t&&t.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15||(r.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Wp,this.strm.avail_out=0;let e=Et.inflateInit2(this.strm,r.windowBits);if(e!==Zr)throw new Error(Qt[e]);if(this.header=new Lx,Et.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=Hr.string2buf(r.dictionary):af.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(e=Et.inflateSetDictionary(this.strm,r.dictionary),e!==Zr)))throw new Error(Qt[e])}Qr.prototype.push=function(t,r){const e=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let o,a,l;if(this.ended)return!1;for(r===~~r?a=r:a=r===!0?Ux:jx,af.call(t)==="[object ArrayBuffer]"?e.input=new Uint8Array(t):e.input=t,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),o=Et.inflate(e,a),o===so&&n&&(o=Et.inflateSetDictionary(e,n),o===Zr?o=Et.inflate(e,a):o===Jl&&(o=so));e.avail_in>0&&o===ao&&e.state.wrap>0&&t[e.next_in]!==0;)Et.inflateReset(e),o=Et.inflate(e,a);switch(o){case Bx:case Jl:case so:case qx:return this.onEnd(o),this.ended=!0,!1}if(l=e.avail_out,e.next_out&&(e.avail_out===0||o===ao))if(this.options.to==="string"){let u=Hr.utf8border(e.output,e.next_out),s=e.next_out-u,c=Hr.buf2string(e.output,u);e.next_out=s,e.avail_out=i-s,s&&e.output.set(e.output.subarray(u,u+s),0),this.onData(c)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(o===Zr&&l===0)){if(o===ao)return o=Et.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};Qr.prototype.onData=function(t){this.chunks.push(t)};Qr.prototype.onEnd=function(t){t===Zr&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Fn.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function ca(t,r){const e=new Qr(r);if(e.push(t),e.err)throw e.msg||Qt[e.err];return e.result}function Vx(t,r){return r=r||{},r.raw=!0,ca(t,r)}var Gx=Qr,Wx=ca,Hx=Vx,Zx=ca,Yx=hr,Xx={Inflate:Gx,inflate:Wx,inflateRaw:Hx,ungzip:Zx,constants:Yx};const{Deflate:L_,deflate:j_,deflateRaw:U_,gzip:Kx}=ix,{Inflate:B_,inflate:q_,inflateRaw:V_,ungzip:Jx}=Xx;var Qx=Kx,e_=Jx,t_=Y('<label class="input input-sm">Scale:<input type=text>'),r_=Y('<div><div><div></div><div><canvas></canvas><div><label class="input input-sm">Max Iter:<input type=text></label><label class="input input-sm">Tol:<input type=text></label><label class="input input-sm">MxStp:<input type=text>'),n_=Y("<li><a>Export To Clipboard"),i_=Y("<li><a>Import From Clipboard"),o_=Y("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Show Code"),a_=Y('<select class="select select-sm"style=width:fit-content;>'),s_=Y("<option>"),l_=Y("<div><pre>");const sf=50,c_=t=>{let[r,e]=Oo(t,["world"]);const i=["Orthogonal","Perspective"];let[n,o]=je({windowWidth:window.innerWidth,windowHeight:window.innerHeight,showCode:!1,projection:"Perspective",orthoScaleText:"0.1",maxIterationsText:"20",tolleranceText:"10.0",maxStepText:"20000.0"}),a=new gw({initSpace:qe.create(X.create(0,0,1e4),we.identity),initOrbitTarget:X.zero}),[l,u]=oe(),s=E(()=>{let x=Number.parseFloat(n.orthoScaleText);return Number.isNaN(x)?.1:x}),c=E(()=>{let x=Number.parseInt(n.maxIterationsText);return Number.isNaN(x)?100:x}),d=E(()=>{let x=Number.parseFloat(n.tolleranceText);return Number.isNaN(x)?.01:x}),f=E(()=>{let x=Number.parseFloat(n.maxStepText);return Number.isNaN(x)?1e4:x});window.addEventListener("resize",()=>{Be(()=>{o("windowWidth",window.innerWidth),o("windowHeight",window.innerHeight)})});let p=E(()=>n.windowWidth>n.windowHeight),[h,g]=oe(),m=E(()=>{let x=h();if(x!=null)return hw({nodesSystem:x,maxIterations:c()})}),[b,y]=oe(),[w,v]=oe(),[k,_]=oe();Re(he([b,w],([x,$])=>{if(x==null||$==null)return;let O=x.getBoundingClientRect();$.width=O.width*window.devicePixelRatio,$.height=O.height*window.devicePixelRatio,$.style.setProperty("background-color","darkblue");let N=$.getContext("webgl");N!=null&&_(N)}));let C,S;{let x=!1;S=()=>{let $=k();if($==null||C==null)return;let O=C;x||(x=!0,requestAnimationFrame(()=>{x=!1,$.bindBuffer($.ARRAY_BUFFER,O.verticesGLBuffer),$.enableVertexAttribArray(O.positionLocation),$.drawArrays($.TRIANGLES,0,6),$.disableVertexAttribArray(O.positionLocation)}))}}Re(he([k,w],([x,$])=>{if(x==null||$==null)return;let O=m();O!=null&&(C=d_(x,$,a,O))})),Re(he([k,m],([x,$])=>{if(h()==null)return;let N=w();if(N==null)return;let A=N.width,L=N.height;const V=.5*L/Math.tan(.5*sf*Math.PI/180);if(C==null||x==null||$==null)return;let Z=No(x,x.FRAGMENT_SHADER,ut.toString($.code));if(Z==null)return;if(x.detachShader(C.shaderProgram,C.fragmentShader),x.deleteShader(C.fragmentShader),C.fragmentShader=Z,x.attachShader(C.shaderProgram,C.fragmentShader),x.linkProgram(C.shaderProgram),!x.getProgramParameter(C.shaderProgram,x.LINK_STATUS)){console.error("ERROR linking program:",x.getProgramInfoLog(C.shaderProgram));return}let G=C.shaderProgram;x.useProgram(G);const J=x.getAttribLocation(G,"aVertexPosition"),ue=x.getUniformLocation(G,"uTollerance"),de=x.getUniformLocation(G,"uMaxStep"),R=x.getUniformLocation(G,"uFocalLength"),F=x.getUniformLocation(G,"uModelViewMatrix"),z=x.getUniformLocation(G,"resolution"),q=x.getUniformLocation(G,"uUseOrthogonalProjection"),ee=x.getUniformLocation(G,"uOrthogonalScale");C.tolleranceLocation=ue,C.maxStepLocation=de,C.inverseViewMatrixLocation=x.getUniformLocation(G,"uInverseViewMatrix"),C.useOrthogonalProjectionLocation=q,C.orthogonalProjectionScaleLocation=ee,a.writeGLInverseViewMatrix(C.inverseViewMatrix),x.uniformMatrix4fv(C.inverseViewMatrixLocation,!1,C.inverseViewMatrix),x.uniform1i(q,n.projection=="Orthogonal"?1:0),x.uniform1f(ue,d()),x.uniform1f(de,f()),x.uniform1f(ee,s()),x.uniform1f(R,V),x.uniform2f(z,A,L),$.onInit({gl:x,program:G,rerender:S});const I=C.vertices;I[0]=0,I[1]=0,I[2]=A,I[3]=0,I[4]=A,I[5]=L,I[6]=0,I[7]=0,I[8]=A,I[9]=L,I[10]=0,I[11]=L;let j=C.verticesGLBuffer;x.bindBuffer(x.ARRAY_BUFFER,j),x.bufferData(x.ARRAY_BUFFER,I,x.DYNAMIC_DRAW),x.vertexAttribPointer(J,2,x.FLOAT,!1,0,0);function se(be,fe,De,tt){var Ee=-1,st=1,It=fe-be,lt=tt-De,B=st-Ee;return[2/It,0,0,0,0,2/lt,0,0,0,0,-2/B,0,-(fe+be)/It,-(tt+De)/lt,-(st+Ee)/B,1]}const ke=new Float32Array(se(0,A,0,L));x.uniformMatrix4fv(F,!1,ke),x.viewport(0,0,A,L),x.enableVertexAttribArray(J),x.drawArrays(x.TRIANGLES,0,6),x.disableVertexAttribArray(J)},{defer:!0})),Re(he(()=>n.projection,x=>{let $=k();if($!=null&&C!=null){switch(x){case"Orthogonal":$.uniform1i(C.useOrthogonalProjectionLocation,1);break;case"Perspective":$.uniform1i(C.useOrthogonalProjectionLocation,0);break}S()}},{defer:!0})),Re(he(d,x=>{let $=k();$!=null&&C!=null&&($.uniform1f(C.tolleranceLocation,x),S())},{defer:!0})),Re(he(f,x=>{let $=k();$!=null&&C!=null&&($.uniform1f(C.maxStepLocation,x),S())},{defer:!0})),Re(he(s,x=>{let $=k();$!=null&&C!=null&&($.uniform1f(C.orthogonalProjectionScaleLocation,x),S())},{defer:!0})),Re(he(()=>a.space(),()=>{let x=k();x!=null&&C!=null&&(a.writeGLInverseViewMatrix(C.inverseViewMatrix),x.uniformMatrix4fv(C.inverseViewMatrixLocation,!1,C.inverseViewMatrix),S())},{defer:!0}));let P=async()=>{let x=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/,$=new Map,O=0;for(let V of r.world.entities())x.test(V)&&$.set(V,`${O++}`);let N=JSON.stringify(r.world.toJson());for(let[V,Z]of $.entries())N=N.replaceAll(V,Z);let A=Qx(N),L=lu(A);await window.navigator.clipboard.writeText(L)},T=async()=>{try{let x=await window.navigator.clipboard.readText(),$=cu(x),O=e_($),A=new TextDecoder("utf-8").decode(O),L=JSON.parse(A),V=Lt.fromJson(pl,L);if(V.type=="Err")throw new Error(V.message);let Z=V.value;Be(()=>{let G=r.world;for(let J of[...G.entities()])G.destroyEntity(J);for(let J of Z.entities()){let ue=Z.getComponents(J);G.createEntityWithId(J,ue)}})}catch(x){console.log(x),alert("Failed to read clipboard.")}};return(()=>{var x=r_(),$=x.firstChild,O=$.firstChild,N=O.nextSibling,A=N.firstChild,L=A.nextSibling,V=L.firstChild,Z=V.firstChild,G=Z.nextSibling,J=V.nextSibling,ue=J.firstChild,de=ue.nextSibling,R=J.nextSibling,F=R.firstChild,z=F.nextSibling;Ao(x,e,!1,!0),$.style.setProperty("width","100%"),$.style.setProperty("height","100%"),$.style.setProperty("position","relative"),$.style.setProperty("display","flex"),O.style.setProperty("flex","1"),O.style.setProperty("display","flex"),O.style.setProperty("overflow","hidden"),te(O,D(wu,{style:{"flex-grow":"1"},onInit:I=>{g(I.nodesSystem),u(I)},componentRegistry:pl,nodeRegistry:Sp,get world(){return r.world},get menu(){return[(()=>{var I=n_(),j=I.firstChild;return j.$$click=()=>{P(),l()?.closeMenu()},I})(),(()=>{var I=i_(),j=I.firstChild;return j.$$click=()=>{T(),l()?.closeMenu()},I})()]},get toolbar(){return[(()=>{var I=o_(),j=I.firstChild;return j.addEventListener("change",se=>o("showCode",se.currentTarget.checked)),le(()=>j.checked=n.showCode),I})(),(()=>{var I=a_();return I.addEventListener("change",j=>{if(j.currentTarget.selectedOptions.length!=1)return;let se=j.currentTarget.selectedOptions[0].value;o("projection",se)}),te(I,D(pt,{each:i,children:j=>(()=>{var se=s_();return se.value=j,te(se,j),le(()=>se.selected=n.projection==j),se})()})),I})()]}}));var q=y;typeof q=="function"?Ce(q,N):y=N,N.style.setProperty("flex","1"),N.style.setProperty("display","flex"),N.style.setProperty("overflow","hidden"),N.style.setProperty("position","relative"),A.$$pointermove=I=>{a.pointerMove(I)},A.$$pointerup=I=>{a.pointerUp(I)},A.$$pointerdown=I=>{a.pointerDown(I)};var ee=v;return typeof ee=="function"?Ce(ee,A):v=A,A.style.setProperty("flex-grow","1"),A.style.setProperty("touch-action","none"),te(N,D(ge,{get when(){return E(()=>!!n.showCode)()?m():void 0},children:I=>(()=>{var j=l_(),se=j.firstChild;return j.style.setProperty("position","absolute"),j.style.setProperty("right","0"),j.style.setProperty("top","0"),j.style.setProperty("bottom","0"),j.style.setProperty("overflow","auto"),j.style.setProperty("width","50%"),le(()=>se.innerText=ut.toString(I().code)),j})()}),L),L.style.setProperty("position","absolute"),L.style.setProperty("left","0"),L.style.setProperty("top","0"),te(L,D(ge,{get when(){return n.projection=="Orthogonal"},get children(){var I=t_(),j=I.firstChild,se=j.nextSibling;return I.style.setProperty("width","100px"),se.$$input=ke=>{o("orthoScaleText",ke.currentTarget.value)},le(()=>se.value=n.orthoScaleText),I}}),V),V.style.setProperty("width","100px"),G.$$input=I=>{o("maxIterationsText",I.currentTarget.value)},J.style.setProperty("width","100px"),de.$$input=I=>{o("tolleranceText",I.currentTarget.value)},R.style.setProperty("width","120px"),z.$$input=I=>{o("maxStepText",I.currentTarget.value)},le(I=>(I=p()?"row":"column")!=null?$.style.setProperty("flex-direction",I):$.style.removeProperty("flex-direction")),le(()=>G.value=n.maxIterationsText),le(()=>de.value=n.tolleranceText),le(()=>z.value=n.maxStepText),x})()};function No(t,r,e){const i=t.createShader(r);if(i!=null){if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){console.error("An error occurred compiling the shaders: "+t.getShaderInfoLog(i)),t.deleteShader(i);return}return i}}function u_(t,r,e){const i=No(t,t.VERTEX_SHADER,r);if(i==null)return;const n=No(t,t.FRAGMENT_SHADER,e);if(n==null){t.deleteShader(i);return}const o=t.createProgram();if(t.attachShader(o,i),t.attachShader(o,n),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS)){console.error("Unable to initialize the shader program: "+t.getProgramInfoLog(o)),t.detachShader(o,i),t.detachShader(o,n),t.deleteShader(i),t.deleteShader(n),t.deleteProgram(o);return}return{vertexShader:i,fragmentShader:n,shaderProgram:o}}function d_(t,r,e,i){let n=r.width,o=r.height;const a=.5*o/Math.tan(.5*sf*Math.PI/180);let l,u,s;{const P=u_(t,`attribute vec4 aVertexPosition;

  uniform mat4 uModelViewMatrix;

  void main(void) {
    gl_Position = uModelViewMatrix * aVertexPosition;
  }
  `,ut.toString(i.code));if(P==null)return;l=P.vertexShader,u=P.fragmentShader,s=P.shaderProgram}t.useProgram(s);const c=t.getAttribLocation(s,"aVertexPosition"),d=t.getUniformLocation(s,"uTollerance"),f=t.getUniformLocation(s,"uMaxStep"),p=t.getUniformLocation(s,"uFocalLength"),h=t.getUniformLocation(s,"uModelViewMatrix"),g=t.getUniformLocation(s,"resolution"),m=t.getUniformLocation(s,"uInverseViewMatrix"),b=t.getUniformLocation(s,"uUseOrthogonalProjection"),y=t.getUniformLocation(s,"uOrthogonalScale");let w=new Float32Array(16);ye(()=>e.writeGLInverseViewMatrix(w)),t.uniformMatrix4fv(m,!1,w),t.uniform1i(b,0),t.uniform1f(y,.1),t.uniform1f(p,a),t.uniform2f(g,n,o);const v=new Float32Array(12);v[0]=0,v[1]=0,v[2]=n,v[3]=0,v[4]=n,v[5]=o,v[6]=0,v[7]=0,v[8]=n,v[9]=o,v[10]=0,v[11]=o;let k=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,k),t.bufferData(t.ARRAY_BUFFER,v,t.DYNAMIC_DRAW),t.vertexAttribPointer(c,2,t.FLOAT,!1,0,0);function _(P,T,x,$){var O=-1,N=1,A=T-P,L=$-x,V=N-O;return[2/A,0,0,0,0,2/L,0,0,0,0,-2/V,0,-(T+P)/A,-($+x)/L,-(N+O)/V,1]}const C=new Float32Array(_(0,n,0,o));return t.uniformMatrix4fv(h,!1,C),t.viewport(0,0,n,o),t.enableVertexAttribArray(c),t.drawArrays(t.TRIANGLES,0,6),t.disableVertexAttribArray(c),{width:r.width,height:r.height,positionLocation:c,verticesGLBuffer:k,vertices:v,vertexShader:l,fragmentShader:u,shaderProgram:s,tolleranceLocation:d,maxStepLocation:f,inverseViewMatrix:w,inverseViewMatrixLocation:m,useOrthogonalProjectionLocation:b,orthogonalProjectionScaleLocation:y}}Oe(["pointerdown","pointerup","pointermove","input","click"]);var p_=Y("<div>");const f_=We(()=>Ge(()=>import("./CodeMirror-CA44buzz.js"),__vite__mapDeps([7,1,2,3,4,5]),import.meta.url)),h_=We(()=>Ge(()=>import("./AppV2-6iBXJVSH.js"),__vite__mapDeps([8,1,2,3,4,9,10,11,6,12,13,14,15,16,17,18,19,20,21,22,23,7,5,24]),import.meta.url)),m_=We(()=>Ge(()=>import("./KittyDemo-GDtrhFg8.js"),__vite__mapDeps([25,1,2,3,4,15,16,20]),import.meta.url)),g_=We(()=>Ge(()=>import("./PixelEditor-ocA06Brg.js"),__vite__mapDeps([9,1,2,3,4,10]),import.meta.url)),y_=We(()=>Ge(()=>import("./lib-CvNVz1PI.js").then(t=>t._),__vite__mapDeps([1,2,3,4]),import.meta.url)),b_=We(()=>Ge(()=>import("./ScriptEditor-BZAKKYP-.js"),__vite__mapDeps([11,1,2,3,4]),import.meta.url)),v_=We(()=>Ge(()=>import("./ColourPicker-l30c-hik.js").then(t=>t.b),__vite__mapDeps([10,1,2,3,4]),import.meta.url)),w_=We(()=>Ge(()=>import("./ReactiveSimulator-BW2q9A_Z.js"),__vite__mapDeps([26,1,2,3,4]),import.meta.url)),k_=We(()=>Ge(()=>import("./VectorEditor-B6oQYpvV.js"),__vite__mapDeps([27,1,2,3,4]),import.meta.url)),x_=We(()=>Ge(()=>import("./GravityTest-RbUe9lch.js"),__vite__mapDeps([28,1,2,3,4]),import.meta.url)),__=We(()=>Ge(()=>import("./ThreeBody-D8QpECIq.js"),__vite__mapDeps([29,1,2,3,4]),import.meta.url)),S_=We(()=>Ge(()=>import("./VirtualFileSystemTest-BfLK2tIl.js"),__vite__mapDeps([30,1,2,3,4]),import.meta.url)),C_=We(()=>Ge(()=>import("./AutomergeWebRtcTest-EIuBMbbm.js"),__vite__mapDeps([31,1,2,3,4]),import.meta.url)),P_=We(()=>Ge(()=>import("./DebugProjection-BdCVffaU.js"),__vite__mapDeps([32,1,2,3,4]),import.meta.url)),T_=We(()=>Ge(()=>import("./AutoFormsTest-BSZKGVDW.js"),__vite__mapDeps([33,1,2,3,4]),import.meta.url)),E_=document.getElementById("root");ec(()=>{let t=new URLSearchParams(window.location.search),r=window.localStorage.getItem("lastDocUrl"),e=t.get("docUrl")??r,[i,n]=oe(!1),o=new pf({storage:new ff,network:[]}),a;if(e==null||!fa(e)){let m=o.create(ha.makeEmptyState(o));window.localStorage.setItem("lastDocUrl",m.url),a=()=>m}else{let[m]=bf(()=>o.find(e));a=m}let l=E(()=>{let[m,b]=oe(a());return{doc:m,setDoc:b}}),u=E(()=>l().doc()),s=m=>{ye(()=>l().setDoc(m))},c=E(()=>a()?.url),d=qh({documentUrl:c,setDocumentUrl:async m=>{if(!fa(m))return;let b=await o.find(m);s(b)}}),f=d.connections.bind(d),p=E(zt(f,m=>new Vh({connection:m.conn})));ve(zt(p,m=>{o.networkSubsystem.addNetworkAdapter(m),Ne(()=>{})}));let h=E(()=>{let m=u();return new ha({repo:o,docHandle:()=>m})}),g=()=>D(eh,{onShareVfs:()=>{let m=a();if(m==null)return;const b=new URL(window.location.href);b.searchParams.set("docUrl",m.url);let y=b.toString();window.history.pushState(null,"",y),navigator.clipboard.writeText(y)},onDeleteVfs:()=>{window.localStorage.removeItem("lastDocUrl"),indexedDB.deleteDatabase("automerge"),window.location.reload()},get vfs(){return h()}});return D(Hf,{get children(){return[D(Fe,{path:"/",component:g}),D(Fe,{path:"/kitty-demo",component:m_}),D(Fe,{path:"/pixel-editor",component:()=>D(g_,{})}),D(Fe,{path:"/level-builder",component:()=>D(y_,{get vfs(){return h()}})}),D(Fe,{path:"/script-editor",component:()=>D(b_,{})}),D(Fe,{path:"/music-editor",component:Cb}),D(Fe,{path:"/model-editor",component:()=>D(c_,{style:"flex-grow: 1; overflow: hidden;",world:new Lt})}),D(Fe,{path:"/code-mirror",component:()=>D(f_,{})}),D(Fe,{path:"/colour-picker",component:()=>(()=>{var m=p_();return m.style.setProperty("width","300px"),m.style.setProperty("height","300px"),m.style.setProperty("display","flex"),m.style.setProperty("flex-direction","column"),m.style.setProperty("margin-left","20px"),m.style.setProperty("margin-top","20px"),te(m,D(v_,{})),m})()}),D(Fe,{path:"/reactive-sim",component:w_}),D(Fe,{path:"/vector-editor",component:k_}),D(Fe,{path:"/gravity-test",component:x_}),D(Fe,{path:"/three-body",component:__}),D(Fe,{path:"/vfs-test",component:S_}),D(Fe,{path:"/automerge-webrtc-test",component:C_}),D(Fe,{path:"/connection-management",get component(){return d.Render}}),D(Fe,{path:"/debug-projection",component:P_}),D(Fe,{path:"/app",component:()=>D(ge,{get when(){return u()},children:m=>D(h_,{get vfsDocUrl(){return m().url},get vfs(){return h()},get ConnectionManagementUi(){return d.Render},get broadcastNetworkAdapterIsEnabled(){return i()},enableBroadcastNetworkAdapter:()=>{o.networkSubsystem.addNetworkAdapter(new hf),n(!0)},flushRepo:()=>o.flush()})})}),D(Fe,{path:"/auto-forms-test",component:T_})]}})},E_);const G_=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{Na as $,Lt as E,hc as F,Xf as a,G_ as b,O_ as e,Qx as g,Kf as i,e_ as u};
