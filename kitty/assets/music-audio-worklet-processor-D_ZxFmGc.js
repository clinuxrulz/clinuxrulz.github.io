(function(){"use strict";let r,a,n;const d=261.625565;class h extends AudioWorkletProcessor{meow=[];activeMeowsHead=void 0;activeMeowsTail=void 0;noteEvents=void 0;atNoteEventIdx=void 0;t0=void 0;constructor(){super(),this.port.onmessage=l=>{let s=l.data;if(s.type=="meowData"){let o=s.params;o.meowOriginalPitch,r=o.meowSampleRate,a=o.meowData,n=r/(sampleRate*d),this.meow=Array(128).fill(void 0).map((v,t)=>{let e={activeId:0,active:!1,at:0,step:d*Math.pow(2,(t-60)/12)*n,prev:void 0,next:void 0};return e.prev=e,e})}else if(s.type=="musicData"){let o=s.params;this.noteEvents=o.noteEvents,this.t0=currentTime}}}process(l,s){if(this.t0==null||this.noteEvents==null||a==null)return!0;if(this.atNoteEventIdx==null&&(this.atNoteEventIdx=0),this.atNoteEventIdx>=this.noteEvents.length)return!1;let o=currentTime-this.t0;for(;this.atNoteEventIdx<this.noteEvents.length;){let t=this.noteEvents[this.atNoteEventIdx];if(o>=t.time){let e=this.meow[t.note];if(e!=null)if(t.type=="On"){if(!e.active){if(this.activeMeowsHead==null)this.activeMeowsHead=this.activeMeowsTail=e;else{let i=this.activeMeowsTail;i.next=e,e.prev=i,this.activeMeowsTail=i}e.active=!0}e.activeId=t.id,e.at=0}else t.type=="Off"&&t.id==e.activeId&&(e.activeId=-1,e.active&&(e.prev.next=e.next,e.next!=null&&(e.next.prev=e.prev),this.activeMeowsHead==e&&(this.activeMeowsHead=e.next),this.activeMeowsTail==e&&(this.activeMeowsTail=e.prev),e.prev=e,e.next=void 0,e.active=!1));this.atNoteEventIdx++}else break}let v=s[0][0];for(let t=0;t<v.length;++t){let e=0,i=this.activeMeowsHead;for(;i!=null;){let c=Math.floor(i.at);c<a.length&&(e+=a[c],i.at+=i.step),i=i.next}v[t]=e}return!0}}registerProcessor("music-audio-worklet-processor",h)})();
