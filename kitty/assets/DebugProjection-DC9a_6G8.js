import{R as f,m as S,createJsonProjectionViaTypeSchemaV2 as N,Vec2 as b,EcsWorld as _,E as h,r as B,f as v,p as P,d as k,t as E,tsObject as j,tsString as $,vec2TypeSchema as C,tsArray as y,tsNumber as w}from"./lib-D2Ry6Al3.js";import{u as x,m as p,N as u}from"./dev-B9-ass9r.js";import{a as T,p as A}from"./dev-CC7pdsS5.js";import"./index-XNH-lkY3.js";var R=E('<div><button class="btn btn-primary">Run Test 1 (type schema projection on automerge)</button><br><button class="btn btn-primary"style=margin-top:5px;>Run Test 2 (ecs world automerge projection)</button><br><button class="btn btn-primary"style=margin-top:5px;>Run Test 3 (brand new projection)');const M=()=>(()=>{var o=R(),r=o.firstChild,s=r.nextSibling,l=s.nextSibling,e=l.nextSibling,n=e.nextSibling;return o.style.setProperty("width","100%"),o.style.setProperty("height","100%"),o.style.setProperty("padding","5px"),r.$$click=()=>D(),l.$$click=()=>O(),n.$$click=()=>z(),o})();function D(){let r=new f().create({firstName:"John",lastName:"Smith",location:{x:10,y:15},targets:[{x:1,y:3},{x:2,y:2},{x:3,y:1}],secretCodes:[[1,3,3,7],[3,1,3,3,7],[4,0]]}),s=j({firstName:$(),lastName:$(),location:C,targets:y(C),secretCodes:y(y(w()))});x(l=>{let e=S(r),n=N(s,e,m=>r.change(g=>m(g)));if(t(n.type=="Ok"),n.type!="Ok")return;let a=n.value,[c,d]=T(a),i;p(()=>{i=c.secretCodes[2][1]}),t(i).toBe(0),d("firstName","Apple"),d("location",b.create(1,2)),d("targets",1,b.create(7,7)),p(u(()=>c.secretCodes,()=>{console.log("A")},{defer:!0})),p(u(()=>c.secretCodes[2],()=>{console.log("B")},{defer:!0})),p(u(()=>c.secretCodes[2][1],()=>{console.log("C")},{defer:!0})),d("secretCodes",2,1,2),t(i).toBe(2),t(e.firstName).toBe("Apple"),t(e.lastName).toBe("Smith"),t(e.location.x).toBe(1),t(e.location.y).toBe(2),t(e.targets[1].x).toBe(7),t(e.targets[1].y).toBe(7),t(e.secretCodes[2][0]).toBe(4),t(e.secretCodes[2][1]).toBe(2),l()})}function O(){let r=new f().create(new _().toJson());x(s=>{let l=h.create(B,r),e=h.create(B,r);if(l.type=="Err"||e.type=="Err")return;let n=l.value,a=e.value;p(u(()=>a.entities(),c=>console.log(c))),n.createEntity([v.create({name:"aaa",pos:b.zero,size:b.create(10,10),numCells:b.create(1,1),metaData:null})]),s()})}async function z(){let o=j({a:"Number",b:y(y(w()))}),s=new f().create({a:5,b:[[0,0,0,0],[0,0,0,0],[0,0,0,0]]});await new Promise(e=>{x(n=>{let a=S(s),c=P(a,s.change.bind(s),o),[d,i]=T(c),m=0;p(u(()=>a.a,()=>{m=a.a},{defer:!0})),i("a",7),t(m).toBe(7),p(u(()=>a.b[1][1],()=>{m=a.b[1][1]},{defer:!0})),i("b",1,1,42),t(m).toBe(42),i("b",1,A(g=>{g.push(42)})),t(a.b[1][4]).toBe(42),n(),e()})})}function t(o){return{toBe:r=>{o!==r&&console.log(`${o} !== ${r}`)}}}k(["click"]);export{M as default};
