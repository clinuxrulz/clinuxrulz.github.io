import{Vec2 as I,u as ce,i as te,d as Se,t as Fe,s as F}from"./lib-DboxH0Mh.js";import{Y as Ie,c as j,m as X,q as R,p as k,N as O,O as be,b as E,s as Y}from"./dev-B9-ass9r.js";import{a as Re}from"./dev-CC7pdsS5.js";class re{r;g;b;a;constructor(l,r,W,V){this.r=l,this.g=r,this.b=W,this.a=V}}var ke=Fe("<div><div><div><div></div><svg><circle r=5 stroke=black stroke-width=2 fill=none pointer-events=none></circle></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div></div><div><div></div><div><table><thead></thead><tbody><tr><td>Red:</td><td><input type=text size=4></td></tr><tr><td>Green:</td><td><input type=text size=4></td></tr><tr><td>Blue:</td><td><input type=text size=4></td></tr><tr><td>Alpha:</td><td><input type=text size=4></td></tr></tbody></table></div><div><div>");const Ae=A=>{let[l,r]=Re({cursorPos:I.zero,chartMousePos:void 0,chartMouseDown:!1,brightness:255,brightnessMousePos:void 0,brightnessMouseDown:!1,alpha:255,alphaMousePos:void 0,alphaMouseDown:!1,userColour:Ie(()=>A.colour),userRedText:void 0,userGreenText:void 0,userBlueText:void 0,userAlphaText:void 0}),[W,V]=j(),[le,Pe]=j();X(()=>{let e=W();if(e==null)return;let o=new ResizeObserver(()=>{let i=e.getBoundingClientRect();le(),Pe(I.create(i.width,i.height))});o.observe(e),be(()=>{o.unobserve(e),o.disconnect()})});let v=R(()=>{let e=le();if(e==null)return;let o=document.createElement("canvas");o.setAttribute("width",`${e.x}`),o.setAttribute("height",`${e.y}`),o.style.setProperty("flex-grow","1");let i=o.getContext("2d");if(i==null)return;let s=new ImageData(e.x,e.y),f=256*6;for(let p=0;p<e.x;++p){let a,y,x,h=Math.floor(p*f/e.x);if(h<256){let n=h;a=255,y=n,x=0}else if(h<256*2)a=255-(h-256),y=255,x=0;else if(h<256*3){let n=h-512;a=0,y=255,x=n}else if(h<256*4){let n=h-768;a=0,y=255-n,x=255}else if(h<256*5)a=h-1024,y=0,x=255;else{let n=h-1280;a=255,y=0,x=255-n}let g=p<<2;for(let n=0;n<e.y;++n){let w=a+Math.floor((256-a)*n/e.y),D=y+Math.floor((256-y)*n/e.y),z=x+Math.floor((256-x)*n/e.y);s.data[g]=w,s.data[g+1]=D,s.data[g+2]=z,s.data[g+3]=255,g+=e.x<<2}}let $=new ImageData(e.x,e.y);X(O(()=>l.brightness,()=>{let p=l.brightness,a=e.x*e.y<<2;for(let y=0;y<a;y+=4){let x=s.data[y],h=s.data[y+1],g=s.data[y+2],n=s.data[y+3],w=Math.floor(x*p/255),D=Math.floor(h*p/255),z=Math.floor(g*p/255);$.data[y]=w,$.data[y+1]=D,$.data[y+2]=z,$.data[y+3]=n}i.putImageData($,0,0)}));let u=document.createElement("canvas");u.setAttribute("width","1"),u.setAttribute("height",`${e.y}`),u.style.setProperty("flex-grow","1");let b=u.getContext("2d");if(b==null)return;let M=new ImageData(1,e.y);X(()=>{let p=l.cursorPos;if(p==null)return;let a=s.width*p.y+p.x<<2,y=s.data[a],x=s.data[a+1],h=s.data[a+2];for(let g=0;g<e.y;++g){let n=g<<2,w=Math.floor(y*(e.y-1-g)/(e.y-1)),D=Math.floor(x*(e.y-1-g)/(e.y-1)),z=Math.floor(h*(e.y-1-g)/(e.y-1));M.data[n]=w,M.data[n+1]=D,M.data[n+2]=z,M.data[n+3]=255}b.putImageData(M,0,0)});let d=document.createElement("canvas");d.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),d.style.setProperty("background-size","20px 20px"),d.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),d.setAttribute("width","1"),d.setAttribute("height",`${e.y}`),d.style.setProperty("flex-grow","1");let P=d.getContext("2d");if(P==null)return;let m=new ImageData(1,e.y);return X(()=>{let p=l.cursorPos;if(p==null)return;let a=s.width*p.y+p.x<<2,y=s.data[a],x=s.data[a+1],h=s.data[a+2],g=s.data[a+3];for(let n=0;n<e.y;++n){let w=n<<2,D=Math.floor(g*(e.y-1-n)/(e.y-1));m.data[w]=y,m.data[w+1]=x,m.data[w+2]=h,m.data[w+3]=D}P.putImageData(m,0,0)}),{canvas:o,sliderCanvas:u,alphaSliderCanvas:d,size:e,sliderImageData:M,alphaSliderImageData:m}});k(()=>{let e=v();if(e==null||!l.chartMouseDown)return;let o=l.chartMousePos;o!=null&&(r("userColour",void 0),r("userRedText",void 0),r("userGreenText",void 0),r("userBlueText",void 0),r("cursorPos",I.create(Math.max(0,Math.min(e.size.x-1,Math.floor(o.x))),Math.max(0,Math.min(e.size.y-1,Math.floor(o.y))))))}),k(()=>{if(!l.brightnessMouseDown)return;let e=l.brightnessMousePos;if(e==null)return;let o=v()?.size.y;o!=null&&(r("userColour",void 0),r("userRedText",void 0),r("userGreenText",void 0),r("userBlueText",void 0),r("brightness",Math.max(0,Math.min(255,Math.floor(256*(o-e.y)/o)))))}),k(()=>{if(!l.alphaMouseDown)return;let e=l.alphaMousePos;if(e==null)return;let o=v()?.size.y;o!=null&&(r("userColour",void 0),r("userRedText",void 0),r("userGreenText",void 0),r("userBlueText",void 0),r("userAlphaText",void 0),r("alpha",Math.max(0,Math.min(255,Math.floor(256*(o-e.y)/o)))))});let B=R(O([v,()=>l.cursorPos,()=>l.brightness,()=>l.alpha],()=>{let e=v();if(e==null)return;let i=Math.max(0,Math.min(e.size.y,Math.floor((255-l.brightness)*e.size.y/256)))<<2,s=e.sliderImageData.data[i],f=e.sliderImageData.data[i+1],$=e.sliderImageData.data[i+2],u=l.alpha;return new re(s,f,$,u)})),q=R(()=>{if(l.userRedText==null)return;let e=Number.parseFloat(l.userRedText);if(Number.isFinite(e))return Math.max(0,Math.min(255,e))}),H=R(()=>{if(l.userGreenText==null)return;let e=Number.parseFloat(l.userGreenText);if(Number.isFinite(e))return Math.max(0,Math.min(255,e))}),J=R(()=>{if(l.userBlueText==null)return;let e=Number.parseFloat(l.userBlueText);if(Number.isFinite(e))return Math.max(0,Math.min(255,e))}),K=R(()=>{if(l.userAlphaText==null)return;let e=Number.parseFloat(l.userAlphaText);if(Number.isFinite(e))return Math.max(0,Math.min(255,e))}),c=R(()=>{let e;return l.userColour!=null?e=l.userColour:e=B(),new re(q()??e?.r??0,H()??e?.g??0,J()??e?.b??0,K()??e?.a??255)});k(O([()=>A.colour],()=>{let e=c();if(e==null||A.colour==null)return;let o=A.colour;o.r==e.r&&o.g==e.g&&o.b==e.b&&o.a==e.a||r("userColour",o)},{defer:!0})),k(O([()=>l.userColour,c],()=>{if(l.userColour!=null)return;let e=c();e!=null&&A.onColour?.(e)})),k(()=>{let e=v();if(!e||l.userColour==null&&q()==null&&H()==null&&J()==null&&K()==null)return;let o=l.userColour,i=new re(q()??o?.r??0,H()??o?.g??0,J()??o?.b??0,K()??o?.a??255),s=Math.max(i.r,i.g,i.b),f=Math.min(i.r,i.g,i.b),$=s,u=255/(s-f);if(!Number.isFinite(u))return;let b=Math.floor((i.r-f)*u),M=Math.floor((i.g-f)*u),d=Math.floor((i.b-f)*u),P=i.r==s,m=i.g==s,p=i.b==s,a;P&&!m&&d==0?a=M:!P&&m&&d==0?a=256+(255-b):b==0&&m&&!p?a=256*2+d:b==0&&!m&&p?a=256*3+(255-M):!P&&M==0&&p?a=256*4+b:a=256*5+(255-d);let y=Math.floor(e.size.x*a/(256*6)),x=f;E(()=>{r("cursorPos",I.create(y,x)),r("brightness",$),r("alpha",i.a)})});let[oe,ie]=j(),[me,Ce]=j(50);return k(O(oe,()=>{let e=oe();if(e==null)return;let o=new ResizeObserver(()=>{let i=e.getBoundingClientRect();console.log(i),i.width!=i.height&&Ce(i.height)});o.observe(e),be(()=>{o.unobserve(e),o.disconnect()})})),(()=>{var e=ke(),o=e.firstChild,i=o.firstChild,s=i.firstChild,f=s.nextSibling,$=f.firstChild,u=i.nextSibling,b=u.firstChild,M=b.firstChild,d=u.nextSibling,P=d.firstChild,m=P.firstChild,p=o.nextSibling,a=p.firstChild,y=a.nextSibling,x=y.firstChild,h=x.firstChild,g=h.nextSibling,n=g.firstChild,w=n.firstChild,D=w.nextSibling,z=D.firstChild,se=n.nextSibling,$e=se.firstChild,Me=$e.nextSibling,ae=Me.firstChild,ne=se.nextSibling,we=ne.firstChild,Te=we.nextSibling,ue=Te.firstChild,De=ne.nextSibling,ze=De.firstChild,_e=ze.nextSibling,de=_e.firstChild,C=y.nextSibling,G=C.firstChild;e.style.setProperty("flex-grow","1"),e.style.setProperty("display","flex"),e.style.setProperty("flex-direction","column"),o.style.setProperty("flex-grow","1"),o.style.setProperty("display","flex"),o.style.setProperty("flex-direction","row"),i.$$pointerup=t=>{r("chartMouseDown",!1),t.currentTarget.releasePointerCapture(t.pointerId),t.preventDefault()},i.$$pointerdown=t=>{r("chartMouseDown",!0),t.currentTarget.setPointerCapture(t.pointerId),t.preventDefault()},i.$$pointerout=t=>{r("chartMousePos",void 0),t.preventDefault()},i.$$pointermove=t=>{let T=t.currentTarget.getBoundingClientRect(),_=t.clientX-T.left,S=t.clientY-T.top;r("chartMousePos",I.create(_,S)),t.preventDefault()},i.style.setProperty("position","relative"),i.style.setProperty("flex-grow","1"),i.style.setProperty("display","flex"),i.style.setProperty("flex-direction","column"),i.style.setProperty("touch-action","none");var ye=V;typeof ye=="function"?ce(ye,s):V=s,s.style.setProperty("flex-grow","1"),s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),te(s,()=>v()?.canvas),f.style.setProperty("position","absolute"),f.style.setProperty("left","0"),f.style.setProperty("top","0"),f.style.setProperty("right","0"),f.style.setProperty("bottom","0"),u.$$pointerup=t=>{r("brightnessMouseDown",!1),t.currentTarget.releasePointerCapture(t.pointerId),t.preventDefault()},u.$$pointerdown=t=>{r("brightnessMouseDown",!0),t.currentTarget.setPointerCapture(t.pointerId),t.preventDefault()},u.$$pointerout=t=>{r("brightnessMousePos",void 0),t.preventDefault()},u.$$pointermove=t=>{let T=t.currentTarget.getBoundingClientRect(),_=t.clientX-T.left,S=t.clientY-T.top;r("brightnessMousePos",I.create(_,S)),t.preventDefault()},u.style.setProperty("position","relative"),u.style.setProperty("display","flex"),u.style.setProperty("flex-direction","row"),u.style.setProperty("width","25px"),u.style.setProperty("margin-left","15px"),u.style.setProperty("overflow","hidden"),u.style.setProperty("touch-action","none"),te(u,()=>v()?.sliderCanvas,b),b.style.setProperty("position","absolute"),b.style.setProperty("left","0"),b.style.setProperty("top","0"),b.style.setProperty("right","0"),b.style.setProperty("bottom","0"),d.$$pointerup=t=>{r("alphaMouseDown",!1),t.currentTarget.releasePointerCapture(t.pointerId),t.preventDefault()},d.$$pointerdown=t=>{r("alphaMouseDown",!0),t.currentTarget.setPointerCapture(t.pointerId),t.preventDefault()},d.$$pointerout=t=>{r("alphaMousePos",void 0),t.preventDefault()},d.$$pointermove=t=>{let T=t.currentTarget.getBoundingClientRect(),_=t.clientX-T.left,S=t.clientY-T.top;r("alphaMousePos",I.create(_,S)),t.preventDefault()},d.style.setProperty("position","relative"),d.style.setProperty("display","flex"),d.style.setProperty("flex-direction","row"),d.style.setProperty("width","25px"),d.style.setProperty("margin-left","15px"),d.style.setProperty("overflow","hidden"),d.style.setProperty("touch-action","none"),te(d,()=>v()?.alphaSliderCanvas,P),P.style.setProperty("position","absolute"),P.style.setProperty("left","0"),P.style.setProperty("top","0"),P.style.setProperty("right","0"),P.style.setProperty("bottom","0"),p.style.setProperty("display","flex"),p.style.setProperty("flex-direction","row"),a.style.setProperty("flex-grow","1"),z.$$input=t=>{E(()=>{r("userRedText",t.currentTarget.value),r("userGreenText",c().g.toFixed(0)),r("userBlueText",c().b.toFixed(0)),r("userAlphaText",c().a.toFixed(0))})},ae.$$input=t=>{E(()=>{r("userRedText",c().r.toFixed(0)),r("userGreenText",t.currentTarget.value),r("userBlueText",c().b.toFixed(0)),r("userAlphaText",c().a.toFixed(0))})},ue.$$input=t=>{E(()=>{r("userRedText",c().r.toFixed(0)),r("userGreenText",c().g.toFixed(0)),r("userBlueText",t.currentTarget.value),r("userAlphaText",c().a.toFixed(0))})},de.$$input=t=>{E(()=>{r("userRedText",c().r.toFixed(0)),r("userGreenText",c().g.toFixed(0)),r("userBlueText",c().b.toFixed(0)),r("userAlphaText",t.currentTarget.value)})};var pe=ie;return typeof pe=="function"?ce(pe,C):ie=C,C.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),C.style.setProperty("background-size","20px 20px"),C.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),C.style.setProperty("margin-top","10px"),C.style.setProperty("margin-bottom","10px"),C.style.setProperty("margin-left","10px"),C.style.setProperty("display","flex"),C.style.setProperty("flex-direction","column"),G.style.setProperty("flex-grow","1"),Y(t=>{var T=v()?.size.x??300,_=v()?.size.y??300,S=l.cursorPos.x,ve=l.cursorPos.y,L=`${v()?.size.y??0}px`,he=v()?.size.y??0,fe=(v()?.size.y??0)-l.brightness*(v()?.size.y??0)/255-5,Q=`${v()?.size.y??0}px`,xe=v()?.size.y??0,ge=(v()?.size.y??0)-l.alpha*(v()?.size.y??0)/255-5,U=`${me()}px`,Z=(()=>{let N=c();if(N!=null)return`rgb(${N.r}, ${N.g}, ${N.b})`})(),ee=c().a/255;return T!==t.e&&F(f,"width",t.e=T),_!==t.t&&F(f,"height",t.t=_),S!==t.a&&F($,"cx",t.a=S),ve!==t.o&&F($,"cy",t.o=ve),L!==t.i&&((t.i=L)!=null?u.style.setProperty("height",L):u.style.removeProperty("height")),he!==t.n&&F(b,"height",t.n=he),fe!==t.s&&F(M,"y",t.s=fe),Q!==t.h&&((t.h=Q)!=null?d.style.setProperty("height",Q):d.style.removeProperty("height")),xe!==t.r&&F(P,"height",t.r=xe),ge!==t.d&&F(m,"y",t.d=ge),U!==t.l&&((t.l=U)!=null?C.style.setProperty("width",U):C.style.removeProperty("width")),Z!==t.u&&((t.u=Z)!=null?G.style.setProperty("background-color",Z):G.style.removeProperty("background-color")),ee!==t.c&&((t.c=ee)!=null?G.style.setProperty("opacity",ee):G.style.removeProperty("opacity")),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),Y(()=>z.value=l.userRedText??l.userColour?.r??B()?.r),Y(()=>ae.value=l.userGreenText??l.userColour?.g??B()?.g),Y(()=>ue.value=l.userBlueText??l.userColour?.b??B()?.b),Y(()=>de.value=l.userAlphaText??l.userColour?.a??B()?.a),e})()};Se(["pointermove","pointerout","pointerdown","pointerup","input"]);const Oe=Object.freeze(Object.defineProperty({__proto__:null,default:Ae},Symbol.toStringTag,{value:"Module"}));export{re as C,Ae as a,Oe as b};
