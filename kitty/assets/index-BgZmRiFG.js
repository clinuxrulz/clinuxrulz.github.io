const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CodeMirror-9VHN8HJG.js","./lib-DQcED-Wj.js","./index-XNH-lkY3.js","./dev-B9-ass9r.js","./dev-CC7pdsS5.js","./AppV2-CopOwSea.js","./PixelEditor-BmPh638B.js","./ColourPicker-BIzsq5Xv.js","./ScriptEditor-Bj1PhInY.js","./solid-js-C16mITwu.js","./pixi-js-CTVzrHHI.js","./FederatedEventTarget-DFQx8mKK.js","./Filter-BDK7ILDO.js","./State-3sV0XrC-.js","./CanvasTextSystem-BKHjFPHo.js","./colorToUniform-W8Zlj3HA.js","./SharedSystems-BwGi1NkL.js","./AnimatedSprite-CrPahPC5.js","./WebGLRenderer-DzfsPnmv.js","./WebGPURenderer-DziseXTR.js","./solid-js-store-D4PqY48D.js","./AppV2-DQoE4ujd.css","./KittyDemo-CmKh1ODH.js","./ReactiveSimulator-DIVGWTtu.js","./VectorEditor-Cglqek8A.js","./GravityTest-CBStNcn1.js","./ThreeBody-BZytEPnY.js","./VirtualFileSystemTest-xT3VF77A.js","./AutomergeWebRtcTest-DVltBoxj.js","./DebugProjection-u9uBIx3i.js","./AutoFormsTest-D3SeKzQ2.js"])))=>i.map(i=>d[i]);
import{dG as Ot,i as Dr,d as bs,dH as vs,_ as Ee}from"./index-XNH-lkY3.js";import{M as ks,d as be,J as wi,w as je,x as de,i as W,u as he,t as B,N as Ft,n as ct,P as We,Vec2 as mn,v as st,s as K,Q as xi,k as jr,g as gn,R as ws,W as xs,X as yn,Y as bn,Z as Ss}from"./lib-DQcED-Wj.js";import{U as Si,q as S,C as Lr,n as Ci,Z as Pi,c as Y,s as Z,N as ne,X as Cs,T as Ps,b as Oe,Y as oe,l as I,k as _i,K as _s,S as ie,u as et,O as ye,V as sr,m as ae,F as qe,h as zr,M as ut,J as tt,Q as Ur,p as xe,W as Br,H as Ie,t as Ts}from"./dev-B9-ass9r.js";import{a as Ce,p as _t}from"./dev-CC7pdsS5.js";function $s(i,e){for(var r=0;r<e.length;r++){const t=e[r];if(typeof t!="string"&&!Array.isArray(t)){for(const n in t)if(n!=="default"&&!(n in i)){const o=Object.getOwnPropertyDescriptor(t,n);o&&Object.defineProperty(i,n,o.get?o:{enumerable:!0,get:()=>t[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}function Ti(){let i=new Set;function e(n){return i.add(n),()=>i.delete(n)}let r=!1;function t(n,o){if(r)return!(r=!1);const a={to:n,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const s of i)s.listener({...a,from:s.location,retry:u=>{u&&(r=!0),s.navigate(n,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:t}}let Cr;function qr(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Cr=window.history.state._depth}qr();function Es(i){return{...i,_depth:window.history.state&&window.history.state._depth}}function Is(i,e){let r=!1;return()=>{const t=Cr;qr();const n=t==null?null:Cr-t;if(r){r=!1;return}n&&e(n)?(r=!0,window.history.go(-n)):i()}}const Rs=/^(?:[a-z0-9]+:)?\/\//i,Ms=/^\/+|(\/)\/+$/g,$i="http://sr";function It(i,e=!1){const r=i.replace(Ms,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Ut(i,e,r){if(Rs.test(e))return;const t=It(i),n=r&&It(r);let o="";return!n||e.startsWith("/")?o=t:n.toLowerCase().indexOf(t.toLowerCase())!==0?o=t+n:o=n,(o||"/")+It(e,!o)}function As(i,e){if(i==null)throw new Error(e);return i}function Ns(i,e){return It(i).replace(/\/*(\*.*)?$/g,"")+It(e)}function Ei(i){const e={};return i.searchParams.forEach((r,t)=>{t in e?Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:e[t]=r}),e}function Os(i,e,r){const[t,n]=i.split("/*",2),o=t.split("/").filter(Boolean),a=o.length;return s=>{const u=s.split("/").filter(Boolean),l=u.length-a;if(l<0||l>0&&n===void 0&&!e)return null;const c={path:a?"":"/",params:{}},d=f=>r===void 0?void 0:r[f];for(let f=0;f<a;f++){const p=o[f],g=p[0]===":",h=g?u[f]:u[f].toLowerCase(),y=g?p.slice(1):p.toLowerCase();if(g&&lr(h,d(y)))c.params[y]=h;else if(g||!lr(h,y))return null;c.path+=`/${h}`}if(n){const f=l?u.slice(-l).join("/"):"";if(lr(f,d(n)))c.params[n]=f;else return null}return c}}function lr(i,e){const r=t=>t===i;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(i):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(i):!1}function Fs(i){const[e,r]=i.pattern.split("/*",2),t=e.split("/").filter(Boolean);return t.reduce((n,o)=>n+(o.startsWith(":")?2:3),t.length-(r===void 0?0:1))}function Ii(i){const e=new Map,r=Lr();return new Proxy({},{get(t,n){return e.has(n)||Si(r,()=>e.set(n,S(()=>i()[n]))),e.get(n)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(i())}})}function Ri(i){let e=/(\/?\:[^\/]+)\?/.exec(i);if(!e)return[i];let r=i.slice(0,e.index),t=i.slice(e.index+e[0].length);const n=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(t);)n.push(r+=e[1]),t=t.slice(e[0].length);return Ri(t).reduce((o,a)=>[...o,...n.map(s=>s+a)],[])}const Ds=100,Mi=Ci(),Ai=Ci(),js=()=>As(Pi(Mi),"<A> and 'use' router primitives can be only used inside a Route."),Ls=()=>js().navigatorFactory();function zs(i,e=""){const{component:r,preload:t,load:n,children:o,info:a}=i,s=!o||Array.isArray(o)&&!o.length,u={key:i,component:r,preload:t||n,info:a};return Ni(i.path).reduce((l,c)=>{for(const d of Ri(c)){const f=Ns(e,d);let p=s?f:f.split("/*",1)[0];p=p.split("/").map(g=>g.startsWith(":")||g.startsWith("*")?g:encodeURIComponent(g)).join("/"),l.push({...u,originalPath:c,pattern:p,matcher:Os(p,!s,i.matchFilters)})}return l},[])}function Us(i,e=0){return{routes:i,score:Fs(i[i.length-1])*1e4-e,matcher(r){const t=[];for(let n=i.length-1;n>=0;n--){const o=i[n],a=o.matcher(r);if(!a)return null;t.unshift({...a,route:o})}return t}}}function Ni(i){return Array.isArray(i)?i:[i]}function Oi(i,e="",r=[],t=[]){const n=Ni(i);for(let o=0,a=n.length;o<a;o++){const s=n[o];if(s&&typeof s=="object"){s.hasOwnProperty("path")||(s.path="");const u=zs(s,e);for(const l of u){r.push(l);const c=Array.isArray(s.children)&&s.children.length===0;if(s.children&&!c)Oi(s.children,l.pattern,r,t);else{const d=Us([...r],t.length);t.push(d)}r.pop()}}}return r.length?t:t.sort((o,a)=>a.score-o.score)}function cr(i,e){for(let r=0,t=i.length;r<t;r++){const n=i[r].matcher(e);if(n)return n}return[]}function Bs(i,e,r){const t=new URL($i),n=S(c=>{const d=i();try{return new URL(d,t)}catch{return console.error(`Invalid path ${d}`),c}},t,{equals:(c,d)=>c.href===d.href}),o=S(()=>n().pathname),a=S(()=>n().search,!0),s=S(()=>n().hash),u=()=>"",l=ne(a,()=>Ei(n()));return{get pathname(){return o()},get search(){return a()},get hash(){return s()},get state(){return e()},get key(){return u()},query:r?r(l):Ii(l)}}let lt;function qs(){return lt}function Vs(i,e,r,t={}){const{signal:[n,o],utils:a={}}=i,s=a.parsePath||(O=>O),u=a.renderPath||(O=>O),l=a.beforeLeave||Ti(),c=Ut("",t.base||"");if(c===void 0)throw new Error(`${c} is not a valid base path`);c&&!n().value&&o({value:c,replace:!0,scroll:!1});const[d,f]=Y(!1);let p;const g=(O,R)=>{R.value===h()&&R.state===m()||(p===void 0&&f(!0),lt=O,p=R,Cs(()=>{p===R&&(y(p.value),b(p.state),Ps(),x[1](F=>F.filter(V=>V.pending)))}).finally(()=>{p===R&&Oe(()=>{lt=void 0,O==="navigate"&&M(p),f(!1),p=void 0})}))},[h,y]=Y(n().value),[m,b]=Y(n().state),v=Bs(h,m,a.queryWrapper),k=[],x=Y([]),w=S(()=>typeof t.transformUrl=="function"?cr(e(),t.transformUrl(v.pathname)):cr(e(),v.pathname)),C=()=>{const O=w(),R={};for(let F=0;F<O.length;F++)Object.assign(R,O[F].params);return R},P=a.paramsWrapper?a.paramsWrapper(C,e):Ii(C),T={pattern:c,path:()=>c,outlet:()=>null,resolvePath(O){return Ut(c,O)}};return Z(ne(n,O=>g("native",O),{defer:!0})),{base:T,location:v,params:P,isRouting:d,renderPath:u,parsePath:s,navigatorFactory:_,matches:w,beforeLeave:l,preloadRoute:L,singleFlight:t.singleFlight===void 0?!0:t.singleFlight,submissions:x};function $(O,R,F){oe(()=>{if(typeof R=="number"){R&&(a.go?a.go(R):console.warn("Router integration does not support relative routing"));return}const V=!R||R[0]==="?",{replace:j,resolve:G,scroll:H,state:te}={replace:!1,resolve:!V,scroll:!0,...F},A=G?O.resolvePath(R):Ut(V&&v.pathname||"",R);if(A===void 0)throw new Error(`Path '${R}' is not a routable path`);if(k.length>=Ds)throw new Error("Too many redirects");const X=h();(A!==X||te!==m())&&(ks||l.confirm(A,F)&&(k.push({value:X,replace:j,scroll:H,state:m()}),g("navigate",{value:A,state:te})))})}function _(O){return O=O||Pi(Ai)||T,(R,F)=>$(O,R,F)}function M(O){const R=k[0];R&&(o({...O,replace:R.replace,scroll:R.scroll}),k.length=0)}function L(O,R){const F=cr(e(),O.pathname),V=lt;lt="preload";for(let j in F){const{route:G,params:H}=F[j];G.component&&G.component.preload&&G.component.preload();const{preload:te}=G;R&&te&&Si(r(),()=>te({params:H,location:{pathname:O.pathname,search:O.search,hash:O.hash,query:Ei(O),state:null,key:""},intent:"preload"}))}lt=V}}function Gs(i,e,r,t){const{base:n,location:o,params:a}=i,{pattern:s,component:u,preload:l}=t().route,c=S(()=>t().path);u&&u.preload&&u.preload();const d=l?l({params:a,location:o,intent:lt||"initial"}):void 0;return{parent:e,pattern:s,path:c,outlet:()=>u?I(u,{params:a,location:o,data:d,get children(){return r()}}):r(),resolvePath(p){return Ut(n.path(),p,c())}}}const Ws=i=>e=>{const{base:r}=e,t=_i(()=>e.children),n=S(()=>Oi(t(),e.base||""));let o;const a=Vs(i,n,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return i.create&&i.create(a),I(Mi.Provider,{value:a,get children(){return I(Hs,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[S(()=>(o=Lr())&&null),I(Ks,{routerState:a,get branches(){return n()}})]}})}})};function Hs(i){const e=i.routerState.location,r=i.routerState.params,t=S(()=>i.preload&&oe(()=>{i.preload({params:r,location:e,intent:qs()||"initial"})}));return I(ie,{get when(){return i.root},keyed:!0,get fallback(){return i.children},children:n=>I(n,{params:r,location:e,get data(){return t()},get children(){return i.children}})})}function Ks(i){const e=[];let r;const t=S(ne(i.routerState.matches,(n,o,a)=>{let s=o&&n.length===o.length;const u=[];for(let l=0,c=n.length;l<c;l++){const d=o&&o[l],f=n[l];a&&d&&f.route.key===d.route.key?u[l]=a[l]:(s=!1,e[l]&&e[l](),et(p=>{e[l]=p,u[l]=Gs(i.routerState,u[l-1]||i.routerState.base,vn(()=>t()[l+1]),()=>i.routerState.matches()[l])}))}return e.splice(n.length).forEach(l=>l()),a&&s?a:(r=u[0],u)}));return vn(()=>t()&&r)()}const vn=i=>()=>I(ie,{get when(){return i()},keyed:!0,children:e=>I(Ai.Provider,{value:e,get children(){return e.outlet()}})}),ke=i=>{const e=_i(()=>i.children);return _s(i,{get children(){return e()}})};function Ys([i,e],r,t){return[i,t?n=>e(t(n)):e]}function Js(i){let e=!1;const r=n=>typeof n=="string"?{value:n}:n,t=Ys(Y(r(i.get()),{equals:(n,o)=>n.value===o.value&&n.state===o.state}),void 0,n=>(!e&&i.set(n),sr.registry&&!sr.done&&(sr.done=!0),n));return i.init&&ye(i.init((n=i.get())=>{e=!0,t[1](r(n)),e=!1})),Ws({signal:t,create:i.create,utils:i.utils})}function Xs(i,e,r){return i.addEventListener(e,r),()=>i.removeEventListener(e,r)}function Zs(i,e){const r=i&&document.getElementById(i);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const Qs=new Map;function el(i=!0,e=!1,r="/_server",t){return n=>{const o=n.base.path(),a=n.navigatorFactory(n.base);let s,u;function l(h){return h.namespaceURI==="http://www.w3.org/2000/svg"}function c(h){if(h.defaultPrevented||h.button!==0||h.metaKey||h.altKey||h.ctrlKey||h.shiftKey)return;const y=h.composedPath().find(w=>w instanceof Node&&w.nodeName.toUpperCase()==="A");if(!y||e&&!y.hasAttribute("link"))return;const m=l(y),b=m?y.href.baseVal:y.href;if((m?y.target.baseVal:y.target)||!b&&!y.hasAttribute("state"))return;const k=(y.getAttribute("rel")||"").split(/\s+/);if(y.hasAttribute("download")||k&&k.includes("external"))return;const x=m?new URL(b,document.baseURI):new URL(b);if(!(x.origin!==window.location.origin||o&&x.pathname&&!x.pathname.toLowerCase().startsWith(o.toLowerCase())))return[y,x]}function d(h){const y=c(h);if(!y)return;const[m,b]=y,v=n.parsePath(b.pathname+b.search+b.hash),k=m.getAttribute("state");h.preventDefault(),a(v,{resolve:!1,replace:m.hasAttribute("replace"),scroll:!m.hasAttribute("noscroll"),state:k?JSON.parse(k):void 0})}function f(h){const y=c(h);if(!y)return;const[m,b]=y;n.preloadRoute(b,m.getAttribute("preload")!=="false")}function p(h){clearTimeout(s);const y=c(h);if(!y)return u=null;const[m,b]=y;u!==m&&(s=setTimeout(()=>{n.preloadRoute(b,m.getAttribute("preload")!=="false"),u=m},20))}function g(h){if(h.defaultPrevented)return;let y=h.submitter&&h.submitter.hasAttribute("formaction")?h.submitter.getAttribute("formaction"):h.target.getAttribute("action");if(!y)return;if(!y.startsWith("https://action/")){const b=new URL(y,$i);if(y=n.parsePath(b.pathname+b.search),!y.startsWith(r))return}if(h.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const m=Qs.get(y);if(m){h.preventDefault();const b=new FormData(h.target,h.submitter);m.call({r:n,f:h.target},h.target.enctype==="multipart/form-data"?b:new URLSearchParams(b))}}be(["click","submit"]),document.addEventListener("click",d),i&&(document.addEventListener("mousemove",p,{passive:!0}),document.addEventListener("focusin",f,{passive:!0}),document.addEventListener("touchstart",f,{passive:!0})),document.addEventListener("submit",g),ye(()=>{document.removeEventListener("click",d),i&&(document.removeEventListener("mousemove",p),document.removeEventListener("focusin",f),document.removeEventListener("touchstart",f)),document.removeEventListener("submit",g)})}}function tl(i){const e=i.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function rl(i){const e=()=>window.location.hash.slice(1),r=Ti();return Js({get:e,set({value:t,replace:n,scroll:o,state:a}){n?window.history.replaceState(Es(a),"","#"+t):window.history.pushState(a,"","#"+t);const s=t.indexOf("#"),u=s>=0?t.slice(s+1):"";Zs(u,o),qr()},init:t=>Xs(window,"hashchange",Is(t,n=>!r.confirm(n&&n<0?n:e()))),create:el(i.preload,i.explicitLinks,i.actionBase),utils:{go:t=>window.history.go(t),renderPath:t=>`#${t}`,parsePath:tl,beforeLeave:r}})(i)}var Bt={exports:{}},nl=Bt.exports,kn;function il(){return kn||(kn=1,function(i,e){(function(r,t){t()})(nl,function(){function r(l,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}function t(l,c,d){var f=new XMLHttpRequest;f.open("GET",l),f.responseType="blob",f.onload=function(){u(f.response,c,d)},f.onerror=function(){console.error("could not download file")},f.send()}function n(l){var c=new XMLHttpRequest;c.open("HEAD",l,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function o(l){try{l.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(c)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Ot=="object"&&Ot.global===Ot?Ot:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(l,c,d){var f=a.URL||a.webkitURL,p=document.createElement("a");c=c||l.name||"download",p.download=c,p.rel="noopener",typeof l=="string"?(p.href=l,p.origin===location.origin?o(p):n(p.href)?t(l,c,d):o(p,p.target="_blank")):(p.href=f.createObjectURL(l),setTimeout(function(){f.revokeObjectURL(p.href)},4e4),setTimeout(function(){o(p)},0))}:"msSaveOrOpenBlob"in navigator?function(l,c,d){if(c=c||l.name||"download",typeof l!="string")navigator.msSaveOrOpenBlob(r(l,d),c);else if(n(l))t(l,c,d);else{var f=document.createElement("a");f.href=l,f.target="_blank",setTimeout(function(){o(f)})}}:function(l,c,d,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof l=="string")return t(l,c,d);var p=l.type==="application/octet-stream",g=/constructor/i.test(a.HTMLElement)||a.safari,h=/CriOS\/[\d]+/.test(navigator.userAgent);if((h||p&&g||s)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var v=y.result;v=h?v:v.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=v:location=v,f=null},y.readAsDataURL(l)}else{var m=a.URL||a.webkitURL,b=m.createObjectURL(l);f?f.location=b:location.href=b,f=null,setTimeout(function(){m.revokeObjectURL(b)},4e4)}});a.saveAs=u.saveAs=u,i.exports=u})}(Bt)),Bt.exports}var ol=il();const Fi=Dr(ol);let Dh=async i=>{let e=i.vfs,r=new wi,t=async(n,o)=>{let a=o.contents;for(let s of a)switch(s.type){case"File":{let u=await new Promise(c=>{et(d=>{let f=o.openFileById(s.id);ae(()=>{let p=f();if(p.type=="Pending")return;if(d(),p.type=="Failed"){c(je(p.message));return}let g=p.value,h;if(g.name().toLowerCase().endsWith(".json"))h=new Blob([JSON.stringify(g.doc,void 0,2)],{type:"application/json"});else if(g.name().toLowerCase().endsWith(".ts"))h=new Blob([g.doc.source],{type:"application/typescript"});else{let y=g.doc.mimeType,m=g.doc.data;h=new Blob([m],{type:y})}c(de(h))})})});if(u.type=="Err")continue;let l=u.value;n.file(s.name,l);break}case"Folder":{let u=n.folder(s.name);if(u==null)continue;await new Promise(l=>{et(c=>{let d=o.openFolderById(s.id);ae(()=>{let f=d();if(f.type=="Pending")return;if(f.type=="Failed"){console.log(f.message),c(),l();return}let p=f.value;(async()=>(await t(u,p),c(),l()))()})})});break}}};et(n=>{let o=e.rootFolder();ae(()=>{let a=o();if(a.type!="Pending"){if(a.type=="Failed"){console.log(a.message),n();return}(async()=>{let s=a.value;await t(r,s);let u=await r.generateAsync({type:"blob"});Fi.saveAs(u,"kitty_export.zip"),n()})()}})})},al=async i=>{let e=i.vfs,r;{let t=await new Promise(n=>{et(o=>{let a=e.rootFolder();ae(()=>{let s=a();if(s.type=="Pending")return;if(s.type=="Failed"){o(),n(je(s.message));return}let u=s.value;oe(()=>{let l=u.contents;for(let c of l)u.removeFileOrFolderById(c.id)}),o(),n(de(u))})})});if(t.type=="Err")return t;r=t.value}{let t=await wi.loadAsync(i.file);async function n(o,a){let s;if(o=="")s=t;else{let c=t.folder(o);if(c==null)return;s=c}if(!s){console.warn(`Folder "${o}" not found in the zip.`);return}const u=[];s.forEach((c,d)=>{const f=o+(o&&!o.endsWith("/")?"/":"")+c;u.push({name:f,relativePath:c,isFolder:d.dir})});let l=[];for(let c of u)c.isFolder&&l.push(c.relativePath);for(const c of u)if(!l.some(d=>c.relativePath.startsWith(d))&&!c.isFolder){let d=t.file(c.name);if(d==null)continue;let f=await d.async("blob");if(c.relativePath.toLowerCase().endsWith(".json")){let p=await f.text(),g=JSON.parse(p);a.createFile(c.relativePath,g)}else if(c.relativePath.toLowerCase().endsWith(".ts")){let p=await f.text();a.createFile(c.relativePath,{source:p})}else{let p=new Uint8Array(await f.arrayBuffer());a.createFile(c.relativePath,{mimeType:f.type,data:p})}}for(const c of u)if(c.isFolder){let d=c.relativePath;d.endsWith("/")&&(d=d.slice(0,d.length-1));let f=a.createFolder(d);if(f.type=="Err")continue;let{id:p}=f.value;await new Promise(g=>{et(h=>{let y=a.openFolderById(p);ae(ne(y,m=>{if(m.type=="Pending")return;if(m.type=="Failed"){console.log(m.message),h(),g();return}let b=m.value;(async()=>(await n(c.name,b),h(),g()))()}))})})}}await n("",r)}return de({})};var sl=B('<div style=flex-grow:1;overflow:auto;><button class="btn btn-primary">Share Virtual File System</button><br><button class="btn btn-secondary">Delete Virtual File System</button><br><br><b>Links:</b><br><div><div><button class=btn>Kitty Demo</button><button class=btn>Pixel Editor</button><button class=btn>Level Builder</button><button class=btn>Music Editor</button><button class=btn>Model Editor</button><button class=btn>Script Editor</button><button class=btn>Colour Picker</button><button class=btn>Reactive Simulator</button><button class=btn>Vector Editor</button><button class=btn>Gravity Test</button><button class=btn>Three Body</button><button class=btn>Virtual File System Test</button><button class=btn>Automerge WebRTC Test</button><button class=btn>Connection Management</button><button class=btn>Debug Projection</button><button class=btn>App</button><button class=btn>Auto Forms Test'),ll=B('<button class="btn btn-primary">Import Virtual File System<input type=file hidden>');const cl=i=>{let e=Ls();return(()=>{var r=sl(),t=r.firstChild,n=t.nextSibling,o=n.nextSibling,a=o.nextSibling,s=a.nextSibling,u=s.nextSibling,l=u.nextSibling,c=l.nextSibling,d=c.firstChild,f=d.firstChild,p=f.nextSibling,g=p.nextSibling,h=g.nextSibling,y=h.nextSibling,m=y.nextSibling,b=m.nextSibling,v=b.nextSibling,k=v.nextSibling,x=k.nextSibling,w=x.nextSibling,C=w.nextSibling,P=C.nextSibling,T=P.nextSibling,$=T.nextSibling,_=$.nextSibling,M=_.nextSibling;return t.$$click=()=>{i.onShareVfs()},o.$$click=()=>{window.confirm("Are you sure you wish to delete your virtual file system?")&&i.onDeleteVfs()},W(r,()=>oe(()=>{let L;return(()=>{var O=ll(),R=O.firstChild,F=R.nextSibling;O.$$click=()=>{L.click()},F.addEventListener("change",()=>{let j=L.files;j!=null&&j.length==1&&al({file:j[0],vfs:i.vfs})});var V=L;return typeof V=="function"?he(V,F):L=F,O})()}),s),c.style.setProperty("margin-left","10px"),c.style.setProperty("margin-top","10px"),c.style.setProperty("display","inline-block"),d.style.setProperty("display","flex"),d.style.setProperty("flex-direction","column"),f.$$click=()=>e("/kitty-demo"),p.$$click=()=>e("/pixel-editor"),g.$$click=()=>e("/level-builder"),h.$$click=()=>e("/music-editor"),y.$$click=()=>e("/model-editor"),m.$$click=()=>e("/script-editor"),b.$$click=()=>e("/colour-picker"),v.$$click=()=>e("/reactive-sim"),k.$$click=()=>e("/vector-editor"),x.$$click=()=>e("/gravity-test"),w.$$click=()=>e("/three-body"),C.$$click=()=>e("/vfs-test"),P.$$click=()=>e("/automerge-webrtc-test"),T.$$click=()=>e("/connection-management"),$.$$click=()=>e("/debug-projection"),_.$$click=()=>e("/app"),M.$$click=()=>e("/auto-forms-test"),r})()};be(["click"]);class ul extends bs{peerId;peerMetadata}var ur={},nt={},Dt={},wn;function dl(){return wn||(wn=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.default=["other","new","good","old","little","great","small","young","long","black","high","only","big","white","political","right","large","real","sure","different","important","public","possible","full","whole","certain","human","major","military","bad","social","dead","true","economic","open","early","free","national","strong","hard","special","clear","local","private","wrong","late","short","poor","recent","dark","fine","foreign","ready","red","cold","low","heavy","serious","single","personal","difficult","left","blue","federal","necessary","general","easy","likely","beautiful","happy","past","hot","close","common","afraid","simple","natural","main","various","available","nice","present","final","sorry","entire","current","similar","deep","huge","rich","nuclear","empty","strange","quiet","front","wide","modern","concerned","green","very","alone","particular","bright","supposed","basic","medical","aware","total","financial","legal","original","international","soft","alive","interested","tall","warm","popular","tiny","top","normal","powerful","silent","religious","impossible","quick","safe","thin","familiar","gray","fresh","physical","individual","willing","crazy","sick","angry","perfect","tired","wild","moral","brown","dangerous","famous","married","terrible","successful","fair","professional","official","obvious","glad","central","chief","effective","light","complete","interesting","thick","proper","involved","responsible","narrow","civil","industrial","dry","yellow","specific","sharp","sudden","direct","following","growing","significant","traditional","slow","previous","vast","surprised","busy","usual","clean","funny","regular","scientific","ordinary","ancient","senior","sweet","future","annual","secret","equal","independent","wonderful","tough","broad","additional","careful","domestic","brief","enormous","commercial","grand","average","sexual","nervous","pale","immediate","critical","proud","like","complex","separate","considerable","still","extra","expensive","guilty","active","mad","asleep","wooden","cool","presidential","apparent","weak","essential","living","pretty","cultural","useful","actual","unusual","daily","potential","wet","solid","lovely","comfortable","formal","outside","massive","sad","corporate","distant","loose","rare","stupid","visible","liberal","flat","pleased","pure","curious","practical","upper","technical","male","appropriate","fat","just","due","mere","handsome","mental","conservative","positive","leading","naked","false","drunk","dirty","friendly","constant","well","used","emotional","internal","odd","historical","female","ill","broken","capable","southern","pleasant","bare","minor","eager","lucky","urban","steady","fiscal","rough","primary","reasonable","typical","inner","favorite","attractive","slight","innocent","limited","straight","pink","excellent","double","dramatic","violent","honest","electric","fellow","substantial","opposite","awful","severe","joint","armed","hungry","remarkable","increased","gentle","illegal","middle","bitter","mass","permanent","increasing","damn","golden","correct","intense","round","northern","proposed","so-called","criminal","healthy","plain","vital","blind","native","intellectual","unknown","extreme","existing","raw","prime","brilliant","sensitive","extraordinary","sufficient","remaining","ultimate","unique","royal","initial","negative","fundamental","nearby","smart","strategic","educational","unlikely","smooth","modest","conventional","giant","scared","cheap","dear","delicate","anxious","valuable","standard","desperate","lonely","diplomatic","firm","wise","principal","congressional","occasional","ugly","vice","radical","faint","working","absolute","intelligent","racial","mutual","silly","fast","musical","tight","complicated","numerous","crucial","square","contemporary","bloody","western","endless","inevitable","environmental","constitutional","rapid","worried","lost","genuine","temporary","democratic","rural","regional","given","painful","literary","chemical","sophisticated","decent","academic","awake","conscious","revolutionary","surprising","elderly","agricultural","psychological","pregnant","live","adequate","superior","grateful","prominent","frightened","remote","overall","stiff","harsh","electronic","spiritual","okay","closed","excited","convinced","long-term","unexpected","dull","evident","civilian","mysterious","romantic","impressive","continuing","exciting","logical","peculiar","exact","widespread","foolish","extensive","evil","continued","confident","generous","legislative","stable","vulnerable","elegant","embarrassed","hostile","efficient","blond","dumb","advanced","defensive","outer","neat","estimated","wealthy","dying","loud","creative","acceptable","unhappy","sheer","competitive","concrete","reluctant","precious","tremendous","burning","precise","uncertain","holy","artificial","vague","ideal","universal","moderate","subtle","mild","peaceful","assistant","invisible","casual","crowded","crude","running","classic","controversial","ridiculous","frequent","grim","accurate","detailed","goddamn","fun","fierce","cruel","incredible","blank","dim","suitable","classical","elaborate","collective","eastern","legitimate","aggressive","rear","administrative","automatic","dependent","ashamed","distinct","fit","clever","brave","ethnic","maximum","relative","primitive","uncomfortable","profound","sacred","biological","identical","furious","loyal","rational","mechanical","mean","naval","noble","ambitious","purple","historic","dominant","suburban","developing","calm","frozen","subsequent","charming","damp","fixed","rigid","offensive","electrical","shy","continuous","urgent","weary","immense","splendid","downtown","uneasy","disappointed","helpless","voluntary","polite","junior","gross","striking","overwhelming","unconscious","steep","outstanding","tender","tragic","costly","miserable","near","useless","welcome","external","helpful","weekly","middle-aged","suspicious","old-fashioned","technological","damned","awkward","visual","organized","ideological","orange","horrible","strict","magnificent","deadly","dusty","mighty","puzzled","bold","global","passing","magic","fond","judicial","missing","definite","changing","rubber","theoretical","satisfied","promising","abstract","excessive","comparable","fatal","distinguished","inadequate","slender","artistic","known","sympathetic","favorable","cheerful","faithful","delighted","unnecessary","sole","cautious","productive","reliable","patient","sensible","desirable","depressed","atomic","able","instant","relevant","alien","spectacular","lesser","swift","comic","enthusiastic","marvelous","experimental","weird","retired","fascinating","content","medieval","inclined","bored","ruling","flying","consistent","organic","alleged","grave","smiling","realistic","amazing","exotic","symbolic","confused","underground","spare","philosophical","vigorous","troubled","shallow","amused","lively","genetic","impatient","brutal","solar","unfair","formidable","tense","unfortunate","minimum","sleeping","secondary","shiny","jealous","insane","gay","vivid","wounded","hurt","intimate","monthly","sour","socialist","worthy","preliminary","colonial","middle-class","alternative","influential","unpleasant","comprehensive","devoted","upset","secure","absurd","neutral","frightening","profitable","fragile","civilized","slim","partial","added","fearful","optimistic","isolated","eternal","vocal","beloved","alert","verbal","rising","skilled","antique","municipal","written","restless","outdoor","governmental","driving","sore","informal","loving","retail","hidden","determined","monetary","convenient","thoughtful","colored","progressive","bizarre","sweeping","fancy","expected","fantastic","editorial","intact","bottom","multiple","well-known","nasty","protective","acute","combined","related","fortunate","earnest","divine","passionate","icy","noisy","vicious","dreadful","apt","boring","unprecedented","decisive","sunny","marked","experienced","disturbing","satisfactory","sober","random","electoral","shocked","deliberate","coming","orderly","surrounding","unwilling","inherent","mixed","naive","dense","hopeless","aesthetic","supreme","encouraging","institutional","solemn","stubborn","required","relaxed","bald","frantic","exclusive","rotten","filthy","flexible","explicit","glorious","lean","ignorant","extended","embarrassing","architectural","mortal","corrupt","hopeful","regulatory","valid","characteristic","tribal","capitalist","diverse","functional","improved","ironic","graceful","unaware","respectable","eligible","lousy","established","postwar","objective","wary","elementary","moving","superb","cute","minimal","meaningful","notable","structural","developed","rolling","fashionable","persistent","distinctive","terrific","thorough","skeptical","secular","chronic","level","everyday","visiting","infinite","short-term","terrorist","youthful","unemployed","forced","liquid","explosive","rude","colorful","renewed","semantic","astonishing","passive","heroic","gleaming","indifferent","vertical","prior","anonymous","absent","customary","mobile","uniform","solitary","probable","amazed","petty","bleak","athletic","tentative","harmless","ample","right-wing","polished","obscure","sincere","dried","intensive","equivalent","convincing","idle","vacant","mature","amusing","competent","ominous","savage","motionless","tropical","blunt","drunken","delicious","lazy","ragged","longtime","nationwide","startling","civic","freezing","muscular","circular","imperial","irrelevant","countless","gloomy","startled","disastrous","skinny","hollow","upward","ethical","underlying","careless","wholesale","abandoned","unfamiliar","mandatory","imaginary","bewildered","annoyed","magnetic","dazzling","lengthy","stern","surgical","clinical","full-time","metropolitan","moist","unlike","doubtful","prosperous","keen","awesome","humble","interior","psychiatric","clumsy","outraged","theatrical","educated","gigantic","scattered","privileged","sleepy","battered","meaningless","predictable","gradual","miniature","radioactive","prospective","aging","destructive","authentic","portable","bearded","balanced","shining","spontaneous","bureaucratic","inferior","sturdy","cynical","exquisite","talented","immune","imaginative","ripe","shared","kind","parliamentary","glowing","frail","astonished","forward","inside","operational","faded","closing","pro","coastal","shrewd","preoccupied","celebrated","wicked","bourgeois","marginal","transparent","dynamic","psychic","plump","coarse","bleeding","striped","eventual","residential","hysterical","pathetic","planned","fake","imminent","sentimental","stunning","worldwide","militant","sizable","representative","incapable","provincial","poetic","injured","tactical","selfish","winning","foul","repeated","novel","dubious","part-time","abrupt","lone","overseas","grey","varied","cooperative","muddy","scheduled","legendary","arrogant","conspicuous","varying","devastating","vulgar","martial","amateur","mathematical","deaf","scarce","specialized","honorable","outrageous","confidential","fallen","goddamned","five-year","feminine","monstrous","brisk","systematic","exhausted","frank","lunar","daring","shadowy","respected","stark","accepted","successive","pending","prolonged","unseen","uniformed","wretched","sullen","arbitrary","drastic","crooked","resulting","intricate","unpredictable","printed","utter","satisfying","delightful","linguistic","shabby","statistical","accessible","prestigious","trivial","waiting","futile","prepared","aged","misleading","cognitive","shocking","childish","elected","magical","forthcoming","exceptional","gifted","stricken","fiery","cardboard","shaky","conflicting","commanding","starving","accustomed","rocky","long-range","floating","sinister","potent","phony","lasting","understandable","curved","barren","lethal","toxic","deserted","ambiguous","notorious","synthetic","worthwhile","imported","intent","reduced","painted","taut","sociological","questionable","crisp","pointed","harmful","horizontal","rival","somber","benign","prevailing","selected","organizational","excess","dedicated","veteran","implicit","prudent","plausible","confusing","smoking","large-scale","subdued","constructive","marital","scarlet","rugged","darkened","untouched","above","matching","covert","communal","sticky","affluent","energetic","stale","controlled","qualified","reminiscent","shut","blonde","handy","ritual","straightforward","terminal","dizzy","sane","twisted","occupied","finished","opposing","sly","depressing","irregular","marine","communist","obscene","wrinkled","unsuccessful","gracious","static","consecutive","reserve","exposed","scholarly","sleek","reckless","oral","comforting","pressing","swollen","viable","carved","obsessed","projected","hideous","unthinkable","mock","susceptible","respective","goddam","downward","memorable","worn","raised","glittering","beneficial","lingering","patriotic","stunned","hairy","worrying","lighted","sexy","abundant","tangled","perpetual","irresistible","terrified","compelling","unmistakable","feeble","uneven","trained","folded","relentless","killed","gorgeous","conservation","serene","eerie","premature","dismal","competing","risky","unacceptable","indirect","witty","muffled","feasible","interstate","heated","uncommon","accidental","queer","innovative","parallel","fried","unnatural","cracked","persuasive","integrated","ongoing","homosexual","sound","fertile","canned","preceding","worldly","onstage","declining","advisory","juvenile","slippery","numb","postal","olive","eccentric","lay","chilly","shrill","ceremonial","registered","boiling","contradictory","irresponsible","then","industrialized","obsolete","rusty","inflationary","split","discreet","intolerable","barefoot","territorial","outspoken","audible","adverse","associate","impending","decorative","luminous","two-year","expanding","unchanged","outstretched","momentary","good-looking","cunning","overnight","sprawling","unbelievable","bland","liable","terrifying","televised","appealing","breathless","alarming","supporting","greasy","affirmative","guiding","homeless","triumphant","rainy","stolen","empirical","timid","provocative","knowledgeable","pragmatic","touching","desired","amiable","attempted","humane","adjacent","superficial","greedy","assorted","elusive","ruthless","lush","soothing","imposing","preferred","lavish","pervasive","managing","sandy","inappropriate","desolate","nude","reassuring","shimmering","first-class","unfinished","insistent","comparative","conceivable","admirable","courageous","aristocratic","meager","subjective","vain","disgusted","dual","towering","responsive","ailing","compact","torn","sortal","entertaining","dreary","metallic","tedious","irrational","immoral","teen-age","interim","jagged","selective","volatile","cozy","unanimous","unlimited","hired","cosmic","indoor","retarded","gold","fabulous","dignified","long-distance","high-school","classified","luxurious","insufficient","pious","incomplete","oblivious","imperialist","stately","lifelong","subordinate","extravagant","intrinsic","unpopular","scant","surplus","radiant","ruined","grotesque","hazardous","disabled","intriguing","worthless","reported","hoarse","utmost","muted","bony","disgusting","monumental","pleasing","sterile","agreeable","three-year","tricky","lucrative","respectful","inexpensive","bulky","troublesome","affectionate","coherent","unreasonable","nineteenth-century","curly","indispensable","nursing","incompetent","governing","alternate","suspected","left-wing","refined","overt","chilling","virtual","devoid","perverse","enduring","outright","overhead","unnoticed","nonprofit","pointless","appalling","dental","chosen","enlightened","robust","commonplace","damaging","conscientious","eloquent","erratic","applied","merry","ardent","flowing","incoming","chaotic","noticeable","pitiful","locked","swelling","definitive","homemade","super","pronounced","kindly","prone","attentive","unstable","unrelated","charitable","armored","unclear","tangible","medium","winding","slick","credible","frustrating","shifting","spacious","day-to-day","surviving","expanded","arid","unwanted","unbearable","hesitant","recognizable","multinational","abdominal","murderous","glossy","mute","working-class","insignificant","ingenious","masculine","blessed","gaunt","miraculous","unconstitutional","parental","rigorous","bodily","impersonal","backward","computerized","four-year","unmarried","wry","resident","luxury","high-level","partisan","powerless","seasonal","self-conscious","triple","onetime","ecological","periodic","racist","exaggerated","facial","erotic","unreal","durable","manual","rounded","concentrated","literal","mystical","stimulating","staggering","tempting","last-minute","erect","feudal","head","emerging","hind","brooding","candid","paranoid","defective","linear","immortal","shattered","unsure","swinging","compatible","ghastly","investigative","rosy","convicted","sensational","committed","makeshift","tolerant","forceful","supernatural","joyous","limp","improper","hanging","sliding","renowned","tattered","nonexistent","supportive","frustrated","undercover","handicapped","apprehensive","plentiful","authoritative","sustained","disappointing","hereditary","photographic","impoverished","ornate","respiratory","substantive","acting","nutritional","unofficial","innumerable","prevalent","dire","menacing","outward","brittle","hasty","sparkling","sled","geographical","therapeutic","melancholy","adolescent","hearty","disturbed","sweaty","poisonous","paid","ineffective","humorous","burly","rebellious","reddish","stout","teenage","eminent","rhythmic","physiological","guaranteed","opaque","folding","fleeting","full-scale","low-income","infectious","stringent","stained","beige","stirring","soaring","glamorous","airborne","improbable","austere","anticipated","designated","oval","restrictive","yearly","precarious","relieved","said","feverish","occupational","holding","speculative","abnormal","challenging","healing","boyish","forbidding","divorced","famed","sluggish","struggling","united","undesirable","steaming","consulting","answering","recreational","accompanying","cramped","journalistic","neighboring","fictional","chopped","phenomenal","bankrupt","illicit","advancing","upcoming","racing","protected","padded","venerable","fuzzy","behavioral","roast","mocking","reactionary","inefficient","packed","sloppy","sparse","foster","revealing","reverse","gaping","blue-collar","thankful","down","unimportant","traveling","corresponding","maternal","autonomous","conceptual","smoky","baked","stuffed","murky","totalitarian","ghostly","seeming","flickering","sensual","clenched","offshore","stinging","oppressive","strained","messy","executive","evolutionary","theological","damaged","unrealistic","rectangular","off","mainstream","benevolent","thirsty","blinding","loaded","applicable","unused","crushed","tan","factual","involuntary","brand-new","akin","scary","modified","mindless","born","feminist","integral","uncanny","aloof","spreading","watery","playful","stocky","wasted","compulsory","indignant","pertinent","incredulous","simultaneous","turbulent","framed","aching","falling","cardiac","trim","silvery","accused","pastoral","barbed","adjoining","inspired","courteous","skillful","majestic","gilded","published","perennial","upright","seasoned","continual","papal","victorious","optical","ecstatic","agonizing","shameful","expressive","inconsistent","insulting","cloudy","defiant","restricted","approaching","aggregate","orthodox","unified","all-out","wooded","nationalist","favored","lofty","assured","smug","earthly","improving","instrumental","stray","clandestine","managerial","animated","intended","flawed","bent","clerical","outgoing","righteous","unspoken","poignant","faulty","defeated","authoritarian","treacherous","catastrophic","refreshing","unidentified","suicidal","sickly","disciplined","meticulous","preferable","trusted","hectic","husky","distraught","select","snowy","ferocious","crumpled","humiliating","divided","crippled","infamous","chic","broke","sovereign","continental","idealistic","first-rate","guarded","learned","nameless","runaway","metaphysical","senseless","boiled","needy","silver","recorded","polar","real-estate","stormy","incomprehensible","wiry","raging","composite","flamboyant","crimson","reproductive","intermediate","ubiquitous","repressive","hefty","listening","good-natured","parochial","stylish","high-tech","flaming","coronary","overweight","bathing","three-day","tidy","beleaguered","manifest","ludicrous","indigenous","adamant","placid","inept","exuberant","stony","salty","seductive","accomplished","impassive","grazing","congenial","misguided","wide-eyed","revised","bass","sonic","budgetary","halfway","ensuing","admiring","palpable","nightly","hooded","best-known","eighteenth-century","dissident","morbid","incumbent","demanding","inexperienced","hazy","revolving","rented","disadvantaged","innate","dietary","minute","cultivated","sealed","contemptuous","rhetorical","conciliatory","articulate","jobless","macho","forgotten","lifeless","proven","latent","secretive","perilous","token","graphic","alcoholic","overdue","permissible","shattering","preventive","illiterate","back","atmospheric","thermal","quaint","negotiated","preposterous","temporal","restrained","triangular","mayoral","spatial","heady","biblical","fitting","pessimistic","mammoth","allied","failed","intuitive","nagging","tidal","angular","speechless","finishing","protracted","watchful","businesslike","automated","versatile","booming","pouring","misty","deceptive","sunken","singular","suspended","unworthy","immigrant","expressionless","airy","mournful","neurotic","cubic","unauthorized","economical","fund-raising","captive","blatant","far-reaching","subversive","imperfect","jolly","inaccurate","resentful","strenuous","suffering","hardened","malicious","unjust","perceptive","newborn","promised","differing","virgin","alarmed","grassy","frivolous","apologetic","wasteful","endangered","unarmed","adept","unavoidable","approved","trembling","stuck","high-ranking","crushing","prescribed","dependable","fragrant","expansive","unfriendly","covered","bemused","digital","probing","sloping","man-made","festive","unilateral","unmarked","bipartisan","statewide","burgeoning","devout","sickening","mediocre","adventurous","elevated","suggestive","accountable","virtuous","lame","heavenly","bruised","unbroken","irritable","affected","inconceivable","sometime","vile","baggy","timely","glistening","imagined","unprepared","unresolved","windy","humanitarian","overriding","detached","annoying","narrative","interminable","appalled","penal","unsatisfactory","instinctive","variable","cumulative","obedient","deficient","colossal","unaffected","extinct","routine","microscopic","compassionate","nominal","forlorn","distorted","mistaken","enclosed","infected","fervent","analogous","frigid","instructive","appointed","one-way","gnarled","problematic","sardonic","two-hour","hypothetical","prompt","anguished","electromagnetic","sensuous","homely","beaten","malignant","rotting","concealed","peripheral","creaking","impeccable","khaki","grinning","irreversible","rampant","wondrous","inward","manufactured","grisly","cooked","discriminatory","cerebral","knowing","auxiliary","operative","losing","genial","phonetic","ecclesiastical","sarcastic","incorrect","ruddy","well-to-do","inexplicable","unreliable","developmental","woolen","agitated","lyrical","consequent","calculated","molecular","pompous","present-day","shaggy","even","inhuman","sublime","diagnostic","manly","raucous","balding","after","bilateral","mounted","blackened","assembled","separated","gaudy","evangelical","darling","juicy","impotent","receptive","irritating","pulmonary","dazed","cross-country","unavailable","parked","habitual","lexical","lowered","unwise","planetary","throbbing","enigmatic","superstitious","threatening","manned","childlike","sporting","right-hand","adult","reflective","white-haired","discernible","celestial","prodigious","translucent","equitable","epic","frayed","arduous","flimsy","penetrating","howling","disparate","alike","all-time","deformed","comical","inert","procedural","resistant","vibrant","geographic","wistful","specified","rightful","spirited","unborn","enjoyable","regal","cumbersome","burned","frenzied","gubernatorial","deteriorating","haunted","evasive","neglected","anthropological","inescapable","clear-cut","visionary","bloated","accumulated","agrarian","pained","dwindling","heightened","gray-haired","distressing","grinding","insecure","archaic","piercing","fluent","leisurely","giddy","slimy","oncoming","short-lived","spinal","wholesome","unanswered","illegitimate","staunch","two-day","rumpled","speedy","soaked","rocking","invaluable","gallant","tacit","finite","inviting","sporadic","powdered","cheery","volcanic","optional","mischievous","flowered","contagious","automotive","inflated","mythic","analytical","infrared","two-week","binding","ancestral","dissatisfied","upstate","veritable","unaccustomed","oily","monotonous","seated","feeding","fluorescent","undue","impassioned","picturesque","vocational","tranquil","tumultuous","rustic","patterned","two-story","pagan","flash","playing","exhilarating","maiden","three-dimensional","mythical","thriving","drab","black-and-white","honorary","dingy","founding","imperative","indistinguishable","lightweight","avid","dreamy","everlasting","obsessive","tional","homogeneous","inner-city","changed","tame","colorless","haggard","implacable","altered","unequal","focal","perceptual","literate","priceless","diminishing","harmonious","dark-haired","fatty","squat","undecided","banal","fruitful","pioneering","innocuous","cordial","rewarding","unsafe","maritime","overcrowded","timeless","fledgling","nostalgic","abreast","one-time","humid","astronomical","one-man","deepening","blazing","fleshy","dishonest","succeeding","qualitative","needless","rickety","joyful","stated","ambivalent","hybrid","six-month","limiting","workable","sleepless","unpaid","mundane","flashy","stagnant","bumper","recurring","sinful","immaculate","synonymous","measured","thrilling","long-standing","unruly","bewildering","unfit","edgy","numerical","sumptuous","fragmented","puffy","elastic","high-pitched","momentous","woven","unsteady","unnamed","cosmetic","snap","impenetrable","floral","waving","promotional","tenuous","lonesome","embroidered","strident","cherished","aghast","fundamentalist","white-collar","afloat","disruptive","law-enforcement","gathered","indefinite","intervening","publicized","geometric","disciplinary","descriptive","wavy","edible","disgruntled","obligatory","untrue","amber","snug","resolute","awed","simplistic","grandiose","crippling","high-speed","mounting","glaring","small-town","cavernous","hushed","wage-price","demographic","diseased","unpublished","causal","defenseless","sheltered","dormant","compulsive","loved","willful","truthful","punitive","disposable","ajar","drowsy","statutory","tanned","proprietary","informed","unheard","decision-making","transient","unlawful","dour","negligible","underwater","optimum","illusory","imaginable","borrowed","divergent","looking","exempt","contentious","forbidden","cowardly","masked","crazed","silken","parched","furry","wandering","insensitive","over-all","elated","waxed","veiled","envious","insidious","scrawny","unwarranted","lithe","abrasive","pretentious","far-off","murdered","deft","prickly","musty","shapeless","incongruous","gruesome","honored","perceived","grieving","unspecified","dizzying","privy","noteworthy","charred","median","fearless","twisting","unattractive","flawless","welcoming","flushed","hardy","glum","scenic","devious","recurrent","distasteful","jubilant","ballistic","hilarious","naughty","bustling","discarded","pristine","exemplary","fading","complacent","incessant","engaging","twentieth-century","protectionist","rudimentary","traumatic","steamy","emphatic","hard-line","teeming","generating","stuffy","connecting","stationary","genteel","populist","supple","hateful","retrospective","glazed","lawful","arched","tiresome","lucid","reserved","pivotal","grimy","surly","anti-Soviet","contrary","quarterly","old-time","residual","spiral","decaying","threatened","docile","appreciative","jovial","fascist","worrisome","red-haired","undisturbed","creamy","well-dressed","serial","existential","mountainous","pastel","self-sufficient","spoken","express","tasty","maroon","infrequent","deceased","full-fledged","transitional","leafy","gravitational","furtive","prophetic","nasal","unwelcome","troubling","immobile","merciful","uncontrollable","impartial","unfavorable","attendant","associated","high-rise","vascular","fateful","concerted","rash","stubby","paramount","impulsive","fraudulent","drooping","reciprocal","usable","fast-food","touchy","astute","oversized","mottled","slack","fruitless","unhealthy","decorated","shady","shaped","fanciful","quivering","charismatic","sordid","oppressed","inaccessible","fastidious","brazen","gloved","crumbling","underdeveloped","scarred","rambling","incipient","remedial","derelict","incompatible","fanatical","smoked","secondhand","hypnotic","failing","marching","flattened","paradoxical","unskilled","esthetic","tolerable","pungent","substitute","soggy","terse","tiring","fictitious","manageable","inventive","haughty","normative","premier","grudging","vested","exhausting","cross-legged","self-evident","away","horrified","prolific","incoherent","quantitative","full-length","year-round","unkind","provisional","exterior","brash","inconclusive","landed","breathtaking","acrid","noted","resultant","long-time","resounding","lovable","hypocritical","plush","foggy","acknowledged","idiotic","tracking","ceramic","taxable","enterprising","flashing","wee","barbaric","deafening","orbital","lurid","dated","hated","buoyant","mating","pictorial","overlapping","lax","archetypal","manic","limitless","puzzling","condescending","hapless","meek","faceless","uncommitted","horrid","greenish","unorthodox","unending","accelerated","day-care","undeniable","bushy","searing","fearsome","unharmed","divisive","overpowering","diving","telling","determining","uptight","cast","enlarged","ebullient","disagreeable","insatiable","grown-up","demented","puffing","inconvenient","uncontrolled","inland","repulsive","unintelligible","blue-eyed","pallid","nonviolent","dilapidated","unyielding","astounded","marvellous","low-cost","purposeful","courtly","predominant","conversational","erroneous","resourceful","converted","disconcerting","oblique","dreaded","indicative","silky","six-year","front-page","biting","flowering","sunlit","licensed","unspeakable","adrift","awash","identifiable","girlish","zealous","spooky","uncompromising","deserving","driven","certified","unlucky","temperate","budding","impractical","public-relations","inflexible","sensory","pornographic","outlandish","resonant","belligerent","wan","leftover","spotted","soybean","easygoing","vengeful","proportional","inaugural","dank","screaming","heterosexual","sliced","year-old","considerate","thunderous","distressed","warring","assertive","foreseeable","psychotic","intermittent","anti-Communist","generalized","unable","molten","excruciating","illustrious","voluminous","offending","trustworthy","grating","laughing","one-year","industrious","uninterrupted","dashing","speaking","metabolic","flattering","one-sided","ineffectual","primal","digestive","taped","floppy","jaunty","practiced","walled","hospitable","dutiful","melodramatic","intestinal","cluttered","conclusive","complementary","unprotected","buzzing","attributable","tasteless","forthright","wily","hourly","delayed","sweating","affable","studied","chubby","thyroid","chilled","conducive","childless","faltering","authorized","buried","land-based","observable","hurried","curving","dismayed","pernicious","upturned","believable","questioning","syndicated","pharmaceutical","high-risk","resigned","discrete","likable","imprisoned","cocky","outdated","autocratic","ablaze","askew","grammatical","wintry","incidental","matter-of-fact","disputed","exorbitant","low-level","sodden","skeletal","disproportionate","soiled","cellular","ephemeral","perfunctory","inconsequential","flourishing","intentional","two-way","elemental","whispered","four-day","stinking","informative","tenacious","outlying","virulent","horrendous","horrifying","burnt","longstanding","senile","unmoving","deprived","interpersonal","intimidating","posh","dainty","portly","nondescript","inquisitive","exiled","capricious","scandalous","severed","debilitating","widowed","horny","sallow","up-to-date","self-contained","carefree","boisterous","coordinated","anti-Semitic","superfluous","metric","expressed","enchanting","disorderly","paternal","wanton","frightful","free-lance","extremist","lined","scornful","inseparable","obese","ponderous","imperious","indistinct","adrenal","belated","rippling","valiant","livid","mystic","cracking","subterranean","invading","rusted","esoteric","red-faced","segregated","lanky","departmental","allergic","predatory","enforced","anti-inflation","implied","flagrant","best-selling","haphazard","trailing","seedy","real-life","unannounced","utilitarian","roving","despairing","immature","simulated","embattled","poisoned","patronizing","baffled","centralized","weathered","weeping","mutilated","painstaking","tax-exempt","socioeconomic","tearful","stringy","projecting","low-key","single-minded","shadowed","vehement","darn","fluffy","apocalyptic","completed","intelligible","furnished","elongated","worsening","eclectic","bacterial","earthy","sagging","wide-ranging","face-to-face","settled","dogmatic","anti","secluded","baffling","coy","pathological","echoing","bridal","autobiographical","instantaneous","ornamental","satirical","voluptuous","movable","kinetic","merciless","tireless","three-month","unconcerned","impromptu","turning","follow-up","retaliatory","arcane","waterproof","justifiable","glassy","unearthly","shuttered","inverted","bogus","petrified","simmering","guided","gritty","widening","generic","pretrial","returning","boundless","swirling","northeastern","swell","tive","minuscule","estranged","upbeat","explanatory","repetitive","repressed","vindictive","shrinking","canny","little-known","hydraulic","unrelenting","looming","supersonic","justified","lukewarm","unmoved","blurred","double-breasted","sanitary","unforgettable","diligent","unconventional","ashen","wordless","stainless","inlaid","irritated","spotless","pudgy","yellowish","lateral","adopted","lowly","obnoxious","utopian","called","unimaginable","hairless","foregoing","opulent","garish","nocturnal","rousing","unexplained","cosmopolitan","milky","medium-sized","all-night","bloodshot","rueful","hard-working","crafty","familial","iced","violet","arctic","ceaseless","exasperated","warped","aquatic","gruff","terrestrial","contrasting","egalitarian","needful","spent","untrained","escalating","liberated","long-haired","abortive","syntactic","consummate","lumpy","spoiled","ten-year-old","talkative","whimsical","weighty","audio","inflammatory","deplorable","spicy","corrugated","morose","sobering","southwestern","three-year-old","methodical","prehistoric","carpeted","smelly","processed","overheated","interstellar","agile","approximate","sadistic","living-room","irate","smashed","frontal","venereal","indiscriminate","suggested","cultured","creeping","recognized","toothless","handmade","mellow","fetal","disinterested","gratifying","trusting","small-scale","intravenous","crashing","exhaustive","afire","clammy","sleazy","florid","heartless","transcendent","restored","demonic","abusive","avowed","shrunken","objectionable","tailored","arms-control","listless","polluted","palatable","funded","elective","entrenched","classy","operatic","daunting","roaring","preferential","languid","three-hour","virile","inspiring","enhanced","scrupulous","bottomless","ginger","wispy","advantageous","rapt","umbilical","uphill","ordered","enraged","detrimental","curt","exalted","hard-pressed","intangible","fussy","forgiving","facile","populous","condemned","mashed","hard-boiled","introductory","rowdy","switching","perplexing","spilled","southeastern","undulating","fractured","inherited","inscrutable","measurable","stunted","hormonal","stylized","hierarchical","air-conditioned","aimless","subsidized","paying","symmetrical","nomadic","cloudless","reigning","thatched","perceptible","anesthetic","anti-American","miscellaneous","homesick","preparatory","seven-year","big-city","decadent","searching","all-important","inanimate","senatorial","diminutive","soft-spoken","contingent","dusky","smashing","precipitous","bulging","standardized","biographical","restive","indecent","upper-class","ecumenical","interchangeable","lumbering","fascinated","untidy","indulgent","leaden","wanted","endemic","doomed","wanting","receiving","engaged","unparalleled","abbreviated","malevolent","wishful","carnival","world-wide","protruding","resplendent","stranded","structured","biased","frosty","northwestern","viral","mindful","paved","indeterminate","painless","second-floor","geological","permissive","downhill","unsuspecting","expectant","fabled","jittery","windowless","evocative","unsolved","disoriented","monastic","soluble","misshapen","antiquated","repugnant","non-Communist","retiring","shaded","combative","high-powered","resilient","antagonistic","starched","vice-presidential","speckled","lopsided","bluish","late-night","prim","unrestrained","almighty","tyrannical","unkempt","menstrual","bleached","overgrown","idiosyncratic","shoddy","hallowed","trying","halting","princely","drugged","gratuitous","descending","fatherly","avant-garde","laborious","pinched","disguised","caustic","bespectacled","handwritten","goodly","itinerant","cryptic","undisclosed","affordable","outmoded","expedient","moody","tepid","firsthand","digging","elitist","observed","chartered","slain","five-day","unimpressed","tactful","idyllic","prostrate","ramshackle","expert","deferred","undistinguished","prized","transatlantic","crystalline","tacky","haunting","nutritious","bereft","turquoise","time-consuming","sanguine","culinary","fraught","precocious","assigned","scrambled","advisable","nationalistic","long-awaited","unwrapped","unchallenged","circumstantial","pleasurable","compressed","humanistic","unforeseen","diversified","frenetic","disapproving","proletarian","conspiratorial","featureless","going","commendable","no-nonsense","chipped","surreal","salient","pissed","insurmountable","backstage","contented","indebted","adoring","one-room","prewar","potted","accelerating","thorny","possessive","abiding","ever-increasing","bloodless","high-technology","counterproductive","attracting","entrepreneurial","cooling","unoccupied","craggy","leathery","degenerate","additive","weakened","quilted","untold","incandescent","intractable","middle-income","abject","self-made","gaseous","anal","displaced","unabashed","immutable","fluttering","ten-year","bearable","stamped","darkening","beefy","petite","charging","high-quality","left-hand","age-old","checkered","stupendous","priestly","loath","endearing","exacting","correctional","freak","sneaky","disgraceful","unholy","oriental","wayward","societal","hard-core","bilingual","flipping","staid","paramilitary","heartfelt","shapely","kosher","heedless","incurable","controlling","in-house","choral","manicured","cardinal","inconspicuous","steely","vanishing","misplaced","centre-fire","enchanted","unfounded","wrecked","womanly","delirious","deposed","panicky","differential","tawny","articulated","coded","wide-open","unregulated","lenient","feathered","simplified","beguiling","sectarian","producing","tiled","inorganic","frosted","lusty","scented","rotating","grievous","dissimilar","salaried","unequivocal","strangled","grubby","alluring","downcast","restraining","unjustified","contaminated","lacy","cinematic","second-class","splintered","adorable","derisive","state-owned","requisite","fleeing","uncomplicated","motherly","inter","high-heeled","climatic","republican","unqualified","leveraged","intercontinental","uncharacteristic","compositional","unwritten","patriarchal","brusque","unresponsive","replete","corrective","reflected","scraping","doctoral","premium","deductible","alternating","amorous","overjoyed","recalcitrant","presumptuous","vaulted","declared","inexorable","groggy","diminished","restful","retroactive","presumed","monolithic","curtained","tortured","ground","trendy","brassy","prosaic","inactive","chaste","bumpy","aggrieved","corny","centrist","trapped","noxious","jerky","concomitant","withholding","poorly","stolid","unguarded","methodological","primordial","retreating","telescopic","sidelong","off-duty","pleated","dissenting","agreed","double-action","optimal","plaintive","banned","kindred","quintessential","impervious","jumping","disenchanted","observant","congested","second-rate","reasoned","extrinsic","infantile","transitory","coveted","small-time","doctrinal","incomparable","jaded","special-interest","sociable","shameless","coloured","ascending","fraternal","queasy","wont","exhilarated","salted","disquieting","listed","unchanging","nine-year-old","unrestricted","uppermost","reputable","dummy","skimpy","crusty","corrosive","bubbling","decrepit","unsuitable","snarling","destitute","illuminating","systemic","material","unwashed","rushing","dialectical","jeweled","attached","liberating","judicious","errant","vanished","worn-out","erstwhile","uninformed","twelve-year-old","longterm","petulant","twin","self-righteous","afflicted","snappy","tantamount","sworn","unethical","drained","hydroelectric","perplexed","logistical","concentric","unifying","lunatic","invincible","diffident","inexhaustible","discouraging","dreamlike","artful","rolled","suppressed","secretarial","smoldering","redundant","forensic","million-dollar","self-styled","earned","weightless","signed","compensatory","glacial","unmanned","stalwart","funky","intensified","uninterested","submerged","urbane","glib","ascetic","contractual","warlike","high-priced","diagonal","cylindrical","gargantuan","illuminated","unconditional","hulking","supplementary","dictatorial","puny","sedate","moonlit","eight-year-old","gullible","counterfeit","alienated","spinning","analytic","nimble","adaptive","individualistic","numbered","blissful","insolent","supplemental","delectable","inordinate","unbalanced","tormented","unchecked","aspiring","punishing","self-serving","crossed","discretionary","box-office","snow-covered","improvised","squalid","orphaned","grizzled","unsmiling","disappearing","affiliated","readable","blocking","bullish","contending","burned-out","bloodied","subsidiary","complimentary","unclean","scanty","uprooted","farfetched","solicitous","regulated","threadbare","choppy","ever-present","negligent","nonstop","one-day","wild-eyed","infuriating","vivacious","abominable","wrought","inaudible","braided","transcendental","desultory","climactic","appellate","interlocking","submissive","unmatched","dapper","demeaning","adaptable","well-meaning","lustrous","tax-free","ungrateful","gentlemanly","missed","loathsome","incalculable","blistering","amenable","tremulous","massed","nonpartisan","unsettled","three-story","succulent","trite","masterful","reticent","unsettling","proverbial","strapping","spurious","invulnerable","paltry","embryonic","repeating","neural","sultry","metaphorical","foreign-policy","linked","pubic","beaming","ministerial","phantom","quizzical","hilly","cold-blooded","gregarious","three-piece","untroubled","bisexual","pensive","unpretentious","exploratory","unscathed","irrepressible","pelvic","newfound","starry","corned","overworked","illogical","unfaithful","interrelated","saintly","overcast","connected","ungainly","organizing","carnal","philosophic","nationalized","fickle","ultraviolet","crass","undeveloped","unprofitable","sheepish","archaeological","out-of-town","balmy","spongy","infallible","callous","scathing","rheumatic","audacious","participating","swarthy","hand-held","comatose","modernist","stellar","antinuclear","delinquent","time-honored","presiding","relaxing","high-pressure","impetuous","hypodermic","fringed","favourite","unscrupulous","inspirational","mystified","wobbly","intrepid","deferential","burdensome","stored","supervisory","seventeenth-century","six-day","interdependent","updated","all-powerful","unitary","stand-up","laconic","penniless","steadfast","dogged","scholastic","convertible","mingled","sorrowful","symptomatic","stylistic","well-intentioned","consuming","sketchy","weakening","generative","atrocious","first-quarter","irrevocable","charged","stoned","dividing","apathetic","debatable","uncomprehending","overhanging","galloping","kinky","uncritical","suave","undisputed","spiky","inarticulate","extracurricular","guttural","impressed","departing","yellowed","discontented","adroit","high-fiber","second-hand","blinking","formless","unsavory","new-found","withered","collected","menial","unobserved","flabby","afterward","vanquished","stained-glass","hour-long","bittersweet","invalid","incriminating","commensurate","all-American","assumed","tried","cursory","absorbing","clearing","confirmed","stressful","depleted","eight-year","participatory","stripped","concave","regrettable","fortified","effortless","regressive","irreverent","collegiate","defunct","grainy","inhospitable","gripping","grizzly","restoring","arterial","busted","indomitable","demure","rabid","headlong","blue-green","bound","breezy","materialistic","uneducated","scruffy","cohesive","full-blown","cranky","motivated","mauve","hardworking","melodic","genital","decorous","comely","rife","purported","hurtful","six-foot","macabre","odious","convulsive","well-trained","heterogeneous","curled","pearly","spindly","latter-day","innermost","clipped","checked","masterly","laughable","naturalistic","tinkling","impudent","fitful","illustrated","speeding","roasted","in-depth","helluva","vigilant","empty-handed","forged","wrought-iron","disgraced","agonized","infirm","preserving","tasteful","onerous","shredded","impregnable","slanted","tainted","opened","first-time","machine-gun","bottled","seismic","fetid","saturated","insubstantial","full-page","aromatic","stingy","promiscuous","unlit","regimental","spellbound","streamlined","bereaved","ruffled","creepy","treasured","ensconced","one-party","well-educated","pert","mercantile","all-purpose","voracious","tortuous","despised","unadorned","offhand","qualifying","manipulative","indelible","well-established","revolting","ethereal","roasting","prohibitive","domed","whipped","overstuffed","garrulous","skittish","revived","heartening","jumpy","grilled","melted","unfocused","spectral","unproductive","top-level","life-size","three-way","negotiable","disloyal","turn-of-the-century","four-hour","unopened","devilish","amorphous","antiseptic","sharpened","primeval","unrecognizable","ineligible","expendable","deathly","auspicious","insoluble","inimical","unquestioned","far-flung","medicinal","deep-seated","formative","iridescent","fragmentary","distinguishable","auburn","closed-circuit","emeritus","third-floor","hazel","tumbling","departed","obstinate","portentous","quixotic","scorched","adjustable","winged","intrusive","taxing","high-ceilinged","barbarous","decreasing","sleeveless","unattended","tight-lipped","concluding","unobtrusive","starved","quirky","big-time","sooty","copious","stalled","scriptural","unconvincing","earthen","throaty","august","extant","sexist","exultant","cancerous","psychedelic","yielding","matched","chunky","unfathomable","concise","admitting","knitted","projective","euphoric","garbled","divisional","despondent","recommended","passable","vegetarian","indefatigable","irreparable","feisty","untenable","contrite","angelic","reputed","untimely","dejected","appreciable","remembered","hellish","rear-view","open-air","ill-fated","nonpolitical","factional","separatist","contributing","post-war","uneventful","metaphoric","unsound","unwitting","venomous","harried","engraved","collapsing","reformist","thematic","inclusive","cheering","springy","obliging","contemplative","unbridled","state-run","reflex","allegorical","geopolitical","disembodied","issuing","bountiful","alright","overbearing","muddled","congenital","distinguishing","absorbed","tart","french","autumnal","verifiable","grueling","crackling","aft","punishable","freckled","indestructible","imprecise","hard-nosed","thoughtless","through","proficient","pent-up","never-ending","hunted","defensible","arresting","across-the-board","spotty","orchestral","undefined","stacked","implausible","antitank","unwary","inflamed","sacrificial","oil-producing","leaky","mint","chronological","conquering","jumbo","three-week","addictive","uninhibited","substandard","contracting","degenerative","triumphal","flowery","cardiovascular","shaken","undefeated","unassuming","luscious","unperturbed","gleeful","sentencing","brawny","perfumed","mild-mannered","healthful","left-handed","rancid","well-defined","unmanageable","drowning","clinging","anachronistic","revered","enriched","capitalistic","good-by","invigorating","practicing","unsold","long-legged","unruffled","aboriginal","inane","bedraggled","early-morning","run-down","straight-backed","reverent","acquired","bestselling","top-secret","woolly","foolhardy","sticking","blue-black","impassable","overcome","coiled","front-line","tinted","acquisitive","slatted","octagonal","receding","investing","doctrinaire","all-white","caring","prejudiced","slow-moving","circulating","science-fiction","shortsighted","disaffected","lawless","chastened","lewd","rubbery","foaming","unsympathetic","ladylike","betrayed","neurological","shouting","good-sized","electrostatic","untoward","flabbergasted","citywide","unanticipated","knotted","whitewashed","year-end","enticing","migratory","multicolored","hashish","ascorbic","topless","heathen","spherical","filmy","deviant","centennial","proportionate","instructional","contrived","savvy","over-the-counter","fast-moving","measuring","uptown","compliant","favourable","unforgivable","undamaged","psychoanalytic","gebling","bubbly","ready-made","caged","ostentatious","superhuman","busing","cream-colored","self-destructive","ostensible","cobbled","whirling","released","showy","baleful","red-hot","named","monogamous","fallow","disdainful","cyclical","long-running","pitiless","diffuse","omnipresent","mossy","cutting","astounding","lyric","dark-blue","unsophisticated","indigent","coincidental","imperceptible","veterinary","coercive","multilateral","ageless","law-abiding","functioning","beneficent","crawling","overturned","steamed","comprehensible","oil-rich","undetected","ribbed","nautical","textured","fast-growing","nauseous","vaunted","paralyzed","maimed","short-range","impure","unintended","practicable","intermediate-range","unfulfilled","behind-the-scenes","backhand","voluble","goofy","apolitical","contraceptive","waning","blasted","sundry","profane","binary","rock-and-roll","ruinous","open-ended","next-door","withering","conical","flustered","decided","able-bodied","round-trip","decreased","half-empty","sponsored","riotous","stereotyped","five-minute","irreplaceable","harrowing","uninteresting","salutary","frugal","disjointed","cupped","freshwater","shaven","ravenous","bulbous","stepped-up","swaying","two-room","valued","planted","bright-eyed","unreadable","trucking","infatuated","dysfunctional","pinkish","futuristic","airtight","unseemly","sizzling","mercurial","conic","unfettered","undisciplined","unrecognized","well-publicized","income-tax","self-appointed","ice-cold","biochemical","contemptible","barefooted","droll","mythological","tree-lined","rearing","luxuriant","heartbreaking","tufted","well-organized","selfless","world-class","unwieldy","contested","rasping","downright","ingratiating","self-proclaimed","parasitic","graying","reformed","cautionary","untested","beaded","maniacal","eucalyptus","pliable","air-conditioning","moot","traceable","anti-abortion","antisocial","reprehensible","self-imposed","yellowing","teasing","porous","ersatz","unwavering","untouchable","underprivileged","auditory","escaping","subservient","unspoiled","anterior","fatuous","lordly","infernal","bouncing","taboo","orthopedic","spiteful","surging","nuts","esteemed","outlawed","pushy","displeased","self-confident","attainable","bowed","cast-iron","despicable","unconvinced","famished","coed","bygone","nonaligned","sectional","typed","squeaky","disparaging","cut-rate","heart-shaped","offbeat","velvety","well-worn","upsetting","leery","long-lost","horse-drawn","puritanical","payable","fertilized","predicted","allowable","peaceable","soundless","marshy","discordant","intoxicating","concurrent","uncut","tantalizing","pedagogical","accursed","two-man","connective","hawkish","ripped","cleared","double-digit","unencumbered","yawning","manifold","stopped","untreated","subliminal","grayish","gory","upper-middle-class","avenging","self-fulfilling","equatorial","saucy","barred","arch","midwestern","blue-gray","tarnished","leafless","incisive","unearned","botanical","feline","extraneous","prep","intransigent","change-minimizing","insurgent","acrimonious","thermonuclear","blue-chip","crummy","acoustic","oversize","fated","galactic","cantankerous","ill-advised","detectable","lower-class","sacrosanct","palatial","conditional","insulated","step-by-step","nebulous","two-dimensional","well-heeled","bronchial","subatomic","semifinal","first-year","dark-eyed","tinny","attacking","indecisive","anatomical","brotherly","blooming","sinuous","meditative","socalled","rheumatoid","received","bleary","half-naked","leaded","woody","averse","shuddering","door-to-door","heretical","suspect","untapped","ravaged","decentralized","rutted","ineffable","intolerant","mechanized","fortuitous","equestrian","seven-year-old","darting","consoling","modern-day","ground-floor","emblematic","lurking","two-year-old","purplish","disorganized","vaudeville","circulatory","eight-hour","presentable","anarchic","unsatisfied","labored","maudlin","trampled","gibberish","unaccountable","sedentary","heavy-duty","thrilled","tutoring","self-centered","do-it-yourself","inquiring","uncaring","disillusioned","bloodstained","surface-to-air","consular","subconscious","four-year-old","collaborative","terraced","figurative","sinewy","horn-rimmed","impertinent","hit-and-run","standby","medium-size","peremptory","incremental","first-aid","dyed","centrifugal","omnipotent","lascivious","two-month","unionized","discredited","mass-produced","feathery","self-indulgent","liturgical","enviable","fifteen-year-old","buxom","abashed","urinary","newsworthy","flailing","beastly","undiscovered","strong-willed","prenatal","brownish","announced","flaky","washed","nightmarish","broad-shouldered","short-sleeved","two-bit","self-assured","whitish","suffocating","black-haired","full-size","self-help","created","uninhabited","smokeless","no-fault","unfashionable","mushy","forested","adhesive","creased","insufferable","down-to-earth","trifling","landless","disreputable","self-effacing","sporty","confined","adoptive","monogrammed","motley","duplicate","silver-haired","rejected","undifferentiated","blasphemous","institutionalized","blue-and-white","hip","winsome","button-down","discerning","abused","clean-cut","bracing","self-supporting","unsupported","premarital","flattered","studious","repetitious","marketable","anemic","meaty","airless","unhurried","galvanized","feal","peace-keeping","rapacious","bulletproof","well-placed","helmeted","packaged","court-ordered","aggravated","gastrointestinal","hand-to-hand","sixteen-year-old","fretful","fourth-quarter","conquered","satiric","nutty","befuddled","humorless","pitched","burnished","mirrored","fishy","fluted","conditioned","military-industrial","one-story","barbarian","branching","dynastic","unthinking","unconscionable","hunched","post-World","capital","putative","incendiary","shaving","topical","self-satisfied","farcical","narcissistic","kneeling","born-again","old-line","amateurish","ill-fitting","scaly","unpainted","eroding"]),Dt}var jt={},xn;function pl(){return xn||(xn=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.default=["man","world","hand","room","face","thing","place","door","woman","house","money","father","government","country","mother","water","state","family","voice","fact","moment","power","city","business","war","school","system","car","number","office","point","body","wife","air","mind","girl","home","company","table","group","boy","problem","bed","death","hair","child","sense","job","light","question","idea","law","word","party","food","floor","book","reason","story","son","heart","friend","interest","right","town","history","land","program","game","control","matter","policy","oil","window","nation","position","ground","blood","action","wall","street","husband","fire","mouth","arm","sound","service","chance","information","price","building","road","paper","court","attention","space","trouble","form","society","art","market","force","effect","nature","chair","period","order","television","president","tax","field","glass","thought","industry","process","phone","plan","center","truth","couple","decision","change","eye","campaign","issue","situation","effort","report","sun","experience","peace","letter","level","energy","role","development","result","evidence","meeting","smile","support","baby","team","show","community","brother","picture","kitchen","production","press","study","daughter","director","dinner","class","defense","piece","record","desk","stage","earth","movement","future","board","security","sea","horse","language","public","church","course","bill","river","coffee","wind","bank","corner","committee","pain","help","answer","subject","hospital","film","economy","trade","feeling","member","apartment","ship","silence","seat","gold","education","leader","pressure","doctor","shoulder","sight","scene","figure","crowd","fear","telephone","labor","success","population","style","station","value","sky","growth","foot","radio","sign","strength","capital","neck","college","budget","breath","choice","direction","guy","agreement","speech","skin","will","amount","plane","practice","marriage","audience","movie","gun","living","hall","concern","income","quality","dog","cause","hotel","race","difference","stone","box","army","trip","distance","attack","chairman","election","presence","computer","science","color","theory","spring","machine","purpose","organization","material","image","tree","surface","officer","administration","act","statement","battle","page","suit","lady","play","stock","list","freedom","bar","relationship","farm","authority","student","conference","ball","structure","nose","plant","career","wood","basis","deal","source","chest","message","stuff","middle","sister","drink","majority","sex","store","trial","character","boat","union","animal","ice","front","firm","heat","hope","rock","weight","disease","spirit","memory","king","response","manner","opinion","operation","increase","lawyer","expression","kid","bag","department","crime","train","executive","aid","dream","beginning","rain","prison","conversation","shirt","lunch","possibility","pleasure","management","danger","rule","throat","wine","behavior","return","hat","surprise","snow","property","flight","training","ability","project","camp","range","approach","agency","treatment","reality","village","bottle","attempt","crisis","drug","violence","inflation","enemy","responsibility","opposition","newspaper","victory","dress","condition","darkness","opportunity","account","degree","pocket","performance","manager","visit","threat","failure","brain","driver","charge","beer","coat","shot","metal","activity","influence","intelligence","bit","official","existence","example","truck","note","construction","shape","event","screen","faith","safety","path","culture","chief","relief","grass","contract","product","investment","weather","soul","murder","bedroom","magazine","model","cup","leg","traffic","writer","beauty","song","share","cancer","patient","credit","club","argument","speed","quarter","design","desire","vision","candidate","bottom","pattern","date","finger","teacher","tea","section","article","flesh","island","balance","spot","meaning","technology","crew","proposal","leadership","concept","object","impact","guard","analysis","birth","shop","knife","advantage","generation","appearance","variety","anger","religion","reaction","fight","star","exchange","agent","investigation","milk","judge","silver","region","steel","ear","sugar","strike","youth","hole","thinking","attitude","supply","start","jacket","jury","taste","secretary","mountain","confidence","master","artist","spokesman","demand","cigarette","track","captain","network","whole","university","conflict","noise","smoke","commission","mirror","accident","plastic","garden","debate","interview","command","tradition","protection","dust","watch","lead","solution","measure","motion","discussion","mission","opening","respect","extent","struggle","goal","tongue","moon","author","iron","breakfast","competition","cover","legislation","environment","sake","justice","fuel","hill","key","length","shock","band","version","contact","engine","settlement","mistake","restaurant","revolution","estate","camera","beach","post","pool","fashion","football","border","touch","laughter","title","background","principle","strategy","roof","forest","philosophy","entrance","pause","doubt","bird","tape","belief","card","ring","occasion","wheel","capacity","cat","collection","passage","writing","bridge","owner","novel","pride","damage","contrast","judgment","gift","division","professor","bathroom","plate","explanation","smell","district","park","wave","player","present","theater","atmosphere","emergency","leather","impression","painting","neighborhood","block","function","circle","sentence","priest","method","warning","editor","ceiling","target","tour","gate","site","baseball","airport","shadow","walk","approval","gesture","individual","difficulty","attorney","criticism","affair","request","doorway","reputation","minority","consumer","notion","general","convention","being","honor","partner","chain","commitment","weapon","joke","coal","meal","reading","detail","library","debt","other","mail","drive","fellow","profit","soldier","forehead","housing","excitement","soil","literature","pilot","dance","reform","volume","scale","imagination","challenge","desert","secret","poet","cabin","average","factor","corn","check","wonder","absence","search","wedding","yard","hero","address","confusion","fool","package","victim","fault","platform","democracy","regime","terror","nurse","stream","offer","medicine","flow","grain","row","county","self","glance","humor","promise","employment","advance","planet","recreation","trail","chicken","storm","creature","mass","stand","gaze","poetry","coast","lake","council","breast","corridor","conclusion","talent","tension","reporter","cut","appeal","total","belt","jail","passion","mayor","claim","combination","highway","wire","rifle","cheek","frame","exercise","incident","testimony","ticket","coach","connection","expert","disaster","valley","minister","deck","territory","chin","universe","independence","counter","resistance","cell","governor","salt","elevator","loan","release","schedule","porch","sheet","cloth","personality","actor","bomb","temperature","bench","break","code","journey","childhood","emphasis","aspect","pot","branch","identity","guest","arrival","recognition","hearing","lap","diet","factory","horror","fence","survey","fate","habit","lobby","bone","routine","discovery","comment","burden","treaty","knee","route","cry","ocean","fund","map","signal","ride","bear","deficit","height","element","sword","birthday","standing","cream","panel","fighting","travel","grandfather","creation","appointment","chapter","funeral","phrase","shore","planning","couch","survival","engineer","wagon","suggestion","waste","guilt","chamber","commander","clock","establishment","flag","content","supper","consciousness","proof","pack","beard","portion","comfort","resolution","sunlight","substance","benefit","honey","protest","prayer","stick","description","device","cloud","display","uniform","gasoline","tail","satisfaction","blanket","mess","consumption","drop","invasion","theme","mystery","belly","association","prospect","port","pipe","reference","skill","rear","heaven","destruction","worker","concentration","file","flat","cab","consideration","uncle","customer","laugh","radiation","favor","studio","boss","transportation","wage","fortune","tent","poem","procedure","clerk","surgery","percentage","expense","cap","household","match","bunch","column","intention","cousin","involvement","host","definition","wheat","permission","can","warmth","draft","silk","aide","lip","conviction","rope","illness","instrument","gap","string","adult","sweat","lover","evil","faculty","enthusiasm","farmer","missile","grin","tank","expansion","emotion","waist","discipline","distinction","technique","profession","wisdom","square","laboratory","tie","review","stranger","communication","pile","arrangement","palm","ceremony","tower","sympathy","deputy","script","nomination","friendship","institution","pass","civilization","magic","client","standard","significance","sport","defeat","announcement","reduction","grandmother","bowl","closet","genius","league","citizen","delivery","button","necessity","reader","lesson","trust","green","experiment","escape","craft","pistol","limit","witness","error","assistant","grace","salary","alarm","fist","potential","withdrawal","phase","bell","perspective","rose","score","amendment","fever","tip","god","crop","vehicle","barn","symbol","tale","exception","shift","scheme","tendency","logic","license","pollution","trend","bath","focus","producer","distribution","cotton","alternative","vacation","muscle","cycle","steam","palace","harm","location","beef","shame","policeman","compromise","tube","participation","fat","item","curiosity","blade","membership","lord","departure","shade","acid","enterprise","jet","selection","jungle","bond","retirement","alliance","bow","railroad","soup","airline","divorce","sofa","gear","gentleman","robe","plot","speaker","examination","egg","handful","recovery","embassy","entry","bastard","improvement","grip","invitation","barrel","context","controversy","fiction","revenue","reply","garage","crash","collar","landscape","grief","pen","teaching","angle","trunk","acceptance","recession","abortion","explosion","application","counsel","dignity","paint","landing","mixture","triumph","stove","winner","summit","thumb","depth","feature","setting","payment","grave","notice","museum","cop","graduate","sidewalk","taxi","trick","lamp","photograph","index","tray","essence","empire","tragedy","alcohol","flower","phenomenon","contribution","shower","castle","cross","booth","lawn","intensity","abuse","determination","passenger","opera","publication","wrist","hint","learning","punishment","ad","skirt","servant","prisoner","physician","midst","purse","rank","neighbor","elbow","contempt","round","cave","coverage","weakness","panic","basketball","juice","shooting","exposure","brick","miracle","unity","accent","coalition","fur","envelope","horizon","glory","stress","delight","politician","conscience","despair","rail","virtue","parent","dispute","killing","corruption","pound","core","stake","proportion","assault","curtain","efficiency","infant","count","suspicion","complex","formation","lock","entertainment","conduct","wit","outcome","shuttle","companion","discrimination","aunt","anxiety","shelter","confrontation","tool","climate","peak","cage","darling","assumption","stability","well","flame","marketing","currency","electricity","text","regulation","comedy","automobile","scientist","cake","scandal","contest","glow","cigar","arrest","brush","boom","basement","document","assembly","output","hut","slave","marble","breathing","pitch","loyalty","affection","resignation","guide","frustration","bureau","adviser","fleet","sector","privacy","awareness","fantasy","speculation","queen","tide","brass","formula","curve","zone","skull","sin","cable","corporation","foundation","achievement","countryside","monster","killer","strain","mask","breeze","whiskey","gang","rhythm","interpretation","basket","extension","tissue","satellite","doctrine","motor","hunger","intervention","kiss","fee","portrait","drawer","analyst","economist","reflection","visitor","transit","reception","provision","slope","sheriff","tunnel","complaint","devil","liquor","throne","hook","temple","tribe","preparation","handle","shoe","origin","helicopter","ruling","injury","crack","flash","gown","jaw","hallway","consequence","depression","subway","leave","drawing","cabinet","initiative","embarrassment","holiday","wilderness","towel","purchase","indication","sink","morality","impulse","rent","enforcement","utility","detective","comparison","critic","dish","hack","photo","crown","operator","conspiracy","rhetoric","bull","inquiry","humanity","demonstration","grade","alley","male","plain","pillow","remark","beast","seed","observation","guerrilla","straw","occupation","champion","excuse","possession","kingdom","snake","nerve","roll","horn","objective","cargo","mate","offense","resort","sequence","apple","bullet","presidency","strip","stroke","pig","print","champagne","saddle","dialogue","suitcase","protein","cook","quantity","toilet","chill","ranch","squad","priority","concert","van","adventure","representative","custom","shell","pension","prince","wound","video","courtroom","suffering","clay","actress","pencil","assignment","shelf","primary","waiter","charm","wool","sweater","soap","psychology","widow","delay","obligation","therapy","sergeant","shortage","myth","collapse","delegation","wish","perception","receiver","sauce","painter","reach","dear","fabric","carrier","ladder","hatred","dancing","cottage","opponent","dealer","prosecution","whisper","spread","poll","beam","exhibition","sigh","fog","harbor","successor","relation","gallery","prize","fireplace","fighter","pit","representation","prosecutor","liberty","bargaining","ownership","root","tin","celebration","stretch","nightmare","transport","link","diplomat","flood","architect","peasant","female","lab","category","inside","tune","carpet","mercy","fraud","introduction","facility","net","temper","rug","conception","eating","legend","tourist","refusal","disappointment","sensation","innocence","transfer","powder","parade","pursuit","parlor","pine","orbit","promotion","senator","colony","cart","interior","productivity","trap","identification","ambition","hip","admiration","corpse","emperor","patch","realm","barrier","ambassador","carriage","residence","maid","gathering","switch","lieutenant","sorrow","contrary","legislature","cliff","lightning","ritual","mist","salad","separation","flour","continent","poison","elite","radar","assessment","outfit","ideology","pad","exile","praise","employee","succession","gain","illusion","option","gravity","journalist","businessman","constitution","singer","sentiment","scope","transition","warrior","cast","march","herd","intent","inspection","episode","uncertainty","spell","isolation","observer","glimpse","privilege","spy","toy","thread","margin","anniversary","irony","organ","lecture","misery","needle","revolver","composition","admission","odor","candy","bid","classroom","bride","vitamin","refrigerator","sandwich","subcommittee","rescue","lad","defendant","blast","angel","compartment","vegetable","minimum","violation","agony","edition","compensation","evolution","treasure","salesman","log","clinic","layer","pitcher","publisher","suite","estimate","airplane","tournament","trace","hammer","reward","broadcasting","running","raid","specialist","mortgage","oak","pole","rocket","aisle","brandy","bureaucracy","mustache","vessel","penalty","export","orange","ignorance","hostility","integration","motive","ban","consultant","timing","equivalent","patrol","liver","assassination","instruction","leaf","railway","freeze","mention","designer","daylight","velvet","amusement","bush","fly","cloak","copper","orchestra","mechanism","chocolate","instinct","circuit","feed","courtyard","mob","profile","bombing","retreat","favorite","revenge","infection","historian","theatre","consent","bucket","mill","insult","pregnancy","psychiatrist","employer","presentation","swing","removal","financing","destiny","label","finish","ghost","channel","equality","requirement","dock","statue","doll","fan","mistress","oven","rim","scent","restraint","frontier","twin","framework","surveillance","diamond","pie","lion","cord","posture","wallet","stool","rally","realization","banker","invention","province","colonel","ally","inspiration","encounter","makeup","certainty","venture","takeover","daddy","ratio","fatigue","verdict","pardon","caution","scream","sleeve","coin","album","acquisition","laundry","transformation","handkerchief","candle","terminal","elephant","madness","appetite","rod","manufacturer","voyage","locker","pulse","indictment","riot","giant","sample","heritage","instance","hay","cure","clan","navy","monopoly","photographer","cowboy","bishop","linen","sacrifice","mortality","dilemma","frequency","harmony","junk","component","bargain","dragon","ruler","replacement","maker","blessing","resentment","surge","costume","editorial","mansion","hood","cellar","bout","driveway","championship","ambulance","sickness","guitar","rejection","compound","launch","journal","sculpture","preference","balcony","lid","toast","chart","motel","agenda","sadness","dimension","verse","scholar","submarine","confession","carbon","thunder","canal","socialism","merchant","bolt","insight","tub","topic","wolf","ridge","shed","gambling","arrow","con","lodge","bicycle","complexity","liberation","disorder","urge","circulation","pickup","distress","spine","romance","anticipation","military","lamb","gloom","pond","republic","ballet","bankruptcy","appreciation","rebellion","custody","feast","fluid","expedition","altar","recipe","array","anguish","harvest","sack","fraction","loneliness","trailer","notebook","surgeon","slip","festival","inability","pan","clearing","making","revival","rack","flashlight","sociology","heir","segment","moonlight","reign","exploration","burst","pet","charity","bundle","assurance","murderer","thrust","conservation","confirmation","outrage","quest","grant","perfection","liquid","stance","jar","essay","addition","diplomacy","rat","outlook","capability","broadcast","cocktail","breeding","immigration","optimism","urgency","helmet","correspondent","breakdown","domain","dressing","dancer","pork","colleague","crystal","insistence","guarantee","lane","dependence","chapel","transmission","hunt","turkey","veto","canoe","interference","sailor","arena","refuge","attraction","thesis","waitress","trigger","founder","briefcase","scholarship","commissioner","stack","lift","greeting","mining","partnership","cane","devotion","thief","troop","menu","finance","coincidence","sleeping","picnic","lounge","dose","jeep","brand","reasoning","proposition","administrator","cylinder","execution","commodity","drum","bronze","staircase","pin","whistle","robbery","catch","thigh","descent","canyon","ballot","shotgun","curb","nod","continuity","shaft","guess","gossip","jurisdiction","revolt","worry","recording","repair","saw","suspect","dome","globe","runway","resident","cemetery","conversion","black","passport","cease-fire","imitation","salvation","cement","creek","nephew","buddy","lung","embrace","ink","simplicity","sunset","astonishment","butt","oath","typewriter","outline","tribute","deadline","hostage","underwear","revelation","reluctance","dread","nest","nut","disposal","disclosure","destination","terrain","procession","recommendation","recorder","potato","ramp","accounting","bat","precision","heap","justification","fork","idiot","biography","prey","ivory","rumor","toll","robot","mix","glare","seal","sweep","haven","bike","courtesy","interaction","secrecy","ham","superiority","synagogue","calendar","ledge","engagement","lace","timber","turmoil","tooth","perfume","magnitude","veteran","lemon","cutting","tomb","accord","ammunition","spear","hunter","acquaintance","grocery","coming","pump","reservation","slide","award","institute","fringe","freight","accuracy","spectrum","ski","diameter","battery","desperation","pounding","variation","ankle","pepper","encouragement","cathedral","expectation","calf","monkey","suburb","rabbit","objection","dismay","boot","pipeline","lust","firing","aggression","ghetto","armor","merger","sphere","texture","moisture","kidney","broker","auction","hose","patent","hesitation","mound","cruise","goat","declaration","regret","conductor","terrace","contention","crap","manuscript","incentive","buyer","gin","principal","steak","novelist","criminal","heel","intellectual","conservative","quarterback","collector","motorcycle","refugee","punch","cluster","clown","preacher","torture","headache","pact","lump","buying","flavor","toe","spectacle","apron","banner","convenience","import","attendant","kindness","verge","dairy","umbrella","dam","inventory","turning","homeland","remainder","gum","plight","container","diversity","drought","reporting","biology","chemistry","curse","scar","merit","spray","reactor","shield","clarity","bamboo","metaphor","vocabulary","runner","luxury","diagnosis","bunk","white","statute","knock","garment","breed","railing","zoo","rival","supermarket","streak","pavement","discomfort","congregation","twilight","bacon","slot","scarf","dime","charter","grammar","theft","sensitivity","mainland","classification","coffin","rider","competence","adoption","reserve","fascination","specialty","mike","temptation","yield","evaluation","passing","intimacy","translation","philosopher","cafe","sitting","superintendent","pill","housewife","signature","correspondence","siege","inn","leftist","injustice","assertion","restoration","registration","farmhouse","denial","endorsement","predecessor","final","demon","greed","transaction","repression","mattress","nobility","embargo","bosom","gym","tenure","addiction","apology","double","litter","nail","incidence","merchandise","volunteer","labour","basin","fiber","whip","payroll","microphone","ax","supervisor","resource","maturity","resemblance","cult","stadium","limousine","welcome","knot","probability","menace","nominee","characteristic","stare","vodka","obsession","nursery","paragraph","discourse","candidacy","battlefield","saint","hierarchy","precedent","imperialism","pope","intake","burial","freshman","rebel","mandate","clause","tile","electorate","torch","adjustment","implication","farewell","curriculum","fountain","satin","subsidiary","humiliation","slaughter","discount","crest","princess","asset","greenhouse","reorganization","irritation","ending","messenger","jealousy","breakthrough","mineral","baggage","mouse","tiger","memorandum","kit","substitute","paradise","stride","deed","accumulation","pledge","hull","projection","apprehension","glue","excellence","composer","decay","ditch","slice","beating","syndrome","parole","pony","saying","vulnerability","rental","wax","renewal","disk","athlete","warehouse","organism","disagreement","suspension","documentary","soda","availability","dedication","delegate","reminder","domination","leap","span","obstacle","counselor","taxation","grandson","banana","rehabilitation","stamp","anchor","diary","tunic","boycott","meadow","backyard","dismissal","rating","disc","glove","pasture","catalogue","inspector","exploitation","missionary","density","sail","excess","chemical","disposition","headline","wartime","atom","bartender","blue","wash","shark","negotiation","monument","mom","faction","echo","tomato","scrap","expenditure","plague","fortress","web","briefing","luncheon","vanity","ribbon","nostalgia","drill","frown","dioxide","sovereignty","sweetheart","cot","tag","laser","purity","melody","sanctuary","citizenship","poster","pal","marketplace","girlfriend","programme","retaliation","researcher","allowance","bedside","yacht","scenario","concession","offering","instructor","motivation","litigation","tolerance","puzzle","compliance","duration","quarrel","aura","crusade","salute","intellect","debut","eternity","monastery","immunity","flock","choir","stern","medal","meter","auditorium","equity","fairy","windshield","mare","conquest","razor","push","kick","battalion","generosity","whale","den","mama","emptiness","hysteria","hillside","ideal","landlord","stem","drain","temperament","orientation","spoon","associate","ash","wig","elimination","bark","boost","activist","stature","liar","vein","tract","telegram","completion","pizza","urine","hollow","ordeal","admiral","psychologist","rehearsal","questioning","musician","installation","ministry","puppet","axe","nitrogen","contractor","poker","arch","tractor","reverse","relative","buffalo","deployment","outbreak","pier","veil","summary","courthouse","academy","confinement","catastrophe","technician","specimen","bachelor","lobster","tyranny","discharge","graduation","shout","monitor","traveler","dope","user","vegetation","deposit","investigator","attic","rabbi","reversal","knight","innovation","probe","altitude","legacy","raft","boyfriend","twist","plaza","paradox","witch","folly","physicist","prophet","threshold","plaster","dentist","telescope","vault","climax","parish","balloon","probation","prescription","liability","wheelchair","blackness","colour","booze","exhibit","vest","abundance","hatch","sketch","cartoon","horseback","investor","violin","hazard","trader","stall","healing","prejudice","scorn","rum","accomplishment","limb","produce","epidemic","tumor","camel","starvation","insect","tenderness","cockpit","maximum","patriotism","chauffeur","parliament","capsule","deficiency","massacre","dessert","bail","meditation","petition","hypothesis","ruin","voter","wait","saving","imprisonment","nationalism","lawsuit","surrender","celebrity","contradiction","disgrace","betrayal","slogan","thrill","enjoyment","narrative","canopy","might","vaccine","fort","stereo","hearth","relaxation","avenue","fright","drift","width","guardian","portfolio","longing","brutality","frenzy","chaplain","chop","tactic","viewpoint","chip","banquet","closing","re-election","impeachment","wardrobe","cradle","facade","finding","tangle","adaptation","hamburger","analogy","fancy","counterpart","dissent","skepticism","gut","advocate","granite","equation","slump","vice-president","nap","foam","buildup","geography","scratch","major","preservation","folder","entity","defiance","nickel","monarchy","shack","teaspoon","chase","remedy","disappearance","foreman","seller","rag","youngster","allegiance","earthquake","columnist","goose","feather","bulb","imagery","bomber","overcoat","harassment","outsider","maze","reproduction","printing","reconciliation","kinship","grease","harp","parallel","stew","particle","accusation","criterion","garlic","boundary","scalp","recess","bearing","warrant","dictatorship","breach","bladder","elegance","fervor","disapproval","monk","tweed","loser","hen","shrug","junta","disguise","gulf","landmark","bourbon","reconstruction","decency","register","feat","hostess","workshop","accommodation","wreck","referendum","viewer","niece","flank","autopsy","boarding","grove","decoration","stain","cape","prophecy","bubble","asylum","commentary","grandeur","subsidy","seizure","badge","limitation","armchair","pro","spark","blaze","centre","split","peril","fusion","goodbye","ringing","solitude","handwriting","crossing","onion","rubber","forefinger","bait","solidarity","measurement","multitude","dump","novelty","truce","perimeter","alien","decree","opposite","constituency","maneuver","ransom","supplier","performer","murmur","coordination","hobby","dough","lantern","cherry","fox","quota","deterioration","flaw","millionaire","raincoat","skeleton","bum","washing","plantation","spotlight","arsenal","villa","sermon","compliment","podium","collision","ratification","jam","loft","theology","escort","tyrant","ore","caste","brokerage","lighter","screw","inheritance","eagle","annoyance","napkin","rationale","flurry","mall","dresser","autobiography","slate","cheer","sulfur","assortment","memorial","electron","detachment","addict","shrine","mold","rookie","astronaut","diesel","neon","heroine","clash","recollection","sweetness","complexion","stewardess","adversary","trance","virgin","screening","classic","nuisance","uprising","shipment","mug","stairway","supporter","famine","stench","click","stupidity","bug","throw","lumber","current","mentality","regiment","galaxy","patron","tap","mischief","contingent","gospel","racket","liaison","honeymoon","foliage","leak","doom","irrigation","mechanic","chef","viewing","swamp","void","mule","lottery","pastor","steward","ranking","survivor","tuition","medication","misunderstanding","prediction","forum","oppression","ale","expanse","consultation","pawn","attachment","franchise","intercom","chunk","mat","pioneer","prairie","familiarity","undergraduate","tenant","chimney","cereal","pub","packet","aftermath","outburst","habitat","federation","deduction","pageant","circumstance","discontent","microscope","sausage","coma","want","intersection","detention","shrimp","deception","illustration","manipulation","ecstasy","dash","eyebrow","ray","persuasion","builder","injunction","foe","inclination","precinct","slab","anthropologist","amnesty","loaf","radical","intrusion","dwelling","calculation","paperback","usage","paste","ashtray","shovel","capture","ferry","preoccupation","joint","filing","spit","womb","puff","quilt","squadron","playwright","rotation","lease","brilliance","burn","cough","spouse","assassin","flu","cabbage","reliance","console","carpenter","dependency","advertisement","lipstick","mahogany","disadvantage","holder","furnace","certificate","alienation","collaboration","extinction","austerity","pupil","tenor","foyer","bluff","whisky","similarity","pouch","chant","nun","hike","babe","com","input","pianist","treason","brake","shake","dividend","repetition","fisherman","pinch","persecution","brightness","disdain","sunrise","gleam","premise","shawl","kettle","forecast","recipient","strap","outlet","chalk","plywood","nickname","fulfillment","doorbell","keyboard","peanut","compass","interval","intuition","clearance","format","shuffling","dent","ambush","chatter","lettuce","harness","hiring","ache","continuation","fit","friction","pretense","velocity","tavern","abdomen","scout","splendor","barber","flap","plateau","hedge","raising","visa","dictator","housekeeper","cafeteria","enrollment","sailing","ingenuity","limp","bard","consistency","ordinance","bathrobe","gauge","strand","taxpayer","spider","coward","reservoir","brigade","self-interest","crackdown","crib","hum","roommate","traitor","blend","kitten","setup","dagger","sophistication","clout","goddess","disability","touchdown","fertilizer","punk","agitation","seminar","hitter","crust","comprehension","nightgown","gamble","freak","stump","microwave","lever","libel","playground","exhaust","abstraction","picket","diversion","advancement","bourgeoisie","coordinator","myriad","dial","diagram","sensibility","donor","endurance","prominence","playgroup","transmitter","revision","consolation","storyteller","jewel","mourning","burglary","competitor","narrator","verb","butterfly","rationality","ant","mister","satire","placement","reunion","plunge","comb","commuter","carving","hormone","creator","swim","clip","necklace","frost","fix","allocation","thickness","happening","disruption","caravan","rodeo","axis","submission","insanity","protocol","caller","porcelain","aristocracy","interrogation","boyhood","muzzle","delicacy","teenager","undertaking","textile","tailor","defence","comeback","zero","wizard","cupboard","cynicism","behaviour","holster","bulletin","broom","receptionist","listener","exemption","flicker","exam","treasury","hug","interruption","no","drugstore","roast","trifle","jerk","exclusion","inmate","contra","permit","gene","melancholy","alcoholic","trainer","perspiration","instability","doorman","deterrent","occurrence","hem","pricing","wear","hog","cushion","commune","courtship","paradigm","down","participant","triangle","apprentice","prevention","forearm","symptom","flush","newcomer","announcer","gorge","frog","platoon","hawk","rivalry","trench","geometry","clubhouse","feller","hymn","dictionary","showing","homicide","crow","pneumonia","gourmet","flannel","congress","dislike","illumination","jockey","superpower","papa","absorption","fragment","catalog","genre","hypocrisy","duel","cone","organizer","fraternity","cubicle","hardship","restriction","gasp","authorization","partition","barrage","groan","waterfront","aerial","cinema","proximity","mockery","compulsion","slum","default","evacuation","fugitive","carton","chariot","masterpiece","nylon","dialect","tee","bathtub","congressman","vapor","disturbance","mailbox","take","groin","moss","shepherd","formulation","foreigner","solo","elder","textbook","predicament","trait","reef","intruder","captivity","commotion","farce","royalty","exasperation","developer","expulsion","plaid","believer","migration","gal","fitness","idealism","galley","offensive","hometown","sophomore","clump","launching","mast","slowdown","generator","make-up","mount","worm","chuckle","prototype","catcher","crotch","interpreter","graveyard","mane","premium","cuisine","jeopardy","reassurance","vantage","condemnation","vase","blackout","token","abandonment","maple","magician","bust","syrup","cassette","pick","madman","cleaner","throng","hanging","riding","villain","squeeze","wallpaper","lime","blur","modification","clatter","anonymity","lineup","polish","accountant","setback","neutrality","modernization","borrowing","kill","dwarf","amateur","expectancy","donkey","fella","contamination","ballroom","kidnapping","popcorn","entourage","crook","ambiguity","coral","roadside","fragrance","slack","spectator","stimulation","groom","rattle","synthesis","tan","skipper","distrust","siren","spin","revulsion","signing","booster","savage","glamour","flute","civilian","flask","tug","misfortune","therapist","plug","standpoint","weed","ecology","footing","patio","decor","malpractice","residue","passageway","chopper","batch","acceleration","depot","quarry","hound","pilgrimage","deference","splash","heartbeat","rap","wedge","indicator","pretext","make","saloon","clientele","poisoning","hemisphere","grotto","ignition","cover-up","ape","transcript","blizzard","crab","ration","puck","propriety","hunch","madam","imbalance","jug","manual","raise","silhouette","sponsor","bore","volcano","crate","humility","devaluation","rocker","rainbow","chap","informant","freezer","limestone","guise","valve","appraisal","handicap","correction","bra","sinking","turnout","manure","pail","cardinal","grape","bee","rumble","miner","dissatisfaction","pamphlet","plaque","chat","injection","pulpit","platter","symphony","molecule","rib","pyramid","shudder","dissolution","vinegar","calling","acreage","chick","cuff","scrub","orphan","porter","saucer","antenna","trophy","rig","convent","good-bye","troupe","ploy","niche","veal","semester","contender","grenade","hilt","spiral","stink","marathon","boulder","treasurer","cookie","peninsula","freeway","rainfall","showdown","parody","telling","statesman","decrease","symbolism","pillar","tremor","penetration","carcass","breadth","psyche","hiss","suppression","pottery","dormitory","scare","overtime","bean","schoolteacher","timetable","buzzer","mesh","jack","marshal","windfall","lance","uterus","inconvenience","chrome","brute","gardener","whim","pearl","fold","trim","ravine","critique","adultery","stretcher","trolley","elevation","worthy","vibration","bracelet","plank","jelly","foil","wrestling","colon","layout","quotation","sting","son-in-law","jargon","likeness","knack","defect","sedan","tilt","chore","moratorium","convoy","piety","acknowledgment","formality","thud","blockade","chord","hush","takeoff","lining","marsh","manifestation","humidity","ingredient","crater","liking","pigeon","abolition","granddaughter","vintage","flourish","playoff","prostitute","prick","oblivion","sociologist","helping","locomotive","contraction","bookstore","surrogate","hippie","sherry","scotch","packing","wink","spasm","conglomerate","ensemble","dugout","insider","sect","inclusion","feedback","trumpet","massage","constituent","brotherhood","directory","newsletter","comrade","grid","turtle","restructuring","reel","spur","comet","dummy","combustion","moustache","oversight","motto","mantle","handshake","mouthful","monologue","buffet","miss","crunch","waking","gray","exaggeration","gait","clutch","courier","hangar","dive","curator","ridicule","diaphragm","tow","projector","eclipse","parcel","lure","transplant","township","squash","commentator","mentor","gutter","stint","treat","germ","infinity","impasse","burglar","proprietor","tariff","dispatch","torment","dove","superstition","going","tempo","warden","sponge","rooster","barge","gorilla","draw","wharf","stallion","countenance","orchard","navigation","tar","biographer","wheelbarrow","imposition","hurricane","stronghold","distortion","starter","rash","feud","parting","interviewer","wrongdoing","lavender","low","leash","envoy","stairwell","backup","doorstep","negotiator","heading","excursion","sewer","endeavor","backbone","rite","vine","gypsy","directive","defender","scoring","esteem","torrent","gland","consortium","nightclub","swell","employe","obscenity","cavity","pulp","lifestyle","butler","peach","tack","fossil","glitter","liner","destroyer","flyer","individuality","roller","outcry","felony","artery","cruiser","bedding","dude","bounty","blindness","bodyguard","corral","coroner","spice","martini","contingency","gag","serving","wail","wrench","sock","safe","spite","broth","trustee","moth","vice","gender","cartel","casting","puppy","prohibition","ox","sculptor","treachery","stir","printer","audit","brim","handbag","lobbyist","jolt","comedian","distraction","challenger","telegraph","homage","evasion","detector","filling","overhead","cartridge","walnut","sonar","puddle","quake","flooding","crescent","thrift","following","tanker","stoop","clergyman","opener","latitude","anatomy","convertible","arbitration","leukemia","absurdity","stab","biologist","baseman","fuse","specialization","carnival","gangster","stalemate","trickle","mallet","working","receipt","charcoal","mortar","drainage","mother-in-law","regularity","emigration","plasma","condominium","muck","workplace","roster","stroll","softness","serpent","owl","infield","sill","swallow","backdrop","fidelity","historiography","thicket","baking","omen","yell","functioning","bribe","dynasty","trough","pudding","alcove","ancestor","ripple","flint","bracket","cube","pasta","proxy","groove","commercial","holocaust","countess","scroll","bang","planting","premiere","norm","bloom","gunman","vow","arithmetic","accelerator","postcard","relish","semblance","whine","inventor","sarcasm","designation","pat","symmetry","quiet","chisel","experimentation","cutter","differentiation","stud","apathy","relay","seminary","escalation","life-style","coil","mythology","futility","intimidation","childbirth","flare","glint","rue","mural","whiff","deposition","vogue","animation","migrant","caretaker","dot","mediator","lookout","captive","blackboard","pocketbook","recourse","negation","plaintiff","shriek","obstruction","latch","manor","casualty","grunt","gambler","erection","nationality","epic","starch","delusion","linkage","provocation","avalanche","offender","melodrama","contentment","appropriation","tonic","salon","accompaniment","paranoia","grimace","communion","cancellation","pendulum","shoreline","hail","refinery","subtlety","videotape","commando","repertoire","refinement","dryer","rust","lapse","haircut","errand","ailment","reanimation","ther","tab","prom","contemplation","bin","gilt","bunker","protector","sage","hilltop","hue","blueprint","correlation","brochure","roadway","arson","remnant","breaking","bouquet","exertion","garrison","beneficiary","colt","turbulence","refuse","bravery","indulgence","assimilation","coastline","livelihood","swarm","configuration","lecturer","paw","upheaval","switchboard","sub","claw","downfall","dye","immigrant","specter","deprivation","shrink","marker","sampling","fellowship","beak","pantry","mouthpiece","gratification","qualification","finality","debacle","extortion","chieftain","speaking","totalitarianism","mole","incumbent","jumper","crush","stubble","terrorist","comic","farmland","contributor","gravy","blossom","keeper","craftsman","pavilion","obscurity","loading","affiliation","vacancy","proclamation","gaiety","yarn","enclosure","clamor","sucker","recruitment","subversion","boiler","emblem","spade","stocking","staple","vocation","sling","maniac","musket","primitive","periphery","idol","snack","antique","redemption","listing","airliner","bandage","bulge","glimmer","priesthood","diner","astronomer","ovation","kindergarten","module","lifting","radiator","booklet","resurrection","precaution","affinity","thinker","quote","turbine","tally","vise","landslide","bakery","portal","majesty","abyss","admirer","turnaround","airfield","wastebasket","lapel","pennant","complication","slick","initiation","rustle","hearse","schooner","carrot","inscription","wench","embryo","vet","poise","disintegration","procurement","speck","kite","vent","plow","homosexual","membrane","waterfall","teevee","matron","utterance","buffer","memoir","cork","recital","loathing","cameraman","throttle","insecurity","trooper","hinge","hoard","umpire","slug","mountainside","affliction","pastime","felt","sentry","denomination","mushroom","linebacker","parachute","teller","fender","trademark","specification","harem","plum","metabolism","certification","neutron","organisation","heresy","relocation","payoff","lizard","termination","dropout","torpedo","stepmother","helm","resonance","heed","progression","braid","cardboard","walkout","shiver","gust","foreground","replica","repertory","sparkle","seam","bump","substitution","rapport","casket","dew","squirrel","palate","hitch","rebirth","reverie","boon","pirate","foresight","vinyl","delta","moat","presumption","tablespoon","aroma","digging","heartland","healer","malaise","creed","archway","exterior","screenplay","examiner","parity","copyright","strawberry","outpost","bookcase","cashmere","bikini","sheaf","pastry","respite","divinity","impossibility","legislator","saga","thump","inauguration","seaman","degradation","strategist","emerald","anthem","affront","burner","entrepreneur","thorn","marvel","stair","cavern","swivel","outlaw","underside","cleanup","fin","catalyst","forage","tapestry","dosage","covering","proletariat","turnover","notch","misconduct","onslaught","upbringing","coyote","bumper","champ","creep","boxer","mileage","vigil","fodder","occupant","dashboard","rarity","centerpiece","consul","ascent","paddle","martyr","doctorate","runoff","grudge","tattoo","robber","carbine","holding","oratory","distributor","heavyweight","footnote","terminology","infrastructure","drummer","chili","tableau","dung","magnet","deceit","caricature","itch","refund","cripple","rectangle","mortal","ancestry","inequality","generalization","furor","relativity","jukebox","dune","endowment","pathology","calibre","subpoena","attrition","hump","congestion","reflex","hoax","honour","herb","mantel","articulation","washer","judgement","brace","printout","helper","wording","crisp","shortstop","boulevard","characterization","cashier","matrix","documentation","deadlock","oyster","chasm","outing","expiration","heater","nutrient","beacon","bile","grievance","janitor","skyline","patrolman","juncture","antagonism","rump","hardwood","solace","warhead","assent","litany","enactment","chimpanzee","rye","feeding","suede","coke","inference","ivy","mosquito","eruption","symposium","variable","cooler","filter","storeroom","mailing","chancellor","beggar","antiquity","inertia","motif","absentee","float","blush","embankment","riverbank","demeanor","vampire","disciple","inadequacy","reinforcement","pedestrian","persona","berserker","tumult","incline","beaver","grill","morgue","denim","wreath","grouping","relic","syndicate","rancher","idiom","hegemony","seating","affirmation","physiology","repose","blight","jest","turret","slit","goalie","clarification","avoidance","volley","redhead","inefficiency","folklore","embodiment","afterthought","steer","cyanide","digestion","continuum","mania","giggle","buggy","willow","pantomime","fireman","growl","devastation","navel","halo","yearning","laborer","alligator","prelude","verification","brown","bead","midget","sleeper","riddle","portrayal","counterattack","lectern","tutor","chestnut","remembrance","aversion","taking","billing","regimen","translator","headmaster","duke","ace","snort","fanfare","imprint","calamity","exposition","cedar","intrigue","transistor","bowel","boardwalk","tramp","ornament","sticker","processor","voltage","sovereign","whistling","caliber","exuberance","snout","enclave","kilt","bombardment","corporal","overhaul","syllable","curfew","layman","consolidation","insignia","mediocrity","coherence","hospitalization","flick","pew","coloring","sanction","baritone","radicalism","savagery","pallet","stead","cadet","shutdown","supplement","unicorn","stepfather","excise","spelling","rebound","puzzlement","tenement","souvenir","veneer","safari","quartet","whirlwind","hamlet","practitioner","parasite","installment","emission","kissing","chronology","mosque","chairmanship","blonde","steamer","caption","shave","standstill","maiden","polling","condor","twinge","campfire","drinker","exhilaration","seafood","gala","crane","hickory","cathode","graph","deliberation","planner","marrow","bud","mediation","cutoff","tit","tic","parchment","noun","culprit","lair","showcase","hangover","chemist","aggregate","thriller","smack","efficacy","smear","heiress","crank","fig","finale","pea","staging","die","rebuke","curry","scum","potency","acclaim","collateral","schoolboy","canteen","radius","deportation","grate","madame","mop","pronunciation","sheen","respiration","breakup","professional","omission","gunshot","ugliness","fanatic","barbecue","dorm","trot","flattery","stereotype","hatchet","capitalist","purge","brew","totality","fern","enzyme","plumber","subscription","cholera","bruise","forge","nipple","commencement","superstar","ether","gem","sash","extraction","spaceship","golfer","realist","encampment","necktie","repayment","skillet","darky","disparity","bedspread","haul","questionnaire","promoter","wand","windowsill","victor","rector","enamel","hoop","coronation","patriot","chandelier","watchdog","glade","renovation","goblet","zipper","communique","crevice","motorcade","sequel","scourge","serum","single","icebox","junction","cache","berth","streetcar","syringe","antithesis","bureaucrat","blacksmith","oval","bun","loot","fiasco","tomahawk","ulcer","pinball","jersey","asthma","brook","pedestal","feeder","soot","inevitability","alteration","carrying","showroom","gimmick","lunatic","gall","fir","borough","hash","woe","controller","sponsorship","applicant","twig","screaming","librarian","intermission","sister-in-law","bushel","inflammation","pomp","vial","extravagance","pate","prostate","dolphin","tuxedo","mathematician","guinea","veranda","aperture","disillusionment","gavel","dating","knocking","oasis","nebula","woodland","yellow","ambivalence","hardness","oxide","socket","wasteland","leopard","blazer","follower","asking","urn","weaving","swimmer","closure","dart","loudspeaker","bazaar","bog","transfusion","reproach","sham","parka","affiliate","scowl","primate","attacker","rink","funnel","spate","elaboration","legality","tablet","heyday","tripod","bully","sharpness","demolition","flip","dandy","appliance","slant","sentimentality","knoll","gloss","defection","explorer","ram","stupor","clone","baton","cohesion","bearer","penance","bandit","aberration","gallop","swirl","coconut","spree","pedal","detergent","canon","teen","brood","phonograph","tabletop","enlargement","sniper","cohort","fable","rising","spill","affidavit","imperative","snapshot","apparition","stunt","wristwatch","chute","teammate","carelessness","over","stripe","postponement","rapture","savior","pacifist","admonition","pear","junkie","surcharge","wavelength","horseman","hag","confessional","comptroller","orthodoxy","financier","snarl","cliche","refreshment","adolescent","teapot","seaweed","drilling","roadblock","antibody","sheath","pallor","constable","misuse","arcade","lee","keep","anarchist","watering","rhyme","exclamation","backseat","great-grandfather","han","pod","daughter-in-law","mailman","alphabet","sloop","reckoning","grower","simulation","homer","birthplace","ence","actuality","depletion","novice","diffusion","concealment","cadre","pathway","fungus","ouster","loner","autograph","descendant","aspiration","better","sick","variant","fragmentation","pesticide","frigate","bestseller","propensity","foul","senate","trouser","airstrip","insurrection","chronicle","coating","stigma","toothbrush","pumpkin","apprenticeship","widower","paycheck","query","teen-ager","shifting","informer","doorknob","ardor","pebble","finesse","scrapbook","fiddle","dowager","sod","wrap","turtleneck","clipboard","rogue","mutiny","suitor","bulkhead","babble","fad","billboard","beverage","hairline","grille","exporter","pathologist","mesa","goblin","scapegoat","crucifix","backpack","observance","forgery","dungeon","methodology","gauze","bonanza","inkling","beret","shouting","ex-wife","wickedness","toil","preview","porridge","cornerstone","scanner","smoker","rebate","mite","brawl","axle","easel","allegation","grab","parrot","antidote","drawl","hijacker","telltale","venom","el","baron","intermediary","seduction","birch","contour","redistribution","cam","protagonist","enmity","hulk","stockbroker","decorator","cookbook","protege","mage","cricket","smock","apex","cortex","modem","shareholder","lament","determinism","rift","tablecloth","trajectory","preface","sneer","gamma","rendition","insemination","aristocrat","hare","labyrinth","thaw","invalid","staffer","alpha","fingernail","medic","crutch","entertainer","jade","eminence","discrepancy","yawn","flea","ledger","orphanage","getaway","manifesto","hijacking","incarnation","elm","adobe","spruce","gist","grit","boar","oracle","mobilization","cantor","crypt","cutback","musical","fallacy","corduroy","fray","racetrack","buckle","foreboding","pest","clap","ber","notation","peek","sow","ballad","brat","constellation","lard","industrialist","hunk","assailant","splinter","bridegroom","dip","fixture","cadence","watchman","windmill","prerogative","drawback","bungalow","heaving","nationalization","mating","writ","rationalization","milking","modernism","landlady","calculator","animosity","workout","skirmish","glycogen","discord","portico","vestibule","renegade","overdose","iceberg","lineage","mosaic","liturgy","watershed","playing","lobe","dowel","ranger","dossier","anvil","co-operation","satchel","fa","corollary","bridle","gateway","brothel","monotony","vendor","mysticism","saucepan","accomplice","hernia","guild","pup","hoof","sparrow","dreamer","craving","outpouring","blink","overlap","duct","brownstone","maneuvering","stagger","foothold","craze","monsoon","induction","handgun","scan","constraint","citadel","rigidity","anecdote","halter","occupancy","rightist","convict","tribunal","stalk","waterway","debtor","yoke","audition","inconsistency","peg","sliver","midwife","premonition","ruby","conduit","excavation","fart","condenser","hop","poodle","upsurge","attainment","stitch","crimson","anomaly","backlog","yeast","chimp","awning","gig","parable","drumming","tiptoe","prow","bypass","crease","reformer","intestine","counterpoint","enormity","anthology","rudder","shroud","magistrate","twitch","commonwealth","circumference","stuffing","sweating","scattering","lender","dripping","legion","refrain","mummy","covenant","morbidity","prop","initial","alignment","licence","infusion","unification","rebuttal","adjective","humour","larceny","mistrust","horde","assemblage","delinquency","testament","convert","patrician","dissension","cider","infidelity","bonnet","displacement","crackle","edifice","conciliation","bondage","schizophrenia","embroidery","standoff","monotone","oddity","mobile","tornado","semicircle","panorama","ex","ping","yogurt","screech","underdog","quay","tai-pan","extract","podesta","ticking","shrubbery","backside","communicator","sorcerer","interlude","dominion","battleground","taboo","blunder","conjecture","drone","cove","maverick","secondary","companionway","rook","gauntlet","ordering","violinist","rooftop","slash","thermometer","vomit","anteroom","deity","nave","acquittal","talker","reed","concussion","malfunction","tundra","cub","anemia","constructivist","cocoon","divide","keeping","percussion","freighter","noose","narcotic","expediency","grandchild","gully","innkeeper","pigment","bloodstream","quiver","alderman","halftime","stable","fission","aggressor","denunciation","abduction","expressway","uniformity","faucet","buff","broiler","allusion","jock","spike","herald","polyester","genocide","fer","parapet","classmate","tinge","sandstone","lurch","skunk","huddle","mum","tranquilizer","pharmacy","susceptibility","penicillin","lark","hoe","lily","hanger","headset","john","appointee","advisor","twine","slumber","magnetism","schoolgirl","smash","screwdriver","newsman","sleet","cleavage","lacquer","milestone","commandant","crick","splitting","rosary","edict","hurdle","fixation","appendix","lock-mechanism","eyelid","swath","fingerprint","carbohydrate","tick","magnate","heck","sailboat","donation","malady","polishing","clipping","collective","sensuality","loom","swagger","facet","variance","mean","walkway","aptitude","prodigy","solemnity","understatement","ebb","scoop","wrapper","narration","icon","prerequisite","planter","gash","interplay","evangelist","drip","vulgarity","subdivision","backwater","euphemism","lotion","corpus","broadcaster","toothpaste","curmudgeon","fo","thong","thatch","baptism","peacock","workman","downturn","scoundrel","machete","creak","five-year-old","dissertation","dishwasher","pimp","electrician","tycoon","otter","shove","snail","rendering","nobleman","booking","pronghorn","deadpan","shutter","escalator","girdle","fling","hire","alibi","flop","stampede","prognosis","itinerary","cologne","spoonful","detour","violet","watcher","falsehood","hype","locale","estimation","propeller","squaw","pickle","lass","pun","racist","scratching","rout","downpour","casing","complacency","camper","equator","reticence","learner","outcast","brunette","improvisation","stag","maxim","loophole","livery","blasphemy","shoot","solvent","misdemeanor","buyout","tiller","jetliner","checkbook","awakening","sideboard","romanticism","squire","newsstand","nuance","consulate","excrement","reprisal","bastion","beginner","obituary","softball","conjunction","scripture","phalanx","vindication","grub","swig","inaction","redwood","scabbard","bonfire","casserole","ovulation","unreality","totem","palette","choreographer","peasantry","skyscraper","penitentiary","outfield","melon","bounce","yolk","diver","archbishop","plurality","amber","recurrence","adulation","piston","insurgency","stoan","coop","tart","eyeball","toss","giveaway","cross-examination","dissident","hermit","ruse","ture","pore","leaving","dowry","gunner","epitome","snowstorm","summation","switchblade","crock","ity","frock","luster","piazza","rotor","impropriety","pivot","blender","immediacy","borrower","slaying","feminist","preserve","bidder","depiction","parasol","clover","intern","asteroid","stub","barricade","medley","multiplier","smirk","knapsack","hank","cognac","headway","treatise","homestead","troublemaker","giraffe","mover","allotment","drowning","naturalist","orderly","attribute","scalpel","shipyard","estrogen","educator","enrichment","grandstand","sire","sideline","landowner","confidant","gel","deviation","clemency","liberal","bigotry","filly","six-year-old","lifeguard","shred","adversity","shelling","pineapple","referee","knockout","jigsaw","retailer","extremity","outgrowth","amplifier","sinner","campground","teasing","steamboat","turban","mutton","cobra","contraption","chopping","schoolhouse","varnish","pane","observatory","ballerina","czar","immensity","lethargy","reimbursement","undershirt","concierge","fracture","variability","accordion","slime","meanness","gelding","practicality","advertiser","graft","gull","stockholder","pilgrim","hooker","puritan","benediction","barbershop","stanza","hallmark","mishap","harpy","silage","enchantment","whirlpool","conditioner","gadget","divestiture","lathe","incarceration","amalgam","antibiotic","annexation","martyrdom","pyre","shank","alert","shale","artifact","interchange","mystic","meet","grinding","triple","boutique","antagonist","fermentation","twinkle","sweetie","shin","creditor","amulet","pall","posse","homeowner","skier","vastness","smith","allegory","oxidation","cracker","levy","ark","sporophyte","enthusiast","snob","spinster","searchlight","waistband","lorry","repeat","reprieve","slalom","respirator","visor","reviewer","putt","miscalculation","shortfall","concourse","dialectic","native","hairdresser","normality","immorality","sprinkling","allure","lick","drudgery","habitation","gondola","vista","ice-cream","cheerleader","predator","countdown","juxtaposition","stumbling","muffler","derby","timer","salvage","boast","cabbie","clam","windbreaker","retardation","antelope","shampoo","raccoon","bible","glider","momma","valise","coffeepot","emissary","compression","grail","guideline","lavatory","glaze","outpatient","thunderstorm","foray","co-op","valet","baker","sycamore","thumbnail","nozzle","timidity","orator","liquidation","spokeswoman","militant","jig","naivete","motorist","dumping","armpit","margarine","exultation","headboard","plume","amplitude","flutter","pronouncement","finery","trepidation","airing","coupon","knuckle","gametophyte","deathbed","extermination","alleyway","hybrid","gambit","nova","binge","original","froth","lighthouse","coolant","continuance","collaborator","fuselage","profanity","whirl","saber","filmmaker","checkup","shaman","rancor","retort","earring","sieve","post-mortem","implantation","conceit","simplification","vat","proficiency","deluge","kiosk","outlay","tantrum","flooring","veterinarian","fireball","carousel","bandanna","glacier","censure","citation","oar","fridge","metamorphosis","superior","approximation","girth","tirade","grocer","holdup","forward","snobbery","cleansing","replay","recitation","facsimile","patter","jubilation","snare","frailty","rampage","pick-up","overture","tumble","residency","prevalence","repository","reentry","battleship","mutation","hammock","importation","thug","semiconductor","ballast","spurt","extreme","artichoke","convergence","circular","rigor","realignment","physique","handbook","bugle","precipice","sauna","skater","furcot","volatility","valuation","barbarian","peddler","layoff","overall","deliverance","chromosome","innuendo","lexicon","empress","polarization","dictum","fitting","impediment","piracy","crocodile","cucumber","keel","sitcom","hypocrite","roaring","encroachment","steamship","resin","fairway","eyewitness","broadside","washroom","sighting","mantra","swan","supposition","governess","upswing","rep","solicitude","rustling","invocation","heather","rectory","orchid","brocade","raiser","invective","fragility","acronym","ostrich","col","absolutism","vicar","psychotherapy","navigator","cartoonist","doe","landfill","invader","werowance","ble","flatness","locality","druid","visitation","headlight","rapist","benefactor","colonization","excerpt","nick","kangaroo","pink","buy","cascade","campsite","slander","headdress","topcoat","causality","karma","trestle","atheist","checkpoint","renunciation","eater","payload","pointer","theologian","beet","undertaker","lineman","hart","gourd","doubling","shuffle","cabaret","periscope","bodice","shootout","grandma","wildcat","proton","dioxin","sorcery","torchlight","stopover","executioner","collage","mesquite","reincarnation","kidnaping","programmer","disloyalty","muslin","throb","mint","aquarium","tel","eccentricity","purification","kerchief","warranty","rigging","breeder","nite","conservatory","fastball","magnification","spa","favour","regeneration","incision","saxophone","detriment","scam","android","coloration","bunny","restitution","rake","serf","despotism","pollen","sidewinder","upstart","revisionist","birthright","multiple","lifeline","queue","follow-up","swipe","boardinghouse","armament","travesty","stirrup","caper","chloride","crepe","primer","clich","inflection","skid","repudiation","serve","spire","peep","inducement","clothesline","fabrication","morsel","spleen","coon","bustle","crossword","back-up","assessor","biopsy","sidecar","hassle","shingle","tint","fixing","collarbone","taint","pusher","gestation","mantelpiece","vaulting","ra","peat","indignity","adequacy","genus","scrape","scaffolding","serial","neurologist","duffel","cipher","rote","horseshoe","bulldog","electrode","joker","juror","fibre","misconception","rut","connoisseur","flowering","op","flirtation","highlander","wisp","sounding","bugger","pharmacist","doughnut","toaster","pinnacle","slob","promenade","amphitheater","singsong","beau","whimper","importer","locket","watermelon","marking","beta","co-author","crossbow","atrocity","desktop","inhibition","draught","rowboat","volleyball","snowfall","extravaganza","teddy","miscarriage","storefront","toxicity","abode","hearty","handyman","centurion","phrasing","anachronism","newspaperman","annex","walker","till","volition","tributary","close-up","nook","cleric","ferment","proverb","inlet","heretic","waistcoat","duet","sniff","crewman","campaigner","wearing","grizzly","p","optimist","placard","overflow","pedigree","clang","brig","cinder","bunting","wag","dishonor","denominator","gong","siding","trilogy","deli","fluoride","questioner","squat","competency","partisan","putter","entree","cynic","tombstone","scoreboard","biscuit","souffle","homecoming","overseer","hideout","brewery","emancipation","interface","premier","auditor","troll","conscription","stout","trucker","beetle","dealing","bookkeeper","build-up","yardstick","da","polity","wick","wrinkle","private","outflow","borderline","outfielder","visage","leper","chiffon","arbor","weave","barnyard","checklist","granny","insensitivity","ex-husband","barometer","rupture","infirmary","desertion","wonderment","encyclopedia","slaughterhouse","nostril","ineptitude","implant","infatuation","laundromat","warship","rub","benchmark","polygraph","dinghy","behind","tween","filibuster","wearer","crayon","sensor","hustler","sinew","progeny","dig","pediatrician","foursome","buckskin","cornfield","safeguard","divergence","ting","coupling","dislocation","the","immersion","purchaser","cleft","overhang","booty","scuffle","rattlesnake","teacup","retinue","hallucination","potion","yeshiva","tapping","rip","multiplication","canister","gallantry","morn","thermostat","grind","aviator","ecosystem","pariah","recruit","vestige","ro","phosphate","abomination","laurel","sweatshirt","vaccination","psychoanalyst","blind","psychosis","sidekick","shopkeeper","theorist","delicatessen","sheepskin","billionaire","receptacle","salami","paddock","glen","beech","leer","mime","ty","perfectionist","seedling","wil","bind","intolerance","dint","plural","rouge","skylight","mammy","drab","microcosm","sole","organist","court-martial","matinee","bulwark","must","expatriate","stethoscope","daydream","backer","godfather","breech","artifice","auxiliary","adventurer","atrium","counterman","idiocy","grotesque","dishonesty","runaway","digit","baseline","reflector","preamble","sellout","falcon","scribe","retainer","louse","grapevine","sojourn","lash","marquee","schoolmaster","squeak","squeal","shooter","townhouse","nationalist","billiard","backfield","auctioneer","aria","avant-garde","hostler","smattering","giving","coaster","arraignment","duo","malignancy","throwback","doc","turnabout","seeker","deletion","vernacular","bulldozer","tedium","hustle","raspberry","estrangement","mutilation","styling","incinerator","wrong","shortcut","mastectomy","infringement","bonding","timbre","cameo","workroom","grassland","spraying","cooperative","tarpaulin","determinant","thyme","innocent","clique","racer","leakage","conflagration","jingle","duplicity","diaper","conqueror","committeeman","robin","reprimand","marina","cross-section","flagship","denouement","recluse","homemaker","moron","rind","gent","magnificence","dispatcher","detonation","harbour","toddler","rotunda","sedition","fell","dolly","laureate","woodsman","syndication","clot","guitarist","blemish","password","overview","eggplant","incantation","drapery","incapacity","florist","hive","civility","mod","screenwriter","intoxication","barman","ern","furrow","cant","clapboard","tumbler","walkie-talkie","pajama","vortex","defenseman","hostel","subjugation","interception","armory","fanaticism","sibling","inhalation","undercurrent","husk","mead","maw","padlock","abnormality","penguin","undersecretary","damnation","independent","airlift","peel","schoolroom","rascal","fingertip","cartilage","dichotomy","blank","lingo","clasp","racquet","acknowledgement","rebuff","bier","aerosol","taping","checkout","arse","thoroughfare","pelt","copse","keg","fissure","tern","mirage","blockbuster","balm","arbiter","shutout","schism","fluff","circumcision","insertion","pseudonym","heathen","eulogy","snowball","penthouse","kinsman","gebling","regulator","proponent","yearbook","barbarism","mutt","reopening","paunch","governorship","differential","airship","subscriber","alloy","adjunct","impairment","incongruity","pheasant","grownup","predicate","loo","sleigh","seer","flitter","sunburn","plebiscite","stockade","pout","sledge","stipulation","lordship","bayonet","wretch","vulture","postman","breaker","newsroom","consort","grinder","ballpoint","tequila","unpleasantness","wrapping","squall","adage","monograph","privation","streetlight","hilarity","sacrament","diminution","mannequin","duplication","banishment","rasp","biochemist","goatee","cranberry","sultan","blip","disservice","idealist","middleman","shaping","apocalypse","strut","oligarchy","moor","zombie","certitude","javelin","azure","turnpike","forger","commode","bleach","sideshow","banister","closeup","dysentery","steeple","offence","commandment","furlough","best-seller","filament","mountaintop","censor","snowmobile","kaleidoscope","elf","imp","slipper","lunacy","telecast","nanny","kernel","eventuality","subordination","sonnet","nitrate","foal","prank","expropriation","fedora","zigzag","resale","namesake","highlight","supplication","concurrence","medallion","jailer","loin","tread","quill","cardigan","prune","slur","surtax","internist","strait","smuggler","panacea","turd","wanderer","crude","darlin","epitaph","docking","seashore","cheeseburger","netting","provider","dispenser","intonation","marching","caress","hootch","morass","chum","sanctum","headband","powerhouse","axiom","terrier","springboard","tot","latrine","toad","clink","herbicide","figger","hick","manger","poppy","chaise","archetype","undoing","beehive","illustrator","withholding","sterility","paddy","coven","custodian","half-life","embezzlement","armoire","kickoff","possessor","rectum","sit","daisy","housecoat","pollster","policewoman","ointment","expressionist","stockpile","bombshell","impresario","co-pilot","chessboard","dazzle","scepter","archdiocese","linguist","odyssey","capitol","accession","lute","liter","multimillionaire","decoy","warp","conveyor","grandpa","ance","mumble","betterment","bullfighter","chador","ampule","indiscretion","shake-up","clarinet","catapult","normalcy","shanty","dinosaur","epithet","tang","scaffold","immunization","repairman","suntan","mu","environmentalist","nightcap","tempest","artisan","orbiter","spiel","needlepoint","geologist","humanist","stutter","perplexity","roundup","concoction","treadmill","cacophony","antipathy","blackberry","bloodbath","brassiere","allergy","hitchhiker","grunting","choke","sitter","elixir","ba","repatriation","whack","decanter","crusader","burlap","incursion","lyric","compilation","seaport","coachman","philanthropy","secretion","collie","inquest","taper","moral","quartermaster","jeweler","salutation","confluence","gullet","tram","hideaway","by-product","drybone","copulation","divorcee","mausoleum","peeling","annuity","set-up","skiff","neurosis","windpipe","buoy","glide","archaeologist","pendant","junkyard","bullhorn","porthole","quandary","irrationality","acidity","pragmatist","derivation","stylist","duplicate","panther","brigadier","introspection","depravity","keynote","vexation","psi","weighing","deserter","speculator","teak","armful","remission","precursor","sorghum","harmonica","olive","gangway","contraband","defector","purgatory","genie","expedient","crowbar","desecration","bathhouse","enhancement","tenet","seasoning","wrangling","downhill","venue","tracery","dictation","bailout","undertone","pecker","prep","forerunner","bandstand","letdown","luminosity","tonnage","catwalk","brunch","sapphire","ballplayer","wineglass","readout","genealogy","horsepower","messiah","blackjack","hemorrhage","damask","registry","gunwale","jerkin","humorist","bowler","tingle","engraving","chauvinist","spirituality","eyepiece","twang","constancy","blot","blob","chard","highschool","sportswriter","tiara","domino","contestant","migraine","newscast","mainstay","hammering","tracker","wager","offshoot","buster","informality","python","felon","imperfection","slag","convulsion","sedative","cellblock","punt","headwaiter","outhouse","monstrosity","nonwhite","override","raisin","inversion","pancake","flavour","cataract","reclamation","churchyard","pidgin","suction","chanting","aggravation","dynamo","pee","fistful","hogan","byproduct","brooch","lullaby","workday","slop","silencer","dealership","earner","anchorman","pittance","crumb","custard","rainstorm","tote","mulch","mason","earl","barroom","levee","discouragement","falsity","compressor","lodging","gynecologist","divination","calico","bibliography","cyclone","senor","gatehouse","lagoon","squirt","artwork","songwriter","derivative","supernova","divan","photon","surety","cobbler","fatality","gout","eleven-year-old","ent","cropping","mainspring","prism","confederation","weaver","neighbour","yuppie","muffin","juniper","ovum","lesbian","pi","shimmer","fax","increment","co-ordination","splashing","thanksgiving","exaltation","confiscation","fairy-tale","fudge","brief","priestess","re-creation","hydrocarbon","ford","usurper","maelstrom","spaceport","swordsman","vegetarian","newness","grad","potter","manservant","fullback","fiend","giver","subculture","debutante","striving","scorer","catechism","charger","armada","blond","paign","handball","wince","appetizer","guidebook","jog","millet","hoot","inferno","pardner","mash","mousse","mammography","launcher","battering","predilection","portent","beep","exhortation","notification","warm-up","diatribe","panda","menstruation","telex","revitalization","workingman","cordon","charmer","fumble","hamper","moralist","settler","chowder","ley","mannerism","drunkard","posting","turquoise","elasticity","abbot","bookie","tusk","paragon","precondition","rollback","lunge","conundrum","eviction","sealer","cellist","cosmology","turntable","outside","fortification","nightstand","spook","shoemaker","sac","sulfate","isle","antigen","steed","bacterium","utopia","stunner","hillock","clove","irritant","tat","memento","rung","gaffe","portraiture","solicitor","rodent","barter","intensification","gallbladder","condom","antiquarian","peck","cheering","meteor","inflow","stenographer","blinking","icing","jackass","dweller","fiesta","irrelevance","harpoon","appendage","stipend","mommy","cassock","microfilm","dead-end","vermouth","scarecrow","fielder","referral","mart","burger","ticker","hindrance","coverlet","speedboat","wafer","sluice","bellboy","hangout","figurehead","midterm","petticoat","matador","skein","beholder","flier","waiver","flotilla","smudge","inequity","mixer","sulfide","banality","roach","billy","tailgate","gaggle","softening","loincloth","gore","bib","chrissake","changer","muse","longitude","tourney","mil","aorta","poop","regression","soviet","placing","winch","apostle","constant","squabble","blimp","abdication","porpoise","puncture","workbench","parameter","conventionalist","flagpole","unfairness","reptile","typist","bookshop","hesitancy","strongman","headland","sprint","manhole","blowing","archipelago","ideologue","slouch","poke","gush","stratum","mulatto","echelon","postmaster","sheik","emigre","alto","affectation","rad","climber","deerskin","bower","idolatry","reciprocity","sweet","wasp","dissection","baby-sitter","purple","toothpick","lyre","archer","sprawl","councilor","contrivance","flake","kynd","suffocation","damp","ware","travail","candelabra","wrestler","patina","moaning","paisley","recruiter","moderator","respondent","marmalade","bellow","harpsichord","atrophy","ejector","jetty","stripper","monorail","dramatist","hysterectomy","riverbed","revaluation","stoppage","conspirator","fetish","sunflower","cognition","scrim","rec","retriever","aphrodisiac","redneck","palsy","pullover","flywheel","roundness","peculiarity","ernment","nectar","ruck","swimsuit","curd","underclass","polka","conservationist","mire","drumbeat","cinch","cordiality","deacon","speechwriter","purr","gelatin","muddle","booby","solid","cloakroom","stopwatch","sportsman","burlesque","overload","mademoiselle","divider","bailiff","handout","ordination","stiff","languor","paperweight","opiate","snap","causation","mower","snatch","touchstone","self-indulgence","shrub","interceptor","mammoth","proceeding","cheekbone","spoke","repellent","cardiologist","reminiscence","sprinter","evocation","postscript","enlistment","blotter","troika","dacha","cabdriver","fund-raiser","switching","para","tendon","fireside","effigy","leech","veneration","reek","schoolyard","pellet","shellac","weasel","jab","carcinogen","restroom","cauliflower","levity","caftan","topside","fruitcake","bickering","drawing-room","dovetail","culvert","chateau","bugging","tinker","hobo","corset","automaker","actualization","oration","handhold","nutmeg","tentacle","quicksand","handler","panoply","bowhead","testimonial","mammal","bellhop","devotee","technicality","trainee","mongrel","newscaster","aggregation","footpath","fawn","accreditation","heave","jib","rationalist","vendetta","midpoint","buckboard","screwball","hatchway","disinfectant","cramp","causeway","tease","corkscrew","sledgehammer","sloth","materialist","mogul","stopper","bevel","carbonate","berry","snore","throwaway","agribusiness","rerun","guillotine","nip","computation","keyhole","storybook","watercolor","cer","porcupine","urging","cockroach","esse","headman","settee","usher","short","obstetrician","faggot","ballpark","palisade","whimsy","co-owner","spout","nub","pectin","dun","cypress","trombone","scat","lite","dame","quip","invisibility","baboon","sneeze","swish","originator","biennial","newsreel","chameleon","dressmaker","storehouse","trapping","statistician","bloke","helmsman","ewe","drape","trump","great-grandmother","cloister","caterer","grounding","hotbed","life-span","urinal","funk","bedchamber","boudoir","theoretician","oddball","nameplate","raven","ditty","canary","anticommunist","reconsideration","playboy","skate","transparency","uplift","six-pack","rambling","commendation","wimp","pestilence","sufferer","kelp","counterforce","self-doubt","deformity","croak","marine","marksman","directorate","reversion","stimulant","dence","beloved","eraser","slurry","tracing","bigot","compendium","entitlement","monolith","misrepresentation","darkroom","nutshell","torque","concubine","peephole","lesion","bogey","spindle","birdie","nugget","tenon","supercomputer","weakling","provenance","vowel","empiricist","filet","co-founder","prelate","onlooker","tricycle","sax","catheter","accessory","fresco","prod","oscillator","self-image","refraction","excretion","prance","insurer","cask","impersonation","rangeland","toothache","magnum","accuser","rubbing","carver","carnation","masquerade","trapdoor","shaker","mittee","tux","poignancy","payday","captor","couplet","mutant","jogger","raider","dilution","sickle","prowl","blister","reassessment","infirmity","matchmaker","workload","restaurateur","tuning","wiretap","perpetrator","davenport","lamppost","inductivist","affect","sterilization","booming","rucksack","repurchase","starship","bystander","taker","spaniel","teletype","cuckoo","sneaker","aspen","soundtrack","sacrilege","surname","succor","co-chairman","anticlimax","hopper","jumpsuit","rinse","rummy","cigaret","washcloth","butchery","almond","cooker","implement","effluent","cheat","threshing","silicone","draining","vector","shopper","dandelion","pecking","brazier","cobblestone","slugger","sacrificer","airlock","lunchroom","zebra","ejection","cutthroat","wizardry","crony","kennel","internship","cohabitation","omelet","wheelhouse","redundancy","schema","psychopath","buttock","grasshopper","playmate","lamentation","socialite","cornucopia","lichen","coterie","warlord","discomfiture","frieze","montage","traveller","curvature","condensation","vineyard","scraper","generality","archive","half-sister","gangplank","intimation","doublet","pleading","tome","quadrangle","connotation","lifeboat","blueberry","coinage","prospector","bash","disciplinarian","dualism","bookshelf","adjutant","clod","apportionment","footbridge","tourniquet","spore","slicker","jetport","magenta","schizophrenic","oilman","harbinger","trespass","merry-go-round","sabra","old-timer","vigilante","melanoma","torpor","gliding","refutation","dab","jurist","plumage","kitty","cauldron","abbey","jasmine","lefty","cabal","detonator","retiree","abatement","clamp","roost","councilman","halfback","centimeter","shirttail","whispering","stratagem","exponent","cheesecake","truism","jaunt","node","ironclad","undertow","self-portrait","urchin","idealization","splendour","antechamber","living-room","sampler","friar","irregularity","lateness","playback","binder","washbasin","tummy","capitulation","felicity","canter","birthrate","earthenware","kitchenette","foundry","ladle","babushka","chlorophyll","adjournment","villager","recrimination","hotshot","blaster","pruning","soloist","hummingbird","recuperation","bequest","hemlock","cottonwood","drawbridge","alternation","malt","interconnection","mugger","tuft","keystone","riverboat","thrall","ayatollah","highland","mistrial","bunkhouse","anesthesiologist","dredging","anode","salsa","prizefighter","neckline","chile","foreclosure","cola","digression","scythe","lout","chamberlain","minefield","sabbatical","appraiser","isotope","demarcation","garnet","buzzard","repulsion","lowland","snifter","bending","weekly","dispensation","botanist","sari","stabbing","ovary","skullcap","journeyman","thievery","look-alike","parson","heartbreak","distillate","neophyte","blower","storekeeper","firmament","taxicab","corona","fusillade","publicist","resume","breather","casement","smokestack","interrogator","outcropping","mecca","dilettante","shoestring","belch","behemoth","negligee","heath","smut","negative","fistfight","regent","incumbency","curragh","toga","ministration","turnip","beamer","stepladder","loon","businesswoman","jumbo","whining","spoor","posturing","parlour","concertina","alkali","rampart","chime","warmup","taffeta","hyena","firehouse","sweetener","guessing","pronoun","madhouse","lioness","breadwinner","diocese","escarpment","mimic","retina","larder","gnat","hothouse","ponytail","markup","bevy","revocation","depressive","garner","redefinition","lifter","stateroom","nutritionist","isolationist","surveyor","polemic","ornamentation","gouge","counterweight","thrower","illegality","joining","lumberyard","wholesaler","obeisance","stagecoach","substage","lockup","nudge","rejoinder","compost","carburetor","peacemaker","prologue","swinger","right-of-way","precipitate","sprinkler","crone","valentine","vassal","tabloid","minstrel","nursemaid","attribution","courtier","docket","spool","convocation","serviceman","letterhead","zealot","negro","cackle","masthead","dispersion","underwriting","armload","noodle","squawk","periodical","reformation","boa","starlet","about-face","ejaculation","encore","harangue","woodpile","earlobe","reaffirmation","handlebar","compunction","contemporary","midriff","nimbus","householder","postgraduate","quirk","innovator","sneak","straitjacket","pussycat","belle","kidnapper","spacing","laying","standout","estuary","duster","jackpot","motorboat","welterweight","kicker","expectant","revue","senior","epistemology","yeoman","firearm","granddaddy","projectile","stammer","crossfire","toxin","hookup","phantom","transgression","flagstone","acuity","twick","acolyte","directorship","corpsman","worktable","mammogram","wart","liqueur","unbutton","receivership","duchess","delinquent","picker","earphone","blare","promontory","formalism","infamy","operative","hock","crusher","megaphone","retrenchment","chaser","dementia","wane","triviality","quadrant","curate","pairing","forging","dermatologist","mango","bon","moccasin","hayloft","marionette","seedship","ooze","interloper","twill","solicitation","trowel","professorship","scrimmage","scrawl","blockage","parkway","motorman","snapper","transcription","vasectomy","binary","flagon","choirboy","butte","throbbing","bound","thunderbolt","dike","cowbell","elect","prodding","lynching","rant","drifter","snot","preservative","brogue","tary","tortoise","lattice","strudel","composite","churn","median","neurosurgeon","mariner","kiln","boarder","ama","petal","friendly","clearinghouse","swastika","filler","enquiry","dispensary","chump","archeologist","rescuer","dy","draftsman","snicker","shakedown","romp","construct","conclave","winery","polarity","breakin","wailing","gurgle","bedroll","commissar","albatross","shading","peal","taverna","chicanery","has-been","waistline","oaf","satirist","faint","myosin","dimple","landfall","smithy","tough","gunboat","busboy","cassava","poplar","discontinuity","obelisk","blubber","demonstrator","meltdown","abolitionist","thorax","holler","pimple","sending","druggist","indirection","leotard","ken","showman","despot","ombudsman","lyricist","dearie","lumberjack","gaff","pagan","cremation","infarction","sturgeon","publican","bottleneck","chambermaid","pectoral","purser","godsend","whisk","canard","concentrate","copter","shipwreck","laundering","clipper","notepad","jackal","indentation","basilica","adhesive","mermaid","knighthood","personage","omelette","whoosh","embellishment","misgiving","tracer","brawling","crucifixion","steal","transference","sleight","threesome","windowpane","bereavement","viceroy","betrothal","refresher","seagull","jay","needler","discoverer","goiter","caterpillar","impostor","diminutive","cation","playpen","amputation","confidante","dockside","inquisition","chronicler","seamstress","lath","absolutist","cadaver","perusal","subterfuge","self-satisfaction","sawmill","agitator","shortcoming","breakwater","microcomputer","lima","greatcoat","mahout","prima","undress","superstructure","stopgap","moo","bio","fret","pomposity","bough","autocracy","anchorage","samovar","gen","burrow","rosebud","segregationist","mortise","hydrant","postmortem","oversimplification","entryway","paintbrush","rea","balustrade","chuck","trumpeter","ferret","opportunist","pinnace","salamander","transom","mace","individualist","synthesizer","thoroughbred","cupola","tomboy","ensign","bottling","whir","poultice","entranceway","saver","gurdwara","renegotiation","tossing","ruffle","footprint","skeptic","birthmark","tailspin","kickback","chalice","plagiarism","passer","inhumanity","ceremonial","sapling","babysitter","creeper","galleon","bellman","holly","hacienda","cur","transplantation","scab","ballgame","demotion","flimsy","hovel","lug","layup","firefighter","gravestone","nymph","cajole","tickle","boxcar","secession","refractor","somersault","personification","treacle","tutorial","voucher","thimble","stickler","front-runner","paroxysm","exorcism","psalm","infestation","scrubbing","castor","peppermint","orchestration","extremist","oppressor","lode","prompting","watchword","swindle","statehouse","floater","nightdress","bloak","elegy","woodshed","trembling","banning","adornment","redoubt","lightweight","postulate","anti-Semite","tasting","viewscreen","sentinel","nation-state","heft","nurture","villainy","manhunt","invoice","sprig","self-denial","selector","piglet","commemoration","crucible","piper","curtsy","lackey","breastplate","gadfly","octave","epilogue","self-examination","thyroid","apologist","chemise","super","figment","waif","essayist","brewer","miniature","sediment","cannibal","tulip","caramel","caseload","synonym","analogue","ver","shirtwaist","cornerback","insecticide","debauchery","lien","strangulation","intricacy","guesthouse","crumbling","glassware","cachet","thumping","damper","colonist","frolic","ogre","heist","sorting","pawl","muttering","refill","cowl","imbecile","painkiller","garter","creole","overpass","simile","potpourri","piling","predisposition","corsage","mobster","sandal","aphorism","vice-chairman","heartache","converter","pecan","ecologist","substrate","quagmire","trenchcoat","voyce","overstatement","soapbox","rediscovery","effusion","agronomist","firecracker","haunt","murmuring","henhouse","fluctuation","signora","mulberry","hoist","bullfight","discotheque","finder","tureen","hairstyle","dignitary","consummation","spar","pogrom","beeper","read","outboard","sho","skit","impurity","sadist","parafoil","bouncer","spender","locust","boardroom","burnout","inoculation","surfeit","welder","propagandist","mortuary","pessimist","equivalence","juke","spatter","incubator","reproof","gulch","notary","speedometer","lodger","mitt","southpaw","footman","amity","bloodline","cleaver","coffeehouse","confederate","assist","ation","lecher","abrasion","daybed","knit","laddie","forfeit","kebele","filigree","frisbee","cantina","oscillation","countryman","juggler","scion","acrobat","hourglass","realtor","onyx","pettiness","chancellery","footfall","slippage","mandarin","eral","lob","impertinence","providence","dom","idyll","democrat","deferral","sorority","slamming","badger","mutter","ling","strobe","explosive","municipality","crossover","bedstead","spatula","tug-of-war","goon","pauper","lation","sacking","alder","nightstick","salve","infraction","prowler","falsification","pant","drunk","rumbling","ce","minuet","plaything","yelling","kiddie","duction","buttress","carapace","sobbing","insufficiency","prig","bidet","bloodhound","madwoman","buffoon","vignette","doorjamb","caprice","gable","converse","cad","creche","mullah","spectre","spotter","ingenue","chalet","automatic","stash","truckload","tailback","static","productivist","dissipation","haunch","nag","awl","self-delusion","rattler","blacklist","beagle","trapeze","obstinacy","fiddler","theorem","rearrangement","changeover","reassignment","courtesan","fillet","nay","cutout","luncheonette","purveyor","incitement","remarriage","amelioration","executor","buttonhole","duality","churchman","sickroom","farmstead","jester","perfidy","cuticle","weal","snub","pretension","roadbed","furnishing","quickie","workweek","conveyance","pseudopatient","turbocharger","fleece","abbreviation","spigot","leaflet","great-aunt","ninny","beaker","experimenter","validation","inhabitant","grading","cantaloupe","potentiality","flue","commoner","playroom","readjustment","boathouse","vivacity","brakeman","petitioner","singularity","gage","delineation","fester","paratrooper","font","pitchfork","signifier","crossbar","playhouse","tripe","stylus","pacemaker","clustering","hone","runt","emporium","ragtag","aneurysm","trapper","pulley","thrashing","candlestick","checkerboard","swoop","surcoat","dystrophy","bristle","beck","toolbox","hunchback","subcompact","doze","seaway","disclaimer","arbitrator","miller","crackpot","loafer","instigation","sen","bale","skim","skip","dollop","tender","oeuvre","goner","sor","tort","cropland","profundity","caf","zoom","gabardine","quack","cataclysm","condolence","foxhole","circlet","brave","misfit","bivouac","artificiality","dachshund","puke","bagel","sortie","nomad","opal","ethnicity","firebox","ratchet","cud","worsted","squabbling","cheque","jean","avatar","dirge","footstool","velour","barrister","pression","microchip","coda","reappraisal","cess","hangman","centenary","plough","broomstick","headstone","tormentor","sore","rathorn","voyeur","world-view","co-star","warren","fail","deflation","noble","fleck","saleswoman","hap","machinist","waffle","tom","ell","prefab","suckling","guardhouse","sabre","entanglement","integrator","quarterly","paraffin","heifer","frivolity","good","bougainvillea","excommunication","distillation","cyclist","meteorologist","rubric","cul-de-sac","misnomer","phobia","demagogue","bloodletting","raconteur","ger","astrologer","zygote","counterrevolution","reinstatement","anchovy","getup","tryout","scullery","turnstile","cyst","mustang","gaslight","self-deception","emanation","grown-up","escapade","versity","fishery","paprika","grailstone","gurney","fount","holdout","licensee","jackknife","asterisk","still","fundamentalist","humbug","repast","christening","butternut","miniskirt","fortune-teller","spillway","ference","salver","payout","nodule","high","tugboat","gizzard","sympathizer","fibrillation","incompatibility","dodge","trove","mercenary","pigtail","matchbook","masterwork","barb","endeavour","confection","ephor","yarmulke","char","mimeograph","holdover","subtitle","saddlebag","metronome","tine","testicle","caveat","etching","auntie","guarantor","ringer","airman","boatman","carnivore","armband","polder","tryst","lem","sitting-room","barrow","reappearance","pastiche","bankroll","stroller","saxophonist","blanc","redesign","plotting","gruel","juicer","slat","scooter","socialist","gradient","ember","scorecard","remembering","bo","forecaster","flirt","backache","parakeet","pixie","guffaw","anesthetist","logjam","pursuer","physiologist","follicle","coverall","patsy","bunt","lubricant","jawbone","numeral","mourner","rune","bettor","solder","nitrite","rime","pinstripe","pistachio","monocle","equivocation","crystallization","twit","two-year-old","toupee","eyelash","recognizance","cy","sophistry","seesaw","loony","do-gooder","dusting","commonality","yearling","disbarment","self-congratulation","tsar","vagabond","rhinestone","viper","planetoid","crochet","laird","flatland","prompt","catamaran","wigwam","mainframe","shivering","stringer","vane","iniquity","hoodlum","tableware","smelter","overlay","umber","placenta","yew","right-hander","laggard","cornice","philanthropist","scouring","dissenter","mainsail","showplace","conch","sentimentalist","protectorate","sanitarium","truancy","angler","showpiece","carotene","pollutant","diabetic","hairbrush","videodisc","intellectualist","pothole","setter","tense","grader","kneecap","birdbath","dell","typhoid","tuba","torturer","commie","houseboat","revelry","medalist","hinterland","jowl","splotch","sable","mouf","ripoff","coolie","streetlamp","damn","sharecropper","oral","schoolmate","commander-in-chief","capitalization","flex","shtetl","chenille","pullback","pharaoh","claret","fulfilment","glower","remuneration","internationalist","pap","pediment","sonata","toke","co-director","dollhouse","salesgirl","greenback","analog","ofa","freelancer","hairpin","aphasia","kicking","bummer","lawmaker","thickening","juggernaut","comma","sander","claimant","triad","rhizome","prolongation","placer","transvestite","faceplate","shortening","coffle","surfer","greengrocer","roughage","dumbbell","coiffure","pinky","ex-President","start-up","bobby","sidearm","paean","raiment","conceptualization","surmise","agnostic","cranny","tassel","infarct","pitchman","minor","stationmaster","sublet","puter","dramatization","mounting","washstand","counsellor","penknife","curtailment","remake","millimeter","sextant","vocalist","blowup","walleye","pickax","fanny","ascendant","brushing","highball","bandleader","winning","godmother","horoscope","disequilibrium","run-up","grazer","sandbar","motorbike","hassock","piggy","teat","reprise","wheeling","psychotherapist","calabash","cob","relativist","packer","slayer","digger","banshee","autocrat","knave","muskrat","extinguisher","foreleg","sobriquet","hospice","accretion","mastermind","figurine","newsmagazine","epidemiologist","pic","minaret","dereliction","city-state","jawline","escapist","legation","weatherman","sinker","cabby","guardrail","objector","timepiece","cistern","werewolf","decadent","harlot","epiphany","bricklayer","doorkeeper","obsidian","bedpost","constriction","refectory","blackbird","enforcer","riposte","schmuck","squab","pop-up","handrail","sandbag","superman","underbelly","alarmist","sesame","paratroop","droplet","proclivity","theorizing","quark","tactician","sundae","poolhall","behaviorist","dipper","postmark","co-conspirator","carload","electrocution","mould","goodnight","appendectomy","statuette","coefficient","cornet","scolding","prude","platitude","carport","lilac","geisha","foist","mitigation","percussionist","lechery","wyrm","charlatan","tussle","slough","jamb","twister","lakeshore","scavenger","pinkie","changeling","pinhead","muster","exploring","fief","critter","haystack","skimmer","geyser","stumble","update","tabernacle","gargoyle","projectionist","requisite","suffix","ramrod","betrayer","perience","tance","fluting","flare-up","fatherland","guardianship","douche","good-night","trawler","headsman","stoplight","operetta","spend","hater","teakettle","geneticist","particular","wardroom","slider","deuce","gingham","telethon","acclamation","centrifuge","workstation","pretender","prong","lampshade","ureter","hiccup","acetate","molding","wallop","vagrant","three-star","carafe","blowout","equinox","rave","junior","spoof","confessor","troubleshooter","braggart","judgeship","rapier","landmass","stoic","cuckold","inheritor","forester","jangle","gymnast","wingman","stein","gnome","drumstick","whatnot","yachtsman","realty","glob","by-election","academic","deflection","knocker","wondering","mugging","petit","frosting","pillowcase","panelling","grendel","tribune","tabulation","simulator","whaler","stork","gill","cavalcade","workhorse","locksmith","preppie","henchman","countertop","groundcar","puree","wellspring","debasement","prankster","tration","insert","put-down","typer","chartreuse","crematorium","headpiece","noncom","wipe","drove","sportscaster","impersonator","shrew","twitching","loader","magnolia","dropping","functionary","dissonance","cudgel","forfeiture","glutton","reject","doubleheader","tarp","suburbanite","afghan","chaperone","bas-relief","oscilloscope","imposter","newel","trusteeship","shocker","cannonball","half-breed","woodpecker","tumbleweed","snip","consignment","left-hander","spoil","also-ran","exhalation","signification","tester","ashram","gardenia","deductible","frontline","subtraction","bowstring","upland","bearskin","gramophone","mock-up","serenade","mix-up","extrapolation","tidbit","semaphore","banging","dogwood","carol","mapping","exchanger","ignominy","retraction","videocassette","precept","sirloin","mortification","pagoda","belfry","cubbyhole","mindstone","greyhound","clank","snowbank","instep","sanatorium","savanna","longshoreman","copier","nightshirt","boatyard","brigand","usurpation","understudy","interrelationship","undercarriage","sulphate","quasar","marshmallow","thrush","sweeper","alleviation","feint","chimera","infidel","modifier","perennial","simpleton","gridiron","overlord","airway","binding","abstention","algorithm","amalgamation","ascension","herdsman","lollipop","pastel","laminate","tendril","synopsis","drawstring","intermarriage","restorer","swoon","firefight","civilisation","self-criticism","hanky","ventricle","jot","interferon","circel","avenger","stepson","amethyst","beachhead","loggia","sizzle","burp","watchtower","endearment","dryad","prefect","tong","croissant","blocker","brioche","thistle","sunburst","savor","dumpling","checker","soliloquy","marketer","wheeze","molar","oboe","inbound","masochist","superficiality","tabby","outcrop","deputation","bassist","particularity","strop","thang","doggy","zation","ghoul","domestic","frostbite","relapse","floorboard","clicking","paraphrase","sinkhole","pushcart","overdraft","spinnaker","sourdough","sweatshop","meteorite","lander","caboose","junket","planer","iguana","brouhaha","reaper","sharpshooter","eggshell","self-sacrifice","minnow","skyrocket","connexion","effrontery","oblong","biker","flinch","cog","bullock","retrial","underwriter","gentlewoman","noggin","sissy","collect","dogmatism","sweatsuit","biplane","polariser","server","hiker","electrolyte","thunderclap","bronc","snooze","mascot","sherbet","carillon","decal","womanizer","underground","tailcoat","worshipper","automaton","proscription","sleuth","honeybee","abutment","foller","palladium","partake","jailing","counterfeit","pompadour","moneymaker","acacia","monthly","geographer","doghouse","bludgeon","fitter","conservator","indecency","atoll","fife","acquit","barracuda","mortician","striker","plait","untruth","hoarding","eighteen-wheeler","shakeup","grounder","abuser","hamstring","parishioner","cherub","cubist","antler","kisser","shunt","cravat","admixture","whinny","scorpion","amenity","matchup","spacer","settling","insinuation","possum","tenancy","girder","adapter","mousetrap","cubble","steppe","hypochondriac","covey","whipping","taunt","pocketful","pug","panhandle","conga","citron","foul-up","plaint","nouveau","oilskin","meridian","lifer","bolster","wren","gripe","mountaineer","transceiver","treetop","hex","harrow","tampering","photocopy","redskin","cesspool","barrette","cleanser","missive","breakfront","mini","ridgeline","semi","pasha","byword","phoneme","seducer","miser","cookstove","limerick","cummerbund","labourer","ascot","wraith","tarantula","toffee","pituitary","liana","cleat","line-up","helix","highboy","bicep","partment","coed","expletive","dumpster","deferment","progenitor","sandbox","mignon","typhoon","sublimation","backdoor","alchemist","pacifier","insomniac","hairpiece","lintel","indemnity","blurb","republican","electrocardiogram","futurist","recliner","mote","sketchbook","fulcrum","gratuity","aqueduct","adherent","masque","sundial","template","handmaiden","hedgehog","coding","corsair","solstice","orifice","sonobuoy","prizewinner","spinner","townsman","rosette","mind-set","unkindness","pushover","bility","infielder","hutch","erasure","parallelism","avowal","fastness","broadcloth","hellhole","grandparent","toehold","ident","sleepwalker","watching","aerie","database","mismatch","hombre","scrambler","spoiler","putdown","rookery","spinoff","ringleader","duchy","sealskin","transformer","doggie","bedsheet","cowhide","ceramic","prostration","cheroot","houseboy","giantess","tomcat","speedster","basalt","minicomputer","rapacity","spaceman","in-law","equerry","humpback","academician","harvester","fairground","ream","carat","entreaty","groundswell","obfuscation","provocateur","fugue","denigration","rifleman","manipulator","panting","synod","glitch","nightie","goaltender","kingpin","comforter","anesthetic","klaxon","hijack","orb","hostelry","gladiator","misadventure","bombard","fixity","tanner","stringency","wonderland","x-ray","plainclothesman","roadhouse","travelogue","gasket","nibble","hacking","nude","tincture","receptor","fink","schoolmarm","washtub","homesteader","hacker","portiere","hatbox","tamer","howitzer","grouper","frontage","amoeba","clime","flashback","teamster","accolade","polluter","officeholder","inpatient","altercation","reverberation","coproduction","phosphor","substation","bandana","sapper","preserver","pigeonhole","prefecture","milkman","avocation","argyle","amphetamine","linker","leviathan","hamster","bondsman","comer","bumpkin","sheikh","beefsteak","tyke","discoloration","kingmaker","quotient","excision","whitey","asymmetry","trill","discourtesy","bleat","hatching","crier","creel","seabed","witticism","riser","lurcher","moviemaker","pantsuit","linchpin","deformation","deodorant","soybean","washboard","egotist","underpass","dysfunction","tingling","barstool","paramour","udder","microbe","radiologist","qualm","welt","salesperson","signpost","sepulcher","lumpectomy","slaver","shopgirl","peregrine","siesta","reiteration","profligacy","iodide","iconoclast","rollcall","fillip","oratorio","splat","incoherence","accompanist","motorcar","nunnery","busybody","carryall","nettle","jaguar","pretence","odometer","potentate","mussel","prophetess","monetarist","proach","typescript","hacksaw","broadsword","miter","fatty","terrarium","archangel","powerboat","stooge","cannery","pylon","pulsation","misstep","yucca","hearthstone","rumour","lockout","toboggan","trampoline","concatenation","debility","acorn","forklift","psion","dragonet","ligament","folio","tie-up","picking","swatch","arrowhead","martinet","fisher","quintet","ellipse","legitimation","nightwatch","hardback","schemer","conversationalist","collectivist","reallocation","diorama","cutaway","point-of-view","cattleman","abscess","talc","incubus","dribble","sis","rhododendron","rolling","spiderweb","nonsmoker","crissake","refusenik","save","obstructionist","suture","parenthesis","reefer","great-grandson","steelworker","bumblebee","bullfrog","festivity","embolism","defeatist","tankard","ferryman","garret","co-worker","consonant","copywriter","bookseller","compress","dogfight","embezzler","quiche","liege","dissector","taskmaster","prosthesis","emulsion","spitball","modulation","squint","retelling","baiting","whirr","air-conditioner","individuation","geezer","aspirant","pensioner","re-enactment","flapper","looker","marshland","sexton","adverb","coenzyme","misapprehension","inaccuracy","barmaid","beautician","daredevil","racehorse","oxford","spume","busload","tradesman","manicure","propellant","apothecary","ruffian","titillation","instigator","siting","ringmaster","enumeration","twirl","bookmaker","technocrat","mouth-harp","quaver","icehouse","ventilator","roadster","subpena","carter","comedienne","savannah","milkmaid","pumper","signer","deadbeat","cofounder","bootlegger","tribesman","wildfire","shard","hailstorm","struction","routing","dolmen","idiosyncrasy","poniard","honky-tonk","spendthrift","draftee","hermaphrodite","pinafore","roundabout","frill","redeployment","ophthalmologist","caldron","reinvestment","troubadour","fjord","leave-taking","elongation","clinch","trinket","suasion","neutralist","finalist","whiplash","ventriloquist","violator","monarchist","spanking","grindstone","initiator","standard-bearer","sender","atelier","distemper","ingot","frontiersman","altarpiece","endgame","homily","synapse","pillbox","ochre","scimitar","jubilee","presentiment","tation","aggrandizement","truncheon","damsel","fallibility","papaya","piggyback","puppeteer","workhouse","nightingale","entomologist","wicket","debriefing","logician","moorland","minimalist","matte","skirmishing","tonality","maidservant","yam","gatekeeper","whammy","drudge","angora","garland","manoeuvre","moviegoer","slingshot","titan","re-evaluation","ironwork","ambassadorship","lanch","pollination","riage","vocalization","brawler","shaving","particulate","inhaler","impoundment","surfboard","waterman","almanac","pepperoni","kook","colonnade","infantryman","scruple","functionalist","wisecrack","conscript","boor","bannister","pretzel","analgesic","firebrand","microprocessor","frame-up","guardsman","teetotaler","broad","pallbearer","airframe","wrangle","backboard","knockdown","reparation","poorhouse","milkshake","battlement","dragonfly","paymaster","snuffler","crudeness","nerd","blockhouse","donut","backhoe","principality","dimmer","wounding","collier","beater","footlocker","barkeep","absurdist","brickwork","great-uncle","rumination","appellation","joiner","hydrolysis","interlocutor","raindrop","hardtop","groping","cymbal","miscellany","pomegranate","hearer","abortionist","corncob","shoal","dunce","bellowing","bridgehead","mangrove","blotch","boxwood","briar","which","trickster","epileptic","dependent","encumbrance","claque","pickpocket","half-truth","bilge","overrun","caveman","posterior","derriere","sty","maggot","vibrator","imbecility","hang-up","syllogism","blindfold","sunbeam","chrysanthemum","amour","ne'er-do-well","odour","flowerpot","satrap","reconnoiter","tonsillectomy","clampdown","coliseum","warbler","hubcap","crudity","baseboard","lithograph","homeroom","stanchion","amphitheatre","disquisition","commonplace","feedlot","reprint","shire","kraken","careerist","goatskin","worldview","waddle","washout","doormat","diadem","sniffer","spat","superhighway","snooper","libation","zoologist","subtext","bailiwick","exterminator","popsicle","actuary","cabinetmaker","swami","contraceptive","softener","margarita","hatter","tention","earpiece","dormer","timberland","katun","crooner","one-liner","adjudication","snitch","referent","subset","disavowal","starburst","merchantman","dalliance","polymer","hypnotist","monogram","peerage","claymore","satyr","twerp","matchstick","rubber-stamp","clapper","exhibitionist","warhorse","eatery","seashell","radish","router","dinette","trombonist","rivet","requiem","breakaway","hard-liner","locator","shindig","corrective","truffle","whelp","expediter","savant","mitten","canton","wobble","misinterpretation","fense","headwrap","conciliator","chine","topping","assemblyman","divine","scuffling","boomlet","dervish","yellow-green","stockyard","hummock","trimming","royalist","calumny","vandal","prickle","strikeout","apologia","afterburner","hunker","flippancy","fop","embrasure","hornet","tithe","oilfield","lawman","turnkey","fledgling","coauthor","blowpipe","subjectivist","backstop","fishbowl","bedpan","sedge","protrusion","crybaby","freedman","seminarian","spacesuit","tautology","footstep","fiveyear","stoneware","mance","generalist","quitter","domicile","requisition","seance","cabana","wastrel","underling","looter","glassful","wallow","boater","disharmony","shiksa","herringbone","flyleaf","eyesore","lawnmower","walk-up","hemline","wiggle","posing","whirring","cropper","reappointment","psychodrama","shaver","orthodontist","granary","extrovert","calfskin","thinning","foghorn","trainload","carbide","metier","harpist","minim","ballcarrier","rayon","bursting","flipper","fastening","mullet","exploit","squatter","nullity","commodore","newlywed","eavesdropper","chiropractor","miler","arsonist","wrecker","transmutation","incompetency","subcontractor","tress","meatball","bobcat","distributorship","camcorder","pasty","glimmering","groaning","classicist","stakeout","supplicant","repeater","crackling","cryptographer","croupier","honeycomb","insincerity","inhibitor","mystification","greaser","barker","anthill","barbarity","strangle","myrtle","segmentation","marlin","capon","toenail","flip-flop","auger","blasphemer","dipping","pawnshop","penumbra","mohole","bauble","rube","flophouse","triplicate","sardine","master-mason","fang","brainstorm","derangement","hanker","molestation","smokescreen","cavalryman","edging","layover","signalman","clavicle","crewcut","tricolor","cochairman","liberationist","foreskin","bleacher","semi-circle","quince","flatcar","abattoir","farmboy","tibia","thrum","conformist","southerner","docudrama","whorl","break-up","conglomeration","exhibitor","bramble","cutie","woodchuck","compatriot","stole","tuner","housemother","dharma","femme","teahouse","banquette","bottomland","arranger","philistine","vacillation","chiton","retch","caddie","reissue","teaser","swampland","deejay","libertarian","pegboard","greenhorn","dork","cellmate","jobber","wishbone","millstone","haunting","blow-up","snorkel","snowplow","trespasser","punter","snowflake","snowdrift","gunnysack","surround","evergreen","clog","radioisotope","cougar","pundit","wattle","subgroup","oviduct","mixup","misstatement","sulfite","pansy","splint","counterproposal","pulsar","remove","landau","four-year-old","rebbe","disconnection","neomort","exegesis","meteoroid","meringue","sheepherder","radioman","strumpet","opment","millionth","speakeasy","conformation","cultivator","goof","annual","gazelle","demitasse","fishhook","preferment","homebody","skewer","chancre","sorbet","hologram","rivulet","oldster","prisoner-of-war","tulle","riff","restatement","debit","emplacement","repre","invariance","half-circle","objectivist","passer-by","scarlet","flail","impala","persimmon","purist","gation","burgher","snowman","starling","barony","annulment","lifespan","herder","embolden","swathe","ex-convict","trouper","half-wit","fuchsia","grange","ricochet","stinker","opacity","colander","absorber","armadillo","pleasantry","noncommunist","taxiway","overtone","debater","taillight","advisement","birdcage","baroness","aureole","breakout","colouring","astrophysicist","flatboat","stilt","eyeshade","barbell","deliverer","fishnet","prise","jackrabbit","manifold","chattel","jimmy","workshirt","thornbush","chatty","frisson","recount","patentee","oceanographer","forepaw","murderess","whalebone","frontrunner","cerebrum","jector","militiaman","lobsterman","earthling","clean","swindler","scree","begat","doorsill","housedress","strangler","shantytown","roughhouse","scenarist","foothill","contaminant","hamadryad","phony","fairyland","seascape","treble","prodigality","hobble","gantry","backroom","enticement","sawhorse","interviewee","cliffside","dustpan","scrubber","imbroglio","acquaintanceship","woodworker","aesthete","octogenarian","mauling","archivist","pungency","interweaving","jabber","bassinet","doubler","torte","linkup","outdoorsman","fixer","caddy","fumbling","defile","meristem","microbiologist","urologist","stovepipe","tambourine","constructionist","egomaniac","adjuster","liniment","impiety","timeline","cowgirl","sinecure","chillun","foreword","frat","retary","bagpipe","coif","visualization","colleen","shirtmaker","flounce","adder","riffle","underboss","reinterpretation","bender","seeding","fiver","sicken","decoder","holothete","figuring","stave","earplug","acrylic","epigraph","fairytale","flasher","sally","inkwell","nitwit","hussy","constrictor","stabilizer","stickup","seaplane","shimmy","dredge","updraft","speciality","insulator","frond","storyboard","shill","rafter","blowgun","dukedom","favourite","populist","striper","blowtorch","mallard","licking","poetess","tetracycline","ad-lib","toxicologist","fencer","gnawing","eration","photocell","golem","heirloom","penitence","gence","latecomer","broil","outdistance","howler","canine","replenishment","traditionalist","emcee","eyeglass","billow","eyelet","khaki","assignation","tepee","buccaneer","bellyache","parkland","musicologist","phaeton","spirochete","lanyard","mischance","tobacconist","blusher","castaway","meson","bouillabaisse","scrivener","stinger","life-cycle","harridan","motivator","mooring","crimp","inlay","purveyance","vertical","jackhammer","strongbox","dishpan","cobweb","couturier","chalkboard","basilisk","duckling","penitent","footrest","tangent","facing","peroration","floodlight","nouvelle","truss","sprite","drier","esplanade","banding","insulter","dialog","pincer","battlefront","missal","hayseed","parvenu","baronet","shipwright","whisker","no-hitter","double-dealing","moire","conjurer","rickshaw","crevasse","switchback","nicety","provincialism","novella","liberator","biggie","tune-up","ferryboat","remover","twosome","loveseat","tektite","sharpener","cartwheel","diva","flirting","disproportion","tortilla","rover","whodunit","birder","parley","birdsong","fiefdom","augury","harrier","tamale","judging","snakebite","diagnostician","tannin","qualifier","cheetah","distillery","protester","stockroom","factotum","newswoman","cosmopolitan","iridescence","aeroplane","toddy","co-defendant","parry","duocorn","boasting","elector","clarinetist","undergarment","psych","supergiant","armature","environ","collectivity","keepsake","gunfighter","wingspan","perforation","worshiper","groupie","cityscape","worrier","shipload","scallop","hatchery","portraitist","screamer","blaspheme","pacer","presenter","malcontent","seine","equivalency","scriptwriter","lieve","discard","bantam","centaur","typology","loiter","drubbing","airfoil","curio","grandmaster","finisher","luminary","alliteration","phantasy","blooper","fasting","samba","gearbox","islet","apricot","smidgen","inset","firestorm","madcap","seedbed","gunsight","forelock","disjunction","writhing","huckleberry","abstract","squirm","ironist","monosaccharide","pushbutton","terracotta","artiste","showgirl","cornea","temptress","popularization","free-fall","scribbling","conviviality","flange","thwack","droop","rower","sweatband","gopher","mandolin","slobber","stricture","calyx","dietician","rehash","padre","ancient","dotage","jacaranda","pensione","contravention","undulation","ironworker","currant","hankie","face-lift","anthropoid","depressant","war-horse","tithing","greeter","matchbox","woodcutter","magpie","wayfarer","handcuff","lawgiver","traverse","minion","cavalier","sonarman","defoliant","scamp","snowshoe","polyp","gainer","honkie","bottler","halloo","amputee","ontology","bromide","brisket","goodie","tavern-keeper","choker","preaching","molester","tonsure","recapitulation","aviary","stevedore","raffle","bootstrap","angiogram","plantain","tipper","hooting","seismometer","persecutor","lobotomy","pigsty","virologist","gamete","presbytery","stepping-stone","dressing-room","cyclamate","chipmunk","platelet","flogging","tuber","reservist","blinker","demographer","turncoat","demesne","fancier","ideologist","self-justification","bucketful","m'lord","rapping","bestiality","irrelevancy","oiler","mackinaw","flutist","trafficker","categorization","pram","world-system","cathouse","deceiver","idjit","double-take","reformulation","brushfire","separator","neigh","whimpering","crisscross","regurgitation","auteur","backwash","refiner","broadsheet","hedonist","recitative","nonentity","codger","tinting","policymaker","tutu","boondoggle","entrant","wok","small","boatload","searcher","taMing","sycophant","substructure","megalomaniac","rusher","saleslady","registrar","blackguard","neckerchief","oldie","clinician","flushing","pinwheel","dition","charioteer","beastie","stridency","verity","eyedropper","canvass","desperado","teardrop","farmyard","mannerist","macaw","valedictorian","whopper","pertinence","assay","puncher","manse","anatomist","dishtowel","nuke","egalitarian","tribulation","cinematographer","sailer","icicle","legume","spiritualist","nativist","these","progressive","blastocyst","harpooner","pedant","instrumentality","connector","masseur","vertebra","moonshiner","bowsprit","grabber","stele","clanking","renter","antihero","bankbook","jailbird","handicraft","fighter-bomber","streamer","retardant","wallflower","flamethrower","agate","cairn","bantamweight","agglomeration","roustabout","linden","roughneck","formance","moray","cession","rashness","capstone","derailment","declivity","snowfield","talon","haymaker","abductor","diffuser","geosector","camisole"]),jt}var Sn;function Cn(){if(Sn)return nt;Sn=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.nouns=nt.adjectives=void 0;const i=dl();nt.adjectives=i.default;const e=pl();return nt.nouns=e.default,nt}var Pn;function fl(){return Pn||(Pn=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.nouns=i.adjectives=i.uniqueUsernameGenerator=i.generateUsername=i.generateFromEmail=void 0;const e=Cn(),r=(u=0,l=4294967295)=>Math.random()*((l|0)-(u|0)+1)+(u|0)|0,t=u=>{let l;switch(u){case 1:l=Math.floor(r(1,9)).toString();break;case 2:l=Math.floor(r(10,90)).toString();break;case 3:l=Math.floor(r(100,900)).toString();break;case 4:l=Math.floor(r(1e3,9e3)).toString();break;case 5:l=Math.floor(r(1e4,9e4)).toString();break;case 6:l=Math.floor(r(1e5,9e5)).toString();break;default:l="";break}return l};function n(u,l){return u.replace(/@.+/,"").replace(/[&/\\#,+()$~%._@'":*?<>{}]/g,"")+t(l)}i.generateFromEmail=n;function o(u,l,c,d){const f=e.nouns[Math.floor(Math.random()*e.nouns.length)],p=d?d.replace(/\s{2,}/g," ").replace(/\s/g,u??"").toLocaleLowerCase():e.adjectives[Math.floor(Math.random()*e.adjectives.length)];let g;return u?g=p+u+f+t(l):g=p+f+t(l),c?g.substring(0,c):g}i.generateUsername=o;function a(u){if(u.dictionaries){const l=g=>u.dictionaries[g][r(0,u.dictionaries[g].length-1)],c=u.dictionaries.length,d=u.separator||"";let f="";for(let g=0;g<c;g++){const h=l(g);f?f+=d+h:f=h}let p=f+t(u.randomDigits);if(p=p.toLowerCase(),u.style==="lowerCase")p=p.toLowerCase();else if(u.style==="capital"){const[g,...h]=p.split("");p=g.toUpperCase()+h.join("")}else u.style==="upperCase"&&(p=p.toUpperCase());return u.length?p.substring(0,u.length):p.substring(0,15)}else throw new Error("Cannot find any dictionary. Please provide at least one, or leave the 'dictionary' field empty in the config object")}i.uniqueUsernameGenerator=a;var s=Cn();Object.defineProperty(i,"adjectives",{enumerable:!0,get:function(){return s.adjectives}}),Object.defineProperty(i,"nouns",{enumerable:!0,get:function(){return s.nouns}})}(ur)),ur}var hl=fl();class ml{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const r of this._parts)e.push(r);return gl(e).buffer}}function gl(i){let e=0;for(const n of i)e+=n.byteLength;const r=new Uint8Array(e);let t=0;for(const n of i){const o=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);r.set(o,t),t+=n.byteLength}return r}function Di(i){return new yl(i).unpack()}function ji(i){const e=new bl,r=e.pack(i);return r instanceof Promise?r.then(()=>e.getBuffer()):e.getBuffer()}class yl{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let r;if((r=e^160)<=15)return this.unpack_raw(r);if((r=e^176)<=15)return this.unpack_string(r);if((r=e^144)<=15)return this.unpack_array(r);if((r=e^128)<=15)return this.unpack_map(r);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return r=this.unpack_uint16(),this.unpack_string(r);case 217:return r=this.unpack_uint32(),this.unpack_string(r);case 218:return r=this.unpack_uint16(),this.unpack_raw(r);case 219:return r=this.unpack_uint32(),this.unpack_raw(r);case 220:return r=this.unpack_uint16(),this.unpack_array(r);case 221:return r=this.unpack_uint32(),this.unpack_array(r);case 222:return r=this.unpack_uint16(),this.unpack_map(r);case 223:return r=this.unpack_uint32(),this.unpack_map(r)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),r=(e[0]&255)*256+(e[1]&255);return this.index+=2,r}unpack_uint32(){const e=this.read(4),r=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,r}unpack_uint64(){const e=this.read(8),r=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,r}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const r=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,r}unpack_string(e){const r=this.read(e);let t=0,n="",o,a;for(;t<e;)o=r[t],o<160?(a=o,t++):(o^192)<32?(a=(o&31)<<6|r[t+1]&63,t+=2):(o^224)<16?(a=(o&15)<<12|(r[t+1]&63)<<6|r[t+2]&63,t+=3):(a=(o&7)<<18|(r[t+1]&63)<<12|(r[t+2]&63)<<6|r[t+3]&63,t+=4),n+=String.fromCodePoint(a);return this.index+=e,n}unpack_array(e){const r=new Array(e);for(let t=0;t<e;t++)r[t]=this.unpack();return r}unpack_map(e){const r={};for(let t=0;t<e;t++){const n=this.unpack();r[n]=this.unpack()}return r}unpack_float(){const e=this.unpack_uint32(),r=e>>31,t=(e>>23&255)-127,n=e&8388607|8388608;return(r===0?1:-1)*n*2**(t-23)}unpack_double(){const e=this.unpack_uint32(),r=this.unpack_uint32(),t=e>>31,n=(e>>20&2047)-1023,a=(e&1048575|1048576)*2**(n-20)+r*2**(n-52);return(t===0?1:-1)*a}read(e){const r=this.index;if(r+e<=this.length)return this.dataView.subarray(r,r+e);throw new Error("BinaryPackFailure: read index out of range")}}class bl{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const r=e.constructor;if(e instanceof Array){const t=this.pack_array(e);if(t instanceof Promise)return t.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const t=e;this.pack_bin(new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(t=>{this.pack_bin(new Uint8Array(t)),this._bufferBuilder.flush()});if(r==Object||r.toString().startsWith("class")){const t=this.pack_object(e);if(t instanceof Promise)return t.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${r.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const r=e.length;if(r<=15)this.pack_uint8(160+r);else if(r<=65535)this._bufferBuilder.append(218),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(r);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const r=this._textEncoder.encode(e),t=r.length;if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this._bufferBuilder.append(216),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(r)}pack_array(e){const r=e.length;if(r<=15)this.pack_uint8(144+r);else if(r<=65535)this._bufferBuilder.append(220),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(r);else throw new Error("Invalid length");const t=n=>{if(n<r){const o=this.pack(e[n]);return o instanceof Promise?o.then(()=>t(n+1)):t(n+1)}};return t(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let r=0;e<0&&(r=1,e=-e);const t=Math.floor(Math.log(e)/Math.LN2),n=e/2**t-1,o=Math.floor(n*2**52),a=2**32,s=r<<31|t+1023<<20|o/a&1048575,u=o%a;this._bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(u)}pack_object(e){const r=Object.keys(e),t=r.length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this._bufferBuilder.append(222),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(t);else throw new Error("Invalid length");const n=o=>{if(o<r.length){const a=r[o];if(e.hasOwnProperty(a)){this.pack(a);const s=this.pack(e[a]);if(s instanceof Promise)return s.then(()=>n(o+1))}return n(o+1)}};return n(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const r=e&4294967295;this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_uint64(e){const r=e/4294967296,t=e%2**32;this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255),this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const r=Math.floor(e/4294967296),t=e%2**32;this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255),this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}constructor(){this._bufferBuilder=new ml,this._textEncoder=new TextEncoder}}let Li=!0,zi=!0;function Tt(i,e,r){const t=i.match(e);return t&&t.length>=r&&parseFloat(t[r],10)}function pt(i,e,r){if(!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype,n=t.addEventListener;t.addEventListener=function(a,s){if(a!==e)return n.apply(this,arguments);const u=l=>{const c=r(l);c&&(s.handleEvent?s.handleEvent(c):s(c))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(s,u),n.apply(this,[a,u])};const o=t.removeEventListener;t.removeEventListener=function(a,s){if(a!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(s))return o.apply(this,arguments);const u=this._eventMap[e].get(s);return this._eventMap[e].delete(s),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[a,u])},Object.defineProperty(t,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function vl(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(Li=i,i?"adapter.js logging disabled":"adapter.js logging enabled")}function kl(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(zi=!i,"adapter.js deprecation warnings "+(i?"disabled":"enabled"))}function Ui(){if(typeof window=="object"){if(Li)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Vr(i,e){zi&&console.warn(i+" is deprecated, please use "+e+" instead.")}function wl(i){const e={browser:null,version:null};if(typeof i>"u"||!i.navigator||!i.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:r}=i;if(r.userAgentData&&r.userAgentData.brands){const t=r.userAgentData.brands.find(n=>n.brand==="Chromium");if(t)return{browser:"chrome",version:parseInt(t.version,10)}}if(r.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Tt(r.userAgent,/Firefox\/(\d+)\./,1));else if(r.webkitGetUserMedia||i.isSecureContext===!1&&i.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Tt(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(i.RTCPeerConnection&&r.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Tt(r.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=i.RTCRtpTransceiver&&"currentDirection"in i.RTCRtpTransceiver.prototype,e._safariVersion=Tt(r.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function _n(i){return Object.prototype.toString.call(i)==="[object Object]"}function Bi(i){return _n(i)?Object.keys(i).reduce(function(e,r){const t=_n(i[r]),n=t?Bi(i[r]):i[r],o=t&&!Object.keys(n).length;return n===void 0||o?e:Object.assign(e,{[r]:n})},{}):i}function Pr(i,e,r){!e||r.has(e.id)||(r.set(e.id,e),Object.keys(e).forEach(t=>{t.endsWith("Id")?Pr(i,i.get(e[t]),r):t.endsWith("Ids")&&e[t].forEach(n=>{Pr(i,i.get(n),r)})}))}function Tn(i,e,r){const t=r?"outbound-rtp":"inbound-rtp",n=new Map;if(e===null)return n;const o=[];return i.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&o.push(a)}),o.forEach(a=>{i.forEach(s=>{s.type===t&&s.trackId===a.id&&Pr(i,s,n)})}),n}const $n=Ui;function qi(i,e){const r=i&&i.navigator;if(!r.mediaDevices)return;const t=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;const u={};return Object.keys(s).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const c=typeof s[l]=="object"?s[l]:{ideal:s[l]};c.exact!==void 0&&typeof c.exact=="number"&&(c.min=c.max=c.exact);const d=function(f,p){return f?f+p.charAt(0).toUpperCase()+p.slice(1):p==="deviceId"?"sourceId":p};if(c.ideal!==void 0){u.optional=u.optional||[];let f={};typeof c.ideal=="number"?(f[d("min",l)]=c.ideal,u.optional.push(f),f={},f[d("max",l)]=c.ideal,u.optional.push(f)):(f[d("",l)]=c.ideal,u.optional.push(f))}c.exact!==void 0&&typeof c.exact!="number"?(u.mandatory=u.mandatory||{},u.mandatory[d("",l)]=c.exact):["min","max"].forEach(f=>{c[f]!==void 0&&(u.mandatory=u.mandatory||{},u.mandatory[d(f,l)]=c[f])})}),s.advanced&&(u.optional=(u.optional||[]).concat(s.advanced)),u},n=function(s,u){if(e.version>=61)return u(s);if(s=JSON.parse(JSON.stringify(s)),s&&typeof s.audio=="object"){const l=function(c,d,f){d in c&&!(f in c)&&(c[f]=c[d],delete c[d])};s=JSON.parse(JSON.stringify(s)),l(s.audio,"autoGainControl","googAutoGainControl"),l(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=t(s.audio)}if(s&&typeof s.video=="object"){let l=s.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const c=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(r.mediaDevices.getSupportedConstraints&&r.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete s.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return r.mediaDevices.enumerateDevices().then(f=>{f=f.filter(g=>g.kind==="videoinput");let p=f.find(g=>d.some(h=>g.label.toLowerCase().includes(h)));return!p&&f.length&&d.includes("back")&&(p=f[f.length-1]),p&&(s.video.deviceId=l.exact?{exact:p.deviceId}:{ideal:p.deviceId}),s.video=t(s.video),$n("chrome: "+JSON.stringify(s)),u(s)})}s.video=t(s.video)}return $n("chrome: "+JSON.stringify(s)),u(s)},o=function(s){return e.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(s,u,l){n(s,c=>{r.webkitGetUserMedia(c,u,d=>{l&&l(o(d))})})};if(r.getUserMedia=a.bind(r),r.mediaDevices.getUserMedia){const s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(u){return n(u,l=>s(l).then(c=>{if(l.audio&&!c.getAudioTracks().length||l.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return c},c=>Promise.reject(o(c))))}}}function Vi(i){i.MediaStream=i.MediaStream||i.webkitMediaStream}function Gi(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("ontrack"in i.RTCPeerConnection.prototype)){Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let o;i.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(s=>s.track&&s.track.id===n.track.id):o={track:n.track};const a=new Event("track");a.track=n.track,a.receiver=o,a.transceiver={receiver:o},a.streams=[t.stream],this.dispatchEvent(a)}),t.stream.getTracks().forEach(n=>{let o;i.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(s=>s.track&&s.track.id===n.id):o={track:n};const a=new Event("track");a.track=n,a.receiver=o,a.transceiver={receiver:o},a.streams=[t.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else pt(i,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Wi(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("getSenders"in i.RTCPeerConnection.prototype)&&"createDTMFSender"in i.RTCPeerConnection.prototype){const e=function(n,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=n.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:n}};if(!i.RTCPeerConnection.prototype.getSenders){i.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(s,u){let l=n.apply(this,arguments);return l||(l=e(this,s),this._senders.push(l)),l};const o=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(s){o.apply(this,arguments);const u=this._senders.indexOf(s);u!==-1&&this._senders.splice(u,1)}}const r=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const t=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],t.apply(this,[o]),o.getTracks().forEach(a=>{const s=this._senders.find(u=>u.track===a);s&&this._senders.splice(this._senders.indexOf(s),1)})}}else if(typeof i=="object"&&i.RTCPeerConnection&&"getSenders"in i.RTCPeerConnection.prototype&&"createDTMFSender"in i.RTCPeerConnection.prototype&&i.RTCRtpSender&&!("dtmf"in i.RTCRtpSender.prototype)){const e=i.RTCPeerConnection.prototype.getSenders;i.RTCPeerConnection.prototype.getSenders=function(){const t=e.apply(this,[]);return t.forEach(n=>n._pc=this),t},Object.defineProperty(i.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Hi(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender&&i.RTCRtpReceiver))return;if(!("getStats"in i.RTCRtpSender.prototype)){const r=i.RTCPeerConnection.prototype.getSenders;r&&(i.RTCPeerConnection.prototype.getSenders=function(){const o=r.apply(this,[]);return o.forEach(a=>a._pc=this),o});const t=i.RTCPeerConnection.prototype.addTrack;t&&(i.RTCPeerConnection.prototype.addTrack=function(){const o=t.apply(this,arguments);return o._pc=this,o}),i.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(a=>Tn(a,o.track,!0))}}if(!("getStats"in i.RTCRtpReceiver.prototype)){const r=i.RTCPeerConnection.prototype.getReceivers;r&&(i.RTCPeerConnection.prototype.getReceivers=function(){const n=r.apply(this,[]);return n.forEach(o=>o._pc=this),n}),pt(i,"track",t=>(t.receiver._pc=t.srcElement,t)),i.RTCRtpReceiver.prototype.getStats=function(){const n=this;return this._pc.getStats().then(o=>Tn(o,n.track,!1))}}if(!("getStats"in i.RTCRtpSender.prototype&&"getStats"in i.RTCRtpReceiver.prototype))return;const e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof i.MediaStreamTrack){const t=arguments[0];let n,o,a;return this.getSenders().forEach(s=>{s.track===t&&(n?a=!0:n=s)}),this.getReceivers().forEach(s=>(s.track===t&&(o?a=!0:o=s),s.track===t)),a||n&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Ki(i){i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(a,s){if(!s)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const u=e.apply(this,arguments);return this._shimmedLocalStreams[s.id]?this._shimmedLocalStreams[s.id].indexOf(u)===-1&&this._shimmedLocalStreams[s.id].push(u):this._shimmedLocalStreams[s.id]=[s,u],u};const r=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const s=this.getSenders();r.apply(this,arguments);const u=this.getSenders().filter(l=>s.indexOf(l)===-1);this._shimmedLocalStreams[a.id]=[a].concat(u)};const t=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],t.apply(this,arguments)};const n=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(s=>{const u=this._shimmedLocalStreams[s].indexOf(a);u!==-1&&this._shimmedLocalStreams[s].splice(u,1),this._shimmedLocalStreams[s].length===1&&delete this._shimmedLocalStreams[s]}),n.apply(this,arguments)}}function Yi(i,e){if(!i.RTCPeerConnection)return;if(i.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Ki(i);const r=i.RTCPeerConnection.prototype.getLocalStreams;i.RTCPeerConnection.prototype.getLocalStreams=function(){const c=r.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(d=>this._reverseStreams[d.id])};const t=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(d=>{if(this.getSenders().find(p=>p.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const d=new i.MediaStream(c.getTracks());this._streams[c.id]=d,this._reverseStreams[d.id]=c,c=d}t.apply(this,[c])};const n=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},i.RTCPeerConnection.prototype.addTrack=function(c,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(h=>h===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(h=>h.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const g=this._streams[d.id];if(g)g.addTrack(c),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const h=new i.MediaStream([c]);this._streams[d.id]=h,this._reverseStreams[h.id]=d,this.addStream(h)}return this.getSenders().find(h=>h.track===c)};function o(l,c){let d=c.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const p=l._reverseStreams[f],g=l._streams[p.id];d=d.replace(new RegExp(g.id,"g"),p.id)}),new RTCSessionDescription({type:c.type,sdp:d})}function a(l,c){let d=c.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const p=l._reverseStreams[f],g=l._streams[p.id];d=d.replace(new RegExp(p.id,"g"),g.id)}),new RTCSessionDescription({type:c.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const c=i.RTCPeerConnection.prototype[l],d={[l](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?c.apply(this,[g=>{const h=o(this,g);f[0].apply(null,[h])},g=>{f[1]&&f[1].apply(null,g)},arguments[2]]):c.apply(this,arguments).then(g=>o(this,g))}};i.RTCPeerConnection.prototype[l]=d[l]});const s=i.RTCPeerConnection.prototype.setLocalDescription;i.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?s.apply(this,arguments):(arguments[0]=a(this,arguments[0]),s.apply(this,arguments))};const u=Object.getOwnPropertyDescriptor(i.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(i.RTCPeerConnection.prototype,"localDescription",{get(){const l=u.get.apply(this);return l.type===""?l:o(this,l)}}),i.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(c._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(p=>{this._streams[p].getTracks().find(h=>c.track===h)&&(f=this._streams[p])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function _r(i,e){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const t=i.RTCPeerConnection.prototype[r],n={[r](){return arguments[0]=new(r==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}};i.RTCPeerConnection.prototype[r]=n[r]})}function Ji(i,e){pt(i,"negotiationneeded",r=>{const t=r.target;if(!((e.version<72||t.getConfiguration&&t.getConfiguration().sdpSemantics==="plan-b")&&t.signalingState!=="stable"))return r})}const En=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Ji,shimAddTrackRemoveTrack:Yi,shimAddTrackRemoveTrackWithNative:Ki,shimGetSendersWithDtmf:Wi,shimGetUserMedia:qi,shimMediaStream:Vi,shimOnTrack:Gi,shimPeerConnection:_r,shimSenderReceiverGetStats:Hi},Symbol.toStringTag,{value:"Module"}));function Xi(i,e){const r=i&&i.navigator,t=i&&i.MediaStreamTrack;if(r.getUserMedia=function(n,o,a){Vr("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(n).then(o,a)},!(e.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const n=function(a,s,u){s in a&&!(u in a)&&(a[u]=a[s],delete a[s])},o=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),n(a.audio,"autoGainControl","mozAutoGainControl"),n(a.audio,"noiseSuppression","mozNoiseSuppression")),o(a)},t&&t.prototype.getSettings){const a=t.prototype.getSettings;t.prototype.getSettings=function(){const s=a.apply(this,arguments);return n(s,"mozAutoGainControl","autoGainControl"),n(s,"mozNoiseSuppression","noiseSuppression"),s}}if(t&&t.prototype.applyConstraints){const a=t.prototype.applyConstraints;t.prototype.applyConstraints=function(s){return this.kind==="audio"&&typeof s=="object"&&(s=JSON.parse(JSON.stringify(s)),n(s,"autoGainControl","mozAutoGainControl"),n(s,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[s])}}}}function xl(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(i.navigator.mediaDevices.getDisplayMedia=function(t){if(!(t&&t.video)){const n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return t.video===!0?t.video={mediaSource:e}:t.video.mediaSource=e,i.navigator.mediaDevices.getUserMedia(t)})}function Zi(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Tr(i,e){if(typeof i!="object"||!(i.RTCPeerConnection||i.mozRTCPeerConnection))return;!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const o=i.RTCPeerConnection.prototype[n],a={[n](){return arguments[0]=new(n==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};i.RTCPeerConnection.prototype[n]=a[n]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},t=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[o,a,s]=arguments;return t.apply(this,[o||null]).then(u=>{if(e.version<53&&!a)try{u.forEach(l=>{l.type=r[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;u.forEach((c,d)=>{u.set(d,Object.assign({},c,{type:r[c.type]||c.type}))})}return u}).then(a,s)}}function Qi(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpSender.prototype)return;const e=i.RTCPeerConnection.prototype.getSenders;e&&(i.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(o=>o._pc=this),n});const r=i.RTCPeerConnection.prototype.addTrack;r&&(i.RTCPeerConnection.prototype.addTrack=function(){const n=r.apply(this,arguments);return n._pc=this,n}),i.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function eo(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpReceiver.prototype)return;const e=i.RTCPeerConnection.prototype.getReceivers;e&&(i.RTCPeerConnection.prototype.getReceivers=function(){const t=e.apply(this,[]);return t.forEach(n=>n._pc=this),t}),pt(i,"track",r=>(r.receiver._pc=r.srcElement,r)),i.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function to(i){!i.RTCPeerConnection||"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(r){Vr("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&r.getTracks().includes(t.track)&&this.removeTrack(t)})})}function ro(i){i.DataChannel&&!i.RTCDataChannel&&(i.RTCDataChannel=i.DataChannel)}function no(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.addTransceiver;e&&(i.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let t=arguments[1]&&arguments[1].sendEncodings;t===void 0&&(t=[]),t=[...t];const n=t.length>0;n&&t.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(n){const{sender:a}=o,s=a.getParameters();(!("encodings"in s)||s.encodings.length===1&&Object.keys(s.encodings[0]).length===0)&&(s.encodings=t,a.sendEncodings=t,this.setParametersPromises.push(a.setParameters(s).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return o})}function io(i){if(!(typeof i=="object"&&i.RTCRtpSender))return;const e=i.RTCRtpSender.prototype.getParameters;e&&(i.RTCRtpSender.prototype.getParameters=function(){const t=e.apply(this,arguments);return"encodings"in t||(t.encodings=[].concat(this.sendEncodings||[{}])),t})}function oo(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function ao(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createAnswer;i.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const In=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:no,shimCreateAnswer:ao,shimCreateOffer:oo,shimGetDisplayMedia:xl,shimGetParameters:io,shimGetUserMedia:Xi,shimOnTrack:Zi,shimPeerConnection:Tr,shimRTCDataChannel:ro,shimReceiverGetStats:eo,shimRemoveStream:to,shimSenderGetStats:Qi},Symbol.toStringTag,{value:"Module"}));function so(i){if(!(typeof i!="object"||!i.RTCPeerConnection)){if("getLocalStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in i.RTCPeerConnection.prototype)){const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addStream=function(t){this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(n=>e.call(this,n,t)),t.getVideoTracks().forEach(n=>e.call(this,n,t))},i.RTCPeerConnection.prototype.addTrack=function(t,...n){return n&&n.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),e.apply(this,arguments)}}"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(r){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(r);if(t===-1)return;this._localStreams.splice(t,1);const n=r.getTracks();this.getSenders().forEach(o=>{n.includes(o.track)&&this.removeTrack(o)})})}}function lo(i){if(!(typeof i!="object"||!i.RTCPeerConnection)&&("getRemoteStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in i.RTCPeerConnection.prototype))){Object.defineProperty(i.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=t=>{t.streams.forEach(n=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(n))return;this._remoteStreams.push(n);const o=new Event("addstream");o.stream=n,this.dispatchEvent(o)})})}});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){const t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(n){n.streams.forEach(o=>{if(t._remoteStreams||(t._remoteStreams=[]),t._remoteStreams.indexOf(o)>=0)return;t._remoteStreams.push(o);const a=new Event("addstream");a.stream=o,t.dispatchEvent(a)})}),e.apply(t,arguments)}}}function co(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype,r=e.createOffer,t=e.createAnswer,n=e.setLocalDescription,o=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(l,c){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return c?(f.then(l,c),Promise.resolve()):f},e.createAnswer=function(l,c){const d=arguments.length>=2?arguments[2]:arguments[0],f=t.apply(this,[d]);return c?(f.then(l,c),Promise.resolve()):f};let s=function(u,l,c){const d=n.apply(this,[u]);return c?(d.then(l,c),Promise.resolve()):d};e.setLocalDescription=s,s=function(u,l,c){const d=o.apply(this,[u]);return c?(d.then(l,c),Promise.resolve()):d},e.setRemoteDescription=s,s=function(u,l,c){const d=a.apply(this,[u]);return c?(d.then(l,c),Promise.resolve()):d},e.addIceCandidate=s}function uo(i){const e=i&&i.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const r=e.mediaDevices,t=r.getUserMedia.bind(r);e.mediaDevices.getUserMedia=n=>t(po(n))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(t,n,o){e.mediaDevices.getUserMedia(t).then(n,o)}.bind(e))}function po(i){return i&&i.video!==void 0?Object.assign({},i,{video:Bi(i.video)}):i}function fo(i){if(!i.RTCPeerConnection)return;const e=i.RTCPeerConnection;i.RTCPeerConnection=function(t,n){if(t&&t.iceServers){const o=[];for(let a=0;a<t.iceServers.length;a++){let s=t.iceServers[a];s.urls===void 0&&s.url?(Vr("RTCIceServer.url","RTCIceServer.urls"),s=JSON.parse(JSON.stringify(s)),s.urls=s.url,delete s.url,o.push(s)):o.push(t.iceServers[a])}t.iceServers=o}return new e(t,n)},i.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(i.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function ho(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function mo(i){const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(t){if(t){typeof t.offerToReceiveAudio<"u"&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);const n=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");t.offerToReceiveAudio===!1&&n?n.direction==="sendrecv"?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":n.direction==="recvonly"&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):t.offerToReceiveAudio===!0&&!n&&this.addTransceiver("audio",{direction:"recvonly"}),typeof t.offerToReceiveVideo<"u"&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);const o=this.getTransceivers().find(a=>a.receiver.track.kind==="video");t.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):t.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function go(i){typeof i!="object"||i.AudioContext||(i.AudioContext=i.webkitAudioContext)}const Rn=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:go,shimCallbacksAPI:co,shimConstraints:po,shimCreateOfferLegacy:mo,shimGetUserMedia:uo,shimLocalStreamsAPI:so,shimRTCIceServerUrls:fo,shimRemoteStreamsAPI:lo,shimTrackEventTransceiver:ho},Symbol.toStringTag,{value:"Module"}));var dr={exports:{}},Mn;function Sl(){return Mn||(Mn=1,function(i){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(r){return r.trim().split(`
`).map(t=>t.trim())},e.splitSections=function(r){return r.split(`
m=`).map((n,o)=>(o>0?"m="+n:n).trim()+`\r
`)},e.getDescription=function(r){const t=e.splitSections(r);return t&&t[0]},e.getMediaSections=function(r){const t=e.splitSections(r);return t.shift(),t},e.matchPrefix=function(r,t){return e.splitLines(r).filter(n=>n.indexOf(t)===0)},e.parseCandidate=function(r){let t;r.indexOf("a=candidate:")===0?t=r.substring(12).split(" "):t=r.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let o=8;o<t.length;o+=2)switch(t[o]){case"raddr":n.relatedAddress=t[o+1];break;case"rport":n.relatedPort=parseInt(t[o+1],10);break;case"tcptype":n.tcpType=t[o+1];break;case"ufrag":n.ufrag=t[o+1],n.usernameFragment=t[o+1];break;default:n[t[o]]===void 0&&(n[t[o]]=t[o+1]);break}return n},e.writeCandidate=function(r){const t=[];t.push(r.foundation);const n=r.component;n==="rtp"?t.push(1):n==="rtcp"?t.push(2):t.push(n),t.push(r.protocol.toUpperCase()),t.push(r.priority),t.push(r.address||r.ip),t.push(r.port);const o=r.type;return t.push("typ"),t.push(o),o!=="host"&&r.relatedAddress&&r.relatedPort&&(t.push("raddr"),t.push(r.relatedAddress),t.push("rport"),t.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(t.push("tcptype"),t.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(t.push("ufrag"),t.push(r.usernameFragment||r.ufrag)),"candidate:"+t.join(" ")},e.parseIceOptions=function(r){return r.substring(14).split(" ")},e.parseRtpMap=function(r){let t=r.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=t.length===3?parseInt(t[2],10):1,n.numChannels=n.channels,n},e.writeRtpMap=function(r){let t=r.payloadType;r.preferredPayloadType!==void 0&&(t=r.preferredPayloadType);const n=r.channels||r.numChannels||1;return"a=rtpmap:"+t+" "+r.name+"/"+r.clockRate+(n!==1?"/"+n:"")+`\r
`},e.parseExtmap=function(r){const t=r.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},e.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+(r.attributes?" "+r.attributes:"")+`\r
`},e.parseFmtp=function(r){const t={};let n;const o=r.substring(r.indexOf(" ")+1).split(";");for(let a=0;a<o.length;a++)n=o[a].trim().split("="),t[n[0].trim()]=n[1];return t},e.writeFmtp=function(r){let t="",n=r.payloadType;if(r.preferredPayloadType!==void 0&&(n=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){const o=[];Object.keys(r.parameters).forEach(a=>{r.parameters[a]!==void 0?o.push(a+"="+r.parameters[a]):o.push(a)}),t+="a=fmtp:"+n+" "+o.join(";")+`\r
`}return t},e.parseRtcpFb=function(r){const t=r.substring(r.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},e.writeRtcpFb=function(r){let t="",n=r.payloadType;return r.preferredPayloadType!==void 0&&(n=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(o=>{t+="a=rtcp-fb:"+n+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),t},e.parseSsrcMedia=function(r){const t=r.indexOf(" "),n={ssrc:parseInt(r.substring(7,t),10)},o=r.indexOf(":",t);return o>-1?(n.attribute=r.substring(t+1,o),n.value=r.substring(o+1)):n.attribute=r.substring(t+1),n},e.parseSsrcGroup=function(r){const t=r.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(n=>parseInt(n,10))}},e.getMid=function(r){const t=e.matchPrefix(r,"a=mid:")[0];if(t)return t.substring(6)},e.parseFingerprint=function(r){const t=r.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},e.getDtlsParameters=function(r,t){return{role:"auto",fingerprints:e.matchPrefix(r+t,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(r,t){let n="a=setup:"+t+`\r
`;return r.fingerprints.forEach(o=>{n+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),n},e.parseCryptoLine=function(r){const t=r.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},e.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?e.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;const t=r.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},e.getCryptoParameters=function(r,t){return e.matchPrefix(r+t,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(r,t){const n=e.matchPrefix(r+t,"a=ice-ufrag:")[0],o=e.matchPrefix(r+t,"a=ice-pwd:")[0];return n&&o?{usernameFragment:n.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(r){let t="a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`;return r.iceLite&&(t+=`a=ice-lite\r
`),t},e.parseRtpParameters=function(r){const t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(r)[0].split(" ");t.profile=o[2];for(let s=3;s<o.length;s++){const u=o[s],l=e.matchPrefix(r,"a=rtpmap:"+u+" ")[0];if(l){const c=e.parseRtpMap(l),d=e.matchPrefix(r,"a=fmtp:"+u+" ");switch(c.parameters=d.length?e.parseFmtp(d[0]):{},c.rtcpFeedback=e.matchPrefix(r,"a=rtcp-fb:"+u+" ").map(e.parseRtcpFb),t.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase());break}}}e.matchPrefix(r,"a=extmap:").forEach(s=>{t.headerExtensions.push(e.parseExtmap(s))});const a=e.matchPrefix(r,"a=rtcp-fb:* ").map(e.parseRtcpFb);return t.codecs.forEach(s=>{a.forEach(u=>{s.rtcpFeedback.find(c=>c.type===u.type&&c.parameter===u.parameter)||s.rtcpFeedback.push(u)})}),t},e.writeRtpDescription=function(r,t){let n="";n+="m="+r+" ",n+=t.codecs.length>0?"9":"0",n+=" "+(t.profile||"UDP/TLS/RTP/SAVPF")+" ",n+=t.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,n+=`c=IN IP4 0.0.0.0\r
`,n+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,t.codecs.forEach(a=>{n+=e.writeRtpMap(a),n+=e.writeFmtp(a),n+=e.writeRtcpFb(a)});let o=0;return t.codecs.forEach(a=>{a.maxptime>o&&(o=a.maxptime)}),o>0&&(n+="a=maxptime:"+o+`\r
`),t.headerExtensions&&t.headerExtensions.forEach(a=>{n+=e.writeExtmap(a)}),n},e.parseRtpEncodingParameters=function(r){const t=[],n=e.parseRtpParameters(r),o=n.fecMechanisms.indexOf("RED")!==-1,a=n.fecMechanisms.indexOf("ULPFEC")!==-1,s=e.matchPrefix(r,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),u=s.length>0&&s[0].ssrc;let l;const c=e.matchPrefix(r,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(g=>parseInt(g,10)));c.length>0&&c[0].length>1&&c[0][0]===u&&(l=c[0][1]),n.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let p={ssrc:u,codecPayloadType:parseInt(f.parameters.apt,10)};u&&l&&(p.rtx={ssrc:l}),t.push(p),o&&(p=JSON.parse(JSON.stringify(p)),p.fec={ssrc:u,mechanism:a?"red+ulpfec":"red"},t.push(p))}}),t.length===0&&u&&t.push({ssrc:u});let d=e.matchPrefix(r,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,t.forEach(f=>{f.maxBitrate=d})),t},e.parseRtcpParameters=function(r){const t={},n=e.matchPrefix(r,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="cname")[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);const o=e.matchPrefix(r,"a=rtcp-rsize");t.reducedSize=o.length>0,t.compound=o.length===0;const a=e.matchPrefix(r,"a=rtcp-mux");return t.mux=a.length>0,t},e.writeRtcpParameters=function(r){let t="";return r.reducedSize&&(t+=`a=rtcp-rsize\r
`),r.mux&&(t+=`a=rtcp-mux\r
`),r.ssrc!==void 0&&r.cname&&(t+="a=ssrc:"+r.ssrc+" cname:"+r.cname+`\r
`),t},e.parseMsid=function(r){let t;const n=e.matchPrefix(r,"a=msid:");if(n.length===1)return t=n[0].substring(7).split(" "),{stream:t[0],track:t[1]};const o=e.matchPrefix(r,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(o.length>0)return t=o[0].value.split(" "),{stream:t[0],track:t[1]}},e.parseSctpDescription=function(r){const t=e.parseMLine(r),n=e.matchPrefix(r,"a=max-message-size:");let o;n.length>0&&(o=parseInt(n[0].substring(19),10)),isNaN(o)&&(o=65536);const a=e.matchPrefix(r,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:t.fmt,maxMessageSize:o};const s=e.matchPrefix(r,"a=sctpmap:");if(s.length>0){const u=s[0].substring(10).split(" ");return{port:parseInt(u[0],10),protocol:u[1],maxMessageSize:o}}},e.writeSctpDescription=function(r,t){let n=[];return r.protocol!=="DTLS/SCTP"?n=["m="+r.kind+" 9 "+r.protocol+" "+t.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+t.port+`\r
`]:n=["m="+r.kind+" 9 "+r.protocol+" "+t.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+t.port+" "+t.protocol+` 65535\r
`],t.maxMessageSize!==void 0&&n.push("a=max-message-size:"+t.maxMessageSize+`\r
`),n.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(r,t,n){let o;const a=t!==void 0?t:2;return r?o=r:o=e.generateSessionId(),`v=0\r
o=`+(n||"thisisadapterortc")+" "+o+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(r,t){const n=e.splitLines(r);for(let o=0;o<n.length;o++)switch(n[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[o].substring(2)}return t?e.getDirection(t):"sendrecv"},e.getKind=function(r){return e.splitLines(r)[0].split(" ")[0].substring(2)},e.isRejected=function(r){return r.split(" ",2)[1]==="0"},e.parseMLine=function(r){const n=e.splitLines(r)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},e.parseOLine=function(r){const n=e.matchPrefix(r,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},e.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;const t=e.splitLines(r);for(let n=0;n<t.length;n++)if(t[n].length<2||t[n].charAt(1)!=="=")return!1;return!0},i.exports=e}(dr)),dr.exports}var yo=Sl();const mt=Dr(yo),Cl=$s({__proto__:null,default:mt},[yo]);function qt(i){if(!i.RTCIceCandidate||i.RTCIceCandidate&&"foundation"in i.RTCIceCandidate.prototype)return;const e=i.RTCIceCandidate;i.RTCIceCandidate=function(t){if(typeof t=="object"&&t.candidate&&t.candidate.indexOf("a=")===0&&(t=JSON.parse(JSON.stringify(t)),t.candidate=t.candidate.substring(2)),t.candidate&&t.candidate.length){const n=new e(t),o=mt.parseCandidate(t.candidate);for(const a in o)a in n||Object.defineProperty(n,a,{value:o[a]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new e(t)},i.RTCIceCandidate.prototype=e.prototype,pt(i,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new i.RTCIceCandidate(r.candidate),writable:"false"}),r))}function $r(i){!i.RTCIceCandidate||i.RTCIceCandidate&&"relayProtocol"in i.RTCIceCandidate.prototype||pt(i,"icecandidate",e=>{if(e.candidate){const r=mt.parseCandidate(e.candidate.candidate);r.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[r.priority>>24])}return e})}function Vt(i,e){if(!i.RTCPeerConnection)return;"sctp"in i.RTCPeerConnection.prototype||Object.defineProperty(i.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const r=function(s){if(!s||!s.sdp)return!1;const u=mt.splitSections(s.sdp);return u.shift(),u.some(l=>{const c=mt.parseMLine(l);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})},t=function(s){const u=s.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(u===null||u.length<2)return-1;const l=parseInt(u[1],10);return l!==l?-1:l},n=function(s){let u=65536;return e.browser==="firefox"&&(e.version<57?s===-1?u=16384:u=2147483637:e.version<60?u=e.version===57?65535:65536:u=2147483637),u},o=function(s,u){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const c=mt.matchPrefix(s.sdp,"a=max-message-size:");return c.length>0?l=parseInt(c[0].substring(19),10):e.browser==="firefox"&&u!==-1&&(l=2147483637),l},a=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:u}=this.getConfiguration();u==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const u=t(arguments[0]),l=n(u),c=o(arguments[0],u);let d;l===0&&c===0?d=Number.POSITIVE_INFINITY:l===0||c===0?d=Math.max(l,c):d=Math.min(l,c);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return a.apply(this,arguments)}}function Gt(i){if(!(i.RTCPeerConnection&&"createDataChannel"in i.RTCPeerConnection.prototype))return;function e(t,n){const o=t.send;t.send=function(){const s=arguments[0],u=s.length||s.size||s.byteLength;if(t.readyState==="open"&&n.sctp&&u>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return o.apply(t,arguments)}}const r=i.RTCPeerConnection.prototype.createDataChannel;i.RTCPeerConnection.prototype.createDataChannel=function(){const n=r.apply(this,arguments);return e(n,this),n},pt(i,"datachannel",t=>(e(t.channel,t.target),t))}function Er(i){if(!i.RTCPeerConnection||"connectionState"in i.RTCPeerConnection.prototype)return;const e=i.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const t=e[r];e[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=n=>{const o=n.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const a=new Event("connectionstatechange",n);o.dispatchEvent(a)}return n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}})}function Ir(i,e){if(!i.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const r=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(n){if(n&&n.sdp&&n.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=n.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);i.RTCSessionDescription&&n instanceof i.RTCSessionDescription?arguments[0]=new i.RTCSessionDescription({type:n.type,sdp:o}):n.sdp=o}return r.apply(this,arguments)}}function Wt(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const r=i.RTCPeerConnection.prototype.addIceCandidate;!r||r.length===0||(i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Ht(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const r=i.RTCPeerConnection.prototype.setLocalDescription;!r||r.length===0||(i.RTCPeerConnection.prototype.setLocalDescription=function(){let n=arguments[0]||{};if(typeof n!="object"||n.type&&n.sdp)return r.apply(this,arguments);if(n={type:n.type,sdp:n.sdp},!n.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":n.type="offer";break;default:n.type="answer";break}return n.sdp||n.type!=="offer"&&n.type!=="answer"?r.apply(this,[n]):(n.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>r.apply(this,[a]))})}const Pl=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:Ir,shimAddIceCandidateNullOrEmpty:Wt,shimConnectionState:Er,shimMaxMessageSize:Vt,shimParameterlessSetLocalDescription:Ht,shimRTCIceCandidate:qt,shimRTCIceCandidateRelayProtocol:$r,shimSendThrowTypeError:Gt},Symbol.toStringTag,{value:"Module"}));function _l({window:i}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const r=Ui,t=wl(i),n={browserDetails:t,commonShim:Pl,extractVersion:Tt,disableLog:vl,disableWarnings:kl,sdp:Cl};switch(t.browser){case"chrome":if(!En||!_r||!e.shimChrome)return r("Chrome shim is not included in this adapter release."),n;if(t.version===null)return r("Chrome shim can not determine version, not shimming."),n;r("adapter.js shimming chrome."),n.browserShim=En,Wt(i,t),Ht(i),qi(i,t),Vi(i),_r(i,t),Gi(i),Yi(i,t),Wi(i),Hi(i),Ji(i,t),qt(i),$r(i),Er(i),Vt(i,t),Gt(i),Ir(i,t);break;case"firefox":if(!In||!Tr||!e.shimFirefox)return r("Firefox shim is not included in this adapter release."),n;r("adapter.js shimming firefox."),n.browserShim=In,Wt(i,t),Ht(i),Xi(i,t),Tr(i,t),Zi(i),to(i),Qi(i),eo(i),ro(i),no(i),io(i),oo(i),ao(i),qt(i),Er(i),Vt(i,t),Gt(i);break;case"safari":if(!Rn||!e.shimSafari)return r("Safari shim is not included in this adapter release."),n;r("adapter.js shimming safari."),n.browserShim=Rn,Wt(i,t),Ht(i),fo(i),mo(i),co(i),so(i),lo(i),ho(i),uo(i),go(i),qt(i),$r(i),Vt(i,t),Gt(i),Ir(i,t);break;default:r("Unsupported browser!");break}return n}const An=_l({window:typeof window>"u"?void 0:window});function ft(i,e,r,t){Object.defineProperty(i,e,{get:r,set:t,enumerable:!0,configurable:!0})}class bo{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const r=[],t=e.byteLength,n=Math.ceil(t/this.chunkedMTU);let o=0,a=0;for(;a<t;){const s=Math.min(t,a+this.chunkedMTU),u=e.slice(a,s),l={__peerData:this._dataCount,n:o,data:u,total:n};r.push(l),a=s,o++}return this._dataCount++,r}}}function Tl(i){let e=0;for(const n of i)e+=n.byteLength;const r=new Uint8Array(e);let t=0;for(const n of i)r.set(n,t),t+=n.byteLength;return r}const pr=An.default||An,kt=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const i=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(i)?i==="chrome"?e>=this.minChromeVersion:i==="firefox"?e>=this.minFirefoxVersion:i==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return pr.browserDetails.browser}getVersion(){return pr.browserDetails.version||0}isUnifiedPlanSupported(){const i=this.getBrowser(),e=pr.browserDetails.version||0;if(i==="chrome"&&e<this.minChromeVersion)return!1;if(i==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let r,t=!1;try{r=new RTCPeerConnection,r.addTransceiver("audio"),t=!0}catch{}finally{r&&r.close()}return t}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},$l=i=>!i||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(i),vo=()=>Math.random().toString(36).slice(2),Nn={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class El extends bo{noop(){}blobToArrayBuffer(e,r){const t=new FileReader;return t.onload=function(n){n.target&&r(n.target.result)},t.readAsArrayBuffer(e),t}binaryStringToArrayBuffer(e){const r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t)&255;return r.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=Nn,this.browser=kt.getBrowser(),this.browserVersion=kt.getVersion(),this.pack=ji,this.unpack=Di,this.supports=function(){const r={browser:kt.isBrowserSupported(),webRTC:kt.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!r.webRTC)return r;let t;try{t=new RTCPeerConnection(Nn),r.audioVideo=!0;let n;try{n=t.createDataChannel("_PEERJSTEST",{ordered:!0}),r.data=!0,r.reliable=!!n.ordered;try{n.binaryType="blob",r.binaryBlob=!kt.isIOS}catch{}}catch{}finally{n&&n.close()}}catch{}finally{t&&t.close()}return r}(),this.validateId=$l,this.randomToken=vo}}const Ae=new El,Il="PeerJS: ";var On;(function(i){i[i.Disabled=0]="Disabled",i[i.Errors=1]="Errors",i[i.Warnings=2]="Warnings",i[i.All=3]="All"})(On||(On={}));class Rl{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...r){const t=[Il,...r];for(const n in t)t[n]instanceof Error&&(t[n]="("+t[n].name+") "+t[n].message);e>=3?console.log(...t):e>=2?console.warn("WARNING",...t):e>=1&&console.error("ERROR",...t)}constructor(){this._logLevel=0}}var z=new Rl,Gr={},Ml=Object.prototype.hasOwnProperty,$e="~";function Mt(){}Object.create&&(Mt.prototype=Object.create(null),new Mt().__proto__||($e=!1));function Al(i,e,r){this.fn=i,this.context=e,this.once=r||!1}function ko(i,e,r,t,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var o=new Al(r,t||i,n),a=$e?$e+e:e;return i._events[a]?i._events[a].fn?i._events[a]=[i._events[a],o]:i._events[a].push(o):(i._events[a]=o,i._eventsCount++),i}function Kt(i,e){--i._eventsCount===0?i._events=new Mt:delete i._events[e]}function _e(){this._events=new Mt,this._eventsCount=0}_e.prototype.eventNames=function(){var e=[],r,t;if(this._eventsCount===0)return e;for(t in r=this._events)Ml.call(r,t)&&e.push($e?t.slice(1):t);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};_e.prototype.listeners=function(e){var r=$e?$e+e:e,t=this._events[r];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,o=t.length,a=new Array(o);n<o;n++)a[n]=t[n].fn;return a};_e.prototype.listenerCount=function(e){var r=$e?$e+e:e,t=this._events[r];return t?t.fn?1:t.length:0};_e.prototype.emit=function(e,r,t,n,o,a){var s=$e?$e+e:e;if(!this._events[s])return!1;var u=this._events[s],l=arguments.length,c,d;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,r),!0;case 3:return u.fn.call(u.context,r,t),!0;case 4:return u.fn.call(u.context,r,t,n),!0;case 5:return u.fn.call(u.context,r,t,n,o),!0;case 6:return u.fn.call(u.context,r,t,n,o,a),!0}for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];u.fn.apply(u.context,c)}else{var f=u.length,p;for(d=0;d<f;d++)switch(u[d].once&&this.removeListener(e,u[d].fn,void 0,!0),l){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,r);break;case 3:u[d].fn.call(u[d].context,r,t);break;case 4:u[d].fn.call(u[d].context,r,t,n);break;default:if(!c)for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];u[d].fn.apply(u[d].context,c)}}return!0};_e.prototype.on=function(e,r,t){return ko(this,e,r,t,!1)};_e.prototype.once=function(e,r,t){return ko(this,e,r,t,!0)};_e.prototype.removeListener=function(e,r,t,n){var o=$e?$e+e:e;if(!this._events[o])return this;if(!r)return Kt(this,o),this;var a=this._events[o];if(a.fn)a.fn===r&&(!n||a.once)&&(!t||a.context===t)&&Kt(this,o);else{for(var s=0,u=[],l=a.length;s<l;s++)(a[s].fn!==r||n&&!a[s].once||t&&a[s].context!==t)&&u.push(a[s]);u.length?this._events[o]=u.length===1?u[0]:u:Kt(this,o)}return this};_e.prototype.removeAllListeners=function(e){var r;return e?(r=$e?$e+e:e,this._events[r]&&Kt(this,r)):(this._events=new Mt,this._eventsCount=0),this};_e.prototype.off=_e.prototype.removeListener;_e.prototype.addListener=_e.prototype.on;_e.prefixed=$e;_e.EventEmitter=_e;Gr=_e;var ht={};ft(ht,"ConnectionType",()=>Ke);ft(ht,"PeerErrorType",()=>ge);ft(ht,"BaseConnectionErrorType",()=>At);ft(ht,"DataConnectionErrorType",()=>Nt);ft(ht,"SerializationType",()=>gt);ft(ht,"SocketEventType",()=>He);ft(ht,"ServerMessageType",()=>Se);var Ke;(function(i){i.Data="data",i.Media="media"})(Ke||(Ke={}));var ge;(function(i){i.BrowserIncompatible="browser-incompatible",i.Disconnected="disconnected",i.InvalidID="invalid-id",i.InvalidKey="invalid-key",i.Network="network",i.PeerUnavailable="peer-unavailable",i.SslUnavailable="ssl-unavailable",i.ServerError="server-error",i.SocketError="socket-error",i.SocketClosed="socket-closed",i.UnavailableID="unavailable-id",i.WebRTC="webrtc"})(ge||(ge={}));var At;(function(i){i.NegotiationFailed="negotiation-failed",i.ConnectionClosed="connection-closed"})(At||(At={}));var Nt;(function(i){i.NotOpenYet="not-open-yet",i.MessageToBig="message-too-big"})(Nt||(Nt={}));var gt;(function(i){i.Binary="binary",i.BinaryUTF8="binary-utf8",i.JSON="json",i.None="raw"})(gt||(gt={}));var He;(function(i){i.Message="message",i.Disconnected="disconnected",i.Error="error",i.Close="close"})(He||(He={}));var Se;(function(i){i.Heartbeat="HEARTBEAT",i.Candidate="CANDIDATE",i.Offer="OFFER",i.Answer="ANSWER",i.Open="OPEN",i.Error="ERROR",i.IdTaken="ID-TAKEN",i.InvalidKey="INVALID-KEY",i.Leave="LEAVE",i.Expire="EXPIRE"})(Se||(Se={}));var Wr={};Wr=JSON.parse('{"name":"peerjs","version":"1.5.4","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Soren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.1.0","webrtc-adapter":"^9.0.0"},"alias":{"process":false,"buffer":false}}');class Nl extends Gr.EventEmitter{constructor(e,r,t,n,o,a=5e3){super(),this.pingInterval=a,this._disconnected=!0,this._messagesQueue=[];const s=e?"wss://":"ws://";this._baseUrl=s+r+":"+t+n+"peerjs?key="+o}start(e,r){this._id=e;const t=`${this._baseUrl}&id=${e}&token=${r}`;this._socket||!this._disconnected||(this._socket=new WebSocket(t+"&version="+Wr.version),this._disconnected=!1,this._socket.onmessage=n=>{let o;try{o=JSON.parse(n.data),z.log("Server message received:",o)}catch{z.log("Invalid server message",n.data);return}this.emit(He.Message,o)},this._socket.onclose=n=>{this._disconnected||(z.log("Socket closed.",n),this._cleanup(),this._disconnected=!0,this.emit(He.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),z.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){z.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:Se.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const r of e)this.send(r)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(He.Error,"Invalid message");return}if(!this._wsOpen())return;const r=JSON.stringify(e);this._socket.send(r)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class wo{constructor(e){this.connection=e}startConnection(e){const r=this._startPeerConnection();if(this.connection.peerConnection=r,this.connection.type===Ke.Media&&e._stream&&this._addTracksToConnection(e._stream,r),e.originator){const t=this.connection,n={ordered:!!e.reliable},o=r.createDataChannel(t.label,n);t._initializeDataChannel(o),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){z.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const r=this.connection.peer,t=this.connection.connectionId,n=this.connection.type,o=this.connection.provider;z.log("Listening for ICE candidates."),e.onicecandidate=a=>{!a.candidate||!a.candidate.candidate||(z.log(`Received ICE candidates for ${r}:`,a.candidate),o.socket.send({type:Se.Candidate,payload:{candidate:a.candidate,type:n,connectionId:t},dst:r}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":z.log("iceConnectionState is failed, closing connections to "+r),this.connection.emitError(At.NegotiationFailed,"Negotiation of connection to "+r+" failed."),this.connection.close();break;case"closed":z.log("iceConnectionState is closed, closing connections to "+r),this.connection.emitError(At.ConnectionClosed,"Connection to "+r+" closed."),this.connection.close();break;case"disconnected":z.log("iceConnectionState changed to disconnected on the connection with "+r);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},z.log("Listening for data channel"),e.ondatachannel=a=>{z.log("Received data channel");const s=a.channel;o.getConnection(r,t)._initializeDataChannel(s)},z.log("Listening for remote stream"),e.ontrack=a=>{z.log("Received remote stream");const s=a.streams[0],u=o.getConnection(r,t);if(u.type===Ke.Media){const l=u;this._addStreamToMediaConnection(s,l)}}}cleanup(){z.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const r=e.signalingState!=="closed";let t=!1;const n=this.connection.dataChannel;n&&(t=!!n.readyState&&n.readyState!=="closed"),(r||t)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,r=this.connection.provider;try{const t=await e.createOffer(this.connection.options.constraints);z.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(t.sdp=this.connection.options.sdpTransform(t.sdp)||t.sdp);try{await e.setLocalDescription(t),z.log("Set localDescription:",t,`for:${this.connection.peer}`);let n={sdp:t,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===Ke.Data){const o=this.connection;n={...n,label:o.label,reliable:o.reliable,serialization:o.serialization}}r.socket.send({type:Se.Offer,payload:n,dst:this.connection.peer})}catch(n){n!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(r.emitError(ge.WebRTC,n),z.log("Failed to setLocalDescription, ",n))}}catch(t){r.emitError(ge.WebRTC,t),z.log("Failed to createOffer, ",t)}}async _makeAnswer(){const e=this.connection.peerConnection,r=this.connection.provider;try{const t=await e.createAnswer();z.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(t.sdp=this.connection.options.sdpTransform(t.sdp)||t.sdp);try{await e.setLocalDescription(t),z.log("Set localDescription:",t,`for:${this.connection.peer}`),r.socket.send({type:Se.Answer,payload:{sdp:t,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(n){r.emitError(ge.WebRTC,n),z.log("Failed to setLocalDescription, ",n)}}catch(t){r.emitError(ge.WebRTC,t),z.log("Failed to create answer, ",t)}}async handleSDP(e,r){r=new RTCSessionDescription(r);const t=this.connection.peerConnection,n=this.connection.provider;z.log("Setting remote description",r);const o=this;try{await t.setRemoteDescription(r),z.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await o._makeAnswer()}catch(a){n.emitError(ge.WebRTC,a),z.log("Failed to setRemoteDescription, ",a)}}async handleCandidate(e){z.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),z.log(`Added ICE candidate for:${this.connection.peer}`)}catch(r){this.connection.provider.emitError(ge.WebRTC,r),z.log("Failed to handleCandidate, ",r)}}_addTracksToConnection(e,r){if(z.log(`add tracks from stream ${e.id} to peer connection`),!r.addTrack)return z.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(t=>{r.addTrack(t,e)})}_addStreamToMediaConnection(e,r){z.log(`add stream ${e.id} to media connection ${r.connectionId}`),r.addStream(e)}}class xo extends Gr.EventEmitter{emitError(e,r){z.error("Error:",r),this.emit("error",new Ol(`${e}`,r))}}class Ol extends Error{constructor(e,r){typeof r=="string"?super(r):(super(),Object.assign(this,r)),this.type=e}}class So extends xo{get open(){return this._open}constructor(e,r,t){super(),this.peer=e,this.provider=r,this.options=t,this._open=!1,this.metadata=t.metadata}}class Xt extends So{static#e=this.ID_PREFIX="mc_";get type(){return Ke.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,r,t){super(e,r,t),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||Xt.ID_PREFIX+Ae.randomToken(),this._negotiator=new wo(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{z.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{z.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){z.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const r=e.type,t=e.payload;switch(e.type){case Se.Answer:this._negotiator.handleSDP(r,t.sdp),this._open=!0;break;case Se.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:z.warn(`Unrecognized message type:${r} from peer:${this.peer}`);break}}answer(e,r={}){if(this._localStream){z.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,r&&r.sdpTransform&&(this.options.sdpTransform=r.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const t=this.provider._getMessages(this.connectionId);for(const n of t)this.handleMessage(n);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class Fl{constructor(e){this._options=e}_buildRequest(e){const r=this._options.secure?"https":"http",{host:t,port:n,path:o,key:a}=this._options,s=new URL(`${r}://${t}:${n}${o}${a}/${e}`);return s.searchParams.set("ts",`${Date.now()}${Math.random()}`),s.searchParams.set("version",Wr.version),fetch(s.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){z.error("Error retrieving ID",e);let r="";throw this._options.path==="/"&&this._options.host!==Ae.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let r="";throw this._options.host===Ae.CLOUD_HOST?r="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":r="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+r)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw z.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}class Zt extends So{static#e=this.ID_PREFIX="dc_";static#n=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return Ke.Data}constructor(e,r,t){super(e,r,t),this.connectionId=this.options.connectionId||Zt.ID_PREFIX+vo(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new wo(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{z.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=r=>{z.log(`DC#${this.connectionId} dc onmessage:`,r.data)},this.dataChannel.onclose=()=>{z.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,r=!1){if(!this.open){this.emitError(Nt.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,r)}async handleMessage(e){const r=e.payload;switch(e.type){case Se.Answer:await this._negotiator.handleSDP(e.type,r.sdp);break;case Se.Candidate:await this._negotiator.handleCandidate(r.candidate);break;default:z.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}}class Hr extends Zt{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",r=>this._handleDataMessage(r))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>Zt.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(r){return z.error(`DC#:${this.connectionId} Error when sending:`,r),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class fr extends Hr{close(e){super.close(e),this._chunkedData={}}constructor(e,r,t){super(e,r,t),this.chunker=new bo,this.serialization=gt.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const r=Di(e),t=r.__peerData;if(t){if(t.type==="close"){this.close();return}this._handleChunk(r);return}this.emit("data",r)}_handleChunk(e){const r=e.__peerData,t=this._chunkedData[r]||{data:[],count:0,total:e.total};if(t.data[e.n]=new Uint8Array(e.data),t.count++,this._chunkedData[r]=t,t.total===t.count){delete this._chunkedData[r];const n=Tl(t.data);this._handleDataMessage({data:n})}}_send(e,r){const t=ji(e);if(t instanceof Promise)return this._send_blob(t);if(!r&&t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}async _send_blob(e){const r=await e;if(r.byteLength>this.chunker.chunkedMTU){this._sendChunks(r);return}this._bufferedSend(r)}_sendChunks(e){const r=this.chunker.chunk(e);z.log(`DC#${this.connectionId} Try to send ${r.length} chunks...`);for(const t of r)this.send(t,!0)}}class Dl extends Hr{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,r){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=gt.None}}class jl extends Hr{_handleDataMessage({data:e}){const r=this.parse(this.decoder.decode(e)),t=r.__peerData;if(t&&t.type==="close"){this.close();return}this.emit("data",r)}_send(e,r){const t=this.encoder.encode(this.stringify(e));if(t.byteLength>=Ae.chunkedMTU){this.emitError(Nt.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(t)}constructor(...e){super(...e),this.serialization=gt.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class Kr extends xo{static#e=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[r,t]of this._connections)e[r]=t;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,r){super(),this._serializers={raw:Dl,json:jl,binary:fr,"binary-utf8":fr,default:fr},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let t;if(e&&e.constructor==Object?r=e:e&&(t=e.toString()),r={debug:0,host:Ae.CLOUD_HOST,port:Ae.CLOUD_PORT,path:"/",key:Kr.DEFAULT_KEY,token:Ae.randomToken(),config:Ae.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...r},this._options=r,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Ae.CLOUD_HOST?this._options.secure=Ae.isSecure():this._options.host==Ae.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&z.setLogFunction(this._options.logFunction),z.logLevel=this._options.debug||0,this._api=new Fl(r),this._socket=this._createServerConnection(),!Ae.supports.audioVideo&&!Ae.supports.data){this._delayedAbort(ge.BrowserIncompatible,"The current browser does not support WebRTC");return}if(t&&!Ae.validateId(t)){this._delayedAbort(ge.InvalidID,`ID "${t}" is invalid`);return}t?this._initialize(t):this._api.retrieveId().then(n=>this._initialize(n)).catch(n=>this._abort(ge.ServerError,n))}_createServerConnection(){const e=new Nl(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(He.Message,r=>{this._handleMessage(r)}),e.on(He.Error,r=>{this._abort(ge.SocketError,r)}),e.on(He.Disconnected,()=>{this.disconnected||(this.emitError(ge.Network,"Lost connection to server."),this.disconnect())}),e.on(He.Close,()=>{this.disconnected||this._abort(ge.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const r=e.type,t=e.payload,n=e.src;switch(r){case Se.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case Se.Error:this._abort(ge.ServerError,t.msg);break;case Se.IdTaken:this._abort(ge.UnavailableID,`ID "${this.id}" is taken`);break;case Se.InvalidKey:this._abort(ge.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case Se.Leave:z.log(`Received leave message from ${n}`),this._cleanupPeer(n),this._connections.delete(n);break;case Se.Expire:this.emitError(ge.PeerUnavailable,`Could not connect to peer ${n}`);break;case Se.Offer:{const o=t.connectionId;let a=this.getConnection(n,o);if(a&&(a.close(),z.warn(`Offer received for existing Connection ID:${o}`)),t.type===Ke.Media){const u=new Xt(n,this,{connectionId:o,_payload:t,metadata:t.metadata});a=u,this._addConnection(n,a),this.emit("call",u)}else if(t.type===Ke.Data){const u=new this._serializers[t.serialization](n,this,{connectionId:o,_payload:t,metadata:t.metadata,label:t.label,serialization:t.serialization,reliable:t.reliable});a=u,this._addConnection(n,a),this.emit("connection",u)}else{z.warn(`Received malformed connection type:${t.type}`);return}const s=this._getMessages(o);for(const u of s)a.handleMessage(u);break}default:{if(!t){z.warn(`You received a malformed message from ${n} of type ${r}`);return}const o=t.connectionId,a=this.getConnection(n,o);a&&a.peerConnection?a.handleMessage(e):o?this._storeMessage(o,e):z.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,r){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(r)}_getMessages(e){const r=this._lostMessages.get(e);return r?(this._lostMessages.delete(e),r):[]}connect(e,r={}){if(r={serialization:"default",...r},this.disconnected){z.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(ge.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const t=new this._serializers[r.serialization](e,this,r);return this._addConnection(e,t),t}call(e,r,t={}){if(this.disconnected){z.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(ge.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!r){z.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const n=new Xt(e,this,{...t,_stream:r});return this._addConnection(e,n),n}_addConnection(e,r){z.log(`add connection ${r.type}:${r.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(r)}_removeConnection(e){const r=this._connections.get(e.peer);if(r){const t=r.indexOf(e);t!==-1&&r.splice(t,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,r){const t=this._connections.get(e);if(!t)return null;for(const n of t)if(n.connectionId===r)return n;return null}_delayedAbort(e,r){setTimeout(()=>{this._abort(e,r)},0)}_abort(e,r){z.error("Aborting!"),this.emitError(e,r),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(z.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const r=this._connections.get(e);if(r)for(const t of r)t.close()}disconnect(){if(this.disconnected)return;const e=this.id;z.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)z.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)z.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=r=>{}){this._api.listAllPeers().then(r=>e(r)).catch(r=>this._abort(ge.ServerError,r))}}var Fn=Kr,hr={exports:{}},mr={exports:{}},Dn;function Ll(){return Dn||(Dn=1,function(){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(r,t){return r<<t|r>>>32-t},rotr:function(r,t){return r<<32-t|r>>>t},endian:function(r){if(r.constructor==Number)return e.rotl(r,8)&16711935|e.rotl(r,24)&4278255360;for(var t=0;t<r.length;t++)r[t]=e.endian(r[t]);return r},randomBytes:function(r){for(var t=[];r>0;r--)t.push(Math.floor(Math.random()*256));return t},bytesToWords:function(r){for(var t=[],n=0,o=0;n<r.length;n++,o+=8)t[o>>>5]|=r[n]<<24-o%32;return t},wordsToBytes:function(r){for(var t=[],n=0;n<r.length*32;n+=8)t.push(r[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(r){for(var t=[],n=0;n<r.length;n++)t.push((r[n]>>>4).toString(16)),t.push((r[n]&15).toString(16));return t.join("")},hexToBytes:function(r){for(var t=[],n=0;n<r.length;n+=2)t.push(parseInt(r.substr(n,2),16));return t},bytesToBase64:function(r){for(var t=[],n=0;n<r.length;n+=3)for(var o=r[n]<<16|r[n+1]<<8|r[n+2],a=0;a<4;a++)n*8+a*6<=r.length*8?t.push(i.charAt(o>>>6*(3-a)&63)):t.push("=");return t.join("")},base64ToBytes:function(r){r=r.replace(/[^A-Z0-9+\/]/ig,"");for(var t=[],n=0,o=0;n<r.length;o=++n%4)o!=0&&t.push((i.indexOf(r.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<o*2|i.indexOf(r.charAt(n))>>>6-o*2);return t}};mr.exports=e}()),mr.exports}var gr,jn;function Ln(){if(jn)return gr;jn=1;var i={utf8:{stringToBytes:function(e){return i.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(i.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var r=[],t=0;t<e.length;t++)r.push(e.charCodeAt(t)&255);return r},bytesToString:function(e){for(var r=[],t=0;t<e.length;t++)r.push(String.fromCharCode(e[t]));return r.join("")}}};return gr=i,gr}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var yr,zn;function zl(){if(zn)return yr;zn=1,yr=function(r){return r!=null&&(i(r)||e(r)||!!r._isBuffer)};function i(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function e(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&i(r.slice(0,0))}return yr}var Un;function Ul(){return Un||(Un=1,function(){var i=Ll(),e=Ln().utf8,r=zl(),t=Ln().bin,n=function(o,a){o.constructor==String?a&&a.encoding==="binary"?o=t.stringToBytes(o):o=e.stringToBytes(o):r(o)?o=Array.prototype.slice.call(o,0):!Array.isArray(o)&&o.constructor!==Uint8Array&&(o=o.toString());for(var s=i.bytesToWords(o),u=o.length*8,l=1732584193,c=-271733879,d=-1732584194,f=271733878,p=0;p<s.length;p++)s[p]=(s[p]<<8|s[p]>>>24)&16711935|(s[p]<<24|s[p]>>>8)&4278255360;s[u>>>5]|=128<<u%32,s[(u+64>>>9<<4)+14]=u;for(var g=n._ff,h=n._gg,y=n._hh,m=n._ii,p=0;p<s.length;p+=16){var b=l,v=c,k=d,x=f;l=g(l,c,d,f,s[p+0],7,-680876936),f=g(f,l,c,d,s[p+1],12,-389564586),d=g(d,f,l,c,s[p+2],17,606105819),c=g(c,d,f,l,s[p+3],22,-1044525330),l=g(l,c,d,f,s[p+4],7,-176418897),f=g(f,l,c,d,s[p+5],12,1200080426),d=g(d,f,l,c,s[p+6],17,-1473231341),c=g(c,d,f,l,s[p+7],22,-45705983),l=g(l,c,d,f,s[p+8],7,1770035416),f=g(f,l,c,d,s[p+9],12,-1958414417),d=g(d,f,l,c,s[p+10],17,-42063),c=g(c,d,f,l,s[p+11],22,-1990404162),l=g(l,c,d,f,s[p+12],7,1804603682),f=g(f,l,c,d,s[p+13],12,-40341101),d=g(d,f,l,c,s[p+14],17,-1502002290),c=g(c,d,f,l,s[p+15],22,1236535329),l=h(l,c,d,f,s[p+1],5,-165796510),f=h(f,l,c,d,s[p+6],9,-1069501632),d=h(d,f,l,c,s[p+11],14,643717713),c=h(c,d,f,l,s[p+0],20,-373897302),l=h(l,c,d,f,s[p+5],5,-701558691),f=h(f,l,c,d,s[p+10],9,38016083),d=h(d,f,l,c,s[p+15],14,-660478335),c=h(c,d,f,l,s[p+4],20,-405537848),l=h(l,c,d,f,s[p+9],5,568446438),f=h(f,l,c,d,s[p+14],9,-1019803690),d=h(d,f,l,c,s[p+3],14,-187363961),c=h(c,d,f,l,s[p+8],20,1163531501),l=h(l,c,d,f,s[p+13],5,-1444681467),f=h(f,l,c,d,s[p+2],9,-51403784),d=h(d,f,l,c,s[p+7],14,1735328473),c=h(c,d,f,l,s[p+12],20,-1926607734),l=y(l,c,d,f,s[p+5],4,-378558),f=y(f,l,c,d,s[p+8],11,-2022574463),d=y(d,f,l,c,s[p+11],16,1839030562),c=y(c,d,f,l,s[p+14],23,-35309556),l=y(l,c,d,f,s[p+1],4,-1530992060),f=y(f,l,c,d,s[p+4],11,1272893353),d=y(d,f,l,c,s[p+7],16,-155497632),c=y(c,d,f,l,s[p+10],23,-1094730640),l=y(l,c,d,f,s[p+13],4,681279174),f=y(f,l,c,d,s[p+0],11,-358537222),d=y(d,f,l,c,s[p+3],16,-722521979),c=y(c,d,f,l,s[p+6],23,76029189),l=y(l,c,d,f,s[p+9],4,-640364487),f=y(f,l,c,d,s[p+12],11,-421815835),d=y(d,f,l,c,s[p+15],16,530742520),c=y(c,d,f,l,s[p+2],23,-995338651),l=m(l,c,d,f,s[p+0],6,-198630844),f=m(f,l,c,d,s[p+7],10,1126891415),d=m(d,f,l,c,s[p+14],15,-1416354905),c=m(c,d,f,l,s[p+5],21,-57434055),l=m(l,c,d,f,s[p+12],6,1700485571),f=m(f,l,c,d,s[p+3],10,-1894986606),d=m(d,f,l,c,s[p+10],15,-1051523),c=m(c,d,f,l,s[p+1],21,-2054922799),l=m(l,c,d,f,s[p+8],6,1873313359),f=m(f,l,c,d,s[p+15],10,-30611744),d=m(d,f,l,c,s[p+6],15,-1560198380),c=m(c,d,f,l,s[p+13],21,1309151649),l=m(l,c,d,f,s[p+4],6,-145523070),f=m(f,l,c,d,s[p+11],10,-1120210379),d=m(d,f,l,c,s[p+2],15,718787259),c=m(c,d,f,l,s[p+9],21,-343485551),l=l+b>>>0,c=c+v>>>0,d=d+k>>>0,f=f+x>>>0}return i.endian([l,c,d,f])};n._ff=function(o,a,s,u,l,c,d){var f=o+(a&s|~a&u)+(l>>>0)+d;return(f<<c|f>>>32-c)+a},n._gg=function(o,a,s,u,l,c,d){var f=o+(a&u|s&~u)+(l>>>0)+d;return(f<<c|f>>>32-c)+a},n._hh=function(o,a,s,u,l,c,d){var f=o+(a^s^u)+(l>>>0)+d;return(f<<c|f>>>32-c)+a},n._ii=function(o,a,s,u,l,c,d){var f=o+(s^(a|~u))+(l>>>0)+d;return(f<<c|f>>>32-c)+a},n._blocksize=16,n._digestsize=16,hr.exports=function(o,a){if(o==null)throw new Error("Illegal argument "+o);var s=i.wordsToBytes(n(o,a));return a&&a.asBytes?s:a&&a.asString?t.bytesToString(s):i.bytesToHex(s)}}()),hr.exports}var Bl=Ul();const ql=Dr(Bl),Vl="7ae48d46-10f2-kitty-";function Gl(){let i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",e="";for(let r=0;r<6;++r){let t=Math.floor(Math.random()*i.length);e+=i.substring(t,t+1)}return e}function Bn(i){return ql(Vl+i)}var Wl=B("<button class=btn>Copy"),Hl=B('<div class="toast toast-center toast-middle">'),Kl=B('<div><div><div class=pb-2><label><div style=display:inline-block;padding-right:5px;>Nickname:</div><input type=text class=input></label></div></div><div><button class="btn btn-outline btn-primary ml-1">Invite</button><button class="btn btn-outline btn-primary ml-1">Join</button></div><div><div>Connections:<table class="table table-zebra"><thead><tr><th></th><th>Nickname</th><th></th></tr></thead><tbody></tbody></table></div><div>Pending Invites:<table class="table table-zebra"><thead><tr><th></th><th>Invite Code</th><th></th></tr></thead><tbody></tbody></table></div></div><dialog class=modal><div class=modal-box>Invite Code:<input type=text class="input ml-2"><button class="btn btn-primary">Paste</button><div class=modal-action><button class="btn btn-primary">OK</button><form method=dialog><button class=btn>Close'),Yl=B('<tr><td></td><td></td><td><button class="btn btn-primary">Kick'),Jl=B('<tr><td></td><td></td><td><button class="btn btn-primary">Copy</button><button class="btn btn-primary ml-1">Delete'),Xl=B('<div class="alert alert-info">');function Zl(i){let[e,r]=Ce({nickname:hl.generateUsername("_"),connections:[],pendingInvites:[],toastStack:[],joinDialogInviteCode:""}),[t,n]=Y(),o=S(()=>e.connections.map(f=>f.value)),a=f=>{let p={};r("toastStack",_t(h=>h.push(new Ft({id:p,Render:f}))));let g=setTimeout(()=>{r("toastStack",e.toastStack.filter(h=>h.value.id!==p)),clearTimeout(g)},5e3)},s=()=>{let[f,p]=Y(!1),g=Gl(),h=Bn(g),y=new Fn(h),m={inviteCode:g,peer:y};y.on("open",()=>{y.on("connection",b=>{b.once("data",v=>{typeof v=="string"&&(r("connections",_t(k=>k.push(new Ft({nickname:v,peer:y,conn:b})))),b.send({nickname:e.nickname,documentUrl:i.documentUrl()??null}),r("pendingInvites",e.pendingInvites.filter(k=>k.value!=m)))}),b.once("close",()=>{r("connections",e.connections.filter(v=>v.value.peer!==y))})}),r("pendingInvites",_t(b=>b.push(new Ft(m)))),a(()=>["Invite Code: ",g,(()=>{var b=Wl();return b.$$click=async()=>{await navigator.clipboard.writeText(g),p(!0);let v=setTimeout(()=>{clearTimeout(v),p(!1)},1e3)},b})(),I(ie,{get when(){return f()},children:"Copied"})])})},u=()=>{r("joinDialogInviteCode",""),t()?.showModal()},l=()=>{t()?.close();let f=e.joinDialogInviteCode;r("joinDialogInviteCode","");let p=Bn(f),g=new Fn;g.on("open",()=>{let h=g.connect(p);h.on("open",()=>{h.once("data",y=>{let m=y.nickname,b=y.documentUrl;typeof m=="string"&&typeof b=="string"&&(i.setDocumentUrl(b),r("connections",_t(v=>v.push(new Ft({nickname:m,peer:g,conn:h})))))}),h.send(e.nickname),h.once("close",()=>{r("connections",e.connections.filter(y=>y.value.peer!==g))})})})},c=f=>{f.peer.destroy()};return{connections:o,Render:()=>(()=>{var f=Kl(),p=f.firstChild,g=p.firstChild,h=g.firstChild,y=h.firstChild,m=y.nextSibling,b=p.nextSibling,v=b.firstChild,k=v.nextSibling,x=b.nextSibling,w=x.firstChild,C=w.firstChild,P=C.nextSibling,T=P.firstChild,$=T.nextSibling,_=w.nextSibling,M=_.firstChild,L=M.nextSibling,O=L.firstChild,R=O.nextSibling,F=x.nextSibling,V=F.firstChild,j=V.firstChild,G=j.nextSibling,H=G.nextSibling,te=H.nextSibling,A=te.firstChild;f.style.setProperty("width","100%"),f.style.setProperty("height","100%"),f.style.setProperty("display","flex"),f.style.setProperty("flex-direction","column"),f.style.setProperty("padding","10px"),f.style.setProperty("position","relative"),m.$$input=re=>{r("nickname",re.currentTarget.validationMessage)},v.$$click=()=>s(),k.$$click=()=>u(),x.style.setProperty("flex-grow","1"),x.style.setProperty("display","flex"),x.style.setProperty("flex-direction","column"),x.style.setProperty("margin-top","10px"),w.style.setProperty("flex-grow","1"),w.style.setProperty("overflow-y","auto"),W($,I(qe,{get each(){return e.connections},children:re=>(()=>{var ve=Yl(),le=ve.firstChild,se=le.nextSibling,Re=se.nextSibling,De=Re.firstChild;return W(se,()=>re.value.nickname),De.$$click=()=>{c(re.value)},ve})()})),_.style.setProperty("flex-grow","1"),_.style.setProperty("overflow-y","auto"),W(R,I(qe,{get each(){return e.pendingInvites},children:re=>{let[ve,le]=Y(!1);return(()=>{var se=Jl(),Re=se.firstChild,De=Re.nextSibling,Ve=De.nextSibling,Xe=Ve.firstChild,Ge=Xe.nextSibling;return W(De,()=>re.value.inviteCode),Xe.$$click=async()=>{await navigator.clipboard.writeText(re.value.inviteCode),le(!0);let me=setTimeout(()=>{clearTimeout(me),le(!1)},1e3)},Ge.$$click=()=>{re.value.peer.destroy(),r("pendingInvites",e.pendingInvites.filter(me=>me.value!==re.value))},W(Ve,I(ie,{get when(){return ve()},children:"Copied"}),null),se})()}})),W(f,I(ie,{get when(){return e.toastStack.length!=0},get children(){var re=Hl();return W(re,I(qe,{get each(){return e.toastStack},children:ve=>(()=>{var le=Xl();return W(le,I(ve.value.Render,{})),le})()})),re}}),F);var X=n;return typeof X=="function"?he(X,F):n=F,G.addEventListener("change",()=>{l()}),G.$$input=re=>{r("joinDialogInviteCode",re.currentTarget.value)},H.$$click=async()=>{let re=await navigator.clipboard.readText();r("joinDialogInviteCode",re)},A.$$click=()=>l(),Z(()=>m.value=e.nickname),Z(()=>G.value=e.joinDialogInviteCode),f})()}}be(["click","input"]);class Ql extends ul{#e=!1;#n;connection;#r=!1;#i;#a=new Promise(e=>{this.#i=e});#t=[];isReady(){return this.#r}whenReady(){return this.#a}#s(){this.#r||(this.#r=!0,this.#i?.())}constructor(e){super(),this.#n=e,this.connection=e.connection}connect(e,r){this.peerId=e,this.peerMetadata=r,this.#e=!1,this.connection.on("data",t=>{if(typeof t!="string")return;const n=JSON.parse(t);if(console.log("message in, ",n),"targetId"in n&&n.targetId!==this.peerId||this.#e)return;const{senderId:o,type:a}=n;switch(a){case"arrive":{const{peerMetadata:s}=n;this.connection.send(JSON.stringify({senderId:this.peerId,targetId:o,type:"welcome",peerMetadata:this.peerMetadata})),this.#o(o,s)}break;case"welcome":{const{peerMetadata:s}=n;this.#o(o,s)}break;case"leave":this.#t=this.#t.filter(s=>s!==o),this.emit("peer-disconnected",{peerId:o});break;default:if(!("data"in n))this.emit("message",n);else{if(!n.data)throw new Error("We got a message without data, we can't send this.");const s=n.data;this.emit("message",{...n,data:new Uint8Array(s)})}break}}),this.connection.send(JSON.stringify({senderId:this.peerId,type:"arrive",peerMetadata:r}))}#o(e,r){this.#s(),this.#t.push(e),this.emit("peer-candidate",{peerId:e,peerMetadata:r})}send(e){if(this.#e)return!1;if("data"in e){let r=e.data?e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength):void 0,t=r==null?void 0:Array.from(new Uint8Array(r));this.connection.send(JSON.stringify({...e,data:t}))}else this.connection.send(JSON.stringify(e))}disconnect(){this.connection.send(JSON.stringify({senderId:this.peerId,type:"leave"}));for(const e of this.#t)this.emit("peer-disconnected",{peerId:e});this.#e=!0}}const ec=261.63,qn=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}];class tc{audioContext=void 0;pianoNodes=[];constructor(){}async init(){if(this.audioContext){this.audioContext.state==="suspended"?await this.audioContext.resume():this.audioContext.state==="running"&&await this.audioContext.suspend();return}this.audioContext=new AudioContext,await this.audioContext.audioWorklet.addModule(Rr),await this.audioContext.audioWorklet.addModule(Co),await this.audioContext.audioWorklet.addModule(Po),await this.audioContext.audioWorklet.addModule(_o);let e=this.audioContext.createGain();e.gain.value=.1,e.connect(this.audioContext.destination),this.pianoNodes=[];for(let r=0;r<12;++r){let t=new AudioWorkletNode(this.audioContext,"piano-processor");t.connect(e),this.pianoNodes.push(t)}}async noteOn(e){if(this.audioContext==null){await this.init();return}this.audioContext.state==="suspended"&&await this.audioContext.resume();let r=qn.findIndex(n=>n.name==e);if(r==-1)return;let t=ec*Math.pow(2,r/12);this.pianoNodes[r].port.postMessage({type:"noteOn",frequency:t})}async noteOff(e){this.audioContext==null&&await this.init();let r=qn.findIndex(t=>t.name==e);r!=-1&&this.pianoNodes[r].port.postMessage({type:"noteOff"})}play(){this.init()}}const rc=`
class SineProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = Math.sin(this.phase); // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('sine-processor', SineProcessor);
`,nc=new Blob([rc],{type:"application/javascript"}),Rr=URL.createObjectURL(nc),ic=`
class SawProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = this.phase; // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('saw-processor', SawProcessor);
`,oc=new Blob([ic],{type:"application/javascript"}),Co=URL.createObjectURL(oc),ac=`
class SquareProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = (this.phase < Math.PI ? 0 : 1); // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('square-processor', SquareProcessor);
`,sc=new Blob([ac],{type:"application/javascript"}),Po=URL.createObjectURL(sc),lc=`
class PianoProcessor extends AudioWorkletProcessor {
    constructor() {
        super();
        this.phase = 0;
        this.sampleRate = sampleRate; // Global sampleRate from AudioWorkletGlobalScope

        // Define harmonics (fundamental + a few overtones) and their relative gains
        // These values are simplified and can be tweaked for different piano sounds
        this.harmonics = [
            { freqMultiplier: 1, gain: 1.0 },   // Fundamental
            { freqMultiplier: 2, gain: 0.6 },   // 1st overtone (octave)
            { freqMultiplier: 3, gain: 0.4 },   // 2nd overtone (fifth above octave)
            { freqMultiplier: 4, gain: 0.3 },   // 3rd overtone (two octaves)
            { freqMultiplier: 5, gain: 0.2 },   // 4th overtone (major third)
        ];

        // ADSR envelope parameters (simplified)
        this.attackTime = 0.01; // Very fast attack
        this.decayTime = 0.1;
        this.sustainLevel = 0.6;
        this.releaseTime = 0.8;

        this.envelopePhase = 0; // 0: idle, 1: attack, 2: decay, 3: sustain, 4: release
        this.currentGain = 0;
        this.noteOnTime = 0;
        this.noteOffTime = 0;
        this.frequency = 0; // Will be set via port.onmessage

        this.port.onmessage = (event) => {
            if (event.data.type === 'noteOn') {
                this.frequency = event.data.frequency;
                this.noteOnTime = currentTime; // Global currentTime from AudioWorkletGlobalScope
                this.envelopePhase = 1; // Start attack
                this.phase = 0; // Reset phase for new note
            } else if (event.data.type === 'noteOff') {
                this.noteOffTime = currentTime;
                this.envelopePhase = 4; // Start release
            }
        };
    }

    process(inputs, outputs, parameters) {
        const output = outputs[0]; // Assuming mono output for simplicity
        const channel = output[0]; // Get the first channel

        for (let i = 0; i < channel.length; ++i) {
            let sample = 0;

            // Update envelope
            if (this.envelopePhase === 1) { // Attack
                const timeElapsed = currentTime - this.noteOnTime;
                if (timeElapsed < this.attackTime) {
                    this.currentGain = timeElapsed / this.attackTime;
                } else {
                    this.currentGain = 1.0;
                    this.envelopePhase = 2; // Move to decay
                    this.decayStartTime = currentTime;
                }
            } else if (this.envelopePhase === 2) { // Decay
                const timeElapsed = currentTime - this.decayStartTime;
                if (timeElapsed < this.decayTime) {
                    this.currentGain = 1.0 - (1.0 - this.sustainLevel) * (timeElapsed / this.decayTime);
                } else {
                    this.currentGain = this.sustainLevel;
                    this.envelopePhase = 3; // Move to sustain
                }
            } else if (this.envelopePhase === 3) { // Sustain (maintain currentGain)
                // Nothing to do, just hold the sustain level
            } else if (this.envelopePhase === 4) { // Release
                const timeElapsed = currentTime - this.noteOffTime;
                if (timeElapsed < this.releaseTime) {
                    this.currentGain = this.sustainLevel * (1.0 - (timeElapsed / this.releaseTime));
                } else {
                    this.currentGain = 0;
                    this.envelopePhase = 0; // Go to idle
                    this.frequency = 0; // Stop generating sound
                }
            }

            // Generate sound if frequency and gain are active
            if (this.frequency > 0 && this.currentGain > 0.001) { // Threshold to prevent silence from generating
                for (const harmonic of this.harmonics) {
                    const freq = this.frequency * harmonic.freqMultiplier;
                    sample += Math.sin(this.phase * freq * 2 * Math.PI) * harmonic.gain;
                }
                sample *= this.currentGain; // Apply envelope gain
            } else {
                sample = 0; // No sound
            }

            channel[i] = sample;

            // Advance phase for the next sample
            this.phase += 1 / this.sampleRate;
            if (this.phase >= 1) {
                this.phase -= 1; // Keep phase within [0, 1)
            }
        }

        // Return false when the sound is completely silent to allow garbage collection
        //return this.envelopePhase !== 0 || this.currentGain > 0.001;
        return true;
    }
}

registerProcessor('piano-processor', PianoProcessor);`,cc=new Blob([lc],{type:"application/javascript"}),_o=URL.createObjectURL(cc);window.addEventListener("beforeunload",()=>{Rr&&(URL.revokeObjectURL(Rr),URL.revokeObjectURL(Co),URL.revokeObjectURL(Po),URL.revokeObjectURL(_o))});var uc=B("<div class=piano>"),dc=B("<div class=white-key>"),pc=B("<div class=black-key>");const fc=i=>{const e=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}],r=150,t=80;let n,o=new ct,a=new We;return(()=>{var s=uc();s.$$pointermove=l=>{if(!o.get(l.pointerId))return;let c=n.getBoundingClientRect();o.set(l.pointerId,mn.create(l.clientX-c.left,l.clientY-c.top))},s.addEventListener("pointercancel",l=>{o.delete(l.pointerId),n.releasePointerCapture(l.pointerId)}),s.$$pointerup=l=>{o.delete(l.pointerId),n.releasePointerCapture(l.pointerId)},s.$$pointerdown=l=>{let c=n.getBoundingClientRect();o.set(l.pointerId,mn.create(l.clientX-c.left,l.clientY-c.top)),n.setPointerCapture(l.pointerId)};var u=n;return typeof u=="function"?he(u,s):n=s,s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","row"),s.style.setProperty("overflow-x","auto"),s.style.setProperty("user-select","none"),s.style.setProperty("touch-action","none"),W(s,I(qe,{each:e,children:l=>{let[c,d]=Y();l.type=="black"&&ae(()=>{let p=c();p!=null&&(a.add(p),ye(()=>a.delete(p)))});let f=S(()=>{let p=c();if(p==null)return!1;let g=n.getBoundingClientRect(),h=p.getBoundingClientRect();for(let y of o.values()){let m=g.left+y.x-h.left,b=g.top+y.y-h.top;if(0<m&&m<h.width&&0<b&&b<h.height){if(l.type=="white")for(let v of a){let k=v.getBoundingClientRect(),x=g.left+y.x-k.left,w=g.top+y.y-k.top;if(0<x&&x<k.width&&0<w&&w<k.height)return!1}return!0}}return!1});return ae(ne(f,p=>{p?i.onNoteOn(l.name):i.onNoteOff(l.name)},{defer:!0})),I(zr,{get children(){return[I(ut,{get when(){return l.type=="white"},get children(){var p=dc(),g=d;return typeof g=="function"?he(g,p):d=p,p.style.setProperty("width","50px"),p.style.setProperty("pointer-events","none"),Z(h=>{var y=!!f(),m=`${r+(f()?2:0)}px`;return y!==h.e&&p.classList.toggle("pressed",h.e=y),m!==h.t&&((h.t=m)!=null?p.style.setProperty("height",m):p.style.removeProperty("height")),h},{e:void 0,t:void 0}),p}}),I(ut,{get when(){return l.type=="black"},get children(){var p=pc(),g=d;return typeof g=="function"?he(g,p):d=p,p.style.setProperty("margin-left","-16px"),p.style.setProperty("margin-right","-14px"),p.style.setProperty("width","30px"),p.style.setProperty("pointer-events","none"),Z(h=>{var y=!!f(),m=`${t+(f()?2:0)}px`;return y!==h.e&&p.classList.toggle("pressed",h.e=y),m!==h.t&&((h.t=m)!=null?p.style.setProperty("height",m):p.style.removeProperty("height")),h},{e:void 0,t:void 0}),p}})]}})}})),s})()};be(["pointerdown","pointerup","pointermove"]);function D(i){return{type:"MaybeUndefined",element:i}}function hc(){return{type:"Boolean"}}function Le(){return{type:"Number"}}function Ye(){return{type:"String"}}function q(i){return{type:"Object",properties:i}}function Q(i){return{type:"Array",element:i}}function Yr(i,e,r){return{type:"Invarant",fromFn:i,toFn:e,inner:r}}function To(i,e){return{type:"Default",value:i,inner:e}}function Te(i,e){switch(i.type){case"Boolean":return typeof e!="boolean"?je("Expected a boolean."):de(e);case"Number":return typeof e!="number"?je("Expected a number."):de(e);case"String":return typeof e!="string"?je("Expected a string."):de(e);case"MaybeUndefined":return e==null?de(void 0):Te(i.element,e);case"MaybeNull":return e==null?de(null):Te(i.element,e);case"Union":{let r=e[i.selector];if(typeof r!="string")return je("Missing type param for union.");let t={...e};delete t[i.selector];let n=q(i.parts[r]),o=Te(n,t);if(o.type=="Err")return je(`Problem parsing union part ${r}: ${o.message}`);let s={...o.value};return s[i.selector]=r,de(s)}case"Array":{let r=[];for(let t of e){let n=Te(i.element,t);if(n.type=="Err")return n;r.push(n.value)}return de(r)}case"Object":{let r={};for(let t of Object.keys(i.properties)){let n=i.properties[t];Object.hasOwn(e,t)||(r[t]=Fe(n));let o=Te(i.properties[t],e[t]);if(o.type=="Err")return je(`Problem parsing field ${t}: ${o.message}`);r[t]=o.value}return de(r)}case"Recursive":{let r=i.inner();return Te(r,e)}case"Invarant":{let r=i.fromFn,t=Te(i.inner,e);return t.type=="Err"?t:de(r(t.value))}case"Default":{let r=i.inner,t;try{t=Te(r,e)}catch(n){t=je(""+n)}return t.type=="Err"?de(i.value):de(t.value)}case"Json":return de(e)}}function Fe(i){switch(i.type){case"Boolean":return!1;case"Number":return 0;case"String":return"";case"MaybeUndefined":return;case"MaybeNull":return null;case"Union":{let e=Object.keys(i.parts)[0],r=Fe(q(i.parts[e]));return r[i.selector]=e,r}case"Array":return[];case"Object":{let e={};for(let r of Object.keys(i.properties)){let t=i.properties[r];e[r]=Fe(t)}return e}case"Recursive":{let e=i.inner();return Fe(e)}case"Invarant":{let e=i.fromFn,r=Fe(i.inner);return e(r)}case"Default":return i.value;case"Json":return null}}function Ne(i,e){switch(i.type){case"Boolean":return e;case"Number":return e;case"String":return e;case"MaybeUndefined":return e==null?null:Ne(i.element,e);case"MaybeNull":return e==null?null:Ne(i.element,e);case"Union":{let r=e[i.selector],t={...e};delete t[i.selector];let n=Ne(q(i.parts[r]),t);return n[i.selector]=r,n}case"Object":{let r={};for(let t of Object.keys(i.properties))r[t]=Ne(i.properties[t],e[t]);return r}case"Array":return e.map(r=>Ne(i.element,r));case"Recursive":{let r=i.inner();return Ne(r,e)}case"Invarant":{let r=i.toFn,t=r(e);return Ne(i.inner,t)}case"Default":return Ne(i.inner,e);case"Json":return e}}function Jr(i,e,r){if(typeof i!="object"||i.type!="Object")return je("Only projections of objects are supported");let t={};for(let[n,o]of Object.entries(i.properties)){let a=o;Object.defineProperty(t,n,{get(){let s=e?.[n];if(typeof o=="object"){if(o.type=="Object"){let l=Jr(a,s,c=>r(d=>c(d[n])));if(l.type=="Err")throw new Error("Unreachable");return l.value}if(o.type=="Array"){let l=$o(a,s,c=>r(d=>{c(d[n])}));if(l.type=="Err")throw new Error("Unreachable");return l.value}}let u=Te(a,s);return u.type=="Err"?Fe(a):u.value},set(s){let u=Ne(a,s);JSON.stringify(e[n])!=JSON.stringify(u)&&r(l=>l[n]=u)}})}return de(t)}function $o(i,e,r){if(typeof i!="object"||i.type!="Array")return je("Expected an array for projection");let t=i.element,n=[],o=new Proxy(n,{get(a,s,u){if(s=="length")return n.length=e.length,e.length;if(typeof s=="string"&&!Number.isNaN(Number.parseInt(s))){let l=Number.parseInt(s),c=e?.[l];if(typeof t=="object"){if(t.type=="Object"){let f=Jr(t,c,p=>r(g=>{p(g[l])}));if(f.type=="Err")throw new Error("Unreachable");return f.value}if(t.type=="Array"){let f=$o(t,c,p=>r(g=>{p(g[s])}));if(f.type=="Err")throw new Error("Unreachable");return f.value}}let d=Te(t,c);return d.type=="Err"?Fe(t):d.value}return Reflect.get(n,s,n)},set(a,s,u,l){if(typeof s=="string"&&!Number.isNaN(Number.parseInt(s))){let c=Number.parseInt(s),d=Ne(t,u);if(JSON.stringify(e[c])==JSON.stringify(u))return!1;r(f=>f[c]=d)}return Reflect.set(n,s,u,n)}});return de(o)}function Qt(i,e,r){if(typeof r!="object"||r.type!="Object")throw new Error("Expected object.");{let o=Vn.get(i);if(o!=null)return o}let t=r.properties,n=new Proxy({},{defineProperty(o,a,s){return Reflect.defineProperty(o,a,s)},deleteProperty(o,a){return Reflect.deleteProperty(o,a)},getOwnPropertyDescriptor(o,a){if(t[a]!=null){let s=Reflect.getOwnPropertyDescriptor(t,a);return s==null?void 0:(s={...s},s.value=n[a],s)}return Reflect.getOwnPropertyDescriptor(o,a)},getPrototypeOf(o){return Reflect.getPrototypeOf(o)},has(o,a){return t[a]!=null?!0:Reflect.has(o,a)},isExtensible(o){return Reflect.isExtensible(o)},ownKeys(o){return[...Reflect.ownKeys(t),...Reflect.ownKeys(o)]},preventExtensions(o){return Reflect.preventExtensions(o)},setPrototypeOf(o,a){return Reflect.setPrototypeOf(o,a)},get(o,a,s){if(typeof a=="symbol")return o[a];if(typeof a=="string"){let u=t[a];if(u!=null){if(u.type=="Object")return Qt(i[a],c=>e(d=>c(d[a])),u);if(u.type=="Array")return Mr(i[a],c=>e(d=>c(d[a])),u);let l=Te(u,i[a]);return l.type=="Err"?Fe(u):l.value}}return Reflect.get(o,a,s)},set(o,a,s,u){if(typeof a=="symbol")return o[a]=s,!0;if(typeof a=="string"){let l=t[a];if(l!=null){let c=Ne(l,s);return e(d=>d[a]=c),!0}}return Reflect.set(o,a,s,u)}});return Vn.set(i,n),n}function Mr(i,e,r){if(typeof r!="object"||r.type!="Array")throw new Error("Expected object.");{let a=Gn.get(i);if(a!=null)return a}let t=r.element,n=function*(){for(let a=0;a<i.length;++a)yield o[a]},o=new Proxy([void 0],{defineProperty(a,s,u){return Reflect.defineProperty(a,s,u)},deleteProperty(a,s){return Reflect.deleteProperty(a,s)},getOwnPropertyDescriptor(a,s){let u=typeof s=="string"?Number.parseInt(s):void 0;if(Number.isNaN(u)&&(u=void 0),u!=null){let c=Reflect.getOwnPropertyDescriptor(a,0);return c==null?void 0:(c={...c},c.value=o[s],c)}let l=Reflect.getOwnPropertyDescriptor(a,s);if(l!=null)return s==="length"&&(l={...l},l.value=i.length),l},getPrototypeOf(a){return Reflect.getPrototypeOf(a)},has(a,s){let u=typeof s=="string"?Number.parseInt(s):void 0;return Number.isNaN(u)&&(u=void 0),u!=null?0<=u&&u<i.length:Reflect.has(a,s)},isExtensible(a){return Reflect.isExtensible(a)},ownKeys(a){return[...Array(i.length).fill(void 0).map((s,u)=>u.toString()),...Reflect.ownKeys(a).filter(s=>s!="0")]},preventExtensions(a){return Reflect.preventExtensions(a)},setPrototypeOf(a,s){return Reflect.setPrototypeOf(a,s)},get(a,s,u){if(s==Symbol.iterator)return n;if(typeof s=="symbol")return a[s];if(s==="length")return i.length;if(s==="findIndex")return function(l,c){console.log("Intercepted findIndex call!");const d=[];for(let f=0;f<i.length;f++)if(t.type=="Object")d.push(Qt(i[f],p=>e(g=>p(g[f])),t));else if(t.type=="Array")d.push(Mr(i[f],p=>e(g=>p(g[f])),t));else{let p=Te(t,i[f]);p.type=="Err"?d.push(Fe(t)):d.push(p.value)}return Array.prototype.findIndex.call(d,l,c)};if(typeof s=="string"){let l=typeof s=="string"?Number.parseInt(s):void 0;if(Number.isNaN(l)&&(l=void 0),l!=null&&0<=l&&l<i.length){if(t.type=="Object")return Qt(i[l],d=>e(f=>d(f[s])),t);if(t.type=="Array")return Mr(i[l],d=>e(f=>d(f[s])),t);let c=Te(t,i[l]);return c.type=="Err"?Fe(t):c.value}}return Reflect.get(a,s,u)},set(a,s,u,l){if(typeof s=="symbol")return a[s]=u,!0;if(s==="length"){let d=u-i.length;if(d>0){let f=Array(d).fill(void 0).map(p=>Fe(t));e(p=>p.push(...f))}else d<0&&e(f=>f.splice(i.length+d,-d));return!0}if(typeof s=="string"){let c=typeof s=="string"?Number.parseInt(s):void 0;if(Number.isNaN(c)&&(c=void 0),c!=null){let d=Ne(t,u);return e(f=>f[s]=d),!0}}return Reflect.set(a,s,u,l)}});return Gn.set(i,o),o}let Vn=new WeakMap,Gn=new WeakMap;class J{typeName;typeSchema;constructor(e){this.typeName=e.typeName,this.typeSchema=e.typeSchema}create(e){let[r,t]=Ce(e);return new Lt({type:this,state:r,setState:t})}createJsonProjectionV3(e,r){let t=Qt(e,r,this.typeSchema),[n,o]=oe(()=>Ce(t));return de(new Lt({type:this,state:t,setState:o}))}createJsonProjectionV2(e,r){let t=Jr(this.typeSchema,e,r);if(t.type=="Err")return je(t.message);let n=t.value,[o,a]=oe(()=>Ce(n));return de(new Lt({type:this,state:o,setState:a}))}createJsonProjection(e,r){let t=S(()=>Te(this.typeSchema,e())),n=S(()=>{let s=t();return s.type=="Err"?s:de(t)},void 0,{equals:(s,u)=>s.type=="Ok"&&u.type=="Ok"?s.value==u.value:!1}),o=S(()=>{let s=n();return s.type=="Err"?s:de(S(()=>s.value().value))}),a=S(()=>{let s=o();if(s.type=="Err")return s;let u=s.value;return de(S(()=>{let[l,c]=Ce(oe(u));ae(ne(u,f=>c(f),{defer:!0}));let d=S(()=>{let f=Ne(this.typeSchema,l);return{json:f,jsonString:JSON.stringify(f)}},void 0,{equals:(f,p)=>f.jsonString==p.jsonString});return ae(ne(()=>d().json,f=>{r(f)},{defer:!0})),new Lt({type:this,state:l,setState:c})}))});return S(()=>{let s=a();return s.type=="Err"?s:de(s.value())})}}class Lt{type;state;setState;constructor(e){this.type=e.type,this.state=e.state,this.setState=e.setState}}const mc=q({childIds:Q(Ye())}),$t=new J({typeName:"Children",typeSchema:mc}),gc=q({parentId:Ye()}),Et=new J({typeName:"Parent",typeSchema:gc}),yc=q({orderIndex:Le()}),bc=new J({typeName:"SortOrderIndex",typeSchema:yc});class Xr{componentTypes;componentTypeMap;constructor(e){this.componentTypes=e,this.componentTypeMap=new Map(e.map(r=>[r.typeName,r]))}}const Eo=new Xr([$t,Et,bc]);class U{x;y;constructor(e,r){this.x=e,this.y=r}static create(e,r){return new U(e,r)}static zero=U.create(0,0);static unitX=U.create(1,0);static unitY=U.create(0,1);add(e){return U.create(this.x+e.x,this.y+e.y)}sub(e){return U.create(this.x-e.x,this.y-e.y)}multScalar(e){return U.create(this.x*e,this.y*e)}cross(e){return this.x*e.y-this.y*e.x}distanceSquared(e){let r=e.x-this.x,t=e.y-this.y;return r*r+t*t}distance(e){return Math.sqrt(this.distanceSquared(e))}lengthSquared(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.lengthSquared())}normalize(){return this.multScalar(1/this.length())}}class pe{x;y;static rot0=new pe(1,0);constructor(e,r){this.x=e,this.y=r}static xy(e){return new pe(e.x,e.y)}static fromAngle(e){let r=e*Math.PI/180;return new pe(Math.cos(r),Math.sin(r))}get u(){return U.create(this.x,this.y)}get v(){return U.create(-this.y,this.x)}getLengthSquared(){return this.x*this.x+this.y*this.y}getLength(){return Math.sqrt(this.getLengthSquared())}normalize(){let e=this.getLength();return new pe(this.x/e,this.y/e)}times(e){let r=this;return new pe(r.x*e.x-r.y*e.y,r.x*e.y+r.y*e.x)}conjugate(){return new pe(this.x,-this.y)}rotate(e){let r=this.x,t=this.y,n=-t,o=r;return U.create(e.x*r+e.y*n,e.x*t+e.y*o)}getAngle(){return(e=>e*180/Math.PI)(Math.atan2(this.y,this.x))}}class fe{origin;orientation;static identity=new fe(U.zero,pe.rot0);constructor(e,r){this.origin=e,this.orientation=r}static create(e,r){return new fe(e,r)}get u(){return this.orientation.u}get v(){return this.orientation.v}pointFromSpace(e){return this.orientation.rotate(e).add(this.origin)}pointToSpace(e){return this.orientation.conjugate().rotate(e.sub(this.origin))}vectorFromSpace(e){return this.orientation.rotate(e)}vectorToSpace(e){return this.orientation.conjugate().rotate(e)}transformFromSpace(e){return fe.create(this.pointFromSpace(e.origin),e.orientation.times(this.orientation))}transformToSpace(e){return fe.create(this.pointToSpace(e.origin),this.orientation.conjugate().times(e.orientation))}}function vc(i){let e=new ct,r=S(()=>{let t=[];for(let[n,o]of e.entries())t.push({id:n,pos:o});return t.sort((n,o)=>n.id-o.id),t});{let t=S(()=>r().length==1);ae(()=>{if((i.disableOneFingerPan?.()??!1)||!t())return;let n=S(()=>r()[0].pos),o=oe(()=>i.pan()),a=oe(()=>i.scale()),s=oe(()=>n()),u=1/a;Number.isFinite(u)&&ae(ne(n,l=>{i.setPan(o.sub(l.sub(s).multScalar(u)))},{defer:!0}))})}{let t=S(()=>r().length==2);ae(()=>{if(!t())return;let n=S(()=>r()[0].pos),o=S(()=>r()[1].pos),a=S(()=>n().add(o()).multScalar(.5)),s=S(()=>n().distance(o())),u=oe(()=>i.pan()),l=oe(()=>i.scale()),c=oe(()=>a()),d=oe(()=>s()),f=oe(()=>c.multScalar(1/l).add(u));!Number.isFinite(f.x)||!Number.isFinite(f.y)||ae(ne([a,s],([p,g])=>{let h=l*g/d,y=f.sub(p.multScalar(1/h));Oe(()=>{Number.isFinite(h)&&Number.isFinite(y.x)&&Number.isFinite(y.y)&&(i.setPan(y),i.setScale(h))})},{defer:!0}))})}return{onPointerDown(t){let n,o;if(t.currentTarget instanceof Element){let a=t.currentTarget.getBoundingClientRect();n=a.left,o=a.top}else n=0,o=0;e.set(t.pointerId,U.create(t.clientX-n,t.clientY-o))},onPointerUp(t){e.delete(t.pointerId),i.releasePointerCapture(t.pointerId)},onPointerCancel(t){e.delete(t.pointerId),i.releasePointerCapture(t.pointerId)},onPointerMove(t){if(!e.has(t.pointerId))return;let n,o;if(t.currentTarget instanceof Element){let a=t.currentTarget.getBoundingClientRect();n=a.left,o=a.top}else n=0,o=0;e.set(t.pointerId,U.create(t.clientX-n,t.clientY-o))},onWheel(t){let n,o;if(t.currentTarget instanceof Element){let c=t.currentTarget.getBoundingClientRect();n=c.left,o=c.top}else n=0,o=0;let a=U.create(t.clientX-n,t.clientY-o),s=i.scale(),u=i.scale();if(t.deltaY<0)u*=1.1;else if(t.deltaY>0)u/=1.1;else return;let l=i.pan().add(a.multScalar(1/s-1/u));Oe(()=>{i.setPan(l),i.setScale(u)})},numTouches:S(()=>r().length)}}class kc{canUndo;canRedo;undoDisplayName;redoDisplayName;undo;redo;pushUndoUnit;clear;constructor(){let e=[],r=-1,[t,n]=Y(!1),[o,a]=Y(!1),[s,u]=Y(),[l,c]=Y(),d=()=>{Oe(()=>{if(n(()=>r!=-1),a(()=>r<e.length-1),r!=-1){let h=e[r];u(h.displayName)}else u(void 0);if(r<e.length-1){let h=e[r+1];c(h.displayName)}else c(void 0)})},f=()=>{if(r==-1)return;e[r].run(!0),--r,d()},p=()=>{if(r>=e.length-1)return;++r,e[r].run(!1),d()},g=h=>{r<e.length-1&&e.splice(r+1,e.length-1-r),++r,e.push(h),d()};this.clear=()=>{e.splice(0,e.length),r=-1,d()},this.canUndo=t,this.canRedo=o,this.undoDisplayName=s,this.redoDisplayName=l,this.undo=f,this.redo=p,this.pushUndoUnit=g}}function Io(i){return i==null?[]:[i]}function wc(i,e){let r,t=()=>{},n=0;return()=>{if(Lr()==null)return r!=null?r():i();if(r==null){let{cache:o,dispose:a}=et(s=>({cache:S(i),dispose:s}));r=o,t=a,n=1}else++n;return ye(()=>{--n==0&&(t(),t=()=>{},e?.(),r=void 0)}),r()}}class er{value;constructor(e){this.value=e}}function xc(i){for(var e="",r=i.byteLength,t=0;t<r;t++)e+=String.fromCharCode(i[t]);return window.btoa(e)}function Sc(i){for(var e=atob(i),r=new Uint8Array(e.length),t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}class dt{entityMap;componentTypeEntitiesMap;componentTypeEntitiesMap_=new Map;constructor(){this.entityMap=new ct,this.componentTypeEntitiesMap=new ct}entities(){return Array.from(this.entityMap.keys())}entitiesWithComponentType(e){{let t=this.componentTypeEntitiesMap_.get(e.typeName);if(t!=null)return t()}let r=wc(()=>{let t=this.componentTypeEntitiesMap.get(e.typeName);if(t==null)return[];let n=[];for(let o of t)n.push(o);return n},()=>{this.componentTypeEntitiesMap_.delete(e.typeName)});return this.componentTypeEntitiesMap_.set(e.typeName,r),r()}createEntityWithId(e,r){oe(()=>Oe(()=>{this.entityMap.set(e,new ct(r.map(t=>[t.type.typeName,t])));for(let t of r){let n=this.componentTypeEntitiesMap.get(t.type.typeName);n==null&&(n=new We,this.componentTypeEntitiesMap.set(t.type.typeName,n)),n.add(e)}}))}createEntity(e){let r=st();return this.createEntityWithId(r,e),r}destroyEntity(e){oe(()=>Oe(()=>{let r=this.entityMap.get(e);if(r!=null)for(let t of r.values()){let n=this.componentTypeEntitiesMap.get(t.type.typeName);n?.delete(e)}this.entityMap.delete(e)}))}attachToParent(e,r){oe(()=>{this.getComponent(e,Et)?.state?.parentId!=null&&this.detactFromParent(e);let t=this.getComponent(r,$t);t==null?(t=$t.create({childIds:[e]}),this.setComponent(r,t)):t.setState("childIds",_t(n=>n.push(e))),this.setComponent(e,Et.create({parentId:r}))})}detactFromParent(e){oe(()=>{let r=this.getComponent(e,Et);if(r!=null){this.unsetComponent(e,Et);let t=r.state.parentId,n=this.getComponent(t,$t);if(n!=null){let o=n.state.childIds.filter(a=>a!==e);o.length==0?this.unsetComponent(t,$t):n.setState("childIds",o)}}})}getComponent(e,r){let t=this.entityMap.get(e);if(t!=null)return t.get(r.typeName)}getComponents(e){return Array.from(this.entityMap.get(e)?.values()??[])}setComponent(e,r){this.setComponents(e,[r])}setComponents(e,r){let t=this.entityMap.get(e);if(t!=null)for(let n of r)t.set(n.type.typeName,n)}unsetComponent(e,r){let t=this.entityMap.get(e);t?.delete(r.typeName)}unsetComponents(e,r){let t=this.entityMap.get(e);if(t!=null)for(let n of r)t.delete(n.typeName)}toJson(){let e={};for(let r of this.entities()){let t={};for(let n of this.getComponents(r))t[n.type.typeName]=Ne(n.type.typeSchema,n.state);e[r]=t}return e}static fromJson(e,r){let t=new dt;for(let n of Object.keys(r)){let o=r[n],a=Object.keys(o),s=[];for(let u of a){let l=e.componentTypeMap.get(u);if(l==null)return je(`${u} not found`);let c=Te(l.typeSchema,o[u]);if(c.type=="Err")return c;let d=c.value,f=l.create(d);s.push(f)}t.createEntityWithId(n,s)}return de(t)}}const Cc=Yr(i=>U.create(i.x,i.y),i=>({x:i.x,y:i.y}),q({x:Le(),y:Le()})),Pc=Yr(i=>new pe(i.x,i.y),i=>({x:i.x,y:i.y}),q({x:Le(),y:Le()})),_c=Yr(({origin:i,orientation:e})=>fe.create(i,e),i=>({origin:i.origin,orientation:i.orientation}),q({origin:Cc,orientation:Pc})),Tc=q({transform:_c}),we=new J({typeName:"Transform2D",typeSchema:Tc});class Ro{nodeTypes=[];noteTypeNameToNodeTypeMap=new Map;registerNodeType(e){this.nodeTypes.push(e),this.noteTypeNameToNodeTypeMap.set(e.componentType.typeName,e)}registerNodeTypes(e){for(let r of e)this.registerNodeType(r)}lookupNodeType(e){return this.noteTypeNameToNodeTypeMap.get(e)}}const E=q({target:Ye(),pin:Ye()});var $c=B("<svg><path fill=none stroke=blue stroke-width=2 vector-effect=non-scaling-stroke></svg>",!1,!0),Ec=B("<svg><g><rect x=0 stroke=black rx=5 ry=5></rect><text style=user-select:none;></svg>",!1,!0),Ic=B("<svg><foreignObject x=5></svg>",!1,!0),Wn=B("<svg><circle r=1></svg>",!1,!0),Hn=B("<svg><text></svg>",!1,!0);class Ar{Render;constructor(e){this.Render=()=>[I(qe,{get each(){return e.nodes()},children:r=>I(Mc,{node:r,get isHighlighted(){return e.highlightedEntitySet.has(r.node.nodeParams.entity)},get isSelected(){return e.selectedEntitySet.has(r.node.nodeParams.entity)}})}),I(qe,{get each(){return e.nodes()},children:r=>I(qe,{get each(){return r.node.inputPins?.()??[]},children:t=>I(ie,{get when(){return t.source()},children:n=>{let o=S(()=>e.lookupNodeById(n().target)),a=S(()=>{let u=o();if(u==null)return;let l=u.outputPinPositionMap()?.get(n().pin);if(l!=null)return u.space().pointFromSpace(l)}),s=S(()=>{let u=r.inputPinPositionMap()?.get(t.name);if(u!=null)return r.space().pointFromSpace(u)});return I(ie,{get when(){return a()},children:u=>I(ie,{get when(){return s()},children:l=>{let c=S(()=>Mo(u().x,-u().y,l().x,-l().y,0));return(()=>{var d=$c();return Z(()=>K(d,"d",c())),d})()}})})}})})})]}}let br=(()=>{let i=new Map;return e=>{let r=i.get(e);if(r!=null)return r;let{svg:t,dispose:n}=et(u=>({svg:Nc(),dispose:u})),o=document.createElementNS("http://www.w3.org/2000/svg","text"),a=document.createTextNode(e);o.appendChild(a),t.appendChild(o);let s=o.getBBox();return n(),r=U.create(s.width,s.height),i.set(e,r),r}})(),Rc=(()=>{let i=new Map;return(e,r)=>{let t=i.get(e);return t!=null||(t=r(),i.set(e,t)),t}})();function Mc(i){let e=S(()=>br(i.node.node.type.componentType.typeName)),r=S(tt(()=>i.node.node.inputPins?.()??[],v=>{let k=br(v.name);return{name:v.name,size:k}})),t=S(tt(()=>i.node.node.outputPins?.()??[],v=>{let k=br(v.name);return{name:v.name,size:k}})),n=S(()=>{let v=i.node.node.ui?.();if(v!=null)return Rc(i.node.node.type.componentType.typeName,()=>{let k=Ac(),x=document.createElement("div");x.style.setProperty("display","inline-block"),k.append(x);let w=xi(()=>I(v,{}),x),C=x.getBoundingClientRect();return w(),U.create(C.width,C.height)})});const o=5,a=5,s=S(()=>{let v=0;for(let k of r())v+=k.size.y;return v}),u=S(()=>{let v=0;for(let k of t())v+=k.size.y;return v});let l=S(()=>{let v=0;for(let k of r())v=Math.max(v,k.size.x);return v}),c=S(()=>{let v=0;for(let k of t())v=Math.max(v,k.size.x);return v}),d=S(()=>e().y+Math.max(s(),u())+(n()?.y??0)+2*o),f=S(()=>Math.max(e().x,l()+c()+4*a,n()?.x??0)+2*o),p=S(()=>U.create(f(),d())),g=S(()=>{let v={},k=d()-e().y;for(let x of r())k-=x.size.y,v[x.name]={dotPos:U.create(a,k+.28*x.size.y),textPos:U.create(2*a,k)};return v}),h=S(()=>{let v={},k=d()-e().y;for(let x of t())k-=x.size.y,v[x.name]={dotPos:U.create(f()-a,k+.28*x.size.y),textPos:U.create(f()-2*a-x.size.x,k)};return v}),y=S(()=>{let v=new Map;for(let[k,{dotPos:x}]of Object.entries(g()))v.set(k,x);return v}),m=S(()=>{let v=new Map;for(let[k,{dotPos:x}]of Object.entries(h()))v.set(k,x);return v});Ur(()=>{i.node.setRenderSizeAccessor(p),i.node.setInputPinPositionMapAccessor(y),i.node.setOutputPinPositionMapAccessor(m)});let b=S(()=>{let v=i.node.space(),k=v.origin,x=v.u,w=k.x,C=-k.y,P=x.x,T=-x.y,$=-T;return`matrix(${P} ${$} ${T} ${P} ${w} ${C})`});return(()=>{var v=Ec(),k=v.firstChild,x=k.nextSibling;return W(v,I(ie,{get when(){return n()},children:w=>I(ie,{get when(){return i.node.node.ui?.()},keyed:!0,children:C=>(()=>{var P=Ic();return W(P,I(C,{})),Z(T=>{var $=-w().y-o,_=w().x,M=w().y;return $!==T.e&&K(P,"y",T.e=$),_!==T.t&&K(P,"width",T.t=_),M!==T.a&&K(P,"height",T.a=M),T},{e:void 0,t:void 0,a:void 0}),P})()})}),x),W(x,()=>i.node.node.type.componentType.typeName),W(v,I(qe,{get each(){return i.node.node.inputPins?.()??[]},children:w=>{let C=S(()=>g()[w.name]),P=w.isEffectPin??!1;return I(ie,{get when(){return C()},children:T=>[(()=>{var $=Wn();return K($,"fill",P?"purple":"black"),Z(_=>{var M=T().dotPos.x,L=-T().dotPos.y;return M!==_.e&&K($,"cx",_.e=M),L!==_.t&&K($,"cy",_.t=L),_},{e:void 0,t:void 0}),$})(),(()=>{var $=Hn();return K($,"font-weight",P?"bold":"normal"),K($,"fill",P?"purple":"black"),W($,()=>w.name),Z(_=>{var M=T().textPos.x,L=-T().textPos.y;return M!==_.e&&K($,"x",_.e=M),L!==_.t&&K($,"y",_.t=L),_},{e:void 0,t:void 0}),$})()]})}}),null),W(v,I(qe,{get each(){return i.node.node.outputPins?.()??[]},children:w=>{let C=S(()=>h()[w.name]),P=w.isEffectPin??!1;return I(ie,{get when(){return C()},children:T=>[(()=>{var $=Wn();return K($,"fill",P?"purple":"black"),Z(_=>{var M=T().dotPos.x,L=-T().dotPos.y;return M!==_.e&&K($,"cx",_.e=M),L!==_.t&&K($,"cy",_.t=L),_},{e:void 0,t:void 0}),$})(),(()=>{var $=Hn();return K($,"font-weight",P?"bold":"normal"),K($,"fill",P?"purple":"black"),W($,()=>w.name),Z(_=>{var M=T().textPos.x,L=-T().textPos.y;return M!==_.e&&K($,"x",_.e=M),L!==_.t&&K($,"y",_.t=L),_},{e:void 0,t:void 0}),$})()]})}}),null),Z(w=>{var C=b(),P=-d(),T=f(),$=d(),_=i.isSelected?"green":i.isHighlighted?"blue":"white",M=.5*(f()-e().x),L=-d()+e().y;return C!==w.e&&K(v,"transform",w.e=C),P!==w.t&&K(k,"y",w.t=P),T!==w.a&&K(k,"width",w.a=T),$!==w.o&&K(k,"height",w.o=$),_!==w.i&&K(k,"fill",w.i=_),M!==w.n&&K(x,"x",w.n=M),L!==w.s&&K(x,"y",w.s=L),w},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),v})()}const Ac=(()=>{let i=0,e;return()=>(e!=null?++i:(e=document.createElement("div"),e.style.setProperty("position","absolute"),e.style.setProperty("left","-1000px"),e.style.setProperty("top","-1000px"),e.style.setProperty("width","500px"),e.style.setProperty("height","500px"),document.body.append(e),i=1),ye(()=>{--i,i==0&&window.queueMicrotask(()=>{i==0&&e!=null&&(document.body.removeChild(e),e=void 0)})}),e)})(),Nc=(()=>{let i=0,e;return()=>(e!=null?++i:(e=document.createElementNS("http://www.w3.org/2000/svg","svg"),e.style.setProperty("position","absolute"),e.style.setProperty("left","-1000px"),e.style.setProperty("top","-1000px"),document.body.append(e),i=1),ye(()=>{--i,i==0&&window.queueMicrotask(()=>{i==0&&e!=null&&(document.body.removeChild(e),e=void 0)})}),e)})();function Mo(i,e,r,t,n=.5){const o=(i+r)/2,a=(e+t)/2;let s,u,l,c;return s=i+(o-i)*(1-n),u=e+(a-e)*n,l=r-(r-o)*(1-n),c=t-(t-a)*n,`M ${i} ${e} C ${s} ${u}, ${l} ${c}, ${r} ${t}`}var Oc=B("<svg><path fill=none stroke-width=2 pointer-events=none vector-effect=non-scaling-stroke></svg>",!1,!0);class Fc{overlaySvg;dragEnd;disablePan=()=>!0;constructor(e){let r=e.modeParams,t=S(()=>r.nodesSystem.lookupNodeById(e.fromNodeId)),n=S(()=>{let s=t();if(s==null)return;let u=s.outputPinPositionMap()?.get(e.fromPin.name);if(u!=null)return s.space().pointFromSpace(u)}),o=S(()=>{let s=r.mousePos();if(s!=null)return r.screenPtToWorldPt(s)}),a=S(()=>{let s=r.pickingSystem.nodeUnderMouseById();if(s==null)return;let u=r.nodesSystem.lookupNodeById(s);if(u==null)return;let l=r.pickingSystem.pinUnderMouse();if(l?.type=="Input")return{nodeId:s,node:u,pin:l}});this.overlaySvg=()=>I(ie,{get when(){return n()},children:s=>I(ie,{get when(){return o()},children:u=>{let l=S(()=>Mo(s().x,-s().y,u().x,-u().y,0)),c=S(()=>a()!=null);return(()=>{var d=Oc();return Z(f=>{var p=l(),g=c()?"blue":"red";return p!==f.e&&K(d,"d",f.e=p),g!==f.t&&K(d,"stroke",f.t=g),f},{e:void 0,t:void 0}),d})()}})}),this.dragEnd=()=>{let s=a();if(s!=null){let u=t();if(u!=null){let l=u.node.outputPins?.()??[],c;for(let d of l)if(d.name==e.fromPin.name){c=d;break}if(c!=null){let d=s.node.node.inputPins?.()??[];for(let f of d)if(f.name==s.pin.name){{let p={target:s.nodeId,pin:s.pin.name},g=!1;for(let h of c.sinks())if(h.target==p.target&&h.pin==p.pin){g=!0;break}g||c.setSinks([...c.sinks(),p])}{let p={target:e.fromNodeId,pin:e.fromPin.name};f.setSource(p)}}}}}r.onDone()}}}var Dc=B("<svg><circle fill=blue pointer-events=none></svg>",!1,!0);class Kn{overlaySvg;click;dragStart;dragEnd;highlightedObjectsById;selectedObjectsById;disablePan;constructor(e){let[r,t]=Ce({dragging:void 0}),n=new We,o=S(()=>Array.from(n)),a=()=>e.pickingSystem.nodeUnderMouseById(),s=()=>e.pickingSystem.pinUnderMouse();xe(()=>{if(r.dragging==null)return;let l=r.dragging.value,c=e.mousePos();if(c==null)return;let d=e.screenPtToWorldPt(c);if(d==null)return;let f=e.nodesSystem.lookupNodeById(l.nodeId);f?.setSpace(fe.create(d.sub(l.pickupOffset),pe.rot0))}),this.overlaySvg=()=>I(ie,{get when(){return s()},children:l=>I(ie,{get when(){return e.nodesSystem.lookupNodeById(l().nodeId)},keyed:!0,children:c=>{let d=S(()=>{let f=l(),p;if(f.type=="Input"){let g=c.inputPinPositionMap()?.get(f.name);if(g==null)return;p=g}else if(f.type=="Output"){let g=c.outputPinPositionMap()?.get(f.name);if(g==null)return;p=g}else return;return c.space().pointFromSpace(p)});return I(ie,{get when(){return d()},children:f=>(()=>{var p=Dc();return Z(g=>{var h=f().x,y=-f().y,m=5/e.scale();return h!==g.e&&K(p,"cx",g.e=h),y!==g.t&&K(p,"cy",g.t=y),m!==g.a&&K(p,"r",g.a=m),g},{e:void 0,t:void 0,a:void 0}),p})()})}})}),this.click=()=>{let l=a();n.clear(),l!=null&&n.add(l)},this.dragStart=()=>{let l=e.mousePos();if(l==null)return;let c=e.screenPtToWorldPt(l);if(c==null)return;{let g=s();if(g!=null&&g.type=="Output"){let h={type:"Output",name:g.name};e.setMode(()=>new Fc({modeParams:e,fromNodeId:g.nodeId,fromPin:h}));return}}if(e.nodesSystem.disablePan())return;let d=a();if(d==null||!n.has(d))return;let f=e.nodesSystem.lookupNodeById(d);if(f==null)return;let p=f.space().pointToSpace(c);t("dragging",new er({nodeId:d,pickupOffset:p}))},this.dragEnd=()=>{t("dragging",void 0)};const u=[];this.highlightedObjectsById=S(()=>s()!=null?u:Io(a())),this.selectedObjectsById=o,this.disablePan=S(()=>s()!=null||r.dragging!=null)}}class Nr{nodes;lookupNodeById;disablePan;constructor(e){let r=e.nodeRegistry,t=S(tt(()=>e.world().entities(),u=>{let l=S(()=>{for(let c of e.world().getComponents(u)){let d=r.lookupNodeType(c.type.typeName);if(d!=null)return{nodeType:d,nodeComponent:c}}});return S(()=>{let c=l();if(c==null)return;let{nodeType:d,nodeComponent:f}=c,p=f,g=d.create({entity:u,state:p.state,setState:p.setState}),h=S(()=>e.world().getComponent(u,we)?.state.transform??fe.identity),y=P=>oe(()=>{let T=e.world().getComponent(u,we);T==null?(T=we.create({transform:P}),e.world().setComponents(u,[T])):T.setState("transform",P)}),[m,b]=Y(),[v,k]=Y(),[x,w]=Y();return{node:g,space:h,setSpace:y,setRenderSizeAccessor:P=>b(()=>P),setInputPinPositionMapAccessor:P=>k(()=>P),setOutputPinPositionMapAccessor:P=>w(()=>P),renderSize:()=>m()?.(),inputPinPositionMap:()=>v()?.(),outputPinPositionMap:()=>x()?.()}})})),n=S(()=>t().flatMap(u=>Io(u()))),o=new ct,a=S(()=>{tt(n,u=>{let l=u.node.nodeParams.entity;o.set(l,u),ye(()=>{o.delete(l)})})()}),s=u=>(a(),o.get(u));this.nodes=n,this.lookupNodeById=s,this.disablePan=S(()=>{for(let u of n())if(u.node.disablePan?.()??!1)return!0;return!1})}}const Yn=20,Jn=Yn*Yn;class Ao{nodeUnderMouseById;pinUnderMouse;constructor(e){let r=S(()=>{let o=e.mousePos();if(o==null)return;let a=e.screenPtToWorldPt(o);if(a!=null)for(let s of e.nodes()){let u=s.renderSize();if(u==null)continue;let l=s.space().pointToSpace(a);if(!(l.x<0||l.y<0||l.x>u.x||l.y>u.y))return s}}),t=()=>r()?.node.nodeParams.entity,n=S(()=>{let o=e.mousePos();if(o==null)return;let a,s;for(let u of e.nodes()){let l=u.inputPinPositionMap();if(l!=null)for(let[d,f]of l.entries()){let p=u.space().pointFromSpace(f),g=e.worldPtToScreenPt(p);if(g==null)continue;let h=g.distanceSquared(o);h>Jn||(s==null||h<s)&&(a={type:"Input",nodeId:u.node.nodeParams.entity,name:d},s=h)}let c=u.outputPinPositionMap();if(c!=null)for(let[d,f]of c.entries()){let p=u.space().pointFromSpace(f),g=e.worldPtToScreenPt(p);if(g==null)continue;let h=g.distanceSquared(o);h>Jn||(s==null||h<s)&&(a={type:"Output",nodeId:u.node.nodeParams.entity,name:d},s=h)}}return a});this.nodeUnderMouseById=t,this.pinUnderMouse=n}}var jc=B('<button class="btn btn-primary">End Mode'),Lc=B("<div>"),zc=B("<svg>"),Uc=B("<div><svg><g>");class Bc{instructions;overlayHtmlUi;sideForm;constructor(e){let[r,t]=Ce({pan:U.zero,scale:1,formMousePos:void 0,dragging:void 0}),n=new dt,o=0;for(let w of e.nodeRegistry.nodeTypes)o-=80,n.createEntity([w.componentType.create(Fe(w.componentType.typeSchema)),we.create({transform:fe.create(U.create(0,o),pe.rot0)})]);let a=w=>U.create(r.pan.x+w.x/r.scale,-(r.pan.y+w.y/r.scale)),s=w=>U.create((w.x-r.pan.x)*r.scale,(-w.y-r.pan.y)*r.scale),u=new Nr({nodeRegistry:e.nodeRegistry,world:()=>n}),l=new Ao({mousePos:()=>r.formMousePos,screenPtToWorldPt:a,worldPtToScreenPt:s,nodes:()=>u.nodes()}),c=()=>l.nodeUnderMouseById(),d=new We,f=new We;ae(()=>{let w=c();w==null?d.clear():(d.clear(),d.add(w))});let p=new Ar({nodes:()=>u.nodes(),lookupNodeById:w=>u.lookupNodeById(w),highlightedEntitySet:d,selectedEntitySet:f}),g=S(()=>{let w={},C=0;for(let P of u.nodes()){let T=P.renderSize();if(T==null)return;C-=T.y,w[P.node.nodeParams.entity]=U.create(0,C)}return w}),h=S(()=>{let w=g();if(w==null)return 0;let C=0;for(let P of Object.values(w))C=Math.min(C,P.y);return Math.abs(C)});ae(()=>{let w=g();if(w!=null)for(let C of n.entities())oe(()=>{let P=w[C];if(P==null)return;let T=n.getComponent(C,we);T?.setState("transform",fe.create(P,pe.rot0))})});let[y,m]=Y(),b,v=w=>{{let C=b.getBoundingClientRect();t("formMousePos",U.create(w.clientX-C.left,w.clientY-C.top))}b.setPointerCapture(w.pointerId),queueMicrotask(()=>{let C=r.formMousePos;if(C==null)return;let P=c();if(P==null)return;let T=u.lookupNodeById(P);if(T==null)return;let $=T.space().origin,_=a(C);_!=null&&t("dragging",new er({nodeType:T.node.type,nodeSize:T.renderSize()??U.create(100,50),pickupOffset:_.sub($)}))})},k=w=>{b.releasePointerCapture(w.pointerId);let C=y();if(r.formMousePos!=null&&r.dragging!=null&&C!=null){let P=r.formMousePos,T=b.getBoundingClientRect(),$=C.getBoundingClientRect(),_=r.dragging.value.pickupOffset,M=U.create(T.left-$.left+P.x-_.x,T.top-$.top+P.y+_.y),L=e.screenPtToWorldPt(M);if(L==null)return;e.world().createEntity([r.dragging.value.nodeType.componentType.create(Fe(r.dragging.value.nodeType.componentType.typeSchema)),we.create({transform:fe.create(L,pe.rot0)})]),t("dragging",void 0)}},x=w=>{let C=b.getBoundingClientRect();t("formMousePos",U.create(w.clientX-C.left,w.clientY-C.top))};this.instructions=()=>(()=>{var w=jc();return w.$$click=()=>{e.onDone()},w})(),this.overlayHtmlUi=()=>I(ie,{get when(){return r.dragging?.value},children:w=>I(ie,{get when(){return r.formMousePos},children:C=>{let[P,T]=Y(!0);ye(()=>{m(void 0)}),Ur(()=>T(!1));let $=S(()=>{if(P())return;let R=y();if(R==null)return;let F=b.getBoundingClientRect(),V=R.getBoundingClientRect();return C().add(U.create(F.left-V.left-w().pickupOffset.x,F.top-V.top-w().nodeSize.y+w().pickupOffset.y))}),_=new dt,M=_.createEntity([oe(()=>w().nodeType.componentType.create(Fe(w().nodeType.componentType.typeSchema))),we.create({transform:fe.create(U.create(0,oe(()=>-w().nodeSize.y)),pe.rot0)})]),L=new Nr({nodeRegistry:e.nodeRegistry,world:()=>_}),O=new Ar({nodes:()=>L.nodes(),lookupNodeById:R=>L.lookupNodeById(R),highlightedEntitySet:new We([M]),selectedEntitySet:new We});return(()=>{var R=Lc(),F=m;return typeof F=="function"?he(F,R):m=R,R.style.setProperty("position","absolute"),R.style.setProperty("left","0"),R.style.setProperty("top","0"),R.style.setProperty("right","0"),R.style.setProperty("bottom","0"),R.style.setProperty("pointer-events","none"),W(R,I(ie,{get when(){return $()},children:V=>(()=>{var j=zc();return j.style.setProperty("position","absolute"),j.style.setProperty("touch-action","none"),j.style.setProperty("user-select","none"),W(j,I(O.Render,{})),Z(G=>{var H=`${V().x}px`,te=`${V().y}px`,A=`${w().nodeSize.x}px`,X=`${w().nodeSize.y}px`;return H!==G.e&&((G.e=H)!=null?j.style.setProperty("left",H):j.style.removeProperty("left")),te!==G.t&&((G.t=te)!=null?j.style.setProperty("top",te):j.style.removeProperty("top")),A!==G.a&&((G.a=A)!=null?j.style.setProperty("width",A):j.style.removeProperty("width")),X!==G.o&&((G.o=X)!=null?j.style.setProperty("height",X):j.style.removeProperty("height")),G},{e:void 0,t:void 0,a:void 0,o:void 0}),j})()})),R})()}})}),this.sideForm=S(()=>()=>(()=>{var w=Uc(),C=w.firstChild,P=C.firstChild;w.style.setProperty("width","150px"),w.style.setProperty("height","100%"),w.style.setProperty("overflow-x","hidden"),w.style.setProperty("overflow-y","auto"),C.$$pointermove=x,C.$$pointerup=k,C.$$pointerdown=v;var T=b;return typeof T=="function"?he(T,C):b=C,C.style.setProperty("width","100%"),C.style.setProperty("touch-action","pan-y"),C.style.setProperty("user-select","none"),W(P,I(p.Render,{})),Z($=>($=`${h()}px`)!=null?C.style.setProperty("height",$):C.style.removeProperty("height")),w})())}}be(["click","pointerdown","pointerup","pointermove"]);var qc=B('<div><div><div><button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-upload"></i></button><input type=file hidden><button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-download"></i></button><button class="btn btn-primary"style=margin-left:5px;>Add Node</button><button class="btn btn-primary"style=margin-left:5px;>Delete</button><label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Freeze Pan/Zoom</label></div><div><svg><g>'),Vc=B("<div>"),Xn=B("<div><div>");function No(i){let[e,r]=Br(i,["onInit","componentRegistry","nodeRegistry","world","toolbar"]),t=e.nodeRegistry,[n,o]=Ce({pan:U.zero,scale:1,mousePos:void 0,mkMode:()=>new Kn(v),showCode:!1,makeSound:!1,freezePanZoom:!1}),a=new kc,s,[u,l]=Y(U.zero);Ur(()=>{{let X=s.getBoundingClientRect();o("pan",U.create(0,-X.height))}let A=new ResizeObserver(()=>{let X=s.getBoundingClientRect();queueMicrotask(()=>{l(U.create(X.width,X.height))})});A.observe(s),ye(()=>{A.unobserve(s),A.disconnect()})});let c=S(()=>`scale(${n.scale}) translate(${-n.pan.x} ${-n.pan.y})`),d=A=>{o("mkMode",()=>A)},f=A=>U.create(n.pan.x+A.x/n.scale,-(n.pan.y+A.y/n.scale)),p=A=>U.create((A.x-n.pan.x)*n.scale,(-A.y-n.pan.y)*n.scale),g=new Nr({nodeRegistry:t,world:()=>e.world}),h=new Ao({mousePos:()=>n.mousePos,screenPtToWorldPt:f,worldPtToScreenPt:p,nodes:()=>g.nodes()}),y=new We,m=new We,b=new Ar({nodes:()=>g.nodes(),lookupNodeById:A=>g.lookupNodeById(A),highlightedEntitySet:y,selectedEntitySet:m}),v={undoManager:a,nodeRegistry:t,nodesSystem:g,pickingSystem:h,mousePos:()=>n.mousePos,screenPtToWorldPt:f,worldPtToScreenPt:p,world:()=>e.world,onDone:()=>{d(()=>new Kn(v))},pan:()=>n.pan,setPan:A=>o("pan",A),scale:()=>n.scale,setScale:A=>o("scale",A),setMode:d},k=S(()=>n.mkMode()),x=vc({pan:()=>n.pan,setPan:A=>o("pan",A),scale:()=>n.scale,setScale:A=>o("scale",A),setPointerCapture:A=>s.setPointerCapture(A),releasePointerCapture:A=>s.releasePointerCapture(A),disableOneFingerPan:S(()=>(k().disablePan?.()??!1)||n.freezePanZoom||g.disablePan())}),w=S(()=>k().highlightedObjectsById?.()??[]),C=S(()=>k().selectedObjectsById?.()??[]);ae(tt(w,A=>{y.add(A),ye(()=>{y.delete(A)})})),ae(tt(C,A=>{m.add(A),ye(()=>{m.delete(A)})}));let P=()=>{k().click?.()},T,$=!1,_=A=>{let X=s.getBoundingClientRect();o("mousePos",U.create(A.clientX-X.left,A.clientY-X.top)),k().dragStart?.(),$=!0,x.onPointerDown(A)},M=A=>{x.onPointerUp(A),x.numTouches()==0&&P(),$&&k().dragEnd?.(),window.clearTimeout(T),T=void 0},L=A=>{x.onPointerCancel(A)},O=A=>{let X=s.getBoundingClientRect();o("mousePos",U.create(A.clientX-X.left,A.clientY-X.top)),x.onPointerMove(A)},R=A=>{x.numTouches()==0&&o("mousePos",void 0)},F=A=>{x.onWheel(A)},V=()=>{for(let A of C())e.world.destroyEntity(A);m.clear()};e.onInit({nodesSystem:g});let[j,G]=Y();const H=async A=>{let X=await A.text().then(le=>JSON.parse(le)),re=dt.fromJson(e.componentRegistry,X);if(re.type=="Err"){alert(re.message);return}let ve=re.value;Oe(()=>{let le=e.world;for(let se of[...le.entities()])le.destroyEntity(se);for(let se of ve.entities()){let Re=ve.getComponents(se);le.createEntityWithId(se,Re)}})},te=()=>{let A=JSON.stringify(e.world.toJson(),void 0,2),X=new Blob([A],{type:"application/json"});Fi.saveAs(X,"node-graph.json")};return(()=>{var A=qc(),X=A.firstChild,re=X.firstChild,ve=re.firstChild,le=ve.nextSibling,se=le.nextSibling,Re=se.nextSibling,De=Re.nextSibling,Ve=De.nextSibling,Xe=Ve.firstChild,Ge=re.nextSibling,me=Ge.firstChild,yt=me.firstChild;jr(A,r,!1,!0),X.style.setProperty("width","100%"),X.style.setProperty("height","100%"),X.style.setProperty("display","flex"),X.style.setProperty("flex-direction","column"),ve.$$click=()=>j()?.click(),le.addEventListener("change",ue=>{let ce=ue.currentTarget.files;if(ce?.length!=1)return;let Ue=ce[0];H(Ue),ue.currentTarget.value=""});var bt=G;typeof bt=="function"?he(bt,le):G=le,se.$$click=()=>te(),Re.$$click=()=>d(()=>new Bc(v)),De.$$click=()=>{V()},W(re,()=>e.toolbar,Ve),Xe.addEventListener("change",ue=>o("freezePanZoom",ue.currentTarget.checked)),Ge.style.setProperty("flex-grow","1"),Ge.style.setProperty("position","relative"),me.$$pointerout=R,me.addEventListener("wheel",F),me.$$pointermove=O,me.addEventListener("pointercancel",L),me.$$pointerup=M,me.$$pointerdown=_;var Pe=s;return typeof Pe=="function"?he(Pe,me):s=me,me.style.setProperty("position","absolute"),me.style.setProperty("left","0"),me.style.setProperty("top","0"),me.style.setProperty("width","100%"),me.style.setProperty("height","100%"),me.style.setProperty("touch-action","none"),me.style.setProperty("user-select","none"),W(yt,I(b.Render,{}),null),W(yt,I(ie,{get when(){return k().overlaySvg},keyed:!0,children:ue=>I(ue,{})}),null),W(Ge,I(ie,{get when(){return k().sideForm?.()==null},get children(){return I(ie,{get when(){return k().instructions},keyed:!0,children:ue=>(()=>{var ce=Vc();return ce.style.setProperty("position","absolute"),ce.style.setProperty("left","0"),ce.style.setProperty("top","0"),W(ce,I(ue,{})),ce})()})}}),null),W(Ge,I(ie,{get when(){return k().sideForm?.()},keyed:!0,children:ue=>(()=>{var ce=Xn(),Ue=ce.firstChild;return ce.style.setProperty("position","absolute"),ce.style.setProperty("left","0"),ce.style.setProperty("top","0"),ce.style.setProperty("height","100%"),ce.style.setProperty("display","flex"),ce.style.setProperty("flex-direction","row"),ce.style.setProperty("pointer-events","none"),Ue.style.setProperty("background","black"),Ue.style.setProperty("pointer-events","auto"),W(Ue,I(ue,{})),W(ce,I(ie,{get when(){return k().instructions},keyed:!0,children:N=>(()=>{var Me=Xn(),Be=Me.firstChild;return Be.style.setProperty("pointer-events","auto"),W(Be,I(N,{})),Me})()}),null),ce})()}),null),W(Ge,I(ie,{get when(){return k().overlayHtmlUi},keyed:!0,children:ue=>I(ue,{})}),null),Z(ue=>{var ce=m.size==0,Ue=c();return ce!==ue.e&&(De.disabled=ue.e=ce),Ue!==ue.t&&K(yt,"transform",ue.t=Ue),ue},{e:void 0,t:void 0}),Z(()=>Xe.checked=n.freezePanZoom),A})()}be(["click","pointerdown","pointerup","pointermove","pointerout"]);const Gc=q({frequency:D(E),amplitude:D(E),centre:D(E),out:Q(E)}),Zr=new J({typeName:"SineWave",typeSchema:Gc});let Wc=class{nextFieldIdx=0;fieldDeclarations="";constructorCode="";messageHandlers=new Map;globalCode="";code_="";postCode="";allocField(e){let r=`x${this.nextFieldIdx++}`;return this.fieldDeclarations+=`  ${r} = ${e};\r
`,`this.${r}`}allocFieldNoDecl(){return`this.${`x${this.nextFieldIdx++}`}`}addDeclToExistingForField(e,r){e.startsWith("this.")&&(e=e.substring(5)),this.fieldDeclarations+=`  ${e} = ${r};\r
`}insertConstructorCode(e){this.constructorCode+=e.map(r=>`      ${r}\r
`).join("")}insertMessageHandlerCode(e,r){this.messageHandlers.get(e);let t=r.map(n=>`        ${n}\r
`).join("");this.messageHandlers.set(e,t)}insertGlobalCode(e){this.globalCode+=e.map(r=>`${r}\r
`).join("")}insertCode(e){this.code_+=e.map(r=>`      ${r}\r
`).join("")}insertPostCode(e){this.postCode+=e.map(r=>`      ${r}\r
`).join("")}get code(){let e="";return this.messageHandlers.size!=0?e=[`    this.port.onmessage = (e) => {\r
`,`      let data = e.data;\r
`,...this.messageHandlers.entries().map(([r,t],n)=>{let o,a=n==this.messageHandlers.size-1;return n==0?o="      if":o="      } else if",`${o} (data.type == "${r}") {\r
        let params = data.params;\r
${t}${a?`      }\r
`:""}`}),`    };\r
`].join(""):e="",[this.globalCode,"class CompiledGraphAudioWorkletProcessor extends AudioWorkletProcessor {","  runningEffectsHead = null;","  runningEffectsTail = null;","  variables = {};",this.fieldDeclarations,"  constructor(options) {","    super();",`${this.constructorCode}${e}  }`,"","  insertRunningEffect(effect) {","    if (this.runningEffectsTail == null) {","      this.runningEffectsHead = effect;","      this.runningEffectsTail = effect;","    } else {","      this.runningEffectsTail.next = effect;","      effect.prev = this.runningEffectsTail;","      this.runningEffectsTail = effect;","    }","  }","","  removeRunningEffect(effect) {","    if (effect.prev != null) {","      effect.prev.next = effect.next;","    }","    if (effect.next != null) {","      effect.next.prev = effect.prev;","    }","    if (this.runningEffectsHead == effect) {","      this.runningEffectsHead = effect.next;","    }","    if (this.runningEffectsTail == effect) {","      this.runningEffectsTail = effect.prev;","    }","    effect.prev = null;","    effect.next = null;","  }","","  process(inputs, outputs, parameters) {","    let output = outputs[0][0];","    debugger;","    for (let i = 0; i < output.length; ++i) {","      let result = 0.0;",`${this.code_}${this.postCode}      let effect = this.runningEffectsHead;`,"      while (effect != null) {","        let isDone = effect.update();","        if (isDone) {","          this.removeRunningEffect(effect);","          for (let onDone of effect.onDone) {","            onDone();","          }","        }","        effect = effect.next;","      }","      output[i] = result;","    }","    return true;","  }","}","",'registerProcessor("compiled-graph-audio-worklet-processor", CompiledGraphAudioWorkletProcessor);'].join(`\r
`)}};function Hc(i,e){let r=new Map,t=[i];for(;;){let n=t.pop();if(n==null)break;if(r.has(n))continue;let o={};for(let s of Object.entries(n.inputs))o[s[0]]={...s[1]};let a={id:0,inputs:o,outputs:{},height:n.height,node:n.node};e(a),r.set(n,a);for(let s of Object.values(n.outputs))for(let u of s)t.push(u.node)}for(let n of r.values())for(let o of Object.entries(n.inputs)){let a=r.get(o[1].node);a!=null&&(o[1].node=a)}for(let n of r.values())for(let[o,{node:a,pin:s}]of Object.entries(n.inputs)){let u=a.outputs[s],l={node:n,pin:o};u==null?(u=[l],a.outputs[s]=u):u.push(l)}return r.get(i)}function Kc(i){let e=i.nodesSystem,r=[];{let a=new Map;for(let s of e.nodes()){let u={id:0,inputs:{},outputs:{},height:0,node:s};a.set(s.node.nodeParams.entity,u),r.push(u)}for(let s of a.values())for(let u of s.node.node.inputPins?.()??[]){let l=u.source();if(l==null)continue;let c=a.get(l.target);c!=null&&(s.inputs[u.name]={node:c,pin:l.pin})}}for(let a of r)for(let[s,{node:u,pin:l}]of Object.entries(a.inputs)){let c=u.outputs[l],d={node:a,pin:s};c==null?(c=[d],u.outputs[l]=c):c.push(d)}let t=[];{let a=new Set;for(;;){let s=!1;Zn(r);for(let u of r){let l=t[u.height];l==null?(l=[u],t[u.height]=l):l.push(u)}for(let u=0;u<t.length;++u){let l=t[u]??[];for(let c of l){if(a.has(c))continue;let d=c.node.node;if(d.ext.macro!=null){d.ext.macro(c,f=>r.push(f)),a.add(c),s=!0;break}}if(s)break}if(!s)break}}Zn(r);{let a=0;for(let s of r)s.id=a++}let n=new Wc;{let a=new Set;for(let s of e.nodes()){let u=s.node.type;a.has(u.componentType.typeName)||(a.add(u.componentType.typeName),u.ext.generateInitOnceCode?.({ctx:n}))}}t.splice(0,t.length);for(let a of r){let s=t[a.height];s==null?(s=[a],t[a.height]=s):s.push(a)}let o=new Map;for(let a=0;a<t.length;++a){let s=t[a]??[];for(let u of s){let l=u.node.node,c=new Map;for(let d of Object.entries(u.inputs)){let f=o.get(d[1].node)?.get(d[1].pin);f!=null?c.set(d[0],f):c.set(d[0],`this.n_${d[1].node.id}_${d[1].pin}`)}if(l.ext.generateCode!=null){let d=l.ext.generateCode({ctx:n,inputAtoms:c,codeGenNodeId:u.id});if(d.length==1){let f=d[0].outputAtoms;o.set(u,f)}}}}return n.code}function Zn(i){let e=new Set,r=[...i],t=[];for(;;){let n=r.pop();if(n==null){let s=r;if(r=t,t=s,n=r.pop(),n==null)break}if(e.has(n))continue;let o=!0;for(let[s,{node:u}]of Object.entries(n.inputs))if(!(n.node.node.inputPins?.().find(l=>l.name==s)?.isEffectPin??!1)&&!e.has(u)){o=!1;break}if(!o){t.push(n);continue}let a=0;for(let[,{node:s,pin:u}]of Object.entries(n.inputs))(s.node.node.outputPins?.().find(({name:l})=>l==u)?.isEffectPin??!1)||s.height>=a&&(a=s.height+1);n.height=a,e.add(n)}}var it={},zt={},vr,Qn;function Yc(){if(Qn)return vr;Qn=1;function i(n){var o=new t(n),a=o.readChunk();if(a.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+a.id+"'";for(var s=e(a.data),u=[],l=0;!o.eof()&&l<s.numTracks;l++){var c=o.readChunk();if(c.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+c.id+"'";var d=r(c.data);u.push(d)}return{header:s,tracks:u}}function e(n){var o=new t(n),a=o.readUInt16(),s=o.readUInt16(),u={format:a,numTracks:s},l=o.readUInt16();return l&32768?(u.framesPerSecond=256-(l>>8),u.ticksPerFrame=l&255):u.ticksPerBeat=l,u}function r(n){for(var o=new t(n),a=[];!o.eof();){var s=l();a.push(s)}return a;var u;function l(){var c={};c.deltaTime=o.readVarInt();var d=o.readUInt8();if((d&240)===240)if(d===255){c.meta=!0;var f=o.readUInt8(),p=o.readVarInt();switch(f){case 0:if(c.type="sequenceNumber",p!==2)throw"Expected length for sequenceNumber event is 2, got "+p;return c.number=o.readUInt16(),c;case 1:return c.type="text",c.text=o.readString(p),c;case 2:return c.type="copyrightNotice",c.text=o.readString(p),c;case 3:return c.type="trackName",c.text=o.readString(p),c;case 4:return c.type="instrumentName",c.text=o.readString(p),c;case 5:return c.type="lyrics",c.text=o.readString(p),c;case 6:return c.type="marker",c.text=o.readString(p),c;case 7:return c.type="cuePoint",c.text=o.readString(p),c;case 32:if(c.type="channelPrefix",p!=1)throw"Expected length for channelPrefix event is 1, got "+p;return c.channel=o.readUInt8(),c;case 33:if(c.type="portPrefix",p!=1)throw"Expected length for portPrefix event is 1, got "+p;return c.port=o.readUInt8(),c;case 47:if(c.type="endOfTrack",p!=0)throw"Expected length for endOfTrack event is 0, got "+p;return c;case 81:if(c.type="setTempo",p!=3)throw"Expected length for setTempo event is 3, got "+p;return c.microsecondsPerBeat=o.readUInt24(),c;case 84:if(c.type="smpteOffset",p!=5)throw"Expected length for smpteOffset event is 5, got "+p;var g=o.readUInt8(),h={0:24,32:25,64:29,96:30};return c.frameRate=h[g&96],c.hour=g&31,c.min=o.readUInt8(),c.sec=o.readUInt8(),c.frame=o.readUInt8(),c.subFrame=o.readUInt8(),c;case 88:if(c.type="timeSignature",p!=2&&p!=4)throw"Expected length for timeSignature event is 4 or 2, got "+p;return c.numerator=o.readUInt8(),c.denominator=1<<o.readUInt8(),p===4?(c.metronome=o.readUInt8(),c.thirtyseconds=o.readUInt8()):(c.metronome=36,c.thirtyseconds=8),c;case 89:if(c.type="keySignature",p!=2)throw"Expected length for keySignature event is 2, got "+p;return c.key=o.readInt8(),c.scale=o.readUInt8(),c;case 127:return c.type="sequencerSpecific",c.data=o.readBytes(p),c;default:return c.type="unknownMeta",c.data=o.readBytes(p),c.metatypeByte=f,c}}else if(d==240){c.type="sysEx";var p=o.readVarInt();return c.data=o.readBytes(p),c}else if(d==247){c.type="endSysEx";var p=o.readVarInt();return c.data=o.readBytes(p),c}else throw"Unrecognised MIDI event type byte: "+d;else{var y;if(d&128)y=o.readUInt8(),u=d;else{if(u===null)throw"Running status byte encountered before status byte";y=d,d=u,c.running=!0}var m=d>>4;switch(c.channel=d&15,m){case 8:return c.type="noteOff",c.noteNumber=y,c.velocity=o.readUInt8(),c;case 9:var b=o.readUInt8();return c.type=b===0?"noteOff":"noteOn",c.noteNumber=y,c.velocity=b,b===0&&(c.byte9=!0),c;case 10:return c.type="noteAftertouch",c.noteNumber=y,c.amount=o.readUInt8(),c;case 11:return c.type="controller",c.controllerType=y,c.value=o.readUInt8(),c;case 12:return c.type="programChange",c.programNumber=y,c;case 13:return c.type="channelAftertouch",c.amount=y,c;case 14:return c.type="pitchBend",c.value=y+(o.readUInt8()<<7)-8192,c;default:throw"Unrecognised MIDI event type: "+m}}}}function t(n){this.buffer=n,this.bufferLen=this.buffer.length,this.pos=0}return t.prototype.eof=function(){return this.pos>=this.bufferLen},t.prototype.readUInt8=function(){var n=this.buffer[this.pos];return this.pos+=1,n},t.prototype.readInt8=function(){var n=this.readUInt8();return n&128?n-256:n},t.prototype.readUInt16=function(){var n=this.readUInt8(),o=this.readUInt8();return(n<<8)+o},t.prototype.readInt16=function(){var n=this.readUInt16();return n&32768?n-65536:n},t.prototype.readUInt24=function(){var n=this.readUInt8(),o=this.readUInt8(),a=this.readUInt8();return(n<<16)+(o<<8)+a},t.prototype.readInt24=function(){var n=this.readUInt24();return n&8388608?n-16777216:n},t.prototype.readUInt32=function(){var n=this.readUInt8(),o=this.readUInt8(),a=this.readUInt8(),s=this.readUInt8();return(n<<24)+(o<<16)+(a<<8)+s},t.prototype.readBytes=function(n){var o=this.buffer.slice(this.pos,this.pos+n);return this.pos+=n,o},t.prototype.readString=function(n){var o=this.readBytes(n);return String.fromCharCode.apply(null,o)},t.prototype.readVarInt=function(){for(var n=0;!this.eof();){var o=this.readUInt8();if(o&128)n+=o&127,n<<=7;else return n+o}return n},t.prototype.readChunk=function(){var n=this.readString(4),o=this.readUInt32(),a=this.readBytes(o);return{id:n,length:o,data:a}},vr=i,vr}var kr,ei;function Jc(){if(ei)return kr;ei=1;function i(o,a){if(typeof o!="object")throw"Invalid MIDI data";a=a||{};var s=o.header||{},u=o.tracks||[],l,c=u.length,d=new n;for(e(d,s,c),l=0;l<c;l++)r(d,u[l],a);return d.buffer}function e(o,a,s){var u=a.format==null?1:a.format,l=128;a.timeDivision?l=a.timeDivision:a.ticksPerFrame&&a.framesPerSecond?l=-(a.framesPerSecond&255)<<8|a.ticksPerFrame&255:a.ticksPerBeat&&(l=a.ticksPerBeat&32767);var c=new n;c.writeUInt16(u),c.writeUInt16(s),c.writeUInt16(l),o.writeChunk("MThd",c.buffer)}function r(o,a,s){var u=new n,l,c=a.length,d=null;for(l=0;l<c;l++)(s.running===!1||!s.running&&!a[l].running)&&(d=null),d=t(u,a[l],d,s.useByte9ForNoteOff);o.writeChunk("MTrk",u.buffer)}function t(o,a,s,u){var l=a.type,c=a.deltaTime,d=a.text||"",f=a.data||[],p=null;switch(o.writeVarInt(c),l){case"sequenceNumber":o.writeUInt8(255),o.writeUInt8(0),o.writeVarInt(2),o.writeUInt16(a.number);break;case"text":o.writeUInt8(255),o.writeUInt8(1),o.writeVarInt(d.length),o.writeString(d);break;case"copyrightNotice":o.writeUInt8(255),o.writeUInt8(2),o.writeVarInt(d.length),o.writeString(d);break;case"trackName":o.writeUInt8(255),o.writeUInt8(3),o.writeVarInt(d.length),o.writeString(d);break;case"instrumentName":o.writeUInt8(255),o.writeUInt8(4),o.writeVarInt(d.length),o.writeString(d);break;case"lyrics":o.writeUInt8(255),o.writeUInt8(5),o.writeVarInt(d.length),o.writeString(d);break;case"marker":o.writeUInt8(255),o.writeUInt8(6),o.writeVarInt(d.length),o.writeString(d);break;case"cuePoint":o.writeUInt8(255),o.writeUInt8(7),o.writeVarInt(d.length),o.writeString(d);break;case"channelPrefix":o.writeUInt8(255),o.writeUInt8(32),o.writeVarInt(1),o.writeUInt8(a.channel);break;case"portPrefix":o.writeUInt8(255),o.writeUInt8(33),o.writeVarInt(1),o.writeUInt8(a.port);break;case"endOfTrack":o.writeUInt8(255),o.writeUInt8(47),o.writeVarInt(0);break;case"setTempo":o.writeUInt8(255),o.writeUInt8(81),o.writeVarInt(3),o.writeUInt24(a.microsecondsPerBeat);break;case"smpteOffset":o.writeUInt8(255),o.writeUInt8(84),o.writeVarInt(5);var g={24:0,25:32,29:64,30:96},h=a.hour&31|g[a.frameRate];o.writeUInt8(h),o.writeUInt8(a.min),o.writeUInt8(a.sec),o.writeUInt8(a.frame),o.writeUInt8(a.subFrame);break;case"timeSignature":o.writeUInt8(255),o.writeUInt8(88),o.writeVarInt(4),o.writeUInt8(a.numerator);var y=Math.floor(Math.log(a.denominator)/Math.LN2)&255;o.writeUInt8(y),o.writeUInt8(a.metronome),o.writeUInt8(a.thirtyseconds||8);break;case"keySignature":o.writeUInt8(255),o.writeUInt8(89),o.writeVarInt(2),o.writeInt8(a.key),o.writeUInt8(a.scale);break;case"sequencerSpecific":o.writeUInt8(255),o.writeUInt8(127),o.writeVarInt(f.length),o.writeBytes(f);break;case"unknownMeta":a.metatypeByte!=null&&(o.writeUInt8(255),o.writeUInt8(a.metatypeByte),o.writeVarInt(f.length),o.writeBytes(f));break;case"sysEx":o.writeUInt8(240),o.writeVarInt(f.length),o.writeBytes(f);break;case"endSysEx":o.writeUInt8(247),o.writeVarInt(f.length),o.writeBytes(f);break;case"noteOff":var m=u!==!1&&a.byte9||u&&a.velocity==0?144:128;p=m|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.noteNumber),o.writeUInt8(a.velocity);break;case"noteOn":p=144|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.noteNumber),o.writeUInt8(a.velocity);break;case"noteAftertouch":p=160|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.noteNumber),o.writeUInt8(a.amount);break;case"controller":p=176|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.controllerType),o.writeUInt8(a.value);break;case"programChange":p=192|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.programNumber);break;case"channelAftertouch":p=208|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.amount);break;case"pitchBend":p=224|a.channel,p!==s&&o.writeUInt8(p);var b=8192+a.value,v=b&127,k=b>>7&127;o.writeUInt8(v),o.writeUInt8(k);break;default:throw"Unrecognized event type: "+l}return p}function n(){this.buffer=[]}return n.prototype.writeUInt8=function(o){this.buffer.push(o&255)},n.prototype.writeInt8=n.prototype.writeUInt8,n.prototype.writeUInt16=function(o){var a=o>>8&255,s=o&255;this.writeUInt8(a),this.writeUInt8(s)},n.prototype.writeInt16=n.prototype.writeUInt16,n.prototype.writeUInt24=function(o){var a=o>>16&255,s=o>>8&255,u=o&255;this.writeUInt8(a),this.writeUInt8(s),this.writeUInt8(u)},n.prototype.writeInt24=n.prototype.writeUInt24,n.prototype.writeUInt32=function(o){var a=o>>24&255,s=o>>16&255,u=o>>8&255,l=o&255;this.writeUInt8(a),this.writeUInt8(s),this.writeUInt8(u),this.writeUInt8(l)},n.prototype.writeInt32=n.prototype.writeUInt32,n.prototype.writeBytes=function(o){this.buffer=this.buffer.concat(Array.prototype.slice.call(o,0))},n.prototype.writeString=function(o){var a,s=o.length,u=[];for(a=0;a<s;a++)u.push(o.codePointAt(a));this.writeBytes(u)},n.prototype.writeVarInt=function(o){if(o<0)throw"Cannot write negative variable-length integer";if(o<=127)this.writeUInt8(o);else{var a=o,s=[];for(s.push(a&127),a>>=7;a;){var u=a&127|128;s.push(u),a>>=7}this.writeBytes(s.reverse())}},n.prototype.writeChunk=function(o,a){this.writeString(o),this.writeUInt32(a.length),this.writeBytes(a)},kr=i,kr}var ti;function Oo(){return ti||(ti=1,zt.parseMidi=Yc(),zt.writeMidi=Jc()),zt}var wr={},ot={},ri;function Fo(){if(ri)return ot;ri=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.insert=ot.search=void 0;function i(r,t,n){n===void 0&&(n="ticks");var o=0,a=r.length,s=a;if(a>0&&r[a-1][n]<=t)return a-1;for(;o<s;){var u=Math.floor(o+(s-o)/2),l=r[u],c=r[u+1];if(l[n]===t){for(var d=u;d<r.length;d++){var f=r[d];f[n]===t&&(u=d)}return u}else{if(l[n]<t&&c[n]>t)return u;l[n]>t?s=u:l[n]<t&&(o=u+1)}}return-1}ot.search=i;function e(r,t,n){if(n===void 0&&(n="ticks"),r.length){var o=i(r,t[n],n);r.splice(o+1,0,t)}else r.push(t)}return ot.insert=e,ot}var ni;function Or(){return ni||(ni=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Header=i.keySignatureKeys=void 0;var e=Fo(),r=new WeakMap;i.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var t=function(){function n(o){var a=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",r.set(this,480),o){r.set(this,o.header.ticksPerBeat),o.tracks.forEach(function(u){u.forEach(function(l){l.meta&&(l.type==="timeSignature"?a.timeSignatures.push({ticks:l.absoluteTime,timeSignature:[l.numerator,l.denominator]}):l.type==="setTempo"?a.tempos.push({bpm:6e7/l.microsecondsPerBeat,ticks:l.absoluteTime}):l.type==="keySignature"&&a.keySignatures.push({key:i.keySignatureKeys[l.key+7],scale:l.scale===0?"major":"minor",ticks:l.absoluteTime}))})});var s=0;o.tracks[0].forEach(function(u){s+=u.deltaTime,u.meta&&(u.type==="trackName"?a.name=u.text:(u.type==="text"||u.type==="cuePoint"||u.type==="marker"||u.type==="lyrics")&&a.meta.push({text:u.text,ticks:s,type:u.type}))}),this.update()}}return n.prototype.update=function(){var o=this,a=0,s=0;this.tempos.sort(function(u,l){return u.ticks-l.ticks}),this.tempos.forEach(function(u,l){var c=l>0?o.tempos[l-1].bpm:o.tempos[0].bpm,d=u.ticks/o.ppq-s,f=60/c*d;u.time=f+a,a=u.time,s+=d}),this.timeSignatures.sort(function(u,l){return u.ticks-l.ticks}),this.timeSignatures.forEach(function(u,l){var c=l>0?o.timeSignatures[l-1]:o.timeSignatures[0],d=(u.ticks-c.ticks)/o.ppq,f=d/c.timeSignature[0]/(c.timeSignature[1]/4);c.measures=c.measures||0,u.measures=f+c.measures})},n.prototype.ticksToSeconds=function(o){var a=(0,e.search)(this.tempos,o);if(a!==-1){var s=this.tempos[a],u=s.time,l=(o-s.ticks)/this.ppq;return u+60/s.bpm*l}else{var c=o/this.ppq;return 60/120*c}},n.prototype.ticksToMeasures=function(o){var a=(0,e.search)(this.timeSignatures,o);if(a!==-1){var s=this.timeSignatures[a],u=(o-s.ticks)/this.ppq;return s.measures+u/(s.timeSignature[0]/s.timeSignature[1])/4}else return o/this.ppq/4},Object.defineProperty(n.prototype,"ppq",{get:function(){return r.get(this)},enumerable:!1,configurable:!0}),n.prototype.secondsToTicks=function(o){var a=(0,e.search)(this.tempos,o,"time");if(a!==-1){var s=this.tempos[a],u=s.time,l=o-u,c=l/(60/s.bpm);return Math.round(s.ticks+c*this.ppq)}else{var d=o/.5;return Math.round(d*this.ppq)}},n.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(o){return{bpm:o.bpm,ticks:o.ticks}}),timeSignatures:this.timeSignatures}},n.prototype.fromJSON=function(o){this.name=o.name,this.tempos=o.tempos.map(function(a){return Object.assign({},a)}),this.timeSignatures=o.timeSignatures.map(function(a){return Object.assign({},a)}),this.keySignatures=o.keySignatures.map(function(a){return Object.assign({},a)}),this.meta=o.meta.map(function(a){return Object.assign({},a)}),r.set(this,o.ppq),this.update()},n.prototype.setTempo=function(o){this.tempos=[{bpm:o,ticks:0}],this.update()},n}();i.Header=t}(wr)),wr}var wt={},xr={},ii;function Do(){return ii||(ii=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ControlChange=i.controlChangeIds=i.controlChangeNames=void 0,i.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},i.controlChangeIds=Object.keys(i.controlChangeNames).reduce(function(n,o){return n[i.controlChangeNames[o]]=o,n},{});var e=new WeakMap,r=new WeakMap,t=function(){function n(o,a){e.set(this,a),r.set(this,o.controllerType),this.ticks=o.absoluteTime,this.value=o.value}return Object.defineProperty(n.prototype,"number",{get:function(){return r.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return i.controlChangeNames[this.number]?i.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){var o=e.get(this);return o.ticksToSeconds(this.ticks)},set:function(o){var a=e.get(this);this.ticks=a.secondsToTicks(o)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},n}();i.ControlChange=t}(xr)),xr}var xt={},oi;function Xc(){if(oi)return xt;oi=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.createControlChanges=void 0;var i=Do();function e(){return new Proxy({},{get:function(r,t){if(r[t])return r[t];if(i.controlChangeIds.hasOwnProperty(t))return r[i.controlChangeIds[t]]},set:function(r,t,n){return i.controlChangeIds.hasOwnProperty(t)?r[i.controlChangeIds[t]]=n:r[t]=n,!0}})}return xt.createControlChanges=e,xt}var St={},ai;function Zc(){if(ai)return St;ai=1,Object.defineProperty(St,"__esModule",{value:!0}),St.PitchBend=void 0;var i=new WeakMap,e=function(){function r(t,n){i.set(this,n),this.ticks=t.absoluteTime,this.value=t.value}return Object.defineProperty(r.prototype,"time",{get:function(){var t=i.get(this);return t.ticksToSeconds(this.ticks)},set:function(t){var n=i.get(this);this.ticks=n.secondsToTicks(t)},enumerable:!1,configurable:!0}),r.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},r}();return St.PitchBend=e,St}var Ct={},Je={},si;function Qc(){return si||(si=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.DrumKitByPatchID=Je.InstrumentFamilyByID=Je.instrumentByPatchID=void 0,Je.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],Je.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],Je.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}),Je}var li;function eu(){if(li)return Ct;li=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.Instrument=void 0;var i=Qc(),e=new WeakMap,r=function(){function t(n,o){if(this.number=0,e.set(this,o),this.number=0,n){var a=n.find(function(s){return s.type==="programChange"});a&&(this.number=a.programNumber)}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.percussion?i.DrumKitByPatchID[this.number]:i.instrumentByPatchID[this.number]},set:function(n){var o=i.instrumentByPatchID.indexOf(n);o!==-1&&(this.number=o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this.percussion?"drums":i.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percussion",{get:function(){var n=e.get(this);return n.channel===9},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},t.prototype.fromJSON=function(n){this.number=n.number},t}();return Ct.Instrument=r,Ct}var Pt={},ci;function tu(){if(ci)return Pt;ci=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Note=void 0;function i(a){var s=Math.floor(a/12)-1;return e(a)+s.toString()}function e(a){var s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],u=a%12;return s[u]}function r(a){var s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return s.indexOf(a)}var t=function(){var a=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,s={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(u){var l=a.exec(u),c=l[1],d=l[2],f=s[c.toLowerCase()];return f+(parseInt(d,10)+1)*12}}(),n=new WeakMap,o=function(){function a(s,u,l){n.set(this,l),this.midi=s.midi,this.velocity=s.velocity,this.noteOffVelocity=u.velocity,this.ticks=s.ticks,this.durationTicks=u.ticks-s.ticks}return Object.defineProperty(a.prototype,"name",{get:function(){return i(this.midi)},set:function(s){this.midi=t(s)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(s){var u=s-this.octave;this.midi+=u*12},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pitch",{get:function(){return e(this.midi)},set:function(s){this.midi=12*(this.octave+1)+r(s)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){var s=n.get(this);return s.ticksToSeconds(this.ticks+this.durationTicks)-s.ticksToSeconds(this.ticks)},set:function(s){var u=n.get(this),l=u.secondsToTicks(this.time+s);this.durationTicks=l-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){var s=n.get(this);return s.ticksToSeconds(this.ticks)},set:function(s){var u=n.get(this);this.ticks=u.secondsToTicks(s)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bars",{get:function(){var s=n.get(this);return s.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},a}();return Pt.Note=o,Pt}var ui;function di(){if(ui)return wt;ui=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.Track=void 0;var i=Fo(),e=Do(),r=Xc(),t=Zc(),n=eu(),o=tu(),a=new WeakMap,s=function(){function u(l,c){var d=this;if(this.name="",this.notes=[],this.controlChanges=(0,r.createControlChanges)(),this.pitchBends=[],a.set(this,c),l){var f=l.find(function(k){return k.type==="trackName"});this.name=f?f.text:""}if(this.instrument=new n.Instrument(l,this),this.channel=0,l){for(var p=l.filter(function(k){return k.type==="noteOn"}),g=l.filter(function(k){return k.type==="noteOff"}),h=function(){var k=p.shift();y.channel=k.channel;var x=g.findIndex(function(C){return C.noteNumber===k.noteNumber&&C.absoluteTime>=k.absoluteTime});if(x!==-1){var w=g.splice(x,1)[0];y.addNote({durationTicks:w.absoluteTime-k.absoluteTime,midi:k.noteNumber,noteOffVelocity:w.velocity/127,ticks:k.absoluteTime,velocity:k.velocity/127})}},y=this;p.length;)h();var m=l.filter(function(k){return k.type==="controller"});m.forEach(function(k){d.addCC({number:k.controllerType,ticks:k.absoluteTime,value:k.value/127})});var b=l.filter(function(k){return k.type==="pitchBend"});b.forEach(function(k){d.addPitchBend({ticks:k.absoluteTime,value:k.value/Math.pow(2,13)})});var v=l.find(function(k){return k.type==="endOfTrack"});this.endOfTrackTicks=v!==void 0?v.absoluteTime:void 0}}return u.prototype.addNote=function(l){var c=a.get(this),d=new o.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},c);return Object.assign(d,l),(0,i.insert)(this.notes,d,"ticks"),this},u.prototype.addCC=function(l){var c=a.get(this),d=new e.ControlChange({controllerType:l.number},c);return delete l.number,Object.assign(d,l),Array.isArray(this.controlChanges[d.number])||(this.controlChanges[d.number]=[]),(0,i.insert)(this.controlChanges[d.number],d,"ticks"),this},u.prototype.addPitchBend=function(l){var c=a.get(this),d=new t.PitchBend({},c);return Object.assign(d,l),(0,i.insert)(this.pitchBends,d,"ticks"),this},Object.defineProperty(u.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var l=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,c=0;c<this.notes.length-1;c++){var d=this.notes[c].time+this.notes[c].duration;l<d&&(l=d)}return l},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var l=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,c=0;c<this.notes.length-1;c++){var d=this.notes[c].ticks+this.notes[c].durationTicks;l<d&&(l=d)}return l},enumerable:!1,configurable:!0}),u.prototype.fromJSON=function(l){var c=this;this.name=l.name,this.channel=l.channel,this.instrument=new n.Instrument(void 0,this),this.instrument.fromJSON(l.instrument),l.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=l.endOfTrackTicks);for(var d in l.controlChanges)l.controlChanges[d]&&l.controlChanges[d].forEach(function(f){c.addCC({number:f.number,ticks:f.ticks,value:f.value})});l.notes.forEach(function(f){c.addNote({durationTicks:f.durationTicks,midi:f.midi,ticks:f.ticks,velocity:f.velocity})})},u.prototype.toJSON=function(){for(var l={},c=0;c<127;c++)this.controlChanges.hasOwnProperty(c)&&(l[c]=this.controlChanges[c].map(function(f){return f.toJSON()}));var d={channel:this.channel,controlChanges:l,pitchBends:this.pitchBends.map(function(f){return f.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(f){return f.toJSON()})};return this.endOfTrackTicks!==void 0&&(d.endOfTrackTicks=this.endOfTrackTicks),d},u}();return wt.Track=s,wt}var at={};function ru(i){var e=[];return jo(i,e),e}function jo(i,e){for(var r=0;r<i.length;r++){var t=i[r];Array.isArray(t)?jo(t,e):e.push(t)}}const nu=Object.freeze(Object.defineProperty({__proto__:null,flatten:ru},Symbol.toStringTag,{value:"Module"})),iu=vs(nu);var pi;function ou(){if(pi)return at;pi=1;var i=at&&at.__spreadArray||function(m,b,v){if(v||arguments.length===2)for(var k=0,x=b.length,w;k<x;k++)(w||!(k in b))&&(w||(w=Array.prototype.slice.call(b,0,k)),w[k]=b[k]);return m.concat(w||Array.prototype.slice.call(b))};Object.defineProperty(at,"__esModule",{value:!0}),at.encode=void 0;var e=Oo(),r=Or(),t=iu;function n(m,b){return[{absoluteTime:m.ticks,channel:b,deltaTime:0,noteNumber:m.midi,type:"noteOn",velocity:Math.floor(m.velocity*127)},{absoluteTime:m.ticks+m.durationTicks,channel:b,deltaTime:0,noteNumber:m.midi,type:"noteOff",velocity:Math.floor(m.noteOffVelocity*127)}]}function o(m){return(0,t.flatten)(m.notes.map(function(b){return n(b,m.channel)}))}function a(m,b){return{absoluteTime:m.ticks,channel:b,controllerType:m.number,deltaTime:0,type:"controller",value:Math.floor(m.value*127)}}function s(m){for(var b=[],v=0;v<127;v++)m.controlChanges.hasOwnProperty(v)&&m.controlChanges[v].forEach(function(k){b.push(a(k,m.channel))});return b}function u(m,b){return{absoluteTime:m.ticks,channel:b,deltaTime:0,type:"pitchBend",value:m.value}}function l(m){var b=[];return m.pitchBends.forEach(function(v){b.push(u(v,m.channel))}),b}function c(m){return{absoluteTime:0,channel:m.channel,deltaTime:0,programNumber:m.instrument.number,type:"programChange"}}function d(m){return{absoluteTime:0,deltaTime:0,meta:!0,text:m,type:"trackName"}}function f(m){return{absoluteTime:m.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/m.bpm),type:"setTempo"}}function p(m){return{absoluteTime:m.ticks,deltaTime:0,denominator:m.timeSignature[1],meta:!0,metronome:24,numerator:m.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function g(m){var b=r.keySignatureKeys.indexOf(m.key);return{absoluteTime:m.ticks,deltaTime:0,key:b+7,meta:!0,scale:m.scale==="major"?0:1,type:"keySignature"}}function h(m){return{absoluteTime:m.ticks,deltaTime:0,meta:!0,text:m.text,type:m.type}}function y(m){var b={header:{format:1,numTracks:m.tracks.length+1,ticksPerBeat:m.header.ppq},tracks:i([i(i(i(i([{absoluteTime:0,deltaTime:0,meta:!0,text:m.header.name,type:"trackName"}],m.header.keySignatures.map(function(v){return g(v)}),!0),m.header.meta.map(function(v){return h(v)}),!0),m.header.tempos.map(function(v){return f(v)}),!0),m.header.timeSignatures.map(function(v){return p(v)}),!0)],m.tracks.map(function(v){return i(i(i([d(v.name),c(v)],o(v),!0),s(v),!0),l(v),!0)}),!0)};return b.tracks=b.tracks.map(function(v){v=v.sort(function(x,w){return x.absoluteTime-w.absoluteTime});var k=0;return v.forEach(function(x){x.deltaTime=x.absoluteTime-k,k=x.absoluteTime,delete x.absoluteTime}),v.push({deltaTime:0,meta:!0,type:"endOfTrack"}),v}),new Uint8Array((0,e.writeMidi)(b))}return at.encode=y,at}var fi;function au(){return fi||(fi=1,function(i){var e=it&&it.__awaiter||function(d,f,p,g){function h(y){return y instanceof p?y:new p(function(m){m(y)})}return new(p||(p=Promise))(function(y,m){function b(x){try{k(g.next(x))}catch(w){m(w)}}function v(x){try{k(g.throw(x))}catch(w){m(w)}}function k(x){x.done?y(x.value):h(x.value).then(b,v)}k((g=g.apply(d,f||[])).next())})},r=it&&it.__generator||function(d,f){var p={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},g,h,y,m;return m={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function b(k){return function(x){return v([k,x])}}function v(k){if(g)throw new TypeError("Generator is already executing.");for(;p;)try{if(g=1,h&&(y=k[0]&2?h.return:k[0]?h.throw||((y=h.return)&&y.call(h),0):h.next)&&!(y=y.call(h,k[1])).done)return y;switch(h=0,y&&(k=[k[0]&2,y.value]),k[0]){case 0:case 1:y=k;break;case 4:return p.label++,{value:k[1],done:!1};case 5:p.label++,h=k[1],k=[0];continue;case 7:k=p.ops.pop(),p.trys.pop();continue;default:if(y=p.trys,!(y=y.length>0&&y[y.length-1])&&(k[0]===6||k[0]===2)){p=0;continue}if(k[0]===3&&(!y||k[1]>y[0]&&k[1]<y[3])){p.label=k[1];break}if(k[0]===6&&p.label<y[1]){p.label=y[1],y=k;break}if(y&&p.label<y[2]){p.label=y[2],p.ops.push(k);break}y[2]&&p.ops.pop(),p.trys.pop();continue}k=f.call(d,p)}catch(x){k=[6,x],h=0}finally{g=y=0}if(k[0]&5)throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0}),i.Header=i.Track=i.Midi=void 0;var t=Oo(),n=Or(),o=di(),a=ou(),s=function(){function d(f){var p=this,g=null;if(f){var h=f instanceof ArrayBuffer?new Uint8Array(f):f;g=(0,t.parseMidi)(h),g.tracks.forEach(function(y){var m=0;y.forEach(function(b){m+=b.deltaTime,b.absoluteTime=m})}),g.tracks=c(g.tracks)}this.header=new n.Header(g),this.tracks=[],f&&(this.tracks=g.tracks.map(function(y){return new o.Track(y,p.header)}),g.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return d.fromUrl=function(f){return e(this,void 0,void 0,function(){var p,g;return r(this,function(h){switch(h.label){case 0:return[4,fetch(f)];case 1:return p=h.sent(),p.ok?[4,p.arrayBuffer()]:[3,3];case 2:return g=h.sent(),[2,new d(g)];case 3:throw new Error("Could not load '".concat(f,"'"))}})})},Object.defineProperty(d.prototype,"name",{get:function(){return this.header.name},set:function(f){this.header.name=f},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"duration",{get:function(){var f=this.tracks.map(function(p){return p.duration});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"durationTicks",{get:function(){var f=this.tracks.map(function(p){return p.durationTicks});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),d.prototype.addTrack=function(){var f=new o.Track(void 0,this.header);return this.tracks.push(f),f},d.prototype.toArray=function(){return(0,a.encode)(this)},d.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(f){return f.toJSON()})}},d.prototype.fromJSON=function(f){var p=this;this.header=new n.Header,this.header.fromJSON(f.header),this.tracks=f.tracks.map(function(g){var h=new o.Track(void 0,p.header);return h.fromJSON(g),h})},d.prototype.clone=function(){var f=new d;return f.fromJSON(this.toJSON()),f},d}();i.Midi=s;var u=di();Object.defineProperty(i,"Track",{enumerable:!0,get:function(){return u.Track}});var l=Or();Object.defineProperty(i,"Header",{enumerable:!0,get:function(){return l.Header}});function c(d){for(var f=[],p=0;p<d.length;p++)for(var g=f.length,h=new Map,y=Array(16).fill(0),m=0,b=d[p];m<b.length;m++){var v=b[m],k=g,x=v.channel;if(x!==void 0){v.type==="programChange"&&(y[x]=v.programNumber);var w=y[x],C="".concat(w," ").concat(x);h.has(C)?k=h.get(C):(k=g+h.size,h.set(C,k))}f[k]||f.push([]),f[k].push(v)}return f}}(it)),it}var Lo=au();const su=q({prev:D(E),delay:D(E),next:Q(E)}),Qr=new J({typeName:"Delay",typeSchema:su}),lu=q({next:Q(E)}),en=new J({typeName:"Start",typeSchema:lu}),cu=q({value:Le(),out:Q(E)}),Rt=new J({typeName:"Number",typeSchema:cu}),uu=q({id:Ye(),prev:D(E),value:D(E),next:Q(E)}),tn=new J({typeName:"SetVariable",typeSchema:uu}),du=q({id:Ye(),value:Q(E)}),rn=new J({typeName:"Variable",typeSchema:du}),pu=q({frequency:D(E),out:Q(E)}),nn=new J({typeName:"Meow",typeSchema:pu}),fu=q({in:D(E)}),on=new J({typeName:"Speaker",typeSchema:fu});async function hu(i,e){let r=[],t=new Lo.Midi(await e.arrayBuffer());for(let h of t.tracks)for(let y of h.notes)r.push({time:y.time,type:"NoteOn",note:y.midi}),r.push({time:y.time+y.duration,type:"NoteOff",note:y.midi});r.sort((h,y)=>h.time-y.time);let n=1e3,o=new Set,a=new Map,s=0;for(let h of r){let y=a.get(h.time);if(y==null?(y=[h],a.set(h.time,y)):y.push(h),o.add(h.note),++s,s>=n)break}let u=0,l=0,c,d;{let h=en.create({next:[]});d=m=>{h.setState("next",b=>[...b,m])},c={target:i.createEntity([h,we.create({transform:fe.create(U.create(l,0),pe.rot0)})]),pin:"next"}}l+=200;let f=[],p,g=-200;for(let h=21;h<=108;++h){if(!o.has(h))continue;let y=261.63*Math.pow(2,(h-60)/12),m=Rt.create({value:y,out:[]}),b=i.createEntity([m,we.create({transform:fe.create(U.create(l,g),pe.rot0)})]);f[h]={id:b,c:m},g-=100}{let h=Rt.create({value:0,out:[]});p={id:i.createEntity([h,we.create({transform:fe.create(U.create(l,g),pe.rot0)})]),c:h}}for(let h=21;h<=108;++h){if(!o.has(h))continue;let y=rn.create({id:`n${h}`,value:[]}),m=i.createEntity([y,we.create({transform:fe.create(U.create(l,g),pe.rot0)})]),b=nn.create({frequency:{target:m,pin:"value"},out:[]}),v=i.createEntity([b,we.create({transform:fe.create(U.create(l+150,g),pe.rot0)})]);y.setState("value",[{target:v,pin:"frequency"}]);let k=on.create({in:{target:v,pin:"out"}}),x=i.createEntity([k,we.create({transform:fe.create(U.create(l+300,g),pe.rot0)})]);b.setState("out",[{target:x,pin:"in"}]),g-=100}for(let[h,y]of a.entries()){let m=h-u;u=h;{let b=Qr.create({prev:c,delay:void 0,next:[]});d=w=>{b.setState("next",C=>[...C,w])};let v=i.createEntity([b,we.create({transform:fe.create(U.create(l,0),pe.rot0)})]),k=i.createEntity([Rt.create({value:m*1e3,out:[{target:v,pin:"delay"}]}),we.create({transform:fe.create(U.create(l,-100),pe.rot0)})]);b.setState("delay",{target:k,pin:"out"}),c={target:v,pin:"next"};let x=-250;for(let w of y){w.type=="NoteOn"&&261.63*Math.pow(2,(w.note-128)/12);let C=tn.create({id:`n${w.note}`,prev:{...c},value:void 0,next:[]}),P=i.createEntity([C,we.create({transform:fe.create(U.create(l,x),pe.rot0)})]);if(w.type=="NoteOn"){let T=f[w.note];T.c.setState("out",$=>[...$,{target:P,pin:"value"}]),C.setState("value",{target:T.id,pin:"out"})}else p.c.setState("out",T=>[...T,{target:P,pin:"value"}]),C.setState("value",{target:p.id,pin:"out"});d({target:P,pin:"prev"}),x-=200}}if(l+=200,n-=y.length,await new Promise(b=>requestAnimationFrame(()=>b())),n<=0)break}}const mu=q({a:D(E),b:D(E),out:Q(E)}),zo=new J({typeName:"Add",typeSchema:mu});class gu{componentType=zo;ext={};create(e){return new yu(e)}}const Uo=new gu;class yu{type=Uo;nodeParams;inputPins;outputPins;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"a",source:()=>r.a,setSource:n=>t("a",n)},{name:"b",source:()=>r.b,setSource:n=>t("b",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("a");if(a==null)return[];let s=o.get("b");if(s==null)return[];let u=n.allocField("0.0");n.insertCode([`${u} = ${a} + ${s}`]);let l=new Map;return l.set("out",u),[{outputAtoms:l}]}}}}const bu=q({timeToOne:D(E),out:Q(E)}),Bo=new J({typeName:"Attack",typeSchema:bu});class vu{componentType=Bo;ext={};create(e){return new ku(e)}}const qo=new vu;class ku{type=qo;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"timeToOne",source:()=>r.timeToOne,setSource:n=>t("timeToOne",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}])}}class wu{componentType=Qr;ext={};create(e){return new xu(e)}}const Vo=new wu;class xu{type=Vo;nodeParams;inputPins;outputPins;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"prev",source:()=>r.prev,setSource:n=>t("prev",n),isEffectPin:!0},{name:"delay",source:()=>r.delay,setSource:n=>t("delay",n)}]),this.outputPins=S(()=>[{name:"next",sinks:()=>r.next,setSinks:n=>t("next",n),isEffectPin:!0}]),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let s=o.get("prev");if(s==null)return[];let u=o.get("delay");if(u==null)return[];let l=`this.n_${a}_next`;n.addDeclToExistingForField(l,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`);let c=n.allocField("0.0");n.insertConstructorCode([`${s}.onDone.push(() => {`,`  ${c} = currentTime * 1000.0;`,`  this.insertRunningEffect(${l});`,"});",`${l}.update = () => {`,`  let time = currentTime * 1000.0 - ${c};`,"  // return true when done.",`  return time >= ${u};`,"};"]);let d=`${l}`,f=new Map;return f.set("next",d),[{outputAtoms:f}]}}}}const Su=q({prev:D(E),entry:D(E),next:Q(E)}),Go=new J({typeName:"Goto",typeSchema:Su});class Cu{componentType=Go;ext={};create(e){return new Pu(e)}}const Wo=new Cu;class Pu{type=Wo;nodeParams;inputPins;outputPins;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"prev",source:()=>r.prev,setSource:n=>t("prev",n),isEffectPin:!0},{name:"entry",source:()=>r.entry,setSource:n=>t("entry",n),isEffectPin:!0}]),this.outputPins=S(()=>[{name:"next",sinks:()=>r.next,setSinks:n=>t("next",n),isEffectPin:!0}]),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let s=o.get("prev");if(s==null)return[];let u=o.get("entry");if(u==null)return[];let l=`this.n_${a}_next`;n.addDeclToExistingForField(l,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),n.insertConstructorCode([`${s}.onDone.push(() => {`,`  this.insertRunningEffect(${l});`,"});",`${u}.onDone.push(() => {`,`  this.insertRunningEffect(${l});`,"});",`${l}.update = () => true;`]);let c=`${l}`,d=new Map;return d.set("next",c),[{outputAtoms:d}]}}}}const _u=q({out:Q(E)}),an=new J({typeName:"Knob",typeSchema:_u});var Tu=B(`<svg version=1.1 viewBox="-16 -16 32 32"><defs><linearGradient id=shape-fill x1=0 x2=0 y1=0 y2=1><stop offset=0% stop-color="rgb(80, 80, 81)"></stop><stop offset=100% stop-color="rgb(30, 30, 31)"></stop></linearGradient><path id=shape d="
        M14.876 -5.890A-16 -16 0 0 0 14.876 5.890A16 16 0 0 112.539 9.938A-16 -16 0 0 0 2.337 15.828
        A16 16 0 0 1-2.337 15.828A-16 -16 0 0 0 -12.539 9.938A16 16 0 0 1-14.876 5.890A-16 -16 0 0 0 -14.876 -5.890
        A16 16 0 0 1-12.539 -9.938A-16 -16 0 0 0 -2.337 -15.828A16 16 0 0 12.337 -15.828A-16 -16 0 0 0 12.539 -9.938
        A16 16 0 0 114.876 -5.890"></path><clipPath id=shape-mask style="transform:rotate(var(--rot)) scale(0.87)"><use href=#shape></use></clipPath><filter id=lights></filter><filter id=shadow></filter></defs><circle cx=0 cy=0 r=15.0 fill="rgb(36, 36, 37)"stroke="rgb(28, 28, 29)"stroke-width=0.5></circle><g filter=url(#shadow)><g filter=url(#lights)><g clip-path=url(#shape-mask)><rect x=-16 y=-16 width=32 height=32 fill=url(#shape-fill)></rect><circle cx=-28 cy=-28 r=32 fill="rgba(250, 250, 255, .16)"></circle></g></g></g><g style=transform:rotate(var(--rot))><circle cx=0 cy=-11 r=1.1 fill=black></circle><circle cx=0 cy=-11 r=0.8 fill=white></circle></g><circle cx=0 cy=0 r=9 stroke="rgb(50, 50, 51)"stroke-width=0.7 fill=none></circle><foreignObject x=-9 y=-9 width=18 height=18><div style=width:18px;height:18px;border-radius:50%;background-image:conic-gradient(#aaa,#666,#aaa,#666,#aaa,#666,#aaa);>`);const $u=i=>{let[e,r]=Ce({dragging:void 0}),[t,n]=Y();ye(()=>{e.dragging&&i.setDisablePan(!1)});let o=-165,a=-o,s=S(()=>o+(i.value-i.minValue)*(a-o)/(i.maxValue-i.minValue)),u=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");u.setAttribute("dx","-0.3"),u.setAttribute("dy","-0.3"),u.setAttribute("stdDeviation","0.1"),u.setAttribute("flood-opacity","0.7"),u.setAttribute("flood-color","white");let l=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");l.setAttribute("dx","1.5"),l.setAttribute("dy","1.5"),l.setAttribute("stdDeviation","0.5"),l.setAttribute("flood-opacity","0.9"),l.setAttribute("flood-color","black");let c=p=>{let g=t(),h=g.getBoundingClientRect(),y=p.clientX-h.left,m=p.clientY-h.top,b=y-.5*h.width,v=m-.5*h.width;console.log("x",y.toFixed()),console.log("y",m.toFixed()),console.log("dx",b.toFixed()),console.log("dy",v.toFixed());let k=b*b+v*v;if(k>h.width*h.width)return;let x=Math.sqrt(k),C=360/(2*Math.PI*x),P=v>0?-C:C,T=b>0?C:-C;r("dragging",new er({pointerId:p.pointerId,startX:y,startY:m,startValue:i.value,dadx:P,dady:T})),g.setPointerCapture(p.pointerId),i.setDisablePan(!0)},d=p=>{if(e.dragging==null||p.pointerId!=e.dragging.value.pointerId)return;let g=t(),h=e.dragging.value,y=g.getBoundingClientRect(),m=p.clientX-y.left,b=p.clientY-y.top,v=o+(h.startValue-i.minValue)*(a-o)/(i.maxValue-i.minValue)+(m-h.startX)*h.dadx+(b-h.startY)*h.dady,k=i.minValue+(v-o)*(i.maxValue-i.minValue)/(a-o);k=Math.max(i.minValue,Math.min(i.maxValue,k)),i.setValue(k)},f=p=>{e.dragging!=null&&e.dragging.value.pointerId==p.pointerId&&(t().releasePointerCapture(e.dragging.value.pointerId),i.setDisablePan(!1))};return(()=>{var p=Tu(),g=p.firstChild,h=g.firstChild,y=h.nextSibling,m=y.nextSibling,b=m.nextSibling,v=b.nextSibling;p.$$pointerup=f,p.$$pointermove=d,p.$$pointerdown=c;var k=n;return typeof k=="function"?he(k,p):n=p,p.style.setProperty("user-select","none"),p.style.setProperty("outline","none"),W(b,u),W(v,l),Z(x=>{var w=`${i.size}px`,C=`${i.size}px`,P=`${s()}deg`;return w!==x.e&&((x.e=w)!=null?p.style.setProperty("width",w):p.style.removeProperty("width")),C!==x.t&&((x.t=C)!=null?p.style.setProperty("height",C):p.style.removeProperty("height")),P!==x.a&&((x.a=P)!=null?p.style.setProperty("--rot",P):p.style.removeProperty("--rot")),x},{e:void 0,t:void 0,a:void 0}),p})()};be(["pointerdown","pointermove","pointerup"]);var Eu=B("<div><div><label class=input>min<input type=text value=0.00></label><label class=input>max<input type=text value=1.00></label><label class=input>value<input type=text>");class Iu{componentType=an;ext;constructor(){this.ext={generateInitOnceCode:({ctx:e})=>{e.insertGlobalCode(["let knobValues = {};"]),e.insertMessageHandlerCode("KnobChange",["knobValues[params.id] = params.value;"])}}}create(e){return new Ru(e)}}const Ho=new Iu;class Ru{type=Ho;nodeParams;outputPins;ui;disablePan;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:u=>t("out",u)}]);let[n,o]=Y(!1),[a,s]=Y();this.ui=S(()=>()=>{let[u,l]=Y(0);ae(ne(u,d=>{let f=a();f?.port.postMessage({type:"KnobChange",params:{id:`${e.entity}`,value:d}})})),ye(()=>o(!1));let c=100;return(()=>{var d=Eu(),f=d.firstChild,p=f.firstChild,g=p.nextSibling,h=g.nextSibling,y=h.firstChild,m=y.nextSibling;return f.style.setProperty("max-width","100px"),W(d,I($u,{size:c,indentSize:10,minValue:0,maxValue:1,get value(){return u()},setValue:l,setDisablePan:o}),null),Z(()=>m.value=u().toFixed(2)),d})()}),this.disablePan=n,this.ext={init:async u=>{s(u)},generateCode:({ctx:u})=>{u.insertGlobalCode([`knobValues["${e.entity}"] = 0.0;`]);let l=`knobValues["${e.entity}"]`,c=new Map;return c.set("out",l),[{outputAtoms:c}]}}}}var Sr={exports:{}},hi;function Mu(){return hi||(hi=1,function(i,e){(function(r,t){i.exports=t()})(window,function(){return function(r){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return r[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=r,n.c=t,n.d=function(o,a,s){n.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:s})},n.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},n.t=function(o,a){if(1&a&&(o=n(o)),8&a||4&a&&typeof o=="object"&&o&&o.__esModule)return o;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:o}),2&a&&typeof o!="string")for(var u in o)n.d(s,u,function(l){return o[l]}.bind(null,u));return s},n.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return n.d(a,"a",a),a},n.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},n.p="",n(n.s="./src/index.ts")}({"./src/chunk.ts":function(r,t,n){n.r(t),n.d(t,"SF2Chunk",function(){return p});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=n("./src/chunks/index.ts");function u(g){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(g)}function l(g,h){for(var y=0;y<h.length;y++){var m=h[y];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(g,m.key,m)}}function c(g){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(g)}function d(g,h){return(d=Object.setPrototypeOf||function(y,m){return y.__proto__=m,y})(g,h)}function f(g){if(g===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}var p=function(g){function h(b){var v,k,x,w,C,P;return function(T,$){if(!(T instanceof $))throw new TypeError("Cannot call a class as a function")}(this,h),k=this,v=!(x=c(h).call(this,b.id,b.length,b.buffer,b.subChunks))||u(x)!=="object"&&typeof x!="function"?f(k):x,w=f(f(v)),P=void 0,(C="subChunks")in w?Object.defineProperty(w,C,{value:P,enumerable:!0,configurable:!0,writable:!0}):w[C]=P,v.subChunks=b.subChunks.map(function(T){return new h(T)}),v}var y,m;return function(b,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(v&&v.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),v&&d(b,v)}(h,g),y=h,(m=[{key:"getMetaData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var b=this.subChunks.reduce(function(v,k){if(k.id==="ifil"||k.id==="iver"){if(k.length!==a.SF_VERSION_LENGTH)throw new o.ParseError("Invalid size for the '".concat(k.id,"' sub-chunk"));v[k.id]="".concat(k.getInt16(),".").concat(k.getInt16(2))}else v[k.id]=k.getString();return v},{});if(!b.ifil)throw new o.ParseError("Missing required 'ifil' sub-chunk");if(!b.INAM)throw new o.ParseError("Missing required 'INAM' sub-chunk");return{version:b.ifil,soundEngine:b.isng||"EMU8000",name:b.INAM,rom:b.irom,romVersion:b.iver,creationDate:b.ICRD,author:b.IENG,product:b.IPRD,copyright:b.ICOP,comments:b.ICMT,createdBy:b.ISFT}}},{key:"getSampleData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var b=this.subChunks[0];if(b.id!=="smpl")throw new o.ParseError("Invalid chunk signature","'smpl'","'".concat(b.id,"'"));return b.buffer}},{key:"getPresetData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));return{presetHeaders:Object(s.getPresetHeaders)(this.subChunks[0]),presetZones:Object(s.getZones)(this.subChunks[1],"pbag"),presetModulators:Object(s.getModulators)(this.subChunks[2],"pmod"),presetGenerators:Object(s.getGenerators)(this.subChunks[3],"pgen"),instrumentHeaders:Object(s.getInstrumentHeaders)(this.subChunks[4]),instrumentZones:Object(s.getZones)(this.subChunks[5],"ibag"),instrumentModulators:Object(s.getModulators)(this.subChunks[6],"imod"),instrumentGenerators:Object(s.getGenerators)(this.subChunks[7],"igen"),sampleHeaders:Object(s.getSampleHeaders)(this.subChunks[8])}}}])&&l(y.prototype,m),h}(o.RIFFChunk)},"./src/chunks/generators.ts":function(r,t,n){n.r(t),n.d(t,"getGenerators",function(){return d});var o=n("./src/riff/index.ts"),a=n("./src/types/index.ts"),s=n("./src/constants.ts"),u=[a.GeneratorType.StartAddrsOffset,a.GeneratorType.EndAddrsOffset,a.GeneratorType.StartLoopAddrsOffset,a.GeneratorType.EndLoopAddrsOffset,a.GeneratorType.StartAddrsCoarseOffset,a.GeneratorType.EndAddrsCoarseOffset,a.GeneratorType.StartLoopAddrsCoarseOffset,a.GeneratorType.KeyNum,a.GeneratorType.Velocity,a.GeneratorType.EndLoopAddrsCoarseOffset,a.GeneratorType.SampleModes,a.GeneratorType.ExclusiveClass,a.GeneratorType.OverridingRootKey],l=[a.GeneratorType.Unused1,a.GeneratorType.Unused2,a.GeneratorType.Unused3,a.GeneratorType.Unused4,a.GeneratorType.Reserved1,a.GeneratorType.Reserved2,a.GeneratorType.Reserved3],c=[a.GeneratorType.KeyRange,a.GeneratorType.VelRange],d=function(f,p){if(f.id!==p)throw new o.ParseError("Unexpected chunk ID","'".concat(p,"'"),"'".concat(f.id,"'"));if(f.length%s.SF_GENERATOR_SIZE)throw new o.ParseError("Invalid size for the '".concat(p,"' sub-chunk"));return f.iterate(function(g){var h=g.getInt16();return a.GeneratorType[h]?p==="pgen"&&u.includes(h)||p==="igen"&&l.includes(h)?null:c.includes(h)?{id:h,range:{lo:g.getByte(),hi:g.getByte()}}:{id:h,value:g.getInt16BE()}:null})}},"./src/chunks/index.ts":function(r,t,n){n.r(t);var o=n("./src/chunks/instruments/index.ts");n.d(t,"getInstrumentHeaders",function(){return o.getInstrumentHeaders});var a=n("./src/chunks/presets/index.ts");n.d(t,"getPresetHeaders",function(){return a.getPresetHeaders});var s=n("./src/chunks/samples/index.ts");n.d(t,"getSampleHeaders",function(){return s.getSampleHeaders});var u=n("./src/chunks/generators.ts");n.d(t,"getGenerators",function(){return u.getGenerators});var l=n("./src/chunks/modulators.ts");n.d(t,"getModulators",function(){return l.getModulators});var c=n("./src/chunks/zones.ts");n.d(t,"getZones",function(){return c.getZones}),n.d(t,"getItemsInZone",function(){return c.getItemsInZone})},"./src/chunks/instruments/headers.ts":function(r,t,n){n.r(t),n.d(t,"getInstrumentHeaders",function(){return s});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=function(u){if(u.id!=="inst")throw new o.ParseError("Unexpected chunk ID","'inst'","'".concat(u.id,"'"));if(u.length%a.SF_INSTRUMENT_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'inst' sub-chunk");return u.iterate(function(l){return{name:l.getString(),bagIndex:l.getInt16()}})}},"./src/chunks/instruments/index.ts":function(r,t,n){n.r(t);var o=n("./src/chunks/instruments/headers.ts");n.d(t,"getInstrumentHeaders",function(){return o.getInstrumentHeaders})},"./src/chunks/modulators.ts":function(r,t,n){n.r(t),n.d(t,"getModulators",function(){return u});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=function(l){return{type:l>>10&63,polarity:l>>9&1,direction:l>>8&1,palette:l>>7&1,index:127&l}},u=function(l,c){if(l.id!==c)throw new o.ParseError("Unexpected chunk ID","'".concat(c,"'"),"'".concat(l.id,"'"));if(l.length%a.SF_MODULATOR_SIZE)throw new o.ParseError("Invalid size for the '".concat(c,"' sub-chunk"));return l.iterate(function(d){return{source:s(d.getInt16BE()),id:d.getInt16BE(),value:d.getInt16BE(),valueSource:s(d.getInt16BE()),transform:d.getInt16BE()}})}},"./src/chunks/presets/headers.ts":function(r,t,n){n.r(t),n.d(t,"getPresetHeaders",function(){return s});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=function(u){if(u.id!=="phdr")throw new o.ParseError("Invalid chunk ID","'phdr'","'".concat(u.id,"'"));if(u.length%a.SF_PRESET_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'phdr' sub-chunk");return u.iterate(function(l){return{name:l.getString(),preset:l.getInt16(),bank:l.getInt16(),bagIndex:l.getInt16(),library:l.getUInt32(),genre:l.getUInt32(),morphology:l.getUInt32()}})}},"./src/chunks/presets/index.ts":function(r,t,n){n.r(t);var o=n("./src/chunks/presets/headers.ts");n.d(t,"getPresetHeaders",function(){return o.getPresetHeaders})},"./src/chunks/samples/headers.ts":function(r,t,n){n.r(t),n.d(t,"getSampleHeaders",function(){return s});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=function(u){if(u.id!=="shdr")throw new o.ParseError("Unexpected chunk ID","'shdr'","'".concat(u.id,"'"));if(u.length%a.SF_SAMPLE_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'shdr' sub-chunk");return u.iterate(function(l){return{name:l.getString(),start:l.getUInt32(),end:l.getUInt32(),startLoop:l.getUInt32(),endLoop:l.getUInt32(),sampleRate:l.getUInt32(),originalPitch:l.getByte(),pitchCorrection:l.getChar(),link:l.getInt16(),type:l.getInt16()}})}},"./src/chunks/samples/index.ts":function(r,t,n){n.r(t);var o=n("./src/chunks/samples/headers.ts");n.d(t,"getSampleHeaders",function(){return o.getSampleHeaders})},"./src/chunks/zones.ts":function(r,t,n){n.r(t),n.d(t,"getZones",function(){return u}),n.d(t,"getItemsInZone",function(){return l});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=n("./src/types/index.ts"),u=function(p,g){if(p.id!==g)throw new o.ParseError("Unexpected chunk ID","'".concat(g,"'"),"'".concat(p.id,"'"));if(p.length%a.SF_BAG_SIZE)throw new o.ParseError("Invalid size for the '".concat(g,"' sub-chunk"));return p.iterate(function(h){return{generatorIndex:h.getInt16(),modulatorIndex:h.getInt16()}})},l=function(p,g,h,y,m,b){for(var v=[],k=0;k<p.length;k++){for(var x=p[k],w=p[k+1],C=x.bagIndex,P=w?w.bagIndex:g.length,T=[],$=void 0,_=C;_<P;_++){var M=c(_,g,h),L=d(_,g,y),O=L[s.GeneratorType.KeyRange]&&L[s.GeneratorType.KeyRange].range,R=L[b];if(R){var F=m[R.value];F&&T.push({keyRange:O,modulators:M,generators:L,reference:F})}else _-C==0&&($={keyRange:O,modulators:M,generators:L})}v.push({header:x,globalZone:$,zones:T})}return v},c=function(p,g,h){var y=g[p],m=g[p+1],b=y.modulatorIndex,v=m?m.modulatorIndex:g.length;return f(b,v,h)},d=function(p,g,h){var y=g[p],m=g[p+1],b=y.generatorIndex,v=m?m.generatorIndex:g.length;return f(b,v,h)},f=function(p,g,h){for(var y={},m=p;m<g;m++){var b=h[m];b&&(y[b.id]=b)}return y}},"./src/constants.ts":function(r,t,n){n.r(t),n.d(t,"SF_VERSION_LENGTH",function(){return o}),n.d(t,"SF_PRESET_HEADER_SIZE",function(){return a}),n.d(t,"SF_BAG_SIZE",function(){return s}),n.d(t,"SF_MODULATOR_SIZE",function(){return u}),n.d(t,"SF_GENERATOR_SIZE",function(){return l}),n.d(t,"SF_INSTRUMENT_HEADER_SIZE",function(){return c}),n.d(t,"SF_SAMPLE_HEADER_SIZE",function(){return d}),n.d(t,"DEFAULT_SAMPLE_RATE",function(){return f});var o=4,a=38,s=4,u=10,l=4,c=22,d=46,f=22050},"./src/index.ts":function(r,t,n){n.r(t);var o=n("./src/types/index.ts");for(var a in o)["default"].indexOf(a)<0&&function(c){n.d(t,c,function(){return o[c]})}(a);var s=n("./src/chunk.ts");n.d(t,"SF2Chunk",function(){return s.SF2Chunk});var u=n("./src/constants.ts");n.d(t,"SF_VERSION_LENGTH",function(){return u.SF_VERSION_LENGTH}),n.d(t,"SF_PRESET_HEADER_SIZE",function(){return u.SF_PRESET_HEADER_SIZE}),n.d(t,"SF_BAG_SIZE",function(){return u.SF_BAG_SIZE}),n.d(t,"SF_MODULATOR_SIZE",function(){return u.SF_MODULATOR_SIZE}),n.d(t,"SF_GENERATOR_SIZE",function(){return u.SF_GENERATOR_SIZE}),n.d(t,"SF_INSTRUMENT_HEADER_SIZE",function(){return u.SF_INSTRUMENT_HEADER_SIZE}),n.d(t,"SF_SAMPLE_HEADER_SIZE",function(){return u.SF_SAMPLE_HEADER_SIZE}),n.d(t,"DEFAULT_SAMPLE_RATE",function(){return u.DEFAULT_SAMPLE_RATE});var l=n("./src/soundFont2.ts");n.d(t,"SoundFont2",function(){return l.SoundFont2})},"./src/riff/chunkIterator.ts":function(r,t,n){n.r(t),n.d(t,"ChunkIterator",function(){return l});var o=n("./src/utils/index.ts");function a(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")}function s(c,d){for(var f=0;f<d.length;f++){var p=d[f];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function u(c,d,f){return d in c?Object.defineProperty(c,d,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[d]=f,c}var l=function(){function c(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;a(this,c),u(this,"target",[]),u(this,"chunk",void 0),u(this,"position",0),this.chunk=p,this.position=g}var d,f;return d=c,(f=[{key:"iterate",value:function(p){for(;this.position<this.chunk.length;){var g=p(this);g&&this.target.push(g)}}},{key:"getString",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20,g=Object(o.getStringFromBuffer)(this.getBuffer(this.position,p));return this.position+=p,g}},{key:"getInt16",value:function(){return this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8}},{key:"getInt16BE",value:function(){return this.getInt16()<<16>>16}},{key:"getUInt32",value:function(){return(this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8|this.chunk.buffer[this.position++]<<16|this.chunk.buffer[this.position++]<<24)>>>0}},{key:"getByte",value:function(){return this.chunk.buffer[this.position++]}},{key:"getChar",value:function(){return this.chunk.buffer[this.position++]<<24>>24}},{key:"skip",value:function(p){this.position+=p}},{key:"getBuffer",value:function(p,g){return this.chunk.buffer.subarray(p,p+g)}},{key:"currentPosition",get:function(){return this.position}}])&&s(d.prototype,f),c}()},"./src/riff/index.ts":function(r,t,n){n.r(t);var o=n("./src/riff/chunkIterator.ts");n.d(t,"ChunkIterator",function(){return o.ChunkIterator});var a=n("./src/riff/parseError.ts");n.d(t,"ParseError",function(){return a.ParseError});var s=n("./src/riff/parser.ts");n.d(t,"parseBuffer",function(){return s.parseBuffer}),n.d(t,"getChunk",function(){return s.getChunk}),n.d(t,"getChunkLength",function(){return s.getChunkLength}),n.d(t,"getSubChunks",function(){return s.getSubChunks}),n.d(t,"getChunkId",function(){return s.getChunkId});var u=n("./src/riff/riffChunk.ts");n.d(t,"RIFFChunk",function(){return u.RIFFChunk})},"./src/riff/parseError.ts":function(r,t,n){function o(p){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(p)}function a(p,g){return!g||o(g)!=="object"&&typeof g!="function"?function(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}(p):g}function s(p){var g=typeof Map=="function"?new Map:void 0;return(s=function(h){if(h===null||(y=h,Function.toString.call(y).indexOf("[native code]")===-1))return h;var y;if(typeof h!="function")throw new TypeError("Super expression must either be null or a function");if(g!==void 0){if(g.has(h))return g.get(h);g.set(h,m)}function m(){return l(h,arguments,d(this).constructor)}return m.prototype=Object.create(h.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),c(m,h)})(p)}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function l(p,g,h){return(l=u()?Reflect.construct:function(y,m,b){var v=[null];v.push.apply(v,m);var k=new(Function.bind.apply(y,v));return b&&c(k,b.prototype),k}).apply(null,arguments)}function c(p,g){return(c=Object.setPrototypeOf||function(h,y){return h.__proto__=y,h})(p,g)}function d(p){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)})(p)}n.r(t),n.d(t,"ParseError",function(){return f});var f=function(p){function g(h,y,m){return function(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}(this,g),a(this,d(g).call(this,"".concat(h).concat(y&&m?", expected ".concat(y,", received ").concat(m):"")))}return function(h,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(y&&y.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),y&&c(h,y)}(g,p),g}(s(Error))},"./src/riff/parser.ts":function(r,t,n){n.r(t),n.d(t,"parseBuffer",function(){return u}),n.d(t,"getChunk",function(){return l}),n.d(t,"getChunkLength",function(){return c}),n.d(t,"getSubChunks",function(){return d}),n.d(t,"getChunkId",function(){return f});var o=n("./src/riff/parseError.ts"),a=n("./src/utils/buffer.ts"),s=n("./src/riff/riffChunk.ts"),u=function(p){var g=f(p);if(g!=="RIFF")throw new o.ParseError("Invalid file format","RIFF",g);var h=f(p,8);if(h!=="sfbk")throw new o.ParseError("Invalid signature","sfbk",h);var y=p.subarray(8),m=d(y.subarray(4));return new s.RIFFChunk(g,y.length,y,m)},l=function(p,g){var h=f(p,g),y=c(p,g+4),m=[];return h!=="RIFF"&&h!=="LIST"||(m=d(p.subarray(g+12))),new s.RIFFChunk(h,y,p.subarray(g+8),m)},c=function(p,g){return((p=p.subarray(g,g+4))[0]|p[1]<<8|p[2]<<16|p[3]<<24)>>>0},d=function(p){for(var g=[],h=0;h<=p.length-8;){var y=l(p,h);g.push(y),h=(h+=8+y.length)%2?h+1:h}return g},f=function(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Object(a.getStringFromBuffer)(p.subarray(g,g+4))}},"./src/riff/riffChunk.ts":function(r,t,n){n.r(t),n.d(t,"RIFFChunk",function(){return l});var o=n("./src/riff/chunkIterator.ts"),a=n("./src/utils/index.ts");function s(c,d){for(var f=0;f<d.length;f++){var p=d[f];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function u(c,d,f){return d in c?Object.defineProperty(c,d,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[d]=f,c}var l=function(){function c(p,g,h,y){(function(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")})(this,c),u(this,"id",void 0),u(this,"length",void 0),u(this,"buffer",void 0),u(this,"subChunks",void 0),this.id=p,this.length=g,this.buffer=h,this.subChunks=y}var d,f;return d=c,(f=[{key:"getString",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,g=arguments.length>1?arguments[1]:void 0;return Object(a.getStringFromBuffer)(this.getBuffer(p,g||this.length-p))}},{key:"getInt16",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[p++]|this.buffer[p]<<8}},{key:"getUInt32",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(this.buffer[p++]|this.buffer[p++]<<8|this.buffer[p++]<<16|this.buffer[p]<<24)>>>0}},{key:"getByte",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[p]}},{key:"getChar",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[p]<<24>>24}},{key:"iterator",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new o.ChunkIterator(this,p)}},{key:"iterate",value:function(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=new o.ChunkIterator(this,g);return h.iterate(p),h.target}},{key:"getBuffer",value:function(p,g){return this.buffer.subarray(p,p+g)}}])&&s(d.prototype,f),c}()},"./src/soundFont2.ts":function(r,t,n){n.r(t),n.d(t,"SoundFont2",function(){return g});var o=n("./src/types/index.ts"),a=n("./src/chunk.ts"),s=n("./src/riff/index.ts"),u=n("./src/chunks/index.ts"),l=n("./src/utils/index.ts");function c(h){for(var y=1;y<arguments.length;y++){var m=arguments[y]!=null?arguments[y]:{},b=Object.keys(m);typeof Object.getOwnPropertySymbols=="function"&&(b=b.concat(Object.getOwnPropertySymbols(m).filter(function(v){return Object.getOwnPropertyDescriptor(m,v).enumerable}))),b.forEach(function(v){p(h,v,m[v])})}return h}function d(h,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,b.key,b)}}function f(h,y,m){return y&&d(h.prototype,y),m&&d(h,m),h}function p(h,y,m){return y in h?Object.defineProperty(h,y,{value:m,enumerable:!0,configurable:!0,writable:!0}):h[y]=m,h}var g=function(){function h(y){if(function(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}(this,h),p(this,"chunk",void 0),p(this,"metaData",void 0),p(this,"sampleData",void 0),p(this,"samples",void 0),p(this,"presetData",void 0),p(this,"instruments",void 0),p(this,"presets",void 0),p(this,"banks",void 0),!(y instanceof a.SF2Chunk)){var m=Object(s.parseBuffer)(y);y=new a.SF2Chunk(m)}if(y.subChunks.length!==3)throw new s.ParseError("Invalid sfbk structure","3 chunks","".concat(y.subChunks.length," chunks"));this.chunk=y,this.metaData=y.subChunks[0].getMetaData(),this.sampleData=y.subChunks[1].getSampleData(),this.presetData=y.subChunks[2].getPresetData(),this.samples=this.getSamples(),this.instruments=this.getInstruments(),this.presets=this.getPresets(),this.banks=this.getBanks()}return f(h,null,[{key:"from",value:function(y){return new h(y)}}]),f(h,[{key:"getKeyData",value:function(y){var m=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Object(l.memoize)(function(k,x,w){var C=m.banks[x];if(C){var P=C.presets[w];if(P){var T=P.zones.filter(function(se){return m.isKeyInRange(se,k)});if(T.length>0){var $=!0,_=!1,M=void 0;try{for(var L,O=T[Symbol.iterator]();!($=(L=O.next()).done);$=!0){var R=L.value,F=R.instrument,V=F.zones.filter(function(se){return m.isKeyInRange(se,k)});if(V.length>0){var j=!0,G=!1,H=void 0;try{for(var te,A=V[Symbol.iterator]();!(j=(te=A.next()).done);j=!0){var X=te.value,re=X.sample,ve=c({},R.generators,X.generators),le=c({},R.modulators,X.modulators);return{keyNumber:k,preset:P,instrument:F,sample:re,generators:ve,modulators:le}}}catch(se){G=!0,H=se}finally{try{j||A.return==null||A.return()}finally{if(G)throw H}}}}}catch(se){_=!0,M=se}finally{try{$||O.return==null||O.return()}finally{if(_)throw M}}}}}return null})(y,b,v)}},{key:"isKeyInRange",value:function(y,m){return y.keyRange===void 0||y.keyRange.lo<=m&&y.keyRange.hi>=m}},{key:"getBanks",value:function(){return this.presets.reduce(function(y,m){var b=m.header.bank;return y[b]||(y[b]={presets:[]}),y[b].presets[m.header.preset]=m,y},[])}},{key:"getPresets",value:function(){var y=this.presetData,m=y.presetHeaders,b=y.presetZones,v=y.presetGenerators,k=y.presetModulators;return Object(u.getItemsInZone)(m,b,k,v,this.instruments,o.GeneratorType.Instrument).filter(function(x){return x.header.name!=="EOP"}).map(function(x){return{header:x.header,globalZone:x.globalZone,zones:x.zones.map(function(w){return{keyRange:w.keyRange,generators:w.generators,modulators:w.modulators,instrument:w.reference}})}})}},{key:"getInstruments",value:function(){var y=this.presetData,m=y.instrumentHeaders,b=y.instrumentZones,v=y.instrumentModulators,k=y.instrumentGenerators;return Object(u.getItemsInZone)(m,b,v,k,this.samples,o.GeneratorType.SampleId).filter(function(x){return x.header.name!=="EOI"}).map(function(x){return{header:x.header,globalZone:x.globalZone,zones:x.zones.map(function(w){return{keyRange:w.keyRange,generators:w.generators,modulators:w.modulators,sample:w.reference}})}})}},{key:"getSamples",value:function(){var y=this;return this.presetData.sampleHeaders.filter(function(m){return m.name!=="EOS"}).map(function(m){if(m.name!=="EOS"&&m.sampleRate<=0)throw new Error("Illegal sample rate of ".concat(m.sampleRate," hz in sample '").concat(m.name,"'"));return m.originalPitch>=128&&m.originalPitch<=254&&(m.originalPitch=60),m.startLoop-=m.start,m.endLoop-=m.start,{header:m,data:new Int16Array(new Uint8Array(y.sampleData.subarray(2*m.start,2*m.end)).buffer)}})}}]),h}()},"./src/types/bank.ts":function(r,t){},"./src/types/generator.ts":function(r,t,n){var o,a;function s(l,c,d){return c in l?Object.defineProperty(l,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[c]=d,l}n.r(t),n.d(t,"GeneratorType",function(){return a}),n.d(t,"DEFAULT_GENERATOR_VALUES",function(){return u}),function(l){l[l.StartAddrsOffset=0]="StartAddrsOffset",l[l.EndAddrsOffset=1]="EndAddrsOffset",l[l.StartLoopAddrsOffset=2]="StartLoopAddrsOffset",l[l.EndLoopAddrsOffset=3]="EndLoopAddrsOffset",l[l.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",l[l.ModLFOToPitch=5]="ModLFOToPitch",l[l.VibLFOToPitch=6]="VibLFOToPitch",l[l.ModEnvToPitch=7]="ModEnvToPitch",l[l.InitialFilterFc=8]="InitialFilterFc",l[l.InitialFilterQ=9]="InitialFilterQ",l[l.ModLFOToFilterFc=10]="ModLFOToFilterFc",l[l.ModEnvToFilterFc=11]="ModEnvToFilterFc",l[l.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",l[l.ModLFOToVolume=13]="ModLFOToVolume",l[l.Unused1=14]="Unused1",l[l.ChorusEffectsSend=15]="ChorusEffectsSend",l[l.ReverbEffectsSend=16]="ReverbEffectsSend",l[l.Pan=17]="Pan",l[l.Unused2=18]="Unused2",l[l.Unused3=19]="Unused3",l[l.Unused4=20]="Unused4",l[l.DelayModLFO=21]="DelayModLFO",l[l.FreqModLFO=22]="FreqModLFO",l[l.DelayVibLFO=23]="DelayVibLFO",l[l.FreqVibLFO=24]="FreqVibLFO",l[l.DelayModEnv=25]="DelayModEnv",l[l.AttackModEnv=26]="AttackModEnv",l[l.HoldModEnv=27]="HoldModEnv",l[l.DecayModEnv=28]="DecayModEnv",l[l.SustainModEnv=29]="SustainModEnv",l[l.ReleaseModEnv=30]="ReleaseModEnv",l[l.KeyNumToModEnvHold=31]="KeyNumToModEnvHold",l[l.KeyNumToModEnvDecay=32]="KeyNumToModEnvDecay",l[l.DelayVolEnv=33]="DelayVolEnv",l[l.AttackVolEnv=34]="AttackVolEnv",l[l.HoldVolEnv=35]="HoldVolEnv",l[l.DecayVolEnv=36]="DecayVolEnv",l[l.SustainVolEnv=37]="SustainVolEnv",l[l.ReleaseVolEnv=38]="ReleaseVolEnv",l[l.KeyNumToVolEnvHold=39]="KeyNumToVolEnvHold",l[l.KeyNumToVolEnvDecay=40]="KeyNumToVolEnvDecay",l[l.Instrument=41]="Instrument",l[l.Reserved1=42]="Reserved1",l[l.KeyRange=43]="KeyRange",l[l.VelRange=44]="VelRange",l[l.StartLoopAddrsCoarseOffset=45]="StartLoopAddrsCoarseOffset",l[l.KeyNum=46]="KeyNum",l[l.Velocity=47]="Velocity",l[l.InitialAttenuation=48]="InitialAttenuation",l[l.Reserved2=49]="Reserved2",l[l.EndLoopAddrsCoarseOffset=50]="EndLoopAddrsCoarseOffset",l[l.CoarseTune=51]="CoarseTune",l[l.FineTune=52]="FineTune",l[l.SampleId=53]="SampleId",l[l.SampleModes=54]="SampleModes",l[l.Reserved3=55]="Reserved3",l[l.ScaleTuning=56]="ScaleTuning",l[l.ExclusiveClass=57]="ExclusiveClass",l[l.OverridingRootKey=58]="OverridingRootKey",l[l.Unused5=59]="Unused5",l[l.EndOper=60]="EndOper"}(a||(a={}));var u=(s(o={},a.StartAddrsOffset,0),s(o,a.EndAddrsOffset,0),s(o,a.StartLoopAddrsOffset,0),s(o,a.EndLoopAddrsOffset,0),s(o,a.StartAddrsCoarseOffset,0),s(o,a.ModLFOToPitch,0),s(o,a.VibLFOToPitch,0),s(o,a.ModEnvToPitch,0),s(o,a.InitialFilterFc,13500),s(o,a.InitialFilterQ,0),s(o,a.ModLFOToFilterFc,0),s(o,a.ModEnvToFilterFc,0),s(o,a.EndAddrsCoarseOffset,0),s(o,a.ModLFOToVolume,0),s(o,a.ChorusEffectsSend,0),s(o,a.ReverbEffectsSend,0),s(o,a.Pan,0),s(o,a.DelayModLFO,-12e3),s(o,a.FreqModLFO,0),s(o,a.DelayVibLFO,-12e3),s(o,a.FreqVibLFO,0),s(o,a.DelayModEnv,-12e3),s(o,a.AttackModEnv,-12e3),s(o,a.HoldModEnv,-12e3),s(o,a.DecayModEnv,-12e3),s(o,a.SustainModEnv,0),s(o,a.ReleaseModEnv,-12e3),s(o,a.KeyNumToModEnvHold,0),s(o,a.KeyNumToModEnvDecay,0),s(o,a.DelayVolEnv,-12e3),s(o,a.AttackVolEnv,-12e3),s(o,a.HoldVolEnv,-12e3),s(o,a.DecayVolEnv,-12e3),s(o,a.SustainVolEnv,0),s(o,a.ReleaseVolEnv,-12e3),s(o,a.KeyNumToVolEnvHold,0),s(o,a.KeyNumToVolEnvDecay,0),s(o,a.StartLoopAddrsCoarseOffset,0),s(o,a.KeyNum,-1),s(o,a.Velocity,-1),s(o,a.InitialAttenuation,0),s(o,a.EndLoopAddrsCoarseOffset,0),s(o,a.CoarseTune,0),s(o,a.FineTune,0),s(o,a.SampleModes,0),s(o,a.ScaleTuning,100),s(o,a.ExclusiveClass,0),s(o,a.OverridingRootKey,-1),o)},"./src/types/index.ts":function(r,t,n){n.r(t);var o=n("./src/types/bank.ts");for(var a in o)["default"].indexOf(a)<0&&function(y){n.d(t,y,function(){return o[y]})}(a);var s=n("./src/types/generator.ts");n.d(t,"GeneratorType",function(){return s.GeneratorType}),n.d(t,"DEFAULT_GENERATOR_VALUES",function(){return s.DEFAULT_GENERATOR_VALUES});var u=n("./src/types/instrument.ts");for(var a in u)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(m){n.d(t,m,function(){return u[m]})}(a);var l=n("./src/types/key.ts");for(var a in l)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(m){n.d(t,m,function(){return l[m]})}(a);var c=n("./src/types/metaData.ts");for(var a in c)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(m){n.d(t,m,function(){return c[m]})}(a);var d=n("./src/types/modulator.ts");n.d(t,"ControllerType",function(){return d.ControllerType}),n.d(t,"ControllerPolarity",function(){return d.ControllerPolarity}),n.d(t,"ControllerDirection",function(){return d.ControllerDirection}),n.d(t,"ControllerPalette",function(){return d.ControllerPalette}),n.d(t,"Controller",function(){return d.Controller}),n.d(t,"TransformType",function(){return d.TransformType}),n.d(t,"DEFAULT_INSTRUMENT_MODULATORS",function(){return d.DEFAULT_INSTRUMENT_MODULATORS});var f=n("./src/types/preset.ts");for(var a in f)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(a)<0&&function(m){n.d(t,m,function(){return f[m]})}(a);var p=n("./src/types/presetData.ts");for(var a in p)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(a)<0&&function(m){n.d(t,m,function(){return p[m]})}(a);var g=n("./src/types/sample.ts");n.d(t,"SampleType",function(){return g.SampleType});var h=n("./src/types/zone.ts");for(var a in h)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","SampleType"].indexOf(a)<0&&function(m){n.d(t,m,function(){return h[m]})}(a)},"./src/types/instrument.ts":function(r,t){},"./src/types/key.ts":function(r,t){},"./src/types/metaData.ts":function(r,t){},"./src/types/modulator.ts":function(r,t,n){n.r(t),n.d(t,"ControllerType",function(){return o}),n.d(t,"ControllerPolarity",function(){return a}),n.d(t,"ControllerDirection",function(){return s}),n.d(t,"ControllerPalette",function(){return u}),n.d(t,"Controller",function(){return l}),n.d(t,"TransformType",function(){return c}),n.d(t,"DEFAULT_INSTRUMENT_MODULATORS",function(){return f});var o,a,s,u,l,c,d=n("./src/types/generator.ts");(function(p){p[p.Linear=0]="Linear",p[p.Concave=1]="Concave",p[p.Convex=2]="Convex",p[p.Switch=3]="Switch"})(o||(o={})),function(p){p[p.Unipolar=0]="Unipolar",p[p.Bipolar=1]="Bipolar"}(a||(a={})),function(p){p[p.Increasing=0]="Increasing",p[p.Decreasing=1]="Decreasing"}(s||(s={})),function(p){p[p.GeneralController=0]="GeneralController",p[p.MidiController=1]="MidiController"}(u||(u={})),function(p){p[p.NoController=0]="NoController",p[p.NoteOnVelocity=2]="NoteOnVelocity",p[p.NoteOnKeyNumber=3]="NoteOnKeyNumber",p[p.PolyPressure=10]="PolyPressure",p[p.ChannelPressure=13]="ChannelPressure",p[p.PitchWheel=14]="PitchWheel",p[p.PitchWheelSensitivity=16]="PitchWheelSensitivity",p[p.Link=127]="Link"}(l||(l={})),function(p){p[p.Linear=0]="Linear",p[p.Absolute=2]="Absolute"}(c||(c={}));var f=[{id:d.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:s.Decreasing,palette:u.GeneralController,index:l.NoteOnVelocity},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.InitialFilterFc,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Decreasing,palette:u.GeneralController,index:l.NoteOnVelocity},value:-2400,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.VibLFOToPitch,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.ChannelPressure},value:50,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.VibLFOToPitch,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.MidiController,index:1},value:50,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:s.Decreasing,palette:u.MidiController,index:7},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.InitialAttenuation,source:{type:o.Linear,polarity:a.Bipolar,direction:s.Increasing,palette:u.MidiController,index:10},value:1e3,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:s.Decreasing,palette:u.MidiController,index:11},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.ReverbEffectsSend,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.MidiController,index:91},value:200,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.ChorusEffectsSend,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.MidiController,index:93},value:200,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.CoarseTune,source:{type:o.Linear,polarity:a.Bipolar,direction:s.Increasing,palette:u.GeneralController,index:l.PitchWheel},value:12700,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.PitchWheelSensitivity},transform:c.Linear}]},"./src/types/preset.ts":function(r,t){},"./src/types/presetData.ts":function(r,t){},"./src/types/sample.ts":function(r,t,n){var o;n.r(t),n.d(t,"SampleType",function(){return o}),function(a){a[a.EOS=0]="EOS",a[a.Mono=1]="Mono",a[a.Right=2]="Right",a[a.Left=4]="Left",a[a.Linked=8]="Linked",a[a.RomMono=32769]="RomMono",a[a.RomRight=32770]="RomRight",a[a.RomLeft=32772]="RomLeft",a[a.RomLinked=32776]="RomLinked"}(o||(o={}))},"./src/types/zone.ts":function(r,t){},"./src/utils/buffer.ts":function(r,t,n){n.r(t),n.d(t,"getStringFromBuffer",function(){return o});var o=function(a){var s=new TextDecoder("utf8").decode(a),u=s.indexOf("\0");return(u===-1?s:s.slice(0,u)).trim()}},"./src/utils/index.ts":function(r,t,n){n.r(t);var o=n("./src/utils/buffer.ts");n.d(t,"getStringFromBuffer",function(){return o.getStringFromBuffer});var a=n("./src/utils/memoize.ts");n.d(t,"memoize",function(){return a.memoize})},"./src/utils/memoize.ts":function(r,t,n){n.r(t),n.d(t,"memoize",function(){return o});var o=function(a){var s={};return function(){for(var u=arguments.length,l=new Array(u),c=0;c<u;c++)l[c]=arguments[c];var d=JSON.stringify(l);if(d in s)return s[d];var f=a.apply(void 0,l);return s[d]=f,f}}}})})}(Sr)),Sr.exports}var Ko=Mu(),Au=B("<img width=120px height=120px src=./cat-node.jpg>");class Nu{componentType=nn;ext;constructor(){this.ext={initAudioCtx:async(e,r)=>{const n=await fetch("./Thurston Waffles.sf2").then(h=>h.arrayBuffer()),o=new Ko.SoundFont2(new Uint8Array(n)),a=o.presets[0];if(!a)throw new Error("Preset at index 0 not found.");const s=o.instruments[a.header.bagIndex];if(!s)throw new Error("No instrument found for preset at index 0");const u=(h,y)=>{for(const m of h.zones)if(m.keyRange!=null&&y>=m.keyRange.lo&&y<=m.keyRange.hi)return m.sample;return null};let l=60;const c=u(s,l);if(!c)throw new Error(`No sample found for note ${l} in preset 0.`);const d=c.header.sampleRate,f=c.data.length,p=new Float32Array(f);for(let h=0;h<f;h++)p[h]=c.data[h]/32768;const g=c.header.originalPitch;r.port.postMessage({type:"meowData",params:{meowOriginalPitch:g,meowSampleRate:d,meowData:p}})},generateInitOnceCode:({ctx:e})=>{e.insertGlobalCode(["let meowOriginalPitch = undefined;","let meowSampleRate = undefined;","let meowData = undefined;","let meowStepPerHz = undefined;"]),e.insertMessageHandlerCode("meowData",["meowOriginalPitch = params.meowOriginalPitch;","meowSampleRate = params.meowSampleRate;","meowData = params.meowData;",`meowStepPerHz = meowSampleRate / (sampleRate * ${261.625565});`])}}}create(e){return new Ou(e)}}const Yo=new Nu;class Ou{type=Yo;nodeParams;inputPins;outputPins;ui;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>r.frequency,setSource:n=>t("frequency",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ui=S(()=>()=>Au()),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let s=n.allocField("0.0"),u=n.allocField("0.0"),l=new Map,c=n.allocField("0.0"),d=n.allocField("0");return n.insertCode([`if (meowData == undefined || ${a} != ${s}) {`,`  ${u} = 0.0;`,`  ${c} = 0.0;`,`  ${s} = ${a};`,"} else {",`  if (${c} >= meowData.length) {`,`    ${u} = 0.0;`,"  } else {",`    ${d} = Math.floor(${c});`,`    let value = meowData[${d}];`,`    ${u} = value;`,`    let step = ${a} * meowStepPerHz;`,`    ${c} += step;`,"  }","}"]),l.set("out",u),[{outputAtoms:l}]}}}}const Fu=q({a:D(E),b:D(E),out:Q(E)}),Jo=new J({typeName:"Mult",typeSchema:Fu});class Du{componentType=Jo;ext={};create(e){return new ju(e)}}const Xo=new Du;class ju{type=Xo;nodeParams;inputPins;outputPins;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"a",source:()=>r.a,setSource:n=>t("a",n)},{name:"b",source:()=>r.b,setSource:n=>t("b",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("a");if(a==null)return[];let s=o.get("b");if(s==null)return[];let u=n.allocField("0.0");n.insertCode([`${u} = ${a} * ${s}`]);let l=new Map;return l.set("out",u),[{outputAtoms:l}]}}}}const Lu=q({out:Q(E)}),Zo=new J({typeName:"NoiseWave",typeSchema:Lu});class zu{componentType=Zo;ext={};create(e){return new Uu(e)}}const Qo=new zu;class Uu{type=Qo;nodeParams;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}])}}const Bu=q({entity:Ye(),note:Ye(),out:Q(E)}),ea=new J({typeName:"Note",typeSchema:Bu});class qu{componentType=ea;ext={};create(e){return new Vu(e)}}const sn=new qu;class Vu{type=sn;nodeParams;outputPins;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:a=>t("out",a)}]);const n=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=261.63;this.ext={generateCode:({ctx:a,inputAtoms:s})=>{let u=n.indexOf(r.note);if(u==-1)return[];let l=o*Math.pow(2,u/12),c=a.allocField("0.0"),d=new Map;return d.set("out",c),a.insertCode([`if (noteDown["${r.entity}/${r.note}"]) {`,`  ${c} = ${l};`,"} else {",`  ${c} = 0.0;`,"}"]),[{outputAtoms:d}]}}}}var Gu=B("<input class=input type=text size=8>");let Wu=class{componentType=Rt;ext={};create(e){return new Hu(e)}};const ta=new Wu;let Hu=class{type=ta;nodeParams;outputPins;ui;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ui=S(()=>()=>{let[n,o]=Ce({valueText:oe(()=>r.value.toFixed(3))});return ae(ne(()=>n.valueText,()=>{let a=Number.parseFloat(n.valueText);Number.isNaN(a)||t("value",a)},{defer:!0})),(()=>{var a=Gu();return a.$$input=s=>{o("valueText",s.currentTarget.value)},Z(()=>a.value=n.valueText),a})()}),this.ext={generateCode:({ctx:n})=>{let o=new Map;return o.set("out",`${r.value}`),[{outputAtoms:o}]}}}};be(["input"]);const Ku=q({out:Q(E)}),ra=new J({typeName:"PianoKeys",typeSchema:Ku});var Yu=B("<div class=piano>"),Ju=B("<div class=white-key>"),Xu=B("<div class=black-key>");const Zu=i=>{const e=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}],r=150,t=80;let n,o=new ct,a=new We;return(()=>{var s=Yu();s.$$pointermove=l=>{if(!o.get(l.pointerId))return;let c=n.getBoundingClientRect();o.set(l.pointerId,U.create(l.clientX-c.left,l.clientY-c.top))},s.addEventListener("pointercancel",l=>{o.delete(l.pointerId),n.releasePointerCapture(l.pointerId)}),s.$$pointerup=l=>{o.delete(l.pointerId),n.releasePointerCapture(l.pointerId)},s.$$pointerdown=l=>{let c=n.getBoundingClientRect();o.set(l.pointerId,U.create(l.clientX-c.left,l.clientY-c.top)),n.setPointerCapture(l.pointerId)};var u=n;return typeof u=="function"?he(u,s):n=s,s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","row"),s.style.setProperty("overflow-x","auto"),s.style.setProperty("user-select","none"),s.style.setProperty("touch-action","none"),W(s,I(qe,{each:e,children:l=>{let[c,d]=Y();l.type=="black"&&ae(()=>{let p=c();p!=null&&(a.add(p),ye(()=>a.delete(p)))});let f=S(()=>{let p=c();if(p==null)return!1;let g=n.getBoundingClientRect(),h=p.getBoundingClientRect();for(let y of o.values()){let m=g.left+y.x-h.left,b=g.top+y.y-h.top;if(0<m&&m<h.width&&0<b&&b<h.height){if(l.type=="white")for(let v of a){let k=v.getBoundingClientRect(),x=g.left+y.x-k.left,w=g.top+y.y-k.top;if(0<x&&x<k.width&&0<w&&w<k.height)return!1}return!0}}return!1});return ae(ne(f,p=>{p?i.onNoteOn(l.name):i.onNoteOff(l.name)},{defer:!0})),I(zr,{get children(){return[I(ut,{get when(){return l.type=="white"},get children(){var p=Ju(),g=d;return typeof g=="function"?he(g,p):d=p,p.style.setProperty("width","50px"),p.style.setProperty("pointer-events","none"),Z(h=>{var y=!!f(),m=`${r+(f()?2:0)}px`;return y!==h.e&&p.classList.toggle("pressed",h.e=y),m!==h.t&&((h.t=m)!=null?p.style.setProperty("height",m):p.style.removeProperty("height")),h},{e:void 0,t:void 0}),p}}),I(ut,{get when(){return l.type=="black"},get children(){var p=Xu(),g=d;return typeof g=="function"?he(g,p):d=p,p.style.setProperty("margin-left","-16px"),p.style.setProperty("margin-right","-14px"),p.style.setProperty("width","30px"),p.style.setProperty("pointer-events","none"),Z(h=>{var y=!!f(),m=`${t+(f()?2:0)}px`;return y!==h.e&&p.classList.toggle("pressed",h.e=y),m!==h.t&&((h.t=m)!=null?p.style.setProperty("height",m):p.style.removeProperty("height")),h},{e:void 0,t:void 0}),p}})]}})}})),s})()};be(["pointerdown","pointerup","pointermove"]);class Qu{componentType=ra;ext;constructor(){this.ext={generateInitOnceCode:({ctx:e})=>{e.insertGlobalCode(["let noteDown = {};"]),e.insertMessageHandlerCode("NoteOn",["noteDown[params.id] = true;"]),e.insertMessageHandlerCode("NoteOff",["noteDown[params.id] = false;"])}}}create(e){return new ed(e)}}const na=new Qu;class ed{type=na;nodeParams;outputPins;ui;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:s=>t("out",s)}]);let[n,o]=Y();this.ui=S(()=>()=>I(Zu,{onNoteOn:s=>{let u=n();u?.port.postMessage({type:"NoteOn",params:{id:`${e.entity}/${s}`}})},onNoteOff:s=>{let u=n();u?.port.postMessage({type:"NoteOff",params:{id:`${e.entity}/${s}`}})}}));const a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];this.ext={macro:(s,u)=>{let l=[],c=[...s.outputs.out];for(let f of c){l.push(f);for(let p=0;p<a.length-1;++p){let g=Hc(f.node,u);l.push({node:g,pin:f.pin})}}let d=0;for(let{node:f,pin:p}of l){let[g,h]=Ce({entity:e.entity,note:a[d],out:[]}),m={node:sn.create({entity:st(),state:g,setState:h}),space:()=>fe.identity,setSpace:()=>{},setRenderSizeAccessor:()=>{},setInputPinPositionMapAccessor:()=>{},setOutputPinPositionMapAccessor:()=>{},renderSize:()=>{},inputPinPositionMap:()=>{},outputPinPositionMap:()=>{}},b={id:0,inputs:{},outputs:{out:[{node:f,pin:p}]},height:0,node:m};u(b),f.inputs[p]={node:b,pin:"out"},++d,d>=a.length&&(d=0)}s.outputs.out=[]},generateCode:({ctx:s})=>{{let u=[];for(let l of a)u.push(`noteDown["${e.entity}/${l}"] = false;`);s.insertGlobalCode(u)}return[{outputAtoms:new Map}]},init:async s=>{o(s)}}}}const td=q({timeToZero:D(E),out:Q(E)}),ia=new J({typeName:"Release",typeSchema:td});class rd{componentType=ia;ext={};create(e){return new nd(e)}}const oa=new rd;class nd{type=oa;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"timeToZero",source:()=>r.timeToZero,setSource:n=>t("timeToZero",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}])}}const id=q({frequency:D(E),amplitude:D(E),centre:D(E),out:Q(E)}),aa=new J({typeName:"SawWave",typeSchema:id});class od{componentType=aa;ext={};create(e){return new ad(e)}}const sa=new od;class ad{type=sa;nodeParams;inputPins;outputPins;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>r.frequency,setSource:n=>t("frequency",n)},{name:"amplitude",source:()=>r.amplitude,setSource:n=>t("amplitude",n)},{name:"centre",source:()=>r.centre,setSource:n=>t("centre",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let s=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",l=new Map,c=n.allocField("0.0"),d=n.allocField("0.0");return n.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${d} = ${s} * ((${c} / Math.PI) - 1.0) + ${u};`,`${c} %= 2 * Math.PI;`]),l.set("out",d),[{outputAtoms:l}]}}}}var sd=B("<label><span style=color:black;padding-right:5px;>Id:</span><input class=input type=text size=8>");class ld{componentType=tn;ext={};create(e){return new cd(e)}}const la=new ld;class cd{type=la;nodeParams;inputPins;outputPins;ui;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"prev",source:()=>r.prev,setSource:n=>t("prev",n),isEffectPin:!0},{name:"value",source:()=>r.value,setSource:n=>t("value",n)}]),this.outputPins=S(()=>[{name:"next",sinks:()=>r.next,setSinks:n=>t("next",n),isEffectPin:!0}]),this.ui=S(()=>()=>(()=>{var n=sd(),o=n.firstChild,a=o.nextSibling;return a.$$input=s=>{t("id",s.currentTarget.value)},Z(()=>a.value=r.id),n})()),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let s=o.get("prev");if(s==null)return[];let u=o.get("value");if(u==null)return[];let l=`this.n_${a}_next`;n.addDeclToExistingForField(l,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),n.insertConstructorCode([`${s}.onDone.push(() => {`,`  this.insertRunningEffect(${l});`,"});",`${l}.update = () => {`,`  this.variables["${r.id}"] = ${u};`,"  return true;","};"]);let c=`${l}`,d=new Map;return d.set("next",c),[{outputAtoms:d}]}}}}be(["input"]);class ud{componentType=Zr;ext={};create(e){return new dd(e)}}const ca=new ud;class dd{type=ca;nodeParams;inputPins;outputPins;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>r.frequency,setSource:n=>t("frequency",n)},{name:"amplitude",source:()=>r.amplitude,setSource:n=>t("amplitude",n)},{name:"centre",source:()=>r.centre,setSource:n=>t("centre",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let s=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",l=new Map,c=n.allocField("0.0"),d=n.allocField("0.0");return n.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${d} = ${s} * Math.sin(${c}) + ${u};`,`${c} %= 2 * Math.PI;`]),l.set("out",d),[{outputAtoms:l}]}}}}var pd=B('<i class="fa-solid fa-volume-high">');class fd{componentType=on;ext={};create(e){return new hd(e)}}const ua=new fd;class hd{type=ua;nodeParams;inputPins;ui;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"in",source:()=>r.in,setSource:n=>t("in",n)}]),this.ui=S(()=>()=>(()=>{var n=pd();return n.style.setProperty("font-size","24px"),n.style.setProperty("color","green"),n})()),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("in");return a==null?[]:(n.insertCode([`result += ${a}`]),[{outputAtoms:new Map}])}}}}const md=q({frequency:D(E),amplitude:D(E),centre:D(E),out:Q(E)}),da=new J({typeName:"SquareWave",typeSchema:md});class gd{componentType=da;ext={};create(e){return new yd(e)}}const pa=new gd;class yd{type=pa;nodeParams;inputPins;outputPins;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>r.frequency,setSource:n=>t("frequency",n)},{name:"amplitude",source:()=>r.amplitude,setSource:n=>t("amplitude",n)},{name:"centre",source:()=>r.centre,setSource:n=>t("centre",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let s=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",l=new Map,c=n.allocField("0.0"),d=n.allocField("0.0");return n.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${d} = ${s} * (${c} < Math.PI ? -1 : 1) + ${u};`,`${c} %= 2 * Math.PI;`]),l.set("out",d),[{outputAtoms:l}]}}}}class bd{componentType=en;ext={};create(e){return new vd(e)}}const fa=new bd;class vd{type=fa;nodeParams;outputPins;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"next",sinks:()=>r.next,setSinks:n=>t("next",n),isEffectPin:!0}]),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let s=`this.n_${a}_next`;n.addDeclToExistingForField(s,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),n.insertConstructorCode([`${s}.update = () => true;`,`this.insertRunningEffect(${s});`]);let u=`${s}`,l=new Map;return l.set("next",u),[{outputAtoms:l}]}}}}var kd=B("<label><span style=color:black;padding-right:5px;>Id:</span><input class=input type=text size=8>");class wd{componentType=rn;ext={};create(e){return new xd(e)}}const ha=new wd;class xd{type=ha;nodeParams;outputPins;ui;ext;constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"value",sinks:()=>r.value,setSinks:n=>t("value",n)}]),this.ui=S(()=>()=>(()=>{var n=kd(),o=n.firstChild,a=o.nextSibling;return a.$$input=s=>{t("id",s.currentTarget.value)},Z(()=>a.value=r.id),n})()),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{n.insertConstructorCode([`this.variables["${r.id}"] = 0.0;`]);let a=`this.variables["${r.id}"]`,s=new Map;return s.set("value",a),[{outputAtoms:s}]}}}}be(["input"]);const ma=new Ro;ma.registerNodeTypes([Uo,qo,Vo,Wo,Ho,Yo,Xo,Qo,sn,ta,na,oa,sa,la,ca,ua,pa,fa,ha]);const Sd=new Xr([...Eo.componentTypes,zo,Bo,Qr,Go,an,nn,Jo,Zo,ea,Rt,ra,ia,aa,tn,Zr,on,da,en,we,rn]);var Cd=B("<div><div>"),Pd=B('<button class="btn btn-primary">Import Midi<input type=file hidden>'),_d=B("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Show Code"),Td=B("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Make Sound"),$d=B("<div><pre>");const Ed=i=>{let[e,r]=Br(i,["world"]),[t,n]=Ce({showCode:!1,makeSound:!1}),[o,a]=Y();setTimeout(()=>{let c=e.world;c.entities().length==0&&c.createEntity([Zr.create({frequency:void 0,amplitude:void 0,centre:void 0,out:[]}),we.create({transform:fe.create(U.create(50,50),pe.rot0)})])});let s=S(()=>{let c=o();if(c!=null&&(t.showCode||t.makeSound))return Kc({nodesSystem:c})});ae(ne([()=>t.makeSound,s],([c,d])=>{let f=o();if(f==null||!c||d==null)return;let p=URL.createObjectURL(new Blob([d],{type:"text/javascript"})),g=new AudioContext;(async()=>{await g.audioWorklet.addModule(p);let h=new AudioWorkletNode(g,"compiled-graph-audio-worklet-processor"),y=new Set;for(let m of f.nodes()){let b=m.node.type;y.has(b.componentType.typeName)||(y.add(b.componentType.typeName),await b.ext.initAudioCtx?.(g,h))}for(let m of f.nodes())await m.node.ext.init?.(h);h.connect(g.destination)})(),ye(()=>{(async()=>(await g.close(),URL.revokeObjectURL(p)))()})}));let[u,l]=Y();return(()=>{var c=Cd(),d=c.firstChild;return jr(c,r,!1,!0),d.style.setProperty("width","100%"),d.style.setProperty("height","100%"),d.style.setProperty("display","flex"),d.style.setProperty("flex-direction","column"),d.style.setProperty("position","relative"),W(d,I(No,{style:{"flex-grow":"1"},onInit:f=>{a(f.nodesSystem)},componentRegistry:Sd,nodeRegistry:ma,get world(){return e.world},get toolbar(){return[(()=>{var f=Pd(),p=f.firstChild,g=p.nextSibling;f.$$click=()=>{let y=u();y?.click()},g.$$input=y=>{let m=y.currentTarget.files;if(m==null||m.length!=1)return;let b=m[0];hu(e.world,b),y.currentTarget.value=""};var h=l;return typeof h=="function"?he(h,g):l=g,f})(),(()=>{var f=_d(),p=f.firstChild;return p.addEventListener("change",g=>n("showCode",g.currentTarget.checked)),Z(()=>p.checked=t.showCode),f})(),(()=>{var f=Td(),p=f.firstChild;return p.addEventListener("change",g=>n("makeSound",g.currentTarget.checked)),Z(()=>p.checked=t.makeSound),f})()]}}),null),W(d,I(ie,{get when(){return S(()=>!!t.showCode)()?s():void 0},children:f=>(()=>{var p=$d(),g=p.firstChild;return p.style.setProperty("position","absolute"),p.style.setProperty("right","0"),p.style.setProperty("top","0"),p.style.setProperty("bottom","0"),p.style.setProperty("overflow","auto"),p.style.setProperty("width","50%"),Z(()=>g.innerText=f()),p})()}),null),c})()};be(["click","input"]);const Id=""+new URL("music-audio-worklet-processor-D_ZxFmGc.js",import.meta.url).href,Rd=`attribute vec4 aVertexPosition;

uniform mat4 uModelViewMatrix;

void main(void) {
  gl_Position = uModelViewMatrix * aVertexPosition;
}
`,Md=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif

uniform float time;
uniform float uOffsetY;
uniform vec2 resolution;
uniform float uFocalLength;

float sdRoundBox(vec3 p, vec3 b, float r){
  vec3 q = abs(p) - b + r;
  return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0) - r;
}

float map(vec3 p) {
  p.x += 700.0;
  float b = 100.0*7.0/12.0;
  vec3 p3 = p;
  vec3 p2 = p;
  p.x = mod(p.x + 100.0, 200.0) - 100.0;
  float i = mod(floor((p2.x) / (2.0*b)) - 6.0,12.0);
  p2.x = mod(p2.x, b*2.0);
  bool skipB = false;
  float w = 52.0 * 200.0;
  if ( i == 0.0 || i == 2.0 ||
       i == 4.0 || i == 6.0 ||
       i == 7.0 || i == 9.0 || i == 11.0 ||
       p3.x < -0.5*w+900.0 ||
       p3.x > 0.5*w+600.0
  ) {
    skipB = true;
  }
  float d3;
  float d1 = sdRoundBox(p, vec3(100,600,100), 30.0);
  if (skipB) {
    d3 = d1;
  } else {
    d3 = min(
      d1,
      sdRoundBox(p2 + vec3(-b,-180,-150), vec3(100*7/12,420,50), 20.0)
    );
  }
  return max(d3,
    max(
      p3.x - 0.5 * w - 700.0,
      -p3.x - 0.5 * w + 700.0
    )
  );
}

bool march(vec3 ro, vec3 rd, out float t) {
  vec3 p = ro;
  t = 0.0;
  for (int i = 0; i < 20; ++i) {
    vec3 p = ro + rd*t;
    float d = map(p);
    if (abs(d) < 1.0) {
      return true;
    }
    t += d;
  }
  return false;
}

vec3 normal(vec3 p) {
  float d = 0.001;
  float mp = map(p);
  float dx = map(p + vec3(d,0,0)) - mp;
  float dy = map(p + vec3(0,d,0)) - mp;
  float dz = map(p + vec3(0,0,d)) - mp;
  return normalize(vec3(dx,dy,dz));
}

void main(void) {
  float fl = uFocalLength;
  float d = 52.0 * 200.0 * fl / resolution.x;
  float mx = max(resolution.x, resolution.y);
  vec2 uv = gl_FragCoord.xy / mx;
  vec3 w = normalize(vec3(0, -1, 3));
  vec3 ro = w * d + vec3(0.0, -600.0, 50.0);
  vec3 u = normalize(cross(vec3(0,1,0),w));
  vec3 v = cross(w,u);
  vec3 rd = normalize(
    (gl_FragCoord.x - 0.5 * resolution.x) * u +
    (gl_FragCoord.y - 0.5 * resolution.y) * v +
    -fl * w
  );
  ro -= uOffsetY * v;
  float t = 0.0;
  bool hit = march(ro, rd, t);
  if (!hit) {
    gl_FragColor = vec4(0.2, 0.2, 0.2, 1.0);
    return;
  }
  vec3 p = ro + rd*t;
  vec3 n = normal(p);
  float s = dot(n,normalize(vec3(1,1,1))) + 0.2;
  if (p.z > 101.0) {
    s *= 0.5;
  }
  gl_FragColor = vec4(s,s,s,1.0);
}
`;var Ad=B('<div><div><button class="btn btn-primary">Import Midi</button><input type=file hidden><button class="btn btn-primary">Run</button></div><div><canvas>');const Nd=50,Yt=1e4,Od=i=>{let[e,r]=Y(),[t,n]=Y(),[o,a]=Y();xe(ne([e,t],([h,y])=>{if(h==null||y==null)return;let m=h.getBoundingClientRect();y.width=m.width*window.devicePixelRatio,y.height=m.height*window.devicePixelRatio,y.style.setProperty("width",`${m.width}px`),y.style.setProperty("height",`${m.height}px`),a(y.getContext("webgl")??void 0)}));let s=S(ne([o,t],([h,y])=>{if(h!=null&&y!=null)return Ld(h,y)})),[u,l]=Y(),c=!1,d=!0,f=0,p=h=>{let y=o();if(y==null)return;let m=s();if(m==null||(d&&(f=h,d=!1),!c))return;let b=h-f;m.time=b,jd(m),zd(y,m),requestAnimationFrame(p)},g=async()=>{let h=s();if(h==null)return;let[y,m]=await qd(),b=[],v=h.notesHead,k=0;for(;v!=null;){let x=k++;b.push({id:x,time:v.startTime*.001,note:v.note,type:"On"}),b.push({id:x,time:(v.startTime+v.holdTime)*.001,note:v.note,type:"Off"}),v=v.next}b.sort((x,w)=>{let C=x.time-w.time;return C!=0||(C=x.note-w.note,C!=0)?C:x.type==w.type?0:x.type=="Off"?-1:1}),m.port.postMessage({type:"musicData",params:{noteEvents:b}}),c=!0,d=!0,requestAnimationFrame(p)};return(()=>{var h=Ad(),y=h.firstChild,m=y.firstChild,b=m.nextSibling,v=b.nextSibling,k=y.nextSibling,x=k.firstChild;h.style.setProperty("flex-grow","1"),h.style.setProperty("display","flex"),h.style.setProperty("flex-direction","column"),h.style.setProperty("overflow","hidden"),m.$$click=()=>{u()?.click()},b.addEventListener("change",T=>{let $=s();if($==null)return;let _=T.currentTarget.files;if(_==null||_.length==0)return;let M=_[0];Fd($,M),T.currentTarget.value=""});var w=l;typeof w=="function"?he(w,b):l=b,v.$$click=()=>g();var C=r;typeof C=="function"?he(C,k):r=k,k.style.setProperty("flex-grow","1");var P=n;return typeof P=="function"?he(P,x):n=x,h})()};async function Fd(i,e){let r=new Lo.Midi(await e.arrayBuffer()),t=[];for(let n of r.tracks){let o=Bd();for(let a of n.notes){let s={startTime:a.time*1e3,holdTime:a.duration*1e3,note:a.midi,colourR:o.r,colourG:o.g,colourB:o.b,colourA:1,isAlive:!1,prev:void 0,next:void 0};s.prev=s,t.push(s)}}t.sort((n,o)=>n.startTime-o.startTime);for(let n of t)Dd(i,n)}function Dd(i,e){if(i.notesHead==null)i.notesHead=i.notesTail=e;else{let r=i.notesTail;r.next=e,e.prev=r,i.notesTail=e}}function jd(i){let e=i.time-i.height/i.fallSpeed,r=i.time,t=i.visibleNotesEnd?.next??i.notesHead;for(;t!=null&&!(t.startTime>=r);)i.visibleNotesEnd==null?i.visibleNotesStart=i.visibleNotesEnd=t:i.visibleNotesEnd=t,i.numVisibleNotes++,t=t.next;for(t=i.visibleNotesStart;;){if(t==null){i.numVisibleNotes=0,i.visibleNotesStart=i.visibleNotesEnd=void 0;break}if(t.startTime+t.holdTime<=e){i.numVisibleNotes--,t=t.next,i.visibleNotesStart=t;continue}break}}function Ld(i,e){const r=.5*e.height/Math.tan(.5*Nd*Math.PI/180);let t={width:e.width,height:e.height,time:0,fallSpeed:.5,maxNotes:Yt,numNotes:0,notesVertices:new Float32Array(Yt*8*6),notesGLVertexBuffer:i.createBuffer(),notesHead:void 0,notesTail:void 0,freeNotesHead:void 0,freeNotesTail:void 0,visibleNotesStart:void 0,visibleNotesEnd:void 0,numVisibleNotes:0,program:void 0,positionLocation:-1,colourLocation:-1,textureCoordLocation:-1,pianoVertices:new Float32Array(12),pianoGLVertexBuffer:i.createBuffer(),pianoProgram:void 0,pianoPositionLocation:-1};for(let y=0,m=0;y<Yt;++y)t.notesVertices[m+6]=0,t.notesVertices[m+7]=0,m+=8,t.notesVertices[m+6]=1,t.notesVertices[m+7]=0,m+=8,t.notesVertices[m+6]=1,t.notesVertices[m+7]=1,m+=8,t.notesVertices[m+6]=0,t.notesVertices[m+7]=0,m+=8,t.notesVertices[m+6]=1,t.notesVertices[m+7]=1,m+=8,t.notesVertices[m+6]=0,t.notesVertices[m+7]=1,m+=8;const a=gi(i,`
    attribute vec4 aVertexPosition;
    attribute vec4 aColour;
    attribute vec2 aTextureCoord;

    uniform mat4 uModelViewMatrix;

    varying highp vec4 vColour;
    varying highp vec2 vTextureCoord;

    void main(void) {
        gl_Position = uModelViewMatrix * aVertexPosition;
        vTextureCoord = aTextureCoord;
        vColour = aColour;
    }
  `,`
    varying highp vec4 vColour;
    varying highp vec2 vTextureCoord;

    void main(void) {
        gl_FragColor = vColour;
    }
  `);if(a==null)return;const s=gi(i,Rd,Md);if(s==null)return;t.program=a,t.pianoProgram=s,i.useProgram(a);const u=i.getUniformLocation(a,"uModelViewMatrix");function l(y,m,b,v){var k=-1,x=1,w=m-y,C=v-b,P=x-k;return[2/w,0,0,0,0,2/C,0,0,0,0,-2/P,0,-(m+y)/w,-(v+b)/C,-(x+k)/P,1]}const c=new Float32Array(l(0,t.width,0,t.height));i.uniformMatrix4fv(u,!1,c),t.positionLocation=i.getAttribLocation(a,"aVertexPosition"),t.colourLocation=i.getAttribLocation(a,"aColour"),t.textureCoordLocation=i.getAttribLocation(a,"aTextureCoord"),i.bindBuffer(i.ARRAY_BUFFER,t.notesGLVertexBuffer),i.bufferData(i.ARRAY_BUFFER,t.notesVertices,i.DYNAMIC_DRAW),i.vertexAttribPointer(t.positionLocation,2,i.FLOAT,!1,8*4,0*4),i.vertexAttribPointer(t.colourLocation,4,i.FLOAT,!1,8*4,4*4),i.vertexAttribPointer(t.textureCoordLocation,2,i.FLOAT,!1,8*4,6*4),i.useProgram(s);const d=i.getUniformLocation(s,"uModelViewMatrix");i.uniformMatrix4fv(d,!1,c);const f=i.getUniformLocation(s,"uFocalLength");i.uniform1f(f,r);const p=i.getUniformLocation(s,"resolution"),g=i.getUniformLocation(s,"uOffsetY");let h;{let y=10400*r/t.width,m=-1,b=3,v=Math.sqrt(m*m+b*b);m/=v,b/=v;let k=b,x=-m,w=m*y-600,C=b*y+50,P=(-600-w)*-m+(-50-C)*-b,T=P*-.5*t.height/r,$=P,_=T+1200*k+400*-m,M=$+1200*x+400*-b,L=T+200*-m,O=T*r/$,R=_*r/M;h=Math.abs(R-O),i.uniform1f(g,L)}return i.uniform2f(p,t.width,t.height),t.pianoPositionLocation=i.getAttribLocation(s,"aVertexPosition"),t.pianoVertices[0]=0,t.pianoVertices[1]=0,t.pianoVertices[2]=t.width,t.pianoVertices[3]=0,t.pianoVertices[4]=t.width,t.pianoVertices[5]=h,t.pianoVertices[6]=0,t.pianoVertices[7]=0,t.pianoVertices[8]=t.width,t.pianoVertices[9]=h,t.pianoVertices[10]=0,t.pianoVertices[11]=h,i.bindBuffer(i.ARRAY_BUFFER,t.pianoGLVertexBuffer),i.bufferData(i.ARRAY_BUFFER,t.pianoVertices,i.DYNAMIC_DRAW),i.vertexAttribPointer(t.pianoPositionLocation,2,i.FLOAT,!1,0,0),i.viewport(0,0,e.width,e.height),t}function zd(i,e){if(e.program==null||e.pianoProgram==null)return;let r=0,t=e.visibleNotesStart,n=0,o=e.width/88;for(i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT);t!=e.visibleNotesEnd?.next&&t!=null;){let a=0;for(;t!=e.visibleNotesEnd?.next&&t!=null;){let s=n+(t.note-21)*o,u=e.height-(e.time-t.startTime)*e.fallSpeed,l=s+o,c=u,d=l,f=c+t.holdTime*e.fallSpeed,p=s,g=f;if(e.notesVertices[r+0]=s,e.notesVertices[r+1]=u,e.notesVertices[r+2]=t.colourR,e.notesVertices[r+3]=t.colourG,e.notesVertices[r+4]=t.colourB,e.notesVertices[r+5]=t.colourA,r+=8,e.notesVertices[r+0]=l,e.notesVertices[r+1]=c,e.notesVertices[r+2]=t.colourR,e.notesVertices[r+3]=t.colourG,e.notesVertices[r+4]=t.colourB,e.notesVertices[r+5]=t.colourA,r+=8,e.notesVertices[r+0]=d,e.notesVertices[r+1]=f,e.notesVertices[r+2]=t.colourR,e.notesVertices[r+3]=t.colourG,e.notesVertices[r+4]=t.colourB,e.notesVertices[r+5]=t.colourA,r+=8,e.notesVertices[r+0]=s,e.notesVertices[r+1]=u,e.notesVertices[r+2]=t.colourR,e.notesVertices[r+3]=t.colourG,e.notesVertices[r+4]=t.colourB,e.notesVertices[r+5]=t.colourA,r+=8,e.notesVertices[r+0]=d,e.notesVertices[r+1]=f,e.notesVertices[r+2]=t.colourR,e.notesVertices[r+3]=t.colourG,e.notesVertices[r+4]=t.colourB,e.notesVertices[r+5]=t.colourA,r+=8,e.notesVertices[r+0]=p,e.notesVertices[r+1]=g,e.notesVertices[r+2]=t.colourR,e.notesVertices[r+3]=t.colourG,e.notesVertices[r+4]=t.colourB,e.notesVertices[r+5]=t.colourA,r+=8,t=t.next,++a,a>=Yt)break}a!=null&&(i.useProgram(e.program),i.bindBuffer(i.ARRAY_BUFFER,e.notesGLVertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,e.notesVertices.subarray(0,a*8*6)),i.vertexAttribPointer(e.positionLocation,2,i.FLOAT,!1,8*4,0*4),i.vertexAttribPointer(e.colourLocation,4,i.FLOAT,!1,8*4,4*4),i.vertexAttribPointer(e.textureCoordLocation,2,i.FLOAT,!1,8*4,6*4),i.enableVertexAttribArray(e.positionLocation),i.enableVertexAttribArray(e.colourLocation),i.enableVertexAttribArray(e.textureCoordLocation),i.drawArrays(i.TRIANGLES,0,a*6),i.disableVertexAttribArray(e.positionLocation),i.disableVertexAttribArray(e.colourLocation),i.disableVertexAttribArray(e.textureCoordLocation))}i.useProgram(e.pianoProgram),i.bindBuffer(i.ARRAY_BUFFER,e.pianoGLVertexBuffer),i.vertexAttribPointer(e.pianoPositionLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(e.pianoPositionLocation),i.drawArrays(i.TRIANGLES,0,6),i.disableVertexAttribArray(e.pianoPositionLocation)}function mi(i,e,r){const t=i.createShader(e);if(t!=null){if(i.shaderSource(t,r),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS)){console.error("An error occurred compiling the shaders: "+i.getShaderInfoLog(t)),i.deleteShader(t);return}return t}}function gi(i,e,r){const t=mi(i,i.VERTEX_SHADER,e),n=mi(i,i.FRAGMENT_SHADER,r);if(t==null||n==null)return;const o=i.createProgram();if(i.attachShader(o,t),i.attachShader(o,n),i.linkProgram(o),!i.getProgramParameter(o,i.LINK_STATUS)){console.error("Unable to initialize the shader program: "+i.getProgramInfoLog(o));return}return o}function Ud(i,e,r){let t,n,o;const a=Math.floor(i*6),s=i*6-a,u=r*(1-e),l=r*(1-s*e),c=r*(1-(1-s)*e);switch(a%6){case 0:t=r,n=c,o=u;break;case 1:t=l,n=r,o=u;break;case 2:t=u,n=r,o=c;break;case 3:t=u,n=l,o=r;break;case 4:t=c,n=u,o=r;break;case 5:t=r,n=u,o=l;break;default:t=0,n=0,o=0;break}return{r:t,g:n,b:o}}function Bd(){const i=Math.random(),e=Math.random()*(1-.7)+.7;return Ud(i,e,1)}async function qd(){let i=new AudioContext;await i.audioWorklet.addModule(Id);let e=new AudioWorkletNode(i,"music-audio-worklet-processor");return Vd(i,e),e.connect(i.destination),[i,e]}let Vd=async(i,e)=>{const t=await fetch("./Thurston Waffles.sf2").then(g=>g.arrayBuffer()),n=new Ko.SoundFont2(new Uint8Array(t)),o=n.presets[0];if(!o)throw new Error("Preset at index 0 not found.");const a=n.instruments[o.header.bagIndex];if(!a)throw new Error("No instrument found for preset at index 0");const s=(g,h)=>{for(const y of g.zones)if(y.keyRange!=null&&h>=y.keyRange.lo&&h<=y.keyRange.hi)return y.sample;return null};let u=60;const l=s(a,u);if(!l)throw new Error(`No sample found for note ${u} in preset 0.`);const c=l.header.sampleRate,d=l.data.length,f=new Float32Array(d);for(let g=0;g<d;g++)f[g]=l.data[g]/32768;const p=l.header.originalPitch;e.port.postMessage({type:"meowData",params:{meowOriginalPitch:p,meowSampleRate:c,meowData:f}})};be(["click"]);var Gd=B('<div><div role=tablist class="tabs tabs-box">'),Wd=B("<a role=tab class=tab>");const Hd=i=>{const e=["Piano Keys","Waterfall","Instrument Editor"];let[r,t]=Ce({selectedTab:"Piano Keys"}),n=new tc;n.init();let o=new dt;return(()=>{var a=Gd(),s=a.firstChild;return a.style.setProperty("flex-grow","1"),a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("overflow","hidden"),W(s,()=>e.map(u=>oe(()=>(()=>{var l=Wd();return l.$$click=()=>{t("selectedTab",u)},W(l,u),Z(()=>l.classList.toggle("tab-active",r.selectedTab==u)),l})()))),W(a,I(zr,{get children(){return[I(ut,{get when(){return r.selectedTab=="Piano Keys"},get children(){return I(fc,{onNoteOn:u=>n.noteOn(u),onNoteOff:u=>n.noteOff(u)})}}),I(ut,{get when(){return r.selectedTab=="Waterfall"},get children(){return I(Od,{})}}),I(ut,{get when(){return r.selectedTab=="Instrument Editor"},get children(){return I(Ed,{style:{"flex-grow":"1"},world:o})}})]}}),null),a})()};be(["click"]);const Kd=q({radius:D(E),out:Q(E)}),ga=new J({typeName:"Sphere",typeSchema:Kd});var Yd=Object.defineProperty,Jd=(i,e)=>{for(var r in e)Yd(i,r,{get:e[r],enumerable:!0})},yi=new WeakMap;function Xd(i){if(i instanceof WebGL2RenderingContext)return i;const e=yi.get(i);if(e)return e;const r=i.getExtension("ANGLE_instanced_arrays");if(!r)return;const t={drawArraysInstanced:r.drawArraysInstancedANGLE.bind(r),drawElementsInstanced:r.drawElementsInstancedANGLE.bind(r),vertexAttribDivisor:r.vertexAttribDivisorANGLE.bind(r)};return yi.set(i,t),t}var bi=new WeakMap;function Zd(i){if(i instanceof WebGL2RenderingContext)return i;const e=bi.get(i);if(e)return e;const r=i.getExtension("OES_vertex_array_object");if(!r)return null;const t={bindVertexArray:r.bindVertexArrayOES.bind(r),createVertexArray:r.createVertexArrayOES.bind(r),deleteVertexArray:r.deleteVertexArrayOES.bind(r)};return bi.set(i,t),t}var rt={};Jd(rt,{forEach:()=>ya,map:()=>Qd});function ya(i,e){let r=0;for(const t in i)e(i[t],t,r),r++;for(const t of Object.getOwnPropertySymbols(i))e(i[t],t,r),r++}function Qd(i,e){const r={};return ya(i,(t,n,o)=>{r[n]=e(t,n,o)}),r}function tr(i,e){if(i==null)throw new Error(e);return i}function vi(i,e,r){const t=i.createShader(e);if(!t)throw new Error("Failed to create shader");if(i.shaderSource(t,r),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS)){const n=i.getShaderInfoLog(t);throw i.deleteShader(t),new Error(`Failed to compile ${e===i.VERTEX_SHADER?"vertex":"fragment"} shader: ${n}`)}return t}function ep(i,e,r){const t=i.createProgram();if(!t)throw new Error("Failed to create WebGL program");const n=vi(i,i.VERTEX_SHADER,e),o=vi(i,i.FRAGMENT_SHADER,r);if(i.attachShader(t,n),i.attachShader(t,o),i.linkProgram(t),!i.getProgramParameter(t,i.LINK_STATUS)){const a=i.getProgramInfoLog(t);throw i.deleteProgram(t),i.deleteShader(n),i.deleteShader(o),new Error(`Failed to link program: ${a}`)}return i.deleteShader(n),i.deleteShader(o),t}var tp=i=>{switch(i[0]){case"m":return"Matrix"+i.slice(3)+"fv";case"s":case"b":case"i":return(i.match(/\d/)?.[0]??"1")+"i";case"u":return(i[4]||"1")+"ui";case"v":return i[3]+"f";default:switch(i){case"float":return"1f";case"uint":return"1ui";default:return"1i"}}},ba=i=>{switch(i[0]){case"m":const[e,r]=i.match(/\d+/g).map(Number);return e*(r??e);case"v":case"i":case"b":case"u":const t=i.match(/\d/);return t?+t[0]:1;default:return 1}},rp=i=>i.includes("mat"),np=i=>i.includes("sampler");function ip(i){const e=new(i??Map);return Object.assign(e,{getOrInsert(r,t){let n=e.get(r);return n||(n=t(),e.set(r,n),n)}})}var op=0,ap="VIEW_GL_ALIAS",sp=navigator.userAgent.toLowerCase().indexOf("firefox")>=0,lp=ip(sp?Map:WeakMap);function Qe(i){return typeof i=="string"?i:typeof i=="symbol"?lp.getOrInsert(i,()=>`${ap}_${op++}`):i.toString()}function cp(i,e,r,t){return{uniforms:r.uniforms?up(i,e,r.uniforms):void 0,attributes:r.attributes?dp(i,e,r.attributes,t):void 0,interleavedAttributes:r.interleavedAttributes?pp(i,e,r.interleavedAttributes,t):void 0,buffers:r.buffers?fp(i,r.buffers):void 0}}function up(i,e,r){return rt.map(r,({kind:t,size:n},o)=>{const a=Qe(o),s=i.getUniformLocation(e,a);if(np(t))return{set(c){i.uniform1i(s,c)}};const u=`uniform${tp(t)}${n?"v":""}`,l=i[u].bind(i);return rp(t)?{set(...c){l(s,!1,c[0])}}:{set(...c){l(s,...c)}}})}function va(i,e,r,t,n,o,a){i.enableVertexAttribArray(e),i.vertexAttribPointer(e,r,i[o],!1,t,n),a&&tr(Xd(i)).vertexAttribDivisor(e,1)}function dp(i,e,r,{signal:t}={}){const n=rt.map(r,({kind:o,instanced:a,buffer:s=tr(i.createBuffer())},u)=>{const l=Qe(u),c=i.getAttribLocation(e,l);if(c<0)throw new Error(`Attribute '${l}' not found`);const d=ba(o),f=o.startsWith("i")?"INT":"FLOAT";return{buffer:s,bind(){i.bindBuffer(i.ARRAY_BUFFER,s),va(i,c,d,0,0,f,a)},dispose(){i.deleteBuffer(s)},set(p,g="STATIC_DRAW"){return i.bindBuffer(i.ARRAY_BUFFER,s),i.bufferData(i.ARRAY_BUFFER,p,i[g]),this}}});return t?.addEventListener("abort",function(){rt.forEach(n,a=>a.dispose())}),n}function pp(i,e,r,{signal:t}={}){const n=rt.map(r,({layout:o,instanced:a})=>{let s=0;const u=o.map(p=>{const g=Qe(p.key),h=i.getAttribLocation(e,g);if(h<0)throw new Error(`Attribute '${g}' not found`);const y=ba(p.kind),m=s,b=p.kind.startsWith("i")?"INT":"FLOAT";return s+=y*4,()=>va(i,h,y,l,m,b,a)}),l=s,c=tr(i.createBuffer());let d;const f=Zd(i);if(f){const p=f.createVertexArray();f.bindVertexArray(p),i.bindBuffer(i.ARRAY_BUFFER,c);for(const g of u)g();f.bindVertexArray(null),d={unbind(){f.bindVertexArray(null)},bind(){f.bindVertexArray(p)},dispose(){f.deleteVertexArray(p)}}}return{bind(){if(i.bindBuffer(i.ARRAY_BUFFER,c),d)d.bind();else for(const p of u)p()},unbind(){d&&d.unbind()},dispose(){i.deleteBuffer(c),d&&d.dispose()},set(p,g="STATIC_DRAW"){d?d.bind():i.bindBuffer(i.ARRAY_BUFFER,c),i.bufferData(i.ARRAY_BUFFER,p,i[g]),d&&d.unbind()}}});return t?.addEventListener("abort",function(){rt.forEach(n,a=>a.dispose())}),n}function fp(i,e,{signal:r}={}){const t=rt.map(e,({target:n="ARRAY_BUFFER",usage:o="STATIC_DRAW"})=>{const a=tr(i.createBuffer());return{bind(){i.bindBuffer(i[n],a)},dispose(){i.deleteBuffer(a)},set(s){i.bindBuffer(i[n],a),i.bufferData(i[n],s,i[o])}}});return r?.addEventListener("abort",function(){rt.forEach(t,o=>o.dispose())}),t}function ee(i,...e){return{template:i,slots:e,type:"glsl"}}var ln=new Proxy({},{get(i,e){return typeof e=="symbol"?i[e]:(r,t)=>({type:"uniform",key:r,kind:e,...t})}});new Proxy({},{get(i,e){return typeof e=="symbol"?i[e]:(r,t)=>({type:"attribute",key:r,kind:e,...t})}});function ze(i,e,r,t){const n=ki(e),o=ki(r),a={uniforms:{...n.schema.uniforms,...o.schema.uniforms},attributes:{...n.schema.attributes,...o.schema.attributes},interleavedAttributes:{...n.schema.interleavedAttributes,...o.schema.interleavedAttributes}};for(const u in t){const l=a[u],c=t[u];for(const d in c)l[d]={...l[d],...c[d]}}const s=ep(i,n.template,o.template);return{program:s,schema:a,view:cp(i,s,a),vertex:n.template,fragment:o.template}}function ki(i){return{template:ze.toString(i),schema:ze.toSchema(i)}}ze.toSchema=function(i){const e={uniforms:{},attributes:{},interleavedAttributes:{}};function r(t){if(Array.isArray(t)){t.forEach(r);return}if(typeof t!="object")return;if(t.type==="glsl"){const{uniforms:s,attributes:u,interleavedAttributes:l}=ze.toSchema(t);e.uniforms={...e.uniforms,...s},e.attributes={...e.attributes,...u},e.interleavedAttributes={...e.interleavedAttributes,...l};return}const{key:n,type:o,...a}=t;e[`${o}s`][n]=a}return i.slots.forEach(r),e};ze.toString=function({template:[i,...e],slots:r}){const t=!!i?.startsWith("#version 300 es");let n=i??"";for(let o=0;o<e.length;o++)n+=`${ka(r[o],t)}${e[o]}`;return n};function ka(i,e){return typeof i!="object"?Qe(i):Array.isArray(i)?i.map(r=>ka(r,e)).join(""):i.type==="glsl"?ze.toString(i):i.type==="interleavedAttribute"?i.layout.reduce((r,t)=>e?`${r}in ${t.kind} ${Qe(t.key)};
`:`${r}attribute ${t.kind} ${Qe(t.key)};
`,""):i.type==="uniform"&&"size"in i?`${i.type} ${i.kind} ${Qe(i.key)}[${i.size}];`:`${i.type==="attribute"&&e?"in":i.type} ${i.kind} ${Qe(i.key)};`}class hp{componentType=ga;ext={};create(e){return new mp(e)}}const wa=new hp;class mp{type=wa;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"radius",source:()=>r.radius,setSource:n=>t("radius",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let s=a.value,u=n.allocVar();return n.insertGlobalCode(ee`
        float ${u}(vec3 p) {
          return length(p) - ${s};
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:"defaultColour"}}]])}}}const gp=q({value:Le(),out:Q(E)}),xa=new J({typeName:"Number",typeSchema:gp});var yp=B("<input class=input type=text size=8>");class bp{componentType=xa;ext={};create(e){return new vp(e)}}const Sa=new bp;class vp{type=Sa;nodeParams;outputPins;ui;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ui=S(()=>()=>{let[n,o]=Ce({valueText:oe(()=>r.value.toFixed(3))});return ae(ne(()=>n.valueText,()=>{let a=Number.parseFloat(n.valueText);Number.isNaN(a)||t("value",a)},{defer:!0})),(()=>{var a=yp();return a.$$input=s=>{o("valueText",s.currentTarget.value)},Z(()=>a.value=n.valueText),a})()}),this.ext.generateCode=({ctx:n,inputs:o})=>new Map([["out",{type:"Atom",value:kp(r.value)}]])}}function kp(i){let e=i.toString();return!e.includes(".")&&!e.includes("e")&&!e.includes("E")&&(e+=".0"),e}be(["input"]);const wp=q({visible:To(!0,hc()),in:D(E)}),Ca=new J({typeName:"Display",typeSchema:wp});var xp=Object.defineProperty,Sp=(i,e)=>{for(var r in e)xp(i,r,{get:e[r],enumerable:!0})},Pa={};Sp(Pa,{forEach:()=>_a,map:()=>Cp});function _a(i,e){let r=0;for(const t in i)e(i[t],t,r),r++;for(const t of Object.getOwnPropertySymbols(i))e(i[t],t,r),r++}function Cp(i,e){const r={};return _a(i,(t,n,o)=>{r[n]=e(t,n,o)}),r}var Pp=i=>{switch(i[0]){case"m":return"Matrix"+i.slice(3)+"fv";case"s":case"b":case"i":return(i.match(/\d/)?.[0]??"1")+"i";case"u":return(i[4]||"1")+"ui";case"v":return i[3]+"f";default:switch(i){case"float":return"1f";case"uint":return"1ui";default:return"1i"}}},_p=i=>i.includes("mat"),Tp=i=>i.includes("sampler");function $p(i){const e=new(i??Map);return Object.assign(e,{getOrInsert(r,t){let n=e.get(r);return n||(n=t(),e.set(r,n),n)}})}var Ep=0,Ip="VIEW_GL_ALIAS",Rp=navigator.userAgent.toLowerCase().indexOf("firefox")>=0,Mp=$p(Rp?Map:WeakMap);function Ap(i){return typeof i=="string"?i:typeof i=="symbol"?Mp.getOrInsert(i,()=>`${Ip}_${Ep++}`):i.toString()}function cn(i,e,r){return Pa.map(r,({kind:t,size:n},o)=>{const a=Ap(o),s=i.getUniformLocation(e,a);if(Tp(t))return{set(c){i.uniform1i(s,c)}};const u=`uniform${Pp(t)}${n?"v":""}`,l=i[u].bind(i);return _p(t)?{set(...c){l(s,!1,c[0])}}:{set(...c){l(s,...c)}}})}var Np=B('<div class="bg-base-200 mt-2 mb-2"><label class=label><input class="checkbox checkbox-sm pl-2"type=checkbox>Visible'),Op=B('<i class="fa-solid fa-desktop">');class Fp{componentType=Ca;ext={};create(e){return new Dp(e)}}const Ta=new Fp;class Dp{type=Ta;nodeParams;inputPins;ui;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"in",source:()=>r.in,setSource:n=>t("in",n)}]),this.ui=S(()=>()=>[(()=>{var n=Np(),o=n.firstChild,a=o.firstChild;return a.addEventListener("change",s=>{t("visible",s.currentTarget.checked)}),Z(()=>a.checked=r.visible),n})(),(()=>{var n=Op();return n.style.setProperty("font-size","24px"),n.style.setProperty("color","green"),n})()]),this.ext.generateCode=({ctx:n,inputs:o,onInit:a})=>{let s=o.get("in");if(s?.type!="Model")return;let u=s.value,{sdfFuncName:l,colourFuncName:c}=u,d=n.allocVar(),f=ee`
        ${ln.bool(d)}
      `;n.insertGlobalCode(f),n.insertCode(ee`
        if (${d}) {
          d = min(d, ${l}(p));
        }
      `);let p=n.allocVar();return n.insertColourCode(ee`
        if (${d}) {
          float ${p} = ${l}(p);
          if (${p} < d) {
            d = ${p};
            ${c}(p, c);
          }
        }
      `),a(({gl:g,program:h,rerender:y})=>{let m=cn(g,h,ze.toSchema(f).uniforms);xe(ne(()=>r.visible,b=>{m[d].set(b?1:0),y()}))}),new Map}}}const jp=q({x:D(E),y:D(E),z:D(E),out:Q(E)}),$a=new J({typeName:"Vec3",typeSchema:jp});class Lp{componentType=$a;ext={};create(e){return new zp(e)}}const Ea=new Lp;class zp{type=Ea;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"x",source:()=>r.x,setSource:n=>t("x",n)},{name:"y",source:()=>r.y,setSource:n=>t("y",n)},{name:"z",source:()=>r.z,setSource:n=>t("z",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("x"),s=o.get("y"),u=o.get("z"),l,c,d;return a?.type=="Atom"?l=a.value:l="0.0",s?.type=="Atom"?c=s.value:c="0.0",u?.type=="Atom"?d=u.value:d="0.0",new Map([["out",{type:"Atom",value:`vec3(${l}, ${c}, ${d})`}]])}}}const Up=q({model:D(E),offset:D(E),out:Q(E)}),Ia=new J({typeName:"Translate",typeSchema:Up});class Bp{componentType=Ia;ext={};create(e){return new qp(e)}}const Ra=new Bp;class qp{type=Ra;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>r.model,setSource:n=>t("model",n)},{name:"offset",source:()=>r.offset,setSource:n=>t("offset",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("offset");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(ee`
        float ${c}(vec3 p) {
          return ${s.sdfFuncName}(p - ${l});
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ee`
        void ${d}(vec3 p, out vec4 c) {
          ${s.colourFuncName}(p - ${l}, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const Vp=q({size:D(E),out:Q(E)}),Ma=new J({typeName:"Box",typeSchema:Vp});class Gp{componentType=Ma;ext={};create(e){return new Wp(e)}}const Aa=new Gp;class Wp{type=Aa;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"size",source:()=>r.size,setSource:n=>t("size",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("size");if(a?.type!="Atom")return;let s=a.value,u=n.allocVar();return n.insertGlobalCode(ee`
        float ${u}(vec3 p) {
          vec3 q = abs(p) - 0.5 * ${s};
          return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:"defaultColour"}}]])}}}const Hp=q({model1:D(E),model2:D(E),k:D(E),out:Q(E)}),Na=new J({typeName:"Union",typeSchema:Hp});class Kp{componentType=Na;ext={};create(e){return new Yp(e)}}const Oa=new Kp;class Yp{type=Oa;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model1",source:()=>r.model1,setSource:n=>t("model1",n)},{name:"model2",source:()=>r.model2,setSource:n=>t("model2",n)},{name:"k",source:()=>r.k,setSource:n=>t("k",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let s=a.value,u=o.get("model2");if(u?.type!="Model")return;let l=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let d=n.allocVar();if(c?.type=="Atom"){let p=c.value;n.insertGlobalCode(ee`
          float ${d}(vec3 p) {
            float k = ${p} * 4.0;
            float d1 = ${s.sdfFuncName}(p);
            float d2 = ${l.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return min(d1, d2) - h*h*0.25/k;
          }
        `)}else n.insertGlobalCode(ee`
          float ${d}(vec3 p) {
            return min(${s.sdfFuncName}(p), ${l.sdfFuncName}(p));
          }
        `);let f=n.allocVar();return n.insertGlobalCode(ee`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${s.sdfFuncName}(p);
          float d2 = ${l.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${s.colourFuncName}(p, c1);
          ${l.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:d,colourFuncName:f}}]])}}}const Jp=q({model1:D(E),model2:D(E),k:D(E),out:Q(E)}),Fa=new J({typeName:"Difference",typeSchema:Jp});class Xp{componentType=Fa;ext={};create(e){return new Zp(e)}}const Da=new Xp;class Zp{type=Da;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model1",source:()=>r.model1,setSource:n=>t("model1",n)},{name:"model2",source:()=>r.model2,setSource:n=>t("model2",n)},{name:"k",source:()=>r.k,setSource:n=>t("k",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let s=a.value,u=o.get("model2");if(u?.type!="Model")return;let l=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let d=n.allocVar();if(c?.type=="Atom"){let p=c.value;n.insertGlobalCode(ee`
          float ${d}(vec3 p) {
            float k = ${p} * 4.0;
            float d1 = -${s.sdfFuncName}(p);
            float d2 = ${l.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return -(min(d1, d2) - h*h*0.25/k);
          }
        `)}else n.insertGlobalCode(ee`
          float ${d}(vec3 p) {
            return -min(-${s.sdfFuncName}(p), ${l.sdfFuncName}(p));
          }
        `);let f=n.allocVar();return n.insertGlobalCode(ee`
        void ${f}(vec3 p, out vec4 c) {
          float d1 = ${s.sdfFuncName}(p);
          float d2 = ${l.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${s.colourFuncName}(p, c1);
          ${l.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:d,colourFuncName:f}}]])}}}const Qp=q({model:D(E),step:D(E),out:Q(E)}),ja=new J({typeName:"Repeat",typeSchema:Qp});class ef{componentType=ja;ext={};create(e){return new tf(e)}}const La=new ef;class tf{type=La;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>r.model,setSource:n=>t("model",n)},{name:"step",source:()=>r.step,setSource:n=>t("step",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("step");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(ee`
        float ${c}(vec3 p) {
          vec3 s = ${l};
          vec3 id = vec3(floor(p.x/s.x + 0.5),floor(p.y/s.y + 0.5),floor(p.z/s.z + 0.5));
          vec3  o = sign(p-s*id);
          float d = 1e20;
          for( int k=0; k<2; k++ )
          for( int j=0; j<2; j++ )
          for( int i=0; i<2; i++ )
          {
            vec3 rid = id + vec3(i,j,k)*o;
            vec3 r = p - s*rid;
            d = min( d, ${s.sdfFuncName}(r));
          }
          return d;
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ee`
        void ${d}(vec3 p, out vec4 c) {
          vec3 s = ${l};
          vec3 id = vec3(floor(p.x/s.x + 0.5),floor(p.y/s.y + 0.5),floor(p.z/s.z + 0.5));
          p = p-s*id;
          ${s.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const rf=q({model:D(E),scale:D(E),out:Q(E)}),za=new J({typeName:"Scale",typeSchema:rf});class nf{componentType=za;ext={};create(e){return new of(e)}}const Ua=new nf;class of{type=Ua;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>r.model,setSource:n=>t("model",n)},{name:"scale",source:()=>r.scale,setSource:n=>t("scale",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("scale");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(ee`
        float ${c}(vec3 p) {
          return ${s.sdfFuncName}(p / ${l}) * ${l};
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ee`
        void ${d}(vec3 p, out vec4 c) {
          ${s.colourFuncName}(p / ${l}, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const af=q({model:D(E),axis:D(E),angle:D(E),out:Q(E)}),Ba=new J({typeName:"Rotate",typeSchema:af});class sf{componentType=Ba;ext={};create(e){return new lf(e)}}const qa=new sf;class lf{type=qa;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>r.model,setSource:n=>t("model",n)},{name:"axis",source:()=>r.axis,setSource:n=>t("axis",n)},{name:"angle",source:()=>r.angle,setSource:n=>t("angle",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("axis");if(u?.type!="Atom")return;let l=u.value,c=o.get("angle");if(c?.type!="Atom")return;let d=c.value,f=n.allocVar();n.insertGlobalCode(ee`
        float ${f}(vec3 p) {
          float a = 0.5 * ${d} * ${Math.PI/180};
          vec3 tmp = sin(a) * normalize(${l});
          vec4 q = vec4(tmp.x, tmp.y, tmp.z, cos(a));
          p = p + 2.0 * cross(-q.xyz, cross(-q.xyz, p) + q.w * p);
          return ${s.sdfFuncName}(p);
        }
      `);let p=n.allocVar();return n.insertGlobalCode(ee`
        void ${p}(vec3 p, out vec4 c) {
          float a = 0.5 * ${d} * ${Math.PI/180};
          vec3 tmp = sin(a) * normalize(${l});
          vec4 q = vec4(tmp.x, tmp.y, tmp.z, cos(a));
          p = p + 2.0 * cross(-q.xyz, cross(-q.xyz, p) + q.w * p);
          ${s.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:f,colourFuncName:p}}]])}}}const cf=q({radius:D(E),out:Q(E)}),Va=new J({typeName:"InfiniteCylinder",typeSchema:cf});class uf{componentType=Va;ext={};create(e){return new df(e)}}const Ga=new uf;class df{type=Ga;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"radius",source:()=>r.radius,setSource:n=>t("radius",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let s=a.value,u=n.allocVar();n.insertGlobalCode(ee`
        float ${u}(vec3 p) {
          return length(p.xy) - ${s};
        }
      `);let l=n.allocVar();return n.insertGlobalCode(ee`
        void ${l}(vec3 p, out vec4 c) {
          c = vec4(0.7, 0.7, 0.7, 1.0);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:l}}]])}}}const pf=q({colour:q({red:Le(),green:Le(),blue:Le(),alpha:Le()}),out:Q(E)}),Wa=new J({typeName:"Colour",typeSchema:pf});class Jt{r;g;b;a;constructor(e,r,t,n){this.r=e,this.g=r,this.b=t,this.a=n}}var ff=B("<div><div><div><div></div><svg><circle r=5 stroke=black stroke-width=2 fill=none pointer-events=none></circle></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div></div><div><div></div><div><table><thead></thead><tbody><tr><td>Red:</td><td><input type=text size=4></td></tr><tr><td>Green:</td><td><input type=text size=4></td></tr><tr><td>Blue:</td><td><input type=text size=4></td></tr><tr><td>Alpha:</td><td><input type=text size=4></td></tr></tbody></table></div><div><div>");const hf=i=>{let[e,r]=Ce({cursorPos:U.zero,chartMousePos:void 0,chartMouseDown:!1,brightness:255,brightnessMousePos:void 0,brightnessMouseDown:!1,alpha:255,alphaMousePos:void 0,alphaMouseDown:!1,userColour:oe(()=>i.colour),userRedText:void 0,userGreenText:void 0,userBlueText:void 0,userAlphaText:void 0}),[t,n]=Y(),[o,a]=Y();ae(()=>{let b=t();if(b==null)return;let v=new ResizeObserver(()=>{let k=b.getBoundingClientRect();o(),a(U.create(k.width,k.height))});v.observe(b),ye(()=>{v.unobserve(b),v.disconnect()})});let s=S(()=>{let b=o();if(b==null)return;let v=document.createElement("canvas");v.setAttribute("width",`${b.x}`),v.setAttribute("height",`${b.y}`),v.style.setProperty("flex-grow","1");let k=v.getContext("2d");if(k==null)return;let x=new ImageData(b.x,b.y),w=256*6;for(let O=0;O<b.x;++O){let R,F,V,j=Math.floor(O*w/b.x);if(j<256){let H=j;R=255,F=H,V=0}else if(j<256*2)R=255-(j-256),F=255,V=0;else if(j<256*3){let H=j-512;R=0,F=255,V=H}else if(j<256*4){let H=j-768;R=0,F=255-H,V=255}else if(j<256*5)R=j-1024,F=0,V=255;else{let H=j-1280;R=255,F=0,V=255-H}let G=O<<2;for(let H=0;H<b.y;++H){let te=R+Math.floor((256-R)*H/b.y),A=F+Math.floor((256-F)*H/b.y),X=V+Math.floor((256-V)*H/b.y);x.data[G]=te,x.data[G+1]=A,x.data[G+2]=X,x.data[G+3]=255,G+=b.x<<2}}let C=new ImageData(b.x,b.y);ae(ne(()=>e.brightness,()=>{let O=e.brightness,R=b.x*b.y<<2;for(let F=0;F<R;F+=4){let V=x.data[F],j=x.data[F+1],G=x.data[F+2],H=x.data[F+3],te=Math.floor(V*O/255),A=Math.floor(j*O/255),X=Math.floor(G*O/255);C.data[F]=te,C.data[F+1]=A,C.data[F+2]=X,C.data[F+3]=H}k.putImageData(C,0,0)}));let P=document.createElement("canvas");P.setAttribute("width","1"),P.setAttribute("height",`${b.y}`),P.style.setProperty("flex-grow","1");let T=P.getContext("2d");if(T==null)return;let $=new ImageData(1,b.y);ae(()=>{let O=e.cursorPos;if(O==null)return;let R=x.width*O.y+O.x<<2,F=x.data[R],V=x.data[R+1],j=x.data[R+2];for(let G=0;G<b.y;++G){let H=G<<2,te=Math.floor(F*(b.y-1-G)/(b.y-1)),A=Math.floor(V*(b.y-1-G)/(b.y-1)),X=Math.floor(j*(b.y-1-G)/(b.y-1));$.data[H]=te,$.data[H+1]=A,$.data[H+2]=X,$.data[H+3]=255}T.putImageData($,0,0)});let _=document.createElement("canvas");_.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),_.style.setProperty("background-size","20px 20px"),_.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),_.setAttribute("width","1"),_.setAttribute("height",`${b.y}`),_.style.setProperty("flex-grow","1");let M=_.getContext("2d");if(M==null)return;let L=new ImageData(1,b.y);return ae(()=>{let O=e.cursorPos;if(O==null)return;let R=x.width*O.y+O.x<<2,F=x.data[R],V=x.data[R+1],j=x.data[R+2],G=x.data[R+3];for(let H=0;H<b.y;++H){let te=H<<2,A=Math.floor(G*(b.y-1-H)/(b.y-1));L.data[te]=F,L.data[te+1]=V,L.data[te+2]=j,L.data[te+3]=A}M.putImageData(L,0,0)}),{canvas:v,sliderCanvas:P,alphaSliderCanvas:_,size:b,sliderImageData:$,alphaSliderImageData:L}});xe(()=>{let b=s();if(b==null||!e.chartMouseDown)return;let v=e.chartMousePos;v!=null&&(r("userColour",void 0),r("userRedText",void 0),r("userGreenText",void 0),r("userBlueText",void 0),r("cursorPos",U.create(Math.max(0,Math.min(b.size.x-1,Math.floor(v.x))),Math.max(0,Math.min(b.size.y-1,Math.floor(v.y))))))}),xe(()=>{if(!e.brightnessMouseDown)return;let b=e.brightnessMousePos;if(b==null)return;let v=s()?.size.y;v!=null&&(r("userColour",void 0),r("userRedText",void 0),r("userGreenText",void 0),r("userBlueText",void 0),r("brightness",Math.max(0,Math.min(255,Math.floor(256*(v-b.y)/v)))))}),xe(()=>{if(!e.alphaMouseDown)return;let b=e.alphaMousePos;if(b==null)return;let v=s()?.size.y;v!=null&&(r("userColour",void 0),r("userRedText",void 0),r("userGreenText",void 0),r("userBlueText",void 0),r("userAlphaText",void 0),r("alpha",Math.max(0,Math.min(255,Math.floor(256*(v-b.y)/v)))))});let u=S(ne([s,()=>e.cursorPos,()=>e.brightness,()=>e.alpha],()=>{let b=s();if(b==null)return;let k=Math.max(0,Math.min(b.size.y,Math.floor((255-e.brightness)*b.size.y/256)))<<2,x=b.sliderImageData.data[k],w=b.sliderImageData.data[k+1],C=b.sliderImageData.data[k+2],P=e.alpha;return new Jt(x,w,C,P)})),l=S(()=>{if(e.userRedText==null)return;let b=Number.parseFloat(e.userRedText);if(Number.isFinite(b))return Math.max(0,Math.min(255,b))}),c=S(()=>{if(e.userGreenText==null)return;let b=Number.parseFloat(e.userGreenText);if(Number.isFinite(b))return Math.max(0,Math.min(255,b))}),d=S(()=>{if(e.userBlueText==null)return;let b=Number.parseFloat(e.userBlueText);if(Number.isFinite(b))return Math.max(0,Math.min(255,b))}),f=S(()=>{if(e.userAlphaText==null)return;let b=Number.parseFloat(e.userAlphaText);if(Number.isFinite(b))return Math.max(0,Math.min(255,b))}),p=S(()=>{let b;return e.userColour!=null?b=e.userColour:b=u(),new Jt(l()??b?.r??0,c()??b?.g??0,d()??b?.b??0,f()??b?.a??255)});xe(ne([()=>i.colour],()=>{let b=p();if(b==null||i.colour==null)return;let v=i.colour;v.r==b.r&&v.g==b.g&&v.b==b.b&&v.a==b.a||r("userColour",v)},{defer:!0})),xe(ne([()=>e.userColour,p],()=>{if(e.userColour!=null)return;let b=p();b!=null&&i.onColour?.(b)})),xe(()=>{let b=s();if(!b||e.userColour==null&&l()==null&&c()==null&&d()==null&&f()==null)return;let v=e.userColour,k=new Jt(l()??v?.r??0,c()??v?.g??0,d()??v?.b??0,f()??v?.a??255),x=Math.max(k.r,k.g,k.b),w=Math.min(k.r,k.g,k.b),C=x,P=255/(x-w);if(!Number.isFinite(P))return;let T=Math.floor((k.r-w)*P),$=Math.floor((k.g-w)*P),_=Math.floor((k.b-w)*P),M=k.r==x,L=k.g==x,O=k.b==x,R;M&&!L&&_==0?R=$:!M&&L&&_==0?R=256+(255-T):T==0&&L&&!O?R=256*2+_:T==0&&!L&&O?R=256*3+(255-$):!M&&$==0&&O?R=256*4+T:R=256*5+(255-_);let F=Math.floor(b.size.x*R/(256*6)),V=w;Oe(()=>{r("cursorPos",U.create(F,V)),r("brightness",C),r("alpha",k.a)})});let[g,h]=Y(),[y,m]=Y(50);return xe(ne(g,()=>{let b=g();if(b==null)return;let v=new ResizeObserver(()=>{let k=b.getBoundingClientRect();console.log(k),k.width!=k.height&&m(k.height)});v.observe(b),ye(()=>{v.unobserve(b),v.disconnect()})})),(()=>{var b=ff(),v=b.firstChild,k=v.firstChild,x=k.firstChild,w=x.nextSibling,C=w.firstChild,P=k.nextSibling,T=P.firstChild,$=T.firstChild,_=P.nextSibling,M=_.firstChild,L=M.firstChild,O=v.nextSibling,R=O.firstChild,F=R.nextSibling,V=F.firstChild,j=V.firstChild,G=j.nextSibling,H=G.firstChild,te=H.firstChild,A=te.nextSibling,X=A.firstChild,re=H.nextSibling,ve=re.firstChild,le=ve.nextSibling,se=le.firstChild,Re=re.nextSibling,De=Re.firstChild,Ve=De.nextSibling,Xe=Ve.firstChild,Ge=Re.nextSibling,me=Ge.firstChild,yt=me.nextSibling,bt=yt.firstChild,Pe=F.nextSibling,ue=Pe.firstChild;b.style.setProperty("flex-grow","1"),b.style.setProperty("display","flex"),b.style.setProperty("flex-direction","column"),v.style.setProperty("flex-grow","1"),v.style.setProperty("display","flex"),v.style.setProperty("flex-direction","row"),k.$$pointerup=N=>{r("chartMouseDown",!1),N.currentTarget.releasePointerCapture(N.pointerId),N.preventDefault()},k.$$pointerdown=N=>{r("chartMouseDown",!0),N.currentTarget.setPointerCapture(N.pointerId),N.preventDefault()},k.$$pointerout=N=>{r("chartMousePos",void 0),N.preventDefault()},k.$$pointermove=N=>{let Me=N.currentTarget.getBoundingClientRect(),Be=N.clientX-Me.left,Ze=N.clientY-Me.top;r("chartMousePos",U.create(Be,Ze)),N.preventDefault()},k.style.setProperty("position","relative"),k.style.setProperty("flex-grow","1"),k.style.setProperty("display","flex"),k.style.setProperty("flex-direction","column"),k.style.setProperty("touch-action","none");var ce=n;typeof ce=="function"?he(ce,x):n=x,x.style.setProperty("flex-grow","1"),x.style.setProperty("display","flex"),x.style.setProperty("flex-direction","column"),W(x,()=>s()?.canvas),w.style.setProperty("position","absolute"),w.style.setProperty("left","0"),w.style.setProperty("top","0"),w.style.setProperty("right","0"),w.style.setProperty("bottom","0"),P.$$pointerup=N=>{r("brightnessMouseDown",!1),N.currentTarget.releasePointerCapture(N.pointerId),N.preventDefault()},P.$$pointerdown=N=>{r("brightnessMouseDown",!0),N.currentTarget.setPointerCapture(N.pointerId),N.preventDefault()},P.$$pointerout=N=>{r("brightnessMousePos",void 0),N.preventDefault()},P.$$pointermove=N=>{let Me=N.currentTarget.getBoundingClientRect(),Be=N.clientX-Me.left,Ze=N.clientY-Me.top;r("brightnessMousePos",U.create(Be,Ze)),N.preventDefault()},P.style.setProperty("position","relative"),P.style.setProperty("display","flex"),P.style.setProperty("flex-direction","row"),P.style.setProperty("width","25px"),P.style.setProperty("margin-left","15px"),P.style.setProperty("overflow","hidden"),P.style.setProperty("touch-action","none"),W(P,()=>s()?.sliderCanvas,T),T.style.setProperty("position","absolute"),T.style.setProperty("left","0"),T.style.setProperty("top","0"),T.style.setProperty("right","0"),T.style.setProperty("bottom","0"),_.$$pointerup=N=>{r("alphaMouseDown",!1),N.currentTarget.releasePointerCapture(N.pointerId),N.preventDefault()},_.$$pointerdown=N=>{r("alphaMouseDown",!0),N.currentTarget.setPointerCapture(N.pointerId),N.preventDefault()},_.$$pointerout=N=>{r("alphaMousePos",void 0),N.preventDefault()},_.$$pointermove=N=>{let Me=N.currentTarget.getBoundingClientRect(),Be=N.clientX-Me.left,Ze=N.clientY-Me.top;r("alphaMousePos",U.create(Be,Ze)),N.preventDefault()},_.style.setProperty("position","relative"),_.style.setProperty("display","flex"),_.style.setProperty("flex-direction","row"),_.style.setProperty("width","25px"),_.style.setProperty("margin-left","15px"),_.style.setProperty("overflow","hidden"),_.style.setProperty("touch-action","none"),W(_,()=>s()?.alphaSliderCanvas,M),M.style.setProperty("position","absolute"),M.style.setProperty("left","0"),M.style.setProperty("top","0"),M.style.setProperty("right","0"),M.style.setProperty("bottom","0"),O.style.setProperty("display","flex"),O.style.setProperty("flex-direction","row"),R.style.setProperty("flex-grow","1"),X.$$input=N=>{Oe(()=>{r("userRedText",N.currentTarget.value),r("userGreenText",p().g.toFixed(0)),r("userBlueText",p().b.toFixed(0)),r("userAlphaText",p().a.toFixed(0))})},se.$$input=N=>{Oe(()=>{r("userRedText",p().r.toFixed(0)),r("userGreenText",N.currentTarget.value),r("userBlueText",p().b.toFixed(0)),r("userAlphaText",p().a.toFixed(0))})},Xe.$$input=N=>{Oe(()=>{r("userRedText",p().r.toFixed(0)),r("userGreenText",p().g.toFixed(0)),r("userBlueText",N.currentTarget.value),r("userAlphaText",p().a.toFixed(0))})},bt.$$input=N=>{Oe(()=>{r("userRedText",p().r.toFixed(0)),r("userGreenText",p().g.toFixed(0)),r("userBlueText",p().b.toFixed(0)),r("userAlphaText",N.currentTarget.value)})};var Ue=h;return typeof Ue=="function"?he(Ue,Pe):h=Pe,Pe.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),Pe.style.setProperty("background-size","20px 20px"),Pe.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),Pe.style.setProperty("margin-top","10px"),Pe.style.setProperty("margin-bottom","10px"),Pe.style.setProperty("margin-left","10px"),Pe.style.setProperty("display","flex"),Pe.style.setProperty("flex-direction","column"),ue.style.setProperty("flex-grow","1"),Z(N=>{var Me=s()?.size.x??300,Be=s()?.size.y??300,Ze=e.cursorPos.x,un=e.cursorPos.y,rr=`${s()?.size.y??0}px`,dn=s()?.size.y??0,pn=(s()?.size.y??0)-e.brightness*(s()?.size.y??0)/255-5,nr=`${s()?.size.y??0}px`,fn=s()?.size.y??0,hn=(s()?.size.y??0)-e.alpha*(s()?.size.y??0)/255-5,ir=`${y()}px`,or=(()=>{let vt=p();if(vt!=null)return`rgb(${vt.r}, ${vt.g}, ${vt.b})`})(),ar=p().a/255;return Me!==N.e&&K(w,"width",N.e=Me),Be!==N.t&&K(w,"height",N.t=Be),Ze!==N.a&&K(C,"cx",N.a=Ze),un!==N.o&&K(C,"cy",N.o=un),rr!==N.i&&((N.i=rr)!=null?P.style.setProperty("height",rr):P.style.removeProperty("height")),dn!==N.n&&K(T,"height",N.n=dn),pn!==N.s&&K($,"y",N.s=pn),nr!==N.h&&((N.h=nr)!=null?_.style.setProperty("height",nr):_.style.removeProperty("height")),fn!==N.r&&K(M,"height",N.r=fn),hn!==N.d&&K(L,"y",N.d=hn),ir!==N.l&&((N.l=ir)!=null?Pe.style.setProperty("width",ir):Pe.style.removeProperty("width")),or!==N.u&&((N.u=or)!=null?ue.style.setProperty("background-color",or):ue.style.removeProperty("background-color")),ar!==N.c&&((N.c=ar)!=null?ue.style.setProperty("opacity",ar):ue.style.removeProperty("opacity")),N},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),Z(()=>X.value=e.userRedText??e.userColour?.r??u()?.r),Z(()=>se.value=e.userGreenText??e.userColour?.g??u()?.g),Z(()=>Xe.value=e.userBlueText??e.userColour?.b??u()?.b),Z(()=>bt.value=e.userAlphaText??e.userColour?.a??u()?.a),b})()};be(["pointermove","pointerout","pointerdown","pointerup","input"]);var mf=B(`<svg version=1.1 viewBox="-16 -16 32 32"><defs><linearGradient x1=0 x2=0 y1=0 y2=1><stop offset=0% stop-color="rgb(80, 80, 81)"></stop><stop offset=100% stop-color="rgb(30, 30, 31)"></stop></linearGradient><path d="
        M14.876 -5.890A-16 -16 0 0 0 14.876 5.890A16 16 0 0 112.539 9.938A-16 -16 0 0 0 2.337 15.828
        A16 16 0 0 1-2.337 15.828A-16 -16 0 0 0 -12.539 9.938A16 16 0 0 1-14.876 5.890A-16 -16 0 0 0 -14.876 -5.890
        A16 16 0 0 1-12.539 -9.938A-16 -16 0 0 0 -2.337 -15.828A16 16 0 0 12.337 -15.828A-16 -16 0 0 0 12.539 -9.938
        A16 16 0 0 114.876 -5.890"></path><clipPath><use></use></clipPath><filter></filter><filter></filter></defs><circle cx=0 cy=0 r=15.0 fill="rgb(36, 36, 37)"stroke="rgb(28, 28, 29)"stroke-width=0.5></circle><g><g><g><rect x=-16 y=-16 width=32 height=32></rect><circle cx=-28 cy=-28 r=32 fill="rgba(250, 250, 255, .16)"></circle></g></g></g><g><circle cx=0 cy=-11 r=1.1 fill=black></circle><circle cx=0 cy=-11 r=0.8 fill=white></circle></g><circle cx=0 cy=0 r=9 stroke="rgb(50, 50, 51)"stroke-width=0.7 fill=none></circle><foreignObject x=-9 y=-9 width=18 height=18><div style=width:18px;height:18px;border-radius:50%;background-image:conic-gradient(#aaa,#666,#aaa,#666,#aaa,#666,#aaa);>`);const gf=i=>{let[e,r]=Ce({dragging:void 0}),[t,n]=Y();ye(()=>{e.dragging&&i.setDisablePan(!1)});let o=-165,a=-o,s=S(()=>o+(i.value-i.minValue)*(a-o)/(i.maxValue-i.minValue)),u=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");u.setAttribute("dx","-0.3"),u.setAttribute("dy","-0.3"),u.setAttribute("stdDeviation","0.1"),u.setAttribute("flood-opacity","0.7"),u.setAttribute("flood-color","white");let l=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");l.setAttribute("dx","1.5"),l.setAttribute("dy","1.5"),l.setAttribute("stdDeviation","0.5"),l.setAttribute("flood-opacity","0.9"),l.setAttribute("flood-color","black");let c=b=>{let v=t(),k=v.getBoundingClientRect(),x=b.clientX-k.left,w=b.clientY-k.top,C=x-.5*k.width,P=w-.5*k.width;console.log("x",x.toFixed()),console.log("y",w.toFixed()),console.log("dx",C.toFixed()),console.log("dy",P.toFixed());let T=C*C+P*P;if(T>k.width*k.width)return;let $=Math.sqrt(T),M=360/(2*Math.PI*$),L=P>0?-M:M,O=C>0?M:-M;r("dragging",new er({pointerId:b.pointerId,startX:x,startY:w,startValue:i.value,dadx:L,dady:O})),v.setPointerCapture(b.pointerId),i.setDisablePan(!0)},d=b=>{if(e.dragging==null||b.pointerId!=e.dragging.value.pointerId)return;let v=t(),k=e.dragging.value,x=v.getBoundingClientRect(),w=b.clientX-x.left,C=b.clientY-x.top,P=o+(k.startValue-i.minValue)*(a-o)/(i.maxValue-i.minValue)+(w-k.startX)*k.dadx+(C-k.startY)*k.dady,T=i.minValue+(P-o)*(i.maxValue-i.minValue)/(a-o);(i.unbounded??!1)||(T=Math.max(i.minValue,Math.min(i.maxValue,T))),i.setValue(T)},f=b=>{e.dragging!=null&&e.dragging.value.pointerId==b.pointerId&&(t().releasePointerCapture(e.dragging.value.pointerId),i.setDisablePan(!1),r("dragging",void 0))},p=st(),g=st(),h=st(),y=st(),m=st();return(()=>{var b=mf(),v=b.firstChild,k=v.firstChild,x=k.nextSibling,w=x.nextSibling,C=w.firstChild,P=w.nextSibling,T=P.nextSibling,$=v.nextSibling,_=$.nextSibling,M=_.firstChild,L=M.firstChild,O=L.firstChild,R=_.nextSibling;b.$$pointerup=f,b.$$pointermove=d,b.$$pointerdown=c;var F=n;return typeof F=="function"?he(F,b):n=b,b.style.setProperty("user-select","none"),b.style.setProperty("outline","none"),K(k,"id",p),K(x,"id",g),K(w,"id",h),K(C,"href",`#${g}`),K(P,"id",y),W(P,u),K(T,"id",m),W(T,l),K(_,"filter",`url(#${m})`),K(M,"filter",`url(#${y})`),K(L,"clip-path",`url(#${h})`),K(O,"fill",`url(#${p})`),Z(V=>{var j=`${i.size}px`,G=`${i.size}px`,H=`transform: rotate(${s()}deg) scale(0.87)`,te=`transform: rotate(${s()}deg)`;return j!==V.e&&((V.e=j)!=null?b.style.setProperty("width",j):b.style.removeProperty("width")),G!==V.t&&((V.t=G)!=null?b.style.setProperty("height",G):b.style.removeProperty("height")),V.a=gn(w,H,V.a),V.o=gn(R,te,V.o),V},{e:void 0,t:void 0,a:void 0,o:void 0}),b})()};be(["pointerdown","pointermove","pointerup"]);var yf=B("<div style=width:300px;height:300px;display:flex;flex-direction:column;>");class bf{componentType=Wa;ext={};create(e){return new vf(e)}}const Ha=new bf;class vf{type=Ha;nodeParams;inputPins;outputPins;ui;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ui=S(()=>()=>(()=>{var n=yf();return W(n,I(hf,{get colour(){return new Jt(r.colour.red,r.colour.green,r.colour.blue,r.colour.alpha)},onColour:o=>{t("colour",{red:o.r,green:o.g,blue:o.b,alpha:o.a})}})),n})()),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=`vec4(${r.colour.red/255}, ${r.colour.green/255}, ${r.colour.blue/255}, ${r.colour.alpha/255})`;return new Map([["out",{type:"Atom",value:a}]])}}}const kf=q({colour:D(E),model:D(E),out:Q(E)}),Ka=new J({typeName:"ApplyColour",typeSchema:kf});class wf{componentType=Ka;ext={};create(e){return new xf(e)}}const Ya=new wf;class xf{type=Ya;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>r.model,setSource:n=>t("model",n)},{name:"colour",source:()=>r.colour,setSource:n=>t("colour",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("colour");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(ee`
        void ${c}(vec3 p, out vec4 c) {
          c = vec4(${l});
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:s.sdfFuncName,colourFuncName:c}}]])}}}const Sf=q({colour1:D(E),colour2:D(E),size:D(E),model:D(E),out:Q(E)}),Ja=new J({typeName:"ApplyCheckers",typeSchema:Sf});class Cf{componentType=Ja;ext={};create(e){return new Pf(e)}}const Xa=new Cf;class Pf{type=Xa;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>r.model,setSource:n=>t("model",n)},{name:"colour1",source:()=>r.colour1,setSource:n=>t("colour1",n)},{name:"colour2",source:()=>r.colour2,setSource:n=>t("colour2",n)},{name:"size",source:()=>r.size,setSource:n=>t("size",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("colour1");if(u?.type!="Atom")return;let l=u.value,c=o.get("colour2");if(c?.type!="Atom")return;let d=c.value,f=o.get("size");if(f?.type!="Atom")return;let p=f.value,g=n.allocVar();return n.insertGlobalCode(ee`
        void ${g}(vec3 p, out vec4 c) {
          p = floor(p / ${p});
          float a = mod(p.x + p.y + p.z, 2.0);
          if (a < 0.5) {
            c = vec4(${l});
          } else {
            c = vec4(${d});
          }
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:s.sdfFuncName,colourFuncName:g}}]])}}}const _f=q({value:Le(),sensitivity:To(1,Le()),out:Q(E)}),Za=new J({typeName:"UnboundKnob",typeSchema:_f});var Tf=B("<div><label class=label style=color:black;>Value</label><input class=input type=text size=5><label class=label style=color:black;>Sensitivity</label><input class=input type=text size=5>");class $f{componentType=Za;ext={};create(e){return new Ef(e)}}const Qa=new $f;class Ef{type=Qa;nodeParams;outputPins;ui;disablePan;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e;let[n,o]=Y(!1);this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:a=>t("out",a)}]),this.ui=S(()=>()=>{let[a,s]=Y(r.value.toFixed(3)),[u,l]=Y(r.sensitivity.toFixed(3)),c=!1,d=!1;return xe(ne(()=>r.value,f=>{c||s(f.toFixed(3))},{defer:!0})),xe(ne(()=>r.sensitivity,f=>{d||l(f.toFixed(3))})),(()=>{var f=Tf(),p=f.firstChild,g=p.nextSibling,h=g.nextSibling,y=h.nextSibling;return f.style.setProperty("display","flex"),f.style.setProperty("flex-direction","column"),g.$$input=m=>{let b=m.currentTarget.value;s(b);let v=Number.parseFloat(b.trim());if(!Number.isNaN(v))try{c=!0,t("value",v)}finally{c=!1}},y.$$input=m=>{let b=m.currentTarget.value;l(b);let v=Number.parseFloat(b.trim());if(!Number.isNaN(v))try{d=!0,t("sensitivity",v)}finally{d=!1}},W(f,I(gf,{size:100,indentSize:10,minValue:0,get maxValue(){return 100*r.sensitivity},unbounded:!0,get value(){return r.value},setValue:m=>t("value",m),setDisablePan:o}),null),Z(()=>g.value=a()),Z(()=>y.value=u()),f})()}),this.disablePan=n,this.ext.generateCode=({ctx:a,inputs:s,onInit:u})=>{let l=a.allocVar(),c=ee`
        ${ln.float(l)}
      `,d=ze.toSchema(c);return a.insertGlobalCode(c),u(({gl:f,program:p,rerender:g})=>{let h=cn(f,p,d.uniforms);xe(ne(()=>r.value,y=>{h[l].set(y),g()}))}),new Map([["out",{type:"Atom",value:l}]])}}}be(["input"]);const If=q({radius:D(E),height:D(E),out:Q(E)}),es=new J({typeName:"Cylinder",typeSchema:If});class Rf{componentType=es;ext={};create(e){return new Mf(e)}}const ts=new Rf;class Mf{type=ts;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"radius",source:()=>r.radius,setSource:n=>t("radius",n)},{name:"height",source:()=>r.height,setSource:n=>t("height",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let s=a.value,u=o.get("height");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(ee`
        float ${c}(vec3 p) {
          vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(${s},${l});
          return min(max(d.x,d.y),0.0) + length(max(d,0.0));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const Af=q({frequency:D(E),magnitude:D(E),out:Q(E)}),rs=new J({typeName:"SinXYZField",typeSchema:Af});class Nf{componentType=rs;ext={};create(e){return new Of(e)}}const ns=new Nf;class Of{type=ns;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>r.frequency,setSource:n=>t("frequency",n)},{name:"magnitude",source:()=>r.magnitude,setSource:n=>t("magnitude",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("frequency");if(a?.type!="Atom")return;let s=a.value,u=o.get("magnitude");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(ee`
        float ${c}(vec3 p) {
          return ${l} * sin(p.x*${s}) * sin(p.y*${s}) * sin(p.z*${s});
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const Ff=q({model1:D(E),model2:D(E),out:Q(E)}),is=new J({typeName:"Displace",typeSchema:Ff});class Df{componentType=is;ext={};create(e){return new jf(e)}}const os=new Df;class jf{type=os;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model1",source:()=>r.model1,setSource:n=>t("model1",n)},{name:"model2",source:()=>r.model2,setSource:n=>t("model2",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let s=a.value,u=o.get("model2");if(u?.type!="Model")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(ee`
        float ${c}(vec3 p) {
          float d1 = ${s.sdfFuncName}(p);
          float d2 = ${l.sdfFuncName}(p);
          return d1 + d2;
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ee`
        void ${d}(vec3 p, out vec4 c) {
          float d1 = ${s.sdfFuncName}(p);
          float d2 = ${l.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${s.colourFuncName}(p, c1);
          ${l.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const Lf=q({model:D(E),count:D(E),out:Q(E)}),as=new J({typeName:"RepeatRotational",typeSchema:Lf});class zf{componentType=as;ext={};create(e){return new Uf(e)}}const ss=new zf;class Uf{type=ss;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>r.model,setSource:n=>t("model",n)},{name:"count",source:()=>r.count,setSource:n=>t("count",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("count");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(ee`
        float ${c}(vec3 p) {
          float sp = 6.283185/float(${l});
          float an = atan(p.y,p.x);
          float id = floor(an/sp);

          float a1 = sp*(id+0.0);
          float a2 = sp*(id+1.0);
          vec2 r1 = mat2(cos(a1),-sin(a1),sin(a1),cos(a1))*p.xy;
          vec2 r2 = mat2(cos(a2),-sin(a2),sin(a2),cos(a2))*p.xy;

          return min(${s.sdfFuncName}(vec3(r1.x, r1.y, p.z)), ${s.sdfFuncName}(vec3(r2.x,r2.y,p.z)));
        }
      `);let d=n.allocVar();return n.insertGlobalCode(ee`
        void ${d}(vec3 p, out vec4 c) {
          float sp = 6.283185/float(${l});
          float an = atan(p.y,p.x);
          float id = floor(an/sp);
          float a1 = sp*(id+0.0);
          float a2 = sp*(id+1.0);
          vec2 r1 = mat2(cos(a1),-sin(a1),sin(a1),cos(a1))*p.xy;
          vec2 r2 = mat2(cos(a2),-sin(a2),sin(a2),cos(a2))*p.xy;
          vec3 p1 = vec3(r1.x, r1.y, p.z);
          vec3 p2 = vec3(r2.x, r2.y, p.z);
          float d1 = ${s.sdfFuncName}(p1);
          float d2 = ${s.sdfFuncName}(p2);
          if (d1 < d2) {
            p = p1;
          } else {
            p = p2;
          }
          ${s.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const Bf=q({model:D(E),k:D(E),out:Q(E)}),ls=new J({typeName:"Bend",typeSchema:Bf});class qf{componentType=ls;ext={};create(e){return new Vf(e)}}const cs=new qf;class Vf{type=cs;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>r.model,setSource:n=>t("model",n)},{name:"k",source:()=>r.k,setSource:n=>t("k",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("k");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(ee`
        float ${c}(vec3 p) {
          float k = ${l};
          float c = cos(k*p.x);
          float s = sin(k*p.x);
          mat2  m = mat2(c,-s,s,c);
          vec3  q = vec3(m*p.xy,p.z);
          return ${s.sdfFuncName}(q);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const Gf=q({mimeType:Ye(),base64Data:Ye(),out:Q(E)}),us=new J({typeName:"Texture",typeSchema:Gf});var Wf=B('<button class="btn btn-primary">Browse...'),Hf=B("<input type=file hidden>");class Kf{componentType=us;ext={};create(e){return new Yf(e)}}const ds=new Kf;class Yf{type=ds;nodeParams;outputPins;ui;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:a=>t("out",a)}]),this.ui=S(()=>()=>{let[a,s]=Y(),u=async l=>{let c=l.type,d=await l.arrayBuffer(),f=new Uint8Array(d),p=xc(f);Oe(()=>{t("mimeType",c),t("base64Data",p)})};return[(()=>{var l=Wf();return l.$$click=()=>a()?.click(),l})(),(()=>{var l=Hf();l.addEventListener("change",d=>{let f=d.currentTarget.files;if(f==null||f.length!=1)return;let p=f[0];u(p),d.currentTarget.value=""});var c=s;return typeof c=="function"?he(c,l):s=l,l})()]});let n=S(()=>{if(r.mimeType==""||r.base64Data=="")return;let a=Sc(r.base64Data),s=new Blob([a],{type:r.mimeType}),u=URL.createObjectURL(s),[l,c]=Y(),d=document.createElement("img");return d.src=u,d.onload=()=>{c(d)},ye(()=>{URL.revokeObjectURL(u)}),l}),o=S(()=>n()?.());this.ext.generateCode=({ctx:a,onInit:s})=>{let u=a.allocVar(),l=ee`
        ${ln.sampler2D(u)}
      `;a.insertGlobalCode(l);let c=ze.toSchema(l);return s(({gl:d,program:f,rerender:p})=>{cn(d,f,c.uniforms)[u].set(0);let h=d.createTexture();d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,h),xe(ne(o,y=>{y!=null&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,y),p())})),ye(()=>{d.deleteTexture(h)})}),new Map([["out",{type:"Atom",value:u}]])}}}be(["click"]);const Jf=q({model:D(E),texture:D(E),scaleX:D(E),scaleY:D(E),offsetX:D(E),offsetY:D(E),out:Q(E)}),ps=new J({typeName:"ApplyTexture",typeSchema:Jf});class Xf{componentType=ps;ext={};create(e){return new Zf(e)}}const fs=new Xf;class Zf{type=fs;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>r.model,setSource:n=>t("model",n)},{name:"texture",source:()=>r.texture,setSource:n=>t("texture",n)},{name:"scaleX",source:()=>r.scaleX,setSource:n=>t("scaleX",n)},{name:"scaleY",source:()=>r.scaleY,setSource:n=>t("scaleY",n)},{name:"offsetX",source:()=>r.offsetX,setSource:n=>t("offsetX",n)},{name:"offsetY",source:()=>r.offsetY,setSource:n=>t("offsetY",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("texture");if(u?.type!="Atom")return;let l=u.value,c=o.get("scaleX"),d;c?.type=="Atom"?d=c.value:d="1.0";let f=o.get("scaleY"),p;f?.type=="Atom"?p=f.value:p="1.0";let g=o.get("offsetX"),h;g?.type=="Atom"?h=g.value:h="0.0";let y=o.get("offsetY"),m;y?.type=="Atom"?m=y.value:m="0.0";let b=n.allocVar();return n.insertGlobalCode(ee`
        void ${b}(vec3 p, out vec4 c) {
          c = texture2D(${l}, (p.xy + vec2(${h}, ${m})) / vec2(${d}, ${p}));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:s.sdfFuncName,colourFuncName:b}}]])}}}const Qf=q({radius:D(E),height:D(E),out:Q(E)}),hs=new J({typeName:"Cone",typeSchema:Qf});class eh{componentType=hs;ext={};create(e){return new th(e)}}const ms=new eh;class th{type=ms;nodeParams;inputPins;outputPins;ext={};constructor(e){let r=e.state,t=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"radius",source:()=>r.radius,setSource:n=>t("radius",n)},{name:"height",source:()=>r.height,setSource:n=>t("height",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>r.out,setSinks:n=>t("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let s=a.value,u=o.get("height");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(ee`
        float ${c}(vec3 p) {
          float h = ${l};
          float z = sqrt(${l} * ${l} + ${s} * ${s});
          vec2 c = vec2(${s} / z, ${l} / z);
          vec2 q = h*vec2(c.x/c.y,-1.0);
          vec2 w = vec2( length(p.xz), p.y );
          vec2 a = w - q*clamp( dot(w,q)/dot(q,q), 0.0, 1.0 );
          vec2 b = w - q*vec2( clamp( w.x/q.x, 0.0, 1.0 ), 1.0 );
          float k = sign( q.y );
          float d = min(dot( a, a ),dot(b, b));
          float s = max( k*(w.x*q.y-w.y*q.x),k*(w.y-q.y)  );
          return sqrt(d)*sign(s);        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const gs=new Ro;gs.registerNodeTypes([Xa,Ya,fs,cs,Aa,Ha,ms,ts,Da,os,Ta,Ga,Qa,Sa,La,ss,qa,Ua,ns,wa,ds,Ra,Oa,Ea]);class rh{nextId=0;globalCode=[];mainBody=[];colourBody=[];allocVar(){return`x${this.nextId++}`}insertGlobalCode(e){this.globalCode.push(e)}insertCode(e){this.mainBody.push(e)}insertColourCode(e){this.colourBody.push(e)}genCode(){return ee`precision highp float;
uniform vec2 resolution;
uniform float uFocalLength;
uniform bool uUseOrthogonalProjection;
uniform float uOrthogonalScale;

void defaultColour(vec3 p, out vec4 c) {
  c = vec4(1.0, 1.0, 1.0, 1.0);
}

${this.globalCode}

float map(vec3 p) {
  float d = 10000.0;
  ${this.mainBody}
  return d;
}

void colourMap(vec3 p, out vec4 c) {
  float d = 10000.0;
  ${this.colourBody}
}

bool march(vec3 ro, vec3 rd, out float t) {
  vec3 p = ro;
  t = 0.0;
  for (int i = 0; i < 100; ++i) {
    vec3 p = ro + rd*t;
    float d = map(p);
    if (abs(d) <= 0.01) {
      return true;
    }
    t += d;
  }
  return false;
}

vec3 normal(vec3 p) {
  float d = 0.01;
  float mp = map(p);
  float dx = map(p + vec3(d,0,0)) - mp;
  float dy = map(p + vec3(0,d,0)) - mp;
  float dz = map(p + vec3(0,0,d)) - mp;
  return normalize(vec3(dx,dy,dz));
}

void main(void) {
  float fl = uFocalLength;
  float d = 10000.0;
  float mx = max(resolution.x, resolution.y);
  vec2 uv = gl_FragCoord.xy / mx;
  vec3 w = normalize(vec3(0.0, 0.0, 1.0));
  vec3 u = normalize(cross(vec3(0,1,0),w));
  vec3 v = cross(w,u);
  vec3 ro;
  vec3 rd;
  if (uUseOrthogonalProjection) {
    ro = w * d
       + (gl_FragCoord.x - 0.5 * resolution.x) * u / uOrthogonalScale
       + (gl_FragCoord.y - 0.5 * resolution.y) * v / uOrthogonalScale;
    rd = vec3(0.0, 0.0, -1.0);
  } else {
    ro = w * d;
    rd = normalize(
      (gl_FragCoord.x - 0.5 * resolution.x) * u +
      (gl_FragCoord.y - 0.5 * resolution.y) * v +
      -fl * w
    );
  }
  float t = 0.0;
  bool hit = march(ro, rd, t);
  if (!hit) {
    gl_FragColor = vec4(0.2, 0.2, 0.2, 1.0);
    return;
  }
  vec3 p = ro + rd*t;
  vec3 n = normal(p);
  float s = dot(n,normalize(vec3(1,1,1))) + 0.2;
  vec4 c = vec4(1.0, 1.0, 1.0, 1.0);
  colourMap(p, c);
  gl_FragColor = vec4(c.r * s, c.g * s, c.b * s, c.a);
}`}}function nh(i){let e=i.nodesSystem,r=[];{let u=new Map;for(let l of e.nodes()){let c={id:0,inputs:{},outputs:{},height:0,node:l};u.set(l.node.nodeParams.entity,c),r.push(c)}for(let l of u.values())for(let c of l.node.node.inputPins?.()??[]){let d=c.source();if(d==null)continue;let f=u.get(d.target);f!=null&&(l.inputs[c.name]={node:f,pin:d.pin})}}for(let u of r)for(let[l,{node:c,pin:d}]of Object.entries(u.inputs)){let f=c.outputs[d],p={node:u,pin:l};f==null?(f=[p],c.outputs[d]=f):f.push(p)}let t=[];ih(r);{let u=0;for(let l of r)l.id=u++}let n=new rh;t.splice(0,t.length);for(let u of r){let l=t[u.height];l==null?(l=[u],t[u.height]=l):l.push(u)}let o=new Map,a=[];for(let u=0;u<t.length;++u){let l=t[u]??[];for(let c of l){let d=c.node.node,f=new Map;for(let p of Object.entries(c.inputs)){let g=o.get(p[1].node)?.get(p[1].pin);g!=null&&f.set(p[0],g)}if(d.ext.generateCode!=null){let p=d.ext.generateCode({ctx:n,inputs:f,onInit:g=>a.push(g)});p!=null&&o.set(c,p)}}}let s=u=>{for(let l of a)l(u)};return{code:n.genCode(),onInit:s}}function ih(i){let e=new Set,r=[...i],t=[];for(;;){let n=r.pop();if(n==null){let s=r;if(r=t,t=s,n=r.pop(),n==null)break}if(e.has(n))continue;let o=!0;for(let[s,{node:u}]of Object.entries(n.inputs))if(!(n.node.node.inputPins?.().find(l=>l.name==s)?.isEffectPin??!1)&&!e.has(u)){o=!1;break}if(!o){t.push(n);continue}let a=0;for(let[,{node:s,pin:u}]of Object.entries(n.inputs))(s.node.node.outputPins?.().find(({name:l})=>l==u)?.isEffectPin??!1)||s.height>=a&&(a=s.height+1);n.height=a,e.add(n)}}const oh=new Xr([...Eo.componentTypes,Ja,Ka,ps,ls,Ma,Wa,hs,es,Fa,is,Ca,Va,an,xa,ja,as,Ba,za,rs,ga,us,we,Ia,Za,Na,$a]);var ah=B('<label class="input input-sm">Scale:<input type=text>'),sh=B("<div><div><div></div><div><canvas>"),lh=B("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Show Code"),ch=B('<select class="select select-sm"style=width:fit-content;>'),uh=B("<option>"),dh=B("<div><pre>");const ys=50,ph=i=>{let[e,r]=Br(i,["world"]);const t=["Orthogonal","Perspective"];let[n,o]=Ce({windowWidth:window.innerWidth,windowHeight:window.innerHeight,showCode:!1,projection:"Perspective",orthoScaleText:"0.1"}),a=S(()=>{let v=Number.parseFloat(n.orthoScaleText);return Number.isNaN(v)?.1:v});window.addEventListener("resize",()=>{Oe(()=>{o("windowWidth",window.innerWidth),o("windowHeight",window.innerHeight)})});let s=S(()=>n.windowWidth>n.windowHeight),[u,l]=Y(),c=S(()=>{let v=u();if(v!=null)return nh({nodesSystem:v})}),[d,f]=Y(),[p,g]=Y(),[h,y]=Y();xe(ne([d,p],([v,k])=>{if(v==null||k==null)return;let x=v.getBoundingClientRect();k.width=x.width*window.devicePixelRatio,k.height=x.height*window.devicePixelRatio,k.style.setProperty("background-color","darkblue");let w=k.getContext("webgl");w!=null&&y(w)}));let m,b;{let v=!1;b=()=>{let k=h();if(k==null||m==null)return;let x=m;v||(v=!0,requestAnimationFrame(()=>{v=!1,k.bindBuffer(k.ARRAY_BUFFER,x.verticesGLBuffer),k.enableVertexAttribArray(x.positionLocation),k.drawArrays(k.TRIANGLES,0,6),k.disableVertexAttribArray(x.positionLocation)}))}}return xe(ne([h,p],([v,k])=>{if(v==null||k==null)return;let x=c();x!=null&&(m=hh(v,k,x))})),xe(ne([h,c],([v,k])=>{if(u()==null)return;let w=p();if(w==null)return;let C=w.width,P=w.height;const T=.5*P/Math.tan(.5*ys*Math.PI/180);if(m==null||v==null||k==null)return;let $=Fr(v,v.FRAGMENT_SHADER,ze.toString(k.code));if($==null)return;if(v.detachShader(m.shaderProgram,m.fragmentShader),v.deleteShader(m.fragmentShader),m.fragmentShader=$,v.attachShader(m.shaderProgram,m.fragmentShader),v.linkProgram(m.shaderProgram),!v.getProgramParameter(m.shaderProgram,v.LINK_STATUS)){console.error("ERROR linking program:",v.getProgramInfoLog(m.shaderProgram));return}let _=m.shaderProgram;v.useProgram(_);const M=v.getAttribLocation(_,"aVertexPosition"),L=v.getUniformLocation(_,"uFocalLength"),O=v.getUniformLocation(_,"uModelViewMatrix"),R=v.getUniformLocation(_,"resolution"),F=v.getUniformLocation(_,"uUseOrthogonalProjection"),V=v.getUniformLocation(_,"uOrthogonalScale");m.useOrthogonalProjectionLocation=F,m.orthogonalProjectionScaleLocation=V,v.uniform1i(F,n.projection=="Orthogonal"?1:0),v.uniform1f(V,a()),v.uniform1f(L,T),v.uniform2f(R,C,P),k.onInit({gl:v,program:_,rerender:b});const j=m.vertices;j[0]=0,j[1]=0,j[2]=C,j[3]=0,j[4]=C,j[5]=P,j[6]=0,j[7]=0,j[8]=C,j[9]=P,j[10]=0,j[11]=P;let G=m.verticesGLBuffer;v.bindBuffer(v.ARRAY_BUFFER,G),v.bufferData(v.ARRAY_BUFFER,j,v.DYNAMIC_DRAW),v.vertexAttribPointer(M,2,v.FLOAT,!1,0,0);function H(A,X,re,ve){var le=-1,se=1,Re=X-A,De=ve-re,Ve=se-le;return[2/Re,0,0,0,0,2/De,0,0,0,0,-2/Ve,0,-(X+A)/Re,-(ve+re)/De,-(se+le)/Ve,1]}const te=new Float32Array(H(0,C,0,P));v.uniformMatrix4fv(O,!1,te),v.viewport(0,0,C,P),v.enableVertexAttribArray(M),v.drawArrays(v.TRIANGLES,0,6),v.disableVertexAttribArray(M)},{defer:!0})),xe(ne(()=>n.projection,v=>{let k=h();if(k!=null&&m!=null){switch(v){case"Orthogonal":k.uniform1i(m.useOrthogonalProjectionLocation,1);break;case"Perspective":k.uniform1i(m.useOrthogonalProjectionLocation,0);break}b()}},{defer:!0})),xe(ne(a,v=>{let k=h();k!=null&&m!=null&&(k.uniform1f(m.orthogonalProjectionScaleLocation,v),b())},{defer:!0})),(()=>{var v=sh(),k=v.firstChild,x=k.firstChild,w=x.nextSibling,C=w.firstChild;jr(v,r,!1,!0),k.style.setProperty("width","100%"),k.style.setProperty("height","100%"),k.style.setProperty("position","relative"),k.style.setProperty("display","flex"),x.style.setProperty("flex","1"),x.style.setProperty("display","flex"),x.style.setProperty("overflow","hidden"),W(x,I(No,{style:{"flex-grow":"1"},onInit:$=>{l($.nodesSystem)},componentRegistry:oh,nodeRegistry:gs,get world(){return e.world},get toolbar(){return[(()=>{var $=lh(),_=$.firstChild;return _.addEventListener("change",M=>o("showCode",M.currentTarget.checked)),Z(()=>_.checked=n.showCode),$})(),(()=>{var $=ch();return $.addEventListener("change",_=>{if(_.currentTarget.selectedOptions.length!=1)return;let M=_.currentTarget.selectedOptions[0].value;o("projection",M)}),W($,I(qe,{each:t,children:_=>(()=>{var M=uh();return M.value=_,W(M,_),Z(()=>M.selected=n.projection==_),M})()})),$})()]}}),null),W(x,I(ie,{get when(){return S(()=>!!n.showCode)()?c():void 0},children:$=>(()=>{var _=dh(),M=_.firstChild;return _.style.setProperty("position","absolute"),_.style.setProperty("right","0"),_.style.setProperty("top","0"),_.style.setProperty("bottom","0"),_.style.setProperty("overflow","auto"),_.style.setProperty("width","50%"),Z(()=>M.innerText=ze.toString($().code)),_})()}),null);var P=f;typeof P=="function"?he(P,w):f=w,w.style.setProperty("flex","1"),w.style.setProperty("display","flex"),w.style.setProperty("overflow","hidden"),w.style.setProperty("position","relative");var T=g;return typeof T=="function"?he(T,C):g=C,C.style.setProperty("flex-grow","1"),W(w,I(ie,{get when(){return n.projection=="Orthogonal"},get children(){var $=ah(),_=$.firstChild,M=_.nextSibling;return $.style.setProperty("position","absolute"),$.style.setProperty("left","0"),$.style.setProperty("top","0"),$.style.setProperty("width","200px"),M.$$input=L=>{o("orthoScaleText",L.currentTarget.value)},Z(()=>M.value=n.orthoScaleText),$}}),null),Z($=>($=s()?"row":"column-reverse")!=null?k.style.setProperty("flex-direction",$):k.style.removeProperty("flex-direction")),v})()};function Fr(i,e,r){const t=i.createShader(e);if(t!=null){if(i.shaderSource(t,r),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS)){console.error("An error occurred compiling the shaders: "+i.getShaderInfoLog(t)),i.deleteShader(t);return}return t}}function fh(i,e,r){const t=Fr(i,i.VERTEX_SHADER,e);if(t==null)return;const n=Fr(i,i.FRAGMENT_SHADER,r);if(n==null){i.deleteShader(t);return}const o=i.createProgram();if(i.attachShader(o,t),i.attachShader(o,n),i.linkProgram(o),!i.getProgramParameter(o,i.LINK_STATUS)){console.error("Unable to initialize the shader program: "+i.getProgramInfoLog(o)),i.detachShader(o,t),i.detachShader(o,n),i.deleteShader(t),i.deleteShader(n),i.deleteProgram(o);return}return{vertexShader:t,fragmentShader:n,shaderProgram:o}}function hh(i,e,r){let t=e.width,n=e.height;const o=.5*n/Math.tan(.5*ys*Math.PI/180);let a,s,u;{const k=fh(i,`attribute vec4 aVertexPosition;

  uniform mat4 uModelViewMatrix;

  void main(void) {
    gl_Position = uModelViewMatrix * aVertexPosition;
  }
  `,ze.toString(r.code));if(k==null)return;a=k.vertexShader,s=k.fragmentShader,u=k.shaderProgram}i.useProgram(u);const l=i.getAttribLocation(u,"aVertexPosition"),c=i.getUniformLocation(u,"uFocalLength"),d=i.getUniformLocation(u,"uModelViewMatrix"),f=i.getUniformLocation(u,"resolution"),p=i.getUniformLocation(u,"uUseOrthogonalProjection"),g=i.getUniformLocation(u,"uOrthogonalScale");i.uniform1i(p,0),i.uniform1f(g,.1),i.uniform1f(c,o),i.uniform2f(f,t,n);const h=new Float32Array(12);h[0]=0,h[1]=0,h[2]=t,h[3]=0,h[4]=t,h[5]=n,h[6]=0,h[7]=0,h[8]=t,h[9]=n,h[10]=0,h[11]=n;let y=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,y),i.bufferData(i.ARRAY_BUFFER,h,i.DYNAMIC_DRAW),i.vertexAttribPointer(l,2,i.FLOAT,!1,0,0);function m(k,x,w,C){var P=-1,T=1,$=x-k,_=C-w,M=T-P;return[2/$,0,0,0,0,2/_,0,0,0,0,-2/M,0,-(x+k)/$,-(C+w)/_,-(T+P)/M,1]}const b=new Float32Array(m(0,t,0,n));return i.uniformMatrix4fv(d,!1,b),i.viewport(0,0,t,n),i.enableVertexAttribArray(l),i.drawArrays(i.TRIANGLES,0,6),i.disableVertexAttribArray(l),{width:e.width,height:e.height,positionLocation:l,verticesGLBuffer:y,vertices:h,vertexShader:a,fragmentShader:s,shaderProgram:u,useOrthogonalProjectionLocation:p,orthogonalProjectionScaleLocation:g}}be(["input"]);var mh=B("<div>");const gh=Ie(()=>Ee(()=>import("./CodeMirror-9VHN8HJG.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),yh=Ie(()=>Ee(()=>import("./AppV2-CopOwSea.js"),__vite__mapDeps([5,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,0,21]),import.meta.url)),bh=Ie(()=>Ee(()=>import("./KittyDemo-CmKh1ODH.js"),__vite__mapDeps([22,1,2,3,4,12,13,17]),import.meta.url)),vh=Ie(()=>Ee(()=>import("./PixelEditor-BmPh638B.js"),__vite__mapDeps([6,1,2,3,4,7]),import.meta.url)),kh=Ie(()=>Ee(()=>import("./lib-DQcED-Wj.js").then(i=>i._),__vite__mapDeps([1,2,3,4]),import.meta.url)),wh=Ie(()=>Ee(()=>import("./ScriptEditor-Bj1PhInY.js"),__vite__mapDeps([8,1,2,3,4]),import.meta.url)),xh=Ie(()=>Ee(()=>import("./ColourPicker-BIzsq5Xv.js").then(i=>i.b),__vite__mapDeps([7,1,2,3,4]),import.meta.url)),Sh=Ie(()=>Ee(()=>import("./ReactiveSimulator-DIVGWTtu.js"),__vite__mapDeps([23,1,2,3,4]),import.meta.url)),Ch=Ie(()=>Ee(()=>import("./VectorEditor-Cglqek8A.js"),__vite__mapDeps([24,1,2,3,4]),import.meta.url)),Ph=Ie(()=>Ee(()=>import("./GravityTest-CBStNcn1.js"),__vite__mapDeps([25,1,2,3,4]),import.meta.url)),_h=Ie(()=>Ee(()=>import("./ThreeBody-BZytEPnY.js"),__vite__mapDeps([26,1,2,3,4]),import.meta.url)),Th=Ie(()=>Ee(()=>import("./VirtualFileSystemTest-xT3VF77A.js"),__vite__mapDeps([27,1,2,3,4]),import.meta.url)),$h=Ie(()=>Ee(()=>import("./AutomergeWebRtcTest-DVltBoxj.js"),__vite__mapDeps([28,1,2,3,4]),import.meta.url)),Eh=Ie(()=>Ee(()=>import("./DebugProjection-u9uBIx3i.js"),__vite__mapDeps([29,1,2,3,4]),import.meta.url)),Ih=Ie(()=>Ee(()=>import("./AutoFormsTest-D3SeKzQ2.js"),__vite__mapDeps([30,1,2,3,4]),import.meta.url)),Rh=document.getElementById("root");xi(()=>{let i=new URLSearchParams(window.location.search),e=window.localStorage.getItem("lastDocUrl"),r=i.get("docUrl")??e,[t,n]=Y(!1),o=new ws({storage:new xs,network:[]}),a;if(r==null||!yn(r)){let y=o.create(bn.makeEmptyState(o));window.localStorage.setItem("lastDocUrl",y.url),a=()=>y}else{let[y]=Ts(()=>o.find(r));a=y}let s=S(()=>{let[y,m]=Y(a());return{doc:y,setDoc:m}}),u=S(()=>s().doc()),l=y=>{oe(()=>s().setDoc(y))},c=S(()=>a()?.url),d=Zl({documentUrl:c,setDocumentUrl:async y=>{if(!yn(y))return;let m=await o.find(y);l(m)}}),f=d.connections.bind(d),p=S(tt(f,y=>new Ql({connection:y.conn})));ae(tt(p,y=>{o.networkSubsystem.addNetworkAdapter(y),ye(()=>{})}));let g=S(()=>{let y=u();return new bn({repo:o,docHandle:()=>y})}),h=()=>I(cl,{onShareVfs:()=>{let y=a();if(y==null)return;const m=new URL(window.location.href);m.searchParams.set("docUrl",y.url);let b=m.toString();window.history.pushState(null,"",b),navigator.clipboard.writeText(b)},onDeleteVfs:()=>{window.localStorage.removeItem("lastDocUrl"),indexedDB.deleteDatabase("automerge"),window.location.reload()},get vfs(){return g()}});return I(rl,{get children(){return[I(ke,{path:"/",component:h}),I(ke,{path:"/kitty-demo",component:bh}),I(ke,{path:"/pixel-editor",component:()=>I(vh,{})}),I(ke,{path:"/level-builder",component:()=>I(kh,{get vfs(){return g()}})}),I(ke,{path:"/script-editor",component:()=>I(wh,{})}),I(ke,{path:"/music-editor",component:Hd}),I(ke,{path:"/model-editor",component:()=>I(ph,{style:"flex-grow: 1; overflow: hidden;",world:new dt})}),I(ke,{path:"/code-mirror",component:()=>I(gh,{})}),I(ke,{path:"/colour-picker",component:()=>(()=>{var y=mh();return y.style.setProperty("width","300px"),y.style.setProperty("height","300px"),y.style.setProperty("display","flex"),y.style.setProperty("flex-direction","column"),y.style.setProperty("margin-left","20px"),y.style.setProperty("margin-top","20px"),W(y,I(xh,{})),y})()}),I(ke,{path:"/reactive-sim",component:Sh}),I(ke,{path:"/vector-editor",component:Ch}),I(ke,{path:"/gravity-test",component:Ph}),I(ke,{path:"/three-body",component:_h}),I(ke,{path:"/vfs-test",component:Th}),I(ke,{path:"/automerge-webrtc-test",component:$h}),I(ke,{path:"/connection-management",get component(){return d.Render}}),I(ke,{path:"/debug-projection",component:Eh}),I(ke,{path:"/app",component:()=>I(ie,{get when(){return u()},children:y=>I(yh,{get vfsDocUrl(){return y().url},get vfs(){return g()},get ConnectionManagementUi(){return d.Render},get broadcastNetworkAdapterIsEnabled(){return t()},enableBroadcastNetworkAdapter:()=>{o.networkSubsystem.addNetworkAdapter(new Ss),n(!0)},flushRepo:()=>o.flush()})})}),I(ke,{path:"/auto-forms-test",component:Ih})]}})},Rh);const Uh=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{Fn as $,Fi as F,ol as a,Uh as b,Dh as e,al as i};
