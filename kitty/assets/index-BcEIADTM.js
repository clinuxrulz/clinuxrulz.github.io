const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CodeMirror-DYZ7CKJi.js","./lib-DboxH0Mh.js","./index-XNH-lkY3.js","./dev-B9-ass9r.js","./dev-CC7pdsS5.js","./AppV2-BeZHOWXp.js","./PixelEditor-CV9Vk2Uj.js","./ColourPicker-C7eT6vxI.js","./ScriptEditor-DtVbKCME.js","./solid-js-C16mITwu.js","./pixi-js-CTVzrHHI.js","./FederatedEventTarget-DFQx8mKK.js","./Filter-BDK7ILDO.js","./State-3sV0XrC-.js","./CanvasTextSystem-BKHjFPHo.js","./colorToUniform-W8Zlj3HA.js","./SharedSystems-BwGi1NkL.js","./AnimatedSprite-CrPahPC5.js","./WebGLRenderer-DzfsPnmv.js","./WebGPURenderer-DziseXTR.js","./solid-js-store-D4PqY48D.js","./AppV2-DQoE4ujd.css","./KittyDemo-FEXpBsO8.js","./ReactiveSimulator-CUdajhZJ.js","./VectorEditor-diFFJLhj.js","./GravityTest-BHrXVkdu.js","./ThreeBody-BxCJCe9S.js","./VirtualFileSystemTest-DNE_KFna.js","./AutomergeWebRtcTest-U62PZw_L.js","./DebugProjection-qPG0xQTx.js","./AutoFormsTest-C0P4jkUR.js"])))=>i.map(i=>d[i]);
import{dG as jt,i as Br,d as Ps,dH as Cs,_ as Ae}from"./index-XNH-lkY3.js";import{M as _s,d as ke,J as Ci,w as Ue,x as pe,i as H,u as ge,t as q,N as Ut,n as ht,P as Ke,Vec2 as $r,v as dt,s as X,Q as _i,k as qr,g as kn,R as Ts,W as $s,X as wn,Y as xn,Z as Is}from"./lib-DboxH0Mh.js";import{U as Ti,q as S,C as Vr,n as $i,Z as Ii,c as K,s as Q,N as ie,X as Es,T as Rs,b as ze,Y as se,l as I,k as Ei,K as Ms,S as ae,u as nt,O as be,V as dr,m as le,F as Xe,h as Gr,M as ft,J as it,Q as Wr,p as ve,W as Hr,H as Ne,t as As}from"./dev-B9-ass9r.js";import{a as _e,p as Et}from"./dev-CC7pdsS5.js";function Ns(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in i)){const o=Object.getOwnPropertyDescriptor(r,n);o&&Object.defineProperty(i,n,o.get?o:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}function Ri(){let i=new Set;function e(n){return i.add(n),()=>i.delete(n)}let t=!1;function r(n,o){if(t)return!(t=!1);const a={to:n,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const s of i)s.listener({...a,from:s.location,retry:u=>{u&&(t=!0),s.navigate(n,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:r}}let Ir;function Yr(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Ir=window.history.state._depth}Yr();function Os(i){return{...i,_depth:window.history.state&&window.history.state._depth}}function Fs(i,e){let t=!1;return()=>{const r=Ir;Yr();const n=r==null?null:Ir-r;if(t){t=!1;return}n&&e(n)?(t=!0,window.history.go(-n)):i()}}const Ds=/^(?:[a-z0-9]+:)?\/\//i,zs=/^\/+|(\/)\/+$/g,Mi="http://sr";function Nt(i,e=!1){const t=i.replace(zs,"$1");return t?e||/^[?#]/.test(t)?t:"/"+t:""}function Wt(i,e,t){if(Ds.test(e))return;const r=Nt(i),n=t&&Nt(t);let o="";return!n||e.startsWith("/")?o=r:n.toLowerCase().indexOf(r.toLowerCase())!==0?o=r+n:o=n,(o||"/")+Nt(e,!o)}function Ls(i,e){if(i==null)throw new Error(e);return i}function js(i,e){return Nt(i).replace(/\/*(\*.*)?$/g,"")+Nt(e)}function Ai(i){const e={};return i.searchParams.forEach((t,r)=>{r in e?Array.isArray(e[r])?e[r].push(t):e[r]=[e[r],t]:e[r]=t}),e}function Us(i,e,t){const[r,n]=i.split("/*",2),o=r.split("/").filter(Boolean),a=o.length;return s=>{const u=s.split("/").filter(Boolean),l=u.length-a;if(l<0||l>0&&n===void 0&&!e)return null;const c={path:a?"":"/",params:{}},d=h=>t===void 0?void 0:t[h];for(let h=0;h<a;h++){const p=o[h],g=p[0]===":",f=g?u[h]:u[h].toLowerCase(),y=g?p.slice(1):p.toLowerCase();if(g&&pr(f,d(y)))c.params[y]=f;else if(g||!pr(f,y))return null;c.path+=`/${f}`}if(n){const h=l?u.slice(-l).join("/"):"";if(pr(h,d(n)))c.params[n]=h;else return null}return c}}function pr(i,e){const t=r=>r===i;return e===void 0?!0:typeof e=="string"?t(e):typeof e=="function"?e(i):Array.isArray(e)?e.some(t):e instanceof RegExp?e.test(i):!1}function Bs(i){const[e,t]=i.pattern.split("/*",2),r=e.split("/").filter(Boolean);return r.reduce((n,o)=>n+(o.startsWith(":")?2:3),r.length-(t===void 0?0:1))}function Ni(i){const e=new Map,t=Vr();return new Proxy({},{get(r,n){return e.has(n)||Ti(t,()=>e.set(n,S(()=>i()[n]))),e.get(n)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(i())}})}function Oi(i){let e=/(\/?\:[^\/]+)\?/.exec(i);if(!e)return[i];let t=i.slice(0,e.index),r=i.slice(e.index+e[0].length);const n=[t,t+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(r);)n.push(t+=e[1]),r=r.slice(e[0].length);return Oi(r).reduce((o,a)=>[...o,...n.map(s=>s+a)],[])}const qs=100,Fi=$i(),Di=$i(),Vs=()=>Ls(Ii(Fi),"<A> and 'use' router primitives can be only used inside a Route."),Gs=()=>Vs().navigatorFactory();function Ws(i,e=""){const{component:t,preload:r,load:n,children:o,info:a}=i,s=!o||Array.isArray(o)&&!o.length,u={key:i,component:t,preload:r||n,info:a};return zi(i.path).reduce((l,c)=>{for(const d of Oi(c)){const h=js(e,d);let p=s?h:h.split("/*",1)[0];p=p.split("/").map(g=>g.startsWith(":")||g.startsWith("*")?g:encodeURIComponent(g)).join("/"),l.push({...u,originalPath:c,pattern:p,matcher:Us(p,!s,i.matchFilters)})}return l},[])}function Hs(i,e=0){return{routes:i,score:Bs(i[i.length-1])*1e4-e,matcher(t){const r=[];for(let n=i.length-1;n>=0;n--){const o=i[n],a=o.matcher(t);if(!a)return null;r.unshift({...a,route:o})}return r}}}function zi(i){return Array.isArray(i)?i:[i]}function Li(i,e="",t=[],r=[]){const n=zi(i);for(let o=0,a=n.length;o<a;o++){const s=n[o];if(s&&typeof s=="object"){s.hasOwnProperty("path")||(s.path="");const u=Ws(s,e);for(const l of u){t.push(l);const c=Array.isArray(s.children)&&s.children.length===0;if(s.children&&!c)Li(s.children,l.pattern,t,r);else{const d=Hs([...t],r.length);r.push(d)}t.pop()}}}return t.length?r:r.sort((o,a)=>a.score-o.score)}function hr(i,e){for(let t=0,r=i.length;t<r;t++){const n=i[t].matcher(e);if(n)return n}return[]}function Ys(i,e,t){const r=new URL(Mi),n=S(c=>{const d=i();try{return new URL(d,r)}catch{return console.error(`Invalid path ${d}`),c}},r,{equals:(c,d)=>c.href===d.href}),o=S(()=>n().pathname),a=S(()=>n().search,!0),s=S(()=>n().hash),u=()=>"",l=ie(a,()=>Ai(n()));return{get pathname(){return o()},get search(){return a()},get hash(){return s()},get state(){return e()},get key(){return u()},query:t?t(l):Ni(l)}}let pt;function Xs(){return pt}function Ks(i,e,t,r={}){const{signal:[n,o],utils:a={}}=i,s=a.parsePath||(F=>F),u=a.renderPath||(F=>F),l=a.beforeLeave||Ri(),c=Wt("",r.base||"");if(c===void 0)throw new Error(`${c} is not a valid base path`);c&&!n().value&&o({value:c,replace:!0,scroll:!1});const[d,h]=K(!1);let p;const g=(F,R)=>{R.value===f()&&R.state===b()||(p===void 0&&h(!0),pt=F,p=R,Es(()=>{p===R&&(y(p.value),m(p.state),Rs(),w[1](z=>z.filter(W=>W.pending)))}).finally(()=>{p===R&&ze(()=>{pt=void 0,F==="navigate"&&E(p),h(!1),p=void 0})}))},[f,y]=K(n().value),[b,m]=K(n().state),k=Ys(f,b,a.queryWrapper),v=[],w=K([]),x=S(()=>typeof r.transformUrl=="function"?hr(e(),r.transformUrl(k.pathname)):hr(e(),k.pathname)),P=()=>{const F=x(),R={};for(let z=0;z<F.length;z++)Object.assign(R,F[z].params);return R},C=a.paramsWrapper?a.paramsWrapper(P,e):Ni(P),T={pattern:c,path:()=>c,outlet:()=>null,resolvePath(F){return Wt(c,F)}};return Q(ie(n,F=>g("native",F),{defer:!0})),{base:T,location:k,params:C,isRouting:d,renderPath:u,parsePath:s,navigatorFactory:_,matches:x,beforeLeave:l,preloadRoute:O,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:w};function M(F,R,z){se(()=>{if(typeof R=="number"){R&&(a.go?a.go(R):console.warn("Router integration does not support relative routing"));return}const W=!R||R[0]==="?",{replace:V,resolve:L,scroll:Y,state:re}={replace:!1,resolve:!W,scroll:!0,...z},N=L?F.resolvePath(R):Wt(W&&k.pathname||"",R);if(N===void 0)throw new Error(`Path '${R}' is not a routable path`);if(v.length>=qs)throw new Error("Too many redirects");const J=f();(N!==J||re!==b())&&(_s||l.confirm(N,z)&&(v.push({value:J,replace:V,scroll:Y,state:b()}),g("navigate",{value:N,state:re})))})}function _(F){return F=F||Ii(Di)||T,(R,z)=>M(F,R,z)}function E(F){const R=v[0];R&&(o({...F,replace:R.replace,scroll:R.scroll}),v.length=0)}function O(F,R){const z=hr(e(),F.pathname),W=pt;pt="preload";for(let V in z){const{route:L,params:Y}=z[V];L.component&&L.component.preload&&L.component.preload();const{preload:re}=L;R&&re&&Ti(t(),()=>re({params:Y,location:{pathname:F.pathname,search:F.search,hash:F.hash,query:Ai(F),state:null,key:""},intent:"preload"}))}pt=W}}function Zs(i,e,t,r){const{base:n,location:o,params:a}=i,{pattern:s,component:u,preload:l}=r().route,c=S(()=>r().path);u&&u.preload&&u.preload();const d=l?l({params:a,location:o,intent:pt||"initial"}):void 0;return{parent:e,pattern:s,path:c,outlet:()=>u?I(u,{params:a,location:o,data:d,get children(){return t()}}):t(),resolvePath(p){return Wt(n.path(),p,c())}}}const Js=i=>e=>{const{base:t}=e,r=Ei(()=>e.children),n=S(()=>Li(r(),e.base||""));let o;const a=Ks(i,n,()=>o,{base:t,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return i.create&&i.create(a),I(Fi.Provider,{value:a,get children(){return I(Qs,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[S(()=>(o=Vr())&&null),I(el,{routerState:a,get branches(){return n()}})]}})}})};function Qs(i){const e=i.routerState.location,t=i.routerState.params,r=S(()=>i.preload&&se(()=>{i.preload({params:t,location:e,intent:Xs()||"initial"})}));return I(ae,{get when(){return i.root},keyed:!0,get fallback(){return i.children},children:n=>I(n,{params:t,location:e,get data(){return r()},get children(){return i.children}})})}function el(i){const e=[];let t;const r=S(ie(i.routerState.matches,(n,o,a)=>{let s=o&&n.length===o.length;const u=[];for(let l=0,c=n.length;l<c;l++){const d=o&&o[l],h=n[l];a&&d&&h.route.key===d.route.key?u[l]=a[l]:(s=!1,e[l]&&e[l](),nt(p=>{e[l]=p,u[l]=Zs(i.routerState,u[l-1]||i.routerState.base,Sn(()=>r()[l+1]),()=>i.routerState.matches()[l])}))}return e.splice(n.length).forEach(l=>l()),a&&s?a:(t=u[0],u)}));return Sn(()=>r()&&t)()}const Sn=i=>()=>I(ae,{get when(){return i()},keyed:!0,children:e=>I(Di.Provider,{value:e,get children(){return e.outlet()}})}),xe=i=>{const e=Ei(()=>i.children);return Ms(i,{get children(){return e()}})};function tl([i,e],t,r){return[i,r?n=>e(r(n)):e]}function rl(i){let e=!1;const t=n=>typeof n=="string"?{value:n}:n,r=tl(K(t(i.get()),{equals:(n,o)=>n.value===o.value&&n.state===o.state}),void 0,n=>(!e&&i.set(n),dr.registry&&!dr.done&&(dr.done=!0),n));return i.init&&be(i.init((n=i.get())=>{e=!0,r[1](t(n)),e=!1})),Js({signal:r,create:i.create,utils:i.utils})}function nl(i,e,t){return i.addEventListener(e,t),()=>i.removeEventListener(e,t)}function il(i,e){const t=i&&document.getElementById(i);t?t.scrollIntoView():e&&window.scrollTo(0,0)}const ol=new Map;function al(i=!0,e=!1,t="/_server",r){return n=>{const o=n.base.path(),a=n.navigatorFactory(n.base);let s,u;function l(f){return f.namespaceURI==="http://www.w3.org/2000/svg"}function c(f){if(f.defaultPrevented||f.button!==0||f.metaKey||f.altKey||f.ctrlKey||f.shiftKey)return;const y=f.composedPath().find(x=>x instanceof Node&&x.nodeName.toUpperCase()==="A");if(!y||e&&!y.hasAttribute("link"))return;const b=l(y),m=b?y.href.baseVal:y.href;if((b?y.target.baseVal:y.target)||!m&&!y.hasAttribute("state"))return;const v=(y.getAttribute("rel")||"").split(/\s+/);if(y.hasAttribute("download")||v&&v.includes("external"))return;const w=b?new URL(m,document.baseURI):new URL(m);if(!(w.origin!==window.location.origin||o&&w.pathname&&!w.pathname.toLowerCase().startsWith(o.toLowerCase())))return[y,w]}function d(f){const y=c(f);if(!y)return;const[b,m]=y,k=n.parsePath(m.pathname+m.search+m.hash),v=b.getAttribute("state");f.preventDefault(),a(k,{resolve:!1,replace:b.hasAttribute("replace"),scroll:!b.hasAttribute("noscroll"),state:v?JSON.parse(v):void 0})}function h(f){const y=c(f);if(!y)return;const[b,m]=y;n.preloadRoute(m,b.getAttribute("preload")!=="false")}function p(f){clearTimeout(s);const y=c(f);if(!y)return u=null;const[b,m]=y;u!==b&&(s=setTimeout(()=>{n.preloadRoute(m,b.getAttribute("preload")!=="false"),u=b},20))}function g(f){if(f.defaultPrevented)return;let y=f.submitter&&f.submitter.hasAttribute("formaction")?f.submitter.getAttribute("formaction"):f.target.getAttribute("action");if(!y)return;if(!y.startsWith("https://action/")){const m=new URL(y,Mi);if(y=n.parsePath(m.pathname+m.search),!y.startsWith(t))return}if(f.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const b=ol.get(y);if(b){f.preventDefault();const m=new FormData(f.target,f.submitter);b.call({r:n,f:f.target},f.target.enctype==="multipart/form-data"?m:new URLSearchParams(m))}}ke(["click","submit"]),document.addEventListener("click",d),i&&(document.addEventListener("mousemove",p,{passive:!0}),document.addEventListener("focusin",h,{passive:!0}),document.addEventListener("touchstart",h,{passive:!0})),document.addEventListener("submit",g),be(()=>{document.removeEventListener("click",d),i&&(document.removeEventListener("mousemove",p),document.removeEventListener("focusin",h),document.removeEventListener("touchstart",h)),document.removeEventListener("submit",g)})}}function sl(i){const e=i.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,t="/"]=window.location.hash.split("#",2);return`${t}#${e}`}return e}function ll(i){const e=()=>window.location.hash.slice(1),t=Ri();return rl({get:e,set({value:r,replace:n,scroll:o,state:a}){n?window.history.replaceState(Os(a),"","#"+r):window.history.pushState(a,"","#"+r);const s=r.indexOf("#"),u=s>=0?r.slice(s+1):"";il(u,o),Yr()},init:r=>nl(window,"hashchange",Fs(r,n=>!t.confirm(n&&n<0?n:e()))),create:al(i.preload,i.explicitLinks,i.actionBase),utils:{go:r=>window.history.go(r),renderPath:r=>`#${r}`,parsePath:sl,beforeLeave:t}})(i)}var Ht={exports:{}},cl=Ht.exports,Pn;function ul(){return Pn||(Pn=1,function(i,e){(function(t,r){r()})(cl,function(){function t(l,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}function r(l,c,d){var h=new XMLHttpRequest;h.open("GET",l),h.responseType="blob",h.onload=function(){u(h.response,c,d)},h.onerror=function(){console.error("could not download file")},h.send()}function n(l){var c=new XMLHttpRequest;c.open("HEAD",l,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function o(l){try{l.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(c)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof jt=="object"&&jt.global===jt?jt:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(l,c,d){var h=a.URL||a.webkitURL,p=document.createElement("a");c=c||l.name||"download",p.download=c,p.rel="noopener",typeof l=="string"?(p.href=l,p.origin===location.origin?o(p):n(p.href)?r(l,c,d):o(p,p.target="_blank")):(p.href=h.createObjectURL(l),setTimeout(function(){h.revokeObjectURL(p.href)},4e4),setTimeout(function(){o(p)},0))}:"msSaveOrOpenBlob"in navigator?function(l,c,d){if(c=c||l.name||"download",typeof l!="string")navigator.msSaveOrOpenBlob(t(l,d),c);else if(n(l))r(l,c,d);else{var h=document.createElement("a");h.href=l,h.target="_blank",setTimeout(function(){o(h)})}}:function(l,c,d,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof l=="string")return r(l,c,d);var p=l.type==="application/octet-stream",g=/constructor/i.test(a.HTMLElement)||a.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent);if((f||p&&g||s)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var k=y.result;k=f?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=k:location=k,h=null},y.readAsDataURL(l)}else{var b=a.URL||a.webkitURL,m=b.createObjectURL(l);h?h.location=m:location.href=m,h=null,setTimeout(function(){b.revokeObjectURL(m)},4e4)}});a.saveAs=u.saveAs=u,i.exports=u})}(Ht)),Ht.exports}var dl=ul();const ji=Br(dl);let Hf=async i=>{let e=i.vfs,t=new Ci,r=async(n,o)=>{let a=o.contents;for(let s of a)switch(s.type){case"File":{let u=await new Promise(c=>{nt(d=>{let h=o.openFileById(s.id);le(()=>{let p=h();if(p.type=="Pending")return;if(d(),p.type=="Failed"){c(Ue(p.message));return}let g=p.value,f;if(g.name().toLowerCase().endsWith(".json"))f=new Blob([JSON.stringify(g.doc,void 0,2)],{type:"application/json"});else if(g.name().toLowerCase().endsWith(".ts"))f=new Blob([g.doc.source],{type:"application/typescript"});else{let y=g.doc.mimeType,b=g.doc.data;f=new Blob([b],{type:y})}c(pe(f))})})});if(u.type=="Err")continue;let l=u.value;n.file(s.name,l);break}case"Folder":{let u=n.folder(s.name);if(u==null)continue;await new Promise(l=>{nt(c=>{let d=o.openFolderById(s.id);le(()=>{let h=d();if(h.type=="Pending")return;if(h.type=="Failed"){console.log(h.message),c(),l();return}let p=h.value;(async()=>(await r(u,p),c(),l()))()})})});break}}};nt(n=>{let o=e.rootFolder();le(()=>{let a=o();if(a.type!="Pending"){if(a.type=="Failed"){console.log(a.message),n();return}(async()=>{let s=a.value;await r(t,s);let u=await t.generateAsync({type:"blob"});ji.saveAs(u,"kitty_export.zip"),n()})()}})})},pl=async i=>{let e=i.vfs,t;{let r=await new Promise(n=>{nt(o=>{let a=e.rootFolder();le(()=>{let s=a();if(s.type=="Pending")return;if(s.type=="Failed"){o(),n(Ue(s.message));return}let u=s.value;se(()=>{let l=u.contents;for(let c of l)u.removeFileOrFolderById(c.id)}),o(),n(pe(u))})})});if(r.type=="Err")return r;t=r.value}{let r=await Ci.loadAsync(i.file);async function n(o,a){let s;if(o=="")s=r;else{let c=r.folder(o);if(c==null)return;s=c}if(!s){console.warn(`Folder "${o}" not found in the zip.`);return}const u=[];s.forEach((c,d)=>{const h=o+(o&&!o.endsWith("/")?"/":"")+c;u.push({name:h,relativePath:c,isFolder:d.dir})});let l=[];for(let c of u)c.isFolder&&l.push(c.relativePath);for(const c of u)if(!l.some(d=>c.relativePath.startsWith(d))&&!c.isFolder){let d=r.file(c.name);if(d==null)continue;let h=await d.async("blob");if(c.relativePath.toLowerCase().endsWith(".json")){let p=await h.text(),g=JSON.parse(p);a.createFile(c.relativePath,g)}else if(c.relativePath.toLowerCase().endsWith(".ts")){let p=await h.text();a.createFile(c.relativePath,{source:p})}else{let p=new Uint8Array(await h.arrayBuffer());a.createFile(c.relativePath,{mimeType:h.type,data:p})}}for(const c of u)if(c.isFolder){let d=c.relativePath;d.endsWith("/")&&(d=d.slice(0,d.length-1));let h=a.createFolder(d);if(h.type=="Err")continue;let{id:p}=h.value;await new Promise(g=>{nt(f=>{let y=a.openFolderById(p);le(ie(y,b=>{if(b.type=="Pending")return;if(b.type=="Failed"){console.log(b.message),f(),g();return}let m=b.value;(async()=>(await n(c.name,m),f(),g()))()}))})})}}await n("",t)}return pe({})};var hl=q('<div style=flex-grow:1;overflow:auto;><button class="btn btn-primary">Share Virtual File System</button><br><button class="btn btn-secondary">Delete Virtual File System</button><br><br><b>Links:</b><br><div><div><button class=btn>Kitty Demo</button><button class=btn>Pixel Editor</button><button class=btn>Level Builder</button><button class=btn>Music Editor</button><button class=btn>Model Editor</button><button class=btn>Script Editor</button><button class=btn>Colour Picker</button><button class=btn>Reactive Simulator</button><button class=btn>Vector Editor</button><button class=btn>Gravity Test</button><button class=btn>Three Body</button><button class=btn>Virtual File System Test</button><button class=btn>Automerge WebRTC Test</button><button class=btn>Connection Management</button><button class=btn>Debug Projection</button><button class=btn>App</button><button class=btn>Auto Forms Test'),fl=q('<button class="btn btn-primary">Import Virtual File System<input type=file hidden>');const ml=i=>{let e=Gs();return(()=>{var t=hl(),r=t.firstChild,n=r.nextSibling,o=n.nextSibling,a=o.nextSibling,s=a.nextSibling,u=s.nextSibling,l=u.nextSibling,c=l.nextSibling,d=c.firstChild,h=d.firstChild,p=h.nextSibling,g=p.nextSibling,f=g.nextSibling,y=f.nextSibling,b=y.nextSibling,m=b.nextSibling,k=m.nextSibling,v=k.nextSibling,w=v.nextSibling,x=w.nextSibling,P=x.nextSibling,C=P.nextSibling,T=C.nextSibling,M=T.nextSibling,_=M.nextSibling,E=_.nextSibling;return r.$$click=()=>{i.onShareVfs()},o.$$click=()=>{window.confirm("Are you sure you wish to delete your virtual file system?")&&i.onDeleteVfs()},H(t,()=>se(()=>{let O;return(()=>{var F=fl(),R=F.firstChild,z=R.nextSibling;F.$$click=()=>{O.click()},z.addEventListener("change",()=>{let V=O.files;V!=null&&V.length==1&&pl({file:V[0],vfs:i.vfs})});var W=O;return typeof W=="function"?ge(W,z):O=z,F})()}),s),c.style.setProperty("margin-left","10px"),c.style.setProperty("margin-top","10px"),c.style.setProperty("display","inline-block"),d.style.setProperty("display","flex"),d.style.setProperty("flex-direction","column"),h.$$click=()=>e("/kitty-demo"),p.$$click=()=>e("/pixel-editor"),g.$$click=()=>e("/level-builder"),f.$$click=()=>e("/music-editor"),y.$$click=()=>e("/model-editor"),b.$$click=()=>e("/script-editor"),m.$$click=()=>e("/colour-picker"),k.$$click=()=>e("/reactive-sim"),v.$$click=()=>e("/vector-editor"),w.$$click=()=>e("/gravity-test"),x.$$click=()=>e("/three-body"),P.$$click=()=>e("/vfs-test"),C.$$click=()=>e("/automerge-webrtc-test"),T.$$click=()=>e("/connection-management"),M.$$click=()=>e("/debug-projection"),_.$$click=()=>e("/app"),E.$$click=()=>e("/auto-forms-test"),t})()};ke(["click"]);class gl extends Ps{peerId;peerMetadata}var fr={},at={},Bt={},Cn;function yl(){return Cn||(Cn=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=["other","new","good","old","little","great","small","young","long","black","high","only","big","white","political","right","large","real","sure","different","important","public","possible","full","whole","certain","human","major","military","bad","social","dead","true","economic","open","early","free","national","strong","hard","special","clear","local","private","wrong","late","short","poor","recent","dark","fine","foreign","ready","red","cold","low","heavy","serious","single","personal","difficult","left","blue","federal","necessary","general","easy","likely","beautiful","happy","past","hot","close","common","afraid","simple","natural","main","various","available","nice","present","final","sorry","entire","current","similar","deep","huge","rich","nuclear","empty","strange","quiet","front","wide","modern","concerned","green","very","alone","particular","bright","supposed","basic","medical","aware","total","financial","legal","original","international","soft","alive","interested","tall","warm","popular","tiny","top","normal","powerful","silent","religious","impossible","quick","safe","thin","familiar","gray","fresh","physical","individual","willing","crazy","sick","angry","perfect","tired","wild","moral","brown","dangerous","famous","married","terrible","successful","fair","professional","official","obvious","glad","central","chief","effective","light","complete","interesting","thick","proper","involved","responsible","narrow","civil","industrial","dry","yellow","specific","sharp","sudden","direct","following","growing","significant","traditional","slow","previous","vast","surprised","busy","usual","clean","funny","regular","scientific","ordinary","ancient","senior","sweet","future","annual","secret","equal","independent","wonderful","tough","broad","additional","careful","domestic","brief","enormous","commercial","grand","average","sexual","nervous","pale","immediate","critical","proud","like","complex","separate","considerable","still","extra","expensive","guilty","active","mad","asleep","wooden","cool","presidential","apparent","weak","essential","living","pretty","cultural","useful","actual","unusual","daily","potential","wet","solid","lovely","comfortable","formal","outside","massive","sad","corporate","distant","loose","rare","stupid","visible","liberal","flat","pleased","pure","curious","practical","upper","technical","male","appropriate","fat","just","due","mere","handsome","mental","conservative","positive","leading","naked","false","drunk","dirty","friendly","constant","well","used","emotional","internal","odd","historical","female","ill","broken","capable","southern","pleasant","bare","minor","eager","lucky","urban","steady","fiscal","rough","primary","reasonable","typical","inner","favorite","attractive","slight","innocent","limited","straight","pink","excellent","double","dramatic","violent","honest","electric","fellow","substantial","opposite","awful","severe","joint","armed","hungry","remarkable","increased","gentle","illegal","middle","bitter","mass","permanent","increasing","damn","golden","correct","intense","round","northern","proposed","so-called","criminal","healthy","plain","vital","blind","native","intellectual","unknown","extreme","existing","raw","prime","brilliant","sensitive","extraordinary","sufficient","remaining","ultimate","unique","royal","initial","negative","fundamental","nearby","smart","strategic","educational","unlikely","smooth","modest","conventional","giant","scared","cheap","dear","delicate","anxious","valuable","standard","desperate","lonely","diplomatic","firm","wise","principal","congressional","occasional","ugly","vice","radical","faint","working","absolute","intelligent","racial","mutual","silly","fast","musical","tight","complicated","numerous","crucial","square","contemporary","bloody","western","endless","inevitable","environmental","constitutional","rapid","worried","lost","genuine","temporary","democratic","rural","regional","given","painful","literary","chemical","sophisticated","decent","academic","awake","conscious","revolutionary","surprising","elderly","agricultural","psychological","pregnant","live","adequate","superior","grateful","prominent","frightened","remote","overall","stiff","harsh","electronic","spiritual","okay","closed","excited","convinced","long-term","unexpected","dull","evident","civilian","mysterious","romantic","impressive","continuing","exciting","logical","peculiar","exact","widespread","foolish","extensive","evil","continued","confident","generous","legislative","stable","vulnerable","elegant","embarrassed","hostile","efficient","blond","dumb","advanced","defensive","outer","neat","estimated","wealthy","dying","loud","creative","acceptable","unhappy","sheer","competitive","concrete","reluctant","precious","tremendous","burning","precise","uncertain","holy","artificial","vague","ideal","universal","moderate","subtle","mild","peaceful","assistant","invisible","casual","crowded","crude","running","classic","controversial","ridiculous","frequent","grim","accurate","detailed","goddamn","fun","fierce","cruel","incredible","blank","dim","suitable","classical","elaborate","collective","eastern","legitimate","aggressive","rear","administrative","automatic","dependent","ashamed","distinct","fit","clever","brave","ethnic","maximum","relative","primitive","uncomfortable","profound","sacred","biological","identical","furious","loyal","rational","mechanical","mean","naval","noble","ambitious","purple","historic","dominant","suburban","developing","calm","frozen","subsequent","charming","damp","fixed","rigid","offensive","electrical","shy","continuous","urgent","weary","immense","splendid","downtown","uneasy","disappointed","helpless","voluntary","polite","junior","gross","striking","overwhelming","unconscious","steep","outstanding","tender","tragic","costly","miserable","near","useless","welcome","external","helpful","weekly","middle-aged","suspicious","old-fashioned","technological","damned","awkward","visual","organized","ideological","orange","horrible","strict","magnificent","deadly","dusty","mighty","puzzled","bold","global","passing","magic","fond","judicial","missing","definite","changing","rubber","theoretical","satisfied","promising","abstract","excessive","comparable","fatal","distinguished","inadequate","slender","artistic","known","sympathetic","favorable","cheerful","faithful","delighted","unnecessary","sole","cautious","productive","reliable","patient","sensible","desirable","depressed","atomic","able","instant","relevant","alien","spectacular","lesser","swift","comic","enthusiastic","marvelous","experimental","weird","retired","fascinating","content","medieval","inclined","bored","ruling","flying","consistent","organic","alleged","grave","smiling","realistic","amazing","exotic","symbolic","confused","underground","spare","philosophical","vigorous","troubled","shallow","amused","lively","genetic","impatient","brutal","solar","unfair","formidable","tense","unfortunate","minimum","sleeping","secondary","shiny","jealous","insane","gay","vivid","wounded","hurt","intimate","monthly","sour","socialist","worthy","preliminary","colonial","middle-class","alternative","influential","unpleasant","comprehensive","devoted","upset","secure","absurd","neutral","frightening","profitable","fragile","civilized","slim","partial","added","fearful","optimistic","isolated","eternal","vocal","beloved","alert","verbal","rising","skilled","antique","municipal","written","restless","outdoor","governmental","driving","sore","informal","loving","retail","hidden","determined","monetary","convenient","thoughtful","colored","progressive","bizarre","sweeping","fancy","expected","fantastic","editorial","intact","bottom","multiple","well-known","nasty","protective","acute","combined","related","fortunate","earnest","divine","passionate","icy","noisy","vicious","dreadful","apt","boring","unprecedented","decisive","sunny","marked","experienced","disturbing","satisfactory","sober","random","electoral","shocked","deliberate","coming","orderly","surrounding","unwilling","inherent","mixed","naive","dense","hopeless","aesthetic","supreme","encouraging","institutional","solemn","stubborn","required","relaxed","bald","frantic","exclusive","rotten","filthy","flexible","explicit","glorious","lean","ignorant","extended","embarrassing","architectural","mortal","corrupt","hopeful","regulatory","valid","characteristic","tribal","capitalist","diverse","functional","improved","ironic","graceful","unaware","respectable","eligible","lousy","established","postwar","objective","wary","elementary","moving","superb","cute","minimal","meaningful","notable","structural","developed","rolling","fashionable","persistent","distinctive","terrific","thorough","skeptical","secular","chronic","level","everyday","visiting","infinite","short-term","terrorist","youthful","unemployed","forced","liquid","explosive","rude","colorful","renewed","semantic","astonishing","passive","heroic","gleaming","indifferent","vertical","prior","anonymous","absent","customary","mobile","uniform","solitary","probable","amazed","petty","bleak","athletic","tentative","harmless","ample","right-wing","polished","obscure","sincere","dried","intensive","equivalent","convincing","idle","vacant","mature","amusing","competent","ominous","savage","motionless","tropical","blunt","drunken","delicious","lazy","ragged","longtime","nationwide","startling","civic","freezing","muscular","circular","imperial","irrelevant","countless","gloomy","startled","disastrous","skinny","hollow","upward","ethical","underlying","careless","wholesale","abandoned","unfamiliar","mandatory","imaginary","bewildered","annoyed","magnetic","dazzling","lengthy","stern","surgical","clinical","full-time","metropolitan","moist","unlike","doubtful","prosperous","keen","awesome","humble","interior","psychiatric","clumsy","outraged","theatrical","educated","gigantic","scattered","privileged","sleepy","battered","meaningless","predictable","gradual","miniature","radioactive","prospective","aging","destructive","authentic","portable","bearded","balanced","shining","spontaneous","bureaucratic","inferior","sturdy","cynical","exquisite","talented","immune","imaginative","ripe","shared","kind","parliamentary","glowing","frail","astonished","forward","inside","operational","faded","closing","pro","coastal","shrewd","preoccupied","celebrated","wicked","bourgeois","marginal","transparent","dynamic","psychic","plump","coarse","bleeding","striped","eventual","residential","hysterical","pathetic","planned","fake","imminent","sentimental","stunning","worldwide","militant","sizable","representative","incapable","provincial","poetic","injured","tactical","selfish","winning","foul","repeated","novel","dubious","part-time","abrupt","lone","overseas","grey","varied","cooperative","muddy","scheduled","legendary","arrogant","conspicuous","varying","devastating","vulgar","martial","amateur","mathematical","deaf","scarce","specialized","honorable","outrageous","confidential","fallen","goddamned","five-year","feminine","monstrous","brisk","systematic","exhausted","frank","lunar","daring","shadowy","respected","stark","accepted","successive","pending","prolonged","unseen","uniformed","wretched","sullen","arbitrary","drastic","crooked","resulting","intricate","unpredictable","printed","utter","satisfying","delightful","linguistic","shabby","statistical","accessible","prestigious","trivial","waiting","futile","prepared","aged","misleading","cognitive","shocking","childish","elected","magical","forthcoming","exceptional","gifted","stricken","fiery","cardboard","shaky","conflicting","commanding","starving","accustomed","rocky","long-range","floating","sinister","potent","phony","lasting","understandable","curved","barren","lethal","toxic","deserted","ambiguous","notorious","synthetic","worthwhile","imported","intent","reduced","painted","taut","sociological","questionable","crisp","pointed","harmful","horizontal","rival","somber","benign","prevailing","selected","organizational","excess","dedicated","veteran","implicit","prudent","plausible","confusing","smoking","large-scale","subdued","constructive","marital","scarlet","rugged","darkened","untouched","above","matching","covert","communal","sticky","affluent","energetic","stale","controlled","qualified","reminiscent","shut","blonde","handy","ritual","straightforward","terminal","dizzy","sane","twisted","occupied","finished","opposing","sly","depressing","irregular","marine","communist","obscene","wrinkled","unsuccessful","gracious","static","consecutive","reserve","exposed","scholarly","sleek","reckless","oral","comforting","pressing","swollen","viable","carved","obsessed","projected","hideous","unthinkable","mock","susceptible","respective","goddam","downward","memorable","worn","raised","glittering","beneficial","lingering","patriotic","stunned","hairy","worrying","lighted","sexy","abundant","tangled","perpetual","irresistible","terrified","compelling","unmistakable","feeble","uneven","trained","folded","relentless","killed","gorgeous","conservation","serene","eerie","premature","dismal","competing","risky","unacceptable","indirect","witty","muffled","feasible","interstate","heated","uncommon","accidental","queer","innovative","parallel","fried","unnatural","cracked","persuasive","integrated","ongoing","homosexual","sound","fertile","canned","preceding","worldly","onstage","declining","advisory","juvenile","slippery","numb","postal","olive","eccentric","lay","chilly","shrill","ceremonial","registered","boiling","contradictory","irresponsible","then","industrialized","obsolete","rusty","inflationary","split","discreet","intolerable","barefoot","territorial","outspoken","audible","adverse","associate","impending","decorative","luminous","two-year","expanding","unchanged","outstretched","momentary","good-looking","cunning","overnight","sprawling","unbelievable","bland","liable","terrifying","televised","appealing","breathless","alarming","supporting","greasy","affirmative","guiding","homeless","triumphant","rainy","stolen","empirical","timid","provocative","knowledgeable","pragmatic","touching","desired","amiable","attempted","humane","adjacent","superficial","greedy","assorted","elusive","ruthless","lush","soothing","imposing","preferred","lavish","pervasive","managing","sandy","inappropriate","desolate","nude","reassuring","shimmering","first-class","unfinished","insistent","comparative","conceivable","admirable","courageous","aristocratic","meager","subjective","vain","disgusted","dual","towering","responsive","ailing","compact","torn","sortal","entertaining","dreary","metallic","tedious","irrational","immoral","teen-age","interim","jagged","selective","volatile","cozy","unanimous","unlimited","hired","cosmic","indoor","retarded","gold","fabulous","dignified","long-distance","high-school","classified","luxurious","insufficient","pious","incomplete","oblivious","imperialist","stately","lifelong","subordinate","extravagant","intrinsic","unpopular","scant","surplus","radiant","ruined","grotesque","hazardous","disabled","intriguing","worthless","reported","hoarse","utmost","muted","bony","disgusting","monumental","pleasing","sterile","agreeable","three-year","tricky","lucrative","respectful","inexpensive","bulky","troublesome","affectionate","coherent","unreasonable","nineteenth-century","curly","indispensable","nursing","incompetent","governing","alternate","suspected","left-wing","refined","overt","chilling","virtual","devoid","perverse","enduring","outright","overhead","unnoticed","nonprofit","pointless","appalling","dental","chosen","enlightened","robust","commonplace","damaging","conscientious","eloquent","erratic","applied","merry","ardent","flowing","incoming","chaotic","noticeable","pitiful","locked","swelling","definitive","homemade","super","pronounced","kindly","prone","attentive","unstable","unrelated","charitable","armored","unclear","tangible","medium","winding","slick","credible","frustrating","shifting","spacious","day-to-day","surviving","expanded","arid","unwanted","unbearable","hesitant","recognizable","multinational","abdominal","murderous","glossy","mute","working-class","insignificant","ingenious","masculine","blessed","gaunt","miraculous","unconstitutional","parental","rigorous","bodily","impersonal","backward","computerized","four-year","unmarried","wry","resident","luxury","high-level","partisan","powerless","seasonal","self-conscious","triple","onetime","ecological","periodic","racist","exaggerated","facial","erotic","unreal","durable","manual","rounded","concentrated","literal","mystical","stimulating","staggering","tempting","last-minute","erect","feudal","head","emerging","hind","brooding","candid","paranoid","defective","linear","immortal","shattered","unsure","swinging","compatible","ghastly","investigative","rosy","convicted","sensational","committed","makeshift","tolerant","forceful","supernatural","joyous","limp","improper","hanging","sliding","renowned","tattered","nonexistent","supportive","frustrated","undercover","handicapped","apprehensive","plentiful","authoritative","sustained","disappointing","hereditary","photographic","impoverished","ornate","respiratory","substantive","acting","nutritional","unofficial","innumerable","prevalent","dire","menacing","outward","brittle","hasty","sparkling","sled","geographical","therapeutic","melancholy","adolescent","hearty","disturbed","sweaty","poisonous","paid","ineffective","humorous","burly","rebellious","reddish","stout","teenage","eminent","rhythmic","physiological","guaranteed","opaque","folding","fleeting","full-scale","low-income","infectious","stringent","stained","beige","stirring","soaring","glamorous","airborne","improbable","austere","anticipated","designated","oval","restrictive","yearly","precarious","relieved","said","feverish","occupational","holding","speculative","abnormal","challenging","healing","boyish","forbidding","divorced","famed","sluggish","struggling","united","undesirable","steaming","consulting","answering","recreational","accompanying","cramped","journalistic","neighboring","fictional","chopped","phenomenal","bankrupt","illicit","advancing","upcoming","racing","protected","padded","venerable","fuzzy","behavioral","roast","mocking","reactionary","inefficient","packed","sloppy","sparse","foster","revealing","reverse","gaping","blue-collar","thankful","down","unimportant","traveling","corresponding","maternal","autonomous","conceptual","smoky","baked","stuffed","murky","totalitarian","ghostly","seeming","flickering","sensual","clenched","offshore","stinging","oppressive","strained","messy","executive","evolutionary","theological","damaged","unrealistic","rectangular","off","mainstream","benevolent","thirsty","blinding","loaded","applicable","unused","crushed","tan","factual","involuntary","brand-new","akin","scary","modified","mindless","born","feminist","integral","uncanny","aloof","spreading","watery","playful","stocky","wasted","compulsory","indignant","pertinent","incredulous","simultaneous","turbulent","framed","aching","falling","cardiac","trim","silvery","accused","pastoral","barbed","adjoining","inspired","courteous","skillful","majestic","gilded","published","perennial","upright","seasoned","continual","papal","victorious","optical","ecstatic","agonizing","shameful","expressive","inconsistent","insulting","cloudy","defiant","restricted","approaching","aggregate","orthodox","unified","all-out","wooded","nationalist","favored","lofty","assured","smug","earthly","improving","instrumental","stray","clandestine","managerial","animated","intended","flawed","bent","clerical","outgoing","righteous","unspoken","poignant","faulty","defeated","authoritarian","treacherous","catastrophic","refreshing","unidentified","suicidal","sickly","disciplined","meticulous","preferable","trusted","hectic","husky","distraught","select","snowy","ferocious","crumpled","humiliating","divided","crippled","infamous","chic","broke","sovereign","continental","idealistic","first-rate","guarded","learned","nameless","runaway","metaphysical","senseless","boiled","needy","silver","recorded","polar","real-estate","stormy","incomprehensible","wiry","raging","composite","flamboyant","crimson","reproductive","intermediate","ubiquitous","repressive","hefty","listening","good-natured","parochial","stylish","high-tech","flaming","coronary","overweight","bathing","three-day","tidy","beleaguered","manifest","ludicrous","indigenous","adamant","placid","inept","exuberant","stony","salty","seductive","accomplished","impassive","grazing","congenial","misguided","wide-eyed","revised","bass","sonic","budgetary","halfway","ensuing","admiring","palpable","nightly","hooded","best-known","eighteenth-century","dissident","morbid","incumbent","demanding","inexperienced","hazy","revolving","rented","disadvantaged","innate","dietary","minute","cultivated","sealed","contemptuous","rhetorical","conciliatory","articulate","jobless","macho","forgotten","lifeless","proven","latent","secretive","perilous","token","graphic","alcoholic","overdue","permissible","shattering","preventive","illiterate","back","atmospheric","thermal","quaint","negotiated","preposterous","temporal","restrained","triangular","mayoral","spatial","heady","biblical","fitting","pessimistic","mammoth","allied","failed","intuitive","nagging","tidal","angular","speechless","finishing","protracted","watchful","businesslike","automated","versatile","booming","pouring","misty","deceptive","sunken","singular","suspended","unworthy","immigrant","expressionless","airy","mournful","neurotic","cubic","unauthorized","economical","fund-raising","captive","blatant","far-reaching","subversive","imperfect","jolly","inaccurate","resentful","strenuous","suffering","hardened","malicious","unjust","perceptive","newborn","promised","differing","virgin","alarmed","grassy","frivolous","apologetic","wasteful","endangered","unarmed","adept","unavoidable","approved","trembling","stuck","high-ranking","crushing","prescribed","dependable","fragrant","expansive","unfriendly","covered","bemused","digital","probing","sloping","man-made","festive","unilateral","unmarked","bipartisan","statewide","burgeoning","devout","sickening","mediocre","adventurous","elevated","suggestive","accountable","virtuous","lame","heavenly","bruised","unbroken","irritable","affected","inconceivable","sometime","vile","baggy","timely","glistening","imagined","unprepared","unresolved","windy","humanitarian","overriding","detached","annoying","narrative","interminable","appalled","penal","unsatisfactory","instinctive","variable","cumulative","obedient","deficient","colossal","unaffected","extinct","routine","microscopic","compassionate","nominal","forlorn","distorted","mistaken","enclosed","infected","fervent","analogous","frigid","instructive","appointed","one-way","gnarled","problematic","sardonic","two-hour","hypothetical","prompt","anguished","electromagnetic","sensuous","homely","beaten","malignant","rotting","concealed","peripheral","creaking","impeccable","khaki","grinning","irreversible","rampant","wondrous","inward","manufactured","grisly","cooked","discriminatory","cerebral","knowing","auxiliary","operative","losing","genial","phonetic","ecclesiastical","sarcastic","incorrect","ruddy","well-to-do","inexplicable","unreliable","developmental","woolen","agitated","lyrical","consequent","calculated","molecular","pompous","present-day","shaggy","even","inhuman","sublime","diagnostic","manly","raucous","balding","after","bilateral","mounted","blackened","assembled","separated","gaudy","evangelical","darling","juicy","impotent","receptive","irritating","pulmonary","dazed","cross-country","unavailable","parked","habitual","lexical","lowered","unwise","planetary","throbbing","enigmatic","superstitious","threatening","manned","childlike","sporting","right-hand","adult","reflective","white-haired","discernible","celestial","prodigious","translucent","equitable","epic","frayed","arduous","flimsy","penetrating","howling","disparate","alike","all-time","deformed","comical","inert","procedural","resistant","vibrant","geographic","wistful","specified","rightful","spirited","unborn","enjoyable","regal","cumbersome","burned","frenzied","gubernatorial","deteriorating","haunted","evasive","neglected","anthropological","inescapable","clear-cut","visionary","bloated","accumulated","agrarian","pained","dwindling","heightened","gray-haired","distressing","grinding","insecure","archaic","piercing","fluent","leisurely","giddy","slimy","oncoming","short-lived","spinal","wholesome","unanswered","illegitimate","staunch","two-day","rumpled","speedy","soaked","rocking","invaluable","gallant","tacit","finite","inviting","sporadic","powdered","cheery","volcanic","optional","mischievous","flowered","contagious","automotive","inflated","mythic","analytical","infrared","two-week","binding","ancestral","dissatisfied","upstate","veritable","unaccustomed","oily","monotonous","seated","feeding","fluorescent","undue","impassioned","picturesque","vocational","tranquil","tumultuous","rustic","patterned","two-story","pagan","flash","playing","exhilarating","maiden","three-dimensional","mythical","thriving","drab","black-and-white","honorary","dingy","founding","imperative","indistinguishable","lightweight","avid","dreamy","everlasting","obsessive","tional","homogeneous","inner-city","changed","tame","colorless","haggard","implacable","altered","unequal","focal","perceptual","literate","priceless","diminishing","harmonious","dark-haired","fatty","squat","undecided","banal","fruitful","pioneering","innocuous","cordial","rewarding","unsafe","maritime","overcrowded","timeless","fledgling","nostalgic","abreast","one-time","humid","astronomical","one-man","deepening","blazing","fleshy","dishonest","succeeding","qualitative","needless","rickety","joyful","stated","ambivalent","hybrid","six-month","limiting","workable","sleepless","unpaid","mundane","flashy","stagnant","bumper","recurring","sinful","immaculate","synonymous","measured","thrilling","long-standing","unruly","bewildering","unfit","edgy","numerical","sumptuous","fragmented","puffy","elastic","high-pitched","momentous","woven","unsteady","unnamed","cosmetic","snap","impenetrable","floral","waving","promotional","tenuous","lonesome","embroidered","strident","cherished","aghast","fundamentalist","white-collar","afloat","disruptive","law-enforcement","gathered","indefinite","intervening","publicized","geometric","disciplinary","descriptive","wavy","edible","disgruntled","obligatory","untrue","amber","snug","resolute","awed","simplistic","grandiose","crippling","high-speed","mounting","glaring","small-town","cavernous","hushed","wage-price","demographic","diseased","unpublished","causal","defenseless","sheltered","dormant","compulsive","loved","willful","truthful","punitive","disposable","ajar","drowsy","statutory","tanned","proprietary","informed","unheard","decision-making","transient","unlawful","dour","negligible","underwater","optimum","illusory","imaginable","borrowed","divergent","looking","exempt","contentious","forbidden","cowardly","masked","crazed","silken","parched","furry","wandering","insensitive","over-all","elated","waxed","veiled","envious","insidious","scrawny","unwarranted","lithe","abrasive","pretentious","far-off","murdered","deft","prickly","musty","shapeless","incongruous","gruesome","honored","perceived","grieving","unspecified","dizzying","privy","noteworthy","charred","median","fearless","twisting","unattractive","flawless","welcoming","flushed","hardy","glum","scenic","devious","recurrent","distasteful","jubilant","ballistic","hilarious","naughty","bustling","discarded","pristine","exemplary","fading","complacent","incessant","engaging","twentieth-century","protectionist","rudimentary","traumatic","steamy","emphatic","hard-line","teeming","generating","stuffy","connecting","stationary","genteel","populist","supple","hateful","retrospective","glazed","lawful","arched","tiresome","lucid","reserved","pivotal","grimy","surly","anti-Soviet","contrary","quarterly","old-time","residual","spiral","decaying","threatened","docile","appreciative","jovial","fascist","worrisome","red-haired","undisturbed","creamy","well-dressed","serial","existential","mountainous","pastel","self-sufficient","spoken","express","tasty","maroon","infrequent","deceased","full-fledged","transitional","leafy","gravitational","furtive","prophetic","nasal","unwelcome","troubling","immobile","merciful","uncontrollable","impartial","unfavorable","attendant","associated","high-rise","vascular","fateful","concerted","rash","stubby","paramount","impulsive","fraudulent","drooping","reciprocal","usable","fast-food","touchy","astute","oversized","mottled","slack","fruitless","unhealthy","decorated","shady","shaped","fanciful","quivering","charismatic","sordid","oppressed","inaccessible","fastidious","brazen","gloved","crumbling","underdeveloped","scarred","rambling","incipient","remedial","derelict","incompatible","fanatical","smoked","secondhand","hypnotic","failing","marching","flattened","paradoxical","unskilled","esthetic","tolerable","pungent","substitute","soggy","terse","tiring","fictitious","manageable","inventive","haughty","normative","premier","grudging","vested","exhausting","cross-legged","self-evident","away","horrified","prolific","incoherent","quantitative","full-length","year-round","unkind","provisional","exterior","brash","inconclusive","landed","breathtaking","acrid","noted","resultant","long-time","resounding","lovable","hypocritical","plush","foggy","acknowledged","idiotic","tracking","ceramic","taxable","enterprising","flashing","wee","barbaric","deafening","orbital","lurid","dated","hated","buoyant","mating","pictorial","overlapping","lax","archetypal","manic","limitless","puzzling","condescending","hapless","meek","faceless","uncommitted","horrid","greenish","unorthodox","unending","accelerated","day-care","undeniable","bushy","searing","fearsome","unharmed","divisive","overpowering","diving","telling","determining","uptight","cast","enlarged","ebullient","disagreeable","insatiable","grown-up","demented","puffing","inconvenient","uncontrolled","inland","repulsive","unintelligible","blue-eyed","pallid","nonviolent","dilapidated","unyielding","astounded","marvellous","low-cost","purposeful","courtly","predominant","conversational","erroneous","resourceful","converted","disconcerting","oblique","dreaded","indicative","silky","six-year","front-page","biting","flowering","sunlit","licensed","unspeakable","adrift","awash","identifiable","girlish","zealous","spooky","uncompromising","deserving","driven","certified","unlucky","temperate","budding","impractical","public-relations","inflexible","sensory","pornographic","outlandish","resonant","belligerent","wan","leftover","spotted","soybean","easygoing","vengeful","proportional","inaugural","dank","screaming","heterosexual","sliced","year-old","considerate","thunderous","distressed","warring","assertive","foreseeable","psychotic","intermittent","anti-Communist","generalized","unable","molten","excruciating","illustrious","voluminous","offending","trustworthy","grating","laughing","one-year","industrious","uninterrupted","dashing","speaking","metabolic","flattering","one-sided","ineffectual","primal","digestive","taped","floppy","jaunty","practiced","walled","hospitable","dutiful","melodramatic","intestinal","cluttered","conclusive","complementary","unprotected","buzzing","attributable","tasteless","forthright","wily","hourly","delayed","sweating","affable","studied","chubby","thyroid","chilled","conducive","childless","faltering","authorized","buried","land-based","observable","hurried","curving","dismayed","pernicious","upturned","believable","questioning","syndicated","pharmaceutical","high-risk","resigned","discrete","likable","imprisoned","cocky","outdated","autocratic","ablaze","askew","grammatical","wintry","incidental","matter-of-fact","disputed","exorbitant","low-level","sodden","skeletal","disproportionate","soiled","cellular","ephemeral","perfunctory","inconsequential","flourishing","intentional","two-way","elemental","whispered","four-day","stinking","informative","tenacious","outlying","virulent","horrendous","horrifying","burnt","longstanding","senile","unmoving","deprived","interpersonal","intimidating","posh","dainty","portly","nondescript","inquisitive","exiled","capricious","scandalous","severed","debilitating","widowed","horny","sallow","up-to-date","self-contained","carefree","boisterous","coordinated","anti-Semitic","superfluous","metric","expressed","enchanting","disorderly","paternal","wanton","frightful","free-lance","extremist","lined","scornful","inseparable","obese","ponderous","imperious","indistinct","adrenal","belated","rippling","valiant","livid","mystic","cracking","subterranean","invading","rusted","esoteric","red-faced","segregated","lanky","departmental","allergic","predatory","enforced","anti-inflation","implied","flagrant","best-selling","haphazard","trailing","seedy","real-life","unannounced","utilitarian","roving","despairing","immature","simulated","embattled","poisoned","patronizing","baffled","centralized","weathered","weeping","mutilated","painstaking","tax-exempt","socioeconomic","tearful","stringy","projecting","low-key","single-minded","shadowed","vehement","darn","fluffy","apocalyptic","completed","intelligible","furnished","elongated","worsening","eclectic","bacterial","earthy","sagging","wide-ranging","face-to-face","settled","dogmatic","anti","secluded","baffling","coy","pathological","echoing","bridal","autobiographical","instantaneous","ornamental","satirical","voluptuous","movable","kinetic","merciless","tireless","three-month","unconcerned","impromptu","turning","follow-up","retaliatory","arcane","waterproof","justifiable","glassy","unearthly","shuttered","inverted","bogus","petrified","simmering","guided","gritty","widening","generic","pretrial","returning","boundless","swirling","northeastern","swell","tive","minuscule","estranged","upbeat","explanatory","repetitive","repressed","vindictive","shrinking","canny","little-known","hydraulic","unrelenting","looming","supersonic","justified","lukewarm","unmoved","blurred","double-breasted","sanitary","unforgettable","diligent","unconventional","ashen","wordless","stainless","inlaid","irritated","spotless","pudgy","yellowish","lateral","adopted","lowly","obnoxious","utopian","called","unimaginable","hairless","foregoing","opulent","garish","nocturnal","rousing","unexplained","cosmopolitan","milky","medium-sized","all-night","bloodshot","rueful","hard-working","crafty","familial","iced","violet","arctic","ceaseless","exasperated","warped","aquatic","gruff","terrestrial","contrasting","egalitarian","needful","spent","untrained","escalating","liberated","long-haired","abortive","syntactic","consummate","lumpy","spoiled","ten-year-old","talkative","whimsical","weighty","audio","inflammatory","deplorable","spicy","corrugated","morose","sobering","southwestern","three-year-old","methodical","prehistoric","carpeted","smelly","processed","overheated","interstellar","agile","approximate","sadistic","living-room","irate","smashed","frontal","venereal","indiscriminate","suggested","cultured","creeping","recognized","toothless","handmade","mellow","fetal","disinterested","gratifying","trusting","small-scale","intravenous","crashing","exhaustive","afire","clammy","sleazy","florid","heartless","transcendent","restored","demonic","abusive","avowed","shrunken","objectionable","tailored","arms-control","listless","polluted","palatable","funded","elective","entrenched","classy","operatic","daunting","roaring","preferential","languid","three-hour","virile","inspiring","enhanced","scrupulous","bottomless","ginger","wispy","advantageous","rapt","umbilical","uphill","ordered","enraged","detrimental","curt","exalted","hard-pressed","intangible","fussy","forgiving","facile","populous","condemned","mashed","hard-boiled","introductory","rowdy","switching","perplexing","spilled","southeastern","undulating","fractured","inherited","inscrutable","measurable","stunted","hormonal","stylized","hierarchical","air-conditioned","aimless","subsidized","paying","symmetrical","nomadic","cloudless","reigning","thatched","perceptible","anesthetic","anti-American","miscellaneous","homesick","preparatory","seven-year","big-city","decadent","searching","all-important","inanimate","senatorial","diminutive","soft-spoken","contingent","dusky","smashing","precipitous","bulging","standardized","biographical","restive","indecent","upper-class","ecumenical","interchangeable","lumbering","fascinated","untidy","indulgent","leaden","wanted","endemic","doomed","wanting","receiving","engaged","unparalleled","abbreviated","malevolent","wishful","carnival","world-wide","protruding","resplendent","stranded","structured","biased","frosty","northwestern","viral","mindful","paved","indeterminate","painless","second-floor","geological","permissive","downhill","unsuspecting","expectant","fabled","jittery","windowless","evocative","unsolved","disoriented","monastic","soluble","misshapen","antiquated","repugnant","non-Communist","retiring","shaded","combative","high-powered","resilient","antagonistic","starched","vice-presidential","speckled","lopsided","bluish","late-night","prim","unrestrained","almighty","tyrannical","unkempt","menstrual","bleached","overgrown","idiosyncratic","shoddy","hallowed","trying","halting","princely","drugged","gratuitous","descending","fatherly","avant-garde","laborious","pinched","disguised","caustic","bespectacled","handwritten","goodly","itinerant","cryptic","undisclosed","affordable","outmoded","expedient","moody","tepid","firsthand","digging","elitist","observed","chartered","slain","five-day","unimpressed","tactful","idyllic","prostrate","ramshackle","expert","deferred","undistinguished","prized","transatlantic","crystalline","tacky","haunting","nutritious","bereft","turquoise","time-consuming","sanguine","culinary","fraught","precocious","assigned","scrambled","advisable","nationalistic","long-awaited","unwrapped","unchallenged","circumstantial","pleasurable","compressed","humanistic","unforeseen","diversified","frenetic","disapproving","proletarian","conspiratorial","featureless","going","commendable","no-nonsense","chipped","surreal","salient","pissed","insurmountable","backstage","contented","indebted","adoring","one-room","prewar","potted","accelerating","thorny","possessive","abiding","ever-increasing","bloodless","high-technology","counterproductive","attracting","entrepreneurial","cooling","unoccupied","craggy","leathery","degenerate","additive","weakened","quilted","untold","incandescent","intractable","middle-income","abject","self-made","gaseous","anal","displaced","unabashed","immutable","fluttering","ten-year","bearable","stamped","darkening","beefy","petite","charging","high-quality","left-hand","age-old","checkered","stupendous","priestly","loath","endearing","exacting","correctional","freak","sneaky","disgraceful","unholy","oriental","wayward","societal","hard-core","bilingual","flipping","staid","paramilitary","heartfelt","shapely","kosher","heedless","incurable","controlling","in-house","choral","manicured","cardinal","inconspicuous","steely","vanishing","misplaced","centre-fire","enchanted","unfounded","wrecked","womanly","delirious","deposed","panicky","differential","tawny","articulated","coded","wide-open","unregulated","lenient","feathered","simplified","beguiling","sectarian","producing","tiled","inorganic","frosted","lusty","scented","rotating","grievous","dissimilar","salaried","unequivocal","strangled","grubby","alluring","downcast","restraining","unjustified","contaminated","lacy","cinematic","second-class","splintered","adorable","derisive","state-owned","requisite","fleeing","uncomplicated","motherly","inter","high-heeled","climatic","republican","unqualified","leveraged","intercontinental","uncharacteristic","compositional","unwritten","patriarchal","brusque","unresponsive","replete","corrective","reflected","scraping","doctoral","premium","deductible","alternating","amorous","overjoyed","recalcitrant","presumptuous","vaulted","declared","inexorable","groggy","diminished","restful","retroactive","presumed","monolithic","curtained","tortured","ground","trendy","brassy","prosaic","inactive","chaste","bumpy","aggrieved","corny","centrist","trapped","noxious","jerky","concomitant","withholding","poorly","stolid","unguarded","methodological","primordial","retreating","telescopic","sidelong","off-duty","pleated","dissenting","agreed","double-action","optimal","plaintive","banned","kindred","quintessential","impervious","jumping","disenchanted","observant","congested","second-rate","reasoned","extrinsic","infantile","transitory","coveted","small-time","doctrinal","incomparable","jaded","special-interest","sociable","shameless","coloured","ascending","fraternal","queasy","wont","exhilarated","salted","disquieting","listed","unchanging","nine-year-old","unrestricted","uppermost","reputable","dummy","skimpy","crusty","corrosive","bubbling","decrepit","unsuitable","snarling","destitute","illuminating","systemic","material","unwashed","rushing","dialectical","jeweled","attached","liberating","judicious","errant","vanished","worn-out","erstwhile","uninformed","twelve-year-old","longterm","petulant","twin","self-righteous","afflicted","snappy","tantamount","sworn","unethical","drained","hydroelectric","perplexed","logistical","concentric","unifying","lunatic","invincible","diffident","inexhaustible","discouraging","dreamlike","artful","rolled","suppressed","secretarial","smoldering","redundant","forensic","million-dollar","self-styled","earned","weightless","signed","compensatory","glacial","unmanned","stalwart","funky","intensified","uninterested","submerged","urbane","glib","ascetic","contractual","warlike","high-priced","diagonal","cylindrical","gargantuan","illuminated","unconditional","hulking","supplementary","dictatorial","puny","sedate","moonlit","eight-year-old","gullible","counterfeit","alienated","spinning","analytic","nimble","adaptive","individualistic","numbered","blissful","insolent","supplemental","delectable","inordinate","unbalanced","tormented","unchecked","aspiring","punishing","self-serving","crossed","discretionary","box-office","snow-covered","improvised","squalid","orphaned","grizzled","unsmiling","disappearing","affiliated","readable","blocking","bullish","contending","burned-out","bloodied","subsidiary","complimentary","unclean","scanty","uprooted","farfetched","solicitous","regulated","threadbare","choppy","ever-present","negligent","nonstop","one-day","wild-eyed","infuriating","vivacious","abominable","wrought","inaudible","braided","transcendental","desultory","climactic","appellate","interlocking","submissive","unmatched","dapper","demeaning","adaptable","well-meaning","lustrous","tax-free","ungrateful","gentlemanly","missed","loathsome","incalculable","blistering","amenable","tremulous","massed","nonpartisan","unsettled","three-story","succulent","trite","masterful","reticent","unsettling","proverbial","strapping","spurious","invulnerable","paltry","embryonic","repeating","neural","sultry","metaphorical","foreign-policy","linked","pubic","beaming","ministerial","phantom","quizzical","hilly","cold-blooded","gregarious","three-piece","untroubled","bisexual","pensive","unpretentious","exploratory","unscathed","irrepressible","pelvic","newfound","starry","corned","overworked","illogical","unfaithful","interrelated","saintly","overcast","connected","ungainly","organizing","carnal","philosophic","nationalized","fickle","ultraviolet","crass","undeveloped","unprofitable","sheepish","archaeological","out-of-town","balmy","spongy","infallible","callous","scathing","rheumatic","audacious","participating","swarthy","hand-held","comatose","modernist","stellar","antinuclear","delinquent","time-honored","presiding","relaxing","high-pressure","impetuous","hypodermic","fringed","favourite","unscrupulous","inspirational","mystified","wobbly","intrepid","deferential","burdensome","stored","supervisory","seventeenth-century","six-day","interdependent","updated","all-powerful","unitary","stand-up","laconic","penniless","steadfast","dogged","scholastic","convertible","mingled","sorrowful","symptomatic","stylistic","well-intentioned","consuming","sketchy","weakening","generative","atrocious","first-quarter","irrevocable","charged","stoned","dividing","apathetic","debatable","uncomprehending","overhanging","galloping","kinky","uncritical","suave","undisputed","spiky","inarticulate","extracurricular","guttural","impressed","departing","yellowed","discontented","adroit","high-fiber","second-hand","blinking","formless","unsavory","new-found","withered","collected","menial","unobserved","flabby","afterward","vanquished","stained-glass","hour-long","bittersweet","invalid","incriminating","commensurate","all-American","assumed","tried","cursory","absorbing","clearing","confirmed","stressful","depleted","eight-year","participatory","stripped","concave","regrettable","fortified","effortless","regressive","irreverent","collegiate","defunct","grainy","inhospitable","gripping","grizzly","restoring","arterial","busted","indomitable","demure","rabid","headlong","blue-green","bound","breezy","materialistic","uneducated","scruffy","cohesive","full-blown","cranky","motivated","mauve","hardworking","melodic","genital","decorous","comely","rife","purported","hurtful","six-foot","macabre","odious","convulsive","well-trained","heterogeneous","curled","pearly","spindly","latter-day","innermost","clipped","checked","masterly","laughable","naturalistic","tinkling","impudent","fitful","illustrated","speeding","roasted","in-depth","helluva","vigilant","empty-handed","forged","wrought-iron","disgraced","agonized","infirm","preserving","tasteful","onerous","shredded","impregnable","slanted","tainted","opened","first-time","machine-gun","bottled","seismic","fetid","saturated","insubstantial","full-page","aromatic","stingy","promiscuous","unlit","regimental","spellbound","streamlined","bereaved","ruffled","creepy","treasured","ensconced","one-party","well-educated","pert","mercantile","all-purpose","voracious","tortuous","despised","unadorned","offhand","qualifying","manipulative","indelible","well-established","revolting","ethereal","roasting","prohibitive","domed","whipped","overstuffed","garrulous","skittish","revived","heartening","jumpy","grilled","melted","unfocused","spectral","unproductive","top-level","life-size","three-way","negotiable","disloyal","turn-of-the-century","four-hour","unopened","devilish","amorphous","antiseptic","sharpened","primeval","unrecognizable","ineligible","expendable","deathly","auspicious","insoluble","inimical","unquestioned","far-flung","medicinal","deep-seated","formative","iridescent","fragmentary","distinguishable","auburn","closed-circuit","emeritus","third-floor","hazel","tumbling","departed","obstinate","portentous","quixotic","scorched","adjustable","winged","intrusive","taxing","high-ceilinged","barbarous","decreasing","sleeveless","unattended","tight-lipped","concluding","unobtrusive","starved","quirky","big-time","sooty","copious","stalled","scriptural","unconvincing","earthen","throaty","august","extant","sexist","exultant","cancerous","psychedelic","yielding","matched","chunky","unfathomable","concise","admitting","knitted","projective","euphoric","garbled","divisional","despondent","recommended","passable","vegetarian","indefatigable","irreparable","feisty","untenable","contrite","angelic","reputed","untimely","dejected","appreciable","remembered","hellish","rear-view","open-air","ill-fated","nonpolitical","factional","separatist","contributing","post-war","uneventful","metaphoric","unsound","unwitting","venomous","harried","engraved","collapsing","reformist","thematic","inclusive","cheering","springy","obliging","contemplative","unbridled","state-run","reflex","allegorical","geopolitical","disembodied","issuing","bountiful","alright","overbearing","muddled","congenital","distinguishing","absorbed","tart","french","autumnal","verifiable","grueling","crackling","aft","punishable","freckled","indestructible","imprecise","hard-nosed","thoughtless","through","proficient","pent-up","never-ending","hunted","defensible","arresting","across-the-board","spotty","orchestral","undefined","stacked","implausible","antitank","unwary","inflamed","sacrificial","oil-producing","leaky","mint","chronological","conquering","jumbo","three-week","addictive","uninhibited","substandard","contracting","degenerative","triumphal","flowery","cardiovascular","shaken","undefeated","unassuming","luscious","unperturbed","gleeful","sentencing","brawny","perfumed","mild-mannered","healthful","left-handed","rancid","well-defined","unmanageable","drowning","clinging","anachronistic","revered","enriched","capitalistic","good-by","invigorating","practicing","unsold","long-legged","unruffled","aboriginal","inane","bedraggled","early-morning","run-down","straight-backed","reverent","acquired","bestselling","top-secret","woolly","foolhardy","sticking","blue-black","impassable","overcome","coiled","front-line","tinted","acquisitive","slatted","octagonal","receding","investing","doctrinaire","all-white","caring","prejudiced","slow-moving","circulating","science-fiction","shortsighted","disaffected","lawless","chastened","lewd","rubbery","foaming","unsympathetic","ladylike","betrayed","neurological","shouting","good-sized","electrostatic","untoward","flabbergasted","citywide","unanticipated","knotted","whitewashed","year-end","enticing","migratory","multicolored","hashish","ascorbic","topless","heathen","spherical","filmy","deviant","centennial","proportionate","instructional","contrived","savvy","over-the-counter","fast-moving","measuring","uptown","compliant","favourable","unforgivable","undamaged","psychoanalytic","gebling","bubbly","ready-made","caged","ostentatious","superhuman","busing","cream-colored","self-destructive","ostensible","cobbled","whirling","released","showy","baleful","red-hot","named","monogamous","fallow","disdainful","cyclical","long-running","pitiless","diffuse","omnipresent","mossy","cutting","astounding","lyric","dark-blue","unsophisticated","indigent","coincidental","imperceptible","veterinary","coercive","multilateral","ageless","law-abiding","functioning","beneficent","crawling","overturned","steamed","comprehensible","oil-rich","undetected","ribbed","nautical","textured","fast-growing","nauseous","vaunted","paralyzed","maimed","short-range","impure","unintended","practicable","intermediate-range","unfulfilled","behind-the-scenes","backhand","voluble","goofy","apolitical","contraceptive","waning","blasted","sundry","profane","binary","rock-and-roll","ruinous","open-ended","next-door","withering","conical","flustered","decided","able-bodied","round-trip","decreased","half-empty","sponsored","riotous","stereotyped","five-minute","irreplaceable","harrowing","uninteresting","salutary","frugal","disjointed","cupped","freshwater","shaven","ravenous","bulbous","stepped-up","swaying","two-room","valued","planted","bright-eyed","unreadable","trucking","infatuated","dysfunctional","pinkish","futuristic","airtight","unseemly","sizzling","mercurial","conic","unfettered","undisciplined","unrecognized","well-publicized","income-tax","self-appointed","ice-cold","biochemical","contemptible","barefooted","droll","mythological","tree-lined","rearing","luxuriant","heartbreaking","tufted","well-organized","selfless","world-class","unwieldy","contested","rasping","downright","ingratiating","self-proclaimed","parasitic","graying","reformed","cautionary","untested","beaded","maniacal","eucalyptus","pliable","air-conditioning","moot","traceable","anti-abortion","antisocial","reprehensible","self-imposed","yellowing","teasing","porous","ersatz","unwavering","untouchable","underprivileged","auditory","escaping","subservient","unspoiled","anterior","fatuous","lordly","infernal","bouncing","taboo","orthopedic","spiteful","surging","nuts","esteemed","outlawed","pushy","displeased","self-confident","attainable","bowed","cast-iron","despicable","unconvinced","famished","coed","bygone","nonaligned","sectional","typed","squeaky","disparaging","cut-rate","heart-shaped","offbeat","velvety","well-worn","upsetting","leery","long-lost","horse-drawn","puritanical","payable","fertilized","predicted","allowable","peaceable","soundless","marshy","discordant","intoxicating","concurrent","uncut","tantalizing","pedagogical","accursed","two-man","connective","hawkish","ripped","cleared","double-digit","unencumbered","yawning","manifold","stopped","untreated","subliminal","grayish","gory","upper-middle-class","avenging","self-fulfilling","equatorial","saucy","barred","arch","midwestern","blue-gray","tarnished","leafless","incisive","unearned","botanical","feline","extraneous","prep","intransigent","change-minimizing","insurgent","acrimonious","thermonuclear","blue-chip","crummy","acoustic","oversize","fated","galactic","cantankerous","ill-advised","detectable","lower-class","sacrosanct","palatial","conditional","insulated","step-by-step","nebulous","two-dimensional","well-heeled","bronchial","subatomic","semifinal","first-year","dark-eyed","tinny","attacking","indecisive","anatomical","brotherly","blooming","sinuous","meditative","socalled","rheumatoid","received","bleary","half-naked","leaded","woody","averse","shuddering","door-to-door","heretical","suspect","untapped","ravaged","decentralized","rutted","ineffable","intolerant","mechanized","fortuitous","equestrian","seven-year-old","darting","consoling","modern-day","ground-floor","emblematic","lurking","two-year-old","purplish","disorganized","vaudeville","circulatory","eight-hour","presentable","anarchic","unsatisfied","labored","maudlin","trampled","gibberish","unaccountable","sedentary","heavy-duty","thrilled","tutoring","self-centered","do-it-yourself","inquiring","uncaring","disillusioned","bloodstained","surface-to-air","consular","subconscious","four-year-old","collaborative","terraced","figurative","sinewy","horn-rimmed","impertinent","hit-and-run","standby","medium-size","peremptory","incremental","first-aid","dyed","centrifugal","omnipotent","lascivious","two-month","unionized","discredited","mass-produced","feathery","self-indulgent","liturgical","enviable","fifteen-year-old","buxom","abashed","urinary","newsworthy","flailing","beastly","undiscovered","strong-willed","prenatal","brownish","announced","flaky","washed","nightmarish","broad-shouldered","short-sleeved","two-bit","self-assured","whitish","suffocating","black-haired","full-size","self-help","created","uninhabited","smokeless","no-fault","unfashionable","mushy","forested","adhesive","creased","insufferable","down-to-earth","trifling","landless","disreputable","self-effacing","sporty","confined","adoptive","monogrammed","motley","duplicate","silver-haired","rejected","undifferentiated","blasphemous","institutionalized","blue-and-white","hip","winsome","button-down","discerning","abused","clean-cut","bracing","self-supporting","unsupported","premarital","flattered","studious","repetitious","marketable","anemic","meaty","airless","unhurried","galvanized","feal","peace-keeping","rapacious","bulletproof","well-placed","helmeted","packaged","court-ordered","aggravated","gastrointestinal","hand-to-hand","sixteen-year-old","fretful","fourth-quarter","conquered","satiric","nutty","befuddled","humorless","pitched","burnished","mirrored","fishy","fluted","conditioned","military-industrial","one-story","barbarian","branching","dynastic","unthinking","unconscionable","hunched","post-World","capital","putative","incendiary","shaving","topical","self-satisfied","farcical","narcissistic","kneeling","born-again","old-line","amateurish","ill-fitting","scaly","unpainted","eroding"]),Bt}var qt={},_n;function bl(){return _n||(_n=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.default=["man","world","hand","room","face","thing","place","door","woman","house","money","father","government","country","mother","water","state","family","voice","fact","moment","power","city","business","war","school","system","car","number","office","point","body","wife","air","mind","girl","home","company","table","group","boy","problem","bed","death","hair","child","sense","job","light","question","idea","law","word","party","food","floor","book","reason","story","son","heart","friend","interest","right","town","history","land","program","game","control","matter","policy","oil","window","nation","position","ground","blood","action","wall","street","husband","fire","mouth","arm","sound","service","chance","information","price","building","road","paper","court","attention","space","trouble","form","society","art","market","force","effect","nature","chair","period","order","television","president","tax","field","glass","thought","industry","process","phone","plan","center","truth","couple","decision","change","eye","campaign","issue","situation","effort","report","sun","experience","peace","letter","level","energy","role","development","result","evidence","meeting","smile","support","baby","team","show","community","brother","picture","kitchen","production","press","study","daughter","director","dinner","class","defense","piece","record","desk","stage","earth","movement","future","board","security","sea","horse","language","public","church","course","bill","river","coffee","wind","bank","corner","committee","pain","help","answer","subject","hospital","film","economy","trade","feeling","member","apartment","ship","silence","seat","gold","education","leader","pressure","doctor","shoulder","sight","scene","figure","crowd","fear","telephone","labor","success","population","style","station","value","sky","growth","foot","radio","sign","strength","capital","neck","college","budget","breath","choice","direction","guy","agreement","speech","skin","will","amount","plane","practice","marriage","audience","movie","gun","living","hall","concern","income","quality","dog","cause","hotel","race","difference","stone","box","army","trip","distance","attack","chairman","election","presence","computer","science","color","theory","spring","machine","purpose","organization","material","image","tree","surface","officer","administration","act","statement","battle","page","suit","lady","play","stock","list","freedom","bar","relationship","farm","authority","student","conference","ball","structure","nose","plant","career","wood","basis","deal","source","chest","message","stuff","middle","sister","drink","majority","sex","store","trial","character","boat","union","animal","ice","front","firm","heat","hope","rock","weight","disease","spirit","memory","king","response","manner","opinion","operation","increase","lawyer","expression","kid","bag","department","crime","train","executive","aid","dream","beginning","rain","prison","conversation","shirt","lunch","possibility","pleasure","management","danger","rule","throat","wine","behavior","return","hat","surprise","snow","property","flight","training","ability","project","camp","range","approach","agency","treatment","reality","village","bottle","attempt","crisis","drug","violence","inflation","enemy","responsibility","opposition","newspaper","victory","dress","condition","darkness","opportunity","account","degree","pocket","performance","manager","visit","threat","failure","brain","driver","charge","beer","coat","shot","metal","activity","influence","intelligence","bit","official","existence","example","truck","note","construction","shape","event","screen","faith","safety","path","culture","chief","relief","grass","contract","product","investment","weather","soul","murder","bedroom","magazine","model","cup","leg","traffic","writer","beauty","song","share","cancer","patient","credit","club","argument","speed","quarter","design","desire","vision","candidate","bottom","pattern","date","finger","teacher","tea","section","article","flesh","island","balance","spot","meaning","technology","crew","proposal","leadership","concept","object","impact","guard","analysis","birth","shop","knife","advantage","generation","appearance","variety","anger","religion","reaction","fight","star","exchange","agent","investigation","milk","judge","silver","region","steel","ear","sugar","strike","youth","hole","thinking","attitude","supply","start","jacket","jury","taste","secretary","mountain","confidence","master","artist","spokesman","demand","cigarette","track","captain","network","whole","university","conflict","noise","smoke","commission","mirror","accident","plastic","garden","debate","interview","command","tradition","protection","dust","watch","lead","solution","measure","motion","discussion","mission","opening","respect","extent","struggle","goal","tongue","moon","author","iron","breakfast","competition","cover","legislation","environment","sake","justice","fuel","hill","key","length","shock","band","version","contact","engine","settlement","mistake","restaurant","revolution","estate","camera","beach","post","pool","fashion","football","border","touch","laughter","title","background","principle","strategy","roof","forest","philosophy","entrance","pause","doubt","bird","tape","belief","card","ring","occasion","wheel","capacity","cat","collection","passage","writing","bridge","owner","novel","pride","damage","contrast","judgment","gift","division","professor","bathroom","plate","explanation","smell","district","park","wave","player","present","theater","atmosphere","emergency","leather","impression","painting","neighborhood","block","function","circle","sentence","priest","method","warning","editor","ceiling","target","tour","gate","site","baseball","airport","shadow","walk","approval","gesture","individual","difficulty","attorney","criticism","affair","request","doorway","reputation","minority","consumer","notion","general","convention","being","honor","partner","chain","commitment","weapon","joke","coal","meal","reading","detail","library","debt","other","mail","drive","fellow","profit","soldier","forehead","housing","excitement","soil","literature","pilot","dance","reform","volume","scale","imagination","challenge","desert","secret","poet","cabin","average","factor","corn","check","wonder","absence","search","wedding","yard","hero","address","confusion","fool","package","victim","fault","platform","democracy","regime","terror","nurse","stream","offer","medicine","flow","grain","row","county","self","glance","humor","promise","employment","advance","planet","recreation","trail","chicken","storm","creature","mass","stand","gaze","poetry","coast","lake","council","breast","corridor","conclusion","talent","tension","reporter","cut","appeal","total","belt","jail","passion","mayor","claim","combination","highway","wire","rifle","cheek","frame","exercise","incident","testimony","ticket","coach","connection","expert","disaster","valley","minister","deck","territory","chin","universe","independence","counter","resistance","cell","governor","salt","elevator","loan","release","schedule","porch","sheet","cloth","personality","actor","bomb","temperature","bench","break","code","journey","childhood","emphasis","aspect","pot","branch","identity","guest","arrival","recognition","hearing","lap","diet","factory","horror","fence","survey","fate","habit","lobby","bone","routine","discovery","comment","burden","treaty","knee","route","cry","ocean","fund","map","signal","ride","bear","deficit","height","element","sword","birthday","standing","cream","panel","fighting","travel","grandfather","creation","appointment","chapter","funeral","phrase","shore","planning","couch","survival","engineer","wagon","suggestion","waste","guilt","chamber","commander","clock","establishment","flag","content","supper","consciousness","proof","pack","beard","portion","comfort","resolution","sunlight","substance","benefit","honey","protest","prayer","stick","description","device","cloud","display","uniform","gasoline","tail","satisfaction","blanket","mess","consumption","drop","invasion","theme","mystery","belly","association","prospect","port","pipe","reference","skill","rear","heaven","destruction","worker","concentration","file","flat","cab","consideration","uncle","customer","laugh","radiation","favor","studio","boss","transportation","wage","fortune","tent","poem","procedure","clerk","surgery","percentage","expense","cap","household","match","bunch","column","intention","cousin","involvement","host","definition","wheat","permission","can","warmth","draft","silk","aide","lip","conviction","rope","illness","instrument","gap","string","adult","sweat","lover","evil","faculty","enthusiasm","farmer","missile","grin","tank","expansion","emotion","waist","discipline","distinction","technique","profession","wisdom","square","laboratory","tie","review","stranger","communication","pile","arrangement","palm","ceremony","tower","sympathy","deputy","script","nomination","friendship","institution","pass","civilization","magic","client","standard","significance","sport","defeat","announcement","reduction","grandmother","bowl","closet","genius","league","citizen","delivery","button","necessity","reader","lesson","trust","green","experiment","escape","craft","pistol","limit","witness","error","assistant","grace","salary","alarm","fist","potential","withdrawal","phase","bell","perspective","rose","score","amendment","fever","tip","god","crop","vehicle","barn","symbol","tale","exception","shift","scheme","tendency","logic","license","pollution","trend","bath","focus","producer","distribution","cotton","alternative","vacation","muscle","cycle","steam","palace","harm","location","beef","shame","policeman","compromise","tube","participation","fat","item","curiosity","blade","membership","lord","departure","shade","acid","enterprise","jet","selection","jungle","bond","retirement","alliance","bow","railroad","soup","airline","divorce","sofa","gear","gentleman","robe","plot","speaker","examination","egg","handful","recovery","embassy","entry","bastard","improvement","grip","invitation","barrel","context","controversy","fiction","revenue","reply","garage","crash","collar","landscape","grief","pen","teaching","angle","trunk","acceptance","recession","abortion","explosion","application","counsel","dignity","paint","landing","mixture","triumph","stove","winner","summit","thumb","depth","feature","setting","payment","grave","notice","museum","cop","graduate","sidewalk","taxi","trick","lamp","photograph","index","tray","essence","empire","tragedy","alcohol","flower","phenomenon","contribution","shower","castle","cross","booth","lawn","intensity","abuse","determination","passenger","opera","publication","wrist","hint","learning","punishment","ad","skirt","servant","prisoner","physician","midst","purse","rank","neighbor","elbow","contempt","round","cave","coverage","weakness","panic","basketball","juice","shooting","exposure","brick","miracle","unity","accent","coalition","fur","envelope","horizon","glory","stress","delight","politician","conscience","despair","rail","virtue","parent","dispute","killing","corruption","pound","core","stake","proportion","assault","curtain","efficiency","infant","count","suspicion","complex","formation","lock","entertainment","conduct","wit","outcome","shuttle","companion","discrimination","aunt","anxiety","shelter","confrontation","tool","climate","peak","cage","darling","assumption","stability","well","flame","marketing","currency","electricity","text","regulation","comedy","automobile","scientist","cake","scandal","contest","glow","cigar","arrest","brush","boom","basement","document","assembly","output","hut","slave","marble","breathing","pitch","loyalty","affection","resignation","guide","frustration","bureau","adviser","fleet","sector","privacy","awareness","fantasy","speculation","queen","tide","brass","formula","curve","zone","skull","sin","cable","corporation","foundation","achievement","countryside","monster","killer","strain","mask","breeze","whiskey","gang","rhythm","interpretation","basket","extension","tissue","satellite","doctrine","motor","hunger","intervention","kiss","fee","portrait","drawer","analyst","economist","reflection","visitor","transit","reception","provision","slope","sheriff","tunnel","complaint","devil","liquor","throne","hook","temple","tribe","preparation","handle","shoe","origin","helicopter","ruling","injury","crack","flash","gown","jaw","hallway","consequence","depression","subway","leave","drawing","cabinet","initiative","embarrassment","holiday","wilderness","towel","purchase","indication","sink","morality","impulse","rent","enforcement","utility","detective","comparison","critic","dish","hack","photo","crown","operator","conspiracy","rhetoric","bull","inquiry","humanity","demonstration","grade","alley","male","plain","pillow","remark","beast","seed","observation","guerrilla","straw","occupation","champion","excuse","possession","kingdom","snake","nerve","roll","horn","objective","cargo","mate","offense","resort","sequence","apple","bullet","presidency","strip","stroke","pig","print","champagne","saddle","dialogue","suitcase","protein","cook","quantity","toilet","chill","ranch","squad","priority","concert","van","adventure","representative","custom","shell","pension","prince","wound","video","courtroom","suffering","clay","actress","pencil","assignment","shelf","primary","waiter","charm","wool","sweater","soap","psychology","widow","delay","obligation","therapy","sergeant","shortage","myth","collapse","delegation","wish","perception","receiver","sauce","painter","reach","dear","fabric","carrier","ladder","hatred","dancing","cottage","opponent","dealer","prosecution","whisper","spread","poll","beam","exhibition","sigh","fog","harbor","successor","relation","gallery","prize","fireplace","fighter","pit","representation","prosecutor","liberty","bargaining","ownership","root","tin","celebration","stretch","nightmare","transport","link","diplomat","flood","architect","peasant","female","lab","category","inside","tune","carpet","mercy","fraud","introduction","facility","net","temper","rug","conception","eating","legend","tourist","refusal","disappointment","sensation","innocence","transfer","powder","parade","pursuit","parlor","pine","orbit","promotion","senator","colony","cart","interior","productivity","trap","identification","ambition","hip","admiration","corpse","emperor","patch","realm","barrier","ambassador","carriage","residence","maid","gathering","switch","lieutenant","sorrow","contrary","legislature","cliff","lightning","ritual","mist","salad","separation","flour","continent","poison","elite","radar","assessment","outfit","ideology","pad","exile","praise","employee","succession","gain","illusion","option","gravity","journalist","businessman","constitution","singer","sentiment","scope","transition","warrior","cast","march","herd","intent","inspection","episode","uncertainty","spell","isolation","observer","glimpse","privilege","spy","toy","thread","margin","anniversary","irony","organ","lecture","misery","needle","revolver","composition","admission","odor","candy","bid","classroom","bride","vitamin","refrigerator","sandwich","subcommittee","rescue","lad","defendant","blast","angel","compartment","vegetable","minimum","violation","agony","edition","compensation","evolution","treasure","salesman","log","clinic","layer","pitcher","publisher","suite","estimate","airplane","tournament","trace","hammer","reward","broadcasting","running","raid","specialist","mortgage","oak","pole","rocket","aisle","brandy","bureaucracy","mustache","vessel","penalty","export","orange","ignorance","hostility","integration","motive","ban","consultant","timing","equivalent","patrol","liver","assassination","instruction","leaf","railway","freeze","mention","designer","daylight","velvet","amusement","bush","fly","cloak","copper","orchestra","mechanism","chocolate","instinct","circuit","feed","courtyard","mob","profile","bombing","retreat","favorite","revenge","infection","historian","theatre","consent","bucket","mill","insult","pregnancy","psychiatrist","employer","presentation","swing","removal","financing","destiny","label","finish","ghost","channel","equality","requirement","dock","statue","doll","fan","mistress","oven","rim","scent","restraint","frontier","twin","framework","surveillance","diamond","pie","lion","cord","posture","wallet","stool","rally","realization","banker","invention","province","colonel","ally","inspiration","encounter","makeup","certainty","venture","takeover","daddy","ratio","fatigue","verdict","pardon","caution","scream","sleeve","coin","album","acquisition","laundry","transformation","handkerchief","candle","terminal","elephant","madness","appetite","rod","manufacturer","voyage","locker","pulse","indictment","riot","giant","sample","heritage","instance","hay","cure","clan","navy","monopoly","photographer","cowboy","bishop","linen","sacrifice","mortality","dilemma","frequency","harmony","junk","component","bargain","dragon","ruler","replacement","maker","blessing","resentment","surge","costume","editorial","mansion","hood","cellar","bout","driveway","championship","ambulance","sickness","guitar","rejection","compound","launch","journal","sculpture","preference","balcony","lid","toast","chart","motel","agenda","sadness","dimension","verse","scholar","submarine","confession","carbon","thunder","canal","socialism","merchant","bolt","insight","tub","topic","wolf","ridge","shed","gambling","arrow","con","lodge","bicycle","complexity","liberation","disorder","urge","circulation","pickup","distress","spine","romance","anticipation","military","lamb","gloom","pond","republic","ballet","bankruptcy","appreciation","rebellion","custody","feast","fluid","expedition","altar","recipe","array","anguish","harvest","sack","fraction","loneliness","trailer","notebook","surgeon","slip","festival","inability","pan","clearing","making","revival","rack","flashlight","sociology","heir","segment","moonlight","reign","exploration","burst","pet","charity","bundle","assurance","murderer","thrust","conservation","confirmation","outrage","quest","grant","perfection","liquid","stance","jar","essay","addition","diplomacy","rat","outlook","capability","broadcast","cocktail","breeding","immigration","optimism","urgency","helmet","correspondent","breakdown","domain","dressing","dancer","pork","colleague","crystal","insistence","guarantee","lane","dependence","chapel","transmission","hunt","turkey","veto","canoe","interference","sailor","arena","refuge","attraction","thesis","waitress","trigger","founder","briefcase","scholarship","commissioner","stack","lift","greeting","mining","partnership","cane","devotion","thief","troop","menu","finance","coincidence","sleeping","picnic","lounge","dose","jeep","brand","reasoning","proposition","administrator","cylinder","execution","commodity","drum","bronze","staircase","pin","whistle","robbery","catch","thigh","descent","canyon","ballot","shotgun","curb","nod","continuity","shaft","guess","gossip","jurisdiction","revolt","worry","recording","repair","saw","suspect","dome","globe","runway","resident","cemetery","conversion","black","passport","cease-fire","imitation","salvation","cement","creek","nephew","buddy","lung","embrace","ink","simplicity","sunset","astonishment","butt","oath","typewriter","outline","tribute","deadline","hostage","underwear","revelation","reluctance","dread","nest","nut","disposal","disclosure","destination","terrain","procession","recommendation","recorder","potato","ramp","accounting","bat","precision","heap","justification","fork","idiot","biography","prey","ivory","rumor","toll","robot","mix","glare","seal","sweep","haven","bike","courtesy","interaction","secrecy","ham","superiority","synagogue","calendar","ledge","engagement","lace","timber","turmoil","tooth","perfume","magnitude","veteran","lemon","cutting","tomb","accord","ammunition","spear","hunter","acquaintance","grocery","coming","pump","reservation","slide","award","institute","fringe","freight","accuracy","spectrum","ski","diameter","battery","desperation","pounding","variation","ankle","pepper","encouragement","cathedral","expectation","calf","monkey","suburb","rabbit","objection","dismay","boot","pipeline","lust","firing","aggression","ghetto","armor","merger","sphere","texture","moisture","kidney","broker","auction","hose","patent","hesitation","mound","cruise","goat","declaration","regret","conductor","terrace","contention","crap","manuscript","incentive","buyer","gin","principal","steak","novelist","criminal","heel","intellectual","conservative","quarterback","collector","motorcycle","refugee","punch","cluster","clown","preacher","torture","headache","pact","lump","buying","flavor","toe","spectacle","apron","banner","convenience","import","attendant","kindness","verge","dairy","umbrella","dam","inventory","turning","homeland","remainder","gum","plight","container","diversity","drought","reporting","biology","chemistry","curse","scar","merit","spray","reactor","shield","clarity","bamboo","metaphor","vocabulary","runner","luxury","diagnosis","bunk","white","statute","knock","garment","breed","railing","zoo","rival","supermarket","streak","pavement","discomfort","congregation","twilight","bacon","slot","scarf","dime","charter","grammar","theft","sensitivity","mainland","classification","coffin","rider","competence","adoption","reserve","fascination","specialty","mike","temptation","yield","evaluation","passing","intimacy","translation","philosopher","cafe","sitting","superintendent","pill","housewife","signature","correspondence","siege","inn","leftist","injustice","assertion","restoration","registration","farmhouse","denial","endorsement","predecessor","final","demon","greed","transaction","repression","mattress","nobility","embargo","bosom","gym","tenure","addiction","apology","double","litter","nail","incidence","merchandise","volunteer","labour","basin","fiber","whip","payroll","microphone","ax","supervisor","resource","maturity","resemblance","cult","stadium","limousine","welcome","knot","probability","menace","nominee","characteristic","stare","vodka","obsession","nursery","paragraph","discourse","candidacy","battlefield","saint","hierarchy","precedent","imperialism","pope","intake","burial","freshman","rebel","mandate","clause","tile","electorate","torch","adjustment","implication","farewell","curriculum","fountain","satin","subsidiary","humiliation","slaughter","discount","crest","princess","asset","greenhouse","reorganization","irritation","ending","messenger","jealousy","breakthrough","mineral","baggage","mouse","tiger","memorandum","kit","substitute","paradise","stride","deed","accumulation","pledge","hull","projection","apprehension","glue","excellence","composer","decay","ditch","slice","beating","syndrome","parole","pony","saying","vulnerability","rental","wax","renewal","disk","athlete","warehouse","organism","disagreement","suspension","documentary","soda","availability","dedication","delegate","reminder","domination","leap","span","obstacle","counselor","taxation","grandson","banana","rehabilitation","stamp","anchor","diary","tunic","boycott","meadow","backyard","dismissal","rating","disc","glove","pasture","catalogue","inspector","exploitation","missionary","density","sail","excess","chemical","disposition","headline","wartime","atom","bartender","blue","wash","shark","negotiation","monument","mom","faction","echo","tomato","scrap","expenditure","plague","fortress","web","briefing","luncheon","vanity","ribbon","nostalgia","drill","frown","dioxide","sovereignty","sweetheart","cot","tag","laser","purity","melody","sanctuary","citizenship","poster","pal","marketplace","girlfriend","programme","retaliation","researcher","allowance","bedside","yacht","scenario","concession","offering","instructor","motivation","litigation","tolerance","puzzle","compliance","duration","quarrel","aura","crusade","salute","intellect","debut","eternity","monastery","immunity","flock","choir","stern","medal","meter","auditorium","equity","fairy","windshield","mare","conquest","razor","push","kick","battalion","generosity","whale","den","mama","emptiness","hysteria","hillside","ideal","landlord","stem","drain","temperament","orientation","spoon","associate","ash","wig","elimination","bark","boost","activist","stature","liar","vein","tract","telegram","completion","pizza","urine","hollow","ordeal","admiral","psychologist","rehearsal","questioning","musician","installation","ministry","puppet","axe","nitrogen","contractor","poker","arch","tractor","reverse","relative","buffalo","deployment","outbreak","pier","veil","summary","courthouse","academy","confinement","catastrophe","technician","specimen","bachelor","lobster","tyranny","discharge","graduation","shout","monitor","traveler","dope","user","vegetation","deposit","investigator","attic","rabbi","reversal","knight","innovation","probe","altitude","legacy","raft","boyfriend","twist","plaza","paradox","witch","folly","physicist","prophet","threshold","plaster","dentist","telescope","vault","climax","parish","balloon","probation","prescription","liability","wheelchair","blackness","colour","booze","exhibit","vest","abundance","hatch","sketch","cartoon","horseback","investor","violin","hazard","trader","stall","healing","prejudice","scorn","rum","accomplishment","limb","produce","epidemic","tumor","camel","starvation","insect","tenderness","cockpit","maximum","patriotism","chauffeur","parliament","capsule","deficiency","massacre","dessert","bail","meditation","petition","hypothesis","ruin","voter","wait","saving","imprisonment","nationalism","lawsuit","surrender","celebrity","contradiction","disgrace","betrayal","slogan","thrill","enjoyment","narrative","canopy","might","vaccine","fort","stereo","hearth","relaxation","avenue","fright","drift","width","guardian","portfolio","longing","brutality","frenzy","chaplain","chop","tactic","viewpoint","chip","banquet","closing","re-election","impeachment","wardrobe","cradle","facade","finding","tangle","adaptation","hamburger","analogy","fancy","counterpart","dissent","skepticism","gut","advocate","granite","equation","slump","vice-president","nap","foam","buildup","geography","scratch","major","preservation","folder","entity","defiance","nickel","monarchy","shack","teaspoon","chase","remedy","disappearance","foreman","seller","rag","youngster","allegiance","earthquake","columnist","goose","feather","bulb","imagery","bomber","overcoat","harassment","outsider","maze","reproduction","printing","reconciliation","kinship","grease","harp","parallel","stew","particle","accusation","criterion","garlic","boundary","scalp","recess","bearing","warrant","dictatorship","breach","bladder","elegance","fervor","disapproval","monk","tweed","loser","hen","shrug","junta","disguise","gulf","landmark","bourbon","reconstruction","decency","register","feat","hostess","workshop","accommodation","wreck","referendum","viewer","niece","flank","autopsy","boarding","grove","decoration","stain","cape","prophecy","bubble","asylum","commentary","grandeur","subsidy","seizure","badge","limitation","armchair","pro","spark","blaze","centre","split","peril","fusion","goodbye","ringing","solitude","handwriting","crossing","onion","rubber","forefinger","bait","solidarity","measurement","multitude","dump","novelty","truce","perimeter","alien","decree","opposite","constituency","maneuver","ransom","supplier","performer","murmur","coordination","hobby","dough","lantern","cherry","fox","quota","deterioration","flaw","millionaire","raincoat","skeleton","bum","washing","plantation","spotlight","arsenal","villa","sermon","compliment","podium","collision","ratification","jam","loft","theology","escort","tyrant","ore","caste","brokerage","lighter","screw","inheritance","eagle","annoyance","napkin","rationale","flurry","mall","dresser","autobiography","slate","cheer","sulfur","assortment","memorial","electron","detachment","addict","shrine","mold","rookie","astronaut","diesel","neon","heroine","clash","recollection","sweetness","complexion","stewardess","adversary","trance","virgin","screening","classic","nuisance","uprising","shipment","mug","stairway","supporter","famine","stench","click","stupidity","bug","throw","lumber","current","mentality","regiment","galaxy","patron","tap","mischief","contingent","gospel","racket","liaison","honeymoon","foliage","leak","doom","irrigation","mechanic","chef","viewing","swamp","void","mule","lottery","pastor","steward","ranking","survivor","tuition","medication","misunderstanding","prediction","forum","oppression","ale","expanse","consultation","pawn","attachment","franchise","intercom","chunk","mat","pioneer","prairie","familiarity","undergraduate","tenant","chimney","cereal","pub","packet","aftermath","outburst","habitat","federation","deduction","pageant","circumstance","discontent","microscope","sausage","coma","want","intersection","detention","shrimp","deception","illustration","manipulation","ecstasy","dash","eyebrow","ray","persuasion","builder","injunction","foe","inclination","precinct","slab","anthropologist","amnesty","loaf","radical","intrusion","dwelling","calculation","paperback","usage","paste","ashtray","shovel","capture","ferry","preoccupation","joint","filing","spit","womb","puff","quilt","squadron","playwright","rotation","lease","brilliance","burn","cough","spouse","assassin","flu","cabbage","reliance","console","carpenter","dependency","advertisement","lipstick","mahogany","disadvantage","holder","furnace","certificate","alienation","collaboration","extinction","austerity","pupil","tenor","foyer","bluff","whisky","similarity","pouch","chant","nun","hike","babe","com","input","pianist","treason","brake","shake","dividend","repetition","fisherman","pinch","persecution","brightness","disdain","sunrise","gleam","premise","shawl","kettle","forecast","recipient","strap","outlet","chalk","plywood","nickname","fulfillment","doorbell","keyboard","peanut","compass","interval","intuition","clearance","format","shuffling","dent","ambush","chatter","lettuce","harness","hiring","ache","continuation","fit","friction","pretense","velocity","tavern","abdomen","scout","splendor","barber","flap","plateau","hedge","raising","visa","dictator","housekeeper","cafeteria","enrollment","sailing","ingenuity","limp","bard","consistency","ordinance","bathrobe","gauge","strand","taxpayer","spider","coward","reservoir","brigade","self-interest","crackdown","crib","hum","roommate","traitor","blend","kitten","setup","dagger","sophistication","clout","goddess","disability","touchdown","fertilizer","punk","agitation","seminar","hitter","crust","comprehension","nightgown","gamble","freak","stump","microwave","lever","libel","playground","exhaust","abstraction","picket","diversion","advancement","bourgeoisie","coordinator","myriad","dial","diagram","sensibility","donor","endurance","prominence","playgroup","transmitter","revision","consolation","storyteller","jewel","mourning","burglary","competitor","narrator","verb","butterfly","rationality","ant","mister","satire","placement","reunion","plunge","comb","commuter","carving","hormone","creator","swim","clip","necklace","frost","fix","allocation","thickness","happening","disruption","caravan","rodeo","axis","submission","insanity","protocol","caller","porcelain","aristocracy","interrogation","boyhood","muzzle","delicacy","teenager","undertaking","textile","tailor","defence","comeback","zero","wizard","cupboard","cynicism","behaviour","holster","bulletin","broom","receptionist","listener","exemption","flicker","exam","treasury","hug","interruption","no","drugstore","roast","trifle","jerk","exclusion","inmate","contra","permit","gene","melancholy","alcoholic","trainer","perspiration","instability","doorman","deterrent","occurrence","hem","pricing","wear","hog","cushion","commune","courtship","paradigm","down","participant","triangle","apprentice","prevention","forearm","symptom","flush","newcomer","announcer","gorge","frog","platoon","hawk","rivalry","trench","geometry","clubhouse","feller","hymn","dictionary","showing","homicide","crow","pneumonia","gourmet","flannel","congress","dislike","illumination","jockey","superpower","papa","absorption","fragment","catalog","genre","hypocrisy","duel","cone","organizer","fraternity","cubicle","hardship","restriction","gasp","authorization","partition","barrage","groan","waterfront","aerial","cinema","proximity","mockery","compulsion","slum","default","evacuation","fugitive","carton","chariot","masterpiece","nylon","dialect","tee","bathtub","congressman","vapor","disturbance","mailbox","take","groin","moss","shepherd","formulation","foreigner","solo","elder","textbook","predicament","trait","reef","intruder","captivity","commotion","farce","royalty","exasperation","developer","expulsion","plaid","believer","migration","gal","fitness","idealism","galley","offensive","hometown","sophomore","clump","launching","mast","slowdown","generator","make-up","mount","worm","chuckle","prototype","catcher","crotch","interpreter","graveyard","mane","premium","cuisine","jeopardy","reassurance","vantage","condemnation","vase","blackout","token","abandonment","maple","magician","bust","syrup","cassette","pick","madman","cleaner","throng","hanging","riding","villain","squeeze","wallpaper","lime","blur","modification","clatter","anonymity","lineup","polish","accountant","setback","neutrality","modernization","borrowing","kill","dwarf","amateur","expectancy","donkey","fella","contamination","ballroom","kidnapping","popcorn","entourage","crook","ambiguity","coral","roadside","fragrance","slack","spectator","stimulation","groom","rattle","synthesis","tan","skipper","distrust","siren","spin","revulsion","signing","booster","savage","glamour","flute","civilian","flask","tug","misfortune","therapist","plug","standpoint","weed","ecology","footing","patio","decor","malpractice","residue","passageway","chopper","batch","acceleration","depot","quarry","hound","pilgrimage","deference","splash","heartbeat","rap","wedge","indicator","pretext","make","saloon","clientele","poisoning","hemisphere","grotto","ignition","cover-up","ape","transcript","blizzard","crab","ration","puck","propriety","hunch","madam","imbalance","jug","manual","raise","silhouette","sponsor","bore","volcano","crate","humility","devaluation","rocker","rainbow","chap","informant","freezer","limestone","guise","valve","appraisal","handicap","correction","bra","sinking","turnout","manure","pail","cardinal","grape","bee","rumble","miner","dissatisfaction","pamphlet","plaque","chat","injection","pulpit","platter","symphony","molecule","rib","pyramid","shudder","dissolution","vinegar","calling","acreage","chick","cuff","scrub","orphan","porter","saucer","antenna","trophy","rig","convent","good-bye","troupe","ploy","niche","veal","semester","contender","grenade","hilt","spiral","stink","marathon","boulder","treasurer","cookie","peninsula","freeway","rainfall","showdown","parody","telling","statesman","decrease","symbolism","pillar","tremor","penetration","carcass","breadth","psyche","hiss","suppression","pottery","dormitory","scare","overtime","bean","schoolteacher","timetable","buzzer","mesh","jack","marshal","windfall","lance","uterus","inconvenience","chrome","brute","gardener","whim","pearl","fold","trim","ravine","critique","adultery","stretcher","trolley","elevation","worthy","vibration","bracelet","plank","jelly","foil","wrestling","colon","layout","quotation","sting","son-in-law","jargon","likeness","knack","defect","sedan","tilt","chore","moratorium","convoy","piety","acknowledgment","formality","thud","blockade","chord","hush","takeoff","lining","marsh","manifestation","humidity","ingredient","crater","liking","pigeon","abolition","granddaughter","vintage","flourish","playoff","prostitute","prick","oblivion","sociologist","helping","locomotive","contraction","bookstore","surrogate","hippie","sherry","scotch","packing","wink","spasm","conglomerate","ensemble","dugout","insider","sect","inclusion","feedback","trumpet","massage","constituent","brotherhood","directory","newsletter","comrade","grid","turtle","restructuring","reel","spur","comet","dummy","combustion","moustache","oversight","motto","mantle","handshake","mouthful","monologue","buffet","miss","crunch","waking","gray","exaggeration","gait","clutch","courier","hangar","dive","curator","ridicule","diaphragm","tow","projector","eclipse","parcel","lure","transplant","township","squash","commentator","mentor","gutter","stint","treat","germ","infinity","impasse","burglar","proprietor","tariff","dispatch","torment","dove","superstition","going","tempo","warden","sponge","rooster","barge","gorilla","draw","wharf","stallion","countenance","orchard","navigation","tar","biographer","wheelbarrow","imposition","hurricane","stronghold","distortion","starter","rash","feud","parting","interviewer","wrongdoing","lavender","low","leash","envoy","stairwell","backup","doorstep","negotiator","heading","excursion","sewer","endeavor","backbone","rite","vine","gypsy","directive","defender","scoring","esteem","torrent","gland","consortium","nightclub","swell","employe","obscenity","cavity","pulp","lifestyle","butler","peach","tack","fossil","glitter","liner","destroyer","flyer","individuality","roller","outcry","felony","artery","cruiser","bedding","dude","bounty","blindness","bodyguard","corral","coroner","spice","martini","contingency","gag","serving","wail","wrench","sock","safe","spite","broth","trustee","moth","vice","gender","cartel","casting","puppy","prohibition","ox","sculptor","treachery","stir","printer","audit","brim","handbag","lobbyist","jolt","comedian","distraction","challenger","telegraph","homage","evasion","detector","filling","overhead","cartridge","walnut","sonar","puddle","quake","flooding","crescent","thrift","following","tanker","stoop","clergyman","opener","latitude","anatomy","convertible","arbitration","leukemia","absurdity","stab","biologist","baseman","fuse","specialization","carnival","gangster","stalemate","trickle","mallet","working","receipt","charcoal","mortar","drainage","mother-in-law","regularity","emigration","plasma","condominium","muck","workplace","roster","stroll","softness","serpent","owl","infield","sill","swallow","backdrop","fidelity","historiography","thicket","baking","omen","yell","functioning","bribe","dynasty","trough","pudding","alcove","ancestor","ripple","flint","bracket","cube","pasta","proxy","groove","commercial","holocaust","countess","scroll","bang","planting","premiere","norm","bloom","gunman","vow","arithmetic","accelerator","postcard","relish","semblance","whine","inventor","sarcasm","designation","pat","symmetry","quiet","chisel","experimentation","cutter","differentiation","stud","apathy","relay","seminary","escalation","life-style","coil","mythology","futility","intimidation","childbirth","flare","glint","rue","mural","whiff","deposition","vogue","animation","migrant","caretaker","dot","mediator","lookout","captive","blackboard","pocketbook","recourse","negation","plaintiff","shriek","obstruction","latch","manor","casualty","grunt","gambler","erection","nationality","epic","starch","delusion","linkage","provocation","avalanche","offender","melodrama","contentment","appropriation","tonic","salon","accompaniment","paranoia","grimace","communion","cancellation","pendulum","shoreline","hail","refinery","subtlety","videotape","commando","repertoire","refinement","dryer","rust","lapse","haircut","errand","ailment","reanimation","ther","tab","prom","contemplation","bin","gilt","bunker","protector","sage","hilltop","hue","blueprint","correlation","brochure","roadway","arson","remnant","breaking","bouquet","exertion","garrison","beneficiary","colt","turbulence","refuse","bravery","indulgence","assimilation","coastline","livelihood","swarm","configuration","lecturer","paw","upheaval","switchboard","sub","claw","downfall","dye","immigrant","specter","deprivation","shrink","marker","sampling","fellowship","beak","pantry","mouthpiece","gratification","qualification","finality","debacle","extortion","chieftain","speaking","totalitarianism","mole","incumbent","jumper","crush","stubble","terrorist","comic","farmland","contributor","gravy","blossom","keeper","craftsman","pavilion","obscurity","loading","affiliation","vacancy","proclamation","gaiety","yarn","enclosure","clamor","sucker","recruitment","subversion","boiler","emblem","spade","stocking","staple","vocation","sling","maniac","musket","primitive","periphery","idol","snack","antique","redemption","listing","airliner","bandage","bulge","glimmer","priesthood","diner","astronomer","ovation","kindergarten","module","lifting","radiator","booklet","resurrection","precaution","affinity","thinker","quote","turbine","tally","vise","landslide","bakery","portal","majesty","abyss","admirer","turnaround","airfield","wastebasket","lapel","pennant","complication","slick","initiation","rustle","hearse","schooner","carrot","inscription","wench","embryo","vet","poise","disintegration","procurement","speck","kite","vent","plow","homosexual","membrane","waterfall","teevee","matron","utterance","buffer","memoir","cork","recital","loathing","cameraman","throttle","insecurity","trooper","hinge","hoard","umpire","slug","mountainside","affliction","pastime","felt","sentry","denomination","mushroom","linebacker","parachute","teller","fender","trademark","specification","harem","plum","metabolism","certification","neutron","organisation","heresy","relocation","payoff","lizard","termination","dropout","torpedo","stepmother","helm","resonance","heed","progression","braid","cardboard","walkout","shiver","gust","foreground","replica","repertory","sparkle","seam","bump","substitution","rapport","casket","dew","squirrel","palate","hitch","rebirth","reverie","boon","pirate","foresight","vinyl","delta","moat","presumption","tablespoon","aroma","digging","heartland","healer","malaise","creed","archway","exterior","screenplay","examiner","parity","copyright","strawberry","outpost","bookcase","cashmere","bikini","sheaf","pastry","respite","divinity","impossibility","legislator","saga","thump","inauguration","seaman","degradation","strategist","emerald","anthem","affront","burner","entrepreneur","thorn","marvel","stair","cavern","swivel","outlaw","underside","cleanup","fin","catalyst","forage","tapestry","dosage","covering","proletariat","turnover","notch","misconduct","onslaught","upbringing","coyote","bumper","champ","creep","boxer","mileage","vigil","fodder","occupant","dashboard","rarity","centerpiece","consul","ascent","paddle","martyr","doctorate","runoff","grudge","tattoo","robber","carbine","holding","oratory","distributor","heavyweight","footnote","terminology","infrastructure","drummer","chili","tableau","dung","magnet","deceit","caricature","itch","refund","cripple","rectangle","mortal","ancestry","inequality","generalization","furor","relativity","jukebox","dune","endowment","pathology","calibre","subpoena","attrition","hump","congestion","reflex","hoax","honour","herb","mantel","articulation","washer","judgement","brace","printout","helper","wording","crisp","shortstop","boulevard","characterization","cashier","matrix","documentation","deadlock","oyster","chasm","outing","expiration","heater","nutrient","beacon","bile","grievance","janitor","skyline","patrolman","juncture","antagonism","rump","hardwood","solace","warhead","assent","litany","enactment","chimpanzee","rye","feeding","suede","coke","inference","ivy","mosquito","eruption","symposium","variable","cooler","filter","storeroom","mailing","chancellor","beggar","antiquity","inertia","motif","absentee","float","blush","embankment","riverbank","demeanor","vampire","disciple","inadequacy","reinforcement","pedestrian","persona","berserker","tumult","incline","beaver","grill","morgue","denim","wreath","grouping","relic","syndicate","rancher","idiom","hegemony","seating","affirmation","physiology","repose","blight","jest","turret","slit","goalie","clarification","avoidance","volley","redhead","inefficiency","folklore","embodiment","afterthought","steer","cyanide","digestion","continuum","mania","giggle","buggy","willow","pantomime","fireman","growl","devastation","navel","halo","yearning","laborer","alligator","prelude","verification","brown","bead","midget","sleeper","riddle","portrayal","counterattack","lectern","tutor","chestnut","remembrance","aversion","taking","billing","regimen","translator","headmaster","duke","ace","snort","fanfare","imprint","calamity","exposition","cedar","intrigue","transistor","bowel","boardwalk","tramp","ornament","sticker","processor","voltage","sovereign","whistling","caliber","exuberance","snout","enclave","kilt","bombardment","corporal","overhaul","syllable","curfew","layman","consolidation","insignia","mediocrity","coherence","hospitalization","flick","pew","coloring","sanction","baritone","radicalism","savagery","pallet","stead","cadet","shutdown","supplement","unicorn","stepfather","excise","spelling","rebound","puzzlement","tenement","souvenir","veneer","safari","quartet","whirlwind","hamlet","practitioner","parasite","installment","emission","kissing","chronology","mosque","chairmanship","blonde","steamer","caption","shave","standstill","maiden","polling","condor","twinge","campfire","drinker","exhilaration","seafood","gala","crane","hickory","cathode","graph","deliberation","planner","marrow","bud","mediation","cutoff","tit","tic","parchment","noun","culprit","lair","showcase","hangover","chemist","aggregate","thriller","smack","efficacy","smear","heiress","crank","fig","finale","pea","staging","die","rebuke","curry","scum","potency","acclaim","collateral","schoolboy","canteen","radius","deportation","grate","madame","mop","pronunciation","sheen","respiration","breakup","professional","omission","gunshot","ugliness","fanatic","barbecue","dorm","trot","flattery","stereotype","hatchet","capitalist","purge","brew","totality","fern","enzyme","plumber","subscription","cholera","bruise","forge","nipple","commencement","superstar","ether","gem","sash","extraction","spaceship","golfer","realist","encampment","necktie","repayment","skillet","darky","disparity","bedspread","haul","questionnaire","promoter","wand","windowsill","victor","rector","enamel","hoop","coronation","patriot","chandelier","watchdog","glade","renovation","goblet","zipper","communique","crevice","motorcade","sequel","scourge","serum","single","icebox","junction","cache","berth","streetcar","syringe","antithesis","bureaucrat","blacksmith","oval","bun","loot","fiasco","tomahawk","ulcer","pinball","jersey","asthma","brook","pedestal","feeder","soot","inevitability","alteration","carrying","showroom","gimmick","lunatic","gall","fir","borough","hash","woe","controller","sponsorship","applicant","twig","screaming","librarian","intermission","sister-in-law","bushel","inflammation","pomp","vial","extravagance","pate","prostate","dolphin","tuxedo","mathematician","guinea","veranda","aperture","disillusionment","gavel","dating","knocking","oasis","nebula","woodland","yellow","ambivalence","hardness","oxide","socket","wasteland","leopard","blazer","follower","asking","urn","weaving","swimmer","closure","dart","loudspeaker","bazaar","bog","transfusion","reproach","sham","parka","affiliate","scowl","primate","attacker","rink","funnel","spate","elaboration","legality","tablet","heyday","tripod","bully","sharpness","demolition","flip","dandy","appliance","slant","sentimentality","knoll","gloss","defection","explorer","ram","stupor","clone","baton","cohesion","bearer","penance","bandit","aberration","gallop","swirl","coconut","spree","pedal","detergent","canon","teen","brood","phonograph","tabletop","enlargement","sniper","cohort","fable","rising","spill","affidavit","imperative","snapshot","apparition","stunt","wristwatch","chute","teammate","carelessness","over","stripe","postponement","rapture","savior","pacifist","admonition","pear","junkie","surcharge","wavelength","horseman","hag","confessional","comptroller","orthodoxy","financier","snarl","cliche","refreshment","adolescent","teapot","seaweed","drilling","roadblock","antibody","sheath","pallor","constable","misuse","arcade","lee","keep","anarchist","watering","rhyme","exclamation","backseat","great-grandfather","han","pod","daughter-in-law","mailman","alphabet","sloop","reckoning","grower","simulation","homer","birthplace","ence","actuality","depletion","novice","diffusion","concealment","cadre","pathway","fungus","ouster","loner","autograph","descendant","aspiration","better","sick","variant","fragmentation","pesticide","frigate","bestseller","propensity","foul","senate","trouser","airstrip","insurrection","chronicle","coating","stigma","toothbrush","pumpkin","apprenticeship","widower","paycheck","query","teen-ager","shifting","informer","doorknob","ardor","pebble","finesse","scrapbook","fiddle","dowager","sod","wrap","turtleneck","clipboard","rogue","mutiny","suitor","bulkhead","babble","fad","billboard","beverage","hairline","grille","exporter","pathologist","mesa","goblin","scapegoat","crucifix","backpack","observance","forgery","dungeon","methodology","gauze","bonanza","inkling","beret","shouting","ex-wife","wickedness","toil","preview","porridge","cornerstone","scanner","smoker","rebate","mite","brawl","axle","easel","allegation","grab","parrot","antidote","drawl","hijacker","telltale","venom","el","baron","intermediary","seduction","birch","contour","redistribution","cam","protagonist","enmity","hulk","stockbroker","decorator","cookbook","protege","mage","cricket","smock","apex","cortex","modem","shareholder","lament","determinism","rift","tablecloth","trajectory","preface","sneer","gamma","rendition","insemination","aristocrat","hare","labyrinth","thaw","invalid","staffer","alpha","fingernail","medic","crutch","entertainer","jade","eminence","discrepancy","yawn","flea","ledger","orphanage","getaway","manifesto","hijacking","incarnation","elm","adobe","spruce","gist","grit","boar","oracle","mobilization","cantor","crypt","cutback","musical","fallacy","corduroy","fray","racetrack","buckle","foreboding","pest","clap","ber","notation","peek","sow","ballad","brat","constellation","lard","industrialist","hunk","assailant","splinter","bridegroom","dip","fixture","cadence","watchman","windmill","prerogative","drawback","bungalow","heaving","nationalization","mating","writ","rationalization","milking","modernism","landlady","calculator","animosity","workout","skirmish","glycogen","discord","portico","vestibule","renegade","overdose","iceberg","lineage","mosaic","liturgy","watershed","playing","lobe","dowel","ranger","dossier","anvil","co-operation","satchel","fa","corollary","bridle","gateway","brothel","monotony","vendor","mysticism","saucepan","accomplice","hernia","guild","pup","hoof","sparrow","dreamer","craving","outpouring","blink","overlap","duct","brownstone","maneuvering","stagger","foothold","craze","monsoon","induction","handgun","scan","constraint","citadel","rigidity","anecdote","halter","occupancy","rightist","convict","tribunal","stalk","waterway","debtor","yoke","audition","inconsistency","peg","sliver","midwife","premonition","ruby","conduit","excavation","fart","condenser","hop","poodle","upsurge","attainment","stitch","crimson","anomaly","backlog","yeast","chimp","awning","gig","parable","drumming","tiptoe","prow","bypass","crease","reformer","intestine","counterpoint","enormity","anthology","rudder","shroud","magistrate","twitch","commonwealth","circumference","stuffing","sweating","scattering","lender","dripping","legion","refrain","mummy","covenant","morbidity","prop","initial","alignment","licence","infusion","unification","rebuttal","adjective","humour","larceny","mistrust","horde","assemblage","delinquency","testament","convert","patrician","dissension","cider","infidelity","bonnet","displacement","crackle","edifice","conciliation","bondage","schizophrenia","embroidery","standoff","monotone","oddity","mobile","tornado","semicircle","panorama","ex","ping","yogurt","screech","underdog","quay","tai-pan","extract","podesta","ticking","shrubbery","backside","communicator","sorcerer","interlude","dominion","battleground","taboo","blunder","conjecture","drone","cove","maverick","secondary","companionway","rook","gauntlet","ordering","violinist","rooftop","slash","thermometer","vomit","anteroom","deity","nave","acquittal","talker","reed","concussion","malfunction","tundra","cub","anemia","constructivist","cocoon","divide","keeping","percussion","freighter","noose","narcotic","expediency","grandchild","gully","innkeeper","pigment","bloodstream","quiver","alderman","halftime","stable","fission","aggressor","denunciation","abduction","expressway","uniformity","faucet","buff","broiler","allusion","jock","spike","herald","polyester","genocide","fer","parapet","classmate","tinge","sandstone","lurch","skunk","huddle","mum","tranquilizer","pharmacy","susceptibility","penicillin","lark","hoe","lily","hanger","headset","john","appointee","advisor","twine","slumber","magnetism","schoolgirl","smash","screwdriver","newsman","sleet","cleavage","lacquer","milestone","commandant","crick","splitting","rosary","edict","hurdle","fixation","appendix","lock-mechanism","eyelid","swath","fingerprint","carbohydrate","tick","magnate","heck","sailboat","donation","malady","polishing","clipping","collective","sensuality","loom","swagger","facet","variance","mean","walkway","aptitude","prodigy","solemnity","understatement","ebb","scoop","wrapper","narration","icon","prerequisite","planter","gash","interplay","evangelist","drip","vulgarity","subdivision","backwater","euphemism","lotion","corpus","broadcaster","toothpaste","curmudgeon","fo","thong","thatch","baptism","peacock","workman","downturn","scoundrel","machete","creak","five-year-old","dissertation","dishwasher","pimp","electrician","tycoon","otter","shove","snail","rendering","nobleman","booking","pronghorn","deadpan","shutter","escalator","girdle","fling","hire","alibi","flop","stampede","prognosis","itinerary","cologne","spoonful","detour","violet","watcher","falsehood","hype","locale","estimation","propeller","squaw","pickle","lass","pun","racist","scratching","rout","downpour","casing","complacency","camper","equator","reticence","learner","outcast","brunette","improvisation","stag","maxim","loophole","livery","blasphemy","shoot","solvent","misdemeanor","buyout","tiller","jetliner","checkbook","awakening","sideboard","romanticism","squire","newsstand","nuance","consulate","excrement","reprisal","bastion","beginner","obituary","softball","conjunction","scripture","phalanx","vindication","grub","swig","inaction","redwood","scabbard","bonfire","casserole","ovulation","unreality","totem","palette","choreographer","peasantry","skyscraper","penitentiary","outfield","melon","bounce","yolk","diver","archbishop","plurality","amber","recurrence","adulation","piston","insurgency","stoan","coop","tart","eyeball","toss","giveaway","cross-examination","dissident","hermit","ruse","ture","pore","leaving","dowry","gunner","epitome","snowstorm","summation","switchblade","crock","ity","frock","luster","piazza","rotor","impropriety","pivot","blender","immediacy","borrower","slaying","feminist","preserve","bidder","depiction","parasol","clover","intern","asteroid","stub","barricade","medley","multiplier","smirk","knapsack","hank","cognac","headway","treatise","homestead","troublemaker","giraffe","mover","allotment","drowning","naturalist","orderly","attribute","scalpel","shipyard","estrogen","educator","enrichment","grandstand","sire","sideline","landowner","confidant","gel","deviation","clemency","liberal","bigotry","filly","six-year-old","lifeguard","shred","adversity","shelling","pineapple","referee","knockout","jigsaw","retailer","extremity","outgrowth","amplifier","sinner","campground","teasing","steamboat","turban","mutton","cobra","contraption","chopping","schoolhouse","varnish","pane","observatory","ballerina","czar","immensity","lethargy","reimbursement","undershirt","concierge","fracture","variability","accordion","slime","meanness","gelding","practicality","advertiser","graft","gull","stockholder","pilgrim","hooker","puritan","benediction","barbershop","stanza","hallmark","mishap","harpy","silage","enchantment","whirlpool","conditioner","gadget","divestiture","lathe","incarceration","amalgam","antibiotic","annexation","martyrdom","pyre","shank","alert","shale","artifact","interchange","mystic","meet","grinding","triple","boutique","antagonist","fermentation","twinkle","sweetie","shin","creditor","amulet","pall","posse","homeowner","skier","vastness","smith","allegory","oxidation","cracker","levy","ark","sporophyte","enthusiast","snob","spinster","searchlight","waistband","lorry","repeat","reprieve","slalom","respirator","visor","reviewer","putt","miscalculation","shortfall","concourse","dialectic","native","hairdresser","normality","immorality","sprinkling","allure","lick","drudgery","habitation","gondola","vista","ice-cream","cheerleader","predator","countdown","juxtaposition","stumbling","muffler","derby","timer","salvage","boast","cabbie","clam","windbreaker","retardation","antelope","shampoo","raccoon","bible","glider","momma","valise","coffeepot","emissary","compression","grail","guideline","lavatory","glaze","outpatient","thunderstorm","foray","co-op","valet","baker","sycamore","thumbnail","nozzle","timidity","orator","liquidation","spokeswoman","militant","jig","naivete","motorist","dumping","armpit","margarine","exultation","headboard","plume","amplitude","flutter","pronouncement","finery","trepidation","airing","coupon","knuckle","gametophyte","deathbed","extermination","alleyway","hybrid","gambit","nova","binge","original","froth","lighthouse","coolant","continuance","collaborator","fuselage","profanity","whirl","saber","filmmaker","checkup","shaman","rancor","retort","earring","sieve","post-mortem","implantation","conceit","simplification","vat","proficiency","deluge","kiosk","outlay","tantrum","flooring","veterinarian","fireball","carousel","bandanna","glacier","censure","citation","oar","fridge","metamorphosis","superior","approximation","girth","tirade","grocer","holdup","forward","snobbery","cleansing","replay","recitation","facsimile","patter","jubilation","snare","frailty","rampage","pick-up","overture","tumble","residency","prevalence","repository","reentry","battleship","mutation","hammock","importation","thug","semiconductor","ballast","spurt","extreme","artichoke","convergence","circular","rigor","realignment","physique","handbook","bugle","precipice","sauna","skater","furcot","volatility","valuation","barbarian","peddler","layoff","overall","deliverance","chromosome","innuendo","lexicon","empress","polarization","dictum","fitting","impediment","piracy","crocodile","cucumber","keel","sitcom","hypocrite","roaring","encroachment","steamship","resin","fairway","eyewitness","broadside","washroom","sighting","mantra","swan","supposition","governess","upswing","rep","solicitude","rustling","invocation","heather","rectory","orchid","brocade","raiser","invective","fragility","acronym","ostrich","col","absolutism","vicar","psychotherapy","navigator","cartoonist","doe","landfill","invader","werowance","ble","flatness","locality","druid","visitation","headlight","rapist","benefactor","colonization","excerpt","nick","kangaroo","pink","buy","cascade","campsite","slander","headdress","topcoat","causality","karma","trestle","atheist","checkpoint","renunciation","eater","payload","pointer","theologian","beet","undertaker","lineman","hart","gourd","doubling","shuffle","cabaret","periscope","bodice","shootout","grandma","wildcat","proton","dioxin","sorcery","torchlight","stopover","executioner","collage","mesquite","reincarnation","kidnaping","programmer","disloyalty","muslin","throb","mint","aquarium","tel","eccentricity","purification","kerchief","warranty","rigging","breeder","nite","conservatory","fastball","magnification","spa","favour","regeneration","incision","saxophone","detriment","scam","android","coloration","bunny","restitution","rake","serf","despotism","pollen","sidewinder","upstart","revisionist","birthright","multiple","lifeline","queue","follow-up","swipe","boardinghouse","armament","travesty","stirrup","caper","chloride","crepe","primer","clich","inflection","skid","repudiation","serve","spire","peep","inducement","clothesline","fabrication","morsel","spleen","coon","bustle","crossword","back-up","assessor","biopsy","sidecar","hassle","shingle","tint","fixing","collarbone","taint","pusher","gestation","mantelpiece","vaulting","ra","peat","indignity","adequacy","genus","scrape","scaffolding","serial","neurologist","duffel","cipher","rote","horseshoe","bulldog","electrode","joker","juror","fibre","misconception","rut","connoisseur","flowering","op","flirtation","highlander","wisp","sounding","bugger","pharmacist","doughnut","toaster","pinnacle","slob","promenade","amphitheater","singsong","beau","whimper","importer","locket","watermelon","marking","beta","co-author","crossbow","atrocity","desktop","inhibition","draught","rowboat","volleyball","snowfall","extravaganza","teddy","miscarriage","storefront","toxicity","abode","hearty","handyman","centurion","phrasing","anachronism","newspaperman","annex","walker","till","volition","tributary","close-up","nook","cleric","ferment","proverb","inlet","heretic","waistcoat","duet","sniff","crewman","campaigner","wearing","grizzly","p","optimist","placard","overflow","pedigree","clang","brig","cinder","bunting","wag","dishonor","denominator","gong","siding","trilogy","deli","fluoride","questioner","squat","competency","partisan","putter","entree","cynic","tombstone","scoreboard","biscuit","souffle","homecoming","overseer","hideout","brewery","emancipation","interface","premier","auditor","troll","conscription","stout","trucker","beetle","dealing","bookkeeper","build-up","yardstick","da","polity","wick","wrinkle","private","outflow","borderline","outfielder","visage","leper","chiffon","arbor","weave","barnyard","checklist","granny","insensitivity","ex-husband","barometer","rupture","infirmary","desertion","wonderment","encyclopedia","slaughterhouse","nostril","ineptitude","implant","infatuation","laundromat","warship","rub","benchmark","polygraph","dinghy","behind","tween","filibuster","wearer","crayon","sensor","hustler","sinew","progeny","dig","pediatrician","foursome","buckskin","cornfield","safeguard","divergence","ting","coupling","dislocation","the","immersion","purchaser","cleft","overhang","booty","scuffle","rattlesnake","teacup","retinue","hallucination","potion","yeshiva","tapping","rip","multiplication","canister","gallantry","morn","thermostat","grind","aviator","ecosystem","pariah","recruit","vestige","ro","phosphate","abomination","laurel","sweatshirt","vaccination","psychoanalyst","blind","psychosis","sidekick","shopkeeper","theorist","delicatessen","sheepskin","billionaire","receptacle","salami","paddock","glen","beech","leer","mime","ty","perfectionist","seedling","wil","bind","intolerance","dint","plural","rouge","skylight","mammy","drab","microcosm","sole","organist","court-martial","matinee","bulwark","must","expatriate","stethoscope","daydream","backer","godfather","breech","artifice","auxiliary","adventurer","atrium","counterman","idiocy","grotesque","dishonesty","runaway","digit","baseline","reflector","preamble","sellout","falcon","scribe","retainer","louse","grapevine","sojourn","lash","marquee","schoolmaster","squeak","squeal","shooter","townhouse","nationalist","billiard","backfield","auctioneer","aria","avant-garde","hostler","smattering","giving","coaster","arraignment","duo","malignancy","throwback","doc","turnabout","seeker","deletion","vernacular","bulldozer","tedium","hustle","raspberry","estrangement","mutilation","styling","incinerator","wrong","shortcut","mastectomy","infringement","bonding","timbre","cameo","workroom","grassland","spraying","cooperative","tarpaulin","determinant","thyme","innocent","clique","racer","leakage","conflagration","jingle","duplicity","diaper","conqueror","committeeman","robin","reprimand","marina","cross-section","flagship","denouement","recluse","homemaker","moron","rind","gent","magnificence","dispatcher","detonation","harbour","toddler","rotunda","sedition","fell","dolly","laureate","woodsman","syndication","clot","guitarist","blemish","password","overview","eggplant","incantation","drapery","incapacity","florist","hive","civility","mod","screenwriter","intoxication","barman","ern","furrow","cant","clapboard","tumbler","walkie-talkie","pajama","vortex","defenseman","hostel","subjugation","interception","armory","fanaticism","sibling","inhalation","undercurrent","husk","mead","maw","padlock","abnormality","penguin","undersecretary","damnation","independent","airlift","peel","schoolroom","rascal","fingertip","cartilage","dichotomy","blank","lingo","clasp","racquet","acknowledgement","rebuff","bier","aerosol","taping","checkout","arse","thoroughfare","pelt","copse","keg","fissure","tern","mirage","blockbuster","balm","arbiter","shutout","schism","fluff","circumcision","insertion","pseudonym","heathen","eulogy","snowball","penthouse","kinsman","gebling","regulator","proponent","yearbook","barbarism","mutt","reopening","paunch","governorship","differential","airship","subscriber","alloy","adjunct","impairment","incongruity","pheasant","grownup","predicate","loo","sleigh","seer","flitter","sunburn","plebiscite","stockade","pout","sledge","stipulation","lordship","bayonet","wretch","vulture","postman","breaker","newsroom","consort","grinder","ballpoint","tequila","unpleasantness","wrapping","squall","adage","monograph","privation","streetlight","hilarity","sacrament","diminution","mannequin","duplication","banishment","rasp","biochemist","goatee","cranberry","sultan","blip","disservice","idealist","middleman","shaping","apocalypse","strut","oligarchy","moor","zombie","certitude","javelin","azure","turnpike","forger","commode","bleach","sideshow","banister","closeup","dysentery","steeple","offence","commandment","furlough","best-seller","filament","mountaintop","censor","snowmobile","kaleidoscope","elf","imp","slipper","lunacy","telecast","nanny","kernel","eventuality","subordination","sonnet","nitrate","foal","prank","expropriation","fedora","zigzag","resale","namesake","highlight","supplication","concurrence","medallion","jailer","loin","tread","quill","cardigan","prune","slur","surtax","internist","strait","smuggler","panacea","turd","wanderer","crude","darlin","epitaph","docking","seashore","cheeseburger","netting","provider","dispenser","intonation","marching","caress","hootch","morass","chum","sanctum","headband","powerhouse","axiom","terrier","springboard","tot","latrine","toad","clink","herbicide","figger","hick","manger","poppy","chaise","archetype","undoing","beehive","illustrator","withholding","sterility","paddy","coven","custodian","half-life","embezzlement","armoire","kickoff","possessor","rectum","sit","daisy","housecoat","pollster","policewoman","ointment","expressionist","stockpile","bombshell","impresario","co-pilot","chessboard","dazzle","scepter","archdiocese","linguist","odyssey","capitol","accession","lute","liter","multimillionaire","decoy","warp","conveyor","grandpa","ance","mumble","betterment","bullfighter","chador","ampule","indiscretion","shake-up","clarinet","catapult","normalcy","shanty","dinosaur","epithet","tang","scaffold","immunization","repairman","suntan","mu","environmentalist","nightcap","tempest","artisan","orbiter","spiel","needlepoint","geologist","humanist","stutter","perplexity","roundup","concoction","treadmill","cacophony","antipathy","blackberry","bloodbath","brassiere","allergy","hitchhiker","grunting","choke","sitter","elixir","ba","repatriation","whack","decanter","crusader","burlap","incursion","lyric","compilation","seaport","coachman","philanthropy","secretion","collie","inquest","taper","moral","quartermaster","jeweler","salutation","confluence","gullet","tram","hideaway","by-product","drybone","copulation","divorcee","mausoleum","peeling","annuity","set-up","skiff","neurosis","windpipe","buoy","glide","archaeologist","pendant","junkyard","bullhorn","porthole","quandary","irrationality","acidity","pragmatist","derivation","stylist","duplicate","panther","brigadier","introspection","depravity","keynote","vexation","psi","weighing","deserter","speculator","teak","armful","remission","precursor","sorghum","harmonica","olive","gangway","contraband","defector","purgatory","genie","expedient","crowbar","desecration","bathhouse","enhancement","tenet","seasoning","wrangling","downhill","venue","tracery","dictation","bailout","undertone","pecker","prep","forerunner","bandstand","letdown","luminosity","tonnage","catwalk","brunch","sapphire","ballplayer","wineglass","readout","genealogy","horsepower","messiah","blackjack","hemorrhage","damask","registry","gunwale","jerkin","humorist","bowler","tingle","engraving","chauvinist","spirituality","eyepiece","twang","constancy","blot","blob","chard","highschool","sportswriter","tiara","domino","contestant","migraine","newscast","mainstay","hammering","tracker","wager","offshoot","buster","informality","python","felon","imperfection","slag","convulsion","sedative","cellblock","punt","headwaiter","outhouse","monstrosity","nonwhite","override","raisin","inversion","pancake","flavour","cataract","reclamation","churchyard","pidgin","suction","chanting","aggravation","dynamo","pee","fistful","hogan","byproduct","brooch","lullaby","workday","slop","silencer","dealership","earner","anchorman","pittance","crumb","custard","rainstorm","tote","mulch","mason","earl","barroom","levee","discouragement","falsity","compressor","lodging","gynecologist","divination","calico","bibliography","cyclone","senor","gatehouse","lagoon","squirt","artwork","songwriter","derivative","supernova","divan","photon","surety","cobbler","fatality","gout","eleven-year-old","ent","cropping","mainspring","prism","confederation","weaver","neighbour","yuppie","muffin","juniper","ovum","lesbian","pi","shimmer","fax","increment","co-ordination","splashing","thanksgiving","exaltation","confiscation","fairy-tale","fudge","brief","priestess","re-creation","hydrocarbon","ford","usurper","maelstrom","spaceport","swordsman","vegetarian","newness","grad","potter","manservant","fullback","fiend","giver","subculture","debutante","striving","scorer","catechism","charger","armada","blond","paign","handball","wince","appetizer","guidebook","jog","millet","hoot","inferno","pardner","mash","mousse","mammography","launcher","battering","predilection","portent","beep","exhortation","notification","warm-up","diatribe","panda","menstruation","telex","revitalization","workingman","cordon","charmer","fumble","hamper","moralist","settler","chowder","ley","mannerism","drunkard","posting","turquoise","elasticity","abbot","bookie","tusk","paragon","precondition","rollback","lunge","conundrum","eviction","sealer","cellist","cosmology","turntable","outside","fortification","nightstand","spook","shoemaker","sac","sulfate","isle","antigen","steed","bacterium","utopia","stunner","hillock","clove","irritant","tat","memento","rung","gaffe","portraiture","solicitor","rodent","barter","intensification","gallbladder","condom","antiquarian","peck","cheering","meteor","inflow","stenographer","blinking","icing","jackass","dweller","fiesta","irrelevance","harpoon","appendage","stipend","mommy","cassock","microfilm","dead-end","vermouth","scarecrow","fielder","referral","mart","burger","ticker","hindrance","coverlet","speedboat","wafer","sluice","bellboy","hangout","figurehead","midterm","petticoat","matador","skein","beholder","flier","waiver","flotilla","smudge","inequity","mixer","sulfide","banality","roach","billy","tailgate","gaggle","softening","loincloth","gore","bib","chrissake","changer","muse","longitude","tourney","mil","aorta","poop","regression","soviet","placing","winch","apostle","constant","squabble","blimp","abdication","porpoise","puncture","workbench","parameter","conventionalist","flagpole","unfairness","reptile","typist","bookshop","hesitancy","strongman","headland","sprint","manhole","blowing","archipelago","ideologue","slouch","poke","gush","stratum","mulatto","echelon","postmaster","sheik","emigre","alto","affectation","rad","climber","deerskin","bower","idolatry","reciprocity","sweet","wasp","dissection","baby-sitter","purple","toothpick","lyre","archer","sprawl","councilor","contrivance","flake","kynd","suffocation","damp","ware","travail","candelabra","wrestler","patina","moaning","paisley","recruiter","moderator","respondent","marmalade","bellow","harpsichord","atrophy","ejector","jetty","stripper","monorail","dramatist","hysterectomy","riverbed","revaluation","stoppage","conspirator","fetish","sunflower","cognition","scrim","rec","retriever","aphrodisiac","redneck","palsy","pullover","flywheel","roundness","peculiarity","ernment","nectar","ruck","swimsuit","curd","underclass","polka","conservationist","mire","drumbeat","cinch","cordiality","deacon","speechwriter","purr","gelatin","muddle","booby","solid","cloakroom","stopwatch","sportsman","burlesque","overload","mademoiselle","divider","bailiff","handout","ordination","stiff","languor","paperweight","opiate","snap","causation","mower","snatch","touchstone","self-indulgence","shrub","interceptor","mammoth","proceeding","cheekbone","spoke","repellent","cardiologist","reminiscence","sprinter","evocation","postscript","enlistment","blotter","troika","dacha","cabdriver","fund-raiser","switching","para","tendon","fireside","effigy","leech","veneration","reek","schoolyard","pellet","shellac","weasel","jab","carcinogen","restroom","cauliflower","levity","caftan","topside","fruitcake","bickering","drawing-room","dovetail","culvert","chateau","bugging","tinker","hobo","corset","automaker","actualization","oration","handhold","nutmeg","tentacle","quicksand","handler","panoply","bowhead","testimonial","mammal","bellhop","devotee","technicality","trainee","mongrel","newscaster","aggregation","footpath","fawn","accreditation","heave","jib","rationalist","vendetta","midpoint","buckboard","screwball","hatchway","disinfectant","cramp","causeway","tease","corkscrew","sledgehammer","sloth","materialist","mogul","stopper","bevel","carbonate","berry","snore","throwaway","agribusiness","rerun","guillotine","nip","computation","keyhole","storybook","watercolor","cer","porcupine","urging","cockroach","esse","headman","settee","usher","short","obstetrician","faggot","ballpark","palisade","whimsy","co-owner","spout","nub","pectin","dun","cypress","trombone","scat","lite","dame","quip","invisibility","baboon","sneeze","swish","originator","biennial","newsreel","chameleon","dressmaker","storehouse","trapping","statistician","bloke","helmsman","ewe","drape","trump","great-grandmother","cloister","caterer","grounding","hotbed","life-span","urinal","funk","bedchamber","boudoir","theoretician","oddball","nameplate","raven","ditty","canary","anticommunist","reconsideration","playboy","skate","transparency","uplift","six-pack","rambling","commendation","wimp","pestilence","sufferer","kelp","counterforce","self-doubt","deformity","croak","marine","marksman","directorate","reversion","stimulant","dence","beloved","eraser","slurry","tracing","bigot","compendium","entitlement","monolith","misrepresentation","darkroom","nutshell","torque","concubine","peephole","lesion","bogey","spindle","birdie","nugget","tenon","supercomputer","weakling","provenance","vowel","empiricist","filet","co-founder","prelate","onlooker","tricycle","sax","catheter","accessory","fresco","prod","oscillator","self-image","refraction","excretion","prance","insurer","cask","impersonation","rangeland","toothache","magnum","accuser","rubbing","carver","carnation","masquerade","trapdoor","shaker","mittee","tux","poignancy","payday","captor","couplet","mutant","jogger","raider","dilution","sickle","prowl","blister","reassessment","infirmity","matchmaker","workload","restaurateur","tuning","wiretap","perpetrator","davenport","lamppost","inductivist","affect","sterilization","booming","rucksack","repurchase","starship","bystander","taker","spaniel","teletype","cuckoo","sneaker","aspen","soundtrack","sacrilege","surname","succor","co-chairman","anticlimax","hopper","jumpsuit","rinse","rummy","cigaret","washcloth","butchery","almond","cooker","implement","effluent","cheat","threshing","silicone","draining","vector","shopper","dandelion","pecking","brazier","cobblestone","slugger","sacrificer","airlock","lunchroom","zebra","ejection","cutthroat","wizardry","crony","kennel","internship","cohabitation","omelet","wheelhouse","redundancy","schema","psychopath","buttock","grasshopper","playmate","lamentation","socialite","cornucopia","lichen","coterie","warlord","discomfiture","frieze","montage","traveller","curvature","condensation","vineyard","scraper","generality","archive","half-sister","gangplank","intimation","doublet","pleading","tome","quadrangle","connotation","lifeboat","blueberry","coinage","prospector","bash","disciplinarian","dualism","bookshelf","adjutant","clod","apportionment","footbridge","tourniquet","spore","slicker","jetport","magenta","schizophrenic","oilman","harbinger","trespass","merry-go-round","sabra","old-timer","vigilante","melanoma","torpor","gliding","refutation","dab","jurist","plumage","kitty","cauldron","abbey","jasmine","lefty","cabal","detonator","retiree","abatement","clamp","roost","councilman","halfback","centimeter","shirttail","whispering","stratagem","exponent","cheesecake","truism","jaunt","node","ironclad","undertow","self-portrait","urchin","idealization","splendour","antechamber","living-room","sampler","friar","irregularity","lateness","playback","binder","washbasin","tummy","capitulation","felicity","canter","birthrate","earthenware","kitchenette","foundry","ladle","babushka","chlorophyll","adjournment","villager","recrimination","hotshot","blaster","pruning","soloist","hummingbird","recuperation","bequest","hemlock","cottonwood","drawbridge","alternation","malt","interconnection","mugger","tuft","keystone","riverboat","thrall","ayatollah","highland","mistrial","bunkhouse","anesthesiologist","dredging","anode","salsa","prizefighter","neckline","chile","foreclosure","cola","digression","scythe","lout","chamberlain","minefield","sabbatical","appraiser","isotope","demarcation","garnet","buzzard","repulsion","lowland","snifter","bending","weekly","dispensation","botanist","sari","stabbing","ovary","skullcap","journeyman","thievery","look-alike","parson","heartbreak","distillate","neophyte","blower","storekeeper","firmament","taxicab","corona","fusillade","publicist","resume","breather","casement","smokestack","interrogator","outcropping","mecca","dilettante","shoestring","belch","behemoth","negligee","heath","smut","negative","fistfight","regent","incumbency","curragh","toga","ministration","turnip","beamer","stepladder","loon","businesswoman","jumbo","whining","spoor","posturing","parlour","concertina","alkali","rampart","chime","warmup","taffeta","hyena","firehouse","sweetener","guessing","pronoun","madhouse","lioness","breadwinner","diocese","escarpment","mimic","retina","larder","gnat","hothouse","ponytail","markup","bevy","revocation","depressive","garner","redefinition","lifter","stateroom","nutritionist","isolationist","surveyor","polemic","ornamentation","gouge","counterweight","thrower","illegality","joining","lumberyard","wholesaler","obeisance","stagecoach","substage","lockup","nudge","rejoinder","compost","carburetor","peacemaker","prologue","swinger","right-of-way","precipitate","sprinkler","crone","valentine","vassal","tabloid","minstrel","nursemaid","attribution","courtier","docket","spool","convocation","serviceman","letterhead","zealot","negro","cackle","masthead","dispersion","underwriting","armload","noodle","squawk","periodical","reformation","boa","starlet","about-face","ejaculation","encore","harangue","woodpile","earlobe","reaffirmation","handlebar","compunction","contemporary","midriff","nimbus","householder","postgraduate","quirk","innovator","sneak","straitjacket","pussycat","belle","kidnapper","spacing","laying","standout","estuary","duster","jackpot","motorboat","welterweight","kicker","expectant","revue","senior","epistemology","yeoman","firearm","granddaddy","projectile","stammer","crossfire","toxin","hookup","phantom","transgression","flagstone","acuity","twick","acolyte","directorship","corpsman","worktable","mammogram","wart","liqueur","unbutton","receivership","duchess","delinquent","picker","earphone","blare","promontory","formalism","infamy","operative","hock","crusher","megaphone","retrenchment","chaser","dementia","wane","triviality","quadrant","curate","pairing","forging","dermatologist","mango","bon","moccasin","hayloft","marionette","seedship","ooze","interloper","twill","solicitation","trowel","professorship","scrimmage","scrawl","blockage","parkway","motorman","snapper","transcription","vasectomy","binary","flagon","choirboy","butte","throbbing","bound","thunderbolt","dike","cowbell","elect","prodding","lynching","rant","drifter","snot","preservative","brogue","tary","tortoise","lattice","strudel","composite","churn","median","neurosurgeon","mariner","kiln","boarder","ama","petal","friendly","clearinghouse","swastika","filler","enquiry","dispensary","chump","archeologist","rescuer","dy","draftsman","snicker","shakedown","romp","construct","conclave","winery","polarity","breakin","wailing","gurgle","bedroll","commissar","albatross","shading","peal","taverna","chicanery","has-been","waistline","oaf","satirist","faint","myosin","dimple","landfall","smithy","tough","gunboat","busboy","cassava","poplar","discontinuity","obelisk","blubber","demonstrator","meltdown","abolitionist","thorax","holler","pimple","sending","druggist","indirection","leotard","ken","showman","despot","ombudsman","lyricist","dearie","lumberjack","gaff","pagan","cremation","infarction","sturgeon","publican","bottleneck","chambermaid","pectoral","purser","godsend","whisk","canard","concentrate","copter","shipwreck","laundering","clipper","notepad","jackal","indentation","basilica","adhesive","mermaid","knighthood","personage","omelette","whoosh","embellishment","misgiving","tracer","brawling","crucifixion","steal","transference","sleight","threesome","windowpane","bereavement","viceroy","betrothal","refresher","seagull","jay","needler","discoverer","goiter","caterpillar","impostor","diminutive","cation","playpen","amputation","confidante","dockside","inquisition","chronicler","seamstress","lath","absolutist","cadaver","perusal","subterfuge","self-satisfaction","sawmill","agitator","shortcoming","breakwater","microcomputer","lima","greatcoat","mahout","prima","undress","superstructure","stopgap","moo","bio","fret","pomposity","bough","autocracy","anchorage","samovar","gen","burrow","rosebud","segregationist","mortise","hydrant","postmortem","oversimplification","entryway","paintbrush","rea","balustrade","chuck","trumpeter","ferret","opportunist","pinnace","salamander","transom","mace","individualist","synthesizer","thoroughbred","cupola","tomboy","ensign","bottling","whir","poultice","entranceway","saver","gurdwara","renegotiation","tossing","ruffle","footprint","skeptic","birthmark","tailspin","kickback","chalice","plagiarism","passer","inhumanity","ceremonial","sapling","babysitter","creeper","galleon","bellman","holly","hacienda","cur","transplantation","scab","ballgame","demotion","flimsy","hovel","lug","layup","firefighter","gravestone","nymph","cajole","tickle","boxcar","secession","refractor","somersault","personification","treacle","tutorial","voucher","thimble","stickler","front-runner","paroxysm","exorcism","psalm","infestation","scrubbing","castor","peppermint","orchestration","extremist","oppressor","lode","prompting","watchword","swindle","statehouse","floater","nightdress","bloak","elegy","woodshed","trembling","banning","adornment","redoubt","lightweight","postulate","anti-Semite","tasting","viewscreen","sentinel","nation-state","heft","nurture","villainy","manhunt","invoice","sprig","self-denial","selector","piglet","commemoration","crucible","piper","curtsy","lackey","breastplate","gadfly","octave","epilogue","self-examination","thyroid","apologist","chemise","super","figment","waif","essayist","brewer","miniature","sediment","cannibal","tulip","caramel","caseload","synonym","analogue","ver","shirtwaist","cornerback","insecticide","debauchery","lien","strangulation","intricacy","guesthouse","crumbling","glassware","cachet","thumping","damper","colonist","frolic","ogre","heist","sorting","pawl","muttering","refill","cowl","imbecile","painkiller","garter","creole","overpass","simile","potpourri","piling","predisposition","corsage","mobster","sandal","aphorism","vice-chairman","heartache","converter","pecan","ecologist","substrate","quagmire","trenchcoat","voyce","overstatement","soapbox","rediscovery","effusion","agronomist","firecracker","haunt","murmuring","henhouse","fluctuation","signora","mulberry","hoist","bullfight","discotheque","finder","tureen","hairstyle","dignitary","consummation","spar","pogrom","beeper","read","outboard","sho","skit","impurity","sadist","parafoil","bouncer","spender","locust","boardroom","burnout","inoculation","surfeit","welder","propagandist","mortuary","pessimist","equivalence","juke","spatter","incubator","reproof","gulch","notary","speedometer","lodger","mitt","southpaw","footman","amity","bloodline","cleaver","coffeehouse","confederate","assist","ation","lecher","abrasion","daybed","knit","laddie","forfeit","kebele","filigree","frisbee","cantina","oscillation","countryman","juggler","scion","acrobat","hourglass","realtor","onyx","pettiness","chancellery","footfall","slippage","mandarin","eral","lob","impertinence","providence","dom","idyll","democrat","deferral","sorority","slamming","badger","mutter","ling","strobe","explosive","municipality","crossover","bedstead","spatula","tug-of-war","goon","pauper","lation","sacking","alder","nightstick","salve","infraction","prowler","falsification","pant","drunk","rumbling","ce","minuet","plaything","yelling","kiddie","duction","buttress","carapace","sobbing","insufficiency","prig","bidet","bloodhound","madwoman","buffoon","vignette","doorjamb","caprice","gable","converse","cad","creche","mullah","spectre","spotter","ingenue","chalet","automatic","stash","truckload","tailback","static","productivist","dissipation","haunch","nag","awl","self-delusion","rattler","blacklist","beagle","trapeze","obstinacy","fiddler","theorem","rearrangement","changeover","reassignment","courtesan","fillet","nay","cutout","luncheonette","purveyor","incitement","remarriage","amelioration","executor","buttonhole","duality","churchman","sickroom","farmstead","jester","perfidy","cuticle","weal","snub","pretension","roadbed","furnishing","quickie","workweek","conveyance","pseudopatient","turbocharger","fleece","abbreviation","spigot","leaflet","great-aunt","ninny","beaker","experimenter","validation","inhabitant","grading","cantaloupe","potentiality","flue","commoner","playroom","readjustment","boathouse","vivacity","brakeman","petitioner","singularity","gage","delineation","fester","paratrooper","font","pitchfork","signifier","crossbar","playhouse","tripe","stylus","pacemaker","clustering","hone","runt","emporium","ragtag","aneurysm","trapper","pulley","thrashing","candlestick","checkerboard","swoop","surcoat","dystrophy","bristle","beck","toolbox","hunchback","subcompact","doze","seaway","disclaimer","arbitrator","miller","crackpot","loafer","instigation","sen","bale","skim","skip","dollop","tender","oeuvre","goner","sor","tort","cropland","profundity","caf","zoom","gabardine","quack","cataclysm","condolence","foxhole","circlet","brave","misfit","bivouac","artificiality","dachshund","puke","bagel","sortie","nomad","opal","ethnicity","firebox","ratchet","cud","worsted","squabbling","cheque","jean","avatar","dirge","footstool","velour","barrister","pression","microchip","coda","reappraisal","cess","hangman","centenary","plough","broomstick","headstone","tormentor","sore","rathorn","voyeur","world-view","co-star","warren","fail","deflation","noble","fleck","saleswoman","hap","machinist","waffle","tom","ell","prefab","suckling","guardhouse","sabre","entanglement","integrator","quarterly","paraffin","heifer","frivolity","good","bougainvillea","excommunication","distillation","cyclist","meteorologist","rubric","cul-de-sac","misnomer","phobia","demagogue","bloodletting","raconteur","ger","astrologer","zygote","counterrevolution","reinstatement","anchovy","getup","tryout","scullery","turnstile","cyst","mustang","gaslight","self-deception","emanation","grown-up","escapade","versity","fishery","paprika","grailstone","gurney","fount","holdout","licensee","jackknife","asterisk","still","fundamentalist","humbug","repast","christening","butternut","miniskirt","fortune-teller","spillway","ference","salver","payout","nodule","high","tugboat","gizzard","sympathizer","fibrillation","incompatibility","dodge","trove","mercenary","pigtail","matchbook","masterwork","barb","endeavour","confection","ephor","yarmulke","char","mimeograph","holdover","subtitle","saddlebag","metronome","tine","testicle","caveat","etching","auntie","guarantor","ringer","airman","boatman","carnivore","armband","polder","tryst","lem","sitting-room","barrow","reappearance","pastiche","bankroll","stroller","saxophonist","blanc","redesign","plotting","gruel","juicer","slat","scooter","socialist","gradient","ember","scorecard","remembering","bo","forecaster","flirt","backache","parakeet","pixie","guffaw","anesthetist","logjam","pursuer","physiologist","follicle","coverall","patsy","bunt","lubricant","jawbone","numeral","mourner","rune","bettor","solder","nitrite","rime","pinstripe","pistachio","monocle","equivocation","crystallization","twit","two-year-old","toupee","eyelash","recognizance","cy","sophistry","seesaw","loony","do-gooder","dusting","commonality","yearling","disbarment","self-congratulation","tsar","vagabond","rhinestone","viper","planetoid","crochet","laird","flatland","prompt","catamaran","wigwam","mainframe","shivering","stringer","vane","iniquity","hoodlum","tableware","smelter","overlay","umber","placenta","yew","right-hander","laggard","cornice","philanthropist","scouring","dissenter","mainsail","showplace","conch","sentimentalist","protectorate","sanitarium","truancy","angler","showpiece","carotene","pollutant","diabetic","hairbrush","videodisc","intellectualist","pothole","setter","tense","grader","kneecap","birdbath","dell","typhoid","tuba","torturer","commie","houseboat","revelry","medalist","hinterland","jowl","splotch","sable","mouf","ripoff","coolie","streetlamp","damn","sharecropper","oral","schoolmate","commander-in-chief","capitalization","flex","shtetl","chenille","pullback","pharaoh","claret","fulfilment","glower","remuneration","internationalist","pap","pediment","sonata","toke","co-director","dollhouse","salesgirl","greenback","analog","ofa","freelancer","hairpin","aphasia","kicking","bummer","lawmaker","thickening","juggernaut","comma","sander","claimant","triad","rhizome","prolongation","placer","transvestite","faceplate","shortening","coffle","surfer","greengrocer","roughage","dumbbell","coiffure","pinky","ex-President","start-up","bobby","sidearm","paean","raiment","conceptualization","surmise","agnostic","cranny","tassel","infarct","pitchman","minor","stationmaster","sublet","puter","dramatization","mounting","washstand","counsellor","penknife","curtailment","remake","millimeter","sextant","vocalist","blowup","walleye","pickax","fanny","ascendant","brushing","highball","bandleader","winning","godmother","horoscope","disequilibrium","run-up","grazer","sandbar","motorbike","hassock","piggy","teat","reprise","wheeling","psychotherapist","calabash","cob","relativist","packer","slayer","digger","banshee","autocrat","knave","muskrat","extinguisher","foreleg","sobriquet","hospice","accretion","mastermind","figurine","newsmagazine","epidemiologist","pic","minaret","dereliction","city-state","jawline","escapist","legation","weatherman","sinker","cabby","guardrail","objector","timepiece","cistern","werewolf","decadent","harlot","epiphany","bricklayer","doorkeeper","obsidian","bedpost","constriction","refectory","blackbird","enforcer","riposte","schmuck","squab","pop-up","handrail","sandbag","superman","underbelly","alarmist","sesame","paratroop","droplet","proclivity","theorizing","quark","tactician","sundae","poolhall","behaviorist","dipper","postmark","co-conspirator","carload","electrocution","mould","goodnight","appendectomy","statuette","coefficient","cornet","scolding","prude","platitude","carport","lilac","geisha","foist","mitigation","percussionist","lechery","wyrm","charlatan","tussle","slough","jamb","twister","lakeshore","scavenger","pinkie","changeling","pinhead","muster","exploring","fief","critter","haystack","skimmer","geyser","stumble","update","tabernacle","gargoyle","projectionist","requisite","suffix","ramrod","betrayer","perience","tance","fluting","flare-up","fatherland","guardianship","douche","good-night","trawler","headsman","stoplight","operetta","spend","hater","teakettle","geneticist","particular","wardroom","slider","deuce","gingham","telethon","acclamation","centrifuge","workstation","pretender","prong","lampshade","ureter","hiccup","acetate","molding","wallop","vagrant","three-star","carafe","blowout","equinox","rave","junior","spoof","confessor","troubleshooter","braggart","judgeship","rapier","landmass","stoic","cuckold","inheritor","forester","jangle","gymnast","wingman","stein","gnome","drumstick","whatnot","yachtsman","realty","glob","by-election","academic","deflection","knocker","wondering","mugging","petit","frosting","pillowcase","panelling","grendel","tribune","tabulation","simulator","whaler","stork","gill","cavalcade","workhorse","locksmith","preppie","henchman","countertop","groundcar","puree","wellspring","debasement","prankster","tration","insert","put-down","typer","chartreuse","crematorium","headpiece","noncom","wipe","drove","sportscaster","impersonator","shrew","twitching","loader","magnolia","dropping","functionary","dissonance","cudgel","forfeiture","glutton","reject","doubleheader","tarp","suburbanite","afghan","chaperone","bas-relief","oscilloscope","imposter","newel","trusteeship","shocker","cannonball","half-breed","woodpecker","tumbleweed","snip","consignment","left-hander","spoil","also-ran","exhalation","signification","tester","ashram","gardenia","deductible","frontline","subtraction","bowstring","upland","bearskin","gramophone","mock-up","serenade","mix-up","extrapolation","tidbit","semaphore","banging","dogwood","carol","mapping","exchanger","ignominy","retraction","videocassette","precept","sirloin","mortification","pagoda","belfry","cubbyhole","mindstone","greyhound","clank","snowbank","instep","sanatorium","savanna","longshoreman","copier","nightshirt","boatyard","brigand","usurpation","understudy","interrelationship","undercarriage","sulphate","quasar","marshmallow","thrush","sweeper","alleviation","feint","chimera","infidel","modifier","perennial","simpleton","gridiron","overlord","airway","binding","abstention","algorithm","amalgamation","ascension","herdsman","lollipop","pastel","laminate","tendril","synopsis","drawstring","intermarriage","restorer","swoon","firefight","civilisation","self-criticism","hanky","ventricle","jot","interferon","circel","avenger","stepson","amethyst","beachhead","loggia","sizzle","burp","watchtower","endearment","dryad","prefect","tong","croissant","blocker","brioche","thistle","sunburst","savor","dumpling","checker","soliloquy","marketer","wheeze","molar","oboe","inbound","masochist","superficiality","tabby","outcrop","deputation","bassist","particularity","strop","thang","doggy","zation","ghoul","domestic","frostbite","relapse","floorboard","clicking","paraphrase","sinkhole","pushcart","overdraft","spinnaker","sourdough","sweatshop","meteorite","lander","caboose","junket","planer","iguana","brouhaha","reaper","sharpshooter","eggshell","self-sacrifice","minnow","skyrocket","connexion","effrontery","oblong","biker","flinch","cog","bullock","retrial","underwriter","gentlewoman","noggin","sissy","collect","dogmatism","sweatsuit","biplane","polariser","server","hiker","electrolyte","thunderclap","bronc","snooze","mascot","sherbet","carillon","decal","womanizer","underground","tailcoat","worshipper","automaton","proscription","sleuth","honeybee","abutment","foller","palladium","partake","jailing","counterfeit","pompadour","moneymaker","acacia","monthly","geographer","doghouse","bludgeon","fitter","conservator","indecency","atoll","fife","acquit","barracuda","mortician","striker","plait","untruth","hoarding","eighteen-wheeler","shakeup","grounder","abuser","hamstring","parishioner","cherub","cubist","antler","kisser","shunt","cravat","admixture","whinny","scorpion","amenity","matchup","spacer","settling","insinuation","possum","tenancy","girder","adapter","mousetrap","cubble","steppe","hypochondriac","covey","whipping","taunt","pocketful","pug","panhandle","conga","citron","foul-up","plaint","nouveau","oilskin","meridian","lifer","bolster","wren","gripe","mountaineer","transceiver","treetop","hex","harrow","tampering","photocopy","redskin","cesspool","barrette","cleanser","missive","breakfront","mini","ridgeline","semi","pasha","byword","phoneme","seducer","miser","cookstove","limerick","cummerbund","labourer","ascot","wraith","tarantula","toffee","pituitary","liana","cleat","line-up","helix","highboy","bicep","partment","coed","expletive","dumpster","deferment","progenitor","sandbox","mignon","typhoon","sublimation","backdoor","alchemist","pacifier","insomniac","hairpiece","lintel","indemnity","blurb","republican","electrocardiogram","futurist","recliner","mote","sketchbook","fulcrum","gratuity","aqueduct","adherent","masque","sundial","template","handmaiden","hedgehog","coding","corsair","solstice","orifice","sonobuoy","prizewinner","spinner","townsman","rosette","mind-set","unkindness","pushover","bility","infielder","hutch","erasure","parallelism","avowal","fastness","broadcloth","hellhole","grandparent","toehold","ident","sleepwalker","watching","aerie","database","mismatch","hombre","scrambler","spoiler","putdown","rookery","spinoff","ringleader","duchy","sealskin","transformer","doggie","bedsheet","cowhide","ceramic","prostration","cheroot","houseboy","giantess","tomcat","speedster","basalt","minicomputer","rapacity","spaceman","in-law","equerry","humpback","academician","harvester","fairground","ream","carat","entreaty","groundswell","obfuscation","provocateur","fugue","denigration","rifleman","manipulator","panting","synod","glitch","nightie","goaltender","kingpin","comforter","anesthetic","klaxon","hijack","orb","hostelry","gladiator","misadventure","bombard","fixity","tanner","stringency","wonderland","x-ray","plainclothesman","roadhouse","travelogue","gasket","nibble","hacking","nude","tincture","receptor","fink","schoolmarm","washtub","homesteader","hacker","portiere","hatbox","tamer","howitzer","grouper","frontage","amoeba","clime","flashback","teamster","accolade","polluter","officeholder","inpatient","altercation","reverberation","coproduction","phosphor","substation","bandana","sapper","preserver","pigeonhole","prefecture","milkman","avocation","argyle","amphetamine","linker","leviathan","hamster","bondsman","comer","bumpkin","sheikh","beefsteak","tyke","discoloration","kingmaker","quotient","excision","whitey","asymmetry","trill","discourtesy","bleat","hatching","crier","creel","seabed","witticism","riser","lurcher","moviemaker","pantsuit","linchpin","deformation","deodorant","soybean","washboard","egotist","underpass","dysfunction","tingling","barstool","paramour","udder","microbe","radiologist","qualm","welt","salesperson","signpost","sepulcher","lumpectomy","slaver","shopgirl","peregrine","siesta","reiteration","profligacy","iodide","iconoclast","rollcall","fillip","oratorio","splat","incoherence","accompanist","motorcar","nunnery","busybody","carryall","nettle","jaguar","pretence","odometer","potentate","mussel","prophetess","monetarist","proach","typescript","hacksaw","broadsword","miter","fatty","terrarium","archangel","powerboat","stooge","cannery","pylon","pulsation","misstep","yucca","hearthstone","rumour","lockout","toboggan","trampoline","concatenation","debility","acorn","forklift","psion","dragonet","ligament","folio","tie-up","picking","swatch","arrowhead","martinet","fisher","quintet","ellipse","legitimation","nightwatch","hardback","schemer","conversationalist","collectivist","reallocation","diorama","cutaway","point-of-view","cattleman","abscess","talc","incubus","dribble","sis","rhododendron","rolling","spiderweb","nonsmoker","crissake","refusenik","save","obstructionist","suture","parenthesis","reefer","great-grandson","steelworker","bumblebee","bullfrog","festivity","embolism","defeatist","tankard","ferryman","garret","co-worker","consonant","copywriter","bookseller","compress","dogfight","embezzler","quiche","liege","dissector","taskmaster","prosthesis","emulsion","spitball","modulation","squint","retelling","baiting","whirr","air-conditioner","individuation","geezer","aspirant","pensioner","re-enactment","flapper","looker","marshland","sexton","adverb","coenzyme","misapprehension","inaccuracy","barmaid","beautician","daredevil","racehorse","oxford","spume","busload","tradesman","manicure","propellant","apothecary","ruffian","titillation","instigator","siting","ringmaster","enumeration","twirl","bookmaker","technocrat","mouth-harp","quaver","icehouse","ventilator","roadster","subpena","carter","comedienne","savannah","milkmaid","pumper","signer","deadbeat","cofounder","bootlegger","tribesman","wildfire","shard","hailstorm","struction","routing","dolmen","idiosyncrasy","poniard","honky-tonk","spendthrift","draftee","hermaphrodite","pinafore","roundabout","frill","redeployment","ophthalmologist","caldron","reinvestment","troubadour","fjord","leave-taking","elongation","clinch","trinket","suasion","neutralist","finalist","whiplash","ventriloquist","violator","monarchist","spanking","grindstone","initiator","standard-bearer","sender","atelier","distemper","ingot","frontiersman","altarpiece","endgame","homily","synapse","pillbox","ochre","scimitar","jubilee","presentiment","tation","aggrandizement","truncheon","damsel","fallibility","papaya","piggyback","puppeteer","workhouse","nightingale","entomologist","wicket","debriefing","logician","moorland","minimalist","matte","skirmishing","tonality","maidservant","yam","gatekeeper","whammy","drudge","angora","garland","manoeuvre","moviegoer","slingshot","titan","re-evaluation","ironwork","ambassadorship","lanch","pollination","riage","vocalization","brawler","shaving","particulate","inhaler","impoundment","surfboard","waterman","almanac","pepperoni","kook","colonnade","infantryman","scruple","functionalist","wisecrack","conscript","boor","bannister","pretzel","analgesic","firebrand","microprocessor","frame-up","guardsman","teetotaler","broad","pallbearer","airframe","wrangle","backboard","knockdown","reparation","poorhouse","milkshake","battlement","dragonfly","paymaster","snuffler","crudeness","nerd","blockhouse","donut","backhoe","principality","dimmer","wounding","collier","beater","footlocker","barkeep","absurdist","brickwork","great-uncle","rumination","appellation","joiner","hydrolysis","interlocutor","raindrop","hardtop","groping","cymbal","miscellany","pomegranate","hearer","abortionist","corncob","shoal","dunce","bellowing","bridgehead","mangrove","blotch","boxwood","briar","which","trickster","epileptic","dependent","encumbrance","claque","pickpocket","half-truth","bilge","overrun","caveman","posterior","derriere","sty","maggot","vibrator","imbecility","hang-up","syllogism","blindfold","sunbeam","chrysanthemum","amour","ne'er-do-well","odour","flowerpot","satrap","reconnoiter","tonsillectomy","clampdown","coliseum","warbler","hubcap","crudity","baseboard","lithograph","homeroom","stanchion","amphitheatre","disquisition","commonplace","feedlot","reprint","shire","kraken","careerist","goatskin","worldview","waddle","washout","doormat","diadem","sniffer","spat","superhighway","snooper","libation","zoologist","subtext","bailiwick","exterminator","popsicle","actuary","cabinetmaker","swami","contraceptive","softener","margarita","hatter","tention","earpiece","dormer","timberland","katun","crooner","one-liner","adjudication","snitch","referent","subset","disavowal","starburst","merchantman","dalliance","polymer","hypnotist","monogram","peerage","claymore","satyr","twerp","matchstick","rubber-stamp","clapper","exhibitionist","warhorse","eatery","seashell","radish","router","dinette","trombonist","rivet","requiem","breakaway","hard-liner","locator","shindig","corrective","truffle","whelp","expediter","savant","mitten","canton","wobble","misinterpretation","fense","headwrap","conciliator","chine","topping","assemblyman","divine","scuffling","boomlet","dervish","yellow-green","stockyard","hummock","trimming","royalist","calumny","vandal","prickle","strikeout","apologia","afterburner","hunker","flippancy","fop","embrasure","hornet","tithe","oilfield","lawman","turnkey","fledgling","coauthor","blowpipe","subjectivist","backstop","fishbowl","bedpan","sedge","protrusion","crybaby","freedman","seminarian","spacesuit","tautology","footstep","fiveyear","stoneware","mance","generalist","quitter","domicile","requisition","seance","cabana","wastrel","underling","looter","glassful","wallow","boater","disharmony","shiksa","herringbone","flyleaf","eyesore","lawnmower","walk-up","hemline","wiggle","posing","whirring","cropper","reappointment","psychodrama","shaver","orthodontist","granary","extrovert","calfskin","thinning","foghorn","trainload","carbide","metier","harpist","minim","ballcarrier","rayon","bursting","flipper","fastening","mullet","exploit","squatter","nullity","commodore","newlywed","eavesdropper","chiropractor","miler","arsonist","wrecker","transmutation","incompetency","subcontractor","tress","meatball","bobcat","distributorship","camcorder","pasty","glimmering","groaning","classicist","stakeout","supplicant","repeater","crackling","cryptographer","croupier","honeycomb","insincerity","inhibitor","mystification","greaser","barker","anthill","barbarity","strangle","myrtle","segmentation","marlin","capon","toenail","flip-flop","auger","blasphemer","dipping","pawnshop","penumbra","mohole","bauble","rube","flophouse","triplicate","sardine","master-mason","fang","brainstorm","derangement","hanker","molestation","smokescreen","cavalryman","edging","layover","signalman","clavicle","crewcut","tricolor","cochairman","liberationist","foreskin","bleacher","semi-circle","quince","flatcar","abattoir","farmboy","tibia","thrum","conformist","southerner","docudrama","whorl","break-up","conglomeration","exhibitor","bramble","cutie","woodchuck","compatriot","stole","tuner","housemother","dharma","femme","teahouse","banquette","bottomland","arranger","philistine","vacillation","chiton","retch","caddie","reissue","teaser","swampland","deejay","libertarian","pegboard","greenhorn","dork","cellmate","jobber","wishbone","millstone","haunting","blow-up","snorkel","snowplow","trespasser","punter","snowflake","snowdrift","gunnysack","surround","evergreen","clog","radioisotope","cougar","pundit","wattle","subgroup","oviduct","mixup","misstatement","sulfite","pansy","splint","counterproposal","pulsar","remove","landau","four-year-old","rebbe","disconnection","neomort","exegesis","meteoroid","meringue","sheepherder","radioman","strumpet","opment","millionth","speakeasy","conformation","cultivator","goof","annual","gazelle","demitasse","fishhook","preferment","homebody","skewer","chancre","sorbet","hologram","rivulet","oldster","prisoner-of-war","tulle","riff","restatement","debit","emplacement","repre","invariance","half-circle","objectivist","passer-by","scarlet","flail","impala","persimmon","purist","gation","burgher","snowman","starling","barony","annulment","lifespan","herder","embolden","swathe","ex-convict","trouper","half-wit","fuchsia","grange","ricochet","stinker","opacity","colander","absorber","armadillo","pleasantry","noncommunist","taxiway","overtone","debater","taillight","advisement","birdcage","baroness","aureole","breakout","colouring","astrophysicist","flatboat","stilt","eyeshade","barbell","deliverer","fishnet","prise","jackrabbit","manifold","chattel","jimmy","workshirt","thornbush","chatty","frisson","recount","patentee","oceanographer","forepaw","murderess","whalebone","frontrunner","cerebrum","jector","militiaman","lobsterman","earthling","clean","swindler","scree","begat","doorsill","housedress","strangler","shantytown","roughhouse","scenarist","foothill","contaminant","hamadryad","phony","fairyland","seascape","treble","prodigality","hobble","gantry","backroom","enticement","sawhorse","interviewee","cliffside","dustpan","scrubber","imbroglio","acquaintanceship","woodworker","aesthete","octogenarian","mauling","archivist","pungency","interweaving","jabber","bassinet","doubler","torte","linkup","outdoorsman","fixer","caddy","fumbling","defile","meristem","microbiologist","urologist","stovepipe","tambourine","constructionist","egomaniac","adjuster","liniment","impiety","timeline","cowgirl","sinecure","chillun","foreword","frat","retary","bagpipe","coif","visualization","colleen","shirtmaker","flounce","adder","riffle","underboss","reinterpretation","bender","seeding","fiver","sicken","decoder","holothete","figuring","stave","earplug","acrylic","epigraph","fairytale","flasher","sally","inkwell","nitwit","hussy","constrictor","stabilizer","stickup","seaplane","shimmy","dredge","updraft","speciality","insulator","frond","storyboard","shill","rafter","blowgun","dukedom","favourite","populist","striper","blowtorch","mallard","licking","poetess","tetracycline","ad-lib","toxicologist","fencer","gnawing","eration","photocell","golem","heirloom","penitence","gence","latecomer","broil","outdistance","howler","canine","replenishment","traditionalist","emcee","eyeglass","billow","eyelet","khaki","assignation","tepee","buccaneer","bellyache","parkland","musicologist","phaeton","spirochete","lanyard","mischance","tobacconist","blusher","castaway","meson","bouillabaisse","scrivener","stinger","life-cycle","harridan","motivator","mooring","crimp","inlay","purveyance","vertical","jackhammer","strongbox","dishpan","cobweb","couturier","chalkboard","basilisk","duckling","penitent","footrest","tangent","facing","peroration","floodlight","nouvelle","truss","sprite","drier","esplanade","banding","insulter","dialog","pincer","battlefront","missal","hayseed","parvenu","baronet","shipwright","whisker","no-hitter","double-dealing","moire","conjurer","rickshaw","crevasse","switchback","nicety","provincialism","novella","liberator","biggie","tune-up","ferryboat","remover","twosome","loveseat","tektite","sharpener","cartwheel","diva","flirting","disproportion","tortilla","rover","whodunit","birder","parley","birdsong","fiefdom","augury","harrier","tamale","judging","snakebite","diagnostician","tannin","qualifier","cheetah","distillery","protester","stockroom","factotum","newswoman","cosmopolitan","iridescence","aeroplane","toddy","co-defendant","parry","duocorn","boasting","elector","clarinetist","undergarment","psych","supergiant","armature","environ","collectivity","keepsake","gunfighter","wingspan","perforation","worshiper","groupie","cityscape","worrier","shipload","scallop","hatchery","portraitist","screamer","blaspheme","pacer","presenter","malcontent","seine","equivalency","scriptwriter","lieve","discard","bantam","centaur","typology","loiter","drubbing","airfoil","curio","grandmaster","finisher","luminary","alliteration","phantasy","blooper","fasting","samba","gearbox","islet","apricot","smidgen","inset","firestorm","madcap","seedbed","gunsight","forelock","disjunction","writhing","huckleberry","abstract","squirm","ironist","monosaccharide","pushbutton","terracotta","artiste","showgirl","cornea","temptress","popularization","free-fall","scribbling","conviviality","flange","thwack","droop","rower","sweatband","gopher","mandolin","slobber","stricture","calyx","dietician","rehash","padre","ancient","dotage","jacaranda","pensione","contravention","undulation","ironworker","currant","hankie","face-lift","anthropoid","depressant","war-horse","tithing","greeter","matchbox","woodcutter","magpie","wayfarer","handcuff","lawgiver","traverse","minion","cavalier","sonarman","defoliant","scamp","snowshoe","polyp","gainer","honkie","bottler","halloo","amputee","ontology","bromide","brisket","goodie","tavern-keeper","choker","preaching","molester","tonsure","recapitulation","aviary","stevedore","raffle","bootstrap","angiogram","plantain","tipper","hooting","seismometer","persecutor","lobotomy","pigsty","virologist","gamete","presbytery","stepping-stone","dressing-room","cyclamate","chipmunk","platelet","flogging","tuber","reservist","blinker","demographer","turncoat","demesne","fancier","ideologist","self-justification","bucketful","m'lord","rapping","bestiality","irrelevancy","oiler","mackinaw","flutist","trafficker","categorization","pram","world-system","cathouse","deceiver","idjit","double-take","reformulation","brushfire","separator","neigh","whimpering","crisscross","regurgitation","auteur","backwash","refiner","broadsheet","hedonist","recitative","nonentity","codger","tinting","policymaker","tutu","boondoggle","entrant","wok","small","boatload","searcher","taMing","sycophant","substructure","megalomaniac","rusher","saleslady","registrar","blackguard","neckerchief","oldie","clinician","flushing","pinwheel","dition","charioteer","beastie","stridency","verity","eyedropper","canvass","desperado","teardrop","farmyard","mannerist","macaw","valedictorian","whopper","pertinence","assay","puncher","manse","anatomist","dishtowel","nuke","egalitarian","tribulation","cinematographer","sailer","icicle","legume","spiritualist","nativist","these","progressive","blastocyst","harpooner","pedant","instrumentality","connector","masseur","vertebra","moonshiner","bowsprit","grabber","stele","clanking","renter","antihero","bankbook","jailbird","handicraft","fighter-bomber","streamer","retardant","wallflower","flamethrower","agate","cairn","bantamweight","agglomeration","roustabout","linden","roughneck","formance","moray","cession","rashness","capstone","derailment","declivity","snowfield","talon","haymaker","abductor","diffuser","geosector","camisole"]),qt}var Tn;function $n(){if(Tn)return at;Tn=1,Object.defineProperty(at,"__esModule",{value:!0}),at.nouns=at.adjectives=void 0;const i=yl();at.adjectives=i.default;const e=bl();return at.nouns=e.default,at}var In;function vl(){return In||(In=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.nouns=i.adjectives=i.uniqueUsernameGenerator=i.generateUsername=i.generateFromEmail=void 0;const e=$n(),t=(u=0,l=4294967295)=>Math.random()*((l|0)-(u|0)+1)+(u|0)|0,r=u=>{let l;switch(u){case 1:l=Math.floor(t(1,9)).toString();break;case 2:l=Math.floor(t(10,90)).toString();break;case 3:l=Math.floor(t(100,900)).toString();break;case 4:l=Math.floor(t(1e3,9e3)).toString();break;case 5:l=Math.floor(t(1e4,9e4)).toString();break;case 6:l=Math.floor(t(1e5,9e5)).toString();break;default:l="";break}return l};function n(u,l){return u.replace(/@.+/,"").replace(/[&/\\#,+()$~%._@'":*?<>{}]/g,"")+r(l)}i.generateFromEmail=n;function o(u,l,c,d){const h=e.nouns[Math.floor(Math.random()*e.nouns.length)],p=d?d.replace(/\s{2,}/g," ").replace(/\s/g,u??"").toLocaleLowerCase():e.adjectives[Math.floor(Math.random()*e.adjectives.length)];let g;return u?g=p+u+h+r(l):g=p+h+r(l),c?g.substring(0,c):g}i.generateUsername=o;function a(u){if(u.dictionaries){const l=g=>u.dictionaries[g][t(0,u.dictionaries[g].length-1)],c=u.dictionaries.length,d=u.separator||"";let h="";for(let g=0;g<c;g++){const f=l(g);h?h+=d+f:h=f}let p=h+r(u.randomDigits);if(p=p.toLowerCase(),u.style==="lowerCase")p=p.toLowerCase();else if(u.style==="capital"){const[g,...f]=p.split("");p=g.toUpperCase()+f.join("")}else u.style==="upperCase"&&(p=p.toUpperCase());return u.length?p.substring(0,u.length):p.substring(0,15)}else throw new Error("Cannot find any dictionary. Please provide at least one, or leave the 'dictionary' field empty in the config object")}i.uniqueUsernameGenerator=a;var s=$n();Object.defineProperty(i,"adjectives",{enumerable:!0,get:function(){return s.adjectives}}),Object.defineProperty(i,"nouns",{enumerable:!0,get:function(){return s.nouns}})}(fr)),fr}var kl=vl();class wl{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const t of this._parts)e.push(t);return xl(e).buffer}}function xl(i){let e=0;for(const n of i)e+=n.byteLength;const t=new Uint8Array(e);let r=0;for(const n of i){const o=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);t.set(o,r),r+=n.byteLength}return t}function Ui(i){return new Sl(i).unpack()}function Bi(i){const e=new Pl,t=e.pack(i);return t instanceof Promise?t.then(()=>e.getBuffer()):e.getBuffer()}class Sl{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let t;if((t=e^160)<=15)return this.unpack_raw(t);if((t=e^176)<=15)return this.unpack_string(t);if((t=e^144)<=15)return this.unpack_array(t);if((t=e^128)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),t=(e[0]&255)*256+(e[1]&255);return this.index+=2,t}unpack_uint32(){const e=this.read(4),t=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,t}unpack_uint64(){const e=this.read(8),t=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,t}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t}unpack_string(e){const t=this.read(e);let r=0,n="",o,a;for(;r<e;)o=t[r],o<160?(a=o,r++):(o^192)<32?(a=(o&31)<<6|t[r+1]&63,r+=2):(o^224)<16?(a=(o&15)<<12|(t[r+1]&63)<<6|t[r+2]&63,r+=3):(a=(o&7)<<18|(t[r+1]&63)<<12|(t[r+2]&63)<<6|t[r+3]&63,r+=4),n+=String.fromCodePoint(a);return this.index+=e,n}unpack_array(e){const t=new Array(e);for(let r=0;r<e;r++)t[r]=this.unpack();return t}unpack_map(e){const t={};for(let r=0;r<e;r++){const n=this.unpack();t[n]=this.unpack()}return t}unpack_float(){const e=this.unpack_uint32(),t=e>>31,r=(e>>23&255)-127,n=e&8388607|8388608;return(t===0?1:-1)*n*2**(r-23)}unpack_double(){const e=this.unpack_uint32(),t=this.unpack_uint32(),r=e>>31,n=(e>>20&2047)-1023,a=(e&1048575|1048576)*2**(n-20)+t*2**(n-52);return(r===0?1:-1)*a}read(e){const t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")}}class Pl{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const t=e.constructor;if(e instanceof Array){const r=this.pack_array(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const r=e;this.pack_bin(new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(r=>{this.pack_bin(new Uint8Array(r)),this._bufferBuilder.flush()});if(t==Object||t.toString().startsWith("class")){const r=this.pack_object(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${t.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const t=e.length;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this._bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const t=this._textEncoder.encode(e),r=t.length;if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this._bufferBuilder.append(216),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(r);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_array(e){const t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this._bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");const r=n=>{if(n<t){const o=this.pack(e[n]);return o instanceof Promise?o.then(()=>r(n+1)):r(n+1)}};return r(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let t=0;e<0&&(t=1,e=-e);const r=Math.floor(Math.log(e)/Math.LN2),n=e/2**r-1,o=Math.floor(n*2**52),a=2**32,s=t<<31|r+1023<<20|o/a&1048575,u=o%a;this._bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(u)}pack_object(e){const t=Object.keys(e),r=t.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this._bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");const n=o=>{if(o<t.length){const a=t[o];if(e.hasOwnProperty(a)){this.pack(a);const s=this.pack(e[a]);if(s instanceof Promise)return s.then(()=>n(o+1))}return n(o+1)}};return n(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const t=e&4294967295;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_uint64(e){const t=e/4294967296,r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const t=Math.floor(e/4294967296),r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}constructor(){this._bufferBuilder=new wl,this._textEncoder=new TextEncoder}}let qi=!0,Vi=!0;function Rt(i,e,t){const r=i.match(e);return r&&r.length>=t&&parseFloat(r[t],10)}function gt(i,e,t){if(!i.RTCPeerConnection)return;const r=i.RTCPeerConnection.prototype,n=r.addEventListener;r.addEventListener=function(a,s){if(a!==e)return n.apply(this,arguments);const u=l=>{const c=t(l);c&&(s.handleEvent?s.handleEvent(c):s(c))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(s,u),n.apply(this,[a,u])};const o=r.removeEventListener;r.removeEventListener=function(a,s){if(a!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(s))return o.apply(this,arguments);const u=this._eventMap[e].get(s);return this._eventMap[e].delete(s),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[a,u])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function Cl(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(qi=i,i?"adapter.js logging disabled":"adapter.js logging enabled")}function _l(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(Vi=!i,"adapter.js deprecation warnings "+(i?"disabled":"enabled"))}function Gi(){if(typeof window=="object"){if(qi)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Xr(i,e){Vi&&console.warn(i+" is deprecated, please use "+e+" instead.")}function Tl(i){const e={browser:null,version:null};if(typeof i>"u"||!i.navigator||!i.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=i;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(n=>n.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Rt(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||i.isSecureContext===!1&&i.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Rt(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(i.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Rt(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=i.RTCRtpTransceiver&&"currentDirection"in i.RTCRtpTransceiver.prototype,e._safariVersion=Rt(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function En(i){return Object.prototype.toString.call(i)==="[object Object]"}function Wi(i){return En(i)?Object.keys(i).reduce(function(e,t){const r=En(i[t]),n=r?Wi(i[t]):i[t],o=r&&!Object.keys(n).length;return n===void 0||o?e:Object.assign(e,{[t]:n})},{}):i}function Er(i,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Er(i,i.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(n=>{Er(i,i.get(n),t)})}))}function Rn(i,e,t){const r=t?"outbound-rtp":"inbound-rtp",n=new Map;if(e===null)return n;const o=[];return i.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&o.push(a)}),o.forEach(a=>{i.forEach(s=>{s.type===r&&s.trackId===a.id&&Er(i,s,n)})}),n}const Mn=Gi;function Hi(i,e){const t=i&&i.navigator;if(!t.mediaDevices)return;const r=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;const u={};return Object.keys(s).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const c=typeof s[l]=="object"?s[l]:{ideal:s[l]};c.exact!==void 0&&typeof c.exact=="number"&&(c.min=c.max=c.exact);const d=function(h,p){return h?h+p.charAt(0).toUpperCase()+p.slice(1):p==="deviceId"?"sourceId":p};if(c.ideal!==void 0){u.optional=u.optional||[];let h={};typeof c.ideal=="number"?(h[d("min",l)]=c.ideal,u.optional.push(h),h={},h[d("max",l)]=c.ideal,u.optional.push(h)):(h[d("",l)]=c.ideal,u.optional.push(h))}c.exact!==void 0&&typeof c.exact!="number"?(u.mandatory=u.mandatory||{},u.mandatory[d("",l)]=c.exact):["min","max"].forEach(h=>{c[h]!==void 0&&(u.mandatory=u.mandatory||{},u.mandatory[d(h,l)]=c[h])})}),s.advanced&&(u.optional=(u.optional||[]).concat(s.advanced)),u},n=function(s,u){if(e.version>=61)return u(s);if(s=JSON.parse(JSON.stringify(s)),s&&typeof s.audio=="object"){const l=function(c,d,h){d in c&&!(h in c)&&(c[h]=c[d],delete c[d])};s=JSON.parse(JSON.stringify(s)),l(s.audio,"autoGainControl","googAutoGainControl"),l(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=r(s.audio)}if(s&&typeof s.video=="object"){let l=s.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const c=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete s.video.facingMode;let d;if(l.exact==="environment"||l.ideal==="environment"?d=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(d=["front"]),d)return t.mediaDevices.enumerateDevices().then(h=>{h=h.filter(g=>g.kind==="videoinput");let p=h.find(g=>d.some(f=>g.label.toLowerCase().includes(f)));return!p&&h.length&&d.includes("back")&&(p=h[h.length-1]),p&&(s.video.deviceId=l.exact?{exact:p.deviceId}:{ideal:p.deviceId}),s.video=r(s.video),Mn("chrome: "+JSON.stringify(s)),u(s)})}s.video=r(s.video)}return Mn("chrome: "+JSON.stringify(s)),u(s)},o=function(s){return e.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(s,u,l){n(s,c=>{t.webkitGetUserMedia(c,u,d=>{l&&l(o(d))})})};if(t.getUserMedia=a.bind(t),t.mediaDevices.getUserMedia){const s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(u){return n(u,l=>s(l).then(c=>{if(l.audio&&!c.getAudioTracks().length||l.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return c},c=>Promise.reject(o(c))))}}}function Yi(i){i.MediaStream=i.MediaStream||i.webkitMediaStream}function Xi(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("ontrack"in i.RTCPeerConnection.prototype)){Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",n=>{let o;i.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(s=>s.track&&s.track.id===n.track.id):o={track:n.track};const a=new Event("track");a.track=n.track,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)}),r.stream.getTracks().forEach(n=>{let o;i.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(s=>s.track&&s.track.id===n.id):o={track:n};const a=new Event("track");a.track=n,a.receiver=o,a.transceiver={receiver:o},a.streams=[r.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else gt(i,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Ki(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("getSenders"in i.RTCPeerConnection.prototype)&&"createDTMFSender"in i.RTCPeerConnection.prototype){const e=function(n,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=n.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:n}};if(!i.RTCPeerConnection.prototype.getSenders){i.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(s,u){let l=n.apply(this,arguments);return l||(l=e(this,s),this._senders.push(l)),l};const o=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(s){o.apply(this,arguments);const u=this._senders.indexOf(s);u!==-1&&this._senders.splice(u,1)}}const t=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],t.apply(this,[o]),o.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const r=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],r.apply(this,[o]),o.getTracks().forEach(a=>{const s=this._senders.find(u=>u.track===a);s&&this._senders.splice(this._senders.indexOf(s),1)})}}else if(typeof i=="object"&&i.RTCPeerConnection&&"getSenders"in i.RTCPeerConnection.prototype&&"createDTMFSender"in i.RTCPeerConnection.prototype&&i.RTCRtpSender&&!("dtmf"in i.RTCRtpSender.prototype)){const e=i.RTCPeerConnection.prototype.getSenders;i.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(n=>n._pc=this),r},Object.defineProperty(i.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Zi(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender&&i.RTCRtpReceiver))return;if(!("getStats"in i.RTCRtpSender.prototype)){const t=i.RTCPeerConnection.prototype.getSenders;t&&(i.RTCPeerConnection.prototype.getSenders=function(){const o=t.apply(this,[]);return o.forEach(a=>a._pc=this),o});const r=i.RTCPeerConnection.prototype.addTrack;r&&(i.RTCPeerConnection.prototype.addTrack=function(){const o=r.apply(this,arguments);return o._pc=this,o}),i.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(a=>Rn(a,o.track,!0))}}if(!("getStats"in i.RTCRtpReceiver.prototype)){const t=i.RTCPeerConnection.prototype.getReceivers;t&&(i.RTCPeerConnection.prototype.getReceivers=function(){const n=t.apply(this,[]);return n.forEach(o=>o._pc=this),n}),gt(i,"track",r=>(r.receiver._pc=r.srcElement,r)),i.RTCRtpReceiver.prototype.getStats=function(){const n=this;return this._pc.getStats().then(o=>Rn(o,n.track,!1))}}if(!("getStats"in i.RTCRtpSender.prototype&&"getStats"in i.RTCRtpReceiver.prototype))return;const e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof i.MediaStreamTrack){const r=arguments[0];let n,o,a;return this.getSenders().forEach(s=>{s.track===r&&(n?a=!0:n=s)}),this.getReceivers().forEach(s=>(s.track===r&&(o?a=!0:o=s),s.track===r)),a||n&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Ji(i){i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(a,s){if(!s)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const u=e.apply(this,arguments);return this._shimmedLocalStreams[s.id]?this._shimmedLocalStreams[s.id].indexOf(u)===-1&&this._shimmedLocalStreams[s.id].push(u):this._shimmedLocalStreams[s.id]=[s,u],u};const t=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(l=>{if(this.getSenders().find(d=>d.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const s=this.getSenders();t.apply(this,arguments);const u=this.getSenders().filter(l=>s.indexOf(l)===-1);this._shimmedLocalStreams[a.id]=[a].concat(u)};const r=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],r.apply(this,arguments)};const n=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(s=>{const u=this._shimmedLocalStreams[s].indexOf(a);u!==-1&&this._shimmedLocalStreams[s].splice(u,1),this._shimmedLocalStreams[s].length===1&&delete this._shimmedLocalStreams[s]}),n.apply(this,arguments)}}function Qi(i,e){if(!i.RTCPeerConnection)return;if(i.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Ji(i);const t=i.RTCPeerConnection.prototype.getLocalStreams;i.RTCPeerConnection.prototype.getLocalStreams=function(){const c=t.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(d=>this._reverseStreams[d.id])};const r=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(d=>{if(this.getSenders().find(p=>p.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const d=new i.MediaStream(c.getTracks());this._streams[c.id]=d,this._reverseStreams[d.id]=c,c=d}r.apply(this,[c])};const n=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},i.RTCPeerConnection.prototype.addTrack=function(c,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const h=[].slice.call(arguments,1);if(h.length!==1||!h[0].getTracks().find(f=>f===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(f=>f.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const g=this._streams[d.id];if(g)g.addTrack(c),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const f=new i.MediaStream([c]);this._streams[d.id]=f,this._reverseStreams[f.id]=d,this.addStream(f)}return this.getSenders().find(f=>f.track===c)};function o(l,c){let d=c.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const p=l._reverseStreams[h],g=l._streams[p.id];d=d.replace(new RegExp(g.id,"g"),p.id)}),new RTCSessionDescription({type:c.type,sdp:d})}function a(l,c){let d=c.sdp;return Object.keys(l._reverseStreams||[]).forEach(h=>{const p=l._reverseStreams[h],g=l._streams[p.id];d=d.replace(new RegExp(p.id,"g"),g.id)}),new RTCSessionDescription({type:c.type,sdp:d})}["createOffer","createAnswer"].forEach(function(l){const c=i.RTCPeerConnection.prototype[l],d={[l](){const h=arguments;return arguments.length&&typeof arguments[0]=="function"?c.apply(this,[g=>{const f=o(this,g);h[0].apply(null,[f])},g=>{h[1]&&h[1].apply(null,g)},arguments[2]]):c.apply(this,arguments).then(g=>o(this,g))}};i.RTCPeerConnection.prototype[l]=d[l]});const s=i.RTCPeerConnection.prototype.setLocalDescription;i.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?s.apply(this,arguments):(arguments[0]=a(this,arguments[0]),s.apply(this,arguments))};const u=Object.getOwnPropertyDescriptor(i.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(i.RTCPeerConnection.prototype,"localDescription",{get(){const l=u.get.apply(this);return l.type===""?l:o(this,l)}}),i.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(c._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let h;Object.keys(this._streams).forEach(p=>{this._streams[p].getTracks().find(f=>c.track===f)&&(h=this._streams[p])}),h&&(h.getTracks().length===1?this.removeStream(this._reverseStreams[h.id]):h.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Rr(i,e){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=i.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new(t==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};i.RTCPeerConnection.prototype[t]=n[t]})}function eo(i,e){gt(i,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}const An=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:eo,shimAddTrackRemoveTrack:Qi,shimAddTrackRemoveTrackWithNative:Ji,shimGetSendersWithDtmf:Ki,shimGetUserMedia:Hi,shimMediaStream:Yi,shimOnTrack:Xi,shimPeerConnection:Rr,shimSenderReceiverGetStats:Zi},Symbol.toStringTag,{value:"Module"}));function to(i,e){const t=i&&i.navigator,r=i&&i.MediaStreamTrack;if(t.getUserMedia=function(n,o,a){Xr("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(n).then(o,a)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const n=function(a,s,u){s in a&&!(u in a)&&(a[u]=a[s],delete a[s])},o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),n(a.audio,"autoGainControl","mozAutoGainControl"),n(a.audio,"noiseSuppression","mozNoiseSuppression")),o(a)},r&&r.prototype.getSettings){const a=r.prototype.getSettings;r.prototype.getSettings=function(){const s=a.apply(this,arguments);return n(s,"mozAutoGainControl","autoGainControl"),n(s,"mozNoiseSuppression","noiseSuppression"),s}}if(r&&r.prototype.applyConstraints){const a=r.prototype.applyConstraints;r.prototype.applyConstraints=function(s){return this.kind==="audio"&&typeof s=="object"&&(s=JSON.parse(JSON.stringify(s)),n(s,"autoGainControl","mozAutoGainControl"),n(s,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[s])}}}}function $l(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(i.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,i.navigator.mediaDevices.getUserMedia(r)})}function ro(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Mr(i,e){if(typeof i!="object"||!(i.RTCPeerConnection||i.mozRTCPeerConnection))return;!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const o=i.RTCPeerConnection.prototype[n],a={[n](){return arguments[0]=new(n==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};i.RTCPeerConnection.prototype[n]=a[n]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[o,a,s]=arguments;return r.apply(this,[o||null]).then(u=>{if(e.version<53&&!a)try{u.forEach(l=>{l.type=t[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;u.forEach((c,d)=>{u.set(d,Object.assign({},c,{type:t[c.type]||c.type}))})}return u}).then(a,s)}}function no(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpSender.prototype)return;const e=i.RTCPeerConnection.prototype.getSenders;e&&(i.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(o=>o._pc=this),n});const t=i.RTCPeerConnection.prototype.addTrack;t&&(i.RTCPeerConnection.prototype.addTrack=function(){const n=t.apply(this,arguments);return n._pc=this,n}),i.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function io(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpReceiver.prototype)return;const e=i.RTCPeerConnection.prototype.getReceivers;e&&(i.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(n=>n._pc=this),r}),gt(i,"track",t=>(t.receiver._pc=t.srcElement,t)),i.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function oo(i){!i.RTCPeerConnection||"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){Xr("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function ao(i){i.DataChannel&&!i.RTCDataChannel&&(i.RTCDataChannel=i.DataChannel)}function so(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.addTransceiver;e&&(i.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const n=r.length>0;n&&r.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(n){const{sender:a}=o,s=a.getParameters();(!("encodings"in s)||s.encodings.length===1&&Object.keys(s.encodings[0]).length===0)&&(s.encodings=r,a.sendEncodings=r,this.setParametersPromises.push(a.setParameters(s).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return o})}function lo(i){if(!(typeof i=="object"&&i.RTCRtpSender))return;const e=i.RTCRtpSender.prototype.getParameters;e&&(i.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function co(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function uo(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createAnswer;i.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const Nn=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:so,shimCreateAnswer:uo,shimCreateOffer:co,shimGetDisplayMedia:$l,shimGetParameters:lo,shimGetUserMedia:to,shimOnTrack:ro,shimPeerConnection:Mr,shimRTCDataChannel:ao,shimReceiverGetStats:io,shimRemoveStream:oo,shimSenderGetStats:no},Symbol.toStringTag,{value:"Module"}));function po(i){if(!(typeof i!="object"||!i.RTCPeerConnection)){if("getLocalStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in i.RTCPeerConnection.prototype)){const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(n=>e.call(this,n,r)),r.getVideoTracks().forEach(n=>e.call(this,n,r))},i.RTCPeerConnection.prototype.addTrack=function(r,...n){return n&&n.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),e.apply(this,arguments)}}"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const n=t.getTracks();this.getSenders().forEach(o=>{n.includes(o.track)&&this.removeTrack(o)})})}}function ho(i){if(!(typeof i!="object"||!i.RTCPeerConnection)&&("getRemoteStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in i.RTCPeerConnection.prototype))){Object.defineProperty(i.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(n=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(n))return;this._remoteStreams.push(n);const o=new Event("addstream");o.stream=n,this.dispatchEvent(o)})})}});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(n){n.streams.forEach(o=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(o)>=0)return;r._remoteStreams.push(o);const a=new Event("addstream");a.stream=o,r.dispatchEvent(a)})}),e.apply(r,arguments)}}}function fo(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,n=e.setLocalDescription,o=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(l,c){const d=arguments.length>=2?arguments[2]:arguments[0],h=t.apply(this,[d]);return c?(h.then(l,c),Promise.resolve()):h},e.createAnswer=function(l,c){const d=arguments.length>=2?arguments[2]:arguments[0],h=r.apply(this,[d]);return c?(h.then(l,c),Promise.resolve()):h};let s=function(u,l,c){const d=n.apply(this,[u]);return c?(d.then(l,c),Promise.resolve()):d};e.setLocalDescription=s,s=function(u,l,c){const d=o.apply(this,[u]);return c?(d.then(l,c),Promise.resolve()):d},e.setRemoteDescription=s,s=function(u,l,c){const d=a.apply(this,[u]);return c?(d.then(l,c),Promise.resolve()):d},e.addIceCandidate=s}function mo(i){const e=i&&i.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=n=>r(go(n))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(r,n,o){e.mediaDevices.getUserMedia(r).then(n,o)}.bind(e))}function go(i){return i&&i.video!==void 0?Object.assign({},i,{video:Wi(i.video)}):i}function yo(i){if(!i.RTCPeerConnection)return;const e=i.RTCPeerConnection;i.RTCPeerConnection=function(r,n){if(r&&r.iceServers){const o=[];for(let a=0;a<r.iceServers.length;a++){let s=r.iceServers[a];s.urls===void 0&&s.url?(Xr("RTCIceServer.url","RTCIceServer.urls"),s=JSON.parse(JSON.stringify(s)),s.urls=s.url,delete s.url,o.push(s)):o.push(r.iceServers[a])}r.iceServers=o}return new e(r,n)},i.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(i.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function bo(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function vo(i){const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const n=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&n?n.direction==="sendrecv"?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":n.direction==="recvonly"&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):r.offerToReceiveAudio===!0&&!n&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const o=this.getTransceivers().find(a=>a.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function ko(i){typeof i!="object"||i.AudioContext||(i.AudioContext=i.webkitAudioContext)}const On=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:ko,shimCallbacksAPI:fo,shimConstraints:go,shimCreateOfferLegacy:vo,shimGetUserMedia:mo,shimLocalStreamsAPI:po,shimRTCIceServerUrls:yo,shimRemoteStreamsAPI:ho,shimTrackEventTransceiver:bo},Symbol.toStringTag,{value:"Module"}));var mr={exports:{}},Fn;function Il(){return Fn||(Fn=1,function(i){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((n,o)=>(o>0?"m="+n:n).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(n=>n.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const n={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let o=8;o<r.length;o+=2)switch(r[o]){case"raddr":n.relatedAddress=r[o+1];break;case"rport":n.relatedPort=parseInt(r[o+1],10);break;case"tcptype":n.tcpType=r[o+1];break;case"ufrag":n.ufrag=r[o+1],n.usernameFragment=r[o+1];break;default:n[r[o]]===void 0&&(n[r[o]]=r[o+1]);break}return n},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const n=t.component;n==="rtp"?r.push(1):n==="rtcp"?r.push(2):r.push(n),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const o=t.type;return r.push("typ"),r.push(o),o!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const n={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),n.name=r[0],n.clockRate=parseInt(r[1],10),n.channels=r.length===3?parseInt(r[2],10):1,n.numChannels=n.channels,n},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const n=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(n!==1?"/"+n:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let n;const o=t.substring(t.indexOf(" ")+1).split(";");for(let a=0;a<o.length;a++)n=o[a].trim().split("="),r[n[0].trim()]=n[1];return r},e.writeFmtp=function(t){let r="",n=t.payloadType;if(t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const o=[];Object.keys(t.parameters).forEach(a=>{t.parameters[a]!==void 0?o.push(a+"="+t.parameters[a]):o.push(a)}),r+="a=fmtp:"+n+" "+o.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",n=t.payloadType;return t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(o=>{r+="a=rtcp-fb:"+n+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),n={ssrc:parseInt(t.substring(7,r),10)},o=t.indexOf(":",r);return o>-1?(n.attribute=t.substring(r+1,o),n.value=t.substring(o+1)):n.attribute=t.substring(r+1),n},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(n=>parseInt(n,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let n="a=setup:"+r+`\r
`;return t.fingerprints.forEach(o=>{n+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),n},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const n=e.matchPrefix(t+r,"a=ice-ufrag:")[0],o=e.matchPrefix(t+r,"a=ice-pwd:")[0];return n&&o?{usernameFragment:n.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(t)[0].split(" ");r.profile=o[2];for(let s=3;s<o.length;s++){const u=o[s],l=e.matchPrefix(t,"a=rtpmap:"+u+" ")[0];if(l){const c=e.parseRtpMap(l),d=e.matchPrefix(t,"a=fmtp:"+u+" ");switch(c.parameters=d.length?e.parseFmtp(d[0]):{},c.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+u+" ").map(e.parseRtcpFb),r.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(c.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(s=>{r.headerExtensions.push(e.parseExtmap(s))});const a=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(s=>{a.forEach(u=>{s.rtcpFeedback.find(c=>c.type===u.type&&c.parameter===u.parameter)||s.rtcpFeedback.push(u)})}),r},e.writeRtpDescription=function(t,r){let n="";n+="m="+t+" ",n+=r.codecs.length>0?"9":"0",n+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",n+=r.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,n+=`c=IN IP4 0.0.0.0\r
`,n+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(a=>{n+=e.writeRtpMap(a),n+=e.writeFmtp(a),n+=e.writeRtcpFb(a)});let o=0;return r.codecs.forEach(a=>{a.maxptime>o&&(o=a.maxptime)}),o>0&&(n+="a=maxptime:"+o+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(a=>{n+=e.writeExtmap(a)}),n},e.parseRtpEncodingParameters=function(t){const r=[],n=e.parseRtpParameters(t),o=n.fecMechanisms.indexOf("RED")!==-1,a=n.fecMechanisms.indexOf("ULPFEC")!==-1,s=e.matchPrefix(t,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname"),u=s.length>0&&s[0].ssrc;let l;const c=e.matchPrefix(t,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(g=>parseInt(g,10)));c.length>0&&c[0].length>1&&c[0][0]===u&&(l=c[0][1]),n.codecs.forEach(h=>{if(h.name.toUpperCase()==="RTX"&&h.parameters.apt){let p={ssrc:u,codecPayloadType:parseInt(h.parameters.apt,10)};u&&l&&(p.rtx={ssrc:l}),r.push(p),o&&(p=JSON.parse(JSON.stringify(p)),p.fec={ssrc:u,mechanism:a?"red+ulpfec":"red"},r.push(p))}}),r.length===0&&u&&r.push({ssrc:u});let d=e.matchPrefix(t,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(h=>{h.maxBitrate=d})),r},e.parseRtcpParameters=function(t){const r={},n=e.matchPrefix(t,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="cname")[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);const o=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=o.length===0;const a=e.matchPrefix(t,"a=rtcp-mux");return r.mux=a.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const n=e.matchPrefix(t,"a=msid:");if(n.length===1)return r=n[0].substring(7).split(" "),{stream:r[0],track:r[1]};const o=e.matchPrefix(t,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(o.length>0)return r=o[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),n=e.matchPrefix(t,"a=max-message-size:");let o;n.length>0&&(o=parseInt(n[0].substring(19),10)),isNaN(o)&&(o=65536);const a=e.matchPrefix(t,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};const s=e.matchPrefix(t,"a=sctpmap:");if(s.length>0){const u=s[0].substring(10).split(" ");return{port:parseInt(u[0],10),protocol:u[1],maxMessageSize:o}}},e.writeSctpDescription=function(t,r){let n=[];return t.protocol!=="DTLS/SCTP"?n=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:n=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&n.push("a=max-message-size:"+r.maxMessageSize+`\r
`),n.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,n){let o;const a=r!==void 0?r:2;return t?o=t:o=e.generateSessionId(),`v=0\r
o=`+(n||"thisisadapterortc")+" "+o+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const n=e.splitLines(t);for(let o=0;o<n.length;o++)switch(n[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[o].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const n=e.splitLines(t)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},e.parseOLine=function(t){const n=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let n=0;n<r.length;n++)if(r[n].length<2||r[n].charAt(1)!=="=")return!1;return!0},i.exports=e}(mr)),mr.exports}var wo=Il();const wt=Br(wo),El=Ns({__proto__:null,default:wt},[wo]);function Yt(i){if(!i.RTCIceCandidate||i.RTCIceCandidate&&"foundation"in i.RTCIceCandidate.prototype)return;const e=i.RTCIceCandidate;i.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const n=new e(r),o=wt.parseCandidate(r.candidate);for(const a in o)a in n||Object.defineProperty(n,a,{value:o[a]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new e(r)},i.RTCIceCandidate.prototype=e.prototype,gt(i,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new i.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Ar(i){!i.RTCIceCandidate||i.RTCIceCandidate&&"relayProtocol"in i.RTCIceCandidate.prototype||gt(i,"icecandidate",e=>{if(e.candidate){const t=wt.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Xt(i,e){if(!i.RTCPeerConnection)return;"sctp"in i.RTCPeerConnection.prototype||Object.defineProperty(i.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(s){if(!s||!s.sdp)return!1;const u=wt.splitSections(s.sdp);return u.shift(),u.some(l=>{const c=wt.parseMLine(l);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})},r=function(s){const u=s.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(u===null||u.length<2)return-1;const l=parseInt(u[1],10);return l!==l?-1:l},n=function(s){let u=65536;return e.browser==="firefox"&&(e.version<57?s===-1?u=16384:u=2147483637:e.version<60?u=e.version===57?65535:65536:u=2147483637),u},o=function(s,u){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const c=wt.matchPrefix(s.sdp,"a=max-message-size:");return c.length>0?l=parseInt(c[0].substring(19),10):e.browser==="firefox"&&u!==-1&&(l=2147483637),l},a=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:u}=this.getConfiguration();u==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const u=r(arguments[0]),l=n(u),c=o(arguments[0],u);let d;l===0&&c===0?d=Number.POSITIVE_INFINITY:l===0||c===0?d=Math.max(l,c):d=Math.min(l,c);const h={};Object.defineProperty(h,"maxMessageSize",{get(){return d}}),this._sctp=h}return a.apply(this,arguments)}}function Kt(i){if(!(i.RTCPeerConnection&&"createDataChannel"in i.RTCPeerConnection.prototype))return;function e(r,n){const o=r.send;r.send=function(){const s=arguments[0],u=s.length||s.size||s.byteLength;if(r.readyState==="open"&&n.sctp&&u>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return o.apply(r,arguments)}}const t=i.RTCPeerConnection.prototype.createDataChannel;i.RTCPeerConnection.prototype.createDataChannel=function(){const n=t.apply(this,arguments);return e(n,this),n},gt(i,"datachannel",r=>(e(r.channel,r.target),r))}function Nr(i){if(!i.RTCPeerConnection||"connectionState"in i.RTCPeerConnection.prototype)return;const e=i.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=n=>{const o=n.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const a=new Event("connectionstatechange",n);o.dispatchEvent(a)}return n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Or(i,e){if(!i.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(n){if(n&&n.sdp&&n.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=n.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);i.RTCSessionDescription&&n instanceof i.RTCSessionDescription?arguments[0]=new i.RTCSessionDescription({type:n.type,sdp:o}):n.sdp=o}return t.apply(this,arguments)}}function Zt(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const t=i.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Jt(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const t=i.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(i.RTCPeerConnection.prototype.setLocalDescription=function(){let n=arguments[0]||{};if(typeof n!="object"||n.type&&n.sdp)return t.apply(this,arguments);if(n={type:n.type,sdp:n.sdp},!n.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":n.type="offer";break;default:n.type="answer";break}return n.sdp||n.type!=="offer"&&n.type!=="answer"?t.apply(this,[n]):(n.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>t.apply(this,[a]))})}const Rl=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:Or,shimAddIceCandidateNullOrEmpty:Zt,shimConnectionState:Nr,shimMaxMessageSize:Xt,shimParameterlessSetLocalDescription:Jt,shimRTCIceCandidate:Yt,shimRTCIceCandidateRelayProtocol:Ar,shimSendThrowTypeError:Kt},Symbol.toStringTag,{value:"Module"}));function Ml({window:i}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=Gi,r=Tl(i),n={browserDetails:r,commonShim:Rl,extractVersion:Rt,disableLog:Cl,disableWarnings:_l,sdp:El};switch(r.browser){case"chrome":if(!An||!Rr||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),n;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),n;t("adapter.js shimming chrome."),n.browserShim=An,Zt(i,r),Jt(i),Hi(i,r),Yi(i),Rr(i,r),Xi(i),Qi(i,r),Ki(i),Zi(i),eo(i,r),Yt(i),Ar(i),Nr(i),Xt(i,r),Kt(i),Or(i,r);break;case"firefox":if(!Nn||!Mr||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),n;t("adapter.js shimming firefox."),n.browserShim=Nn,Zt(i,r),Jt(i),to(i,r),Mr(i,r),ro(i),oo(i),no(i),io(i),ao(i),so(i),lo(i),co(i),uo(i),Yt(i),Nr(i),Xt(i,r),Kt(i);break;case"safari":if(!On||!e.shimSafari)return t("Safari shim is not included in this adapter release."),n;t("adapter.js shimming safari."),n.browserShim=On,Zt(i,r),Jt(i),yo(i),vo(i),fo(i),po(i),ho(i),bo(i),mo(i),ko(i),Yt(i),Ar(i),Xt(i,r),Kt(i),Or(i,r);break;default:t("Unsupported browser!");break}return n}const Dn=Ml({window:typeof window>"u"?void 0:window});function yt(i,e,t,r){Object.defineProperty(i,e,{get:t,set:r,enumerable:!0,configurable:!0})}class xo{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const t=[],r=e.byteLength,n=Math.ceil(r/this.chunkedMTU);let o=0,a=0;for(;a<r;){const s=Math.min(r,a+this.chunkedMTU),u=e.slice(a,s),l={__peerData:this._dataCount,n:o,data:u,total:n};t.push(l),a=s,o++}return this._dataCount++,t}}}function Al(i){let e=0;for(const n of i)e+=n.byteLength;const t=new Uint8Array(e);let r=0;for(const n of i)t.set(n,r),r+=n.byteLength;return t}const gr=Dn.default||Dn,Pt=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const i=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(i)?i==="chrome"?e>=this.minChromeVersion:i==="firefox"?e>=this.minFirefoxVersion:i==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return gr.browserDetails.browser}getVersion(){return gr.browserDetails.version||0}isUnifiedPlanSupported(){const i=this.getBrowser(),e=gr.browserDetails.version||0;if(i==="chrome"&&e<this.minChromeVersion)return!1;if(i==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t,r=!1;try{t=new RTCPeerConnection,t.addTransceiver("audio"),r=!0}catch{}finally{t&&t.close()}return r}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},Nl=i=>!i||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(i),So=()=>Math.random().toString(36).slice(2),zn={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class Ol extends xo{noop(){}blobToArrayBuffer(e,t){const r=new FileReader;return r.onload=function(n){n.target&&t(n.target.result)},r.readAsArrayBuffer(e),r}binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r)&255;return t.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=zn,this.browser=Pt.getBrowser(),this.browserVersion=Pt.getVersion(),this.pack=Bi,this.unpack=Ui,this.supports=function(){const t={browser:Pt.isBrowserSupported(),webRTC:Pt.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;let r;try{r=new RTCPeerConnection(zn),t.audioVideo=!0;let n;try{n=r.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!Pt.isIOS}catch{}}catch{}finally{n&&n.close()}}catch{}finally{r&&r.close()}return t}(),this.validateId=Nl,this.randomToken=So}}const Fe=new Ol,Fl="PeerJS: ";var Ln;(function(i){i[i.Disabled=0]="Disabled",i[i.Errors=1]="Errors",i[i.Warnings=2]="Warnings",i[i.All=3]="All"})(Ln||(Ln={}));class Dl{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...t){const r=[Fl,...t];for(const n in r)r[n]instanceof Error&&(r[n]="("+r[n].name+") "+r[n].message);e>=3?console.log(...r):e>=2?console.warn("WARNING",...r):e>=1&&console.error("ERROR",...r)}constructor(){this._logLevel=0}}var U=new Dl,Kr={},zl=Object.prototype.hasOwnProperty,Me="~";function Ft(){}Object.create&&(Ft.prototype=Object.create(null),new Ft().__proto__||(Me=!1));function Ll(i,e,t){this.fn=i,this.context=e,this.once=t||!1}function Po(i,e,t,r,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new Ll(t,r||i,n),a=Me?Me+e:e;return i._events[a]?i._events[a].fn?i._events[a]=[i._events[a],o]:i._events[a].push(o):(i._events[a]=o,i._eventsCount++),i}function Qt(i,e){--i._eventsCount===0?i._events=new Ft:delete i._events[e]}function Ee(){this._events=new Ft,this._eventsCount=0}Ee.prototype.eventNames=function(){var e=[],t,r;if(this._eventsCount===0)return e;for(r in t=this._events)zl.call(t,r)&&e.push(Me?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};Ee.prototype.listeners=function(e){var t=Me?Me+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,o=r.length,a=new Array(o);n<o;n++)a[n]=r[n].fn;return a};Ee.prototype.listenerCount=function(e){var t=Me?Me+e:e,r=this._events[t];return r?r.fn?1:r.length:0};Ee.prototype.emit=function(e,t,r,n,o,a){var s=Me?Me+e:e;if(!this._events[s])return!1;var u=this._events[s],l=arguments.length,c,d;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,n),!0;case 5:return u.fn.call(u.context,t,r,n,o),!0;case 6:return u.fn.call(u.context,t,r,n,o,a),!0}for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];u.fn.apply(u.context,c)}else{var h=u.length,p;for(d=0;d<h;d++)switch(u[d].once&&this.removeListener(e,u[d].fn,void 0,!0),l){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,t);break;case 3:u[d].fn.call(u[d].context,t,r);break;case 4:u[d].fn.call(u[d].context,t,r,n);break;default:if(!c)for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];u[d].fn.apply(u[d].context,c)}}return!0};Ee.prototype.on=function(e,t,r){return Po(this,e,t,r,!1)};Ee.prototype.once=function(e,t,r){return Po(this,e,t,r,!0)};Ee.prototype.removeListener=function(e,t,r,n){var o=Me?Me+e:e;if(!this._events[o])return this;if(!t)return Qt(this,o),this;var a=this._events[o];if(a.fn)a.fn===t&&(!n||a.once)&&(!r||a.context===r)&&Qt(this,o);else{for(var s=0,u=[],l=a.length;s<l;s++)(a[s].fn!==t||n&&!a[s].once||r&&a[s].context!==r)&&u.push(a[s]);u.length?this._events[o]=u.length===1?u[0]:u:Qt(this,o)}return this};Ee.prototype.removeAllListeners=function(e){var t;return e?(t=Me?Me+e:e,this._events[t]&&Qt(this,t)):(this._events=new Ft,this._eventsCount=0),this};Ee.prototype.off=Ee.prototype.removeListener;Ee.prototype.addListener=Ee.prototype.on;Ee.prefixed=Me;Ee.EventEmitter=Ee;Kr=Ee;var bt={};yt(bt,"ConnectionType",()=>Je);yt(bt,"PeerErrorType",()=>ye);yt(bt,"BaseConnectionErrorType",()=>Dt);yt(bt,"DataConnectionErrorType",()=>zt);yt(bt,"SerializationType",()=>xt);yt(bt,"SocketEventType",()=>Ze);yt(bt,"ServerMessageType",()=>Ce);var Je;(function(i){i.Data="data",i.Media="media"})(Je||(Je={}));var ye;(function(i){i.BrowserIncompatible="browser-incompatible",i.Disconnected="disconnected",i.InvalidID="invalid-id",i.InvalidKey="invalid-key",i.Network="network",i.PeerUnavailable="peer-unavailable",i.SslUnavailable="ssl-unavailable",i.ServerError="server-error",i.SocketError="socket-error",i.SocketClosed="socket-closed",i.UnavailableID="unavailable-id",i.WebRTC="webrtc"})(ye||(ye={}));var Dt;(function(i){i.NegotiationFailed="negotiation-failed",i.ConnectionClosed="connection-closed"})(Dt||(Dt={}));var zt;(function(i){i.NotOpenYet="not-open-yet",i.MessageToBig="message-too-big"})(zt||(zt={}));var xt;(function(i){i.Binary="binary",i.BinaryUTF8="binary-utf8",i.JSON="json",i.None="raw"})(xt||(xt={}));var Ze;(function(i){i.Message="message",i.Disconnected="disconnected",i.Error="error",i.Close="close"})(Ze||(Ze={}));var Ce;(function(i){i.Heartbeat="HEARTBEAT",i.Candidate="CANDIDATE",i.Offer="OFFER",i.Answer="ANSWER",i.Open="OPEN",i.Error="ERROR",i.IdTaken="ID-TAKEN",i.InvalidKey="INVALID-KEY",i.Leave="LEAVE",i.Expire="EXPIRE"})(Ce||(Ce={}));var Zr={};Zr=JSON.parse('{"name":"peerjs","version":"1.5.4","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stückler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Sören Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.1.0","webrtc-adapter":"^9.0.0"},"alias":{"process":false,"buffer":false}}');class jl extends Kr.EventEmitter{constructor(e,t,r,n,o,a=5e3){super(),this.pingInterval=a,this._disconnected=!0,this._messagesQueue=[];const s=e?"wss://":"ws://";this._baseUrl=s+t+":"+r+n+"peerjs?key="+o}start(e,t){this._id=e;const r=`${this._baseUrl}&id=${e}&token=${t}`;this._socket||!this._disconnected||(this._socket=new WebSocket(r+"&version="+Zr.version),this._disconnected=!1,this._socket.onmessage=n=>{let o;try{o=JSON.parse(n.data),U.log("Server message received:",o)}catch{U.log("Invalid server message",n.data);return}this.emit(Ze.Message,o)},this._socket.onclose=n=>{this._disconnected||(U.log("Socket closed.",n),this._cleanup(),this._disconnected=!0,this.emit(Ze.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),U.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){U.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:Ce.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const t of e)this.send(t)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(Ze.Error,"Invalid message");return}if(!this._wsOpen())return;const t=JSON.stringify(e);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class Co{constructor(e){this.connection=e}startConnection(e){const t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===Je.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){const r=this.connection,n={ordered:!!e.reliable},o=t.createDataChannel(r.label,n);r._initializeDataChannel(o),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){U.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const t=this.connection.peer,r=this.connection.connectionId,n=this.connection.type,o=this.connection.provider;U.log("Listening for ICE candidates."),e.onicecandidate=a=>{!a.candidate||!a.candidate.candidate||(U.log(`Received ICE candidates for ${t}:`,a.candidate),o.socket.send({type:Ce.Candidate,payload:{candidate:a.candidate,type:n,connectionId:r},dst:t}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":U.log("iceConnectionState is failed, closing connections to "+t),this.connection.emitError(Dt.NegotiationFailed,"Negotiation of connection to "+t+" failed."),this.connection.close();break;case"closed":U.log("iceConnectionState is closed, closing connections to "+t),this.connection.emitError(Dt.ConnectionClosed,"Connection to "+t+" closed."),this.connection.close();break;case"disconnected":U.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},U.log("Listening for data channel"),e.ondatachannel=a=>{U.log("Received data channel");const s=a.channel;o.getConnection(t,r)._initializeDataChannel(s)},U.log("Listening for remote stream"),e.ontrack=a=>{U.log("Received remote stream");const s=a.streams[0],u=o.getConnection(t,r);if(u.type===Je.Media){const l=u;this._addStreamToMediaConnection(s,l)}}}cleanup(){U.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const t=e.signalingState!=="closed";let r=!1;const n=this.connection.dataChannel;n&&(r=!!n.readyState&&n.readyState!=="closed"),(t||r)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createOffer(this.connection.options.constraints);U.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),U.log("Set localDescription:",r,`for:${this.connection.peer}`);let n={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===Je.Data){const o=this.connection;n={...n,label:o.label,reliable:o.reliable,serialization:o.serialization}}t.socket.send({type:Ce.Offer,payload:n,dst:this.connection.peer})}catch(n){n!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(ye.WebRTC,n),U.log("Failed to setLocalDescription, ",n))}}catch(r){t.emitError(ye.WebRTC,r),U.log("Failed to createOffer, ",r)}}async _makeAnswer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createAnswer();U.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),U.log("Set localDescription:",r,`for:${this.connection.peer}`),t.socket.send({type:Ce.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(n){t.emitError(ye.WebRTC,n),U.log("Failed to setLocalDescription, ",n)}}catch(r){t.emitError(ye.WebRTC,r),U.log("Failed to create answer, ",r)}}async handleSDP(e,t){t=new RTCSessionDescription(t);const r=this.connection.peerConnection,n=this.connection.provider;U.log("Setting remote description",t);const o=this;try{await r.setRemoteDescription(t),U.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await o._makeAnswer()}catch(a){n.emitError(ye.WebRTC,a),U.log("Failed to setRemoteDescription, ",a)}}async handleCandidate(e){U.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),U.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(ye.WebRTC,t),U.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(e,t){if(U.log(`add tracks from stream ${e.id} to peer connection`),!t.addTrack)return U.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(r=>{t.addTrack(r,e)})}_addStreamToMediaConnection(e,t){U.log(`add stream ${e.id} to media connection ${t.connectionId}`),t.addStream(e)}}class _o extends Kr.EventEmitter{emitError(e,t){U.error("Error:",t),this.emit("error",new Ul(`${e}`,t))}}class Ul extends Error{constructor(e,t){typeof t=="string"?super(t):(super(),Object.assign(this,t)),this.type=e}}class To extends _o{get open(){return this._open}constructor(e,t,r){super(),this.peer=e,this.provider=t,this.options=r,this._open=!1,this.metadata=r.metadata}}class rr extends To{static#e=this.ID_PREFIX="mc_";get type(){return Je.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,t,r){super(e,t,r),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||rr.ID_PREFIX+Fe.randomToken(),this._negotiator=new Co(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{U.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{U.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){U.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const t=e.type,r=e.payload;switch(e.type){case Ce.Answer:this._negotiator.handleSDP(t,r.sdp),this._open=!0;break;case Ce.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:U.warn(`Unrecognized message type:${t} from peer:${this.peer}`);break}}answer(e,t={}){if(this._localStream){U.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const r=this.provider._getMessages(this.connectionId);for(const n of r)this.handleMessage(n);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class Bl{constructor(e){this._options=e}_buildRequest(e){const t=this._options.secure?"https":"http",{host:r,port:n,path:o,key:a}=this._options,s=new URL(`${t}://${r}:${n}${o}${a}/${e}`);return s.searchParams.set("ts",`${Date.now()}${Math.random()}`),s.searchParams.set("version",Zr.version),fetch(s.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){U.error("Error retrieving ID",e);let t="";throw this._options.path==="/"&&this._options.host!==Fe.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let t="";throw this._options.host===Fe.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw U.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}class nr extends To{static#e=this.ID_PREFIX="dc_";static#n=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return Je.Data}constructor(e,t,r){super(e,t,r),this.connectionId=this.options.connectionId||nr.ID_PREFIX+So(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new Co(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{U.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{U.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{U.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,t=!1){if(!this.open){this.emitError(zt.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,t)}async handleMessage(e){const t=e.payload;switch(e.type){case Ce.Answer:await this._negotiator.handleSDP(e.type,t.sdp);break;case Ce.Candidate:await this._negotiator.handleCandidate(t.candidate);break;default:U.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}}class Jr extends nr{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>nr.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(t){return U.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class yr extends Jr{close(e){super.close(e),this._chunkedData={}}constructor(e,t,r){super(e,t,r),this.chunker=new xo,this.serialization=xt.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const t=Ui(e),r=t.__peerData;if(r){if(r.type==="close"){this.close();return}this._handleChunk(t);return}this.emit("data",t)}_handleChunk(e){const t=e.__peerData,r=this._chunkedData[t]||{data:[],count:0,total:e.total};if(r.data[e.n]=new Uint8Array(e.data),r.count++,this._chunkedData[t]=r,r.total===r.count){delete this._chunkedData[t];const n=Al(r.data);this._handleDataMessage({data:n})}}_send(e,t){const r=Bi(e);if(r instanceof Promise)return this._send_blob(r);if(!t&&r.byteLength>this.chunker.chunkedMTU){this._sendChunks(r);return}this._bufferedSend(r)}async _send_blob(e){const t=await e;if(t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}_sendChunks(e){const t=this.chunker.chunk(e);U.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(const r of t)this.send(r,!0)}}class ql extends Jr{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,t){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=xt.None}}class Vl extends Jr{_handleDataMessage({data:e}){const t=this.parse(this.decoder.decode(e)),r=t.__peerData;if(r&&r.type==="close"){this.close();return}this.emit("data",t)}_send(e,t){const r=this.encoder.encode(this.stringify(e));if(r.byteLength>=Fe.chunkedMTU){this.emitError(zt.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(r)}constructor(...e){super(...e),this.serialization=xt.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class Qr extends _o{static#e=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[t,r]of this._connections)e[t]=r;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,t){super(),this._serializers={raw:ql,json:Vl,binary:yr,"binary-utf8":yr,default:yr},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let r;if(e&&e.constructor==Object?t=e:e&&(r=e.toString()),t={debug:0,host:Fe.CLOUD_HOST,port:Fe.CLOUD_PORT,path:"/",key:Qr.DEFAULT_KEY,token:Fe.randomToken(),config:Fe.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...t},this._options=t,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Fe.CLOUD_HOST?this._options.secure=Fe.isSecure():this._options.host==Fe.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&U.setLogFunction(this._options.logFunction),U.logLevel=this._options.debug||0,this._api=new Bl(t),this._socket=this._createServerConnection(),!Fe.supports.audioVideo&&!Fe.supports.data){this._delayedAbort(ye.BrowserIncompatible,"The current browser does not support WebRTC");return}if(r&&!Fe.validateId(r)){this._delayedAbort(ye.InvalidID,`ID "${r}" is invalid`);return}r?this._initialize(r):this._api.retrieveId().then(n=>this._initialize(n)).catch(n=>this._abort(ye.ServerError,n))}_createServerConnection(){const e=new jl(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(Ze.Message,t=>{this._handleMessage(t)}),e.on(Ze.Error,t=>{this._abort(ye.SocketError,t)}),e.on(Ze.Disconnected,()=>{this.disconnected||(this.emitError(ye.Network,"Lost connection to server."),this.disconnect())}),e.on(Ze.Close,()=>{this.disconnected||this._abort(ye.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const t=e.type,r=e.payload,n=e.src;switch(t){case Ce.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case Ce.Error:this._abort(ye.ServerError,r.msg);break;case Ce.IdTaken:this._abort(ye.UnavailableID,`ID "${this.id}" is taken`);break;case Ce.InvalidKey:this._abort(ye.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case Ce.Leave:U.log(`Received leave message from ${n}`),this._cleanupPeer(n),this._connections.delete(n);break;case Ce.Expire:this.emitError(ye.PeerUnavailable,`Could not connect to peer ${n}`);break;case Ce.Offer:{const o=r.connectionId;let a=this.getConnection(n,o);if(a&&(a.close(),U.warn(`Offer received for existing Connection ID:${o}`)),r.type===Je.Media){const u=new rr(n,this,{connectionId:o,_payload:r,metadata:r.metadata});a=u,this._addConnection(n,a),this.emit("call",u)}else if(r.type===Je.Data){const u=new this._serializers[r.serialization](n,this,{connectionId:o,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable});a=u,this._addConnection(n,a),this.emit("connection",u)}else{U.warn(`Received malformed connection type:${r.type}`);return}const s=this._getMessages(o);for(const u of s)a.handleMessage(u);break}default:{if(!r){U.warn(`You received a malformed message from ${n} of type ${t}`);return}const o=r.connectionId,a=this.getConnection(n,o);a&&a.peerConnection?a.handleMessage(e):o?this._storeMessage(o,e):U.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)}_getMessages(e){const t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]}connect(e,t={}){if(t={serialization:"default",...t},this.disconnected){U.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(ye.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const r=new this._serializers[t.serialization](e,this,t);return this._addConnection(e,r),r}call(e,t,r={}){if(this.disconnected){U.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(ye.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!t){U.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const n=new rr(e,this,{...r,_stream:t});return this._addConnection(e,n),n}_addConnection(e,t){U.log(`add connection ${t.type}:${t.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)}_removeConnection(e){const t=this._connections.get(e.peer);if(t){const r=t.indexOf(e);r!==-1&&t.splice(r,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,t){const r=this._connections.get(e);if(!r)return null;for(const n of r)if(n.connectionId===t)return n;return null}_delayedAbort(e,t){setTimeout(()=>{this._abort(e,t)},0)}_abort(e,t){U.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(U.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const t=this._connections.get(e);if(t)for(const r of t)r.close()}disconnect(){if(this.disconnected)return;const e=this.id;U.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)U.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)U.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=t=>{}){this._api.listAllPeers().then(t=>e(t)).catch(t=>this._abort(ye.ServerError,t))}}var jn=Qr,br={exports:{}},vr={exports:{}},Un;function Gl(){return Un||(Un=1,function(){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(t,r){return t<<r|t>>>32-r},rotr:function(t,r){return t<<32-r|t>>>r},endian:function(t){if(t.constructor==Number)return e.rotl(t,8)&16711935|e.rotl(t,24)&4278255360;for(var r=0;r<t.length;r++)t[r]=e.endian(t[r]);return t},randomBytes:function(t){for(var r=[];t>0;t--)r.push(Math.floor(Math.random()*256));return r},bytesToWords:function(t){for(var r=[],n=0,o=0;n<t.length;n++,o+=8)r[o>>>5]|=t[n]<<24-o%32;return r},wordsToBytes:function(t){for(var r=[],n=0;n<t.length*32;n+=8)r.push(t[n>>>5]>>>24-n%32&255);return r},bytesToHex:function(t){for(var r=[],n=0;n<t.length;n++)r.push((t[n]>>>4).toString(16)),r.push((t[n]&15).toString(16));return r.join("")},hexToBytes:function(t){for(var r=[],n=0;n<t.length;n+=2)r.push(parseInt(t.substr(n,2),16));return r},bytesToBase64:function(t){for(var r=[],n=0;n<t.length;n+=3)for(var o=t[n]<<16|t[n+1]<<8|t[n+2],a=0;a<4;a++)n*8+a*6<=t.length*8?r.push(i.charAt(o>>>6*(3-a)&63)):r.push("=");return r.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/ig,"");for(var r=[],n=0,o=0;n<t.length;o=++n%4)o!=0&&r.push((i.indexOf(t.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<o*2|i.indexOf(t.charAt(n))>>>6-o*2);return r}};vr.exports=e}()),vr.exports}var kr,Bn;function qn(){if(Bn)return kr;Bn=1;var i={utf8:{stringToBytes:function(e){return i.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(i.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e.charCodeAt(r)&255);return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};return kr=i,kr}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var wr,Vn;function Wl(){if(Vn)return wr;Vn=1,wr=function(t){return t!=null&&(i(t)||e(t)||!!t._isBuffer)};function i(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function e(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&i(t.slice(0,0))}return wr}var Gn;function Hl(){return Gn||(Gn=1,function(){var i=Gl(),e=qn().utf8,t=Wl(),r=qn().bin,n=function(o,a){o.constructor==String?a&&a.encoding==="binary"?o=r.stringToBytes(o):o=e.stringToBytes(o):t(o)?o=Array.prototype.slice.call(o,0):!Array.isArray(o)&&o.constructor!==Uint8Array&&(o=o.toString());for(var s=i.bytesToWords(o),u=o.length*8,l=1732584193,c=-271733879,d=-1732584194,h=271733878,p=0;p<s.length;p++)s[p]=(s[p]<<8|s[p]>>>24)&16711935|(s[p]<<24|s[p]>>>8)&4278255360;s[u>>>5]|=128<<u%32,s[(u+64>>>9<<4)+14]=u;for(var g=n._ff,f=n._gg,y=n._hh,b=n._ii,p=0;p<s.length;p+=16){var m=l,k=c,v=d,w=h;l=g(l,c,d,h,s[p+0],7,-680876936),h=g(h,l,c,d,s[p+1],12,-389564586),d=g(d,h,l,c,s[p+2],17,606105819),c=g(c,d,h,l,s[p+3],22,-1044525330),l=g(l,c,d,h,s[p+4],7,-176418897),h=g(h,l,c,d,s[p+5],12,1200080426),d=g(d,h,l,c,s[p+6],17,-1473231341),c=g(c,d,h,l,s[p+7],22,-45705983),l=g(l,c,d,h,s[p+8],7,1770035416),h=g(h,l,c,d,s[p+9],12,-1958414417),d=g(d,h,l,c,s[p+10],17,-42063),c=g(c,d,h,l,s[p+11],22,-1990404162),l=g(l,c,d,h,s[p+12],7,1804603682),h=g(h,l,c,d,s[p+13],12,-40341101),d=g(d,h,l,c,s[p+14],17,-1502002290),c=g(c,d,h,l,s[p+15],22,1236535329),l=f(l,c,d,h,s[p+1],5,-165796510),h=f(h,l,c,d,s[p+6],9,-1069501632),d=f(d,h,l,c,s[p+11],14,643717713),c=f(c,d,h,l,s[p+0],20,-373897302),l=f(l,c,d,h,s[p+5],5,-701558691),h=f(h,l,c,d,s[p+10],9,38016083),d=f(d,h,l,c,s[p+15],14,-660478335),c=f(c,d,h,l,s[p+4],20,-405537848),l=f(l,c,d,h,s[p+9],5,568446438),h=f(h,l,c,d,s[p+14],9,-1019803690),d=f(d,h,l,c,s[p+3],14,-187363961),c=f(c,d,h,l,s[p+8],20,1163531501),l=f(l,c,d,h,s[p+13],5,-1444681467),h=f(h,l,c,d,s[p+2],9,-51403784),d=f(d,h,l,c,s[p+7],14,1735328473),c=f(c,d,h,l,s[p+12],20,-1926607734),l=y(l,c,d,h,s[p+5],4,-378558),h=y(h,l,c,d,s[p+8],11,-2022574463),d=y(d,h,l,c,s[p+11],16,1839030562),c=y(c,d,h,l,s[p+14],23,-35309556),l=y(l,c,d,h,s[p+1],4,-1530992060),h=y(h,l,c,d,s[p+4],11,1272893353),d=y(d,h,l,c,s[p+7],16,-155497632),c=y(c,d,h,l,s[p+10],23,-1094730640),l=y(l,c,d,h,s[p+13],4,681279174),h=y(h,l,c,d,s[p+0],11,-358537222),d=y(d,h,l,c,s[p+3],16,-722521979),c=y(c,d,h,l,s[p+6],23,76029189),l=y(l,c,d,h,s[p+9],4,-640364487),h=y(h,l,c,d,s[p+12],11,-421815835),d=y(d,h,l,c,s[p+15],16,530742520),c=y(c,d,h,l,s[p+2],23,-995338651),l=b(l,c,d,h,s[p+0],6,-198630844),h=b(h,l,c,d,s[p+7],10,1126891415),d=b(d,h,l,c,s[p+14],15,-1416354905),c=b(c,d,h,l,s[p+5],21,-57434055),l=b(l,c,d,h,s[p+12],6,1700485571),h=b(h,l,c,d,s[p+3],10,-1894986606),d=b(d,h,l,c,s[p+10],15,-1051523),c=b(c,d,h,l,s[p+1],21,-2054922799),l=b(l,c,d,h,s[p+8],6,1873313359),h=b(h,l,c,d,s[p+15],10,-30611744),d=b(d,h,l,c,s[p+6],15,-1560198380),c=b(c,d,h,l,s[p+13],21,1309151649),l=b(l,c,d,h,s[p+4],6,-145523070),h=b(h,l,c,d,s[p+11],10,-1120210379),d=b(d,h,l,c,s[p+2],15,718787259),c=b(c,d,h,l,s[p+9],21,-343485551),l=l+m>>>0,c=c+k>>>0,d=d+v>>>0,h=h+w>>>0}return i.endian([l,c,d,h])};n._ff=function(o,a,s,u,l,c,d){var h=o+(a&s|~a&u)+(l>>>0)+d;return(h<<c|h>>>32-c)+a},n._gg=function(o,a,s,u,l,c,d){var h=o+(a&u|s&~u)+(l>>>0)+d;return(h<<c|h>>>32-c)+a},n._hh=function(o,a,s,u,l,c,d){var h=o+(a^s^u)+(l>>>0)+d;return(h<<c|h>>>32-c)+a},n._ii=function(o,a,s,u,l,c,d){var h=o+(s^(a|~u))+(l>>>0)+d;return(h<<c|h>>>32-c)+a},n._blocksize=16,n._digestsize=16,br.exports=function(o,a){if(o==null)throw new Error("Illegal argument "+o);var s=i.wordsToBytes(n(o,a));return a&&a.asBytes?s:a&&a.asString?r.bytesToString(s):i.bytesToHex(s)}}()),br.exports}var Yl=Hl();const Xl=Br(Yl),Kl="7ae48d46-10f2-kitty-";function Zl(){let i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",e="";for(let t=0;t<6;++t){let r=Math.floor(Math.random()*i.length);e+=i.substring(r,r+1)}return e}function Wn(i){return Xl(Kl+i)}var Jl=q("<button class=btn>Copy"),Ql=q('<div class="toast toast-center toast-middle">'),ec=q('<div><div><div class=pb-2><label><div style=display:inline-block;padding-right:5px;>Nickname:</div><input type=text class=input></label></div></div><div><button class="btn btn-outline btn-primary ml-1">Invite</button><button class="btn btn-outline btn-primary ml-1">Join</button></div><div><div>Connections:<table class="table table-zebra"><thead><tr><th></th><th>Nickname</th><th></th></tr></thead><tbody></tbody></table></div><div>Pending Invites:<table class="table table-zebra"><thead><tr><th></th><th>Invite Code</th><th></th></tr></thead><tbody></tbody></table></div></div><dialog class=modal><div class=modal-box>Invite Code:<input type=text class="input ml-2"><button class="btn btn-primary">Paste</button><div class=modal-action><button class="btn btn-primary">OK</button><form method=dialog><button class=btn>Close'),tc=q('<tr><td></td><td></td><td><button class="btn btn-primary">Kick'),rc=q('<tr><td></td><td></td><td><button class="btn btn-primary">Copy</button><button class="btn btn-primary ml-1">Delete'),nc=q('<div class="alert alert-info">');function ic(i){let[e,t]=_e({nickname:kl.generateUsername("_"),connections:[],pendingInvites:[],toastStack:[],joinDialogInviteCode:""}),[r,n]=K(),o=S(()=>e.connections.map(h=>h.value)),a=h=>{let p={};t("toastStack",Et(f=>f.push(new Ut({id:p,Render:h}))));let g=setTimeout(()=>{t("toastStack",e.toastStack.filter(f=>f.value.id!==p)),clearTimeout(g)},5e3)},s=()=>{let[h,p]=K(!1),g=Zl(),f=Wn(g),y=new jn(f),b={inviteCode:g,peer:y};y.on("open",()=>{y.on("connection",m=>{m.once("data",k=>{typeof k=="string"&&(t("connections",Et(v=>v.push(new Ut({nickname:k,peer:y,conn:m})))),m.send({nickname:e.nickname,documentUrl:i.documentUrl()??null}),t("pendingInvites",e.pendingInvites.filter(v=>v.value!=b)))}),m.once("close",()=>{t("connections",e.connections.filter(k=>k.value.peer!==y))})}),t("pendingInvites",Et(m=>m.push(new Ut(b)))),a(()=>["Invite Code: ",g,(()=>{var m=Jl();return m.$$click=async()=>{await navigator.clipboard.writeText(g),p(!0);let k=setTimeout(()=>{clearTimeout(k),p(!1)},1e3)},m})(),I(ae,{get when(){return h()},children:"Copied"})])})},u=()=>{t("joinDialogInviteCode",""),r()?.showModal()},l=()=>{r()?.close();let h=e.joinDialogInviteCode;t("joinDialogInviteCode","");let p=Wn(h),g=new jn;g.on("open",()=>{let f=g.connect(p);f.on("open",()=>{f.once("data",y=>{let b=y.nickname,m=y.documentUrl;typeof b=="string"&&typeof m=="string"&&(i.setDocumentUrl(m),t("connections",Et(k=>k.push(new Ut({nickname:b,peer:g,conn:f})))))}),f.send(e.nickname),f.once("close",()=>{t("connections",e.connections.filter(y=>y.value.peer!==g))})})})},c=h=>{h.peer.destroy()};return{connections:o,Render:()=>(()=>{var h=ec(),p=h.firstChild,g=p.firstChild,f=g.firstChild,y=f.firstChild,b=y.nextSibling,m=p.nextSibling,k=m.firstChild,v=k.nextSibling,w=m.nextSibling,x=w.firstChild,P=x.firstChild,C=P.nextSibling,T=C.firstChild,M=T.nextSibling,_=x.nextSibling,E=_.firstChild,O=E.nextSibling,F=O.firstChild,R=F.nextSibling,z=w.nextSibling,W=z.firstChild,V=W.firstChild,L=V.nextSibling,Y=L.nextSibling,re=Y.nextSibling,N=re.firstChild;h.style.setProperty("width","100%"),h.style.setProperty("height","100%"),h.style.setProperty("display","flex"),h.style.setProperty("flex-direction","column"),h.style.setProperty("padding","10px"),h.style.setProperty("position","relative"),b.$$input=ne=>{t("nickname",ne.currentTarget.validationMessage)},k.$$click=()=>s(),v.$$click=()=>u(),w.style.setProperty("flex-grow","1"),w.style.setProperty("display","flex"),w.style.setProperty("flex-direction","column"),w.style.setProperty("margin-top","10px"),x.style.setProperty("flex-grow","1"),x.style.setProperty("overflow-y","auto"),H(M,I(Xe,{get each(){return e.connections},children:ne=>(()=>{var we=tc(),fe=we.firstChild,oe=fe.nextSibling,Te=oe.nextSibling,Oe=Te.firstChild;return H(oe,()=>ne.value.nickname),Oe.$$click=()=>{c(ne.value)},we})()})),_.style.setProperty("flex-grow","1"),_.style.setProperty("overflow-y","auto"),H(R,I(Xe,{get each(){return e.pendingInvites},children:ne=>{let[we,fe]=K(!1);return(()=>{var oe=rc(),Te=oe.firstChild,Oe=Te.nextSibling,Ge=Oe.nextSibling,We=Ge.firstChild,vt=We.nextSibling;return H(Oe,()=>ne.value.inviteCode),We.$$click=async()=>{await navigator.clipboard.writeText(ne.value.inviteCode),fe(!0);let qe=setTimeout(()=>{clearTimeout(qe),fe(!1)},1e3)},vt.$$click=()=>{ne.value.peer.destroy(),t("pendingInvites",e.pendingInvites.filter(qe=>qe.value!==ne.value))},H(Ge,I(ae,{get when(){return we()},children:"Copied"}),null),oe})()}})),H(h,I(ae,{get when(){return e.toastStack.length!=0},get children(){var ne=Ql();return H(ne,I(Xe,{get each(){return e.toastStack},children:we=>(()=>{var fe=nc();return H(fe,I(we.value.Render,{})),fe})()})),ne}}),z);var J=n;return typeof J=="function"?ge(J,z):n=z,L.addEventListener("change",()=>{l()}),L.$$input=ne=>{t("joinDialogInviteCode",ne.currentTarget.value)},Y.$$click=async()=>{let ne=await navigator.clipboard.readText();t("joinDialogInviteCode",ne)},N.$$click=()=>l(),Q(()=>b.value=e.nickname),Q(()=>L.value=e.joinDialogInviteCode),h})()}}ke(["click","input"]);class oc extends gl{#e=!1;#n;connection;#r=!1;#i;#a=new Promise(e=>{this.#i=e});#t=[];isReady(){return this.#r}whenReady(){return this.#a}#s(){this.#r||(this.#r=!0,this.#i?.())}constructor(e){super(),this.#n=e,this.connection=e.connection}connect(e,t){this.peerId=e,this.peerMetadata=t,this.#e=!1,this.connection.on("data",r=>{if(typeof r!="string")return;const n=JSON.parse(r);if(console.log("message in, ",n),"targetId"in n&&n.targetId!==this.peerId||this.#e)return;const{senderId:o,type:a}=n;switch(a){case"arrive":{const{peerMetadata:s}=n;this.connection.send(JSON.stringify({senderId:this.peerId,targetId:o,type:"welcome",peerMetadata:this.peerMetadata})),this.#o(o,s)}break;case"welcome":{const{peerMetadata:s}=n;this.#o(o,s)}break;case"leave":this.#t=this.#t.filter(s=>s!==o),this.emit("peer-disconnected",{peerId:o});break;default:if(!("data"in n))this.emit("message",n);else{if(!n.data)throw new Error("We got a message without data, we can't send this.");const s=n.data;this.emit("message",{...n,data:new Uint8Array(s)})}break}}),this.connection.send(JSON.stringify({senderId:this.peerId,type:"arrive",peerMetadata:t}))}#o(e,t){this.#s(),this.#t.push(e),this.emit("peer-candidate",{peerId:e,peerMetadata:t})}send(e){if(this.#e)return!1;if("data"in e){let t=e.data?e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength):void 0,r=t==null?void 0:Array.from(new Uint8Array(t));this.connection.send(JSON.stringify({...e,data:r}))}else this.connection.send(JSON.stringify(e))}disconnect(){this.connection.send(JSON.stringify({senderId:this.peerId,type:"leave"}));for(const e of this.#t)this.emit("peer-disconnected",{peerId:e});this.#e=!0}}const ac=261.63,Hn=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}];class sc{audioContext=void 0;pianoNodes=[];constructor(){}async init(){if(this.audioContext){this.audioContext.state==="suspended"?await this.audioContext.resume():this.audioContext.state==="running"&&await this.audioContext.suspend();return}this.audioContext=new AudioContext,await this.audioContext.audioWorklet.addModule(Fr),await this.audioContext.audioWorklet.addModule($o),await this.audioContext.audioWorklet.addModule(Io),await this.audioContext.audioWorklet.addModule(Eo);let e=this.audioContext.createGain();e.gain.value=.1,e.connect(this.audioContext.destination),this.pianoNodes=[];for(let t=0;t<12;++t){let r=new AudioWorkletNode(this.audioContext,"piano-processor");r.connect(e),this.pianoNodes.push(r)}}async noteOn(e){if(this.audioContext==null){await this.init();return}this.audioContext.state==="suspended"&&await this.audioContext.resume();let t=Hn.findIndex(n=>n.name==e);if(t==-1)return;let r=ac*Math.pow(2,t/12);this.pianoNodes[t].port.postMessage({type:"noteOn",frequency:r})}async noteOff(e){this.audioContext==null&&await this.init();let t=Hn.findIndex(r=>r.name==e);t!=-1&&this.pianoNodes[t].port.postMessage({type:"noteOff"})}play(){this.init()}}const lc=`
class SineProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = Math.sin(this.phase); // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('sine-processor', SineProcessor);
`,cc=new Blob([lc],{type:"application/javascript"}),Fr=URL.createObjectURL(cc),uc=`
class SawProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = this.phase; // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('saw-processor', SawProcessor);
`,dc=new Blob([uc],{type:"application/javascript"}),$o=URL.createObjectURL(dc),pc=`
class SquareProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.phase = 0;
    this.frequency = 300; // Hz
  }

  process(inputs, outputs, parameters) {
    const output = outputs[0]; // Get the first output channel
    const outputChannel = output[0]; // Get the first channel (mono)

    // Generate sine wave samples
    for (let i = 0; i < outputChannel.length; i++) {
      // Calculate the phase increment based on frequency and sample rate
      // sampleRate is a global variable available in AudioWorkletGlobalScope
      this.phase += (2 * Math.PI * this.frequency) / sampleRate;
      outputChannel[i] = (this.phase < Math.PI ? 0 : 1); // Generate sine wave sample
    }

    // Keep phase within [0, 2*PI] to prevent it from growing indefinitely
    this.phase %= (2 * Math.PI);

    return true; // Keep the processor alive
  }
}

registerProcessor('square-processor', SquareProcessor);
`,hc=new Blob([pc],{type:"application/javascript"}),Io=URL.createObjectURL(hc),fc=`
class PianoProcessor extends AudioWorkletProcessor {
    constructor() {
        super();
        this.phase = 0;
        this.sampleRate = sampleRate; // Global sampleRate from AudioWorkletGlobalScope

        // Define harmonics (fundamental + a few overtones) and their relative gains
        // These values are simplified and can be tweaked for different piano sounds
        this.harmonics = [
            { freqMultiplier: 1, gain: 1.0 },   // Fundamental
            { freqMultiplier: 2, gain: 0.6 },   // 1st overtone (octave)
            { freqMultiplier: 3, gain: 0.4 },   // 2nd overtone (fifth above octave)
            { freqMultiplier: 4, gain: 0.3 },   // 3rd overtone (two octaves)
            { freqMultiplier: 5, gain: 0.2 },   // 4th overtone (major third)
        ];

        // ADSR envelope parameters (simplified)
        this.attackTime = 0.01; // Very fast attack
        this.decayTime = 0.1;
        this.sustainLevel = 0.6;
        this.releaseTime = 0.8;

        this.envelopePhase = 0; // 0: idle, 1: attack, 2: decay, 3: sustain, 4: release
        this.currentGain = 0;
        this.noteOnTime = 0;
        this.noteOffTime = 0;
        this.frequency = 0; // Will be set via port.onmessage

        this.port.onmessage = (event) => {
            if (event.data.type === 'noteOn') {
                this.frequency = event.data.frequency;
                this.noteOnTime = currentTime; // Global currentTime from AudioWorkletGlobalScope
                this.envelopePhase = 1; // Start attack
                this.phase = 0; // Reset phase for new note
            } else if (event.data.type === 'noteOff') {
                this.noteOffTime = currentTime;
                this.envelopePhase = 4; // Start release
            }
        };
    }

    process(inputs, outputs, parameters) {
        const output = outputs[0]; // Assuming mono output for simplicity
        const channel = output[0]; // Get the first channel

        for (let i = 0; i < channel.length; ++i) {
            let sample = 0;

            // Update envelope
            if (this.envelopePhase === 1) { // Attack
                const timeElapsed = currentTime - this.noteOnTime;
                if (timeElapsed < this.attackTime) {
                    this.currentGain = timeElapsed / this.attackTime;
                } else {
                    this.currentGain = 1.0;
                    this.envelopePhase = 2; // Move to decay
                    this.decayStartTime = currentTime;
                }
            } else if (this.envelopePhase === 2) { // Decay
                const timeElapsed = currentTime - this.decayStartTime;
                if (timeElapsed < this.decayTime) {
                    this.currentGain = 1.0 - (1.0 - this.sustainLevel) * (timeElapsed / this.decayTime);
                } else {
                    this.currentGain = this.sustainLevel;
                    this.envelopePhase = 3; // Move to sustain
                }
            } else if (this.envelopePhase === 3) { // Sustain (maintain currentGain)
                // Nothing to do, just hold the sustain level
            } else if (this.envelopePhase === 4) { // Release
                const timeElapsed = currentTime - this.noteOffTime;
                if (timeElapsed < this.releaseTime) {
                    this.currentGain = this.sustainLevel * (1.0 - (timeElapsed / this.releaseTime));
                } else {
                    this.currentGain = 0;
                    this.envelopePhase = 0; // Go to idle
                    this.frequency = 0; // Stop generating sound
                }
            }

            // Generate sound if frequency and gain are active
            if (this.frequency > 0 && this.currentGain > 0.001) { // Threshold to prevent silence from generating
                for (const harmonic of this.harmonics) {
                    const freq = this.frequency * harmonic.freqMultiplier;
                    sample += Math.sin(this.phase * freq * 2 * Math.PI) * harmonic.gain;
                }
                sample *= this.currentGain; // Apply envelope gain
            } else {
                sample = 0; // No sound
            }

            channel[i] = sample;

            // Advance phase for the next sample
            this.phase += 1 / this.sampleRate;
            if (this.phase >= 1) {
                this.phase -= 1; // Keep phase within [0, 1)
            }
        }

        // Return false when the sound is completely silent to allow garbage collection
        //return this.envelopePhase !== 0 || this.currentGain > 0.001;
        return true;
    }
}

registerProcessor('piano-processor', PianoProcessor);`,mc=new Blob([fc],{type:"application/javascript"}),Eo=URL.createObjectURL(mc);window.addEventListener("beforeunload",()=>{Fr&&(URL.revokeObjectURL(Fr),URL.revokeObjectURL($o),URL.revokeObjectURL(Io),URL.revokeObjectURL(Eo))});var gc=q("<div class=piano>"),yc=q("<div class=white-key>"),bc=q("<div class=black-key>");const vc=i=>{const e=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}],t=150,r=80;let n,o=new ht,a=new Ke;return(()=>{var s=gc();s.$$pointermove=l=>{if(!o.get(l.pointerId))return;let c=n.getBoundingClientRect();o.set(l.pointerId,$r.create(l.clientX-c.left,l.clientY-c.top))},s.addEventListener("pointercancel",l=>{o.delete(l.pointerId),n.releasePointerCapture(l.pointerId)}),s.$$pointerup=l=>{o.delete(l.pointerId),n.releasePointerCapture(l.pointerId)},s.$$pointerdown=l=>{let c=n.getBoundingClientRect();o.set(l.pointerId,$r.create(l.clientX-c.left,l.clientY-c.top)),n.setPointerCapture(l.pointerId)};var u=n;return typeof u=="function"?ge(u,s):n=s,s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","row"),s.style.setProperty("overflow-x","auto"),s.style.setProperty("user-select","none"),s.style.setProperty("touch-action","none"),H(s,I(Xe,{each:e,children:l=>{let[c,d]=K();l.type=="black"&&le(()=>{let p=c();p!=null&&(a.add(p),be(()=>a.delete(p)))});let h=S(()=>{let p=c();if(p==null)return!1;let g=n.getBoundingClientRect(),f=p.getBoundingClientRect();for(let y of o.values()){let b=g.left+y.x-f.left,m=g.top+y.y-f.top;if(0<b&&b<f.width&&0<m&&m<f.height){if(l.type=="white")for(let k of a){let v=k.getBoundingClientRect(),w=g.left+y.x-v.left,x=g.top+y.y-v.top;if(0<w&&w<v.width&&0<x&&x<v.height)return!1}return!0}}return!1});return le(ie(h,p=>{p?i.onNoteOn(l.name):i.onNoteOff(l.name)},{defer:!0})),I(Gr,{get children(){return[I(ft,{get when(){return l.type=="white"},get children(){var p=yc(),g=d;return typeof g=="function"?ge(g,p):d=p,p.style.setProperty("width","50px"),p.style.setProperty("pointer-events","none"),Q(f=>{var y=!!h(),b=`${t+(h()?2:0)}px`;return y!==f.e&&p.classList.toggle("pressed",f.e=y),b!==f.t&&((f.t=b)!=null?p.style.setProperty("height",b):p.style.removeProperty("height")),f},{e:void 0,t:void 0}),p}}),I(ft,{get when(){return l.type=="black"},get children(){var p=bc(),g=d;return typeof g=="function"?ge(g,p):d=p,p.style.setProperty("margin-left","-16px"),p.style.setProperty("margin-right","-14px"),p.style.setProperty("width","30px"),p.style.setProperty("pointer-events","none"),Q(f=>{var y=!!h(),b=`${r+(h()?2:0)}px`;return y!==f.e&&p.classList.toggle("pressed",f.e=y),b!==f.t&&((f.t=b)!=null?p.style.setProperty("height",b):p.style.removeProperty("height")),f},{e:void 0,t:void 0}),p}})]}})}})),s})()};ke(["pointerdown","pointerup","pointermove"]);function D(i){return{type:"MaybeUndefined",element:i}}function kc(){return{type:"Boolean"}}function Be(){return{type:"Number"}}function Qe(){return{type:"String"}}function G(i){return{type:"Object",properties:i}}function ee(i){return{type:"Array",element:i}}function en(i,e,t){return{type:"Invarant",fromFn:i,toFn:e,inner:t}}function Ro(i,e){return{type:"Default",value:i,inner:e}}function Re(i,e){switch(i.type){case"Boolean":return typeof e!="boolean"?Ue("Expected a boolean."):pe(e);case"Number":return typeof e!="number"?Ue("Expected a number."):pe(e);case"String":return typeof e!="string"?Ue("Expected a string."):pe(e);case"MaybeUndefined":return e==null?pe(void 0):Re(i.element,e);case"MaybeNull":return e==null?pe(null):Re(i.element,e);case"Union":{let t=e[i.selector];if(typeof t!="string")return Ue("Missing type param for union.");let r={...e};delete r[i.selector];let n=G(i.parts[t]),o=Re(n,r);if(o.type=="Err")return Ue(`Problem parsing union part ${t}: ${o.message}`);let s={...o.value};return s[i.selector]=t,pe(s)}case"Array":{let t=[];for(let r of e){let n=Re(i.element,r);if(n.type=="Err")return n;t.push(n.value)}return pe(t)}case"Object":{let t={};for(let r of Object.keys(i.properties)){let n=i.properties[r];Object.hasOwn(e,r)||(t[r]=Le(n));let o=Re(i.properties[r],e[r]);if(o.type=="Err")return Ue(`Problem parsing field ${r}: ${o.message}`);t[r]=o.value}return pe(t)}case"Recursive":{let t=i.inner();return Re(t,e)}case"Invarant":{let t=i.fromFn,r=Re(i.inner,e);return r.type=="Err"?r:pe(t(r.value))}case"Default":{let t=i.inner,r;try{r=Re(t,e)}catch(n){r=Ue(""+n)}return r.type=="Err"?pe(i.value):pe(r.value)}case"Json":return pe(e)}}function Le(i){switch(i.type){case"Boolean":return!1;case"Number":return 0;case"String":return"";case"MaybeUndefined":return;case"MaybeNull":return null;case"Union":{let e=Object.keys(i.parts)[0],t=Le(G(i.parts[e]));return t[i.selector]=e,t}case"Array":return[];case"Object":{let e={};for(let t of Object.keys(i.properties)){let r=i.properties[t];e[t]=Le(r)}return e}case"Recursive":{let e=i.inner();return Le(e)}case"Invarant":{let e=i.fromFn,t=Le(i.inner);return e(t)}case"Default":return i.value;case"Json":return null}}function De(i,e){switch(i.type){case"Boolean":return e;case"Number":return e;case"String":return e;case"MaybeUndefined":return e==null?null:De(i.element,e);case"MaybeNull":return e==null?null:De(i.element,e);case"Union":{let t=e[i.selector],r={...e};delete r[i.selector];let n=De(G(i.parts[t]),r);return n[i.selector]=t,n}case"Object":{let t={};for(let r of Object.keys(i.properties))t[r]=De(i.properties[r],e[r]);return t}case"Array":return e.map(t=>De(i.element,t));case"Recursive":{let t=i.inner();return De(t,e)}case"Invarant":{let t=i.toFn,r=t(e);return De(i.inner,r)}case"Default":return De(i.inner,e);case"Json":return e}}function tn(i,e,t){if(typeof i!="object"||i.type!="Object")return Ue("Only projections of objects are supported");let r={};for(let[n,o]of Object.entries(i.properties)){let a=o;Object.defineProperty(r,n,{get(){let s=e?.[n];if(typeof o=="object"){if(o.type=="Object"){let l=tn(a,s,c=>t(d=>c(d[n])));if(l.type=="Err")throw new Error("Unreachable");return l.value}if(o.type=="Array"){let l=Mo(a,s,c=>t(d=>{c(d[n])}));if(l.type=="Err")throw new Error("Unreachable");return l.value}}let u=Re(a,s);return u.type=="Err"?Le(a):u.value},set(s){let u=De(a,s);JSON.stringify(e[n])!=JSON.stringify(u)&&t(l=>l[n]=u)}})}return pe(r)}function Mo(i,e,t){if(typeof i!="object"||i.type!="Array")return Ue("Expected an array for projection");let r=i.element,n=[],o=new Proxy(n,{get(a,s,u){if(s=="length")return n.length=e.length,e.length;if(typeof s=="string"&&!Number.isNaN(Number.parseInt(s))){let l=Number.parseInt(s),c=e?.[l];if(typeof r=="object"){if(r.type=="Object"){let h=tn(r,c,p=>t(g=>{p(g[l])}));if(h.type=="Err")throw new Error("Unreachable");return h.value}if(r.type=="Array"){let h=Mo(r,c,p=>t(g=>{p(g[s])}));if(h.type=="Err")throw new Error("Unreachable");return h.value}}let d=Re(r,c);return d.type=="Err"?Le(r):d.value}return Reflect.get(n,s,n)},set(a,s,u,l){if(typeof s=="string"&&!Number.isNaN(Number.parseInt(s))){let c=Number.parseInt(s),d=De(r,u);if(JSON.stringify(e[c])==JSON.stringify(u))return!1;t(h=>h[c]=d)}return Reflect.set(n,s,u,n)}});return pe(o)}function ir(i,e,t){if(typeof t!="object"||t.type!="Object")throw new Error("Expected object.");{let o=Yn.get(i);if(o!=null)return o}let r=t.properties,n=new Proxy({},{defineProperty(o,a,s){return Reflect.defineProperty(o,a,s)},deleteProperty(o,a){return Reflect.deleteProperty(o,a)},getOwnPropertyDescriptor(o,a){if(r[a]!=null){let s=Reflect.getOwnPropertyDescriptor(r,a);return s==null?void 0:(s={...s},s.value=n[a],s)}return Reflect.getOwnPropertyDescriptor(o,a)},getPrototypeOf(o){return Reflect.getPrototypeOf(o)},has(o,a){return r[a]!=null?!0:Reflect.has(o,a)},isExtensible(o){return Reflect.isExtensible(o)},ownKeys(o){return[...Reflect.ownKeys(r),...Reflect.ownKeys(o)]},preventExtensions(o){return Reflect.preventExtensions(o)},setPrototypeOf(o,a){return Reflect.setPrototypeOf(o,a)},get(o,a,s){if(typeof a=="symbol")return o[a];if(typeof a=="string"){let u=r[a];if(u!=null){if(u.type=="Object")return ir(i[a],c=>e(d=>c(d[a])),u);if(u.type=="Array")return Dr(i[a],c=>e(d=>c(d[a])),u);let l=Re(u,i[a]);return l.type=="Err"?Le(u):l.value}}return Reflect.get(o,a,s)},set(o,a,s,u){if(typeof a=="symbol")return o[a]=s,!0;if(typeof a=="string"){let l=r[a];if(l!=null){let c=De(l,s);return e(d=>d[a]=c),!0}}return Reflect.set(o,a,s,u)}});return Yn.set(i,n),n}function Dr(i,e,t){if(typeof t!="object"||t.type!="Array")throw new Error("Expected object.");{let a=Xn.get(i);if(a!=null)return a}let r=t.element,n=function*(){for(let a=0;a<i.length;++a)yield o[a]},o=new Proxy([void 0],{defineProperty(a,s,u){return Reflect.defineProperty(a,s,u)},deleteProperty(a,s){return Reflect.deleteProperty(a,s)},getOwnPropertyDescriptor(a,s){let u=typeof s=="string"?Number.parseInt(s):void 0;if(Number.isNaN(u)&&(u=void 0),u!=null){let c=Reflect.getOwnPropertyDescriptor(a,0);return c==null?void 0:(c={...c},c.value=o[s],c)}let l=Reflect.getOwnPropertyDescriptor(a,s);if(l!=null)return s==="length"&&(l={...l},l.value=i.length),l},getPrototypeOf(a){return Reflect.getPrototypeOf(a)},has(a,s){let u=typeof s=="string"?Number.parseInt(s):void 0;return Number.isNaN(u)&&(u=void 0),u!=null?0<=u&&u<i.length:Reflect.has(a,s)},isExtensible(a){return Reflect.isExtensible(a)},ownKeys(a){return[...Array(i.length).fill(void 0).map((s,u)=>u.toString()),...Reflect.ownKeys(a).filter(s=>s!="0")]},preventExtensions(a){return Reflect.preventExtensions(a)},setPrototypeOf(a,s){return Reflect.setPrototypeOf(a,s)},get(a,s,u){if(s==Symbol.iterator)return n;if(typeof s=="symbol")return a[s];if(s==="length")return i.length;if(s==="findIndex")return function(l,c){console.log("Intercepted findIndex call!");const d=[];for(let h=0;h<i.length;h++)if(r.type=="Object")d.push(ir(i[h],p=>e(g=>p(g[h])),r));else if(r.type=="Array")d.push(Dr(i[h],p=>e(g=>p(g[h])),r));else{let p=Re(r,i[h]);p.type=="Err"?d.push(Le(r)):d.push(p.value)}return Array.prototype.findIndex.call(d,l,c)};if(typeof s=="string"){let l=typeof s=="string"?Number.parseInt(s):void 0;if(Number.isNaN(l)&&(l=void 0),l!=null&&0<=l&&l<i.length){if(r.type=="Object")return ir(i[l],d=>e(h=>d(h[s])),r);if(r.type=="Array")return Dr(i[l],d=>e(h=>d(h[s])),r);let c=Re(r,i[l]);return c.type=="Err"?Le(r):c.value}}return Reflect.get(a,s,u)},set(a,s,u,l){if(typeof s=="symbol")return a[s]=u,!0;if(s==="length"){let d=u-i.length;if(d>0){let h=Array(d).fill(void 0).map(p=>Le(r));e(p=>p.push(...h))}else d<0&&e(h=>h.splice(i.length+d,-d));return!0}if(typeof s=="string"){let c=typeof s=="string"?Number.parseInt(s):void 0;if(Number.isNaN(c)&&(c=void 0),c!=null){let d=De(r,u);return e(h=>h[s]=d),!0}}return Reflect.set(a,s,u,l)}});return Xn.set(i,o),o}let Yn=new WeakMap,Xn=new WeakMap;class Z{typeName;typeSchema;constructor(e){this.typeName=e.typeName,this.typeSchema=e.typeSchema}create(e){let[t,r]=_e(e);return new Vt({type:this,state:t,setState:r})}createJsonProjectionV3(e,t){let r=ir(e,t,this.typeSchema),[n,o]=se(()=>_e(r));return pe(new Vt({type:this,state:r,setState:o}))}createJsonProjectionV2(e,t){let r=tn(this.typeSchema,e,t);if(r.type=="Err")return Ue(r.message);let n=r.value,[o,a]=se(()=>_e(n));return pe(new Vt({type:this,state:o,setState:a}))}createJsonProjection(e,t){let r=S(()=>Re(this.typeSchema,e())),n=S(()=>{let s=r();return s.type=="Err"?s:pe(r)},void 0,{equals:(s,u)=>s.type=="Ok"&&u.type=="Ok"?s.value==u.value:!1}),o=S(()=>{let s=n();return s.type=="Err"?s:pe(S(()=>s.value().value))}),a=S(()=>{let s=o();if(s.type=="Err")return s;let u=s.value;return pe(S(()=>{let[l,c]=_e(se(u));le(ie(u,h=>c(h),{defer:!0}));let d=S(()=>{let h=De(this.typeSchema,l);return{json:h,jsonString:JSON.stringify(h)}},void 0,{equals:(h,p)=>h.jsonString==p.jsonString});return le(ie(()=>d().json,h=>{t(h)},{defer:!0})),new Vt({type:this,state:l,setState:c})}))});return S(()=>{let s=a();return s.type=="Err"?s:pe(s.value())})}}class Vt{type;state;setState;constructor(e){this.type=e.type,this.state=e.state,this.setState=e.setState}}const wc=G({childIds:ee(Qe())}),Mt=new Z({typeName:"Children",typeSchema:wc}),xc=G({parentId:Qe()}),At=new Z({typeName:"Parent",typeSchema:xc}),Sc=G({orderIndex:Be()}),Pc=new Z({typeName:"SortOrderIndex",typeSchema:Sc});class rn{componentTypes;componentTypeMap;constructor(e){this.componentTypes=e,this.componentTypeMap=new Map(e.map(t=>[t.typeName,t]))}}const Ao=new rn([Mt,At,Pc]);class B{x;y;constructor(e,t){this.x=e,this.y=t}static create(e,t){return new B(e,t)}static zero=B.create(0,0);static unitX=B.create(1,0);static unitY=B.create(0,1);add(e){return B.create(this.x+e.x,this.y+e.y)}sub(e){return B.create(this.x-e.x,this.y-e.y)}multScalar(e){return B.create(this.x*e,this.y*e)}cross(e){return this.x*e.y-this.y*e.x}distanceSquared(e){let t=e.x-this.x,r=e.y-this.y;return t*t+r*r}distance(e){return Math.sqrt(this.distanceSquared(e))}lengthSquared(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.lengthSquared())}normalize(){return this.multScalar(1/this.length())}}class he{x;y;static rot0=new he(1,0);constructor(e,t){this.x=e,this.y=t}static xy(e){return new he(e.x,e.y)}static fromAngle(e){let t=e*Math.PI/180;return new he(Math.cos(t),Math.sin(t))}get u(){return B.create(this.x,this.y)}get v(){return B.create(-this.y,this.x)}getLengthSquared(){return this.x*this.x+this.y*this.y}getLength(){return Math.sqrt(this.getLengthSquared())}normalize(){let e=this.getLength();return new he(this.x/e,this.y/e)}times(e){let t=this;return new he(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)}conjugate(){return new he(this.x,-this.y)}rotate(e){let t=this.x,r=this.y,n=-r,o=t;return B.create(e.x*t+e.y*n,e.x*r+e.y*o)}getAngle(){return(e=>e*180/Math.PI)(Math.atan2(this.y,this.x))}}class j{_x;_y;_z;static zero;static zero_$LI$(){return j.zero==null&&(j.zero=j.create(0,0,0)),j.zero}static unitX;static unitX_$LI$(){return j.unitX==null&&(j.unitX=j.create(1,0,0)),j.unitX}static unitY;static unitY_$LI$(){return j.unitY==null&&(j.unitY=j.create(0,1,0)),j.unitY}static unitZ;static unitZ_$LI$(){return j.unitZ==null&&(j.unitZ=j.create(0,0,1)),j.unitZ}static negUnitX;static negUnitX_$LI$(){return j.negUnitX==null&&(j.negUnitX=j.create(-1,0,0)),j.negUnitX}static negUnitY;static negUnitY_$LI$(){return j.negUnitY==null&&(j.negUnitY=j.create(0,-1,0)),j.negUnitY}static negUnitZ;static negUnitZ_$LI$(){return j.negUnitZ==null&&(j.negUnitZ=j.create(0,0,-1)),j.negUnitZ}constructor(e,t,r){this._x=e,this._y=t,this._z=r}static create(e,t,r){return new j(e,t,r)}get x(){return this._x}get y(){return this._y}get z(){return this._z}xy(){return B.create(this._x,this._y)}xz(){return B.create(this._x,this._z)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}add(e){return j.create(this.x+e.x,this.y+e.y,this.z+e.z)}sub(e){return j.create(this.x-e.x,this.y-e.y,this.z-e.z)}scale(e){return j.create(this.x*e,this.y*e,this.z*e)}negate(){return j.create(-this.x,-this.y,-this.z)}cross(e){return j.create(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}normalize(){let e=this.length();return j.create(this.x/e,this.y/e,this.z/e)}lengthSquared(){return this.dot(this)}length(){return Math.sqrt(this.lengthSquared())}distanceSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}distance(e){return Math.sqrt(this.distanceSquared(e))}lerp(e,t){return j.create(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t,this.z+(e.z-this.z)*t)}toJSON(){return{x:this.x,y:this.y,z:this.z}}static fromJSON(e){return j.create(e.x,e.y,e.z)}toString(){return"("+(""+this.x)+", "+(""+this.y)+", "+(""+this.z)+")"}}j.negUnitZ_$LI$();j.negUnitY_$LI$();j.negUnitX_$LI$();j.unitZ_$LI$();j.unitY_$LI$();j.unitX_$LI$();j.zero_$LI$();class ut{_n;_d;constructor(e,t){this._n=e,this._d=t}static create(e,t){return new ut(e,t)}static fromKnownPtAndNormal(e,t){return ut.create(t,-t.dot(e))}get n(){return this._n}get d(){return this._d}moveInNormalDirection(e){return new ut(this.n,this.d-e*this.n.length())}closestPoint(e){let t=-(this.d+e.dot(this.n))/this.n.dot(this.n);return e.add(this.n.scale(t))}threePlaneIntersection(e,t){let r=this,n=r.closestPoint(j.zero_$LI$()),o=e.closestPoint(j.zero_$LI$()),a=t.closestPoint(j.zero_$LI$()),s=r.n,u=e.n,l=t.n,c=u.cross(l).scale(n.dot(s)).add(l.cross(s).scale(o.dot(u))).add(s.cross(u).scale(a.dot(l))),d=s.x,h=s.y,p=s.z,g=u.x,f=u.y,y=u.z,b=l.x,m=l.y,k=l.z,v=d*(f*k-m*y)+g*(m*p-h*k)+b*(h*y-f*p);if(!(Math.abs(v)<.001))return c.scale(1/v)}fromSpace(e){let t=this.closestPoint(j.zero_$LI$()),r=e.vectorFromThisSpace(this.n),n=e.pointFromThisSpace(t);return ut.fromKnownPtAndNormal(n,r)}toSpace(e){let t=this.closestPoint(j.zero_$LI$()),r=e.vectorToThisSpace(this.n),n=e.pointToThisSpace(t);return ut.fromKnownPtAndNormal(n,r)}static xyPlane=ut.create(j.unitZ,0)}class ue{_w;_x;_y;_z;static identity;static identity_$LI$(){return ue.identity==null&&(ue.identity=ue.Builder.fromWXYZ().setWXYZ(1,0,0,0).build()),ue.identity}constructor(e,t,r,n){this._w=e,this._x=t,this._y=r,this._z=n}static fromAxisAngle(e,t){return ue.Builder.fromAxisAngle().setAxis(e).setAngle(t).build()}static fromUV(e,t){return ue.Builder.fromUVW().setU(e).setV(t).setW(e.cross(t)).build()}static fromVW(e,t){return ue.Builder.fromUVW().setU(e.cross(t)).setV(e).setW(t).build()}static fromWU(e,t){return ue.Builder.fromUVW().setU(t).setV(e.cross(t)).setW(e).build()}get w(){return this._w}get x(){return this._x}get y(){return this._y}get z(){return this._z}getLengthSquared(){return this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z}getLength(){return Math.sqrt(this.getLengthSquared())}normalize(){let e=this.getLength();return new ue(this.w/e,this.x/e,this.y/e,this.z/e)}times(e){let t=this;return new ue(t.w*e.w-t.x*e.x-t.y*e.y-t.z*e.z,t.w*e.x+t.x*e.w+t.y*e.z-t.z*e.y,t.w*e.y-t.x*e.z+t.y*e.w+t.z*e.x,t.w*e.z+t.x*e.y-t.y*e.x+t.z*e.w)}dotProduct(e){let t=this;return t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z}conjugate(){return new ue(this.w,-this.x,-this.y,-this.z)}rotate$Quaternion(e){return this.times(e).times(this.conjugate())}rotate(e){if(e!=null&&e instanceof ue||e===null)return this.rotate$Quaternion(e);if(e!=null&&e instanceof j||e===null)return this.rotate$Vec3(e);throw new Error("invalid overload")}rotate$Vec3(e){let t=this.times(ue.Builder.fromWXYZ().setWXYZ(0,e.x,e.y,e.z).build()).times(this.conjugate());return j.create(t.x,t.y,t.z)}slerp(e,t,r){let n=this,o=e,a=n.dotProduct(o),s,u;if(1-Math.abs(a)<.01)s=1-t,u=t;else{let l=Math.acos(Math.abs(a)),c=Math.sin(l);s=Math.sin(l*(1-t))/c,u=Math.sin(l*t)/c}return r&&a<0&&(s=-s),new ue(s*n.w+u*o.w,s*n.x+u*o.x,s*n.y+u*o.y,s*n.z+u*o.z)}toJSON(){return{w:this.w,x:this.x,y:this.y,z:this.z}}static fromJSON(e){return new ue(e.w,e.x,e.y,e.z)}toString(){return"Quaternion "+this.w+" "+this.x+" "+this.y+" "+this.z}}ue.__class="Quaternion";(i=>{class e{w;x;y;z;setW(a){return this.w=a,this}setWXYZ(a,s,u,l){return this.w=a,this.x=s,this.y=u,this.z=l,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}build(){return new i(this.w,this.x,this.y,this.z)}constructor(){this.w=0,this.x=0,this.y=0,this.z=0}}i.FromWXYZBuilder=e,e.__class="Quaternion.FromWXYZBuilder",e.__interfaces=["Quaternion.BuildStep","Quaternion.FromWXYZSetWStep","Quaternion.FromWXYZSetXStep","Quaternion.FromWXYZSetZStep","Quaternion.FromWXYZSetYStep"];class t{axisX;axisY;axisZ;angle;setAxisX(a){return this.axisX=a,this}setAxisXYZ(a,s,u){return this.axisX=a,this.axisY=s,this.axisZ=u,this}setAxis(a){return this.axisX=a.x,this.axisY=a.y,this.axisZ=a.z,this}setAxisY(a){return this.axisY=a,this}setAxisZ(a){return this.axisZ=a,this}setAngle(a){return this.angle=a,this}build(){let a=Math.sqrt(this.axisX*this.axisX+this.axisY*this.axisY+this.axisZ*this.axisZ);this.axisX/=a,this.axisY/=a,this.axisZ/=a;let s=Math.cos((l=>l*Math.PI/180)(.5*this.angle)),u=Math.sin((l=>l*Math.PI/180)(.5*this.angle));return new i(s,u*this.axisX,u*this.axisY,u*this.axisZ)}constructor(){this.axisX=0,this.axisY=0,this.axisZ=0,this.angle=0}}i.FromAxisAngleBuilder=t,t.__class="Quaternion.FromAxisAngleBuilder",t.__interfaces=["Quaternion.FromAxisAngleSetAxisYStep","Quaternion.FromAxisAngleSetAngleStep","Quaternion.FromAxisAngleSetAxisXStep","Quaternion.BuildStep","Quaternion.FromAxisAngleSetAxisZStep"];class r{u;v;w;setU(a){return this.u=a,this}setV(a){return this.v=a,this}setW(a){return this.w=a,this}build(){if(this.u==null||this.v==null||this.w==null)throw"Fields not all set";let a=this.u.x,s=this.u.y,u=this.u.z,l=this.v.x,c=this.v.y,d=this.v.z,h=this.w.x,p=this.w.y,g=this.w.z,f=a+c+g,y,b,m,k;if(f>0){let v=Math.sqrt(f+1)*2;y=.25*v,b=(d-p)/v,m=(h-u)/v,k=(s-l)/v}else if(((v,w)=>v&&w)(a>c,a>g)){let v=Math.sqrt(1+a-c-g)*2;y=(d-p)/v,b=.25*v,m=(l+s)/v,k=(h+u)/v}else if(c>g){let v=Math.sqrt(1+c-a-g)*2;y=(h-u)/v,b=(l+s)/v,m=.25*v,k=(p+d)/v}else{let v=Math.sqrt(1+g-a-c)*2;y=(s-l)/v,b=(h+u)/v,m=(p+d)/v,k=.25*v}return new i(y,b,m,k)}constructor(){this.u=null,this.v=null,this.w=null}}i.FromUVWBuilder=r,r.__class="Quaternion.FromUVWBuilder",r.__interfaces=["Quaternion.FromUVWSetUStep","Quaternion.BuildStep","Quaternion.FromUVWSetWStep","Quaternion.FromUVWSetVStep"];class n{static fromWXYZ(){return new i.FromWXYZBuilder}static fromAxisAngle(){return new i.FromAxisAngleBuilder}static fromUVW(){return new i.FromUVWBuilder}constructor(){}}i.Builder=n,n.__class="Quaternion.Builder"})(ue||(ue={}));ue.identity_$LI$();class me{origin;orientation;static identity=new me(B.zero,he.rot0);constructor(e,t){this.origin=e,this.orientation=t}static create(e,t){return new me(e,t)}get u(){return this.orientation.u}get v(){return this.orientation.v}pointFromSpace(e){return this.orientation.rotate(e).add(this.origin)}pointToSpace(e){return this.orientation.conjugate().rotate(e.sub(this.origin))}vectorFromSpace(e){return this.orientation.rotate(e)}vectorToSpace(e){return this.orientation.conjugate().rotate(e)}transformFromSpace(e){return me.create(this.pointFromSpace(e.origin),e.orientation.times(this.orientation))}transformToSpace(e){return me.create(this.pointToSpace(e.origin),this.orientation.conjugate().times(e.orientation))}}class Ie{_origin;_orientation;static identity;static identity_$LI$(){return Ie.identity==null&&(Ie.identity=Ie.Builder.fromOriginOrientation().setOrigin(j.zero_$LI$()).setOrientation(ue.identity_$LI$()).build()),Ie.identity}constructor(e,t){this._origin=e,this._orientation=t}static create(e,t){return new Ie(e,t)}get origin(){return this._origin}get orientation(){return this._orientation}get o(){return this.origin}get u(){return this.orientation.rotate$Vec3(j.unitX_$LI$())}get v(){return this.orientation.rotate$Vec3(j.unitY_$LI$())}get w(){return this.orientation.rotate$Vec3(j.unitZ_$LI$())}pointToThisSpace(e){return this.orientation.conjugate().rotate$Vec3(e.sub(this.origin))}vectorToThisSpace(e){return this.orientation.conjugate().rotate$Vec3(e)}toThisSpace(e){return Ie.Builder.fromOriginOrientation().setOrigin(this.pointToThisSpace(e.origin)).setOrientation(this.orientation.conjugate().times(e.orientation)).build()}pointFromThisSpace(e){return this.orientation.rotate$Vec3(e).add(this.origin)}vectorFromThisSpace(e){return this.orientation.rotate$Vec3(e)}fromThisSpace(e){return Ie.Builder.fromOriginOrientation().setOrigin(this.pointFromThisSpace(e.origin)).setOrientation(this.orientation.times(e.orientation)).build()}invert(){return Ie.Builder.fromOriginOrientation().setOrigin(this.orientation.conjugate().rotate$Vec3(this.origin.scale(-1))).setOrientation(this.orientation.conjugate()).build()}times(e){return this.fromThisSpace(e)}toJSON(){return{origin:this.origin,orientation:this.orientation}}static fromJSON(e){return Ie.create(j.fromJSON(e.origin),ue.fromJSON(e.orientation))}toString(){return"(origin:"+this.origin.toString()+", orientation: "+this.orientation.toString()+")"}}Ie.__class="Transform3D";(i=>{class e{originX;originY;originZ;orientation;setOrigin(n){return this.originX=n.x,this.originY=n.y,this.originZ=n.z,this}setOriginX(n){return this.originX=n,this}setOriginXYZ(n,o,a){return this.originX=n,this.originY=o,this.originZ=a,this}setOriginY(n){return this.originY=n,this}setOriginZ(n){return this.originZ=n,this}setOrientation(n){return this.orientation=n,this}build(){if(this.orientation==null)throw"Fields not all set";return new i(j.create(this.originX,this.originY,this.originZ),this.orientation)}constructor(){this.originX=0,this.originY=0,this.originZ=0,this.orientation=null}}i.FromOriginOrientationBuilder=e,e.__class="Transform3D.FromOriginOrientationBuilder",e.__interfaces=["Transform3D.FromOriginOrientationSetOriginYStep","Transform3D.FromOriginOrientationSetOrientationStep","Transform3D.FromOriginOrientationSetOriginXStep","Transform3D.BuildStep","Transform3D.FromOriginOrientationSetOriginZStep"];class t{static fromOriginOrientation(){return new i.FromOriginOrientationBuilder}constructor(){}}i.Builder=t,t.__class="Transform3D.Builder"})(Ie||(Ie={}));Ie.identity_$LI$();function Cc(i){let e=new ht,t=S(()=>{let r=[];for(let[n,o]of e.entries())r.push({id:n,pos:o});return r.sort((n,o)=>n.id-o.id),r});{let r=S(()=>t().length==1);le(()=>{if((i.disableOneFingerPan?.()??!1)||!r())return;let n=S(()=>t()[0].pos),o=se(()=>i.pan()),a=se(()=>i.scale()),s=se(()=>n()),u=1/a;Number.isFinite(u)&&le(ie(n,l=>{i.setPan(o.sub(l.sub(s).multScalar(u)))},{defer:!0}))})}{let r=S(()=>t().length==2);le(()=>{if(!r())return;let n=S(()=>t()[0].pos),o=S(()=>t()[1].pos),a=S(()=>n().add(o()).multScalar(.5)),s=S(()=>n().distance(o())),u=se(()=>i.pan()),l=se(()=>i.scale()),c=se(()=>a()),d=se(()=>s()),h=se(()=>c.multScalar(1/l).add(u));!Number.isFinite(h.x)||!Number.isFinite(h.y)||le(ie([a,s],([p,g])=>{let f=l*g/d,y=h.sub(p.multScalar(1/f));ze(()=>{Number.isFinite(f)&&Number.isFinite(y.x)&&Number.isFinite(y.y)&&(i.setPan(y),i.setScale(f))})},{defer:!0}))})}return{onPointerDown(r){let n,o;if(r.currentTarget instanceof Element){let a=r.currentTarget.getBoundingClientRect();n=a.left,o=a.top}else n=0,o=0;e.set(r.pointerId,B.create(r.clientX-n,r.clientY-o))},onPointerUp(r){e.delete(r.pointerId),i.releasePointerCapture(r.pointerId)},onPointerCancel(r){e.delete(r.pointerId),i.releasePointerCapture(r.pointerId)},onPointerMove(r){if(!e.has(r.pointerId))return;let n,o;if(r.currentTarget instanceof Element){let a=r.currentTarget.getBoundingClientRect();n=a.left,o=a.top}else n=0,o=0;e.set(r.pointerId,B.create(r.clientX-n,r.clientY-o))},onWheel(r){let n,o;if(r.currentTarget instanceof Element){let c=r.currentTarget.getBoundingClientRect();n=c.left,o=c.top}else n=0,o=0;let a=B.create(r.clientX-n,r.clientY-o),s=i.scale(),u=i.scale();if(r.deltaY<0)u*=1.1;else if(r.deltaY>0)u/=1.1;else return;let l=i.pan().add(a.multScalar(1/s-1/u));ze(()=>{i.setPan(l),i.setScale(u)})},numTouches:S(()=>t().length)}}class _c{canUndo;canRedo;undoDisplayName;redoDisplayName;undo;redo;pushUndoUnit;clear;constructor(){let e=[],t=-1,[r,n]=K(!1),[o,a]=K(!1),[s,u]=K(),[l,c]=K(),d=()=>{ze(()=>{if(n(()=>t!=-1),a(()=>t<e.length-1),t!=-1){let f=e[t];u(f.displayName)}else u(void 0);if(t<e.length-1){let f=e[t+1];c(f.displayName)}else c(void 0)})},h=()=>{if(t==-1)return;e[t].run(!0),--t,d()},p=()=>{if(t>=e.length-1)return;++t,e[t].run(!1),d()},g=f=>{t<e.length-1&&e.splice(t+1,e.length-1-t),++t,e.push(f),d()};this.clear=()=>{e.splice(0,e.length),t=-1,d()},this.canUndo=r,this.canRedo=o,this.undoDisplayName=s,this.redoDisplayName=l,this.undo=h,this.redo=p,this.pushUndoUnit=g}}function No(i){return i==null?[]:[i]}function Tc(i,e){let t,r=()=>{},n=0;return()=>{if(Vr()==null)return t!=null?t():i();if(t==null){let{cache:o,dispose:a}=nt(s=>({cache:S(i),dispose:s}));t=o,r=a,n=1}else++n;return be(()=>{--n==0&&(r(),r=()=>{},e?.(),t=void 0)}),t()}}class Lt{value;constructor(e){this.value=e}}function $c(i){for(var e="",t=i.byteLength,r=0;r<t;r++)e+=String.fromCharCode(i[r]);return window.btoa(e)}function Ic(i){for(var e=atob(i),t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}class mt{entityMap;componentTypeEntitiesMap;componentTypeEntitiesMap_=new Map;constructor(){this.entityMap=new ht,this.componentTypeEntitiesMap=new ht}entities(){return Array.from(this.entityMap.keys())}entitiesWithComponentType(e){{let r=this.componentTypeEntitiesMap_.get(e.typeName);if(r!=null)return r()}let t=Tc(()=>{let r=this.componentTypeEntitiesMap.get(e.typeName);if(r==null)return[];let n=[];for(let o of r)n.push(o);return n},()=>{this.componentTypeEntitiesMap_.delete(e.typeName)});return this.componentTypeEntitiesMap_.set(e.typeName,t),t()}createEntityWithId(e,t){se(()=>ze(()=>{this.entityMap.set(e,new ht(t.map(r=>[r.type.typeName,r])));for(let r of t){let n=this.componentTypeEntitiesMap.get(r.type.typeName);n==null&&(n=new Ke,this.componentTypeEntitiesMap.set(r.type.typeName,n)),n.add(e)}}))}createEntity(e){let t=dt();return this.createEntityWithId(t,e),t}destroyEntity(e){se(()=>ze(()=>{let t=this.entityMap.get(e);if(t!=null)for(let r of t.values()){let n=this.componentTypeEntitiesMap.get(r.type.typeName);n?.delete(e)}this.entityMap.delete(e)}))}attachToParent(e,t){se(()=>{this.getComponent(e,At)?.state?.parentId!=null&&this.detactFromParent(e);let r=this.getComponent(t,Mt);r==null?(r=Mt.create({childIds:[e]}),this.setComponent(t,r)):r.setState("childIds",Et(n=>n.push(e))),this.setComponent(e,At.create({parentId:t}))})}detactFromParent(e){se(()=>{let t=this.getComponent(e,At);if(t!=null){this.unsetComponent(e,At);let r=t.state.parentId,n=this.getComponent(r,Mt);if(n!=null){let o=n.state.childIds.filter(a=>a!==e);o.length==0?this.unsetComponent(r,Mt):n.setState("childIds",o)}}})}getComponent(e,t){let r=this.entityMap.get(e);if(r!=null)return r.get(t.typeName)}getComponents(e){return Array.from(this.entityMap.get(e)?.values()??[])}setComponent(e,t){this.setComponents(e,[t])}setComponents(e,t){let r=this.entityMap.get(e);if(r!=null)for(let n of t)r.set(n.type.typeName,n)}unsetComponent(e,t){let r=this.entityMap.get(e);r?.delete(t.typeName)}unsetComponents(e,t){let r=this.entityMap.get(e);if(r!=null)for(let n of t)r.delete(n.typeName)}toJson(){let e={};for(let t of this.entities()){let r={};for(let n of this.getComponents(t))r[n.type.typeName]=De(n.type.typeSchema,n.state);e[t]=r}return e}static fromJson(e,t){let r=new mt;for(let n of Object.keys(t)){let o=t[n],a=Object.keys(o),s=[];for(let u of a){let l=e.componentTypeMap.get(u);if(l==null)return Ue(`${u} not found`);let c=Re(l.typeSchema,o[u]);if(c.type=="Err")return c;let d=c.value,h=l.create(d);s.push(h)}r.createEntityWithId(n,s)}return pe(r)}}const Ec=en(i=>B.create(i.x,i.y),i=>({x:i.x,y:i.y}),G({x:Be(),y:Be()})),Rc=en(i=>new he(i.x,i.y),i=>({x:i.x,y:i.y}),G({x:Be(),y:Be()})),Mc=en(({origin:i,orientation:e})=>me.create(i,e),i=>({origin:i.origin,orientation:i.orientation}),G({origin:Ec,orientation:Rc})),Ac=G({transform:Mc}),Se=new Z({typeName:"Transform2D",typeSchema:Ac});class Oo{nodeTypes=[];noteTypeNameToNodeTypeMap=new Map;registerNodeType(e){this.nodeTypes.push(e),this.noteTypeNameToNodeTypeMap.set(e.componentType.typeName,e)}registerNodeTypes(e){for(let t of e)this.registerNodeType(t)}lookupNodeType(e){return this.noteTypeNameToNodeTypeMap.get(e)}}const $=G({target:Qe(),pin:Qe()});var Nc=q("<svg><path fill=none stroke=blue stroke-width=2 vector-effect=non-scaling-stroke></svg>",!1,!0),Oc=q("<svg><g><rect x=0 stroke=black rx=5 ry=5></rect><text style=user-select:none;></svg>",!1,!0),Fc=q("<svg><foreignObject x=5></svg>",!1,!0),Kn=q("<svg><circle r=1></svg>",!1,!0),Zn=q("<svg><text></svg>",!1,!0);class zr{Render;constructor(e){this.Render=()=>[I(Xe,{get each(){return e.nodes()},children:t=>I(zc,{node:t,get isHighlighted(){return e.highlightedEntitySet.has(t.node.nodeParams.entity)},get isSelected(){return e.selectedEntitySet.has(t.node.nodeParams.entity)}})}),I(Xe,{get each(){return e.nodes()},children:t=>I(Xe,{get each(){return t.node.inputPins?.()??[]},children:r=>I(ae,{get when(){return r.source()},children:n=>{let o=S(()=>e.lookupNodeById(n().target)),a=S(()=>{let u=o();if(u==null)return;let l=u.outputPinPositionMap()?.get(n().pin);if(l!=null)return u.space().pointFromSpace(l)}),s=S(()=>{let u=t.inputPinPositionMap()?.get(r.name);if(u!=null)return t.space().pointFromSpace(u)});return I(ae,{get when(){return a()},children:u=>I(ae,{get when(){return s()},children:l=>{let c=S(()=>Fo(u().x,-u().y,l().x,-l().y,0));return(()=>{var d=Nc();return Q(()=>X(d,"d",c())),d})()}})})}})})})]}}let xr=(()=>{let i=new Map;return e=>{let t=i.get(e);if(t!=null)return t;let{svg:r,dispose:n}=nt(u=>({svg:jc(),dispose:u})),o=document.createElementNS("http://www.w3.org/2000/svg","text"),a=document.createTextNode(e);o.appendChild(a),r.appendChild(o);let s=o.getBBox();return n(),t=B.create(s.width,s.height),i.set(e,t),t}})(),Dc=(()=>{let i=new Map;return(e,t)=>{let r=i.get(e);return r!=null||(r=t(),i.set(e,r)),r}})();function zc(i){let e=S(()=>xr(i.node.node.type.componentType.typeName)),t=S(it(()=>i.node.node.inputPins?.()??[],k=>{let v=xr(k.name);return{name:k.name,size:v}})),r=S(it(()=>i.node.node.outputPins?.()??[],k=>{let v=xr(k.name);return{name:k.name,size:v}})),n=S(()=>{let k=i.node.node.ui?.();if(k!=null)return Dc(i.node.node.type.componentType.typeName,()=>{let v=Lc(),w=document.createElement("div");w.style.setProperty("display","inline-block"),v.append(w);let x=_i(()=>I(k,{}),w),P=w.getBoundingClientRect();return x(),B.create(P.width,P.height)})});const o=5,a=5,s=S(()=>{let k=0;for(let v of t())k+=v.size.y;return k}),u=S(()=>{let k=0;for(let v of r())k+=v.size.y;return k});let l=S(()=>{let k=0;for(let v of t())k=Math.max(k,v.size.x);return k}),c=S(()=>{let k=0;for(let v of r())k=Math.max(k,v.size.x);return k}),d=S(()=>e().y+Math.max(s(),u())+(n()?.y??0)+2*o),h=S(()=>Math.max(e().x,l()+c()+4*a,n()?.x??0)+2*o),p=S(()=>B.create(h(),d())),g=S(()=>{let k={},v=d()-e().y;for(let w of t())v-=w.size.y,k[w.name]={dotPos:B.create(a,v+.28*w.size.y),textPos:B.create(2*a,v)};return k}),f=S(()=>{let k={},v=d()-e().y;for(let w of r())v-=w.size.y,k[w.name]={dotPos:B.create(h()-a,v+.28*w.size.y),textPos:B.create(h()-2*a-w.size.x,v)};return k}),y=S(()=>{let k=new Map;for(let[v,{dotPos:w}]of Object.entries(g()))k.set(v,w);return k}),b=S(()=>{let k=new Map;for(let[v,{dotPos:w}]of Object.entries(f()))k.set(v,w);return k});Wr(()=>{i.node.setRenderSizeAccessor(p),i.node.setInputPinPositionMapAccessor(y),i.node.setOutputPinPositionMapAccessor(b)});let m=S(()=>{let k=i.node.space(),v=k.origin,w=k.u,x=v.x,P=-v.y,C=w.x,T=-w.y,M=-T;return`matrix(${C} ${M} ${T} ${C} ${x} ${P})`});return(()=>{var k=Oc(),v=k.firstChild,w=v.nextSibling;return H(k,I(ae,{get when(){return n()},children:x=>I(ae,{get when(){return i.node.node.ui?.()},keyed:!0,children:P=>(()=>{var C=Fc();return H(C,I(P,{})),Q(T=>{var M=-x().y-o,_=x().x,E=x().y;return M!==T.e&&X(C,"y",T.e=M),_!==T.t&&X(C,"width",T.t=_),E!==T.a&&X(C,"height",T.a=E),T},{e:void 0,t:void 0,a:void 0}),C})()})}),w),H(w,()=>i.node.node.type.componentType.typeName),H(k,I(Xe,{get each(){return i.node.node.inputPins?.()??[]},children:x=>{let P=S(()=>g()[x.name]),C=x.isEffectPin??!1;return I(ae,{get when(){return P()},children:T=>[(()=>{var M=Kn();return X(M,"fill",C?"purple":"black"),Q(_=>{var E=T().dotPos.x,O=-T().dotPos.y;return E!==_.e&&X(M,"cx",_.e=E),O!==_.t&&X(M,"cy",_.t=O),_},{e:void 0,t:void 0}),M})(),(()=>{var M=Zn();return X(M,"font-weight",C?"bold":"normal"),X(M,"fill",C?"purple":"black"),H(M,()=>x.name),Q(_=>{var E=T().textPos.x,O=-T().textPos.y;return E!==_.e&&X(M,"x",_.e=E),O!==_.t&&X(M,"y",_.t=O),_},{e:void 0,t:void 0}),M})()]})}}),null),H(k,I(Xe,{get each(){return i.node.node.outputPins?.()??[]},children:x=>{let P=S(()=>f()[x.name]),C=x.isEffectPin??!1;return I(ae,{get when(){return P()},children:T=>[(()=>{var M=Kn();return X(M,"fill",C?"purple":"black"),Q(_=>{var E=T().dotPos.x,O=-T().dotPos.y;return E!==_.e&&X(M,"cx",_.e=E),O!==_.t&&X(M,"cy",_.t=O),_},{e:void 0,t:void 0}),M})(),(()=>{var M=Zn();return X(M,"font-weight",C?"bold":"normal"),X(M,"fill",C?"purple":"black"),H(M,()=>x.name),Q(_=>{var E=T().textPos.x,O=-T().textPos.y;return E!==_.e&&X(M,"x",_.e=E),O!==_.t&&X(M,"y",_.t=O),_},{e:void 0,t:void 0}),M})()]})}}),null),Q(x=>{var P=m(),C=-d(),T=h(),M=d(),_=i.isSelected?"green":i.isHighlighted?"blue":"white",E=.5*(h()-e().x),O=-d()+e().y;return P!==x.e&&X(k,"transform",x.e=P),C!==x.t&&X(v,"y",x.t=C),T!==x.a&&X(v,"width",x.a=T),M!==x.o&&X(v,"height",x.o=M),_!==x.i&&X(v,"fill",x.i=_),E!==x.n&&X(w,"x",x.n=E),O!==x.s&&X(w,"y",x.s=O),x},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),k})()}const Lc=(()=>{let i=0,e;return()=>(e!=null?++i:(e=document.createElement("div"),e.style.setProperty("position","absolute"),e.style.setProperty("left","-1000px"),e.style.setProperty("top","-1000px"),e.style.setProperty("width","500px"),e.style.setProperty("height","500px"),document.body.append(e),i=1),be(()=>{--i,i==0&&window.queueMicrotask(()=>{i==0&&e!=null&&(document.body.removeChild(e),e=void 0)})}),e)})(),jc=(()=>{let i=0,e;return()=>(e!=null?++i:(e=document.createElementNS("http://www.w3.org/2000/svg","svg"),e.style.setProperty("position","absolute"),e.style.setProperty("left","-1000px"),e.style.setProperty("top","-1000px"),document.body.append(e),i=1),be(()=>{--i,i==0&&window.queueMicrotask(()=>{i==0&&e!=null&&(document.body.removeChild(e),e=void 0)})}),e)})();function Fo(i,e,t,r,n=.5){const o=(i+t)/2,a=(e+r)/2;let s,u,l,c;return s=i+(o-i)*(1-n),u=e+(a-e)*n,l=t-(t-o)*(1-n),c=r-(r-a)*n,`M ${i} ${e} C ${s} ${u}, ${l} ${c}, ${t} ${r}`}var Uc=q("<svg><path fill=none stroke-width=2 pointer-events=none vector-effect=non-scaling-stroke></svg>",!1,!0);class Bc{overlaySvg;dragEnd;disablePan=()=>!0;constructor(e){let t=e.modeParams,r=S(()=>t.nodesSystem.lookupNodeById(e.fromNodeId)),n=S(()=>{let s=r();if(s==null)return;let u=s.outputPinPositionMap()?.get(e.fromPin.name);if(u!=null)return s.space().pointFromSpace(u)}),o=S(()=>{let s=t.mousePos();if(s!=null)return t.screenPtToWorldPt(s)}),a=S(()=>{let s=t.pickingSystem.nodeUnderMouseById();if(s==null)return;let u=t.nodesSystem.lookupNodeById(s);if(u==null)return;let l=t.pickingSystem.pinUnderMouse();if(l?.type=="Input")return{nodeId:s,node:u,pin:l}});this.overlaySvg=()=>I(ae,{get when(){return n()},children:s=>I(ae,{get when(){return o()},children:u=>{let l=S(()=>Fo(s().x,-s().y,u().x,-u().y,0)),c=S(()=>a()!=null);return(()=>{var d=Uc();return Q(h=>{var p=l(),g=c()?"blue":"red";return p!==h.e&&X(d,"d",h.e=p),g!==h.t&&X(d,"stroke",h.t=g),h},{e:void 0,t:void 0}),d})()}})}),this.dragEnd=()=>{let s=a();if(s!=null){let u=r();if(u!=null){let l=u.node.outputPins?.()??[],c;for(let d of l)if(d.name==e.fromPin.name){c=d;break}if(c!=null){let d=s.node.node.inputPins?.()??[];for(let h of d)if(h.name==s.pin.name){{let p={target:s.nodeId,pin:s.pin.name},g=!1;for(let f of c.sinks())if(f.target==p.target&&f.pin==p.pin){g=!0;break}g||c.setSinks([...c.sinks(),p])}{let p={target:e.fromNodeId,pin:e.fromPin.name};h.setSource(p)}}}}}t.onDone()}}}var qc=q("<svg><circle fill=blue pointer-events=none></svg>",!1,!0);class Jn{overlaySvg;click;dragStart;dragEnd;highlightedObjectsById;selectedObjectsById;disablePan;constructor(e){let[t,r]=_e({dragging:void 0}),n=new Ke,o=S(()=>Array.from(n)),a=()=>e.pickingSystem.nodeUnderMouseById(),s=()=>e.pickingSystem.pinUnderMouse();ve(()=>{if(t.dragging==null)return;let l=t.dragging.value,c=e.mousePos();if(c==null)return;let d=e.screenPtToWorldPt(c);if(d==null)return;let h=e.nodesSystem.lookupNodeById(l.nodeId);h?.setSpace(me.create(d.sub(l.pickupOffset),he.rot0))}),this.overlaySvg=()=>I(ae,{get when(){return s()},children:l=>I(ae,{get when(){return e.nodesSystem.lookupNodeById(l().nodeId)},keyed:!0,children:c=>{let d=S(()=>{let h=l(),p;if(h.type=="Input"){let g=c.inputPinPositionMap()?.get(h.name);if(g==null)return;p=g}else if(h.type=="Output"){let g=c.outputPinPositionMap()?.get(h.name);if(g==null)return;p=g}else return;return c.space().pointFromSpace(p)});return I(ae,{get when(){return d()},children:h=>(()=>{var p=qc();return Q(g=>{var f=h().x,y=-h().y,b=5/e.scale();return f!==g.e&&X(p,"cx",g.e=f),y!==g.t&&X(p,"cy",g.t=y),b!==g.a&&X(p,"r",g.a=b),g},{e:void 0,t:void 0,a:void 0}),p})()})}})}),this.click=()=>{let l=a();n.clear(),l!=null&&n.add(l)},this.dragStart=()=>{let l=e.mousePos();if(l==null)return;let c=e.screenPtToWorldPt(l);if(c==null)return;{let g=s();if(g!=null&&g.type=="Output"){let f={type:"Output",name:g.name};e.setMode(()=>new Bc({modeParams:e,fromNodeId:g.nodeId,fromPin:f}));return}}if(e.nodesSystem.disablePan())return;let d=a();if(d==null||!n.has(d))return;let h=e.nodesSystem.lookupNodeById(d);if(h==null)return;let p=h.space().pointToSpace(c);r("dragging",new Lt({nodeId:d,pickupOffset:p}))},this.dragEnd=()=>{r("dragging",void 0)};const u=[];this.highlightedObjectsById=S(()=>s()!=null?u:No(a())),this.selectedObjectsById=o,this.disablePan=S(()=>s()!=null||t.dragging!=null)}}class Lr{nodes;lookupNodeById;disablePan;constructor(e){let t=e.nodeRegistry,r=S(it(()=>e.world().entities(),u=>{let l=S(()=>{for(let c of e.world().getComponents(u)){let d=t.lookupNodeType(c.type.typeName);if(d!=null)return{nodeType:d,nodeComponent:c}}});return S(()=>{let c=l();if(c==null)return;let{nodeType:d,nodeComponent:h}=c,p=h,g=d.create({entity:u,state:p.state,setState:p.setState}),f=S(()=>e.world().getComponent(u,Se)?.state.transform??me.identity),y=C=>se(()=>{let T=e.world().getComponent(u,Se);T==null?(T=Se.create({transform:C}),e.world().setComponents(u,[T])):T.setState("transform",C)}),[b,m]=K(),[k,v]=K(),[w,x]=K();return{node:g,space:f,setSpace:y,setRenderSizeAccessor:C=>m(()=>C),setInputPinPositionMapAccessor:C=>v(()=>C),setOutputPinPositionMapAccessor:C=>x(()=>C),renderSize:()=>b()?.(),inputPinPositionMap:()=>k()?.(),outputPinPositionMap:()=>w()?.()}})})),n=S(()=>r().flatMap(u=>No(u()))),o=new ht,a=S(()=>{it(n,u=>{let l=u.node.nodeParams.entity;o.set(l,u),be(()=>{o.delete(l)})})()}),s=u=>(a(),o.get(u));this.nodes=n,this.lookupNodeById=s,this.disablePan=S(()=>{for(let u of n())if(u.node.disablePan?.()??!1)return!0;return!1})}}const Qn=20,ei=Qn*Qn;class Do{nodeUnderMouseById;pinUnderMouse;constructor(e){let t=S(()=>{let o=e.mousePos();if(o==null)return;let a=e.screenPtToWorldPt(o);if(a!=null)for(let s of e.nodes()){let u=s.renderSize();if(u==null)continue;let l=s.space().pointToSpace(a);if(!(l.x<0||l.y<0||l.x>u.x||l.y>u.y))return s}}),r=()=>t()?.node.nodeParams.entity,n=S(()=>{let o=e.mousePos();if(o==null)return;let a,s;for(let u of e.nodes()){let l=u.inputPinPositionMap();if(l!=null)for(let[d,h]of l.entries()){let p=u.space().pointFromSpace(h),g=e.worldPtToScreenPt(p);if(g==null)continue;let f=g.distanceSquared(o);f>ei||(s==null||f<s)&&(a={type:"Input",nodeId:u.node.nodeParams.entity,name:d},s=f)}let c=u.outputPinPositionMap();if(c!=null)for(let[d,h]of c.entries()){let p=u.space().pointFromSpace(h),g=e.worldPtToScreenPt(p);if(g==null)continue;let f=g.distanceSquared(o);f>ei||(s==null||f<s)&&(a={type:"Output",nodeId:u.node.nodeParams.entity,name:d},s=f)}}return a});this.nodeUnderMouseById=r,this.pinUnderMouse=n}}var Vc=q('<button class="btn btn-primary">End Mode'),Gc=q("<div>"),Wc=q("<svg>"),Hc=q("<div><svg><g>");class Yc{instructions;overlayHtmlUi;sideForm;constructor(e){let[t,r]=_e({pan:B.zero,scale:1,formMousePos:void 0,dragging:void 0}),n=new mt,o=0;for(let x of e.nodeRegistry.nodeTypes)o-=80,n.createEntity([x.componentType.create(Le(x.componentType.typeSchema)),Se.create({transform:me.create(B.create(0,o),he.rot0)})]);let a=x=>B.create(t.pan.x+x.x/t.scale,-(t.pan.y+x.y/t.scale)),s=x=>B.create((x.x-t.pan.x)*t.scale,(-x.y-t.pan.y)*t.scale),u=new Lr({nodeRegistry:e.nodeRegistry,world:()=>n}),l=new Do({mousePos:()=>t.formMousePos,screenPtToWorldPt:a,worldPtToScreenPt:s,nodes:()=>u.nodes()}),c=()=>l.nodeUnderMouseById(),d=new Ke,h=new Ke;le(()=>{let x=c();x==null?d.clear():(d.clear(),d.add(x))});let p=new zr({nodes:()=>u.nodes(),lookupNodeById:x=>u.lookupNodeById(x),highlightedEntitySet:d,selectedEntitySet:h}),g=S(()=>{let x={},P=0;for(let C of u.nodes()){let T=C.renderSize();if(T==null)return;P-=T.y,x[C.node.nodeParams.entity]=B.create(0,P)}return x}),f=S(()=>{let x=g();if(x==null)return 0;let P=0;for(let C of Object.values(x))P=Math.min(P,C.y);return Math.abs(P)});le(()=>{let x=g();if(x!=null)for(let P of n.entities())se(()=>{let C=x[P];if(C==null)return;let T=n.getComponent(P,Se);T?.setState("transform",me.create(C,he.rot0))})});let[y,b]=K(),m,k=x=>{{let P=m.getBoundingClientRect();r("formMousePos",B.create(x.clientX-P.left,x.clientY-P.top))}m.setPointerCapture(x.pointerId),queueMicrotask(()=>{let P=t.formMousePos;if(P==null)return;let C=c();if(C==null)return;let T=u.lookupNodeById(C);if(T==null)return;let M=T.space().origin,_=a(P);_!=null&&r("dragging",new Lt({nodeType:T.node.type,nodeSize:T.renderSize()??B.create(100,50),pickupOffset:_.sub(M)}))})},v=x=>{m.releasePointerCapture(x.pointerId);let P=y();if(t.formMousePos!=null&&t.dragging!=null&&P!=null){let C=t.formMousePos,T=m.getBoundingClientRect(),M=P.getBoundingClientRect(),_=t.dragging.value.pickupOffset,E=B.create(T.left-M.left+C.x-_.x,T.top-M.top+C.y+_.y),O=e.screenPtToWorldPt(E);if(O==null)return;e.world().createEntity([t.dragging.value.nodeType.componentType.create(Le(t.dragging.value.nodeType.componentType.typeSchema)),Se.create({transform:me.create(O,he.rot0)})]),r("dragging",void 0)}},w=x=>{let P=m.getBoundingClientRect();r("formMousePos",B.create(x.clientX-P.left,x.clientY-P.top))};this.instructions=()=>(()=>{var x=Vc();return x.$$click=()=>{e.onDone()},x})(),this.overlayHtmlUi=()=>I(ae,{get when(){return t.dragging?.value},children:x=>I(ae,{get when(){return t.formMousePos},children:P=>{let[C,T]=K(!0);be(()=>{b(void 0)}),Wr(()=>T(!1));let M=S(()=>{if(C())return;let R=y();if(R==null)return;let z=m.getBoundingClientRect(),W=R.getBoundingClientRect();return P().add(B.create(z.left-W.left-x().pickupOffset.x,z.top-W.top-x().nodeSize.y+x().pickupOffset.y))}),_=new mt,E=_.createEntity([se(()=>x().nodeType.componentType.create(Le(x().nodeType.componentType.typeSchema))),Se.create({transform:me.create(B.create(0,se(()=>-x().nodeSize.y)),he.rot0)})]),O=new Lr({nodeRegistry:e.nodeRegistry,world:()=>_}),F=new zr({nodes:()=>O.nodes(),lookupNodeById:R=>O.lookupNodeById(R),highlightedEntitySet:new Ke([E]),selectedEntitySet:new Ke});return(()=>{var R=Gc(),z=b;return typeof z=="function"?ge(z,R):b=R,R.style.setProperty("position","absolute"),R.style.setProperty("left","0"),R.style.setProperty("top","0"),R.style.setProperty("right","0"),R.style.setProperty("bottom","0"),R.style.setProperty("pointer-events","none"),H(R,I(ae,{get when(){return M()},children:W=>(()=>{var V=Wc();return V.style.setProperty("position","absolute"),V.style.setProperty("touch-action","none"),V.style.setProperty("user-select","none"),H(V,I(F.Render,{})),Q(L=>{var Y=`${W().x}px`,re=`${W().y}px`,N=`${x().nodeSize.x}px`,J=`${x().nodeSize.y}px`;return Y!==L.e&&((L.e=Y)!=null?V.style.setProperty("left",Y):V.style.removeProperty("left")),re!==L.t&&((L.t=re)!=null?V.style.setProperty("top",re):V.style.removeProperty("top")),N!==L.a&&((L.a=N)!=null?V.style.setProperty("width",N):V.style.removeProperty("width")),J!==L.o&&((L.o=J)!=null?V.style.setProperty("height",J):V.style.removeProperty("height")),L},{e:void 0,t:void 0,a:void 0,o:void 0}),V})()})),R})()}})}),this.sideForm=S(()=>()=>(()=>{var x=Hc(),P=x.firstChild,C=P.firstChild;x.style.setProperty("width","150px"),x.style.setProperty("height","100%"),x.style.setProperty("overflow-x","hidden"),x.style.setProperty("overflow-y","auto"),P.$$pointermove=w,P.$$pointerup=v,P.$$pointerdown=k;var T=m;return typeof T=="function"?ge(T,P):m=P,P.style.setProperty("width","100%"),P.style.setProperty("touch-action","pan-y"),P.style.setProperty("user-select","none"),H(C,I(p.Render,{})),Q(M=>(M=`${f()}px`)!=null?P.style.setProperty("height",M):P.style.removeProperty("height")),x})())}}ke(["click","pointerdown","pointerup","pointermove"]);var Xc=q('<div><div><div><button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-t"></i></button><button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-upload"></i></button><input type=file hidden><button class="btn btn-primary"style=margin-left:5px;><i class="fa-solid fa-download"></i></button><button class="btn btn-primary"style=margin-left:5px;>Add Node</button><button class="btn btn-primary"style=margin-left:5px;>Delete</button><label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Freeze Pan/Zoom</label></div><div><svg><g>'),Kc=q("<div>"),ti=q("<div><div>");function zo(i){let[e,t]=Hr(i,["onInit","componentRegistry","nodeRegistry","world","toolbar"]),r=e.nodeRegistry,[n,o]=_e({pan:B.zero,scale:1,mousePos:void 0,mkMode:()=>new Jn(k),showCode:!1,makeSound:!1,freezePanZoom:!1,filename:"node-graph"}),a=new _c,s,[u,l]=K(B.zero);Wr(()=>{{let J=s.getBoundingClientRect();o("pan",B.create(0,-J.height))}let N=new ResizeObserver(()=>{let J=s.getBoundingClientRect();queueMicrotask(()=>{l(B.create(J.width,J.height))})});N.observe(s),be(()=>{N.unobserve(s),N.disconnect()})});let c=S(()=>`scale(${n.scale}) translate(${-n.pan.x} ${-n.pan.y})`),d=N=>{o("mkMode",()=>N)},h=N=>B.create(n.pan.x+N.x/n.scale,-(n.pan.y+N.y/n.scale)),p=N=>B.create((N.x-n.pan.x)*n.scale,(-N.y-n.pan.y)*n.scale),g=new Lr({nodeRegistry:r,world:()=>e.world}),f=new Do({mousePos:()=>n.mousePos,screenPtToWorldPt:h,worldPtToScreenPt:p,nodes:()=>g.nodes()}),y=new Ke,b=new Ke,m=new zr({nodes:()=>g.nodes(),lookupNodeById:N=>g.lookupNodeById(N),highlightedEntitySet:y,selectedEntitySet:b}),k={undoManager:a,nodeRegistry:r,nodesSystem:g,pickingSystem:f,mousePos:()=>n.mousePos,screenPtToWorldPt:h,worldPtToScreenPt:p,world:()=>e.world,onDone:()=>{d(()=>new Jn(k))},pan:()=>n.pan,setPan:N=>o("pan",N),scale:()=>n.scale,setScale:N=>o("scale",N),setMode:d},v=S(()=>n.mkMode()),w=Cc({pan:()=>n.pan,setPan:N=>o("pan",N),scale:()=>n.scale,setScale:N=>o("scale",N),setPointerCapture:N=>s.setPointerCapture(N),releasePointerCapture:N=>s.releasePointerCapture(N),disableOneFingerPan:S(()=>(v().disablePan?.()??!1)||n.freezePanZoom||g.disablePan())}),x=S(()=>v().highlightedObjectsById?.()??[]),P=S(()=>v().selectedObjectsById?.()??[]);le(it(x,N=>{y.add(N),be(()=>{y.delete(N)})})),le(it(P,N=>{b.add(N),be(()=>{b.delete(N)})}));let C=()=>{v().click?.()},T,M=!1,_=N=>{let J=s.getBoundingClientRect();o("mousePos",B.create(N.clientX-J.left,N.clientY-J.top)),v().dragStart?.(),M=!0,w.onPointerDown(N)},E=N=>{w.onPointerUp(N),w.numTouches()==0&&C(),M&&v().dragEnd?.(),window.clearTimeout(T),T=void 0},O=N=>{w.onPointerCancel(N)},F=N=>{let J=s.getBoundingClientRect();o("mousePos",B.create(N.clientX-J.left,N.clientY-J.top)),w.onPointerMove(N)},R=N=>{w.numTouches()==0&&o("mousePos",void 0)},z=N=>{w.onWheel(N)},W=()=>{for(let N of P())e.world.destroyEntity(N);b.clear()};e.onInit({nodesSystem:g});let[V,L]=K();const Y=async N=>{let J=await N.text().then(oe=>JSON.parse(oe)),ne=mt.fromJson(e.componentRegistry,J);if(ne.type=="Err"){alert(ne.message);return}let we=ne.value;ze(()=>{let oe=e.world;for(let Te of[...oe.entities()])oe.destroyEntity(Te);for(let Te of we.entities()){let Oe=we.getComponents(Te);oe.createEntityWithId(Te,Oe)}});let fe=N.name;fe.endsWith(".json")&&(fe=fe.slice(0,fe.length-5)),o("filename",fe)},re=()=>{let N=JSON.stringify(e.world.toJson(),void 0,2),J=new Blob([N],{type:"application/json"});ji.saveAs(J,`${n.filename}.json`)};return(()=>{var N=Xc(),J=N.firstChild,ne=J.firstChild,we=ne.firstChild,fe=we.nextSibling,oe=fe.nextSibling,Te=oe.nextSibling,Oe=Te.nextSibling,Ge=Oe.nextSibling,We=Ge.nextSibling,vt=We.firstChild,qe=ne.nextSibling,Pe=qe.firstChild,kt=Pe.firstChild;qr(N,t,!1,!0),J.style.setProperty("width","100%"),J.style.setProperty("height","100%"),J.style.setProperty("display","flex"),J.style.setProperty("flex-direction","column"),we.$$click=()=>{let ce=window.prompt("Enter new filename:",n.filename);ce!=null&&(ce=ce.trim(),ce!=""&&o("filename",ce))},fe.$$click=()=>V()?.click(),oe.addEventListener("change",ce=>{let de=ce.currentTarget.files;if(de?.length!=1)return;let A=de[0];Y(A),ce.currentTarget.value=""});var $e=L;typeof $e=="function"?ge($e,oe):L=oe,Te.$$click=()=>re(),Oe.$$click=()=>d(()=>new Yc(k)),Ge.$$click=()=>{W()},H(ne,()=>e.toolbar,We),vt.addEventListener("change",ce=>o("freezePanZoom",ce.currentTarget.checked)),qe.style.setProperty("flex-grow","1"),qe.style.setProperty("position","relative"),Pe.$$pointerout=R,Pe.addEventListener("wheel",z),Pe.$$pointermove=F,Pe.addEventListener("pointercancel",O),Pe.$$pointerup=E,Pe.$$pointerdown=_;var tt=s;return typeof tt=="function"?ge(tt,Pe):s=Pe,Pe.style.setProperty("position","absolute"),Pe.style.setProperty("left","0"),Pe.style.setProperty("top","0"),Pe.style.setProperty("width","100%"),Pe.style.setProperty("height","100%"),Pe.style.setProperty("touch-action","none"),Pe.style.setProperty("user-select","none"),H(kt,I(m.Render,{}),null),H(kt,I(ae,{get when(){return v().overlaySvg},keyed:!0,children:ce=>I(ce,{})}),null),H(qe,I(ae,{get when(){return v().sideForm?.()==null},get children(){return I(ae,{get when(){return v().instructions},keyed:!0,children:ce=>(()=>{var de=Kc();return de.style.setProperty("position","absolute"),de.style.setProperty("left","0"),de.style.setProperty("top","0"),H(de,I(ce,{})),de})()})}}),null),H(qe,I(ae,{get when(){return v().sideForm?.()},keyed:!0,children:ce=>(()=>{var de=ti(),A=de.firstChild;return de.style.setProperty("position","absolute"),de.style.setProperty("left","0"),de.style.setProperty("top","0"),de.style.setProperty("height","100%"),de.style.setProperty("display","flex"),de.style.setProperty("flex-direction","row"),de.style.setProperty("pointer-events","none"),A.style.setProperty("background","black"),A.style.setProperty("pointer-events","auto"),H(A,I(ce,{})),H(de,I(ae,{get when(){return v().instructions},keyed:!0,children:je=>(()=>{var He=ti(),Ye=He.firstChild;return Ye.style.setProperty("pointer-events","auto"),H(Ye,I(je,{})),He})()}),null),de})()}),null),H(qe,I(ae,{get when(){return v().overlayHtmlUi},keyed:!0,children:ce=>I(ce,{})}),null),Q(ce=>{var de=b.size==0,A=c();return de!==ce.e&&(Ge.disabled=ce.e=de),A!==ce.t&&X(kt,"transform",ce.t=A),ce},{e:void 0,t:void 0}),Q(()=>vt.checked=n.freezePanZoom),N})()}ke(["click","pointerdown","pointerup","pointermove","pointerout"]);const Zc=G({frequency:D($),amplitude:D($),centre:D($),out:ee($)}),nn=new Z({typeName:"SineWave",typeSchema:Zc});let Jc=class{nextFieldIdx=0;fieldDeclarations="";constructorCode="";messageHandlers=new Map;globalCode="";code_="";postCode="";allocField(e){let t=`x${this.nextFieldIdx++}`;return this.fieldDeclarations+=`  ${t} = ${e};\r
`,`this.${t}`}allocFieldNoDecl(){return`this.${`x${this.nextFieldIdx++}`}`}addDeclToExistingForField(e,t){e.startsWith("this.")&&(e=e.substring(5)),this.fieldDeclarations+=`  ${e} = ${t};\r
`}insertConstructorCode(e){this.constructorCode+=e.map(t=>`      ${t}\r
`).join("")}insertMessageHandlerCode(e,t){this.messageHandlers.get(e);let r=t.map(n=>`        ${n}\r
`).join("");this.messageHandlers.set(e,r)}insertGlobalCode(e){this.globalCode+=e.map(t=>`${t}\r
`).join("")}insertCode(e){this.code_+=e.map(t=>`      ${t}\r
`).join("")}insertPostCode(e){this.postCode+=e.map(t=>`      ${t}\r
`).join("")}get code(){let e="";return this.messageHandlers.size!=0?e=[`    this.port.onmessage = (e) => {\r
`,`      let data = e.data;\r
`,...this.messageHandlers.entries().map(([t,r],n)=>{let o,a=n==this.messageHandlers.size-1;return n==0?o="      if":o="      } else if",`${o} (data.type == "${t}") {\r
        let params = data.params;\r
${r}${a?`      }\r
`:""}`}),`    };\r
`].join(""):e="",[this.globalCode,"class CompiledGraphAudioWorkletProcessor extends AudioWorkletProcessor {","  runningEffectsHead = null;","  runningEffectsTail = null;","  variables = {};",this.fieldDeclarations,"  constructor(options) {","    super();",`${this.constructorCode}${e}  }`,"","  insertRunningEffect(effect) {","    if (this.runningEffectsTail == null) {","      this.runningEffectsHead = effect;","      this.runningEffectsTail = effect;","    } else {","      this.runningEffectsTail.next = effect;","      effect.prev = this.runningEffectsTail;","      this.runningEffectsTail = effect;","    }","  }","","  removeRunningEffect(effect) {","    if (effect.prev != null) {","      effect.prev.next = effect.next;","    }","    if (effect.next != null) {","      effect.next.prev = effect.prev;","    }","    if (this.runningEffectsHead == effect) {","      this.runningEffectsHead = effect.next;","    }","    if (this.runningEffectsTail == effect) {","      this.runningEffectsTail = effect.prev;","    }","    effect.prev = null;","    effect.next = null;","  }","","  process(inputs, outputs, parameters) {","    let output = outputs[0][0];","    debugger;","    for (let i = 0; i < output.length; ++i) {","      let result = 0.0;",`${this.code_}${this.postCode}      let effect = this.runningEffectsHead;`,"      while (effect != null) {","        let isDone = effect.update();","        if (isDone) {","          this.removeRunningEffect(effect);","          for (let onDone of effect.onDone) {","            onDone();","          }","        }","        effect = effect.next;","      }","      output[i] = result;","    }","    return true;","  }","}","",'registerProcessor("compiled-graph-audio-worklet-processor", CompiledGraphAudioWorkletProcessor);'].join(`\r
`)}};function Qc(i,e){let t=new Map,r=[i];for(;;){let n=r.pop();if(n==null)break;if(t.has(n))continue;let o={};for(let s of Object.entries(n.inputs))o[s[0]]={...s[1]};let a={id:0,inputs:o,outputs:{},height:n.height,node:n.node};e(a),t.set(n,a);for(let s of Object.values(n.outputs))for(let u of s)r.push(u.node)}for(let n of t.values())for(let o of Object.entries(n.inputs)){let a=t.get(o[1].node);a!=null&&(o[1].node=a)}for(let n of t.values())for(let[o,{node:a,pin:s}]of Object.entries(n.inputs)){let u=a.outputs[s],l={node:n,pin:o};u==null?(u=[l],a.outputs[s]=u):u.push(l)}return t.get(i)}function eu(i){let e=i.nodesSystem,t=[];{let a=new Map;for(let s of e.nodes()){let u={id:0,inputs:{},outputs:{},height:0,node:s};a.set(s.node.nodeParams.entity,u),t.push(u)}for(let s of a.values())for(let u of s.node.node.inputPins?.()??[]){let l=u.source();if(l==null)continue;let c=a.get(l.target);c!=null&&(s.inputs[u.name]={node:c,pin:l.pin})}}for(let a of t)for(let[s,{node:u,pin:l}]of Object.entries(a.inputs)){let c=u.outputs[l],d={node:a,pin:s};c==null?(c=[d],u.outputs[l]=c):c.push(d)}let r=[];{let a=new Set;for(;;){let s=!1;ri(t);for(let u of t){let l=r[u.height];l==null?(l=[u],r[u.height]=l):l.push(u)}for(let u=0;u<r.length;++u){let l=r[u]??[];for(let c of l){if(a.has(c))continue;let d=c.node.node;if(d.ext.macro!=null){d.ext.macro(c,h=>t.push(h)),a.add(c),s=!0;break}}if(s)break}if(!s)break}}ri(t);{let a=0;for(let s of t)s.id=a++}let n=new Jc;{let a=new Set;for(let s of e.nodes()){let u=s.node.type;a.has(u.componentType.typeName)||(a.add(u.componentType.typeName),u.ext.generateInitOnceCode?.({ctx:n}))}}r.splice(0,r.length);for(let a of t){let s=r[a.height];s==null?(s=[a],r[a.height]=s):s.push(a)}let o=new Map;for(let a=0;a<r.length;++a){let s=r[a]??[];for(let u of s){let l=u.node.node,c=new Map;for(let d of Object.entries(u.inputs)){let h=o.get(d[1].node)?.get(d[1].pin);h!=null?c.set(d[0],h):c.set(d[0],`this.n_${d[1].node.id}_${d[1].pin}`)}if(l.ext.generateCode!=null){let d=l.ext.generateCode({ctx:n,inputAtoms:c,codeGenNodeId:u.id});if(d.length==1){let h=d[0].outputAtoms;o.set(u,h)}}}}return n.code}function ri(i){let e=new Set,t=[...i],r=[];for(;;){let n=t.pop();if(n==null){let s=t;if(t=r,r=s,n=t.pop(),n==null)break}if(e.has(n))continue;let o=!0;for(let[s,{node:u}]of Object.entries(n.inputs))if(!(n.node.node.inputPins?.().find(l=>l.name==s)?.isEffectPin??!1)&&!e.has(u)){o=!1;break}if(!o){r.push(n);continue}let a=0;for(let[,{node:s,pin:u}]of Object.entries(n.inputs))(s.node.node.outputPins?.().find(({name:l})=>l==u)?.isEffectPin??!1)||s.height>=a&&(a=s.height+1);n.height=a,e.add(n)}}var st={},Gt={},Sr,ni;function tu(){if(ni)return Sr;ni=1;function i(n){var o=new r(n),a=o.readChunk();if(a.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+a.id+"'";for(var s=e(a.data),u=[],l=0;!o.eof()&&l<s.numTracks;l++){var c=o.readChunk();if(c.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+c.id+"'";var d=t(c.data);u.push(d)}return{header:s,tracks:u}}function e(n){var o=new r(n),a=o.readUInt16(),s=o.readUInt16(),u={format:a,numTracks:s},l=o.readUInt16();return l&32768?(u.framesPerSecond=256-(l>>8),u.ticksPerFrame=l&255):u.ticksPerBeat=l,u}function t(n){for(var o=new r(n),a=[];!o.eof();){var s=l();a.push(s)}return a;var u;function l(){var c={};c.deltaTime=o.readVarInt();var d=o.readUInt8();if((d&240)===240)if(d===255){c.meta=!0;var h=o.readUInt8(),p=o.readVarInt();switch(h){case 0:if(c.type="sequenceNumber",p!==2)throw"Expected length for sequenceNumber event is 2, got "+p;return c.number=o.readUInt16(),c;case 1:return c.type="text",c.text=o.readString(p),c;case 2:return c.type="copyrightNotice",c.text=o.readString(p),c;case 3:return c.type="trackName",c.text=o.readString(p),c;case 4:return c.type="instrumentName",c.text=o.readString(p),c;case 5:return c.type="lyrics",c.text=o.readString(p),c;case 6:return c.type="marker",c.text=o.readString(p),c;case 7:return c.type="cuePoint",c.text=o.readString(p),c;case 32:if(c.type="channelPrefix",p!=1)throw"Expected length for channelPrefix event is 1, got "+p;return c.channel=o.readUInt8(),c;case 33:if(c.type="portPrefix",p!=1)throw"Expected length for portPrefix event is 1, got "+p;return c.port=o.readUInt8(),c;case 47:if(c.type="endOfTrack",p!=0)throw"Expected length for endOfTrack event is 0, got "+p;return c;case 81:if(c.type="setTempo",p!=3)throw"Expected length for setTempo event is 3, got "+p;return c.microsecondsPerBeat=o.readUInt24(),c;case 84:if(c.type="smpteOffset",p!=5)throw"Expected length for smpteOffset event is 5, got "+p;var g=o.readUInt8(),f={0:24,32:25,64:29,96:30};return c.frameRate=f[g&96],c.hour=g&31,c.min=o.readUInt8(),c.sec=o.readUInt8(),c.frame=o.readUInt8(),c.subFrame=o.readUInt8(),c;case 88:if(c.type="timeSignature",p!=2&&p!=4)throw"Expected length for timeSignature event is 4 or 2, got "+p;return c.numerator=o.readUInt8(),c.denominator=1<<o.readUInt8(),p===4?(c.metronome=o.readUInt8(),c.thirtyseconds=o.readUInt8()):(c.metronome=36,c.thirtyseconds=8),c;case 89:if(c.type="keySignature",p!=2)throw"Expected length for keySignature event is 2, got "+p;return c.key=o.readInt8(),c.scale=o.readUInt8(),c;case 127:return c.type="sequencerSpecific",c.data=o.readBytes(p),c;default:return c.type="unknownMeta",c.data=o.readBytes(p),c.metatypeByte=h,c}}else if(d==240){c.type="sysEx";var p=o.readVarInt();return c.data=o.readBytes(p),c}else if(d==247){c.type="endSysEx";var p=o.readVarInt();return c.data=o.readBytes(p),c}else throw"Unrecognised MIDI event type byte: "+d;else{var y;if(d&128)y=o.readUInt8(),u=d;else{if(u===null)throw"Running status byte encountered before status byte";y=d,d=u,c.running=!0}var b=d>>4;switch(c.channel=d&15,b){case 8:return c.type="noteOff",c.noteNumber=y,c.velocity=o.readUInt8(),c;case 9:var m=o.readUInt8();return c.type=m===0?"noteOff":"noteOn",c.noteNumber=y,c.velocity=m,m===0&&(c.byte9=!0),c;case 10:return c.type="noteAftertouch",c.noteNumber=y,c.amount=o.readUInt8(),c;case 11:return c.type="controller",c.controllerType=y,c.value=o.readUInt8(),c;case 12:return c.type="programChange",c.programNumber=y,c;case 13:return c.type="channelAftertouch",c.amount=y,c;case 14:return c.type="pitchBend",c.value=y+(o.readUInt8()<<7)-8192,c;default:throw"Unrecognised MIDI event type: "+b}}}}function r(n){this.buffer=n,this.bufferLen=this.buffer.length,this.pos=0}return r.prototype.eof=function(){return this.pos>=this.bufferLen},r.prototype.readUInt8=function(){var n=this.buffer[this.pos];return this.pos+=1,n},r.prototype.readInt8=function(){var n=this.readUInt8();return n&128?n-256:n},r.prototype.readUInt16=function(){var n=this.readUInt8(),o=this.readUInt8();return(n<<8)+o},r.prototype.readInt16=function(){var n=this.readUInt16();return n&32768?n-65536:n},r.prototype.readUInt24=function(){var n=this.readUInt8(),o=this.readUInt8(),a=this.readUInt8();return(n<<16)+(o<<8)+a},r.prototype.readInt24=function(){var n=this.readUInt24();return n&8388608?n-16777216:n},r.prototype.readUInt32=function(){var n=this.readUInt8(),o=this.readUInt8(),a=this.readUInt8(),s=this.readUInt8();return(n<<24)+(o<<16)+(a<<8)+s},r.prototype.readBytes=function(n){var o=this.buffer.slice(this.pos,this.pos+n);return this.pos+=n,o},r.prototype.readString=function(n){var o=this.readBytes(n);return String.fromCharCode.apply(null,o)},r.prototype.readVarInt=function(){for(var n=0;!this.eof();){var o=this.readUInt8();if(o&128)n+=o&127,n<<=7;else return n+o}return n},r.prototype.readChunk=function(){var n=this.readString(4),o=this.readUInt32(),a=this.readBytes(o);return{id:n,length:o,data:a}},Sr=i,Sr}var Pr,ii;function ru(){if(ii)return Pr;ii=1;function i(o,a){if(typeof o!="object")throw"Invalid MIDI data";a=a||{};var s=o.header||{},u=o.tracks||[],l,c=u.length,d=new n;for(e(d,s,c),l=0;l<c;l++)t(d,u[l],a);return d.buffer}function e(o,a,s){var u=a.format==null?1:a.format,l=128;a.timeDivision?l=a.timeDivision:a.ticksPerFrame&&a.framesPerSecond?l=-(a.framesPerSecond&255)<<8|a.ticksPerFrame&255:a.ticksPerBeat&&(l=a.ticksPerBeat&32767);var c=new n;c.writeUInt16(u),c.writeUInt16(s),c.writeUInt16(l),o.writeChunk("MThd",c.buffer)}function t(o,a,s){var u=new n,l,c=a.length,d=null;for(l=0;l<c;l++)(s.running===!1||!s.running&&!a[l].running)&&(d=null),d=r(u,a[l],d,s.useByte9ForNoteOff);o.writeChunk("MTrk",u.buffer)}function r(o,a,s,u){var l=a.type,c=a.deltaTime,d=a.text||"",h=a.data||[],p=null;switch(o.writeVarInt(c),l){case"sequenceNumber":o.writeUInt8(255),o.writeUInt8(0),o.writeVarInt(2),o.writeUInt16(a.number);break;case"text":o.writeUInt8(255),o.writeUInt8(1),o.writeVarInt(d.length),o.writeString(d);break;case"copyrightNotice":o.writeUInt8(255),o.writeUInt8(2),o.writeVarInt(d.length),o.writeString(d);break;case"trackName":o.writeUInt8(255),o.writeUInt8(3),o.writeVarInt(d.length),o.writeString(d);break;case"instrumentName":o.writeUInt8(255),o.writeUInt8(4),o.writeVarInt(d.length),o.writeString(d);break;case"lyrics":o.writeUInt8(255),o.writeUInt8(5),o.writeVarInt(d.length),o.writeString(d);break;case"marker":o.writeUInt8(255),o.writeUInt8(6),o.writeVarInt(d.length),o.writeString(d);break;case"cuePoint":o.writeUInt8(255),o.writeUInt8(7),o.writeVarInt(d.length),o.writeString(d);break;case"channelPrefix":o.writeUInt8(255),o.writeUInt8(32),o.writeVarInt(1),o.writeUInt8(a.channel);break;case"portPrefix":o.writeUInt8(255),o.writeUInt8(33),o.writeVarInt(1),o.writeUInt8(a.port);break;case"endOfTrack":o.writeUInt8(255),o.writeUInt8(47),o.writeVarInt(0);break;case"setTempo":o.writeUInt8(255),o.writeUInt8(81),o.writeVarInt(3),o.writeUInt24(a.microsecondsPerBeat);break;case"smpteOffset":o.writeUInt8(255),o.writeUInt8(84),o.writeVarInt(5);var g={24:0,25:32,29:64,30:96},f=a.hour&31|g[a.frameRate];o.writeUInt8(f),o.writeUInt8(a.min),o.writeUInt8(a.sec),o.writeUInt8(a.frame),o.writeUInt8(a.subFrame);break;case"timeSignature":o.writeUInt8(255),o.writeUInt8(88),o.writeVarInt(4),o.writeUInt8(a.numerator);var y=Math.floor(Math.log(a.denominator)/Math.LN2)&255;o.writeUInt8(y),o.writeUInt8(a.metronome),o.writeUInt8(a.thirtyseconds||8);break;case"keySignature":o.writeUInt8(255),o.writeUInt8(89),o.writeVarInt(2),o.writeInt8(a.key),o.writeUInt8(a.scale);break;case"sequencerSpecific":o.writeUInt8(255),o.writeUInt8(127),o.writeVarInt(h.length),o.writeBytes(h);break;case"unknownMeta":a.metatypeByte!=null&&(o.writeUInt8(255),o.writeUInt8(a.metatypeByte),o.writeVarInt(h.length),o.writeBytes(h));break;case"sysEx":o.writeUInt8(240),o.writeVarInt(h.length),o.writeBytes(h);break;case"endSysEx":o.writeUInt8(247),o.writeVarInt(h.length),o.writeBytes(h);break;case"noteOff":var b=u!==!1&&a.byte9||u&&a.velocity==0?144:128;p=b|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.noteNumber),o.writeUInt8(a.velocity);break;case"noteOn":p=144|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.noteNumber),o.writeUInt8(a.velocity);break;case"noteAftertouch":p=160|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.noteNumber),o.writeUInt8(a.amount);break;case"controller":p=176|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.controllerType),o.writeUInt8(a.value);break;case"programChange":p=192|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.programNumber);break;case"channelAftertouch":p=208|a.channel,p!==s&&o.writeUInt8(p),o.writeUInt8(a.amount);break;case"pitchBend":p=224|a.channel,p!==s&&o.writeUInt8(p);var m=8192+a.value,k=m&127,v=m>>7&127;o.writeUInt8(k),o.writeUInt8(v);break;default:throw"Unrecognized event type: "+l}return p}function n(){this.buffer=[]}return n.prototype.writeUInt8=function(o){this.buffer.push(o&255)},n.prototype.writeInt8=n.prototype.writeUInt8,n.prototype.writeUInt16=function(o){var a=o>>8&255,s=o&255;this.writeUInt8(a),this.writeUInt8(s)},n.prototype.writeInt16=n.prototype.writeUInt16,n.prototype.writeUInt24=function(o){var a=o>>16&255,s=o>>8&255,u=o&255;this.writeUInt8(a),this.writeUInt8(s),this.writeUInt8(u)},n.prototype.writeInt24=n.prototype.writeUInt24,n.prototype.writeUInt32=function(o){var a=o>>24&255,s=o>>16&255,u=o>>8&255,l=o&255;this.writeUInt8(a),this.writeUInt8(s),this.writeUInt8(u),this.writeUInt8(l)},n.prototype.writeInt32=n.prototype.writeUInt32,n.prototype.writeBytes=function(o){this.buffer=this.buffer.concat(Array.prototype.slice.call(o,0))},n.prototype.writeString=function(o){var a,s=o.length,u=[];for(a=0;a<s;a++)u.push(o.codePointAt(a));this.writeBytes(u)},n.prototype.writeVarInt=function(o){if(o<0)throw"Cannot write negative variable-length integer";if(o<=127)this.writeUInt8(o);else{var a=o,s=[];for(s.push(a&127),a>>=7;a;){var u=a&127|128;s.push(u),a>>=7}this.writeBytes(s.reverse())}},n.prototype.writeChunk=function(o,a){this.writeString(o),this.writeUInt32(a.length),this.writeBytes(a)},Pr=i,Pr}var oi;function Lo(){return oi||(oi=1,Gt.parseMidi=tu(),Gt.writeMidi=ru()),Gt}var Cr={},lt={},ai;function jo(){if(ai)return lt;ai=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.insert=lt.search=void 0;function i(t,r,n){n===void 0&&(n="ticks");var o=0,a=t.length,s=a;if(a>0&&t[a-1][n]<=r)return a-1;for(;o<s;){var u=Math.floor(o+(s-o)/2),l=t[u],c=t[u+1];if(l[n]===r){for(var d=u;d<t.length;d++){var h=t[d];h[n]===r&&(u=d)}return u}else{if(l[n]<r&&c[n]>r)return u;l[n]>r?s=u:l[n]<r&&(o=u+1)}}return-1}lt.search=i;function e(t,r,n){if(n===void 0&&(n="ticks"),t.length){var o=i(t,r[n],n);t.splice(o+1,0,r)}else t.push(r)}return lt.insert=e,lt}var si;function jr(){return si||(si=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Header=i.keySignatureKeys=void 0;var e=jo(),t=new WeakMap;i.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var r=function(){function n(o){var a=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",t.set(this,480),o){t.set(this,o.header.ticksPerBeat),o.tracks.forEach(function(u){u.forEach(function(l){l.meta&&(l.type==="timeSignature"?a.timeSignatures.push({ticks:l.absoluteTime,timeSignature:[l.numerator,l.denominator]}):l.type==="setTempo"?a.tempos.push({bpm:6e7/l.microsecondsPerBeat,ticks:l.absoluteTime}):l.type==="keySignature"&&a.keySignatures.push({key:i.keySignatureKeys[l.key+7],scale:l.scale===0?"major":"minor",ticks:l.absoluteTime}))})});var s=0;o.tracks[0].forEach(function(u){s+=u.deltaTime,u.meta&&(u.type==="trackName"?a.name=u.text:(u.type==="text"||u.type==="cuePoint"||u.type==="marker"||u.type==="lyrics")&&a.meta.push({text:u.text,ticks:s,type:u.type}))}),this.update()}}return n.prototype.update=function(){var o=this,a=0,s=0;this.tempos.sort(function(u,l){return u.ticks-l.ticks}),this.tempos.forEach(function(u,l){var c=l>0?o.tempos[l-1].bpm:o.tempos[0].bpm,d=u.ticks/o.ppq-s,h=60/c*d;u.time=h+a,a=u.time,s+=d}),this.timeSignatures.sort(function(u,l){return u.ticks-l.ticks}),this.timeSignatures.forEach(function(u,l){var c=l>0?o.timeSignatures[l-1]:o.timeSignatures[0],d=(u.ticks-c.ticks)/o.ppq,h=d/c.timeSignature[0]/(c.timeSignature[1]/4);c.measures=c.measures||0,u.measures=h+c.measures})},n.prototype.ticksToSeconds=function(o){var a=(0,e.search)(this.tempos,o);if(a!==-1){var s=this.tempos[a],u=s.time,l=(o-s.ticks)/this.ppq;return u+60/s.bpm*l}else{var c=o/this.ppq;return 60/120*c}},n.prototype.ticksToMeasures=function(o){var a=(0,e.search)(this.timeSignatures,o);if(a!==-1){var s=this.timeSignatures[a],u=(o-s.ticks)/this.ppq;return s.measures+u/(s.timeSignature[0]/s.timeSignature[1])/4}else return o/this.ppq/4},Object.defineProperty(n.prototype,"ppq",{get:function(){return t.get(this)},enumerable:!1,configurable:!0}),n.prototype.secondsToTicks=function(o){var a=(0,e.search)(this.tempos,o,"time");if(a!==-1){var s=this.tempos[a],u=s.time,l=o-u,c=l/(60/s.bpm);return Math.round(s.ticks+c*this.ppq)}else{var d=o/.5;return Math.round(d*this.ppq)}},n.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(o){return{bpm:o.bpm,ticks:o.ticks}}),timeSignatures:this.timeSignatures}},n.prototype.fromJSON=function(o){this.name=o.name,this.tempos=o.tempos.map(function(a){return Object.assign({},a)}),this.timeSignatures=o.timeSignatures.map(function(a){return Object.assign({},a)}),this.keySignatures=o.keySignatures.map(function(a){return Object.assign({},a)}),this.meta=o.meta.map(function(a){return Object.assign({},a)}),t.set(this,o.ppq),this.update()},n.prototype.setTempo=function(o){this.tempos=[{bpm:o,ticks:0}],this.update()},n}();i.Header=r}(Cr)),Cr}var Ct={},_r={},li;function Uo(){return li||(li=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ControlChange=i.controlChangeIds=i.controlChangeNames=void 0,i.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},i.controlChangeIds=Object.keys(i.controlChangeNames).reduce(function(n,o){return n[i.controlChangeNames[o]]=o,n},{});var e=new WeakMap,t=new WeakMap,r=function(){function n(o,a){e.set(this,a),t.set(this,o.controllerType),this.ticks=o.absoluteTime,this.value=o.value}return Object.defineProperty(n.prototype,"number",{get:function(){return t.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return i.controlChangeNames[this.number]?i.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){var o=e.get(this);return o.ticksToSeconds(this.ticks)},set:function(o){var a=e.get(this);this.ticks=a.secondsToTicks(o)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},n}();i.ControlChange=r}(_r)),_r}var _t={},ci;function nu(){if(ci)return _t;ci=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.createControlChanges=void 0;var i=Uo();function e(){return new Proxy({},{get:function(t,r){if(t[r])return t[r];if(i.controlChangeIds.hasOwnProperty(r))return t[i.controlChangeIds[r]]},set:function(t,r,n){return i.controlChangeIds.hasOwnProperty(r)?t[i.controlChangeIds[r]]=n:t[r]=n,!0}})}return _t.createControlChanges=e,_t}var Tt={},ui;function iu(){if(ui)return Tt;ui=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.PitchBend=void 0;var i=new WeakMap,e=function(){function t(r,n){i.set(this,n),this.ticks=r.absoluteTime,this.value=r.value}return Object.defineProperty(t.prototype,"time",{get:function(){var r=i.get(this);return r.ticksToSeconds(this.ticks)},set:function(r){var n=i.get(this);this.ticks=n.secondsToTicks(r)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},t}();return Tt.PitchBend=e,Tt}var $t={},et={},di;function ou(){return di||(di=1,Object.defineProperty(et,"__esModule",{value:!0}),et.DrumKitByPatchID=et.InstrumentFamilyByID=et.instrumentByPatchID=void 0,et.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],et.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],et.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}),et}var pi;function au(){if(pi)return $t;pi=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.Instrument=void 0;var i=ou(),e=new WeakMap,t=function(){function r(n,o){if(this.number=0,e.set(this,o),this.number=0,n){var a=n.find(function(s){return s.type==="programChange"});a&&(this.number=a.programNumber)}}return Object.defineProperty(r.prototype,"name",{get:function(){return this.percussion?i.DrumKitByPatchID[this.number]:i.instrumentByPatchID[this.number]},set:function(n){var o=i.instrumentByPatchID.indexOf(n);o!==-1&&(this.number=o)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"family",{get:function(){return this.percussion?"drums":i.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"percussion",{get:function(){var n=e.get(this);return n.channel===9},enumerable:!1,configurable:!0}),r.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},r.prototype.fromJSON=function(n){this.number=n.number},r}();return $t.Instrument=t,$t}var It={},hi;function su(){if(hi)return It;hi=1,Object.defineProperty(It,"__esModule",{value:!0}),It.Note=void 0;function i(a){var s=Math.floor(a/12)-1;return e(a)+s.toString()}function e(a){var s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],u=a%12;return s[u]}function t(a){var s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return s.indexOf(a)}var r=function(){var a=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,s={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(u){var l=a.exec(u),c=l[1],d=l[2],h=s[c.toLowerCase()];return h+(parseInt(d,10)+1)*12}}(),n=new WeakMap,o=function(){function a(s,u,l){n.set(this,l),this.midi=s.midi,this.velocity=s.velocity,this.noteOffVelocity=u.velocity,this.ticks=s.ticks,this.durationTicks=u.ticks-s.ticks}return Object.defineProperty(a.prototype,"name",{get:function(){return i(this.midi)},set:function(s){this.midi=r(s)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(s){var u=s-this.octave;this.midi+=u*12},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pitch",{get:function(){return e(this.midi)},set:function(s){this.midi=12*(this.octave+1)+t(s)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){var s=n.get(this);return s.ticksToSeconds(this.ticks+this.durationTicks)-s.ticksToSeconds(this.ticks)},set:function(s){var u=n.get(this),l=u.secondsToTicks(this.time+s);this.durationTicks=l-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){var s=n.get(this);return s.ticksToSeconds(this.ticks)},set:function(s){var u=n.get(this);this.ticks=u.secondsToTicks(s)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bars",{get:function(){var s=n.get(this);return s.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},a}();return It.Note=o,It}var fi;function mi(){if(fi)return Ct;fi=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.Track=void 0;var i=jo(),e=Uo(),t=nu(),r=iu(),n=au(),o=su(),a=new WeakMap,s=function(){function u(l,c){var d=this;if(this.name="",this.notes=[],this.controlChanges=(0,t.createControlChanges)(),this.pitchBends=[],a.set(this,c),l){var h=l.find(function(v){return v.type==="trackName"});this.name=h?h.text:""}if(this.instrument=new n.Instrument(l,this),this.channel=0,l){for(var p=l.filter(function(v){return v.type==="noteOn"}),g=l.filter(function(v){return v.type==="noteOff"}),f=function(){var v=p.shift();y.channel=v.channel;var w=g.findIndex(function(P){return P.noteNumber===v.noteNumber&&P.absoluteTime>=v.absoluteTime});if(w!==-1){var x=g.splice(w,1)[0];y.addNote({durationTicks:x.absoluteTime-v.absoluteTime,midi:v.noteNumber,noteOffVelocity:x.velocity/127,ticks:v.absoluteTime,velocity:v.velocity/127})}},y=this;p.length;)f();var b=l.filter(function(v){return v.type==="controller"});b.forEach(function(v){d.addCC({number:v.controllerType,ticks:v.absoluteTime,value:v.value/127})});var m=l.filter(function(v){return v.type==="pitchBend"});m.forEach(function(v){d.addPitchBend({ticks:v.absoluteTime,value:v.value/Math.pow(2,13)})});var k=l.find(function(v){return v.type==="endOfTrack"});this.endOfTrackTicks=k!==void 0?k.absoluteTime:void 0}}return u.prototype.addNote=function(l){var c=a.get(this),d=new o.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},c);return Object.assign(d,l),(0,i.insert)(this.notes,d,"ticks"),this},u.prototype.addCC=function(l){var c=a.get(this),d=new e.ControlChange({controllerType:l.number},c);return delete l.number,Object.assign(d,l),Array.isArray(this.controlChanges[d.number])||(this.controlChanges[d.number]=[]),(0,i.insert)(this.controlChanges[d.number],d,"ticks"),this},u.prototype.addPitchBend=function(l){var c=a.get(this),d=new r.PitchBend({},c);return Object.assign(d,l),(0,i.insert)(this.pitchBends,d,"ticks"),this},Object.defineProperty(u.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var l=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,c=0;c<this.notes.length-1;c++){var d=this.notes[c].time+this.notes[c].duration;l<d&&(l=d)}return l},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var l=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,c=0;c<this.notes.length-1;c++){var d=this.notes[c].ticks+this.notes[c].durationTicks;l<d&&(l=d)}return l},enumerable:!1,configurable:!0}),u.prototype.fromJSON=function(l){var c=this;this.name=l.name,this.channel=l.channel,this.instrument=new n.Instrument(void 0,this),this.instrument.fromJSON(l.instrument),l.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=l.endOfTrackTicks);for(var d in l.controlChanges)l.controlChanges[d]&&l.controlChanges[d].forEach(function(h){c.addCC({number:h.number,ticks:h.ticks,value:h.value})});l.notes.forEach(function(h){c.addNote({durationTicks:h.durationTicks,midi:h.midi,ticks:h.ticks,velocity:h.velocity})})},u.prototype.toJSON=function(){for(var l={},c=0;c<127;c++)this.controlChanges.hasOwnProperty(c)&&(l[c]=this.controlChanges[c].map(function(h){return h.toJSON()}));var d={channel:this.channel,controlChanges:l,pitchBends:this.pitchBends.map(function(h){return h.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(h){return h.toJSON()})};return this.endOfTrackTicks!==void 0&&(d.endOfTrackTicks=this.endOfTrackTicks),d},u}();return Ct.Track=s,Ct}var ct={};function lu(i){var e=[];return Bo(i,e),e}function Bo(i,e){for(var t=0;t<i.length;t++){var r=i[t];Array.isArray(r)?Bo(r,e):e.push(r)}}const cu=Object.freeze(Object.defineProperty({__proto__:null,flatten:lu},Symbol.toStringTag,{value:"Module"})),uu=Cs(cu);var gi;function du(){if(gi)return ct;gi=1;var i=ct&&ct.__spreadArray||function(b,m,k){if(k||arguments.length===2)for(var v=0,w=m.length,x;v<w;v++)(x||!(v in m))&&(x||(x=Array.prototype.slice.call(m,0,v)),x[v]=m[v]);return b.concat(x||Array.prototype.slice.call(m))};Object.defineProperty(ct,"__esModule",{value:!0}),ct.encode=void 0;var e=Lo(),t=jr(),r=uu;function n(b,m){return[{absoluteTime:b.ticks,channel:m,deltaTime:0,noteNumber:b.midi,type:"noteOn",velocity:Math.floor(b.velocity*127)},{absoluteTime:b.ticks+b.durationTicks,channel:m,deltaTime:0,noteNumber:b.midi,type:"noteOff",velocity:Math.floor(b.noteOffVelocity*127)}]}function o(b){return(0,r.flatten)(b.notes.map(function(m){return n(m,b.channel)}))}function a(b,m){return{absoluteTime:b.ticks,channel:m,controllerType:b.number,deltaTime:0,type:"controller",value:Math.floor(b.value*127)}}function s(b){for(var m=[],k=0;k<127;k++)b.controlChanges.hasOwnProperty(k)&&b.controlChanges[k].forEach(function(v){m.push(a(v,b.channel))});return m}function u(b,m){return{absoluteTime:b.ticks,channel:m,deltaTime:0,type:"pitchBend",value:b.value}}function l(b){var m=[];return b.pitchBends.forEach(function(k){m.push(u(k,b.channel))}),m}function c(b){return{absoluteTime:0,channel:b.channel,deltaTime:0,programNumber:b.instrument.number,type:"programChange"}}function d(b){return{absoluteTime:0,deltaTime:0,meta:!0,text:b,type:"trackName"}}function h(b){return{absoluteTime:b.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/b.bpm),type:"setTempo"}}function p(b){return{absoluteTime:b.ticks,deltaTime:0,denominator:b.timeSignature[1],meta:!0,metronome:24,numerator:b.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function g(b){var m=t.keySignatureKeys.indexOf(b.key);return{absoluteTime:b.ticks,deltaTime:0,key:m+7,meta:!0,scale:b.scale==="major"?0:1,type:"keySignature"}}function f(b){return{absoluteTime:b.ticks,deltaTime:0,meta:!0,text:b.text,type:b.type}}function y(b){var m={header:{format:1,numTracks:b.tracks.length+1,ticksPerBeat:b.header.ppq},tracks:i([i(i(i(i([{absoluteTime:0,deltaTime:0,meta:!0,text:b.header.name,type:"trackName"}],b.header.keySignatures.map(function(k){return g(k)}),!0),b.header.meta.map(function(k){return f(k)}),!0),b.header.tempos.map(function(k){return h(k)}),!0),b.header.timeSignatures.map(function(k){return p(k)}),!0)],b.tracks.map(function(k){return i(i(i([d(k.name),c(k)],o(k),!0),s(k),!0),l(k),!0)}),!0)};return m.tracks=m.tracks.map(function(k){k=k.sort(function(w,x){return w.absoluteTime-x.absoluteTime});var v=0;return k.forEach(function(w){w.deltaTime=w.absoluteTime-v,v=w.absoluteTime,delete w.absoluteTime}),k.push({deltaTime:0,meta:!0,type:"endOfTrack"}),k}),new Uint8Array((0,e.writeMidi)(m))}return ct.encode=y,ct}var yi;function pu(){return yi||(yi=1,function(i){var e=st&&st.__awaiter||function(d,h,p,g){function f(y){return y instanceof p?y:new p(function(b){b(y)})}return new(p||(p=Promise))(function(y,b){function m(w){try{v(g.next(w))}catch(x){b(x)}}function k(w){try{v(g.throw(w))}catch(x){b(x)}}function v(w){w.done?y(w.value):f(w.value).then(m,k)}v((g=g.apply(d,h||[])).next())})},t=st&&st.__generator||function(d,h){var p={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},g,f,y,b;return b={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(b[Symbol.iterator]=function(){return this}),b;function m(v){return function(w){return k([v,w])}}function k(v){if(g)throw new TypeError("Generator is already executing.");for(;p;)try{if(g=1,f&&(y=v[0]&2?f.return:v[0]?f.throw||((y=f.return)&&y.call(f),0):f.next)&&!(y=y.call(f,v[1])).done)return y;switch(f=0,y&&(v=[v[0]&2,y.value]),v[0]){case 0:case 1:y=v;break;case 4:return p.label++,{value:v[1],done:!1};case 5:p.label++,f=v[1],v=[0];continue;case 7:v=p.ops.pop(),p.trys.pop();continue;default:if(y=p.trys,!(y=y.length>0&&y[y.length-1])&&(v[0]===6||v[0]===2)){p=0;continue}if(v[0]===3&&(!y||v[1]>y[0]&&v[1]<y[3])){p.label=v[1];break}if(v[0]===6&&p.label<y[1]){p.label=y[1],y=v;break}if(y&&p.label<y[2]){p.label=y[2],p.ops.push(v);break}y[2]&&p.ops.pop(),p.trys.pop();continue}v=h.call(d,p)}catch(w){v=[6,w],f=0}finally{g=y=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0}),i.Header=i.Track=i.Midi=void 0;var r=Lo(),n=jr(),o=mi(),a=du(),s=function(){function d(h){var p=this,g=null;if(h){var f=h instanceof ArrayBuffer?new Uint8Array(h):h;g=(0,r.parseMidi)(f),g.tracks.forEach(function(y){var b=0;y.forEach(function(m){b+=m.deltaTime,m.absoluteTime=b})}),g.tracks=c(g.tracks)}this.header=new n.Header(g),this.tracks=[],h&&(this.tracks=g.tracks.map(function(y){return new o.Track(y,p.header)}),g.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return d.fromUrl=function(h){return e(this,void 0,void 0,function(){var p,g;return t(this,function(f){switch(f.label){case 0:return[4,fetch(h)];case 1:return p=f.sent(),p.ok?[4,p.arrayBuffer()]:[3,3];case 2:return g=f.sent(),[2,new d(g)];case 3:throw new Error("Could not load '".concat(h,"'"))}})})},Object.defineProperty(d.prototype,"name",{get:function(){return this.header.name},set:function(h){this.header.name=h},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"duration",{get:function(){var h=this.tracks.map(function(p){return p.duration});return Math.max.apply(Math,h)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"durationTicks",{get:function(){var h=this.tracks.map(function(p){return p.durationTicks});return Math.max.apply(Math,h)},enumerable:!1,configurable:!0}),d.prototype.addTrack=function(){var h=new o.Track(void 0,this.header);return this.tracks.push(h),h},d.prototype.toArray=function(){return(0,a.encode)(this)},d.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(h){return h.toJSON()})}},d.prototype.fromJSON=function(h){var p=this;this.header=new n.Header,this.header.fromJSON(h.header),this.tracks=h.tracks.map(function(g){var f=new o.Track(void 0,p.header);return f.fromJSON(g),f})},d.prototype.clone=function(){var h=new d;return h.fromJSON(this.toJSON()),h},d}();i.Midi=s;var u=mi();Object.defineProperty(i,"Track",{enumerable:!0,get:function(){return u.Track}});var l=jr();Object.defineProperty(i,"Header",{enumerable:!0,get:function(){return l.Header}});function c(d){for(var h=[],p=0;p<d.length;p++)for(var g=h.length,f=new Map,y=Array(16).fill(0),b=0,m=d[p];b<m.length;b++){var k=m[b],v=g,w=k.channel;if(w!==void 0){k.type==="programChange"&&(y[w]=k.programNumber);var x=y[w],P="".concat(x," ").concat(w);f.has(P)?v=f.get(P):(v=g+f.size,f.set(P,v))}h[v]||h.push([]),h[v].push(k)}return h}}(st)),st}var qo=pu();const hu=G({prev:D($),delay:D($),next:ee($)}),on=new Z({typeName:"Delay",typeSchema:hu}),fu=G({next:ee($)}),an=new Z({typeName:"Start",typeSchema:fu}),mu=G({value:Be(),out:ee($)}),Ot=new Z({typeName:"Number",typeSchema:mu}),gu=G({id:Qe(),prev:D($),value:D($),next:ee($)}),sn=new Z({typeName:"SetVariable",typeSchema:gu}),yu=G({id:Qe(),value:ee($)}),ln=new Z({typeName:"Variable",typeSchema:yu}),bu=G({frequency:D($),out:ee($)}),cn=new Z({typeName:"Meow",typeSchema:bu}),vu=G({in:D($)}),un=new Z({typeName:"Speaker",typeSchema:vu});async function ku(i,e){let t=[],r=new qo.Midi(await e.arrayBuffer());for(let f of r.tracks)for(let y of f.notes)t.push({time:y.time,type:"NoteOn",note:y.midi}),t.push({time:y.time+y.duration,type:"NoteOff",note:y.midi});t.sort((f,y)=>f.time-y.time);let n=1e3,o=new Set,a=new Map,s=0;for(let f of t){let y=a.get(f.time);if(y==null?(y=[f],a.set(f.time,y)):y.push(f),o.add(f.note),++s,s>=n)break}let u=0,l=0,c,d;{let f=an.create({next:[]});d=b=>{f.setState("next",m=>[...m,b])},c={target:i.createEntity([f,Se.create({transform:me.create(B.create(l,0),he.rot0)})]),pin:"next"}}l+=200;let h=[],p,g=-200;for(let f=21;f<=108;++f){if(!o.has(f))continue;let y=261.63*Math.pow(2,(f-60)/12),b=Ot.create({value:y,out:[]}),m=i.createEntity([b,Se.create({transform:me.create(B.create(l,g),he.rot0)})]);h[f]={id:m,c:b},g-=100}{let f=Ot.create({value:0,out:[]});p={id:i.createEntity([f,Se.create({transform:me.create(B.create(l,g),he.rot0)})]),c:f}}for(let f=21;f<=108;++f){if(!o.has(f))continue;let y=ln.create({id:`n${f}`,value:[]}),b=i.createEntity([y,Se.create({transform:me.create(B.create(l,g),he.rot0)})]),m=cn.create({frequency:{target:b,pin:"value"},out:[]}),k=i.createEntity([m,Se.create({transform:me.create(B.create(l+150,g),he.rot0)})]);y.setState("value",[{target:k,pin:"frequency"}]);let v=un.create({in:{target:k,pin:"out"}}),w=i.createEntity([v,Se.create({transform:me.create(B.create(l+300,g),he.rot0)})]);m.setState("out",[{target:w,pin:"in"}]),g-=100}for(let[f,y]of a.entries()){let b=f-u;u=f;{let m=on.create({prev:c,delay:void 0,next:[]});d=x=>{m.setState("next",P=>[...P,x])};let k=i.createEntity([m,Se.create({transform:me.create(B.create(l,0),he.rot0)})]),v=i.createEntity([Ot.create({value:b*1e3,out:[{target:k,pin:"delay"}]}),Se.create({transform:me.create(B.create(l,-100),he.rot0)})]);m.setState("delay",{target:v,pin:"out"}),c={target:k,pin:"next"};let w=-250;for(let x of y){x.type=="NoteOn"&&261.63*Math.pow(2,(x.note-128)/12);let P=sn.create({id:`n${x.note}`,prev:{...c},value:void 0,next:[]}),C=i.createEntity([P,Se.create({transform:me.create(B.create(l,w),he.rot0)})]);if(x.type=="NoteOn"){let T=h[x.note];T.c.setState("out",M=>[...M,{target:C,pin:"value"}]),P.setState("value",{target:T.id,pin:"out"})}else p.c.setState("out",T=>[...T,{target:C,pin:"value"}]),P.setState("value",{target:p.id,pin:"out"});d({target:C,pin:"prev"}),w-=200}}if(l+=200,n-=y.length,await new Promise(m=>requestAnimationFrame(()=>m())),n<=0)break}}const wu=G({a:D($),b:D($),out:ee($)}),Vo=new Z({typeName:"Add",typeSchema:wu});class xu{componentType=Vo;ext={};create(e){return new Su(e)}}const Go=new xu;class Su{type=Go;nodeParams;inputPins;outputPins;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"a",source:()=>t.a,setSource:n=>r("a",n)},{name:"b",source:()=>t.b,setSource:n=>r("b",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("a");if(a==null)return[];let s=o.get("b");if(s==null)return[];let u=n.allocField("0.0");n.insertCode([`${u} = ${a} + ${s}`]);let l=new Map;return l.set("out",u),[{outputAtoms:l}]}}}}const Pu=G({timeToOne:D($),out:ee($)}),Wo=new Z({typeName:"Attack",typeSchema:Pu});class Cu{componentType=Wo;ext={};create(e){return new _u(e)}}const Ho=new Cu;class _u{type=Ho;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"timeToOne",source:()=>t.timeToOne,setSource:n=>r("timeToOne",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}])}}class Tu{componentType=on;ext={};create(e){return new $u(e)}}const Yo=new Tu;class $u{type=Yo;nodeParams;inputPins;outputPins;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"prev",source:()=>t.prev,setSource:n=>r("prev",n),isEffectPin:!0},{name:"delay",source:()=>t.delay,setSource:n=>r("delay",n)}]),this.outputPins=S(()=>[{name:"next",sinks:()=>t.next,setSinks:n=>r("next",n),isEffectPin:!0}]),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let s=o.get("prev");if(s==null)return[];let u=o.get("delay");if(u==null)return[];let l=`this.n_${a}_next`;n.addDeclToExistingForField(l,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`);let c=n.allocField("0.0");n.insertConstructorCode([`${s}.onDone.push(() => {`,`  ${c} = currentTime * 1000.0;`,`  this.insertRunningEffect(${l});`,"});",`${l}.update = () => {`,`  let time = currentTime * 1000.0 - ${c};`,"  // return true when done.",`  return time >= ${u};`,"};"]);let d=`${l}`,h=new Map;return h.set("next",d),[{outputAtoms:h}]}}}}const Iu=G({prev:D($),entry:D($),next:ee($)}),Xo=new Z({typeName:"Goto",typeSchema:Iu});class Eu{componentType=Xo;ext={};create(e){return new Ru(e)}}const Ko=new Eu;class Ru{type=Ko;nodeParams;inputPins;outputPins;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"prev",source:()=>t.prev,setSource:n=>r("prev",n),isEffectPin:!0},{name:"entry",source:()=>t.entry,setSource:n=>r("entry",n),isEffectPin:!0}]),this.outputPins=S(()=>[{name:"next",sinks:()=>t.next,setSinks:n=>r("next",n),isEffectPin:!0}]),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let s=o.get("prev");if(s==null)return[];let u=o.get("entry");if(u==null)return[];let l=`this.n_${a}_next`;n.addDeclToExistingForField(l,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),n.insertConstructorCode([`${s}.onDone.push(() => {`,`  this.insertRunningEffect(${l});`,"});",`${u}.onDone.push(() => {`,`  this.insertRunningEffect(${l});`,"});",`${l}.update = () => true;`]);let c=`${l}`,d=new Map;return d.set("next",c),[{outputAtoms:d}]}}}}const Mu=G({out:ee($)}),dn=new Z({typeName:"Knob",typeSchema:Mu});var Au=q(`<svg version=1.1 viewBox="-16 -16 32 32"><defs><linearGradient id=shape-fill x1=0 x2=0 y1=0 y2=1><stop offset=0% stop-color="rgb(80, 80, 81)"></stop><stop offset=100% stop-color="rgb(30, 30, 31)"></stop></linearGradient><path id=shape d="
        M14.876 -5.890A-16 -16 0 0 0 14.876 5.890A16 16 0 0 112.539 9.938A-16 -16 0 0 0 2.337 15.828
        A16 16 0 0 1-2.337 15.828A-16 -16 0 0 0 -12.539 9.938A16 16 0 0 1-14.876 5.890A-16 -16 0 0 0 -14.876 -5.890
        A16 16 0 0 1-12.539 -9.938A-16 -16 0 0 0 -2.337 -15.828A16 16 0 0 12.337 -15.828A-16 -16 0 0 0 12.539 -9.938
        A16 16 0 0 114.876 -5.890"></path><clipPath id=shape-mask style="transform:rotate(var(--rot)) scale(0.87)"><use href=#shape></use></clipPath><filter id=lights></filter><filter id=shadow></filter></defs><circle cx=0 cy=0 r=15.0 fill="rgb(36, 36, 37)"stroke="rgb(28, 28, 29)"stroke-width=0.5></circle><g filter=url(#shadow)><g filter=url(#lights)><g clip-path=url(#shape-mask)><rect x=-16 y=-16 width=32 height=32 fill=url(#shape-fill)></rect><circle cx=-28 cy=-28 r=32 fill="rgba(250, 250, 255, .16)"></circle></g></g></g><g style=transform:rotate(var(--rot))><circle cx=0 cy=-11 r=1.1 fill=black></circle><circle cx=0 cy=-11 r=0.8 fill=white></circle></g><circle cx=0 cy=0 r=9 stroke="rgb(50, 50, 51)"stroke-width=0.7 fill=none></circle><foreignObject x=-9 y=-9 width=18 height=18><div style=width:18px;height:18px;border-radius:50%;background-image:conic-gradient(#aaa,#666,#aaa,#666,#aaa,#666,#aaa);>`);const Nu=i=>{let[e,t]=_e({dragging:void 0}),[r,n]=K();be(()=>{e.dragging&&i.setDisablePan(!1)});let o=-165,a=-o,s=S(()=>o+(i.value-i.minValue)*(a-o)/(i.maxValue-i.minValue)),u=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");u.setAttribute("dx","-0.3"),u.setAttribute("dy","-0.3"),u.setAttribute("stdDeviation","0.1"),u.setAttribute("flood-opacity","0.7"),u.setAttribute("flood-color","white");let l=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");l.setAttribute("dx","1.5"),l.setAttribute("dy","1.5"),l.setAttribute("stdDeviation","0.5"),l.setAttribute("flood-opacity","0.9"),l.setAttribute("flood-color","black");let c=p=>{let g=r(),f=g.getBoundingClientRect(),y=p.clientX-f.left,b=p.clientY-f.top,m=y-.5*f.width,k=b-.5*f.width;console.log("x",y.toFixed()),console.log("y",b.toFixed()),console.log("dx",m.toFixed()),console.log("dy",k.toFixed());let v=m*m+k*k;if(v>f.width*f.width)return;let w=Math.sqrt(v),P=360/(2*Math.PI*w),C=k>0?-P:P,T=m>0?P:-P;t("dragging",new Lt({pointerId:p.pointerId,startX:y,startY:b,startValue:i.value,dadx:C,dady:T})),g.setPointerCapture(p.pointerId),i.setDisablePan(!0)},d=p=>{if(e.dragging==null||p.pointerId!=e.dragging.value.pointerId)return;let g=r(),f=e.dragging.value,y=g.getBoundingClientRect(),b=p.clientX-y.left,m=p.clientY-y.top,k=o+(f.startValue-i.minValue)*(a-o)/(i.maxValue-i.minValue)+(b-f.startX)*f.dadx+(m-f.startY)*f.dady,v=i.minValue+(k-o)*(i.maxValue-i.minValue)/(a-o);v=Math.max(i.minValue,Math.min(i.maxValue,v)),i.setValue(v)},h=p=>{e.dragging!=null&&e.dragging.value.pointerId==p.pointerId&&(r().releasePointerCapture(e.dragging.value.pointerId),i.setDisablePan(!1))};return(()=>{var p=Au(),g=p.firstChild,f=g.firstChild,y=f.nextSibling,b=y.nextSibling,m=b.nextSibling,k=m.nextSibling;p.$$pointerup=h,p.$$pointermove=d,p.$$pointerdown=c;var v=n;return typeof v=="function"?ge(v,p):n=p,p.style.setProperty("user-select","none"),p.style.setProperty("outline","none"),H(m,u),H(k,l),Q(w=>{var x=`${i.size}px`,P=`${i.size}px`,C=`${s()}deg`;return x!==w.e&&((w.e=x)!=null?p.style.setProperty("width",x):p.style.removeProperty("width")),P!==w.t&&((w.t=P)!=null?p.style.setProperty("height",P):p.style.removeProperty("height")),C!==w.a&&((w.a=C)!=null?p.style.setProperty("--rot",C):p.style.removeProperty("--rot")),w},{e:void 0,t:void 0,a:void 0}),p})()};ke(["pointerdown","pointermove","pointerup"]);var Ou=q("<div><div><label class=input>min<input type=text value=0.00></label><label class=input>max<input type=text value=1.00></label><label class=input>value<input type=text>");class Fu{componentType=dn;ext;constructor(){this.ext={generateInitOnceCode:({ctx:e})=>{e.insertGlobalCode(["let knobValues = {};"]),e.insertMessageHandlerCode("KnobChange",["knobValues[params.id] = params.value;"])}}}create(e){return new Du(e)}}const Zo=new Fu;class Du{type=Zo;nodeParams;outputPins;ui;disablePan;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:u=>r("out",u)}]);let[n,o]=K(!1),[a,s]=K();this.ui=S(()=>()=>{let[u,l]=K(0);le(ie(u,d=>{let h=a();h?.port.postMessage({type:"KnobChange",params:{id:`${e.entity}`,value:d}})})),be(()=>o(!1));let c=100;return(()=>{var d=Ou(),h=d.firstChild,p=h.firstChild,g=p.nextSibling,f=g.nextSibling,y=f.firstChild,b=y.nextSibling;return h.style.setProperty("max-width","100px"),H(d,I(Nu,{size:c,indentSize:10,minValue:0,maxValue:1,get value(){return u()},setValue:l,setDisablePan:o}),null),Q(()=>b.value=u().toFixed(2)),d})()}),this.disablePan=n,this.ext={init:async u=>{s(u)},generateCode:({ctx:u})=>{u.insertGlobalCode([`knobValues["${e.entity}"] = 0.0;`]);let l=`knobValues["${e.entity}"]`,c=new Map;return c.set("out",l),[{outputAtoms:c}]}}}}var Tr={exports:{}},bi;function zu(){return bi||(bi=1,function(i,e){(function(t,r){i.exports=r()})(window,function(){return function(t){var r={};function n(o){if(r[o])return r[o].exports;var a=r[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=r,n.d=function(o,a,s){n.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:s})},n.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},n.t=function(o,a){if(1&a&&(o=n(o)),8&a||4&a&&typeof o=="object"&&o&&o.__esModule)return o;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:o}),2&a&&typeof o!="string")for(var u in o)n.d(s,u,function(l){return o[l]}.bind(null,u));return s},n.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return n.d(a,"a",a),a},n.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},n.p="",n(n.s="./src/index.ts")}({"./src/chunk.ts":function(t,r,n){n.r(r),n.d(r,"SF2Chunk",function(){return p});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=n("./src/chunks/index.ts");function u(g){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(g)}function l(g,f){for(var y=0;y<f.length;y++){var b=f[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}function c(g){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(g)}function d(g,f){return(d=Object.setPrototypeOf||function(y,b){return y.__proto__=b,y})(g,f)}function h(g){if(g===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}var p=function(g){function f(m){var k,v,w,x,P,C;return function(T,M){if(!(T instanceof M))throw new TypeError("Cannot call a class as a function")}(this,f),v=this,k=!(w=c(f).call(this,m.id,m.length,m.buffer,m.subChunks))||u(w)!=="object"&&typeof w!="function"?h(v):w,x=h(h(k)),C=void 0,(P="subChunks")in x?Object.defineProperty(x,P,{value:C,enumerable:!0,configurable:!0,writable:!0}):x[P]=C,k.subChunks=m.subChunks.map(function(T){return new f(T)}),k}var y,b;return function(m,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(k&&k.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),k&&d(m,k)}(f,g),y=f,(b=[{key:"getMetaData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var m=this.subChunks.reduce(function(k,v){if(v.id==="ifil"||v.id==="iver"){if(v.length!==a.SF_VERSION_LENGTH)throw new o.ParseError("Invalid size for the '".concat(v.id,"' sub-chunk"));k[v.id]="".concat(v.getInt16(),".").concat(v.getInt16(2))}else k[v.id]=v.getString();return k},{});if(!m.ifil)throw new o.ParseError("Missing required 'ifil' sub-chunk");if(!m.INAM)throw new o.ParseError("Missing required 'INAM' sub-chunk");return{version:m.ifil,soundEngine:m.isng||"EMU8000",name:m.INAM,rom:m.irom,romVersion:m.iver,creationDate:m.ICRD,author:m.IENG,product:m.IPRD,copyright:m.ICOP,comments:m.ICMT,createdBy:m.ISFT}}},{key:"getSampleData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));var m=this.subChunks[0];if(m.id!=="smpl")throw new o.ParseError("Invalid chunk signature","'smpl'","'".concat(m.id,"'"));return m.buffer}},{key:"getPresetData",value:function(){if(this.id!=="LIST")throw new o.ParseError("Unexpected chunk ID","'LIST'","'".concat(this.id,"'"));return{presetHeaders:Object(s.getPresetHeaders)(this.subChunks[0]),presetZones:Object(s.getZones)(this.subChunks[1],"pbag"),presetModulators:Object(s.getModulators)(this.subChunks[2],"pmod"),presetGenerators:Object(s.getGenerators)(this.subChunks[3],"pgen"),instrumentHeaders:Object(s.getInstrumentHeaders)(this.subChunks[4]),instrumentZones:Object(s.getZones)(this.subChunks[5],"ibag"),instrumentModulators:Object(s.getModulators)(this.subChunks[6],"imod"),instrumentGenerators:Object(s.getGenerators)(this.subChunks[7],"igen"),sampleHeaders:Object(s.getSampleHeaders)(this.subChunks[8])}}}])&&l(y.prototype,b),f}(o.RIFFChunk)},"./src/chunks/generators.ts":function(t,r,n){n.r(r),n.d(r,"getGenerators",function(){return d});var o=n("./src/riff/index.ts"),a=n("./src/types/index.ts"),s=n("./src/constants.ts"),u=[a.GeneratorType.StartAddrsOffset,a.GeneratorType.EndAddrsOffset,a.GeneratorType.StartLoopAddrsOffset,a.GeneratorType.EndLoopAddrsOffset,a.GeneratorType.StartAddrsCoarseOffset,a.GeneratorType.EndAddrsCoarseOffset,a.GeneratorType.StartLoopAddrsCoarseOffset,a.GeneratorType.KeyNum,a.GeneratorType.Velocity,a.GeneratorType.EndLoopAddrsCoarseOffset,a.GeneratorType.SampleModes,a.GeneratorType.ExclusiveClass,a.GeneratorType.OverridingRootKey],l=[a.GeneratorType.Unused1,a.GeneratorType.Unused2,a.GeneratorType.Unused3,a.GeneratorType.Unused4,a.GeneratorType.Reserved1,a.GeneratorType.Reserved2,a.GeneratorType.Reserved3],c=[a.GeneratorType.KeyRange,a.GeneratorType.VelRange],d=function(h,p){if(h.id!==p)throw new o.ParseError("Unexpected chunk ID","'".concat(p,"'"),"'".concat(h.id,"'"));if(h.length%s.SF_GENERATOR_SIZE)throw new o.ParseError("Invalid size for the '".concat(p,"' sub-chunk"));return h.iterate(function(g){var f=g.getInt16();return a.GeneratorType[f]?p==="pgen"&&u.includes(f)||p==="igen"&&l.includes(f)?null:c.includes(f)?{id:f,range:{lo:g.getByte(),hi:g.getByte()}}:{id:f,value:g.getInt16BE()}:null})}},"./src/chunks/index.ts":function(t,r,n){n.r(r);var o=n("./src/chunks/instruments/index.ts");n.d(r,"getInstrumentHeaders",function(){return o.getInstrumentHeaders});var a=n("./src/chunks/presets/index.ts");n.d(r,"getPresetHeaders",function(){return a.getPresetHeaders});var s=n("./src/chunks/samples/index.ts");n.d(r,"getSampleHeaders",function(){return s.getSampleHeaders});var u=n("./src/chunks/generators.ts");n.d(r,"getGenerators",function(){return u.getGenerators});var l=n("./src/chunks/modulators.ts");n.d(r,"getModulators",function(){return l.getModulators});var c=n("./src/chunks/zones.ts");n.d(r,"getZones",function(){return c.getZones}),n.d(r,"getItemsInZone",function(){return c.getItemsInZone})},"./src/chunks/instruments/headers.ts":function(t,r,n){n.r(r),n.d(r,"getInstrumentHeaders",function(){return s});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=function(u){if(u.id!=="inst")throw new o.ParseError("Unexpected chunk ID","'inst'","'".concat(u.id,"'"));if(u.length%a.SF_INSTRUMENT_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'inst' sub-chunk");return u.iterate(function(l){return{name:l.getString(),bagIndex:l.getInt16()}})}},"./src/chunks/instruments/index.ts":function(t,r,n){n.r(r);var o=n("./src/chunks/instruments/headers.ts");n.d(r,"getInstrumentHeaders",function(){return o.getInstrumentHeaders})},"./src/chunks/modulators.ts":function(t,r,n){n.r(r),n.d(r,"getModulators",function(){return u});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=function(l){return{type:l>>10&63,polarity:l>>9&1,direction:l>>8&1,palette:l>>7&1,index:127&l}},u=function(l,c){if(l.id!==c)throw new o.ParseError("Unexpected chunk ID","'".concat(c,"'"),"'".concat(l.id,"'"));if(l.length%a.SF_MODULATOR_SIZE)throw new o.ParseError("Invalid size for the '".concat(c,"' sub-chunk"));return l.iterate(function(d){return{source:s(d.getInt16BE()),id:d.getInt16BE(),value:d.getInt16BE(),valueSource:s(d.getInt16BE()),transform:d.getInt16BE()}})}},"./src/chunks/presets/headers.ts":function(t,r,n){n.r(r),n.d(r,"getPresetHeaders",function(){return s});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=function(u){if(u.id!=="phdr")throw new o.ParseError("Invalid chunk ID","'phdr'","'".concat(u.id,"'"));if(u.length%a.SF_PRESET_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'phdr' sub-chunk");return u.iterate(function(l){return{name:l.getString(),preset:l.getInt16(),bank:l.getInt16(),bagIndex:l.getInt16(),library:l.getUInt32(),genre:l.getUInt32(),morphology:l.getUInt32()}})}},"./src/chunks/presets/index.ts":function(t,r,n){n.r(r);var o=n("./src/chunks/presets/headers.ts");n.d(r,"getPresetHeaders",function(){return o.getPresetHeaders})},"./src/chunks/samples/headers.ts":function(t,r,n){n.r(r),n.d(r,"getSampleHeaders",function(){return s});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=function(u){if(u.id!=="shdr")throw new o.ParseError("Unexpected chunk ID","'shdr'","'".concat(u.id,"'"));if(u.length%a.SF_SAMPLE_HEADER_SIZE)throw new o.ParseError("Invalid size for the 'shdr' sub-chunk");return u.iterate(function(l){return{name:l.getString(),start:l.getUInt32(),end:l.getUInt32(),startLoop:l.getUInt32(),endLoop:l.getUInt32(),sampleRate:l.getUInt32(),originalPitch:l.getByte(),pitchCorrection:l.getChar(),link:l.getInt16(),type:l.getInt16()}})}},"./src/chunks/samples/index.ts":function(t,r,n){n.r(r);var o=n("./src/chunks/samples/headers.ts");n.d(r,"getSampleHeaders",function(){return o.getSampleHeaders})},"./src/chunks/zones.ts":function(t,r,n){n.r(r),n.d(r,"getZones",function(){return u}),n.d(r,"getItemsInZone",function(){return l});var o=n("./src/riff/index.ts"),a=n("./src/constants.ts"),s=n("./src/types/index.ts"),u=function(p,g){if(p.id!==g)throw new o.ParseError("Unexpected chunk ID","'".concat(g,"'"),"'".concat(p.id,"'"));if(p.length%a.SF_BAG_SIZE)throw new o.ParseError("Invalid size for the '".concat(g,"' sub-chunk"));return p.iterate(function(f){return{generatorIndex:f.getInt16(),modulatorIndex:f.getInt16()}})},l=function(p,g,f,y,b,m){for(var k=[],v=0;v<p.length;v++){for(var w=p[v],x=p[v+1],P=w.bagIndex,C=x?x.bagIndex:g.length,T=[],M=void 0,_=P;_<C;_++){var E=c(_,g,f),O=d(_,g,y),F=O[s.GeneratorType.KeyRange]&&O[s.GeneratorType.KeyRange].range,R=O[m];if(R){var z=b[R.value];z&&T.push({keyRange:F,modulators:E,generators:O,reference:z})}else _-P==0&&(M={keyRange:F,modulators:E,generators:O})}k.push({header:w,globalZone:M,zones:T})}return k},c=function(p,g,f){var y=g[p],b=g[p+1],m=y.modulatorIndex,k=b?b.modulatorIndex:g.length;return h(m,k,f)},d=function(p,g,f){var y=g[p],b=g[p+1],m=y.generatorIndex,k=b?b.generatorIndex:g.length;return h(m,k,f)},h=function(p,g,f){for(var y={},b=p;b<g;b++){var m=f[b];m&&(y[m.id]=m)}return y}},"./src/constants.ts":function(t,r,n){n.r(r),n.d(r,"SF_VERSION_LENGTH",function(){return o}),n.d(r,"SF_PRESET_HEADER_SIZE",function(){return a}),n.d(r,"SF_BAG_SIZE",function(){return s}),n.d(r,"SF_MODULATOR_SIZE",function(){return u}),n.d(r,"SF_GENERATOR_SIZE",function(){return l}),n.d(r,"SF_INSTRUMENT_HEADER_SIZE",function(){return c}),n.d(r,"SF_SAMPLE_HEADER_SIZE",function(){return d}),n.d(r,"DEFAULT_SAMPLE_RATE",function(){return h});var o=4,a=38,s=4,u=10,l=4,c=22,d=46,h=22050},"./src/index.ts":function(t,r,n){n.r(r);var o=n("./src/types/index.ts");for(var a in o)["default"].indexOf(a)<0&&function(c){n.d(r,c,function(){return o[c]})}(a);var s=n("./src/chunk.ts");n.d(r,"SF2Chunk",function(){return s.SF2Chunk});var u=n("./src/constants.ts");n.d(r,"SF_VERSION_LENGTH",function(){return u.SF_VERSION_LENGTH}),n.d(r,"SF_PRESET_HEADER_SIZE",function(){return u.SF_PRESET_HEADER_SIZE}),n.d(r,"SF_BAG_SIZE",function(){return u.SF_BAG_SIZE}),n.d(r,"SF_MODULATOR_SIZE",function(){return u.SF_MODULATOR_SIZE}),n.d(r,"SF_GENERATOR_SIZE",function(){return u.SF_GENERATOR_SIZE}),n.d(r,"SF_INSTRUMENT_HEADER_SIZE",function(){return u.SF_INSTRUMENT_HEADER_SIZE}),n.d(r,"SF_SAMPLE_HEADER_SIZE",function(){return u.SF_SAMPLE_HEADER_SIZE}),n.d(r,"DEFAULT_SAMPLE_RATE",function(){return u.DEFAULT_SAMPLE_RATE});var l=n("./src/soundFont2.ts");n.d(r,"SoundFont2",function(){return l.SoundFont2})},"./src/riff/chunkIterator.ts":function(t,r,n){n.r(r),n.d(r,"ChunkIterator",function(){return l});var o=n("./src/utils/index.ts");function a(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")}function s(c,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function u(c,d,h){return d in c?Object.defineProperty(c,d,{value:h,enumerable:!0,configurable:!0,writable:!0}):c[d]=h,c}var l=function(){function c(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;a(this,c),u(this,"target",[]),u(this,"chunk",void 0),u(this,"position",0),this.chunk=p,this.position=g}var d,h;return d=c,(h=[{key:"iterate",value:function(p){for(;this.position<this.chunk.length;){var g=p(this);g&&this.target.push(g)}}},{key:"getString",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:20,g=Object(o.getStringFromBuffer)(this.getBuffer(this.position,p));return this.position+=p,g}},{key:"getInt16",value:function(){return this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8}},{key:"getInt16BE",value:function(){return this.getInt16()<<16>>16}},{key:"getUInt32",value:function(){return(this.chunk.buffer[this.position++]|this.chunk.buffer[this.position++]<<8|this.chunk.buffer[this.position++]<<16|this.chunk.buffer[this.position++]<<24)>>>0}},{key:"getByte",value:function(){return this.chunk.buffer[this.position++]}},{key:"getChar",value:function(){return this.chunk.buffer[this.position++]<<24>>24}},{key:"skip",value:function(p){this.position+=p}},{key:"getBuffer",value:function(p,g){return this.chunk.buffer.subarray(p,p+g)}},{key:"currentPosition",get:function(){return this.position}}])&&s(d.prototype,h),c}()},"./src/riff/index.ts":function(t,r,n){n.r(r);var o=n("./src/riff/chunkIterator.ts");n.d(r,"ChunkIterator",function(){return o.ChunkIterator});var a=n("./src/riff/parseError.ts");n.d(r,"ParseError",function(){return a.ParseError});var s=n("./src/riff/parser.ts");n.d(r,"parseBuffer",function(){return s.parseBuffer}),n.d(r,"getChunk",function(){return s.getChunk}),n.d(r,"getChunkLength",function(){return s.getChunkLength}),n.d(r,"getSubChunks",function(){return s.getSubChunks}),n.d(r,"getChunkId",function(){return s.getChunkId});var u=n("./src/riff/riffChunk.ts");n.d(r,"RIFFChunk",function(){return u.RIFFChunk})},"./src/riff/parseError.ts":function(t,r,n){function o(p){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(p)}function a(p,g){return!g||o(g)!=="object"&&typeof g!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(p):g}function s(p){var g=typeof Map=="function"?new Map:void 0;return(s=function(f){if(f===null||(y=f,Function.toString.call(y).indexOf("[native code]")===-1))return f;var y;if(typeof f!="function")throw new TypeError("Super expression must either be null or a function");if(g!==void 0){if(g.has(f))return g.get(f);g.set(f,b)}function b(){return l(f,arguments,d(this).constructor)}return b.prototype=Object.create(f.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),c(b,f)})(p)}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function l(p,g,f){return(l=u()?Reflect.construct:function(y,b,m){var k=[null];k.push.apply(k,b);var v=new(Function.bind.apply(y,k));return m&&c(v,m.prototype),v}).apply(null,arguments)}function c(p,g){return(c=Object.setPrototypeOf||function(f,y){return f.__proto__=y,f})(p,g)}function d(p){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)})(p)}n.r(r),n.d(r,"ParseError",function(){return h});var h=function(p){function g(f,y,b){return function(m,k){if(!(m instanceof k))throw new TypeError("Cannot call a class as a function")}(this,g),a(this,d(g).call(this,"".concat(f).concat(y&&b?", expected ".concat(y,", received ").concat(b):"")))}return function(f,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(y&&y.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),y&&c(f,y)}(g,p),g}(s(Error))},"./src/riff/parser.ts":function(t,r,n){n.r(r),n.d(r,"parseBuffer",function(){return u}),n.d(r,"getChunk",function(){return l}),n.d(r,"getChunkLength",function(){return c}),n.d(r,"getSubChunks",function(){return d}),n.d(r,"getChunkId",function(){return h});var o=n("./src/riff/parseError.ts"),a=n("./src/utils/buffer.ts"),s=n("./src/riff/riffChunk.ts"),u=function(p){var g=h(p);if(g!=="RIFF")throw new o.ParseError("Invalid file format","RIFF",g);var f=h(p,8);if(f!=="sfbk")throw new o.ParseError("Invalid signature","sfbk",f);var y=p.subarray(8),b=d(y.subarray(4));return new s.RIFFChunk(g,y.length,y,b)},l=function(p,g){var f=h(p,g),y=c(p,g+4),b=[];return f!=="RIFF"&&f!=="LIST"||(b=d(p.subarray(g+12))),new s.RIFFChunk(f,y,p.subarray(g+8),b)},c=function(p,g){return((p=p.subarray(g,g+4))[0]|p[1]<<8|p[2]<<16|p[3]<<24)>>>0},d=function(p){for(var g=[],f=0;f<=p.length-8;){var y=l(p,f);g.push(y),f=(f+=8+y.length)%2?f+1:f}return g},h=function(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Object(a.getStringFromBuffer)(p.subarray(g,g+4))}},"./src/riff/riffChunk.ts":function(t,r,n){n.r(r),n.d(r,"RIFFChunk",function(){return l});var o=n("./src/riff/chunkIterator.ts"),a=n("./src/utils/index.ts");function s(c,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function u(c,d,h){return d in c?Object.defineProperty(c,d,{value:h,enumerable:!0,configurable:!0,writable:!0}):c[d]=h,c}var l=function(){function c(p,g,f,y){(function(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")})(this,c),u(this,"id",void 0),u(this,"length",void 0),u(this,"buffer",void 0),u(this,"subChunks",void 0),this.id=p,this.length=g,this.buffer=f,this.subChunks=y}var d,h;return d=c,(h=[{key:"getString",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,g=arguments.length>1?arguments[1]:void 0;return Object(a.getStringFromBuffer)(this.getBuffer(p,g||this.length-p))}},{key:"getInt16",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[p++]|this.buffer[p]<<8}},{key:"getUInt32",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return(this.buffer[p++]|this.buffer[p++]<<8|this.buffer[p++]<<16|this.buffer[p]<<24)>>>0}},{key:"getByte",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[p]}},{key:"getChar",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.buffer[p]<<24>>24}},{key:"iterator",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new o.ChunkIterator(this,p)}},{key:"iterate",value:function(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=new o.ChunkIterator(this,g);return f.iterate(p),f.target}},{key:"getBuffer",value:function(p,g){return this.buffer.subarray(p,p+g)}}])&&s(d.prototype,h),c}()},"./src/soundFont2.ts":function(t,r,n){n.r(r),n.d(r,"SoundFont2",function(){return g});var o=n("./src/types/index.ts"),a=n("./src/chunk.ts"),s=n("./src/riff/index.ts"),u=n("./src/chunks/index.ts"),l=n("./src/utils/index.ts");function c(f){for(var y=1;y<arguments.length;y++){var b=arguments[y]!=null?arguments[y]:{},m=Object.keys(b);typeof Object.getOwnPropertySymbols=="function"&&(m=m.concat(Object.getOwnPropertySymbols(b).filter(function(k){return Object.getOwnPropertyDescriptor(b,k).enumerable}))),m.forEach(function(k){p(f,k,b[k])})}return f}function d(f,y){for(var b=0;b<y.length;b++){var m=y[b];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function h(f,y,b){return y&&d(f.prototype,y),b&&d(f,b),f}function p(f,y,b){return y in f?Object.defineProperty(f,y,{value:b,enumerable:!0,configurable:!0,writable:!0}):f[y]=b,f}var g=function(){function f(y){if(function(m,k){if(!(m instanceof k))throw new TypeError("Cannot call a class as a function")}(this,f),p(this,"chunk",void 0),p(this,"metaData",void 0),p(this,"sampleData",void 0),p(this,"samples",void 0),p(this,"presetData",void 0),p(this,"instruments",void 0),p(this,"presets",void 0),p(this,"banks",void 0),!(y instanceof a.SF2Chunk)){var b=Object(s.parseBuffer)(y);y=new a.SF2Chunk(b)}if(y.subChunks.length!==3)throw new s.ParseError("Invalid sfbk structure","3 chunks","".concat(y.subChunks.length," chunks"));this.chunk=y,this.metaData=y.subChunks[0].getMetaData(),this.sampleData=y.subChunks[1].getSampleData(),this.presetData=y.subChunks[2].getPresetData(),this.samples=this.getSamples(),this.instruments=this.getInstruments(),this.presets=this.getPresets(),this.banks=this.getBanks()}return h(f,null,[{key:"from",value:function(y){return new f(y)}}]),h(f,[{key:"getKeyData",value:function(y){var b=this,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Object(l.memoize)(function(v,w,x){var P=b.banks[w];if(P){var C=P.presets[x];if(C){var T=C.zones.filter(function(oe){return b.isKeyInRange(oe,v)});if(T.length>0){var M=!0,_=!1,E=void 0;try{for(var O,F=T[Symbol.iterator]();!(M=(O=F.next()).done);M=!0){var R=O.value,z=R.instrument,W=z.zones.filter(function(oe){return b.isKeyInRange(oe,v)});if(W.length>0){var V=!0,L=!1,Y=void 0;try{for(var re,N=W[Symbol.iterator]();!(V=(re=N.next()).done);V=!0){var J=re.value,ne=J.sample,we=c({},R.generators,J.generators),fe=c({},R.modulators,J.modulators);return{keyNumber:v,preset:C,instrument:z,sample:ne,generators:we,modulators:fe}}}catch(oe){L=!0,Y=oe}finally{try{V||N.return==null||N.return()}finally{if(L)throw Y}}}}}catch(oe){_=!0,E=oe}finally{try{M||F.return==null||F.return()}finally{if(_)throw E}}}}}return null})(y,m,k)}},{key:"isKeyInRange",value:function(y,b){return y.keyRange===void 0||y.keyRange.lo<=b&&y.keyRange.hi>=b}},{key:"getBanks",value:function(){return this.presets.reduce(function(y,b){var m=b.header.bank;return y[m]||(y[m]={presets:[]}),y[m].presets[b.header.preset]=b,y},[])}},{key:"getPresets",value:function(){var y=this.presetData,b=y.presetHeaders,m=y.presetZones,k=y.presetGenerators,v=y.presetModulators;return Object(u.getItemsInZone)(b,m,v,k,this.instruments,o.GeneratorType.Instrument).filter(function(w){return w.header.name!=="EOP"}).map(function(w){return{header:w.header,globalZone:w.globalZone,zones:w.zones.map(function(x){return{keyRange:x.keyRange,generators:x.generators,modulators:x.modulators,instrument:x.reference}})}})}},{key:"getInstruments",value:function(){var y=this.presetData,b=y.instrumentHeaders,m=y.instrumentZones,k=y.instrumentModulators,v=y.instrumentGenerators;return Object(u.getItemsInZone)(b,m,k,v,this.samples,o.GeneratorType.SampleId).filter(function(w){return w.header.name!=="EOI"}).map(function(w){return{header:w.header,globalZone:w.globalZone,zones:w.zones.map(function(x){return{keyRange:x.keyRange,generators:x.generators,modulators:x.modulators,sample:x.reference}})}})}},{key:"getSamples",value:function(){var y=this;return this.presetData.sampleHeaders.filter(function(b){return b.name!=="EOS"}).map(function(b){if(b.name!=="EOS"&&b.sampleRate<=0)throw new Error("Illegal sample rate of ".concat(b.sampleRate," hz in sample '").concat(b.name,"'"));return b.originalPitch>=128&&b.originalPitch<=254&&(b.originalPitch=60),b.startLoop-=b.start,b.endLoop-=b.start,{header:b,data:new Int16Array(new Uint8Array(y.sampleData.subarray(2*b.start,2*b.end)).buffer)}})}}]),f}()},"./src/types/bank.ts":function(t,r){},"./src/types/generator.ts":function(t,r,n){var o,a;function s(l,c,d){return c in l?Object.defineProperty(l,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[c]=d,l}n.r(r),n.d(r,"GeneratorType",function(){return a}),n.d(r,"DEFAULT_GENERATOR_VALUES",function(){return u}),function(l){l[l.StartAddrsOffset=0]="StartAddrsOffset",l[l.EndAddrsOffset=1]="EndAddrsOffset",l[l.StartLoopAddrsOffset=2]="StartLoopAddrsOffset",l[l.EndLoopAddrsOffset=3]="EndLoopAddrsOffset",l[l.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",l[l.ModLFOToPitch=5]="ModLFOToPitch",l[l.VibLFOToPitch=6]="VibLFOToPitch",l[l.ModEnvToPitch=7]="ModEnvToPitch",l[l.InitialFilterFc=8]="InitialFilterFc",l[l.InitialFilterQ=9]="InitialFilterQ",l[l.ModLFOToFilterFc=10]="ModLFOToFilterFc",l[l.ModEnvToFilterFc=11]="ModEnvToFilterFc",l[l.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",l[l.ModLFOToVolume=13]="ModLFOToVolume",l[l.Unused1=14]="Unused1",l[l.ChorusEffectsSend=15]="ChorusEffectsSend",l[l.ReverbEffectsSend=16]="ReverbEffectsSend",l[l.Pan=17]="Pan",l[l.Unused2=18]="Unused2",l[l.Unused3=19]="Unused3",l[l.Unused4=20]="Unused4",l[l.DelayModLFO=21]="DelayModLFO",l[l.FreqModLFO=22]="FreqModLFO",l[l.DelayVibLFO=23]="DelayVibLFO",l[l.FreqVibLFO=24]="FreqVibLFO",l[l.DelayModEnv=25]="DelayModEnv",l[l.AttackModEnv=26]="AttackModEnv",l[l.HoldModEnv=27]="HoldModEnv",l[l.DecayModEnv=28]="DecayModEnv",l[l.SustainModEnv=29]="SustainModEnv",l[l.ReleaseModEnv=30]="ReleaseModEnv",l[l.KeyNumToModEnvHold=31]="KeyNumToModEnvHold",l[l.KeyNumToModEnvDecay=32]="KeyNumToModEnvDecay",l[l.DelayVolEnv=33]="DelayVolEnv",l[l.AttackVolEnv=34]="AttackVolEnv",l[l.HoldVolEnv=35]="HoldVolEnv",l[l.DecayVolEnv=36]="DecayVolEnv",l[l.SustainVolEnv=37]="SustainVolEnv",l[l.ReleaseVolEnv=38]="ReleaseVolEnv",l[l.KeyNumToVolEnvHold=39]="KeyNumToVolEnvHold",l[l.KeyNumToVolEnvDecay=40]="KeyNumToVolEnvDecay",l[l.Instrument=41]="Instrument",l[l.Reserved1=42]="Reserved1",l[l.KeyRange=43]="KeyRange",l[l.VelRange=44]="VelRange",l[l.StartLoopAddrsCoarseOffset=45]="StartLoopAddrsCoarseOffset",l[l.KeyNum=46]="KeyNum",l[l.Velocity=47]="Velocity",l[l.InitialAttenuation=48]="InitialAttenuation",l[l.Reserved2=49]="Reserved2",l[l.EndLoopAddrsCoarseOffset=50]="EndLoopAddrsCoarseOffset",l[l.CoarseTune=51]="CoarseTune",l[l.FineTune=52]="FineTune",l[l.SampleId=53]="SampleId",l[l.SampleModes=54]="SampleModes",l[l.Reserved3=55]="Reserved3",l[l.ScaleTuning=56]="ScaleTuning",l[l.ExclusiveClass=57]="ExclusiveClass",l[l.OverridingRootKey=58]="OverridingRootKey",l[l.Unused5=59]="Unused5",l[l.EndOper=60]="EndOper"}(a||(a={}));var u=(s(o={},a.StartAddrsOffset,0),s(o,a.EndAddrsOffset,0),s(o,a.StartLoopAddrsOffset,0),s(o,a.EndLoopAddrsOffset,0),s(o,a.StartAddrsCoarseOffset,0),s(o,a.ModLFOToPitch,0),s(o,a.VibLFOToPitch,0),s(o,a.ModEnvToPitch,0),s(o,a.InitialFilterFc,13500),s(o,a.InitialFilterQ,0),s(o,a.ModLFOToFilterFc,0),s(o,a.ModEnvToFilterFc,0),s(o,a.EndAddrsCoarseOffset,0),s(o,a.ModLFOToVolume,0),s(o,a.ChorusEffectsSend,0),s(o,a.ReverbEffectsSend,0),s(o,a.Pan,0),s(o,a.DelayModLFO,-12e3),s(o,a.FreqModLFO,0),s(o,a.DelayVibLFO,-12e3),s(o,a.FreqVibLFO,0),s(o,a.DelayModEnv,-12e3),s(o,a.AttackModEnv,-12e3),s(o,a.HoldModEnv,-12e3),s(o,a.DecayModEnv,-12e3),s(o,a.SustainModEnv,0),s(o,a.ReleaseModEnv,-12e3),s(o,a.KeyNumToModEnvHold,0),s(o,a.KeyNumToModEnvDecay,0),s(o,a.DelayVolEnv,-12e3),s(o,a.AttackVolEnv,-12e3),s(o,a.HoldVolEnv,-12e3),s(o,a.DecayVolEnv,-12e3),s(o,a.SustainVolEnv,0),s(o,a.ReleaseVolEnv,-12e3),s(o,a.KeyNumToVolEnvHold,0),s(o,a.KeyNumToVolEnvDecay,0),s(o,a.StartLoopAddrsCoarseOffset,0),s(o,a.KeyNum,-1),s(o,a.Velocity,-1),s(o,a.InitialAttenuation,0),s(o,a.EndLoopAddrsCoarseOffset,0),s(o,a.CoarseTune,0),s(o,a.FineTune,0),s(o,a.SampleModes,0),s(o,a.ScaleTuning,100),s(o,a.ExclusiveClass,0),s(o,a.OverridingRootKey,-1),o)},"./src/types/index.ts":function(t,r,n){n.r(r);var o=n("./src/types/bank.ts");for(var a in o)["default"].indexOf(a)<0&&function(y){n.d(r,y,function(){return o[y]})}(a);var s=n("./src/types/generator.ts");n.d(r,"GeneratorType",function(){return s.GeneratorType}),n.d(r,"DEFAULT_GENERATOR_VALUES",function(){return s.DEFAULT_GENERATOR_VALUES});var u=n("./src/types/instrument.ts");for(var a in u)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(b){n.d(r,b,function(){return u[b]})}(a);var l=n("./src/types/key.ts");for(var a in l)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(b){n.d(r,b,function(){return l[b]})}(a);var c=n("./src/types/metaData.ts");for(var a in c)["default","GeneratorType","DEFAULT_GENERATOR_VALUES"].indexOf(a)<0&&function(b){n.d(r,b,function(){return c[b]})}(a);var d=n("./src/types/modulator.ts");n.d(r,"ControllerType",function(){return d.ControllerType}),n.d(r,"ControllerPolarity",function(){return d.ControllerPolarity}),n.d(r,"ControllerDirection",function(){return d.ControllerDirection}),n.d(r,"ControllerPalette",function(){return d.ControllerPalette}),n.d(r,"Controller",function(){return d.Controller}),n.d(r,"TransformType",function(){return d.TransformType}),n.d(r,"DEFAULT_INSTRUMENT_MODULATORS",function(){return d.DEFAULT_INSTRUMENT_MODULATORS});var h=n("./src/types/preset.ts");for(var a in h)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(a)<0&&function(b){n.d(r,b,function(){return h[b]})}(a);var p=n("./src/types/presetData.ts");for(var a in p)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS"].indexOf(a)<0&&function(b){n.d(r,b,function(){return p[b]})}(a);var g=n("./src/types/sample.ts");n.d(r,"SampleType",function(){return g.SampleType});var f=n("./src/types/zone.ts");for(var a in f)["default","GeneratorType","DEFAULT_GENERATOR_VALUES","ControllerType","ControllerPolarity","ControllerDirection","ControllerPalette","Controller","TransformType","DEFAULT_INSTRUMENT_MODULATORS","SampleType"].indexOf(a)<0&&function(b){n.d(r,b,function(){return f[b]})}(a)},"./src/types/instrument.ts":function(t,r){},"./src/types/key.ts":function(t,r){},"./src/types/metaData.ts":function(t,r){},"./src/types/modulator.ts":function(t,r,n){n.r(r),n.d(r,"ControllerType",function(){return o}),n.d(r,"ControllerPolarity",function(){return a}),n.d(r,"ControllerDirection",function(){return s}),n.d(r,"ControllerPalette",function(){return u}),n.d(r,"Controller",function(){return l}),n.d(r,"TransformType",function(){return c}),n.d(r,"DEFAULT_INSTRUMENT_MODULATORS",function(){return h});var o,a,s,u,l,c,d=n("./src/types/generator.ts");(function(p){p[p.Linear=0]="Linear",p[p.Concave=1]="Concave",p[p.Convex=2]="Convex",p[p.Switch=3]="Switch"})(o||(o={})),function(p){p[p.Unipolar=0]="Unipolar",p[p.Bipolar=1]="Bipolar"}(a||(a={})),function(p){p[p.Increasing=0]="Increasing",p[p.Decreasing=1]="Decreasing"}(s||(s={})),function(p){p[p.GeneralController=0]="GeneralController",p[p.MidiController=1]="MidiController"}(u||(u={})),function(p){p[p.NoController=0]="NoController",p[p.NoteOnVelocity=2]="NoteOnVelocity",p[p.NoteOnKeyNumber=3]="NoteOnKeyNumber",p[p.PolyPressure=10]="PolyPressure",p[p.ChannelPressure=13]="ChannelPressure",p[p.PitchWheel=14]="PitchWheel",p[p.PitchWheelSensitivity=16]="PitchWheelSensitivity",p[p.Link=127]="Link"}(l||(l={})),function(p){p[p.Linear=0]="Linear",p[p.Absolute=2]="Absolute"}(c||(c={}));var h=[{id:d.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:s.Decreasing,palette:u.GeneralController,index:l.NoteOnVelocity},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.InitialFilterFc,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Decreasing,palette:u.GeneralController,index:l.NoteOnVelocity},value:-2400,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.VibLFOToPitch,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.ChannelPressure},value:50,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.VibLFOToPitch,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.MidiController,index:1},value:50,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:s.Decreasing,palette:u.MidiController,index:7},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.InitialAttenuation,source:{type:o.Linear,polarity:a.Bipolar,direction:s.Increasing,palette:u.MidiController,index:10},value:1e3,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.InitialAttenuation,source:{type:o.Concave,polarity:a.Unipolar,direction:s.Decreasing,palette:u.MidiController,index:11},value:960,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.ReverbEffectsSend,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.MidiController,index:91},value:200,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.ChorusEffectsSend,source:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.MidiController,index:93},value:200,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.NoController},transform:c.Linear},{id:d.GeneratorType.CoarseTune,source:{type:o.Linear,polarity:a.Bipolar,direction:s.Increasing,palette:u.GeneralController,index:l.PitchWheel},value:12700,valueSource:{type:o.Linear,polarity:a.Unipolar,direction:s.Increasing,palette:u.GeneralController,index:l.PitchWheelSensitivity},transform:c.Linear}]},"./src/types/preset.ts":function(t,r){},"./src/types/presetData.ts":function(t,r){},"./src/types/sample.ts":function(t,r,n){var o;n.r(r),n.d(r,"SampleType",function(){return o}),function(a){a[a.EOS=0]="EOS",a[a.Mono=1]="Mono",a[a.Right=2]="Right",a[a.Left=4]="Left",a[a.Linked=8]="Linked",a[a.RomMono=32769]="RomMono",a[a.RomRight=32770]="RomRight",a[a.RomLeft=32772]="RomLeft",a[a.RomLinked=32776]="RomLinked"}(o||(o={}))},"./src/types/zone.ts":function(t,r){},"./src/utils/buffer.ts":function(t,r,n){n.r(r),n.d(r,"getStringFromBuffer",function(){return o});var o=function(a){var s=new TextDecoder("utf8").decode(a),u=s.indexOf("\0");return(u===-1?s:s.slice(0,u)).trim()}},"./src/utils/index.ts":function(t,r,n){n.r(r);var o=n("./src/utils/buffer.ts");n.d(r,"getStringFromBuffer",function(){return o.getStringFromBuffer});var a=n("./src/utils/memoize.ts");n.d(r,"memoize",function(){return a.memoize})},"./src/utils/memoize.ts":function(t,r,n){n.r(r),n.d(r,"memoize",function(){return o});var o=function(a){var s={};return function(){for(var u=arguments.length,l=new Array(u),c=0;c<u;c++)l[c]=arguments[c];var d=JSON.stringify(l);if(d in s)return s[d];var h=a.apply(void 0,l);return s[d]=h,h}}}})})}(Tr)),Tr.exports}var Jo=zu(),Lu=q("<img width=120px height=120px src=./cat-node.jpg>");class ju{componentType=cn;ext;constructor(){this.ext={initAudioCtx:async(e,t)=>{const n=await fetch("./Thurston Waffles.sf2").then(f=>f.arrayBuffer()),o=new Jo.SoundFont2(new Uint8Array(n)),a=o.presets[0];if(!a)throw new Error("Preset at index 0 not found.");const s=o.instruments[a.header.bagIndex];if(!s)throw new Error("No instrument found for preset at index 0");const u=(f,y)=>{for(const b of f.zones)if(b.keyRange!=null&&y>=b.keyRange.lo&&y<=b.keyRange.hi)return b.sample;return null};let l=60;const c=u(s,l);if(!c)throw new Error(`No sample found for note ${l} in preset 0.`);const d=c.header.sampleRate,h=c.data.length,p=new Float32Array(h);for(let f=0;f<h;f++)p[f]=c.data[f]/32768;const g=c.header.originalPitch;t.port.postMessage({type:"meowData",params:{meowOriginalPitch:g,meowSampleRate:d,meowData:p}})},generateInitOnceCode:({ctx:e})=>{e.insertGlobalCode(["let meowOriginalPitch = undefined;","let meowSampleRate = undefined;","let meowData = undefined;","let meowStepPerHz = undefined;"]),e.insertMessageHandlerCode("meowData",["meowOriginalPitch = params.meowOriginalPitch;","meowSampleRate = params.meowSampleRate;","meowData = params.meowData;",`meowStepPerHz = meowSampleRate / (sampleRate * ${261.625565});`])}}}create(e){return new Uu(e)}}const Qo=new ju;class Uu{type=Qo;nodeParams;inputPins;outputPins;ui;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>t.frequency,setSource:n=>r("frequency",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ui=S(()=>()=>Lu()),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let s=n.allocField("0.0"),u=n.allocField("0.0"),l=new Map,c=n.allocField("0.0"),d=n.allocField("0");return n.insertCode([`if (meowData == undefined || ${a} != ${s}) {`,`  ${u} = 0.0;`,`  ${c} = 0.0;`,`  ${s} = ${a};`,"} else {",`  if (${c} >= meowData.length) {`,`    ${u} = 0.0;`,"  } else {",`    ${d} = Math.floor(${c});`,`    let value = meowData[${d}];`,`    ${u} = value;`,`    let step = ${a} * meowStepPerHz;`,`    ${c} += step;`,"  }","}"]),l.set("out",u),[{outputAtoms:l}]}}}}const Bu=G({a:D($),b:D($),out:ee($)}),ea=new Z({typeName:"Mult",typeSchema:Bu});class qu{componentType=ea;ext={};create(e){return new Vu(e)}}const ta=new qu;class Vu{type=ta;nodeParams;inputPins;outputPins;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"a",source:()=>t.a,setSource:n=>r("a",n)},{name:"b",source:()=>t.b,setSource:n=>r("b",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("a");if(a==null)return[];let s=o.get("b");if(s==null)return[];let u=n.allocField("0.0");n.insertCode([`${u} = ${a} * ${s}`]);let l=new Map;return l.set("out",u),[{outputAtoms:l}]}}}}const Gu=G({out:ee($)}),ra=new Z({typeName:"NoiseWave",typeSchema:Gu});class Wu{componentType=ra;ext={};create(e){return new Hu(e)}}const na=new Wu;class Hu{type=na;nodeParams;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}])}}const Yu=G({entity:Qe(),note:Qe(),out:ee($)}),ia=new Z({typeName:"Note",typeSchema:Yu});class Xu{componentType=ia;ext={};create(e){return new Ku(e)}}const pn=new Xu;class Ku{type=pn;nodeParams;outputPins;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:a=>r("out",a)}]);const n=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=261.63;this.ext={generateCode:({ctx:a,inputAtoms:s})=>{let u=n.indexOf(t.note);if(u==-1)return[];let l=o*Math.pow(2,u/12),c=a.allocField("0.0"),d=new Map;return d.set("out",c),a.insertCode([`if (noteDown["${t.entity}/${t.note}"]) {`,`  ${c} = ${l};`,"} else {",`  ${c} = 0.0;`,"}"]),[{outputAtoms:d}]}}}}var Zu=q("<input class=input type=text size=8>");let Ju=class{componentType=Ot;ext={};create(e){return new Qu(e)}};const oa=new Ju;let Qu=class{type=oa;nodeParams;outputPins;ui;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ui=S(()=>()=>{let[n,o]=_e({valueText:se(()=>t.value.toFixed(3))});return le(ie(()=>n.valueText,()=>{let a=Number.parseFloat(n.valueText);Number.isNaN(a)||r("value",a)},{defer:!0})),(()=>{var a=Zu();return a.$$input=s=>{o("valueText",s.currentTarget.value)},Q(()=>a.value=n.valueText),a})()}),this.ext={generateCode:({ctx:n})=>{let o=new Map;return o.set("out",`${t.value}`),[{outputAtoms:o}]}}}};ke(["input"]);const ed=G({out:ee($)}),aa=new Z({typeName:"PianoKeys",typeSchema:ed});var td=q("<div class=piano>"),rd=q("<div class=white-key>"),nd=q("<div class=black-key>");const id=i=>{const e=[{name:"C",type:"white"},{name:"C#",type:"black"},{name:"D",type:"white"},{name:"D#",type:"black"},{name:"E",type:"white"},{name:"F",type:"white"},{name:"F#",type:"black"},{name:"G",type:"white"},{name:"G#",type:"black"},{name:"A",type:"white"},{name:"A#",type:"black"},{name:"B",type:"white"}],t=150,r=80;let n,o=new ht,a=new Ke;return(()=>{var s=td();s.$$pointermove=l=>{if(!o.get(l.pointerId))return;let c=n.getBoundingClientRect();o.set(l.pointerId,B.create(l.clientX-c.left,l.clientY-c.top))},s.addEventListener("pointercancel",l=>{o.delete(l.pointerId),n.releasePointerCapture(l.pointerId)}),s.$$pointerup=l=>{o.delete(l.pointerId),n.releasePointerCapture(l.pointerId)},s.$$pointerdown=l=>{let c=n.getBoundingClientRect();o.set(l.pointerId,B.create(l.clientX-c.left,l.clientY-c.top)),n.setPointerCapture(l.pointerId)};var u=n;return typeof u=="function"?ge(u,s):n=s,s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","row"),s.style.setProperty("overflow-x","auto"),s.style.setProperty("user-select","none"),s.style.setProperty("touch-action","none"),H(s,I(Xe,{each:e,children:l=>{let[c,d]=K();l.type=="black"&&le(()=>{let p=c();p!=null&&(a.add(p),be(()=>a.delete(p)))});let h=S(()=>{let p=c();if(p==null)return!1;let g=n.getBoundingClientRect(),f=p.getBoundingClientRect();for(let y of o.values()){let b=g.left+y.x-f.left,m=g.top+y.y-f.top;if(0<b&&b<f.width&&0<m&&m<f.height){if(l.type=="white")for(let k of a){let v=k.getBoundingClientRect(),w=g.left+y.x-v.left,x=g.top+y.y-v.top;if(0<w&&w<v.width&&0<x&&x<v.height)return!1}return!0}}return!1});return le(ie(h,p=>{p?i.onNoteOn(l.name):i.onNoteOff(l.name)},{defer:!0})),I(Gr,{get children(){return[I(ft,{get when(){return l.type=="white"},get children(){var p=rd(),g=d;return typeof g=="function"?ge(g,p):d=p,p.style.setProperty("width","50px"),p.style.setProperty("pointer-events","none"),Q(f=>{var y=!!h(),b=`${t+(h()?2:0)}px`;return y!==f.e&&p.classList.toggle("pressed",f.e=y),b!==f.t&&((f.t=b)!=null?p.style.setProperty("height",b):p.style.removeProperty("height")),f},{e:void 0,t:void 0}),p}}),I(ft,{get when(){return l.type=="black"},get children(){var p=nd(),g=d;return typeof g=="function"?ge(g,p):d=p,p.style.setProperty("margin-left","-16px"),p.style.setProperty("margin-right","-14px"),p.style.setProperty("width","30px"),p.style.setProperty("pointer-events","none"),Q(f=>{var y=!!h(),b=`${r+(h()?2:0)}px`;return y!==f.e&&p.classList.toggle("pressed",f.e=y),b!==f.t&&((f.t=b)!=null?p.style.setProperty("height",b):p.style.removeProperty("height")),f},{e:void 0,t:void 0}),p}})]}})}})),s})()};ke(["pointerdown","pointerup","pointermove"]);class od{componentType=aa;ext;constructor(){this.ext={generateInitOnceCode:({ctx:e})=>{e.insertGlobalCode(["let noteDown = {};"]),e.insertMessageHandlerCode("NoteOn",["noteDown[params.id] = true;"]),e.insertMessageHandlerCode("NoteOff",["noteDown[params.id] = false;"])}}}create(e){return new ad(e)}}const sa=new od;class ad{type=sa;nodeParams;outputPins;ui;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:s=>r("out",s)}]);let[n,o]=K();this.ui=S(()=>()=>I(id,{onNoteOn:s=>{let u=n();u?.port.postMessage({type:"NoteOn",params:{id:`${e.entity}/${s}`}})},onNoteOff:s=>{let u=n();u?.port.postMessage({type:"NoteOff",params:{id:`${e.entity}/${s}`}})}}));const a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];this.ext={macro:(s,u)=>{let l=[],c=[...s.outputs.out];for(let h of c){l.push(h);for(let p=0;p<a.length-1;++p){let g=Qc(h.node,u);l.push({node:g,pin:h.pin})}}let d=0;for(let{node:h,pin:p}of l){let[g,f]=_e({entity:e.entity,note:a[d],out:[]}),b={node:pn.create({entity:dt(),state:g,setState:f}),space:()=>me.identity,setSpace:()=>{},setRenderSizeAccessor:()=>{},setInputPinPositionMapAccessor:()=>{},setOutputPinPositionMapAccessor:()=>{},renderSize:()=>{},inputPinPositionMap:()=>{},outputPinPositionMap:()=>{}},m={id:0,inputs:{},outputs:{out:[{node:h,pin:p}]},height:0,node:b};u(m),h.inputs[p]={node:m,pin:"out"},++d,d>=a.length&&(d=0)}s.outputs.out=[]},generateCode:({ctx:s})=>{{let u=[];for(let l of a)u.push(`noteDown["${e.entity}/${l}"] = false;`);s.insertGlobalCode(u)}return[{outputAtoms:new Map}]},init:async s=>{o(s)}}}}const sd=G({timeToZero:D($),out:ee($)}),la=new Z({typeName:"Release",typeSchema:sd});class ld{componentType=la;ext={};create(e){return new cd(e)}}const ca=new ld;class cd{type=ca;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"timeToZero",source:()=>t.timeToZero,setSource:n=>r("timeToZero",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}])}}const ud=G({frequency:D($),amplitude:D($),centre:D($),out:ee($)}),ua=new Z({typeName:"SawWave",typeSchema:ud});class dd{componentType=ua;ext={};create(e){return new pd(e)}}const da=new dd;class pd{type=da;nodeParams;inputPins;outputPins;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>t.frequency,setSource:n=>r("frequency",n)},{name:"amplitude",source:()=>t.amplitude,setSource:n=>r("amplitude",n)},{name:"centre",source:()=>t.centre,setSource:n=>r("centre",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let s=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",l=new Map,c=n.allocField("0.0"),d=n.allocField("0.0");return n.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${d} = ${s} * ((${c} / Math.PI) - 1.0) + ${u};`,`${c} %= 2 * Math.PI;`]),l.set("out",d),[{outputAtoms:l}]}}}}var hd=q("<label><span style=color:black;padding-right:5px;>Id:</span><input class=input type=text size=8>");class fd{componentType=sn;ext={};create(e){return new md(e)}}const pa=new fd;class md{type=pa;nodeParams;inputPins;outputPins;ui;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"prev",source:()=>t.prev,setSource:n=>r("prev",n),isEffectPin:!0},{name:"value",source:()=>t.value,setSource:n=>r("value",n)}]),this.outputPins=S(()=>[{name:"next",sinks:()=>t.next,setSinks:n=>r("next",n),isEffectPin:!0}]),this.ui=S(()=>()=>(()=>{var n=hd(),o=n.firstChild,a=o.nextSibling;return a.$$input=s=>{r("id",s.currentTarget.value)},Q(()=>a.value=t.id),n})()),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let s=o.get("prev");if(s==null)return[];let u=o.get("value");if(u==null)return[];let l=`this.n_${a}_next`;n.addDeclToExistingForField(l,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),n.insertConstructorCode([`${s}.onDone.push(() => {`,`  this.insertRunningEffect(${l});`,"});",`${l}.update = () => {`,`  this.variables["${t.id}"] = ${u};`,"  return true;","};"]);let c=`${l}`,d=new Map;return d.set("next",c),[{outputAtoms:d}]}}}}ke(["input"]);class gd{componentType=nn;ext={};create(e){return new yd(e)}}const ha=new gd;class yd{type=ha;nodeParams;inputPins;outputPins;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>t.frequency,setSource:n=>r("frequency",n)},{name:"amplitude",source:()=>t.amplitude,setSource:n=>r("amplitude",n)},{name:"centre",source:()=>t.centre,setSource:n=>r("centre",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let s=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",l=new Map,c=n.allocField("0.0"),d=n.allocField("0.0");return n.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${d} = ${s} * Math.sin(${c}) + ${u};`,`${c} %= 2 * Math.PI;`]),l.set("out",d),[{outputAtoms:l}]}}}}var bd=q('<i class="fa-solid fa-volume-high">');class vd{componentType=un;ext={};create(e){return new kd(e)}}const fa=new vd;class kd{type=fa;nodeParams;inputPins;ui;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"in",source:()=>t.in,setSource:n=>r("in",n)}]),this.ui=S(()=>()=>(()=>{var n=bd();return n.style.setProperty("font-size","24px"),n.style.setProperty("color","green"),n})()),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("in");return a==null?[]:(n.insertCode([`result += ${a}`]),[{outputAtoms:new Map}])}}}}const wd=G({frequency:D($),amplitude:D($),centre:D($),out:ee($)}),ma=new Z({typeName:"SquareWave",typeSchema:wd});class xd{componentType=ma;ext={};create(e){return new Sd(e)}}const ga=new xd;class Sd{type=ga;nodeParams;inputPins;outputPins;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>t.frequency,setSource:n=>r("frequency",n)},{name:"amplitude",source:()=>t.amplitude,setSource:n=>r("amplitude",n)},{name:"centre",source:()=>t.centre,setSource:n=>r("centre",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{let a=o.get("frequency");if(a==null)return[];let s=o.get("amplitude")??"1.0",u=o.get("centre")??"0.0",l=new Map,c=n.allocField("0.0"),d=n.allocField("0.0");return n.insertCode([`${c} += (2 * Math.PI * ${a}) / sampleRate;`,`${d} = ${s} * (${c} < Math.PI ? -1 : 1) + ${u};`,`${c} %= 2 * Math.PI;`]),l.set("out",d),[{outputAtoms:l}]}}}}class Pd{componentType=an;ext={};create(e){return new Cd(e)}}const ya=new Pd;class Cd{type=ya;nodeParams;outputPins;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"next",sinks:()=>t.next,setSinks:n=>r("next",n),isEffectPin:!0}]),this.ext={generateCode:({ctx:n,inputAtoms:o,codeGenNodeId:a})=>{let s=`this.n_${a}_next`;n.addDeclToExistingForField(s,`{\r
    prev: null,\r
    next: null,\r
    update: null, /* () => boolean */\r
    onDone: [], /* (() => void)[] */\r
  }`),n.insertConstructorCode([`${s}.update = () => true;`,`this.insertRunningEffect(${s});`]);let u=`${s}`,l=new Map;return l.set("next",u),[{outputAtoms:l}]}}}}var _d=q("<label><span style=color:black;padding-right:5px;>Id:</span><input class=input type=text size=8>");class Td{componentType=ln;ext={};create(e){return new $d(e)}}const ba=new Td;class $d{type=ba;nodeParams;outputPins;ui;ext;constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"value",sinks:()=>t.value,setSinks:n=>r("value",n)}]),this.ui=S(()=>()=>(()=>{var n=_d(),o=n.firstChild,a=o.nextSibling;return a.$$input=s=>{r("id",s.currentTarget.value)},Q(()=>a.value=t.id),n})()),this.ext={generateCode:({ctx:n,inputAtoms:o})=>{n.insertConstructorCode([`this.variables["${t.id}"] = 0.0;`]);let a=`this.variables["${t.id}"]`,s=new Map;return s.set("value",a),[{outputAtoms:s}]}}}}ke(["input"]);const va=new Oo;va.registerNodeTypes([Go,Ho,Yo,Ko,Zo,Qo,ta,na,pn,oa,sa,ca,da,pa,ha,fa,ga,ya,ba]);const Id=new rn([...Ao.componentTypes,Vo,Wo,on,Xo,dn,cn,ea,ra,ia,Ot,aa,la,ua,sn,nn,un,ma,an,Se,ln]);var Ed=q("<div><div>"),Rd=q('<button class="btn btn-primary">Import Midi<input type=file hidden>'),Md=q("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Show Code"),Ad=q("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Make Sound"),Nd=q("<div><pre>");const Od=i=>{let[e,t]=Hr(i,["world"]),[r,n]=_e({showCode:!1,makeSound:!1}),[o,a]=K();setTimeout(()=>{let c=e.world;c.entities().length==0&&c.createEntity([nn.create({frequency:void 0,amplitude:void 0,centre:void 0,out:[]}),Se.create({transform:me.create(B.create(50,50),he.rot0)})])});let s=S(()=>{let c=o();if(c!=null&&(r.showCode||r.makeSound))return eu({nodesSystem:c})});le(ie([()=>r.makeSound,s],([c,d])=>{let h=o();if(h==null||!c||d==null)return;let p=URL.createObjectURL(new Blob([d],{type:"text/javascript"})),g=new AudioContext;(async()=>{await g.audioWorklet.addModule(p);let f=new AudioWorkletNode(g,"compiled-graph-audio-worklet-processor"),y=new Set;for(let b of h.nodes()){let m=b.node.type;y.has(m.componentType.typeName)||(y.add(m.componentType.typeName),await m.ext.initAudioCtx?.(g,f))}for(let b of h.nodes())await b.node.ext.init?.(f);f.connect(g.destination)})(),be(()=>{(async()=>(await g.close(),URL.revokeObjectURL(p)))()})}));let[u,l]=K();return(()=>{var c=Ed(),d=c.firstChild;return qr(c,t,!1,!0),d.style.setProperty("width","100%"),d.style.setProperty("height","100%"),d.style.setProperty("display","flex"),d.style.setProperty("flex-direction","column"),d.style.setProperty("position","relative"),H(d,I(zo,{style:{"flex-grow":"1"},onInit:h=>{a(h.nodesSystem)},componentRegistry:Id,nodeRegistry:va,get world(){return e.world},get toolbar(){return[(()=>{var h=Rd(),p=h.firstChild,g=p.nextSibling;h.$$click=()=>{let y=u();y?.click()},g.$$input=y=>{let b=y.currentTarget.files;if(b==null||b.length!=1)return;let m=b[0];ku(e.world,m),y.currentTarget.value=""};var f=l;return typeof f=="function"?ge(f,g):l=g,h})(),(()=>{var h=Md(),p=h.firstChild;return p.addEventListener("change",g=>n("showCode",g.currentTarget.checked)),Q(()=>p.checked=r.showCode),h})(),(()=>{var h=Ad(),p=h.firstChild;return p.addEventListener("change",g=>n("makeSound",g.currentTarget.checked)),Q(()=>p.checked=r.makeSound),h})()]}}),null),H(d,I(ae,{get when(){return S(()=>!!r.showCode)()?s():void 0},children:h=>(()=>{var p=Nd(),g=p.firstChild;return p.style.setProperty("position","absolute"),p.style.setProperty("right","0"),p.style.setProperty("top","0"),p.style.setProperty("bottom","0"),p.style.setProperty("overflow","auto"),p.style.setProperty("width","50%"),Q(()=>g.innerText=h()),p})()}),null),c})()};ke(["click","input"]);const Fd=""+new URL("music-audio-worklet-processor-D_ZxFmGc.js",import.meta.url).href,Dd=`attribute vec4 aVertexPosition;

uniform mat4 uModelViewMatrix;

void main(void) {
  gl_Position = uModelViewMatrix * aVertexPosition;
}
`,zd=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif

uniform float time;
uniform float uOffsetY;
uniform vec2 resolution;
uniform float uFocalLength;

float sdRoundBox(vec3 p, vec3 b, float r){
  vec3 q = abs(p) - b + r;
  return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0) - r;
}

float map(vec3 p) {
  p.x += 700.0;
  float b = 100.0*7.0/12.0;
  vec3 p3 = p;
  vec3 p2 = p;
  p.x = mod(p.x + 100.0, 200.0) - 100.0;
  float i = mod(floor((p2.x) / (2.0*b)) - 6.0,12.0);
  p2.x = mod(p2.x, b*2.0);
  bool skipB = false;
  float w = 52.0 * 200.0;
  if ( i == 0.0 || i == 2.0 ||
       i == 4.0 || i == 6.0 ||
       i == 7.0 || i == 9.0 || i == 11.0 ||
       p3.x < -0.5*w+900.0 ||
       p3.x > 0.5*w+600.0
  ) {
    skipB = true;
  }
  float d3;
  float d1 = sdRoundBox(p, vec3(100,600,100), 30.0);
  if (skipB) {
    d3 = d1;
  } else {
    d3 = min(
      d1,
      sdRoundBox(p2 + vec3(-b,-180,-150), vec3(100*7/12,420,50), 20.0)
    );
  }
  return max(d3,
    max(
      p3.x - 0.5 * w - 700.0,
      -p3.x - 0.5 * w + 700.0
    )
  );
}

bool march(vec3 ro, vec3 rd, out float t) {
  vec3 p = ro;
  t = 0.0;
  for (int i = 0; i < 20; ++i) {
    vec3 p = ro + rd*t;
    float d = map(p);
    if (abs(d) < 1.0) {
      return true;
    }
    t += d;
  }
  return false;
}

vec3 normal(vec3 p) {
  float d = 0.001;
  float mp = map(p);
  float dx = map(p + vec3(d,0,0)) - mp;
  float dy = map(p + vec3(0,d,0)) - mp;
  float dz = map(p + vec3(0,0,d)) - mp;
  return normalize(vec3(dx,dy,dz));
}

void main(void) {
  float fl = uFocalLength;
  float d = 52.0 * 200.0 * fl / resolution.x;
  float mx = max(resolution.x, resolution.y);
  vec2 uv = gl_FragCoord.xy / mx;
  vec3 w = normalize(vec3(0, -1, 3));
  vec3 ro = w * d + vec3(0.0, -600.0, 50.0);
  vec3 u = normalize(cross(vec3(0,1,0),w));
  vec3 v = cross(w,u);
  vec3 rd = normalize(
    (gl_FragCoord.x - 0.5 * resolution.x) * u +
    (gl_FragCoord.y - 0.5 * resolution.y) * v +
    -fl * w
  );
  ro -= uOffsetY * v;
  float t = 0.0;
  bool hit = march(ro, rd, t);
  if (!hit) {
    gl_FragColor = vec4(0.2, 0.2, 0.2, 1.0);
    return;
  }
  vec3 p = ro + rd*t;
  vec3 n = normal(p);
  float s = dot(n,normalize(vec3(1,1,1))) + 0.2;
  if (p.z > 101.0) {
    s *= 0.5;
  }
  gl_FragColor = vec4(s,s,s,1.0);
}
`;var Ld=q('<div><div><button class="btn btn-primary">Import Midi</button><input type=file hidden><button class="btn btn-primary">Run</button></div><div><canvas>');const jd=50,er=1e4,Ud=i=>{let[e,t]=K(),[r,n]=K(),[o,a]=K();ve(ie([e,r],([f,y])=>{if(f==null||y==null)return;let b=f.getBoundingClientRect();y.width=b.width*window.devicePixelRatio,y.height=b.height*window.devicePixelRatio,y.style.setProperty("width",`${b.width}px`),y.style.setProperty("height",`${b.height}px`),a(y.getContext("webgl")??void 0)}));let s=S(ie([o,r],([f,y])=>{if(f!=null&&y!=null)return Gd(f,y)})),[u,l]=K(),c=!1,d=!0,h=0,p=f=>{let y=o();if(y==null)return;let b=s();if(b==null||(d&&(h=f,d=!1),!c))return;let m=f-h;b.time=m,Vd(b),Wd(y,b),requestAnimationFrame(p)},g=async()=>{let f=s();if(f==null)return;let[y,b]=await Xd(),m=[],k=f.notesHead,v=0;for(;k!=null;){let w=v++;m.push({id:w,time:k.startTime*.001,note:k.note,type:"On"}),m.push({id:w,time:(k.startTime+k.holdTime)*.001,note:k.note,type:"Off"}),k=k.next}m.sort((w,x)=>{let P=w.time-x.time;return P!=0||(P=w.note-x.note,P!=0)?P:w.type==x.type?0:w.type=="Off"?-1:1}),b.port.postMessage({type:"musicData",params:{noteEvents:m}}),c=!0,d=!0,requestAnimationFrame(p)};return(()=>{var f=Ld(),y=f.firstChild,b=y.firstChild,m=b.nextSibling,k=m.nextSibling,v=y.nextSibling,w=v.firstChild;f.style.setProperty("flex-grow","1"),f.style.setProperty("display","flex"),f.style.setProperty("flex-direction","column"),f.style.setProperty("overflow","hidden"),b.$$click=()=>{u()?.click()},m.addEventListener("change",T=>{let M=s();if(M==null)return;let _=T.currentTarget.files;if(_==null||_.length==0)return;let E=_[0];Bd(M,E),T.currentTarget.value=""});var x=l;typeof x=="function"?ge(x,m):l=m,k.$$click=()=>g();var P=t;typeof P=="function"?ge(P,v):t=v,v.style.setProperty("flex-grow","1");var C=n;return typeof C=="function"?ge(C,w):n=w,f})()};async function Bd(i,e){let t=new qo.Midi(await e.arrayBuffer()),r=[];for(let n of t.tracks){let o=Yd();for(let a of n.notes){let s={startTime:a.time*1e3,holdTime:a.duration*1e3,note:a.midi,colourR:o.r,colourG:o.g,colourB:o.b,colourA:1,isAlive:!1,prev:void 0,next:void 0};s.prev=s,r.push(s)}}r.sort((n,o)=>n.startTime-o.startTime);for(let n of r)qd(i,n)}function qd(i,e){if(i.notesHead==null)i.notesHead=i.notesTail=e;else{let t=i.notesTail;t.next=e,e.prev=t,i.notesTail=e}}function Vd(i){let e=i.time-i.height/i.fallSpeed,t=i.time,r=i.visibleNotesEnd?.next??i.notesHead;for(;r!=null&&!(r.startTime>=t);)i.visibleNotesEnd==null?i.visibleNotesStart=i.visibleNotesEnd=r:i.visibleNotesEnd=r,i.numVisibleNotes++,r=r.next;for(r=i.visibleNotesStart;;){if(r==null){i.numVisibleNotes=0,i.visibleNotesStart=i.visibleNotesEnd=void 0;break}if(r.startTime+r.holdTime<=e){i.numVisibleNotes--,r=r.next,i.visibleNotesStart=r;continue}break}}function Gd(i,e){const t=.5*e.height/Math.tan(.5*jd*Math.PI/180);let r={width:e.width,height:e.height,time:0,fallSpeed:.5,maxNotes:er,numNotes:0,notesVertices:new Float32Array(er*8*6),notesGLVertexBuffer:i.createBuffer(),notesHead:void 0,notesTail:void 0,freeNotesHead:void 0,freeNotesTail:void 0,visibleNotesStart:void 0,visibleNotesEnd:void 0,numVisibleNotes:0,program:void 0,positionLocation:-1,colourLocation:-1,textureCoordLocation:-1,pianoVertices:new Float32Array(12),pianoGLVertexBuffer:i.createBuffer(),pianoProgram:void 0,pianoPositionLocation:-1};for(let y=0,b=0;y<er;++y)r.notesVertices[b+6]=0,r.notesVertices[b+7]=0,b+=8,r.notesVertices[b+6]=1,r.notesVertices[b+7]=0,b+=8,r.notesVertices[b+6]=1,r.notesVertices[b+7]=1,b+=8,r.notesVertices[b+6]=0,r.notesVertices[b+7]=0,b+=8,r.notesVertices[b+6]=1,r.notesVertices[b+7]=1,b+=8,r.notesVertices[b+6]=0,r.notesVertices[b+7]=1,b+=8;const a=ki(i,`
    attribute vec4 aVertexPosition;
    attribute vec4 aColour;
    attribute vec2 aTextureCoord;

    uniform mat4 uModelViewMatrix;

    varying highp vec4 vColour;
    varying highp vec2 vTextureCoord;

    void main(void) {
        gl_Position = uModelViewMatrix * aVertexPosition;
        vTextureCoord = aTextureCoord;
        vColour = aColour;
    }
  `,`
    varying highp vec4 vColour;
    varying highp vec2 vTextureCoord;

    void main(void) {
        gl_FragColor = vColour;
    }
  `);if(a==null)return;const s=ki(i,Dd,zd);if(s==null)return;r.program=a,r.pianoProgram=s,i.useProgram(a);const u=i.getUniformLocation(a,"uModelViewMatrix");function l(y,b,m,k){var v=-1,w=1,x=b-y,P=k-m,C=w-v;return[2/x,0,0,0,0,2/P,0,0,0,0,-2/C,0,-(b+y)/x,-(k+m)/P,-(w+v)/C,1]}const c=new Float32Array(l(0,r.width,0,r.height));i.uniformMatrix4fv(u,!1,c),r.positionLocation=i.getAttribLocation(a,"aVertexPosition"),r.colourLocation=i.getAttribLocation(a,"aColour"),r.textureCoordLocation=i.getAttribLocation(a,"aTextureCoord"),i.bindBuffer(i.ARRAY_BUFFER,r.notesGLVertexBuffer),i.bufferData(i.ARRAY_BUFFER,r.notesVertices,i.DYNAMIC_DRAW),i.vertexAttribPointer(r.positionLocation,2,i.FLOAT,!1,8*4,0*4),i.vertexAttribPointer(r.colourLocation,4,i.FLOAT,!1,8*4,4*4),i.vertexAttribPointer(r.textureCoordLocation,2,i.FLOAT,!1,8*4,6*4),i.useProgram(s);const d=i.getUniformLocation(s,"uModelViewMatrix");i.uniformMatrix4fv(d,!1,c);const h=i.getUniformLocation(s,"uFocalLength");i.uniform1f(h,t);const p=i.getUniformLocation(s,"resolution"),g=i.getUniformLocation(s,"uOffsetY");let f;{let y=10400*t/r.width,b=-1,m=3,k=Math.sqrt(b*b+m*m);b/=k,m/=k;let v=m,w=-b,x=b*y-600,P=m*y+50,C=(-600-x)*-b+(-50-P)*-m,T=C*-.5*r.height/t,M=C,_=T+1200*v+400*-b,E=M+1200*w+400*-m,O=T+200*-b,F=T*t/M,R=_*t/E;f=Math.abs(R-F),i.uniform1f(g,O)}return i.uniform2f(p,r.width,r.height),r.pianoPositionLocation=i.getAttribLocation(s,"aVertexPosition"),r.pianoVertices[0]=0,r.pianoVertices[1]=0,r.pianoVertices[2]=r.width,r.pianoVertices[3]=0,r.pianoVertices[4]=r.width,r.pianoVertices[5]=f,r.pianoVertices[6]=0,r.pianoVertices[7]=0,r.pianoVertices[8]=r.width,r.pianoVertices[9]=f,r.pianoVertices[10]=0,r.pianoVertices[11]=f,i.bindBuffer(i.ARRAY_BUFFER,r.pianoGLVertexBuffer),i.bufferData(i.ARRAY_BUFFER,r.pianoVertices,i.DYNAMIC_DRAW),i.vertexAttribPointer(r.pianoPositionLocation,2,i.FLOAT,!1,0,0),i.viewport(0,0,e.width,e.height),r}function Wd(i,e){if(e.program==null||e.pianoProgram==null)return;let t=0,r=e.visibleNotesStart,n=0,o=e.width/88;for(i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT);r!=e.visibleNotesEnd?.next&&r!=null;){let a=0;for(;r!=e.visibleNotesEnd?.next&&r!=null;){let s=n+(r.note-21)*o,u=e.height-(e.time-r.startTime)*e.fallSpeed,l=s+o,c=u,d=l,h=c+r.holdTime*e.fallSpeed,p=s,g=h;if(e.notesVertices[t+0]=s,e.notesVertices[t+1]=u,e.notesVertices[t+2]=r.colourR,e.notesVertices[t+3]=r.colourG,e.notesVertices[t+4]=r.colourB,e.notesVertices[t+5]=r.colourA,t+=8,e.notesVertices[t+0]=l,e.notesVertices[t+1]=c,e.notesVertices[t+2]=r.colourR,e.notesVertices[t+3]=r.colourG,e.notesVertices[t+4]=r.colourB,e.notesVertices[t+5]=r.colourA,t+=8,e.notesVertices[t+0]=d,e.notesVertices[t+1]=h,e.notesVertices[t+2]=r.colourR,e.notesVertices[t+3]=r.colourG,e.notesVertices[t+4]=r.colourB,e.notesVertices[t+5]=r.colourA,t+=8,e.notesVertices[t+0]=s,e.notesVertices[t+1]=u,e.notesVertices[t+2]=r.colourR,e.notesVertices[t+3]=r.colourG,e.notesVertices[t+4]=r.colourB,e.notesVertices[t+5]=r.colourA,t+=8,e.notesVertices[t+0]=d,e.notesVertices[t+1]=h,e.notesVertices[t+2]=r.colourR,e.notesVertices[t+3]=r.colourG,e.notesVertices[t+4]=r.colourB,e.notesVertices[t+5]=r.colourA,t+=8,e.notesVertices[t+0]=p,e.notesVertices[t+1]=g,e.notesVertices[t+2]=r.colourR,e.notesVertices[t+3]=r.colourG,e.notesVertices[t+4]=r.colourB,e.notesVertices[t+5]=r.colourA,t+=8,r=r.next,++a,a>=er)break}a!=null&&(i.useProgram(e.program),i.bindBuffer(i.ARRAY_BUFFER,e.notesGLVertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,e.notesVertices.subarray(0,a*8*6)),i.vertexAttribPointer(e.positionLocation,2,i.FLOAT,!1,8*4,0*4),i.vertexAttribPointer(e.colourLocation,4,i.FLOAT,!1,8*4,4*4),i.vertexAttribPointer(e.textureCoordLocation,2,i.FLOAT,!1,8*4,6*4),i.enableVertexAttribArray(e.positionLocation),i.enableVertexAttribArray(e.colourLocation),i.enableVertexAttribArray(e.textureCoordLocation),i.drawArrays(i.TRIANGLES,0,a*6),i.disableVertexAttribArray(e.positionLocation),i.disableVertexAttribArray(e.colourLocation),i.disableVertexAttribArray(e.textureCoordLocation))}i.useProgram(e.pianoProgram),i.bindBuffer(i.ARRAY_BUFFER,e.pianoGLVertexBuffer),i.vertexAttribPointer(e.pianoPositionLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(e.pianoPositionLocation),i.drawArrays(i.TRIANGLES,0,6),i.disableVertexAttribArray(e.pianoPositionLocation)}function vi(i,e,t){const r=i.createShader(e);if(r!=null){if(i.shaderSource(r,t),i.compileShader(r),!i.getShaderParameter(r,i.COMPILE_STATUS)){console.error("An error occurred compiling the shaders: "+i.getShaderInfoLog(r)),i.deleteShader(r);return}return r}}function ki(i,e,t){const r=vi(i,i.VERTEX_SHADER,e),n=vi(i,i.FRAGMENT_SHADER,t);if(r==null||n==null)return;const o=i.createProgram();if(i.attachShader(o,r),i.attachShader(o,n),i.linkProgram(o),!i.getProgramParameter(o,i.LINK_STATUS)){console.error("Unable to initialize the shader program: "+i.getProgramInfoLog(o));return}return o}function Hd(i,e,t){let r,n,o;const a=Math.floor(i*6),s=i*6-a,u=t*(1-e),l=t*(1-s*e),c=t*(1-(1-s)*e);switch(a%6){case 0:r=t,n=c,o=u;break;case 1:r=l,n=t,o=u;break;case 2:r=u,n=t,o=c;break;case 3:r=u,n=l,o=t;break;case 4:r=c,n=u,o=t;break;case 5:r=t,n=u,o=l;break;default:r=0,n=0,o=0;break}return{r,g:n,b:o}}function Yd(){const i=Math.random(),e=Math.random()*(1-.7)+.7;return Hd(i,e,1)}async function Xd(){let i=new AudioContext;await i.audioWorklet.addModule(Fd);let e=new AudioWorkletNode(i,"music-audio-worklet-processor");return Kd(i,e),e.connect(i.destination),[i,e]}let Kd=async(i,e)=>{const r=await fetch("./Thurston Waffles.sf2").then(g=>g.arrayBuffer()),n=new Jo.SoundFont2(new Uint8Array(r)),o=n.presets[0];if(!o)throw new Error("Preset at index 0 not found.");const a=n.instruments[o.header.bagIndex];if(!a)throw new Error("No instrument found for preset at index 0");const s=(g,f)=>{for(const y of g.zones)if(y.keyRange!=null&&f>=y.keyRange.lo&&f<=y.keyRange.hi)return y.sample;return null};let u=60;const l=s(a,u);if(!l)throw new Error(`No sample found for note ${u} in preset 0.`);const c=l.header.sampleRate,d=l.data.length,h=new Float32Array(d);for(let g=0;g<d;g++)h[g]=l.data[g]/32768;const p=l.header.originalPitch;e.port.postMessage({type:"meowData",params:{meowOriginalPitch:p,meowSampleRate:c,meowData:h}})};ke(["click"]);var Zd=q('<div><div role=tablist class="tabs tabs-box">'),Jd=q("<a role=tab class=tab>");const Qd=i=>{const e=["Piano Keys","Waterfall","Instrument Editor"];let[t,r]=_e({selectedTab:"Piano Keys"}),n=new sc;n.init();let o=new mt;return(()=>{var a=Zd(),s=a.firstChild;return a.style.setProperty("flex-grow","1"),a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("overflow","hidden"),H(s,()=>e.map(u=>se(()=>(()=>{var l=Jd();return l.$$click=()=>{r("selectedTab",u)},H(l,u),Q(()=>l.classList.toggle("tab-active",t.selectedTab==u)),l})()))),H(a,I(Gr,{get children(){return[I(ft,{get when(){return t.selectedTab=="Piano Keys"},get children(){return I(vc,{onNoteOn:u=>n.noteOn(u),onNoteOff:u=>n.noteOff(u)})}}),I(ft,{get when(){return t.selectedTab=="Waterfall"},get children(){return I(Ud,{})}}),I(ft,{get when(){return t.selectedTab=="Instrument Editor"},get children(){return I(Od,{style:{"flex-grow":"1"},world:o})}})]}}),null),a})()};ke(["click"]);const ep=G({radius:D($),out:ee($)}),ka=new Z({typeName:"Sphere",typeSchema:ep});var tp=Object.defineProperty,rp=(i,e)=>{for(var t in e)tp(i,t,{get:e[t],enumerable:!0})},wi=new WeakMap;function np(i){if(i instanceof WebGL2RenderingContext)return i;const e=wi.get(i);if(e)return e;const t=i.getExtension("ANGLE_instanced_arrays");if(!t)return;const r={drawArraysInstanced:t.drawArraysInstancedANGLE.bind(t),drawElementsInstanced:t.drawElementsInstancedANGLE.bind(t),vertexAttribDivisor:t.vertexAttribDivisorANGLE.bind(t)};return wi.set(i,r),r}var xi=new WeakMap;function ip(i){if(i instanceof WebGL2RenderingContext)return i;const e=xi.get(i);if(e)return e;const t=i.getExtension("OES_vertex_array_object");if(!t)return null;const r={bindVertexArray:t.bindVertexArrayOES.bind(t),createVertexArray:t.createVertexArrayOES.bind(t),deleteVertexArray:t.deleteVertexArrayOES.bind(t)};return xi.set(i,r),r}var ot={};rp(ot,{forEach:()=>wa,map:()=>op});function wa(i,e){let t=0;for(const r in i)e(i[r],r,t),t++;for(const r of Object.getOwnPropertySymbols(i))e(i[r],r,t),t++}function op(i,e){const t={};return wa(i,(r,n,o)=>{t[n]=e(r,n,o)}),t}function or(i,e){if(i==null)throw new Error(e);return i}function Si(i,e,t){const r=i.createShader(e);if(!r)throw new Error("Failed to create shader");if(i.shaderSource(r,t),i.compileShader(r),!i.getShaderParameter(r,i.COMPILE_STATUS)){const n=i.getShaderInfoLog(r);throw i.deleteShader(r),new Error(`Failed to compile ${e===i.VERTEX_SHADER?"vertex":"fragment"} shader: ${n}`)}return r}function ap(i,e,t){const r=i.createProgram();if(!r)throw new Error("Failed to create WebGL program");const n=Si(i,i.VERTEX_SHADER,e),o=Si(i,i.FRAGMENT_SHADER,t);if(i.attachShader(r,n),i.attachShader(r,o),i.linkProgram(r),!i.getProgramParameter(r,i.LINK_STATUS)){const a=i.getProgramInfoLog(r);throw i.deleteProgram(r),i.deleteShader(n),i.deleteShader(o),new Error(`Failed to link program: ${a}`)}return i.deleteShader(n),i.deleteShader(o),r}var sp=i=>{switch(i[0]){case"m":return"Matrix"+i.slice(3)+"fv";case"s":case"b":case"i":return(i.match(/\d/)?.[0]??"1")+"i";case"u":return(i[4]||"1")+"ui";case"v":return i[3]+"f";default:switch(i){case"float":return"1f";case"uint":return"1ui";default:return"1i"}}},xa=i=>{switch(i[0]){case"m":const[e,t]=i.match(/\d+/g).map(Number);return e*(t??e);case"v":case"i":case"b":case"u":const r=i.match(/\d/);return r?+r[0]:1;default:return 1}},lp=i=>i.includes("mat"),cp=i=>i.includes("sampler");function up(i){const e=new(i??Map);return Object.assign(e,{getOrInsert(t,r){let n=e.get(t);return n||(n=r(),e.set(t,n),n)}})}var dp=0,pp="VIEW_GL_ALIAS",hp=navigator.userAgent.toLowerCase().indexOf("firefox")>=0,fp=up(hp?Map:WeakMap);function rt(i){return typeof i=="string"?i:typeof i=="symbol"?fp.getOrInsert(i,()=>`${pp}_${dp++}`):i.toString()}function mp(i,e,t,r){return{uniforms:t.uniforms?gp(i,e,t.uniforms):void 0,attributes:t.attributes?yp(i,e,t.attributes,r):void 0,interleavedAttributes:t.interleavedAttributes?bp(i,e,t.interleavedAttributes,r):void 0,buffers:t.buffers?vp(i,t.buffers):void 0}}function gp(i,e,t){return ot.map(t,({kind:r,size:n},o)=>{const a=rt(o),s=i.getUniformLocation(e,a);if(cp(r))return{set(c){i.uniform1i(s,c)}};const u=`uniform${sp(r)}${n?"v":""}`,l=i[u].bind(i);return lp(r)?{set(...c){l(s,!1,c[0])}}:{set(...c){l(s,...c)}}})}function Sa(i,e,t,r,n,o,a){i.enableVertexAttribArray(e),i.vertexAttribPointer(e,t,i[o],!1,r,n),a&&or(np(i)).vertexAttribDivisor(e,1)}function yp(i,e,t,{signal:r}={}){const n=ot.map(t,({kind:o,instanced:a,buffer:s=or(i.createBuffer())},u)=>{const l=rt(u),c=i.getAttribLocation(e,l);if(c<0)throw new Error(`Attribute '${l}' not found`);const d=xa(o),h=o.startsWith("i")?"INT":"FLOAT";return{buffer:s,bind(){i.bindBuffer(i.ARRAY_BUFFER,s),Sa(i,c,d,0,0,h,a)},dispose(){i.deleteBuffer(s)},set(p,g="STATIC_DRAW"){return i.bindBuffer(i.ARRAY_BUFFER,s),i.bufferData(i.ARRAY_BUFFER,p,i[g]),this}}});return r?.addEventListener("abort",function(){ot.forEach(n,a=>a.dispose())}),n}function bp(i,e,t,{signal:r}={}){const n=ot.map(t,({layout:o,instanced:a})=>{let s=0;const u=o.map(p=>{const g=rt(p.key),f=i.getAttribLocation(e,g);if(f<0)throw new Error(`Attribute '${g}' not found`);const y=xa(p.kind),b=s,m=p.kind.startsWith("i")?"INT":"FLOAT";return s+=y*4,()=>Sa(i,f,y,l,b,m,a)}),l=s,c=or(i.createBuffer());let d;const h=ip(i);if(h){const p=h.createVertexArray();h.bindVertexArray(p),i.bindBuffer(i.ARRAY_BUFFER,c);for(const g of u)g();h.bindVertexArray(null),d={unbind(){h.bindVertexArray(null)},bind(){h.bindVertexArray(p)},dispose(){h.deleteVertexArray(p)}}}return{bind(){if(i.bindBuffer(i.ARRAY_BUFFER,c),d)d.bind();else for(const p of u)p()},unbind(){d&&d.unbind()},dispose(){i.deleteBuffer(c),d&&d.dispose()},set(p,g="STATIC_DRAW"){d?d.bind():i.bindBuffer(i.ARRAY_BUFFER,c),i.bufferData(i.ARRAY_BUFFER,p,i[g]),d&&d.unbind()}}});return r?.addEventListener("abort",function(){ot.forEach(n,a=>a.dispose())}),n}function vp(i,e,{signal:t}={}){const r=ot.map(e,({target:n="ARRAY_BUFFER",usage:o="STATIC_DRAW"})=>{const a=or(i.createBuffer());return{bind(){i.bindBuffer(i[n],a)},dispose(){i.deleteBuffer(a)},set(s){i.bindBuffer(i[n],a),i.bufferData(i[n],s,i[o])}}});return t?.addEventListener("abort",function(){ot.forEach(r,o=>o.dispose())}),r}function te(i,...e){return{template:i,slots:e,type:"glsl"}}var hn=new Proxy({},{get(i,e){return typeof e=="symbol"?i[e]:(t,r)=>({type:"uniform",key:t,kind:e,...r})}});new Proxy({},{get(i,e){return typeof e=="symbol"?i[e]:(t,r)=>({type:"attribute",key:t,kind:e,...r})}});function Ve(i,e,t,r){const n=Pi(e),o=Pi(t),a={uniforms:{...n.schema.uniforms,...o.schema.uniforms},attributes:{...n.schema.attributes,...o.schema.attributes},interleavedAttributes:{...n.schema.interleavedAttributes,...o.schema.interleavedAttributes}};for(const u in r){const l=a[u],c=r[u];for(const d in c)l[d]={...l[d],...c[d]}}const s=ap(i,n.template,o.template);return{program:s,schema:a,view:mp(i,s,a),vertex:n.template,fragment:o.template}}function Pi(i){return{template:Ve.toString(i),schema:Ve.toSchema(i)}}Ve.toSchema=function(i){const e={uniforms:{},attributes:{},interleavedAttributes:{}};function t(r){if(Array.isArray(r)){r.forEach(t);return}if(typeof r!="object")return;if(r.type==="glsl"){const{uniforms:s,attributes:u,interleavedAttributes:l}=Ve.toSchema(r);e.uniforms={...e.uniforms,...s},e.attributes={...e.attributes,...u},e.interleavedAttributes={...e.interleavedAttributes,...l};return}const{key:n,type:o,...a}=r;e[`${o}s`][n]=a}return i.slots.forEach(t),e};Ve.toString=function({template:[i,...e],slots:t}){const r=!!i?.startsWith("#version 300 es");let n=i??"";for(let o=0;o<e.length;o++)n+=`${Pa(t[o],r)}${e[o]}`;return n};function Pa(i,e){return typeof i!="object"?rt(i):Array.isArray(i)?i.map(t=>Pa(t,e)).join(""):i.type==="glsl"?Ve.toString(i):i.type==="interleavedAttribute"?i.layout.reduce((t,r)=>e?`${t}in ${r.kind} ${rt(r.key)};
`:`${t}attribute ${r.kind} ${rt(r.key)};
`,""):i.type==="uniform"&&"size"in i?`${i.type} ${i.kind} ${rt(i.key)}[${i.size}];`:`${i.type==="attribute"&&e?"in":i.type} ${i.kind} ${rt(i.key)};`}class kp{componentType=ka;ext={};create(e){return new wp(e)}}const Ca=new kp;class wp{type=Ca;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"radius",source:()=>t.radius,setSource:n=>r("radius",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let s=a.value,u=n.allocVar();return n.insertGlobalCode(te`
        float ${u}(vec3 p) {
          return length(p) - ${s};
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:"defaultColour"}}]])}}}const xp=G({value:Be(),out:ee($)}),_a=new Z({typeName:"Number",typeSchema:xp});var Sp=q("<input class=input type=text size=8>");class Pp{componentType=_a;ext={};create(e){return new Cp(e)}}const Ta=new Pp;class Cp{type=Ta;nodeParams;outputPins;ui;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ui=S(()=>()=>{let[n,o]=_e({valueText:se(()=>t.value.toFixed(3))});return le(ie(()=>n.valueText,()=>{let a=Number.parseFloat(n.valueText);Number.isNaN(a)||r("value",a)},{defer:!0})),(()=>{var a=Sp();return a.$$input=s=>{o("valueText",s.currentTarget.value)},Q(()=>a.value=n.valueText),a})()}),this.ext.generateCode=({ctx:n,inputs:o})=>new Map([["out",{type:"Atom",value:_p(t.value)}]])}}function _p(i){let e=i.toString();return!e.includes(".")&&!e.includes("e")&&!e.includes("E")&&(e+=".0"),e}ke(["input"]);const Tp=G({visible:Ro(!0,kc()),in:D($)}),$a=new Z({typeName:"Display",typeSchema:Tp});var $p=Object.defineProperty,Ip=(i,e)=>{for(var t in e)$p(i,t,{get:e[t],enumerable:!0})},Ia={};Ip(Ia,{forEach:()=>Ea,map:()=>Ep});function Ea(i,e){let t=0;for(const r in i)e(i[r],r,t),t++;for(const r of Object.getOwnPropertySymbols(i))e(i[r],r,t),t++}function Ep(i,e){const t={};return Ea(i,(r,n,o)=>{t[n]=e(r,n,o)}),t}var Rp=i=>{switch(i[0]){case"m":return"Matrix"+i.slice(3)+"fv";case"s":case"b":case"i":return(i.match(/\d/)?.[0]??"1")+"i";case"u":return(i[4]||"1")+"ui";case"v":return i[3]+"f";default:switch(i){case"float":return"1f";case"uint":return"1ui";default:return"1i"}}},Mp=i=>i.includes("mat"),Ap=i=>i.includes("sampler");function Np(i){const e=new(i??Map);return Object.assign(e,{getOrInsert(t,r){let n=e.get(t);return n||(n=r(),e.set(t,n),n)}})}var Op=0,Fp="VIEW_GL_ALIAS",Dp=navigator.userAgent.toLowerCase().indexOf("firefox")>=0,zp=Np(Dp?Map:WeakMap);function Lp(i){return typeof i=="string"?i:typeof i=="symbol"?zp.getOrInsert(i,()=>`${Fp}_${Op++}`):i.toString()}function fn(i,e,t){return Ia.map(t,({kind:r,size:n},o)=>{const a=Lp(o),s=i.getUniformLocation(e,a);if(Ap(r))return{set(c){i.uniform1i(s,c)}};const u=`uniform${Rp(r)}${n?"v":""}`,l=i[u].bind(i);return Mp(r)?{set(...c){l(s,!1,c[0])}}:{set(...c){l(s,...c)}}})}var jp=q('<div class="bg-base-200 mt-2 mb-2"><label class=label><input class="checkbox checkbox-sm pl-2"type=checkbox>Visible'),Up=q('<i class="fa-solid fa-desktop">');class Bp{componentType=$a;ext={};create(e){return new qp(e)}}const Ra=new Bp;class qp{type=Ra;nodeParams;inputPins;ui;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"in",source:()=>t.in,setSource:n=>r("in",n)}]),this.ui=S(()=>()=>[(()=>{var n=jp(),o=n.firstChild,a=o.firstChild;return a.addEventListener("change",s=>{r("visible",s.currentTarget.checked)}),Q(()=>a.checked=t.visible),n})(),(()=>{var n=Up();return n.style.setProperty("font-size","24px"),n.style.setProperty("color","green"),n})()]),this.ext.generateCode=({ctx:n,inputs:o,onInit:a})=>{let s=o.get("in");if(s?.type!="Model")return;let u=s.value,{sdfFuncName:l,colourFuncName:c}=u,d=n.allocVar(),h=te`
        ${hn.bool(d)}
      `;n.insertGlobalCode(h),n.insertCode(te`
        if (${d}) {
          d = min(d, ${l}(p));
        }
      `);let p=n.allocVar();return n.insertColourCode(te`
        if (${d}) {
          float ${p} = ${l}(p);
          if (${p} < d) {
            d = ${p};
            ${c}(p, c);
          }
        }
      `),a(({gl:g,program:f,rerender:y})=>{let b=fn(g,f,Ve.toSchema(h).uniforms);ve(ie(()=>t.visible,m=>{b[d].set(m?1:0),y()}))}),new Map}}}const Vp=G({x:D($),y:D($),z:D($),out:ee($)}),Ma=new Z({typeName:"Vec3",typeSchema:Vp});class Gp{componentType=Ma;ext={};create(e){return new Wp(e)}}const Aa=new Gp;class Wp{type=Aa;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"x",source:()=>t.x,setSource:n=>r("x",n)},{name:"y",source:()=>t.y,setSource:n=>r("y",n)},{name:"z",source:()=>t.z,setSource:n=>r("z",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("x"),s=o.get("y"),u=o.get("z"),l,c,d;return a?.type=="Atom"?l=a.value:l="0.0",s?.type=="Atom"?c=s.value:c="0.0",u?.type=="Atom"?d=u.value:d="0.0",new Map([["out",{type:"Atom",value:`vec3(${l}, ${c}, ${d})`}]])}}}const Hp=G({model:D($),offset:D($),out:ee($)}),Na=new Z({typeName:"Translate",typeSchema:Hp});class Yp{componentType=Na;ext={};create(e){return new Xp(e)}}const Oa=new Yp;class Xp{type=Oa;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>t.model,setSource:n=>r("model",n)},{name:"offset",source:()=>t.offset,setSource:n=>r("offset",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("offset");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          return ${s.sdfFuncName}(p - ${l});
        }
      `);let d=n.allocVar();return n.insertGlobalCode(te`
        void ${d}(vec3 p, out vec4 c) {
          ${s.colourFuncName}(p - ${l}, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const Kp=G({size:D($),out:ee($)}),Fa=new Z({typeName:"Box",typeSchema:Kp});class Zp{componentType=Fa;ext={};create(e){return new Jp(e)}}const Da=new Zp;class Jp{type=Da;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"size",source:()=>t.size,setSource:n=>r("size",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("size");if(a?.type!="Atom")return;let s=a.value,u=n.allocVar();return n.insertGlobalCode(te`
        float ${u}(vec3 p) {
          vec3 q = abs(p) - 0.5 * ${s};
          return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:"defaultColour"}}]])}}}const Qp=G({model1:D($),model2:D($),k:D($),out:ee($)}),za=new Z({typeName:"Union",typeSchema:Qp});class eh{componentType=za;ext={};create(e){return new th(e)}}const La=new eh;class th{type=La;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model1",source:()=>t.model1,setSource:n=>r("model1",n)},{name:"model2",source:()=>t.model2,setSource:n=>r("model2",n)},{name:"k",source:()=>t.k,setSource:n=>r("k",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let s=a.value,u=o.get("model2");if(u?.type!="Model")return;let l=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let d=n.allocVar();if(c?.type=="Atom"){let p=c.value;n.insertGlobalCode(te`
          float ${d}(vec3 p) {
            float k = ${p} * 4.0;
            float d1 = ${s.sdfFuncName}(p);
            float d2 = ${l.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return min(d1, d2) - h*h*0.25/k;
          }
        `)}else n.insertGlobalCode(te`
          float ${d}(vec3 p) {
            return min(${s.sdfFuncName}(p), ${l.sdfFuncName}(p));
          }
        `);let h=n.allocVar();return n.insertGlobalCode(te`
        void ${h}(vec3 p, out vec4 c) {
          float d1 = ${s.sdfFuncName}(p);
          float d2 = ${l.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${s.colourFuncName}(p, c1);
          ${l.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:d,colourFuncName:h}}]])}}}const rh=G({model1:D($),model2:D($),k:D($),out:ee($)}),ja=new Z({typeName:"Difference",typeSchema:rh});class nh{componentType=ja;ext={};create(e){return new ih(e)}}const Ua=new nh;class ih{type=Ua;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model1",source:()=>t.model1,setSource:n=>r("model1",n)},{name:"model2",source:()=>t.model2,setSource:n=>r("model2",n)},{name:"k",source:()=>t.k,setSource:n=>r("k",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let s=a.value,u=o.get("model2");if(u?.type!="Model")return;let l=u.value,c=o.get("k");if(c!=null&&c.type!="Atom")return;let d=n.allocVar();if(c?.type=="Atom"){let p=c.value;n.insertGlobalCode(te`
          float ${d}(vec3 p) {
            float k = ${p} * 4.0;
            float d1 = -${s.sdfFuncName}(p);
            float d2 = ${l.sdfFuncName}(p);
            float h = max(k-abs(d1-d2),0.0);
            return -(min(d1, d2) - h*h*0.25/k);
          }
        `)}else n.insertGlobalCode(te`
          float ${d}(vec3 p) {
            return -min(-${s.sdfFuncName}(p), ${l.sdfFuncName}(p));
          }
        `);let h=n.allocVar();return n.insertGlobalCode(te`
        void ${h}(vec3 p, out vec4 c) {
          float d1 = ${s.sdfFuncName}(p);
          float d2 = ${l.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${s.colourFuncName}(p, c1);
          ${l.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:d,colourFuncName:h}}]])}}}const oh=G({model:D($),step:D($),out:ee($)}),Ba=new Z({typeName:"Repeat",typeSchema:oh});class ah{componentType=Ba;ext={};create(e){return new sh(e)}}const qa=new ah;class sh{type=qa;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>t.model,setSource:n=>r("model",n)},{name:"step",source:()=>t.step,setSource:n=>r("step",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("step");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          vec3 s = ${l};
          vec3 id = vec3(floor(p.x/s.x + 0.5),floor(p.y/s.y + 0.5),floor(p.z/s.z + 0.5));
          vec3  o = sign(p-s*id);
          float d = 1e20;
          for( int k=0; k<2; k++ )
          for( int j=0; j<2; j++ )
          for( int i=0; i<2; i++ )
          {
            vec3 rid = id + vec3(i,j,k)*o;
            vec3 r = p - s*rid;
            d = min( d, ${s.sdfFuncName}(r));
          }
          return d;
        }
      `);let d=n.allocVar();return n.insertGlobalCode(te`
        void ${d}(vec3 p, out vec4 c) {
          vec3 s = ${l};
          vec3 id = vec3(floor(p.x/s.x + 0.5),floor(p.y/s.y + 0.5),floor(p.z/s.z + 0.5));
          p = p-s*id;
          ${s.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const lh=G({model:D($),scale:D($),out:ee($)}),Va=new Z({typeName:"Scale",typeSchema:lh});class ch{componentType=Va;ext={};create(e){return new uh(e)}}const Ga=new ch;class uh{type=Ga;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>t.model,setSource:n=>r("model",n)},{name:"scale",source:()=>t.scale,setSource:n=>r("scale",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("scale");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          return ${s.sdfFuncName}(p / ${l}) * ${l};
        }
      `);let d=n.allocVar();return n.insertGlobalCode(te`
        void ${d}(vec3 p, out vec4 c) {
          ${s.colourFuncName}(p / ${l}, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const dh=G({model:D($),axis:D($),angle:D($),out:ee($)}),Wa=new Z({typeName:"Rotate",typeSchema:dh});class ph{componentType=Wa;ext={};create(e){return new hh(e)}}const Ha=new ph;class hh{type=Ha;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>t.model,setSource:n=>r("model",n)},{name:"axis",source:()=>t.axis,setSource:n=>r("axis",n)},{name:"angle",source:()=>t.angle,setSource:n=>r("angle",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("axis");if(u?.type!="Atom")return;let l=u.value,c=o.get("angle");if(c?.type!="Atom")return;let d=c.value,h=n.allocVar();n.insertGlobalCode(te`
        float ${h}(vec3 p) {
          float a = 0.5 * ${d} * ${Math.PI/180};
          vec3 tmp = sin(a) * normalize(${l});
          vec4 q = vec4(tmp.x, tmp.y, tmp.z, cos(a));
          p = p + 2.0 * cross(-q.xyz, cross(-q.xyz, p) + q.w * p);
          return ${s.sdfFuncName}(p);
        }
      `);let p=n.allocVar();return n.insertGlobalCode(te`
        void ${p}(vec3 p, out vec4 c) {
          float a = 0.5 * ${d} * ${Math.PI/180};
          vec3 tmp = sin(a) * normalize(${l});
          vec4 q = vec4(tmp.x, tmp.y, tmp.z, cos(a));
          p = p + 2.0 * cross(-q.xyz, cross(-q.xyz, p) + q.w * p);
          ${s.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:h,colourFuncName:p}}]])}}}const fh=G({radius:D($),out:ee($)}),Ya=new Z({typeName:"InfiniteCylinder",typeSchema:fh});class mh{componentType=Ya;ext={};create(e){return new gh(e)}}const Xa=new mh;class gh{type=Xa;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"radius",source:()=>t.radius,setSource:n=>r("radius",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let s=a.value,u=n.allocVar();n.insertGlobalCode(te`
        float ${u}(vec3 p) {
          return length(p.xy) - ${s};
        }
      `);let l=n.allocVar();return n.insertGlobalCode(te`
        void ${l}(vec3 p, out vec4 c) {
          c = vec4(0.7, 0.7, 0.7, 1.0);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:u,colourFuncName:l}}]])}}}const yh=G({colour:G({red:Be(),green:Be(),blue:Be(),alpha:Be()}),out:ee($)}),Ka=new Z({typeName:"Colour",typeSchema:yh});class tr{r;g;b;a;constructor(e,t,r,n){this.r=e,this.g=t,this.b=r,this.a=n}}var bh=q("<div><div><div><div></div><svg><circle r=5 stroke=black stroke-width=2 fill=none pointer-events=none></circle></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div><div><svg width=25><rect x=0 width=24 height=10 fill=none stroke=black stroke-width=2 pointer-events=none></rect></svg></div></div><div><div></div><div><table><thead></thead><tbody><tr><td>Red:</td><td><input type=text size=4></td></tr><tr><td>Green:</td><td><input type=text size=4></td></tr><tr><td>Blue:</td><td><input type=text size=4></td></tr><tr><td>Alpha:</td><td><input type=text size=4></td></tr></tbody></table></div><div><div>");const vh=i=>{let[e,t]=_e({cursorPos:B.zero,chartMousePos:void 0,chartMouseDown:!1,brightness:255,brightnessMousePos:void 0,brightnessMouseDown:!1,alpha:255,alphaMousePos:void 0,alphaMouseDown:!1,userColour:se(()=>i.colour),userRedText:void 0,userGreenText:void 0,userBlueText:void 0,userAlphaText:void 0}),[r,n]=K(),[o,a]=K();le(()=>{let m=r();if(m==null)return;let k=new ResizeObserver(()=>{let v=m.getBoundingClientRect();o(),a(B.create(v.width,v.height))});k.observe(m),be(()=>{k.unobserve(m),k.disconnect()})});let s=S(()=>{let m=o();if(m==null)return;let k=document.createElement("canvas");k.setAttribute("width",`${m.x}`),k.setAttribute("height",`${m.y}`),k.style.setProperty("flex-grow","1");let v=k.getContext("2d");if(v==null)return;let w=new ImageData(m.x,m.y),x=256*6;for(let F=0;F<m.x;++F){let R,z,W,V=Math.floor(F*x/m.x);if(V<256){let Y=V;R=255,z=Y,W=0}else if(V<256*2)R=255-(V-256),z=255,W=0;else if(V<256*3){let Y=V-512;R=0,z=255,W=Y}else if(V<256*4){let Y=V-768;R=0,z=255-Y,W=255}else if(V<256*5)R=V-1024,z=0,W=255;else{let Y=V-1280;R=255,z=0,W=255-Y}let L=F<<2;for(let Y=0;Y<m.y;++Y){let re=R+Math.floor((256-R)*Y/m.y),N=z+Math.floor((256-z)*Y/m.y),J=W+Math.floor((256-W)*Y/m.y);w.data[L]=re,w.data[L+1]=N,w.data[L+2]=J,w.data[L+3]=255,L+=m.x<<2}}let P=new ImageData(m.x,m.y);le(ie(()=>e.brightness,()=>{let F=e.brightness,R=m.x*m.y<<2;for(let z=0;z<R;z+=4){let W=w.data[z],V=w.data[z+1],L=w.data[z+2],Y=w.data[z+3],re=Math.floor(W*F/255),N=Math.floor(V*F/255),J=Math.floor(L*F/255);P.data[z]=re,P.data[z+1]=N,P.data[z+2]=J,P.data[z+3]=Y}v.putImageData(P,0,0)}));let C=document.createElement("canvas");C.setAttribute("width","1"),C.setAttribute("height",`${m.y}`),C.style.setProperty("flex-grow","1");let T=C.getContext("2d");if(T==null)return;let M=new ImageData(1,m.y);le(()=>{let F=e.cursorPos;if(F==null)return;let R=w.width*F.y+F.x<<2,z=w.data[R],W=w.data[R+1],V=w.data[R+2];for(let L=0;L<m.y;++L){let Y=L<<2,re=Math.floor(z*(m.y-1-L)/(m.y-1)),N=Math.floor(W*(m.y-1-L)/(m.y-1)),J=Math.floor(V*(m.y-1-L)/(m.y-1));M.data[Y]=re,M.data[Y+1]=N,M.data[Y+2]=J,M.data[Y+3]=255}T.putImageData(M,0,0)});let _=document.createElement("canvas");_.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),_.style.setProperty("background-size","20px 20px"),_.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),_.setAttribute("width","1"),_.setAttribute("height",`${m.y}`),_.style.setProperty("flex-grow","1");let E=_.getContext("2d");if(E==null)return;let O=new ImageData(1,m.y);return le(()=>{let F=e.cursorPos;if(F==null)return;let R=w.width*F.y+F.x<<2,z=w.data[R],W=w.data[R+1],V=w.data[R+2],L=w.data[R+3];for(let Y=0;Y<m.y;++Y){let re=Y<<2,N=Math.floor(L*(m.y-1-Y)/(m.y-1));O.data[re]=z,O.data[re+1]=W,O.data[re+2]=V,O.data[re+3]=N}E.putImageData(O,0,0)}),{canvas:k,sliderCanvas:C,alphaSliderCanvas:_,size:m,sliderImageData:M,alphaSliderImageData:O}});ve(()=>{let m=s();if(m==null||!e.chartMouseDown)return;let k=e.chartMousePos;k!=null&&(t("userColour",void 0),t("userRedText",void 0),t("userGreenText",void 0),t("userBlueText",void 0),t("cursorPos",B.create(Math.max(0,Math.min(m.size.x-1,Math.floor(k.x))),Math.max(0,Math.min(m.size.y-1,Math.floor(k.y))))))}),ve(()=>{if(!e.brightnessMouseDown)return;let m=e.brightnessMousePos;if(m==null)return;let k=s()?.size.y;k!=null&&(t("userColour",void 0),t("userRedText",void 0),t("userGreenText",void 0),t("userBlueText",void 0),t("brightness",Math.max(0,Math.min(255,Math.floor(256*(k-m.y)/k)))))}),ve(()=>{if(!e.alphaMouseDown)return;let m=e.alphaMousePos;if(m==null)return;let k=s()?.size.y;k!=null&&(t("userColour",void 0),t("userRedText",void 0),t("userGreenText",void 0),t("userBlueText",void 0),t("userAlphaText",void 0),t("alpha",Math.max(0,Math.min(255,Math.floor(256*(k-m.y)/k)))))});let u=S(ie([s,()=>e.cursorPos,()=>e.brightness,()=>e.alpha],()=>{let m=s();if(m==null)return;let v=Math.max(0,Math.min(m.size.y,Math.floor((255-e.brightness)*m.size.y/256)))<<2,w=m.sliderImageData.data[v],x=m.sliderImageData.data[v+1],P=m.sliderImageData.data[v+2],C=e.alpha;return new tr(w,x,P,C)})),l=S(()=>{if(e.userRedText==null)return;let m=Number.parseFloat(e.userRedText);if(Number.isFinite(m))return Math.max(0,Math.min(255,m))}),c=S(()=>{if(e.userGreenText==null)return;let m=Number.parseFloat(e.userGreenText);if(Number.isFinite(m))return Math.max(0,Math.min(255,m))}),d=S(()=>{if(e.userBlueText==null)return;let m=Number.parseFloat(e.userBlueText);if(Number.isFinite(m))return Math.max(0,Math.min(255,m))}),h=S(()=>{if(e.userAlphaText==null)return;let m=Number.parseFloat(e.userAlphaText);if(Number.isFinite(m))return Math.max(0,Math.min(255,m))}),p=S(()=>{let m;return e.userColour!=null?m=e.userColour:m=u(),new tr(l()??m?.r??0,c()??m?.g??0,d()??m?.b??0,h()??m?.a??255)});ve(ie([()=>i.colour],()=>{let m=p();if(m==null||i.colour==null)return;let k=i.colour;k.r==m.r&&k.g==m.g&&k.b==m.b&&k.a==m.a||t("userColour",k)},{defer:!0})),ve(ie([()=>e.userColour,p],()=>{if(e.userColour!=null)return;let m=p();m!=null&&i.onColour?.(m)})),ve(()=>{let m=s();if(!m||e.userColour==null&&l()==null&&c()==null&&d()==null&&h()==null)return;let k=e.userColour,v=new tr(l()??k?.r??0,c()??k?.g??0,d()??k?.b??0,h()??k?.a??255),w=Math.max(v.r,v.g,v.b),x=Math.min(v.r,v.g,v.b),P=w,C=255/(w-x);if(!Number.isFinite(C))return;let T=Math.floor((v.r-x)*C),M=Math.floor((v.g-x)*C),_=Math.floor((v.b-x)*C),E=v.r==w,O=v.g==w,F=v.b==w,R;E&&!O&&_==0?R=M:!E&&O&&_==0?R=256+(255-T):T==0&&O&&!F?R=256*2+_:T==0&&!O&&F?R=256*3+(255-M):!E&&M==0&&F?R=256*4+T:R=256*5+(255-_);let z=Math.floor(m.size.x*R/(256*6)),W=x;ze(()=>{t("cursorPos",B.create(z,W)),t("brightness",P),t("alpha",v.a)})});let[g,f]=K(),[y,b]=K(50);return ve(ie(g,()=>{let m=g();if(m==null)return;let k=new ResizeObserver(()=>{let v=m.getBoundingClientRect();console.log(v),v.width!=v.height&&b(v.height)});k.observe(m),be(()=>{k.unobserve(m),k.disconnect()})})),(()=>{var m=bh(),k=m.firstChild,v=k.firstChild,w=v.firstChild,x=w.nextSibling,P=x.firstChild,C=v.nextSibling,T=C.firstChild,M=T.firstChild,_=C.nextSibling,E=_.firstChild,O=E.firstChild,F=k.nextSibling,R=F.firstChild,z=R.nextSibling,W=z.firstChild,V=W.firstChild,L=V.nextSibling,Y=L.firstChild,re=Y.firstChild,N=re.nextSibling,J=N.firstChild,ne=Y.nextSibling,we=ne.firstChild,fe=we.nextSibling,oe=fe.firstChild,Te=ne.nextSibling,Oe=Te.firstChild,Ge=Oe.nextSibling,We=Ge.firstChild,vt=Te.nextSibling,qe=vt.firstChild,Pe=qe.nextSibling,kt=Pe.firstChild,$e=z.nextSibling,tt=$e.firstChild;m.style.setProperty("flex-grow","1"),m.style.setProperty("display","flex"),m.style.setProperty("flex-direction","column"),k.style.setProperty("flex-grow","1"),k.style.setProperty("display","flex"),k.style.setProperty("flex-direction","row"),v.$$pointerup=A=>{t("chartMouseDown",!1),A.currentTarget.releasePointerCapture(A.pointerId),A.preventDefault()},v.$$pointerdown=A=>{t("chartMouseDown",!0),A.currentTarget.setPointerCapture(A.pointerId),A.preventDefault()},v.$$pointerout=A=>{t("chartMousePos",void 0),A.preventDefault()},v.$$pointermove=A=>{let je=A.currentTarget.getBoundingClientRect(),He=A.clientX-je.left,Ye=A.clientY-je.top;t("chartMousePos",B.create(He,Ye)),A.preventDefault()},v.style.setProperty("position","relative"),v.style.setProperty("flex-grow","1"),v.style.setProperty("display","flex"),v.style.setProperty("flex-direction","column"),v.style.setProperty("touch-action","none");var ce=n;typeof ce=="function"?ge(ce,w):n=w,w.style.setProperty("flex-grow","1"),w.style.setProperty("display","flex"),w.style.setProperty("flex-direction","column"),H(w,()=>s()?.canvas),x.style.setProperty("position","absolute"),x.style.setProperty("left","0"),x.style.setProperty("top","0"),x.style.setProperty("right","0"),x.style.setProperty("bottom","0"),C.$$pointerup=A=>{t("brightnessMouseDown",!1),A.currentTarget.releasePointerCapture(A.pointerId),A.preventDefault()},C.$$pointerdown=A=>{t("brightnessMouseDown",!0),A.currentTarget.setPointerCapture(A.pointerId),A.preventDefault()},C.$$pointerout=A=>{t("brightnessMousePos",void 0),A.preventDefault()},C.$$pointermove=A=>{let je=A.currentTarget.getBoundingClientRect(),He=A.clientX-je.left,Ye=A.clientY-je.top;t("brightnessMousePos",B.create(He,Ye)),A.preventDefault()},C.style.setProperty("position","relative"),C.style.setProperty("display","flex"),C.style.setProperty("flex-direction","row"),C.style.setProperty("width","25px"),C.style.setProperty("margin-left","15px"),C.style.setProperty("overflow","hidden"),C.style.setProperty("touch-action","none"),H(C,()=>s()?.sliderCanvas,T),T.style.setProperty("position","absolute"),T.style.setProperty("left","0"),T.style.setProperty("top","0"),T.style.setProperty("right","0"),T.style.setProperty("bottom","0"),_.$$pointerup=A=>{t("alphaMouseDown",!1),A.currentTarget.releasePointerCapture(A.pointerId),A.preventDefault()},_.$$pointerdown=A=>{t("alphaMouseDown",!0),A.currentTarget.setPointerCapture(A.pointerId),A.preventDefault()},_.$$pointerout=A=>{t("alphaMousePos",void 0),A.preventDefault()},_.$$pointermove=A=>{let je=A.currentTarget.getBoundingClientRect(),He=A.clientX-je.left,Ye=A.clientY-je.top;t("alphaMousePos",B.create(He,Ye)),A.preventDefault()},_.style.setProperty("position","relative"),_.style.setProperty("display","flex"),_.style.setProperty("flex-direction","row"),_.style.setProperty("width","25px"),_.style.setProperty("margin-left","15px"),_.style.setProperty("overflow","hidden"),_.style.setProperty("touch-action","none"),H(_,()=>s()?.alphaSliderCanvas,E),E.style.setProperty("position","absolute"),E.style.setProperty("left","0"),E.style.setProperty("top","0"),E.style.setProperty("right","0"),E.style.setProperty("bottom","0"),F.style.setProperty("display","flex"),F.style.setProperty("flex-direction","row"),R.style.setProperty("flex-grow","1"),J.$$input=A=>{ze(()=>{t("userRedText",A.currentTarget.value),t("userGreenText",p().g.toFixed(0)),t("userBlueText",p().b.toFixed(0)),t("userAlphaText",p().a.toFixed(0))})},oe.$$input=A=>{ze(()=>{t("userRedText",p().r.toFixed(0)),t("userGreenText",A.currentTarget.value),t("userBlueText",p().b.toFixed(0)),t("userAlphaText",p().a.toFixed(0))})},We.$$input=A=>{ze(()=>{t("userRedText",p().r.toFixed(0)),t("userGreenText",p().g.toFixed(0)),t("userBlueText",A.currentTarget.value),t("userAlphaText",p().a.toFixed(0))})},kt.$$input=A=>{ze(()=>{t("userRedText",p().r.toFixed(0)),t("userGreenText",p().g.toFixed(0)),t("userBlueText",p().b.toFixed(0)),t("userAlphaText",A.currentTarget.value)})};var de=f;return typeof de=="function"?ge(de,$e):f=$e,$e.style.setProperty("background-image","linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)"),$e.style.setProperty("background-size","20px 20px"),$e.style.setProperty("background-position","0 0, 0 10px, 10px -10px, -10px 0px"),$e.style.setProperty("margin-top","10px"),$e.style.setProperty("margin-bottom","10px"),$e.style.setProperty("margin-left","10px"),$e.style.setProperty("display","flex"),$e.style.setProperty("flex-direction","column"),tt.style.setProperty("flex-grow","1"),Q(A=>{var je=s()?.size.x??300,He=s()?.size.y??300,Ye=e.cursorPos.x,mn=e.cursorPos.y,ar=`${s()?.size.y??0}px`,gn=s()?.size.y??0,yn=(s()?.size.y??0)-e.brightness*(s()?.size.y??0)/255-5,sr=`${s()?.size.y??0}px`,bn=s()?.size.y??0,vn=(s()?.size.y??0)-e.alpha*(s()?.size.y??0)/255-5,lr=`${y()}px`,cr=(()=>{let St=p();if(St!=null)return`rgb(${St.r}, ${St.g}, ${St.b})`})(),ur=p().a/255;return je!==A.e&&X(x,"width",A.e=je),He!==A.t&&X(x,"height",A.t=He),Ye!==A.a&&X(P,"cx",A.a=Ye),mn!==A.o&&X(P,"cy",A.o=mn),ar!==A.i&&((A.i=ar)!=null?C.style.setProperty("height",ar):C.style.removeProperty("height")),gn!==A.n&&X(T,"height",A.n=gn),yn!==A.s&&X(M,"y",A.s=yn),sr!==A.h&&((A.h=sr)!=null?_.style.setProperty("height",sr):_.style.removeProperty("height")),bn!==A.r&&X(E,"height",A.r=bn),vn!==A.d&&X(O,"y",A.d=vn),lr!==A.l&&((A.l=lr)!=null?$e.style.setProperty("width",lr):$e.style.removeProperty("width")),cr!==A.u&&((A.u=cr)!=null?tt.style.setProperty("background-color",cr):tt.style.removeProperty("background-color")),ur!==A.c&&((A.c=ur)!=null?tt.style.setProperty("opacity",ur):tt.style.removeProperty("opacity")),A},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),Q(()=>J.value=e.userRedText??e.userColour?.r??u()?.r),Q(()=>oe.value=e.userGreenText??e.userColour?.g??u()?.g),Q(()=>We.value=e.userBlueText??e.userColour?.b??u()?.b),Q(()=>kt.value=e.userAlphaText??e.userColour?.a??u()?.a),m})()};ke(["pointermove","pointerout","pointerdown","pointerup","input"]);var kh=q(`<svg version=1.1 viewBox="-16 -16 32 32"><defs><linearGradient x1=0 x2=0 y1=0 y2=1><stop offset=0% stop-color="rgb(80, 80, 81)"></stop><stop offset=100% stop-color="rgb(30, 30, 31)"></stop></linearGradient><path d="
        M14.876 -5.890A-16 -16 0 0 0 14.876 5.890A16 16 0 0 112.539 9.938A-16 -16 0 0 0 2.337 15.828
        A16 16 0 0 1-2.337 15.828A-16 -16 0 0 0 -12.539 9.938A16 16 0 0 1-14.876 5.890A-16 -16 0 0 0 -14.876 -5.890
        A16 16 0 0 1-12.539 -9.938A-16 -16 0 0 0 -2.337 -15.828A16 16 0 0 12.337 -15.828A-16 -16 0 0 0 12.539 -9.938
        A16 16 0 0 114.876 -5.890"></path><clipPath><use></use></clipPath><filter></filter><filter></filter></defs><circle cx=0 cy=0 r=15.0 fill="rgb(36, 36, 37)"stroke="rgb(28, 28, 29)"stroke-width=0.5></circle><g><g><g><rect x=-16 y=-16 width=32 height=32></rect><circle cx=-28 cy=-28 r=32 fill="rgba(250, 250, 255, .16)"></circle></g></g></g><g><circle cx=0 cy=-11 r=1.1 fill=black></circle><circle cx=0 cy=-11 r=0.8 fill=white></circle></g><circle cx=0 cy=0 r=9 stroke="rgb(50, 50, 51)"stroke-width=0.7 fill=none></circle><foreignObject x=-9 y=-9 width=18 height=18><div style=width:18px;height:18px;border-radius:50%;background-image:conic-gradient(#aaa,#666,#aaa,#666,#aaa,#666,#aaa);>`);const wh=i=>{let[e,t]=_e({dragging:void 0}),[r,n]=K();be(()=>{e.dragging&&i.setDisablePan(!1)});let o=-165,a=-o,s=S(()=>o+(i.value-i.minValue)*(a-o)/(i.maxValue-i.minValue)),u=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");u.setAttribute("dx","-0.3"),u.setAttribute("dy","-0.3"),u.setAttribute("stdDeviation","0.1"),u.setAttribute("flood-opacity","0.7"),u.setAttribute("flood-color","white");let l=document.createElementNS("http://www.w3.org/2000/svg","feDropShadow");l.setAttribute("dx","1.5"),l.setAttribute("dy","1.5"),l.setAttribute("stdDeviation","0.5"),l.setAttribute("flood-opacity","0.9"),l.setAttribute("flood-color","black");let c=m=>{let k=r(),v=k.getBoundingClientRect(),w=m.clientX-v.left,x=m.clientY-v.top,P=w-.5*v.width,C=x-.5*v.width;console.log("x",w.toFixed()),console.log("y",x.toFixed()),console.log("dx",P.toFixed()),console.log("dy",C.toFixed());let T=P*P+C*C;if(T>v.width*v.width)return;let M=Math.sqrt(T),E=360/(2*Math.PI*M),O=C>0?-E:E,F=P>0?E:-E;t("dragging",new Lt({pointerId:m.pointerId,startX:w,startY:x,startValue:i.value,dadx:O,dady:F})),k.setPointerCapture(m.pointerId),i.setDisablePan(!0)},d=m=>{if(e.dragging==null||m.pointerId!=e.dragging.value.pointerId)return;let k=r(),v=e.dragging.value,w=k.getBoundingClientRect(),x=m.clientX-w.left,P=m.clientY-w.top,C=o+(v.startValue-i.minValue)*(a-o)/(i.maxValue-i.minValue)+(x-v.startX)*v.dadx+(P-v.startY)*v.dady,T=i.minValue+(C-o)*(i.maxValue-i.minValue)/(a-o);(i.unbounded??!1)||(T=Math.max(i.minValue,Math.min(i.maxValue,T))),i.setValue(T)},h=m=>{e.dragging!=null&&e.dragging.value.pointerId==m.pointerId&&(r().releasePointerCapture(e.dragging.value.pointerId),i.setDisablePan(!1),t("dragging",void 0))},p=dt(),g=dt(),f=dt(),y=dt(),b=dt();return(()=>{var m=kh(),k=m.firstChild,v=k.firstChild,w=v.nextSibling,x=w.nextSibling,P=x.firstChild,C=x.nextSibling,T=C.nextSibling,M=k.nextSibling,_=M.nextSibling,E=_.firstChild,O=E.firstChild,F=O.firstChild,R=_.nextSibling;m.$$pointerup=h,m.$$pointermove=d,m.$$pointerdown=c;var z=n;return typeof z=="function"?ge(z,m):n=m,m.style.setProperty("user-select","none"),m.style.setProperty("outline","none"),X(v,"id",p),X(w,"id",g),X(x,"id",f),X(P,"href",`#${g}`),X(C,"id",y),H(C,u),X(T,"id",b),H(T,l),X(_,"filter",`url(#${b})`),X(E,"filter",`url(#${y})`),X(O,"clip-path",`url(#${f})`),X(F,"fill",`url(#${p})`),Q(W=>{var V=`${i.size}px`,L=`${i.size}px`,Y=`transform: rotate(${s()}deg) scale(0.87)`,re=`transform: rotate(${s()}deg)`;return V!==W.e&&((W.e=V)!=null?m.style.setProperty("width",V):m.style.removeProperty("width")),L!==W.t&&((W.t=L)!=null?m.style.setProperty("height",L):m.style.removeProperty("height")),W.a=kn(x,Y,W.a),W.o=kn(R,re,W.o),W},{e:void 0,t:void 0,a:void 0,o:void 0}),m})()};ke(["pointerdown","pointermove","pointerup"]);var xh=q("<div style=width:300px;height:300px;display:flex;flex-direction:column;>");class Sh{componentType=Ka;ext={};create(e){return new Ph(e)}}const Za=new Sh;class Ph{type=Za;nodeParams;inputPins;outputPins;ui;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ui=S(()=>()=>(()=>{var n=xh();return H(n,I(vh,{get colour(){return new tr(t.colour.red,t.colour.green,t.colour.blue,t.colour.alpha)},onColour:o=>{r("colour",{red:o.r,green:o.g,blue:o.b,alpha:o.a})}})),n})()),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=`vec4(${t.colour.red/255}, ${t.colour.green/255}, ${t.colour.blue/255}, ${t.colour.alpha/255})`;return new Map([["out",{type:"Atom",value:a}]])}}}const Ch=G({colour:D($),model:D($),out:ee($)}),Ja=new Z({typeName:"ApplyColour",typeSchema:Ch});class _h{componentType=Ja;ext={};create(e){return new Th(e)}}const Qa=new _h;class Th{type=Qa;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>t.model,setSource:n=>r("model",n)},{name:"colour",source:()=>t.colour,setSource:n=>r("colour",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("colour");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(te`
        void ${c}(vec3 p, out vec4 c) {
          c = vec4(${l});
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:s.sdfFuncName,colourFuncName:c}}]])}}}const $h=G({colour1:D($),colour2:D($),size:D($),model:D($),out:ee($)}),es=new Z({typeName:"ApplyCheckers",typeSchema:$h});class Ih{componentType=es;ext={};create(e){return new Eh(e)}}const ts=new Ih;class Eh{type=ts;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>t.model,setSource:n=>r("model",n)},{name:"colour1",source:()=>t.colour1,setSource:n=>r("colour1",n)},{name:"colour2",source:()=>t.colour2,setSource:n=>r("colour2",n)},{name:"size",source:()=>t.size,setSource:n=>r("size",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("colour1");if(u?.type!="Atom")return;let l=u.value,c=o.get("colour2");if(c?.type!="Atom")return;let d=c.value,h=o.get("size");if(h?.type!="Atom")return;let p=h.value,g=n.allocVar();return n.insertGlobalCode(te`
        void ${g}(vec3 p, out vec4 c) {
          p = floor(p / ${p});
          float a = mod(p.x + p.y + p.z, 2.0);
          if (a < 0.5) {
            c = vec4(${l});
          } else {
            c = vec4(${d});
          }
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:s.sdfFuncName,colourFuncName:g}}]])}}}const Rh=G({value:Be(),sensitivity:Ro(1,Be()),out:ee($)}),rs=new Z({typeName:"UnboundKnob",typeSchema:Rh});var Mh=q("<div><label class=label style=color:black;>Value</label><input class=input type=text size=5><label class=label style=color:black;>Sensitivity</label><input class=input type=text size=5>");class Ah{componentType=rs;ext={};create(e){return new Nh(e)}}const ns=new Ah;class Nh{type=ns;nodeParams;outputPins;ui;disablePan;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e;let[n,o]=K(!1);this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:a=>r("out",a)}]),this.ui=S(()=>()=>{let[a,s]=K(t.value.toFixed(3)),[u,l]=K(t.sensitivity.toFixed(3)),c=!1,d=!1;return ve(ie(()=>t.value,h=>{c||s(h.toFixed(3))},{defer:!0})),ve(ie(()=>t.sensitivity,h=>{d||l(h.toFixed(3))})),(()=>{var h=Mh(),p=h.firstChild,g=p.nextSibling,f=g.nextSibling,y=f.nextSibling;return h.style.setProperty("display","flex"),h.style.setProperty("flex-direction","column"),g.$$input=b=>{let m=b.currentTarget.value;s(m);let k=Number.parseFloat(m.trim());if(!Number.isNaN(k))try{c=!0,r("value",k)}finally{c=!1}},y.$$input=b=>{let m=b.currentTarget.value;l(m);let k=Number.parseFloat(m.trim());if(!Number.isNaN(k))try{d=!0,r("sensitivity",k)}finally{d=!1}},H(h,I(wh,{size:100,indentSize:10,minValue:0,get maxValue(){return 100*t.sensitivity},unbounded:!0,get value(){return t.value},setValue:b=>r("value",b),setDisablePan:o}),null),Q(()=>g.value=a()),Q(()=>y.value=u()),h})()}),this.disablePan=n,this.ext.generateCode=({ctx:a,inputs:s,onInit:u})=>{let l=a.allocVar(),c=te`
        ${hn.float(l)}
      `,d=Ve.toSchema(c);return a.insertGlobalCode(c),u(({gl:h,program:p,rerender:g})=>{let f=fn(h,p,d.uniforms);ve(ie(()=>t.value,y=>{f[l].set(y),g()}))}),new Map([["out",{type:"Atom",value:l}]])}}}ke(["input"]);const Oh=G({radius:D($),height:D($),out:ee($)}),is=new Z({typeName:"Cylinder",typeSchema:Oh});class Fh{componentType=is;ext={};create(e){return new Dh(e)}}const os=new Fh;class Dh{type=os;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"radius",source:()=>t.radius,setSource:n=>r("radius",n)},{name:"height",source:()=>t.height,setSource:n=>r("height",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let s=a.value,u=o.get("height");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(${s},${l});
          return min(max(d.x,d.y),0.0) + length(max(d,0.0));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const zh=G({frequency:D($),magnitude:D($),out:ee($)}),as=new Z({typeName:"SinXYZField",typeSchema:zh});class Lh{componentType=as;ext={};create(e){return new jh(e)}}const ss=new Lh;class jh{type=ss;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"frequency",source:()=>t.frequency,setSource:n=>r("frequency",n)},{name:"magnitude",source:()=>t.magnitude,setSource:n=>r("magnitude",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("frequency");if(a?.type!="Atom")return;let s=a.value,u=o.get("magnitude");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          return ${l} * sin(p.x*${s}) * sin(p.y*${s}) * sin(p.z*${s});
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const Uh=G({model1:D($),model2:D($),out:ee($)}),ls=new Z({typeName:"Displace",typeSchema:Uh});class Bh{componentType=ls;ext={};create(e){return new qh(e)}}const cs=new Bh;class qh{type=cs;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model1",source:()=>t.model1,setSource:n=>r("model1",n)},{name:"model2",source:()=>t.model2,setSource:n=>r("model2",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model1");if(a?.type!="Model")return;let s=a.value,u=o.get("model2");if(u?.type!="Model")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          float d1 = ${s.sdfFuncName}(p);
          float d2 = ${l.sdfFuncName}(p);
          return d1 + d2;
        }
      `);let d=n.allocVar();return n.insertGlobalCode(te`
        void ${d}(vec3 p, out vec4 c) {
          float d1 = ${s.sdfFuncName}(p);
          float d2 = ${l.sdfFuncName}(p);
          float t = d1 + d2;
          vec4 c1;
          vec4 c2;
          ${s.colourFuncName}(p, c1);
          ${l.colourFuncName}(p, c2);
          c = (c1 * d2 + c2 * d1) / t;
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const Vh=G({model:D($),count:D($),out:ee($)}),us=new Z({typeName:"RepeatRotational",typeSchema:Vh});class Gh{componentType=us;ext={};create(e){return new Wh(e)}}const ds=new Gh;class Wh{type=ds;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>t.model,setSource:n=>r("model",n)},{name:"count",source:()=>t.count,setSource:n=>r("count",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("count");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          float sp = 6.283185/float(${l});
          float an = atan(p.y,p.x);
          float id = floor(an/sp);

          float a1 = sp*(id+0.0);
          float a2 = sp*(id+1.0);
          vec2 r1 = mat2(cos(a1),-sin(a1),sin(a1),cos(a1))*p.xy;
          vec2 r2 = mat2(cos(a2),-sin(a2),sin(a2),cos(a2))*p.xy;

          return min(${s.sdfFuncName}(vec3(r1.x, r1.y, p.z)), ${s.sdfFuncName}(vec3(r2.x,r2.y,p.z)));
        }
      `);let d=n.allocVar();return n.insertGlobalCode(te`
        void ${d}(vec3 p, out vec4 c) {
          float sp = 6.283185/float(${l});
          float an = atan(p.y,p.x);
          float id = floor(an/sp);
          float a1 = sp*(id+0.0);
          float a2 = sp*(id+1.0);
          vec2 r1 = mat2(cos(a1),-sin(a1),sin(a1),cos(a1))*p.xy;
          vec2 r2 = mat2(cos(a2),-sin(a2),sin(a2),cos(a2))*p.xy;
          vec3 p1 = vec3(r1.x, r1.y, p.z);
          vec3 p2 = vec3(r2.x, r2.y, p.z);
          float d1 = ${s.sdfFuncName}(p1);
          float d2 = ${s.sdfFuncName}(p2);
          if (d1 < d2) {
            p = p1;
          } else {
            p = p2;
          }
          ${s.colourFuncName}(p, c);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:d}}]])}}}const Hh=G({model:D($),k:D($),out:ee($)}),ps=new Z({typeName:"Bend",typeSchema:Hh});class Yh{componentType=ps;ext={};create(e){return new Xh(e)}}const hs=new Yh;class Xh{type=hs;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>t.model,setSource:n=>r("model",n)},{name:"k",source:()=>t.k,setSource:n=>r("k",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("k");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          float k = ${l};
          float c = cos(k*p.x);
          float s = sin(k*p.x);
          mat2  m = mat2(c,-s,s,c);
          vec3  q = vec3(m*p.xy,p.z);
          return ${s.sdfFuncName}(q);
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const Kh=G({mimeType:Qe(),base64Data:Qe(),out:ee($)}),fs=new Z({typeName:"Texture",typeSchema:Kh});var Zh=q('<button class="btn btn-primary">Browse...'),Jh=q("<input type=file hidden>");class Qh{componentType=fs;ext={};create(e){return new ef(e)}}const ms=new Qh;class ef{type=ms;nodeParams;outputPins;ui;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:a=>r("out",a)}]),this.ui=S(()=>()=>{let[a,s]=K(),u=async l=>{let c=l.type,d=await l.arrayBuffer(),h=new Uint8Array(d),p=$c(h);ze(()=>{r("mimeType",c),r("base64Data",p)})};return[(()=>{var l=Zh();return l.$$click=()=>a()?.click(),l})(),(()=>{var l=Jh();l.addEventListener("change",d=>{let h=d.currentTarget.files;if(h==null||h.length!=1)return;let p=h[0];u(p),d.currentTarget.value=""});var c=s;return typeof c=="function"?ge(c,l):s=l,l})()]});let n=S(()=>{if(t.mimeType==""||t.base64Data=="")return;let a=Ic(t.base64Data),s=new Blob([a],{type:t.mimeType}),u=URL.createObjectURL(s),[l,c]=K(),d=document.createElement("img");return d.src=u,d.onload=()=>{c(d)},be(()=>{URL.revokeObjectURL(u)}),l}),o=S(()=>n()?.());this.ext.generateCode=({ctx:a,onInit:s})=>{let u=a.allocVar(),l=te`
        ${hn.sampler2D(u)}
      `;a.insertGlobalCode(l);let c=Ve.toSchema(l);return s(({gl:d,program:h,rerender:p})=>{fn(d,h,c.uniforms)[u].set(0);let f=d.createTexture();d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,f),ve(ie(o,y=>{y!=null&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,y),p())})),be(()=>{d.deleteTexture(f)})}),new Map([["out",{type:"Atom",value:u}]])}}}ke(["click"]);const tf=G({model:D($),texture:D($),scaleX:D($),scaleY:D($),offsetX:D($),offsetY:D($),out:ee($)}),gs=new Z({typeName:"ApplyTexture",typeSchema:tf});class rf{componentType=gs;ext={};create(e){return new nf(e)}}const ys=new rf;class nf{type=ys;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"model",source:()=>t.model,setSource:n=>r("model",n)},{name:"texture",source:()=>t.texture,setSource:n=>r("texture",n)},{name:"scaleX",source:()=>t.scaleX,setSource:n=>r("scaleX",n)},{name:"scaleY",source:()=>t.scaleY,setSource:n=>r("scaleY",n)},{name:"offsetX",source:()=>t.offsetX,setSource:n=>r("offsetX",n)},{name:"offsetY",source:()=>t.offsetY,setSource:n=>r("offsetY",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("model");if(a?.type!="Model")return;let s=a.value,u=o.get("texture");if(u?.type!="Atom")return;let l=u.value,c=o.get("scaleX"),d;c?.type=="Atom"?d=c.value:d="1.0";let h=o.get("scaleY"),p;h?.type=="Atom"?p=h.value:p="1.0";let g=o.get("offsetX"),f;g?.type=="Atom"?f=g.value:f="0.0";let y=o.get("offsetY"),b;y?.type=="Atom"?b=y.value:b="0.0";let m=n.allocVar();return n.insertGlobalCode(te`
        void ${m}(vec3 p, out vec4 c) {
          c = texture2D(${l}, (p.xy + vec2(${f}, ${b})) / vec2(${d}, ${p}));
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:s.sdfFuncName,colourFuncName:m}}]])}}}const of=G({radius:D($),height:D($),out:ee($)}),bs=new Z({typeName:"Cone",typeSchema:of});class af{componentType=bs;ext={};create(e){return new sf(e)}}const vs=new af;class sf{type=vs;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"radius",source:()=>t.radius,setSource:n=>r("radius",n)},{name:"height",source:()=>t.height,setSource:n=>r("height",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius");if(a?.type!="Atom")return;let s=a.value,u=o.get("height");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          float h = ${l};
          float z = sqrt(${l} * ${l} + ${s} * ${s});
          vec2 c = vec2(${s} / z, ${l} / z);
          vec2 q = h*vec2(c.x/c.y,-1.0);
          vec2 w = vec2( length(p.xz), p.y );
          vec2 a = w - q*clamp( dot(w,q)/dot(q,q), 0.0, 1.0 );
          vec2 b = w - q*vec2( clamp( w.x/q.x, 0.0, 1.0 ), 1.0 );
          float k = sign( q.y );
          float d = min(dot( a, a ),dot(b, b));
          float s = max( k*(w.x*q.y-w.y*q.x),k*(w.y-q.y)  );
          return sqrt(d)*sign(s);        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const lf=G({radius1:D($),radius2:D($),out:ee($)}),ks=new Z({typeName:"Torus",typeSchema:lf});class cf{componentType=ks;ext={};create(e){return new uf(e)}}const ws=new cf;class uf{type=ws;nodeParams;inputPins;outputPins;ext={};constructor(e){let t=e.state,r=e.setState;this.nodeParams=e,this.inputPins=S(()=>[{name:"radius1",source:()=>t.radius1,setSource:n=>r("radius1",n)},{name:"radius2",source:()=>t.radius2,setSource:n=>r("radius2",n)}]),this.outputPins=S(()=>[{name:"out",sinks:()=>t.out,setSinks:n=>r("out",n)}]),this.ext.generateCode=({ctx:n,inputs:o})=>{let a=o.get("radius1");if(a?.type!="Atom")return;let s=a.value,u=o.get("radius2");if(u?.type!="Atom")return;let l=u.value,c=n.allocVar();return n.insertGlobalCode(te`
        float ${c}(vec3 p) {
          vec2 q = vec2(length(p.xz)-${s},p.y);
          return length(q)-${l};
        }
      `),new Map([["out",{type:"Model",value:{sdfFuncName:c,colourFuncName:"defaultColour"}}]])}}}const xs=new Oo;xs.registerNodeTypes([ts,Qa,ys,hs,Da,Za,vs,os,Ua,cs,Ra,Xa,ns,Ta,qa,ds,Ha,Ga,ss,Ca,ms,ws,Oa,La,Aa]);class df{nextId=0;globalCode=[];mainBody=[];colourBody=[];allocVar(){return`x${this.nextId++}`}insertGlobalCode(e){this.globalCode.push(e)}insertCode(e){this.mainBody.push(e)}insertColourCode(e){this.colourBody.push(e)}genCode(){return te`precision highp float;
uniform vec2 resolution;
uniform float uFocalLength;
uniform mat4 uInverseViewMatrix;
uniform bool uUseOrthogonalProjection;
uniform float uOrthogonalScale;

void defaultColour(vec3 p, out vec4 c) {
  c = vec4(1.0, 1.0, 1.0, 1.0);
}

${this.globalCode}

float map(vec3 p) {
  float d = 10000.0;
  ${this.mainBody}
  return d;
}

void colourMap(vec3 p, out vec4 c) {
  float d = 10000.0;
  ${this.colourBody}
}

bool march(vec3 ro, vec3 rd, out float t) {
  vec3 p = ro;
  t = 0.0;
  for (int i = 0; i < 100; ++i) {
    vec3 p = ro + rd*t;
    float d = map(p);
    if (abs(d) <= 0.01) {
      return true;
    }
    t += d;
  }
  return false;
}

vec3 normal(vec3 p) {
  float d = 0.01;
  float mp = map(p);
  float dx = map(p + vec3(d,0,0)) - mp;
  float dy = map(p + vec3(0,d,0)) - mp;
  float dz = map(p + vec3(0,0,d)) - mp;
  return normalize(vec3(dx,dy,dz));
}

void main(void) {
  float fl = uFocalLength;
  float d = 10000.0;
  float mx = max(resolution.x, resolution.y);
  vec2 uv = gl_FragCoord.xy / mx;
  vec3 w = normalize(vec3(0.0, 0.0, 1.0));
  vec3 u = normalize(cross(vec3(0,1,0),w));
  vec3 v = cross(w,u);
  vec3 ro;
  vec3 rd;
  if (uUseOrthogonalProjection) {
    ro = (gl_FragCoord.x - 0.5 * resolution.x) * u / uOrthogonalScale
       + (gl_FragCoord.y - 0.5 * resolution.y) * v / uOrthogonalScale;
    rd = vec3(0.0, 0.0, -1.0);
  } else {
    ro = vec3(0.0);
    rd = normalize(
      (gl_FragCoord.x - 0.5 * resolution.x) * u +
      (gl_FragCoord.y - 0.5 * resolution.y) * v +
      -fl * w
    );
  }
  vec3 rp = ro + rd;
  ro = (uInverseViewMatrix * vec4(ro, 1.0)).xyz;
  rp = (uInverseViewMatrix * vec4(rp, 1.0)).xyz;
  rd = rp - ro;
  float t = 0.0;
  bool hit = march(ro, rd, t);
  if (!hit) {
    gl_FragColor = vec4(0.2, 0.2, 0.2, 1.0);
    return;
  }
  vec3 p = ro + rd*t;
  vec3 n = normal(p);
  float s = dot(n,normalize(vec3(1,1,1))) + 0.2;
  vec4 c = vec4(1.0, 1.0, 1.0, 1.0);
  colourMap(p, c);
  gl_FragColor = vec4(c.r * s, c.g * s, c.b * s, c.a);
}`}}function pf(i){let e=i.nodesSystem,t=[];{let u=new Map;for(let l of e.nodes()){let c={id:0,inputs:{},outputs:{},height:0,node:l};u.set(l.node.nodeParams.entity,c),t.push(c)}for(let l of u.values())for(let c of l.node.node.inputPins?.()??[]){let d=c.source();if(d==null)continue;let h=u.get(d.target);h!=null&&(l.inputs[c.name]={node:h,pin:d.pin})}}for(let u of t)for(let[l,{node:c,pin:d}]of Object.entries(u.inputs)){let h=c.outputs[d],p={node:u,pin:l};h==null?(h=[p],c.outputs[d]=h):h.push(p)}let r=[];hf(t);{let u=0;for(let l of t)l.id=u++}let n=new df;r.splice(0,r.length);for(let u of t){let l=r[u.height];l==null?(l=[u],r[u.height]=l):l.push(u)}let o=new Map,a=[];for(let u=0;u<r.length;++u){let l=r[u]??[];for(let c of l){let d=c.node.node,h=new Map;for(let p of Object.entries(c.inputs)){let g=o.get(p[1].node)?.get(p[1].pin);g!=null&&h.set(p[0],g)}if(d.ext.generateCode!=null){let p=d.ext.generateCode({ctx:n,inputs:h,onInit:g=>a.push(g)});p!=null&&o.set(c,p)}}}let s=u=>{for(let l of a)l(u)};return{code:n.genCode(),onInit:s}}function hf(i){let e=new Set,t=[...i],r=[];for(;;){let n=t.pop();if(n==null){let s=t;if(t=r,r=s,n=t.pop(),n==null)break}if(e.has(n))continue;let o=!0;for(let[s,{node:u}]of Object.entries(n.inputs))if(!(n.node.node.inputPins?.().find(l=>l.name==s)?.isEffectPin??!1)&&!e.has(u)){o=!1;break}if(!o){r.push(n);continue}let a=0;for(let[,{node:s,pin:u}]of Object.entries(n.inputs))(s.node.node.outputPins?.().find(({name:l})=>l==u)?.isEffectPin??!1)||s.height>=a&&(a=s.height+1);n.height=a,e.add(n)}}const ff=new rn([...Ao.componentTypes,es,Ja,gs,ps,Fa,Ka,bs,is,ja,ls,$a,Ya,dn,_a,Ba,us,Wa,Va,as,ka,fs,ks,Se,Na,rs,za,Ma]);class mf{space;pointerDown;pointerUp;pointerMove;constructor(e){let[t,r]=_e({space:e.initSpace,orbitTarget:e.initOrbitTarget,orbiting:void 0});this.space=()=>t.space,this.pointerDown=n=>{t.orbiting||r("orbiting",new Lt({pointerId:n.pointerId,startPoint:$r.create(n.clientX,n.clientY),startOrigin:t.space.origin}))},this.pointerUp=n=>{t.orbiting!=null&&n.pointerId==n.pointerId&&r("orbiting",void 0)},this.pointerMove=n=>{if(t.orbiting){let o=t.orbiting.value,a=n.clientX-o.startPoint.x,s=n.clientY-o.startPoint.y,l=ue.fromAxisAngle(j.unitY,-a).rotate$Vec3(o.startOrigin.sub(t.orbitTarget)),c=j.create(l.z,0,-l.x).normalize();l=ue.fromAxisAngle(c,-s).rotate$Vec3(l);let h=l.add(t.orbitTarget),p=l.normalize();c=j.unitY.cross(p).normalize();let g=Ie.create(h,ue.fromWU(p,c));r("space",g)}}}writeGLInverseViewMatrix(e){let t=this.space(),r=t.u,n=t.v,o=t.w,a=t.o;e[0]=r.x,e[4]=n.x,e[8]=o.x,e[12]=a.x,e[1]=r.y,e[5]=n.y,e[9]=o.y,e[13]=a.y,e[2]=r.z,e[6]=n.z,e[10]=o.z,e[14]=a.z,e[3]=0,e[7]=0,e[11]=0,e[15]=1}}var gf=q('<label class="input input-sm">Scale:<input type=text>'),yf=q("<div><div><div></div><div><canvas>"),bf=q("<label class=label style=margin-left:5px;><input type=checkbox class=checkbox>Show Code"),vf=q('<select class="select select-sm"style=width:fit-content;>'),kf=q("<option>"),wf=q("<div><pre>");const Ss=50,xf=i=>{let[e,t]=Hr(i,["world"]);const r=["Orthogonal","Perspective"];let[n,o]=_e({windowWidth:window.innerWidth,windowHeight:window.innerHeight,showCode:!1,projection:"Perspective",orthoScaleText:"0.1"}),a=new mf({initSpace:Ie.create(j.create(0,0,1e4),ue.identity),initOrbitTarget:j.zero}),s=S(()=>{let v=Number.parseFloat(n.orthoScaleText);return Number.isNaN(v)?.1:v});window.addEventListener("resize",()=>{ze(()=>{o("windowWidth",window.innerWidth),o("windowHeight",window.innerHeight)})});let u=S(()=>n.windowWidth>n.windowHeight),[l,c]=K(),d=S(()=>{let v=l();if(v!=null)return pf({nodesSystem:v})}),[h,p]=K(),[g,f]=K(),[y,b]=K();ve(ie([h,g],([v,w])=>{if(v==null||w==null)return;let x=v.getBoundingClientRect();w.width=x.width*window.devicePixelRatio,w.height=x.height*window.devicePixelRatio,w.style.setProperty("background-color","darkblue");let P=w.getContext("webgl");P!=null&&b(P)}));let m,k;{let v=!1;k=()=>{let w=y();if(w==null||m==null)return;let x=m;v||(v=!0,requestAnimationFrame(()=>{v=!1,w.bindBuffer(w.ARRAY_BUFFER,x.verticesGLBuffer),w.enableVertexAttribArray(x.positionLocation),w.drawArrays(w.TRIANGLES,0,6),w.disableVertexAttribArray(x.positionLocation)}))}}return ve(ie([y,g],([v,w])=>{if(v==null||w==null)return;let x=d();x!=null&&(m=Pf(v,w,a,x))})),ve(ie([y,d],([v,w])=>{if(l()==null)return;let P=g();if(P==null)return;let C=P.width,T=P.height;const M=.5*T/Math.tan(.5*Ss*Math.PI/180);if(m==null||v==null||w==null)return;let _=Ur(v,v.FRAGMENT_SHADER,Ve.toString(w.code));if(_==null)return;if(v.detachShader(m.shaderProgram,m.fragmentShader),v.deleteShader(m.fragmentShader),m.fragmentShader=_,v.attachShader(m.shaderProgram,m.fragmentShader),v.linkProgram(m.shaderProgram),!v.getProgramParameter(m.shaderProgram,v.LINK_STATUS)){console.error("ERROR linking program:",v.getProgramInfoLog(m.shaderProgram));return}let E=m.shaderProgram;v.useProgram(E);const O=v.getAttribLocation(E,"aVertexPosition"),F=v.getUniformLocation(E,"uFocalLength"),R=v.getUniformLocation(E,"uModelViewMatrix"),z=v.getUniformLocation(E,"resolution"),W=v.getUniformLocation(E,"uUseOrthogonalProjection"),V=v.getUniformLocation(E,"uOrthogonalScale");m.inverseViewMatrixLocation=v.getUniformLocation(E,"uInverseViewMatrix"),m.useOrthogonalProjectionLocation=W,m.orthogonalProjectionScaleLocation=V,a.writeGLInverseViewMatrix(m.inverseViewMatrix),v.uniformMatrix4fv(m.inverseViewMatrixLocation,!1,m.inverseViewMatrix),v.uniform1i(W,n.projection=="Orthogonal"?1:0),v.uniform1f(V,s()),v.uniform1f(F,M),v.uniform2f(z,C,T),w.onInit({gl:v,program:E,rerender:k});const L=m.vertices;L[0]=0,L[1]=0,L[2]=C,L[3]=0,L[4]=C,L[5]=T,L[6]=0,L[7]=0,L[8]=C,L[9]=T,L[10]=0,L[11]=T;let Y=m.verticesGLBuffer;v.bindBuffer(v.ARRAY_BUFFER,Y),v.bufferData(v.ARRAY_BUFFER,L,v.DYNAMIC_DRAW),v.vertexAttribPointer(O,2,v.FLOAT,!1,0,0);function re(J,ne,we,fe){var oe=-1,Te=1,Oe=ne-J,Ge=fe-we,We=Te-oe;return[2/Oe,0,0,0,0,2/Ge,0,0,0,0,-2/We,0,-(ne+J)/Oe,-(fe+we)/Ge,-(Te+oe)/We,1]}const N=new Float32Array(re(0,C,0,T));v.uniformMatrix4fv(R,!1,N),v.viewport(0,0,C,T),v.enableVertexAttribArray(O),v.drawArrays(v.TRIANGLES,0,6),v.disableVertexAttribArray(O)},{defer:!0})),ve(ie(()=>n.projection,v=>{let w=y();if(w!=null&&m!=null){switch(v){case"Orthogonal":w.uniform1i(m.useOrthogonalProjectionLocation,1);break;case"Perspective":w.uniform1i(m.useOrthogonalProjectionLocation,0);break}k()}},{defer:!0})),ve(ie(s,v=>{let w=y();w!=null&&m!=null&&(w.uniform1f(m.orthogonalProjectionScaleLocation,v),k())},{defer:!0})),ve(ie(()=>a.space(),()=>{let v=y();v!=null&&m!=null&&(a.writeGLInverseViewMatrix(m.inverseViewMatrix),v.uniformMatrix4fv(m.inverseViewMatrixLocation,!1,m.inverseViewMatrix),k())},{defer:!0})),(()=>{var v=yf(),w=v.firstChild,x=w.firstChild,P=x.nextSibling,C=P.firstChild;qr(v,t,!1,!0),w.style.setProperty("width","100%"),w.style.setProperty("height","100%"),w.style.setProperty("position","relative"),w.style.setProperty("display","flex"),x.style.setProperty("flex","1"),x.style.setProperty("display","flex"),x.style.setProperty("overflow","hidden"),H(x,I(zo,{style:{"flex-grow":"1"},onInit:_=>{c(_.nodesSystem)},componentRegistry:ff,nodeRegistry:xs,get world(){return e.world},get toolbar(){return[(()=>{var _=bf(),E=_.firstChild;return E.addEventListener("change",O=>o("showCode",O.currentTarget.checked)),Q(()=>E.checked=n.showCode),_})(),(()=>{var _=vf();return _.addEventListener("change",E=>{if(E.currentTarget.selectedOptions.length!=1)return;let O=E.currentTarget.selectedOptions[0].value;o("projection",O)}),H(_,I(Xe,{each:r,children:E=>(()=>{var O=kf();return O.value=E,H(O,E),Q(()=>O.selected=n.projection==E),O})()})),_})()]}}),null),H(x,I(ae,{get when(){return S(()=>!!n.showCode)()?d():void 0},children:_=>(()=>{var E=wf(),O=E.firstChild;return E.style.setProperty("position","absolute"),E.style.setProperty("right","0"),E.style.setProperty("top","0"),E.style.setProperty("bottom","0"),E.style.setProperty("overflow","auto"),E.style.setProperty("width","50%"),Q(()=>O.innerText=Ve.toString(_().code)),E})()}),null);var T=p;typeof T=="function"?ge(T,P):p=P,P.style.setProperty("flex","1"),P.style.setProperty("display","flex"),P.style.setProperty("overflow","hidden"),P.style.setProperty("position","relative"),C.$$pointermove=_=>{a.pointerMove(_)},C.$$pointerup=_=>{a.pointerUp(_)},C.$$pointerdown=_=>{a.pointerDown(_)};var M=f;return typeof M=="function"?ge(M,C):f=C,C.style.setProperty("flex-grow","1"),C.style.setProperty("touch-action","none"),H(P,I(ae,{get when(){return n.projection=="Orthogonal"},get children(){var _=gf(),E=_.firstChild,O=E.nextSibling;return _.style.setProperty("position","absolute"),_.style.setProperty("left","0"),_.style.setProperty("top","0"),_.style.setProperty("width","200px"),O.$$input=F=>{o("orthoScaleText",F.currentTarget.value)},Q(()=>O.value=n.orthoScaleText),_}}),null),Q(_=>(_=u()?"row":"column-reverse")!=null?w.style.setProperty("flex-direction",_):w.style.removeProperty("flex-direction")),v})()};function Ur(i,e,t){const r=i.createShader(e);if(r!=null){if(i.shaderSource(r,t),i.compileShader(r),!i.getShaderParameter(r,i.COMPILE_STATUS)){console.error("An error occurred compiling the shaders: "+i.getShaderInfoLog(r)),i.deleteShader(r);return}return r}}function Sf(i,e,t){const r=Ur(i,i.VERTEX_SHADER,e);if(r==null)return;const n=Ur(i,i.FRAGMENT_SHADER,t);if(n==null){i.deleteShader(r);return}const o=i.createProgram();if(i.attachShader(o,r),i.attachShader(o,n),i.linkProgram(o),!i.getProgramParameter(o,i.LINK_STATUS)){console.error("Unable to initialize the shader program: "+i.getProgramInfoLog(o)),i.detachShader(o,r),i.detachShader(o,n),i.deleteShader(r),i.deleteShader(n),i.deleteProgram(o);return}return{vertexShader:r,fragmentShader:n,shaderProgram:o}}function Pf(i,e,t,r){let n=e.width,o=e.height;const a=.5*o/Math.tan(.5*Ss*Math.PI/180);let s,u,l;{const P=Sf(i,`attribute vec4 aVertexPosition;

  uniform mat4 uModelViewMatrix;

  void main(void) {
    gl_Position = uModelViewMatrix * aVertexPosition;
  }
  `,Ve.toString(r.code));if(P==null)return;s=P.vertexShader,u=P.fragmentShader,l=P.shaderProgram}i.useProgram(l);const c=i.getAttribLocation(l,"aVertexPosition"),d=i.getUniformLocation(l,"uFocalLength"),h=i.getUniformLocation(l,"uModelViewMatrix"),p=i.getUniformLocation(l,"resolution"),g=i.getUniformLocation(l,"uInverseViewMatrix"),f=i.getUniformLocation(l,"uUseOrthogonalProjection"),y=i.getUniformLocation(l,"uOrthogonalScale");let b=new Float32Array(16);se(()=>t.writeGLInverseViewMatrix(b)),i.uniformMatrix4fv(g,!1,b),i.uniform1i(f,0),i.uniform1f(y,.1),i.uniform1f(d,a),i.uniform2f(p,n,o);const m=new Float32Array(12);m[0]=0,m[1]=0,m[2]=n,m[3]=0,m[4]=n,m[5]=o,m[6]=0,m[7]=0,m[8]=n,m[9]=o,m[10]=0,m[11]=o;let k=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,k),i.bufferData(i.ARRAY_BUFFER,m,i.DYNAMIC_DRAW),i.vertexAttribPointer(c,2,i.FLOAT,!1,0,0);function v(P,C,T,M){var _=-1,E=1,O=C-P,F=M-T,R=E-_;return[2/O,0,0,0,0,2/F,0,0,0,0,-2/R,0,-(C+P)/O,-(M+T)/F,-(E+_)/R,1]}const w=new Float32Array(v(0,n,0,o));return i.uniformMatrix4fv(h,!1,w),i.viewport(0,0,n,o),i.enableVertexAttribArray(c),i.drawArrays(i.TRIANGLES,0,6),i.disableVertexAttribArray(c),{width:e.width,height:e.height,positionLocation:c,verticesGLBuffer:k,vertices:m,vertexShader:s,fragmentShader:u,shaderProgram:l,inverseViewMatrix:b,inverseViewMatrixLocation:g,useOrthogonalProjectionLocation:f,orthogonalProjectionScaleLocation:y}}ke(["pointerdown","pointerup","pointermove","input"]);var Cf=q("<div>");const _f=Ne(()=>Ae(()=>import("./CodeMirror-DYZ7CKJi.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),Tf=Ne(()=>Ae(()=>import("./AppV2-BeZHOWXp.js"),__vite__mapDeps([5,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,0,21]),import.meta.url)),$f=Ne(()=>Ae(()=>import("./KittyDemo-FEXpBsO8.js"),__vite__mapDeps([22,1,2,3,4,12,13,17]),import.meta.url)),If=Ne(()=>Ae(()=>import("./PixelEditor-CV9Vk2Uj.js"),__vite__mapDeps([6,1,2,3,4,7]),import.meta.url)),Ef=Ne(()=>Ae(()=>import("./lib-DboxH0Mh.js").then(i=>i._),__vite__mapDeps([1,2,3,4]),import.meta.url)),Rf=Ne(()=>Ae(()=>import("./ScriptEditor-DtVbKCME.js"),__vite__mapDeps([8,1,2,3,4]),import.meta.url)),Mf=Ne(()=>Ae(()=>import("./ColourPicker-C7eT6vxI.js").then(i=>i.b),__vite__mapDeps([7,1,2,3,4]),import.meta.url)),Af=Ne(()=>Ae(()=>import("./ReactiveSimulator-CUdajhZJ.js"),__vite__mapDeps([23,1,2,3,4]),import.meta.url)),Nf=Ne(()=>Ae(()=>import("./VectorEditor-diFFJLhj.js"),__vite__mapDeps([24,1,2,3,4]),import.meta.url)),Of=Ne(()=>Ae(()=>import("./GravityTest-BHrXVkdu.js"),__vite__mapDeps([25,1,2,3,4]),import.meta.url)),Ff=Ne(()=>Ae(()=>import("./ThreeBody-BxCJCe9S.js"),__vite__mapDeps([26,1,2,3,4]),import.meta.url)),Df=Ne(()=>Ae(()=>import("./VirtualFileSystemTest-DNE_KFna.js"),__vite__mapDeps([27,1,2,3,4]),import.meta.url)),zf=Ne(()=>Ae(()=>import("./AutomergeWebRtcTest-U62PZw_L.js"),__vite__mapDeps([28,1,2,3,4]),import.meta.url)),Lf=Ne(()=>Ae(()=>import("./DebugProjection-qPG0xQTx.js"),__vite__mapDeps([29,1,2,3,4]),import.meta.url)),jf=Ne(()=>Ae(()=>import("./AutoFormsTest-C0P4jkUR.js"),__vite__mapDeps([30,1,2,3,4]),import.meta.url)),Uf=document.getElementById("root");_i(()=>{let i=new URLSearchParams(window.location.search),e=window.localStorage.getItem("lastDocUrl"),t=i.get("docUrl")??e,[r,n]=K(!1),o=new Ts({storage:new $s,network:[]}),a;if(t==null||!wn(t)){let y=o.create(xn.makeEmptyState(o));window.localStorage.setItem("lastDocUrl",y.url),a=()=>y}else{let[y]=As(()=>o.find(t));a=y}let s=S(()=>{let[y,b]=K(a());return{doc:y,setDoc:b}}),u=S(()=>s().doc()),l=y=>{se(()=>s().setDoc(y))},c=S(()=>a()?.url),d=ic({documentUrl:c,setDocumentUrl:async y=>{if(!wn(y))return;let b=await o.find(y);l(b)}}),h=d.connections.bind(d),p=S(it(h,y=>new oc({connection:y.conn})));le(it(p,y=>{o.networkSubsystem.addNetworkAdapter(y),be(()=>{})}));let g=S(()=>{let y=u();return new xn({repo:o,docHandle:()=>y})}),f=()=>I(ml,{onShareVfs:()=>{let y=a();if(y==null)return;const b=new URL(window.location.href);b.searchParams.set("docUrl",y.url);let m=b.toString();window.history.pushState(null,"",m),navigator.clipboard.writeText(m)},onDeleteVfs:()=>{window.localStorage.removeItem("lastDocUrl"),indexedDB.deleteDatabase("automerge"),window.location.reload()},get vfs(){return g()}});return I(ll,{get children(){return[I(xe,{path:"/",component:f}),I(xe,{path:"/kitty-demo",component:$f}),I(xe,{path:"/pixel-editor",component:()=>I(If,{})}),I(xe,{path:"/level-builder",component:()=>I(Ef,{get vfs(){return g()}})}),I(xe,{path:"/script-editor",component:()=>I(Rf,{})}),I(xe,{path:"/music-editor",component:Qd}),I(xe,{path:"/model-editor",component:()=>I(xf,{style:"flex-grow: 1; overflow: hidden;",world:new mt})}),I(xe,{path:"/code-mirror",component:()=>I(_f,{})}),I(xe,{path:"/colour-picker",component:()=>(()=>{var y=Cf();return y.style.setProperty("width","300px"),y.style.setProperty("height","300px"),y.style.setProperty("display","flex"),y.style.setProperty("flex-direction","column"),y.style.setProperty("margin-left","20px"),y.style.setProperty("margin-top","20px"),H(y,I(Mf,{})),y})()}),I(xe,{path:"/reactive-sim",component:Af}),I(xe,{path:"/vector-editor",component:Nf}),I(xe,{path:"/gravity-test",component:Of}),I(xe,{path:"/three-body",component:Ff}),I(xe,{path:"/vfs-test",component:Df}),I(xe,{path:"/automerge-webrtc-test",component:zf}),I(xe,{path:"/connection-management",get component(){return d.Render}}),I(xe,{path:"/debug-projection",component:Lf}),I(xe,{path:"/app",component:()=>I(ae,{get when(){return u()},children:y=>I(Tf,{get vfsDocUrl(){return y().url},get vfs(){return g()},get ConnectionManagementUi(){return d.Render},get broadcastNetworkAdapterIsEnabled(){return r()},enableBroadcastNetworkAdapter:()=>{o.networkSubsystem.addNetworkAdapter(new Is),n(!0)},flushRepo:()=>o.flush()})})}),I(xe,{path:"/auto-forms-test",component:jf})]}})},Uf);const Zf=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{jn as $,ji as F,dl as a,Zf as b,Hf as e,pl as i};
